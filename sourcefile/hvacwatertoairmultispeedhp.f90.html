<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HVACWatertoAirMultiSpeedHP.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HVACWatertoAirMultiSpeedHP.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.0% of total for source files.">3838 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HVACWatertoAirMultiSpeedHP.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HVACWatertoAirMultiSpeedHP.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/variablespeedcoils.html">VariableSpeedCoils</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html#src">HVACWatertoAirMultiSpeedHP.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilehvacwatertoairmultispeedhpf90EfferentGraph" width="641pt" height="901pt"
 viewBox="0.00 0.00 641.00 900.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph" class="graph" transform="scale(.2708 .2708) rotate(0) translate(4 3321.5731)">
<title>sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-3321.5731 2362.8716,-3321.5731 2362.8716,4 -4,4"/>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~hvacwatertoairmultispeedhp.f90</title>
<polygon fill="none" stroke="#000000" points="2358.8135,-3245.8527 2186.0459,-3245.8527 2186.0459,-3223.8418 2358.8135,-3223.8418 2358.8135,-3245.8527"/>
<text text-anchor="middle" x="2272.4297" y="-3231.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACWatertoAirMultiSpeedHP.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-2641.8527 543.4891,-2641.8527 543.4891,-2619.8418 658.8752,-2619.8418 658.8752,-2641.8527"/>
<text text-anchor="middle" x="601.1821" y="-2627.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1834.0785,-3236.8472C1894.2437,-3247.0852 1910.7233,-3229.221 1971.3926,-3235.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M659.116,-2639.3814C668.9141,-2643.0888 678.2209,-2648.3616 685.3989,-2655.8472 730.7597,-2703.1517 678.1246,-2749.6269 721.3989,-2798.8472 896.8571,-2998.4137 1572.1143,-3192.2705 1834.0785,-3236.8472"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1390.5785,-812.8527 1292.5795,-812.8527 1292.5795,-790.8418 1390.5785,-790.8418 1390.5785,-812.8527"/>
<text text-anchor="middle" x="1341.579" y="-798.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M659.2047,-2623.989C669.3695,-2620.1684 678.7903,-2614.4254 685.3989,-2605.8472 765.1133,-2502.3757 657.5383,-1544.7884 721.3989,-1430.8472 759.0825,-1363.6115 825.6501,-1401.2174 866.4844,-1335.8472 934.1248,-1227.5642 821.2488,-1149.342 902.4844,-1050.8472 924.2493,-1024.4582 944.6125,-1041.3092 975.6116,-1026.8472"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="827.3104,-1570.8527 760.5729,-1570.8527 760.5729,-1548.8418 827.3104,-1548.8418 827.3104,-1570.8527"/>
<text text-anchor="middle" x="793.9417" y="-1556.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M659.1078,-2623.9138C669.2801,-2620.099 678.7285,-2614.3774 685.3989,-2605.8472 740.0732,-2535.9294 706.8355,-1895.4011 721.3989,-1807.8472 735.7844,-1721.3628 770.4848,-1622.3878 786.098,-1580.3985"/>
<polygon fill="#1400ff" stroke="#1400ff" points="789.3909,-1581.5854 789.6323,-1570.9933 782.8383,-1579.1231 789.3909,-1581.5854"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1897.5812,-2752.8527 1770.5758,-2752.8527 1770.5758,-2730.8418 1897.5812,-2730.8418 1897.5812,-2752.8527"/>
<text text-anchor="middle" x="1834.0785" y="-2738.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M659.1349,-2639.9561C668.8144,-2643.6146 678.0739,-2648.7225 685.3989,-2655.8472 722.2735,-2691.7136 683.9481,-2730.5831 721.3989,-2765.8472 745.6636,-2788.6952 761.1787,-2778.7324 793.9417,-2784.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-2784.8472C1137.5078,-2848.9703 1231.7183,-2786.9285 1579.7417,-2754.8472 1622.4227,-2750.9129 1632.4192,-2737.6192 1675.1594,-2740.8472"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2141.3812,-2828.8527 2053.8119,-2828.8527 2053.8119,-2806.8418 2141.3812,-2806.8418 2141.3812,-2828.8527"/>
<text text-anchor="middle" x="2097.5966" y="-2814.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.2729,-2829.001C2125.9229,-2885.4094 2232.4554,-3139.5034 2263.7561,-3214.1595"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2260.5626,-3215.5947 2267.657,-3223.4637 2267.0181,-3212.8881 2260.5626,-3215.5947"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-2871.8527 358.7923,-2871.8527 358.7923,-2849.8418 439.3754,-2849.8418 439.3754,-2871.8527"/>
<text text-anchor="middle" x="399.0839" y="-2857.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-3122.8472C633.5859,-3139.1604 1174.9102,-3236.8472 1341.579,-3236.8472 1341.579,-3236.8472 1341.579,-3236.8472 1514.4946,-3236.8472 1656.5319,-3236.8472 1692.2273,-3229.5785 1834.0785,-3236.8472"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M601.1821,-3122.8472C635.3426,-3139.6395 1940.0367,-3162.428 1971.3926,-3140.8472"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2009.019,-2828.8527 1933.7662,-2828.8527 1933.7662,-2806.8418 2009.019,-2806.8418 2009.019,-2828.8527"/>
<text text-anchor="middle" x="1971.3926" y="-2814.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M793.9417,-3046.8472C1175.2349,-2955.7854 1283.7591,-3030.8143 1675.1594,-3008.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1954.8527 551.623,-1954.8527 551.623,-1932.8418 650.7412,-1932.8418 650.7412,-1954.8527"/>
<text text-anchor="middle" x="601.1821" y="-1940.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M439.2343,-2858.2343C454.698,-2855.0659 471.0187,-2848.6355 480.9653,-2835.8472 532.5275,-2769.5548 492.1937,-2161.095 516.9653,-2080.8472 531.2562,-2034.5519 564.8721,-1988.0669 585.0456,-1962.9235"/>
<polygon fill="#ff003d" stroke="#ff003d" points="587.9419,-1964.9107 591.5668,-1954.9553 582.5248,-1960.4773 587.9419,-1964.9107"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-3046.8472C845.9014,-3034.1382 852.0067,-3012.5487 902.4844,-2994.8472 1194.0608,-2892.5972 1310.1833,-2988.8776 1579.7417,-2837.8472 1632.4984,-2808.2883 1614.8083,-2737.0076 1675.1594,-2740.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.307,-2866.4088C453.7007,-2870.0276 469.2448,-2875.9982 480.9653,-2885.8472 571.3879,-2961.8315 495.1868,-3070.7432 601.1821,-3122.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-3122.8472C653.4252,-3148.5283 666.9967,-3091.5656 721.3989,-3070.8472 753.1352,-3058.7609 760.9107,-3054.7358 793.9417,-3046.8472"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1302.8527 350.2841,-1302.8527 350.2841,-1280.8418 447.8836,-1280.8418 447.8836,-1302.8527"/>
<text text-anchor="middle" x="399.0839" y="-1288.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.7416,-1280.6716C420.1597,-1249.6157 462.9626,-1159.2609 480.9653,-1078.8472 528.5744,-866.1899 433.5182,-791.1588 516.9653,-589.8472 560.818,-484.0551 632.479,-496.4077 685.3989,-394.8472 715.4851,-337.1079 681.3128,-304.1514 721.3989,-252.8472 834.237,-108.4316 908.7682,-109.0592 1084.7388,-57.8472 1194.6423,-25.8625 1227.649,-27.8124 1341.579,-38.8472"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1834.0785,-2588.8472C1860.05,-2602.2298 1871.5041,-2592.6688 1897.5798,-2605.8472 1935.0626,-2624.7907 1937.2102,-2640.4468 1971.3926,-2664.8472"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M601.1821,-2094.8472C618.2213,-2129.8391 659.5631,-2089.7394 685.3989,-2118.8472 752.6253,-2194.5877 646.0733,-2276.1564 721.3989,-2343.8472 778.6534,-2395.2986 1338.4343,-2361.7282 1413.2476,-2379.8472 1566.7938,-2417.0346 1595.2451,-2457.3762 1734.5771,-2531.8472 1779.5248,-2555.8711 1788.7742,-2565.503 1834.0785,-2588.8472"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1971.3926,-2664.8472C2023.2044,-2701.8321 2066.0013,-2765.192 2085.7826,-2797.5439"/>
<polygon fill="#ff3d00" stroke="#ff3d00" points="2083.0232,-2799.7482 2091.1672,-2806.5251 2089.0269,-2796.1487 2083.0232,-2799.7482"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1579.9897,-999.8527 1448.9995,-999.8527 1448.9995,-977.8418 1579.9897,-977.8418 1579.9897,-999.8527"/>
<text text-anchor="middle" x="1514.4946" y="-985.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M402.2892,-1280.6289C413.2983,-1243.531 452.4809,-1122.6411 516.9653,-1042.8472 576.2325,-969.5094 616.2539,-977.9565 685.3989,-913.8472 791.5962,-815.3841 788.4624,-760.1324 902.4844,-670.8472 953.3331,-631.03 1094.81,-537.8258 1159.3246,-534.8472"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="840.5655,-2334.8527 747.3178,-2334.8527 747.3178,-2312.8418 840.5655,-2312.8418 840.5655,-2334.8527"/>
<text text-anchor="middle" x="793.9417" y="-2320.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M601.1821,-2094.8472C618.2213,-2129.8391 659.0041,-2090.2452 685.3989,-2118.8472 740.7279,-2178.8031 667.7166,-2237.4126 721.3989,-2298.8472 725.9336,-2304.0368 731.598,-2308.1498 737.7505,-2311.4095"/>
<polygon fill="#cbff00" stroke="#cbff00" points="736.4843,-2314.6779 747.0389,-2315.6007 739.3635,-2308.2974 736.4843,-2314.6779"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M448.1629,-1296.7181C460.6964,-1300.3843 472.8941,-1306.5548 480.9653,-1316.8472 525.3951,-1373.5042 494.7635,-1895.3557 516.9653,-1963.8472 538.3086,-2029.69 570.8795,-2032.6174 601.1821,-2094.8472"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1896.8177,-1991.8527 1771.3392,-1991.8527 1771.3392,-1969.8418 1896.8177,-1969.8418 1896.8177,-1991.8527"/>
<text text-anchor="middle" x="1834.0785" y="-1977.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M404.5405,-1280.6241C419.4449,-1249.4467 461.0564,-1158.8103 480.9653,-1078.8472 512.9835,-950.2483 456.0972,-900.567 516.9653,-782.8472 563.4153,-693.0123 630.5267,-714.7999 685.3989,-629.8472 713.5385,-586.2819 683.0389,-553.7512 721.3989,-518.8472 930.2564,-328.8069 1076.1683,-284.4422 1341.579,-380.8472"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M408.0936,-1280.5076C426.8699,-1257.2669 472.175,-1203.193 516.9653,-1164.8472 545.8687,-1140.1026 1048.3528,-792.9723 1084.7388,-781.8472 1155.912,-760.0859 1243.0797,-775.066 1295.3753,-788.2167"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1294.7955,-791.6823 1305.3544,-790.8111 1296.5568,-784.9075 1294.7955,-791.6823"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1025.0015,-2562.8527 926.2216,-2562.8527 926.2216,-2540.8418 1025.0015,-2540.8418 1025.0015,-2562.8527"/>
<text text-anchor="middle" x="975.6116" y="-2548.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M448.2986,-1296.6127C460.8343,-1300.2772 472.9992,-1306.4732 480.9653,-1316.8472 550.101,-1406.88 453.4034,-2243.7966 516.9653,-2337.8472 540.7533,-2373.0457 828.3521,-2474.1195 866.4844,-2492.8472 894.3946,-2506.5547 925.5327,-2523.5664 947.3807,-2535.7957"/>
<polygon fill="#00ff66" stroke="#00ff66" points="945.707,-2538.8699 956.1389,-2540.7204 949.1379,-2532.7683 945.707,-2538.8699"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1030.7496,-1114.8527 920.4735,-1114.8527 920.4735,-1092.8418 1030.7496,-1092.8418 1030.7496,-1114.8527"/>
<text text-anchor="middle" x="975.6116" y="-1100.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M601.1821,-1290.8472C733.3321,-1300.4999 753.4947,-1224.0581 866.4844,-1154.8472 883.3145,-1144.5381 884.955,-1137.9165 902.4844,-1128.8472 910.1073,-1124.9033 918.4866,-1121.3694 926.7684,-1118.2869"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="928.1363,-1121.5155 936.3944,-1114.8781 925.7996,-1114.917 928.1363,-1121.5155"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1208.8735,-468.8527 1109.7757,-468.8527 1109.7757,-446.8418 1208.8735,-446.8418 1208.8735,-468.8527"/>
<text text-anchor="middle" x="1159.3246" y="-454.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M403.211,-1280.6789C420.2139,-1234.9099 485.4226,-1061.8015 516.9653,-1012.8472 653.8514,-800.4006 702.5073,-749.3807 902.4844,-594.8472 973.6749,-539.8343 1070.0601,-495.0815 1122.1705,-472.9231"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="1123.8157,-476.0281 1131.6755,-468.9237 1121.1008,-469.576 1123.8157,-476.0281"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1048.8662,-2144.8527 902.357,-2144.8527 902.357,-2122.8418 1048.8662,-2122.8418 1048.8662,-2144.8527"/>
<text text-anchor="middle" x="975.6116" y="-2130.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-1366.8472C630.0044,-1392.1764 659.725,-1357.3316 685.3989,-1385.8472 777.025,-1487.6149 654.9406,-1572.1172 721.3989,-1691.8472 761.4661,-1764.0316 825.7903,-1736.0145 866.4844,-1807.8472 925.2886,-1911.6478 844.3381,-1969.6767 902.4844,-2073.8472 912.5877,-2091.9475 930.5064,-2106.7856 946.077,-2117.1778"/>
<polygon fill="#0066ff" stroke="#0066ff" points="944.5777,-2120.3716 954.8966,-2122.7739 948.3281,-2114.461 944.5777,-2120.3716"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1216.4895,-1192.8527 1102.1597,-1192.8527 1102.1597,-1170.8418 1216.4895,-1170.8418 1216.4895,-1192.8527"/>
<text text-anchor="middle" x="1159.3246" y="-1178.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M601.1821,-1290.8472C640.0057,-1293.584 655.1544,-1290.3517 685.3989,-1314.8472 711.9727,-1336.3698 700.0232,-1356.1553 721.3989,-1382.8472 747.9105,-1415.9522 752.3445,-1453.1227 793.9417,-1444.8472"/>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M793.9417,-1444.8472C879.7822,-1427.7698 894.9003,-1402.6989 975.6116,-1368.8472"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M601.1821,-1290.8472C639.9986,-1293.6825 659.5115,-1285.7852 685.3989,-1314.8472 751.3003,-1388.8304 657.5287,-1459.1037 721.3989,-1534.8472 728.9042,-1543.7477 739.74,-1549.4848 750.7575,-1553.181"/>
<polygon fill="#1400ff" stroke="#1400ff" points="749.8307,-1556.5562 760.4072,-1555.9321 751.75,-1549.8244 749.8307,-1556.5562"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M448.281,-1296.6263C460.8164,-1300.291 472.9855,-1306.4837 480.9653,-1316.8472 545.4097,-1400.5425 450.5977,-2184.6687 516.9653,-2266.8472 565.5076,-2326.9539 624.5467,-2262.243 685.3989,-2309.8472 712.0239,-2330.6758 694.7953,-2355.9915 721.3989,-2376.8472 798.9037,-2437.6065 1486.014,-2567.6182 1579.7417,-2597.8472 1615.8195,-2609.483 1867.2569,-2699.0982 1897.5798,-2721.8472 1925.2886,-2742.6351 1947.9061,-2776.4314 1960.5078,-2797.88"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="1957.584,-2799.8185 1965.5753,-2806.7748 1963.6662,-2796.3534 1957.584,-2799.8185"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1734.495,-2030.8527 1615.8239,-2030.8527 1615.8239,-2008.8418 1734.495,-2008.8418 1734.495,-2030.8527"/>
<text text-anchor="middle" x="1675.1594" y="-2016.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M601.1821,-1290.8472C739.8855,-1291.1722 644.0086,-1117.9536 721.3989,-1002.8472 784.7148,-908.6744 805.7265,-882.1375 902.4844,-822.8472 960.817,-787.1028 999.83,-822.6834 1048.7388,-774.8472 1083.107,-741.2327 1045.4941,-700.6135 1084.7388,-672.8472 1210.3172,-583.9986 1329.9191,-652.54 1413.2476,-781.8472 1485.5128,-893.9868 1366.4794,-975.2195 1449.2476,-1079.8472 1468.4173,-1104.0799 1502.1281,-1075.5317 1514.4946,-1103.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1514.4946,-1103.8472C1591.4645,-1272.6703 1659.7299,-1876.6873 1672.8798,-1998.3891"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1669.4316,-1999.0607 1673.9787,-2008.6302 1676.3917,-1998.3138 1669.4316,-1999.0607"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M448.0952,-1292.0444C489.0265,-1292.1034 548.9141,-1291.9447 601.1821,-1290.8472"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1025.7389,-2064.8527 925.4843,-2064.8527 925.4843,-2042.8418 1025.7389,-2042.8418 1025.7389,-2064.8527"/>
<text text-anchor="middle" x="975.6116" y="-2050.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M601.1821,-1366.8472C630.6096,-1391.4707 658.793,-1358.1992 685.3989,-1385.8472 746.2057,-1449.0359 686.3167,-1499.4762 721.3989,-1579.8472 764.614,-1678.85 822.4749,-1676.195 866.4844,-1774.8472 899.3673,-1848.5581 870.0811,-1878.9243 902.4844,-1952.8472 916.3387,-1984.4537 941.294,-2015.8605 958.1533,-2035.0609"/>
<polygon fill="#ff007a" stroke="#ff007a" points="955.7615,-2037.6362 965.0438,-2042.744 960.9728,-2032.9625 955.7615,-2037.6362"/>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M448.2874,-1299.7768C492.7123,-1309.1377 557.6087,-1328.5548 601.1821,-1366.8472"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M448.1087,-1296.7607C460.6414,-1300.4276 472.8522,-1306.5878 480.9653,-1316.8472 558.8658,-1415.3559 457.1812,-1770.4013 516.9653,-1880.8472 528.119,-1901.4526 549.2507,-1917.2299 567.5552,-1927.8422"/>
<polygon fill="#ff003d" stroke="#ff003d" points="566.0799,-1931.0252 576.5289,-1932.7771 569.4531,-1924.8915 566.0799,-1931.0252"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1409.9767,-1153.8527 1273.1812,-1153.8527 1273.1812,-1131.8418 1409.9767,-1131.8418 1409.9767,-1153.8527"/>
<text text-anchor="middle" x="1341.579" y="-1139.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1290.8472C857.4495,-1304.6 904.0219,-1168.9747 1159.3246,-1142.8472"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1215.1414,-812.8527 1103.5078,-812.8527 1103.5078,-790.8418 1215.1414,-790.8418 1215.1414,-812.8527"/>
<text text-anchor="middle" x="1159.3246" y="-798.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-1290.8472C681.6562,-1296.5201 662.6998,-1210.1887 721.3989,-1154.8472 795.8162,-1084.6867 812.2939,-1061.077 902.4844,-1012.8472 932.6488,-996.7166 946.2335,-1006.3693 975.6116,-988.8472"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1416.8527 532.6734,-1416.8527 532.6734,-1394.8418 669.6908,-1394.8418 669.6908,-1416.8527"/>
<text text-anchor="middle" x="601.1821" y="-1402.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M447.9818,-1300.2087C459.6541,-1303.8983 471.4682,-1309.2085 480.9653,-1316.8472 506.3958,-1337.3015 491.4556,-1360.4919 516.9653,-1380.8472 521.7004,-1384.6255 526.9934,-1387.8332 532.5572,-1390.5564"/>
<polygon fill="#ff0000" stroke="#ff0000" points="531.5582,-1393.9377 542.1258,-1394.6971 534.3383,-1387.5134 531.5582,-1393.9377"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M447.8949,-1296.4706C460.5815,-1300.1184 472.9272,-1306.3411 480.9653,-1316.8472 557.6342,-1417.0565 458.6872,-2339.9381 516.9653,-2451.8472 560.1459,-2534.7651 630.8962,-2501.8908 685.3989,-2577.8472 715.3884,-2619.6414 680.4467,-2656.7179 721.3989,-2687.8472 797.4033,-2745.6211 1484.7073,-2717.7395 1579.7417,-2726.8472 1622.4081,-2730.9362 1632.4156,-2737.6681 1675.1594,-2740.8472"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1568.2203,-1647.8527 1460.7689,-1647.8527 1460.7689,-1625.8418 1568.2203,-1625.8418 1568.2203,-1647.8527"/>
<text text-anchor="middle" x="1514.4946" y="-1633.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1290.8472C640.9115,-1291.4259 658.5518,-1291.5558 685.3989,-1320.8472 728.2275,-1367.5751 676.6172,-1413.9877 721.3989,-1458.8472 827.6707,-1565.3036 914.7727,-1476.4386 1048.7388,-1544.8472 1143.5653,-1593.2696 1151.914,-1628.9254 1233.9104,-1696.8472 1281.941,-1736.6335 1279.2956,-1790.1116 1341.579,-1786.8472"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1572.6292,-999.8559C1609.1905,-1010.1623 1653.4251,-1029.6501 1675.1594,-1065.8472"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1971.3926,-2286.8472C2026.894,-2294.9563 2072.2017,-2236.8346 2097.5966,-2286.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M825.7966,-2312.8066C908.3251,-2284.3729 1125.0462,-2210.8472 1159.3246,-2210.8472 1159.3246,-2210.8472 1159.3246,-2210.8472 1675.1594,-2210.8472 1811.0825,-2210.8472 1836.8975,-2267.1967 1971.3926,-2286.8472"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="844.0946,-2678.8527 743.7887,-2678.8527 743.7887,-2656.8418 844.0946,-2656.8418 844.0946,-2678.8527"/>
<text text-anchor="middle" x="793.9417" y="-2664.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1971.3926,-3235.8472C2027.0287,-3242.9875 2048.7167,-3207.3314 2097.5966,-3234.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M818.8847,-2678.9452C928.1504,-2727.6856 1375.1357,-2928.3712 1734.5771,-3108.8472 1841.3098,-3162.4378 1852.9329,-3220.6444 1971.3926,-3235.8472"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M975.6116,-2666.8472C1215.0773,-2662.4957 1274.9934,-2666.2323 1514.4946,-2664.8472"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1514.4946,-2664.8472C1565.081,-2664.701 1569.7428,-2633.8973 1615.7417,-2612.8472 1641.6395,-2600.9959 1646.8705,-2592.1471 1675.1594,-2588.8472"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1159.3246,-2590.8472C1191.5464,-2577.6411 1202.2683,-2581.3878 1233.9104,-2566.8472 1318.8733,-2527.804 1343.2892,-2518.8868 1413.2476,-2456.8472 1461.0813,-2414.4279 1719.2168,-2043.9208 1770.5771,-2005.8472 1775.6366,-2002.0967 1781.3328,-1998.8257 1787.1832,-1995.997"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1788.7013,-1999.1528 1796.4343,-1991.9105 1785.8727,-1992.7497 1788.7013,-1999.1528"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M811.3609,-2656.7247C843.3726,-2636.2845 911.7188,-2592.6441 949.3738,-2568.6006"/>
<polygon fill="#00ff66" stroke="#00ff66" points="951.7003,-2571.2678 958.245,-2562.9361 947.933,-2565.3679 951.7003,-2571.2678"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M804.2135,-2656.6335C819.9224,-2638.8929 849.8399,-2602.6777 866.4844,-2566.8472 935.5006,-2418.2766 964.9333,-2219.9534 973.1058,-2155.2418"/>
<polygon fill="#0066ff" stroke="#0066ff" points="976.6098,-2155.4217 974.3519,-2145.0703 969.6618,-2154.5705 976.6098,-2155.4217"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M1834.0785,-2951.8472C1891.1146,-2928.6292 1937.3844,-2869.0612 1958.6921,-2837.7537"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="1961.8767,-2839.2844 1964.4878,-2829.0164 1956.0434,-2835.415 1961.8767,-2839.2844"/>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M975.6116,-2666.8472C1176.1857,-2680.0568 1647.9044,-3027.6343 1834.0785,-2951.8472"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1159.3246,-2590.8472C1192.6037,-2580.5928 1205.6759,-2587.2302 1233.9104,-2566.8472 1466.9676,-2398.5992 1390.2171,-2223.0654 1615.7417,-2044.8472 1620.3543,-2041.2022 1625.5758,-2038.0004 1630.9621,-2035.2134"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1632.5472,-2038.3357 1640.104,-2030.9097 1629.5657,-2032.0024 1632.5472,-2038.3357"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M975.6116,-2666.8472C1063.7817,-2672.654 1077.564,-2624.357 1159.3246,-2590.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M844.1213,-2665.6539C880.6313,-2664.5249 931.2357,-2663.9247 975.6116,-2666.8472"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1514.4946,-2664.8472C1593.4859,-2664.3904 1596.3911,-2734.8981 1675.1594,-2740.8472"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2149.8793,-3284.8527 2045.3139,-3284.8527 2045.3139,-3262.8418 2149.8793,-3262.8418 2149.8793,-3284.8527"/>
<text text-anchor="middle" x="2097.5966" y="-3270.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2147.2291,-3262.7757C2167.7097,-3258.2071 2191.6166,-3252.8742 2213.0192,-3248.0999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2213.9778,-3251.4722 2222.9759,-3245.8789 2212.4537,-3244.6401 2213.9778,-3251.4722"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1897.0072,-1978.0999C1928.0474,-1980.6722 1961.0286,-1990.6547 1971.3926,-2019.8472"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1343.9593,-813.1274C1354.2632,-858.4965 1399.7872,-1027.0685 1514.4946,-1065.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1514.4946,-1065.8472C1582.1402,-1088.7159 1638.4011,-1004.6286 1675.1594,-1065.8472"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M994.8937,-2540.6888C1095.1928,-2483.9322 1568.1074,-2232.0745 1971.3926,-2286.8472"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1024.8575,-2554.9321C1076.9861,-2558.5898 1161.5615,-2565.6431 1233.9104,-2576.8472 1389.241,-2600.9022 1440.5763,-2577.7773 1579.7417,-2650.8472 1631.3556,-2677.9476 1617.0289,-2736.4568 1675.1594,-2740.8472"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640.4201,-276.8527 561.9441,-276.8527 561.9441,-254.8418 640.4201,-254.8418 640.4201,-276.8527"/>
<text text-anchor="middle" x="601.1821" y="-262.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M623.1591,-254.7114C642.1415,-244.0501 669.0251,-226.2869 685.3989,-203.8472 714.9743,-163.3154 683.7081,-129.9672 721.3989,-96.8472 752.3149,-69.6806 1043.7794,-28.8665 1084.7388,-24.8472 1150.7204,-18.3727 1167.7504,-20.5639 1233.9104,-24.8472 1282.0651,-27.9649 1293.5781,-33.8964 1341.579,-38.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-38.8472C1608.0036,-44.6917 1726.3427,-137.1071 1834.0785,-380.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2097.5966,-2286.8472C2184.9426,-2458.8668 2256.7641,-3089.943 2270.1797,-3213.7067"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2266.7143,-3214.217 2271.2641,-3223.7851 2273.6742,-3213.4681 2266.7143,-3214.217"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1971.3926,-2019.8472C2015.3058,-2143.5387 2038.1712,-2169.8149 2097.5966,-2286.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1834.0785,-380.8472C2014.4341,-698.7478 1849.1102,-1675.4115 1971.3926,-2019.8472"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M640.4293,-263.8854C679.4604,-262.4433 740.9961,-261.5449 793.9417,-266.8472"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-1065.8472C1418.0248,-1057.9626 1441.691,-1041.2348 1514.4946,-1065.8472"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1159.3246,-1103.8472C1240.4877,-1087.7508 1259.2717,-1074.3365 1341.579,-1065.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1341.579,-1065.8472C1368.6453,-1063.0556 1561.2321,-1028.7914 1579.7417,-1008.8472 1670.0895,-911.4973 1548.9581,-377.4594 1675.1594,-418.8472"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M1030.821,-1109.4096C1067.5871,-1111.7581 1116.7766,-1112.2855 1159.3246,-1103.8472"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M1159.3246,-1103.8472C1193.6185,-1097.046 1208.6109,-1102.9774 1233.9104,-1078.8472 1309.7538,-1006.5096 1333.0265,-874.56 1339.4039,-823.1502"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1342.9139,-823.2622 1340.5764,-812.9285 1335.9595,-822.4644 1342.9139,-823.2622"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M1031.055,-1093.0258C1037.8904,-1089.531 1044.0928,-1084.922 1048.7388,-1078.8472 1124.2249,-980.1465 1028.8059,-631.8045 1084.7388,-520.8472 1094.5884,-501.308 1113.4707,-485.4546 1129.7712,-474.5384"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="1131.9313,-477.3124 1138.4876,-468.9898 1128.1723,-471.4073 1131.9313,-477.3124"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M996.5728,-1115.0291C1018.2776,-1126.3682 1053.3467,-1144.0252 1084.7388,-1156.8472 1094.0314,-1160.6428 1104.1362,-1164.3197 1113.8209,-1167.6331"/>
<polygon fill="#0028ff" stroke="#0028ff" points="1112.726,-1170.9574 1123.3199,-1170.8164 1114.9503,-1164.3202 1112.726,-1170.9574"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1341.579,-1065.8472C1361.1465,-1063.829 1506.6215,-1085.8202 1514.4946,-1103.8472"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-1103.8472C1185.0702,-1098.7413 1251.377,-1115.7689 1296.4976,-1128.9278"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1295.7629,-1132.3602 1306.3447,-1131.8359 1297.7455,-1125.6469 1295.7629,-1132.3602"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1026.8113,-1092.7382C1034.8338,-1089.2851 1042.5157,-1084.7641 1048.7388,-1078.8472 1124.9681,-1006.3681 1149.8511,-874.5016 1156.8771,-823.1321"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1160.3863,-823.281 1158.1793,-812.9187 1153.4425,-822.3957 1160.3863,-823.281"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-1103.8472C1199.0518,-1095.9684 1318.834,-1070.3362 1341.579,-1103.8472"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1413.4165,-506.8527 1269.7414,-506.8527 1269.7414,-484.8418 1413.4165,-484.8418 1413.4165,-506.8527"/>
<text text-anchor="middle" x="1341.579" y="-492.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1834.0785,-2019.8472C1886.2584,-2051.4974 1950.9747,-1962.3356 1971.3926,-2019.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1390.3243,-506.987C1398.6171,-510.4486 1406.6638,-514.9645 1413.2476,-520.8472 1613.6461,-699.9064 1536.8181,-835.4487 1675.1594,-1065.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.1594,-1065.8472C1928.0199,-1398.3324 1504.4023,-1678.9221 1770.5771,-2000.8472 1789.349,-2023.5509 1808.8907,-2004.5694 1834.0785,-2019.8472"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M1394.0712,-506.9556C1401.2901,-510.4047 1408.0096,-514.9245 1413.2476,-520.8472 1473.7341,-589.2425 1504.9643,-884.8482 1512.6105,-967.3765"/>
<polygon fill="#fff400" stroke="#fff400" points="1509.1452,-967.9184 1513.5335,-977.5617 1516.1166,-967.2866 1509.1452,-967.9184"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1345.161,-506.8661C1357.2716,-544.6666 1396.8447,-672.7634 1413.2476,-781.8472 1458.1843,-1080.6892 1388.0274,-1164.9116 1449.2476,-1460.8472 1461.3401,-1519.3023 1489.5329,-1584.2138 1504.5944,-1616.4141"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1501.5371,-1618.1354 1508.986,-1625.6697 1507.8613,-1615.1347 1501.5371,-1618.1354"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1168.178,-446.6495C1185.2375,-426.0908 1224.9736,-382.9593 1269.9104,-366.8472 1310.3821,-352.3361 1599.0242,-376.3611 1675.1594,-380.8472"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1180.3214,-446.7228C1214.4688,-430.1068 1284.013,-402.4281 1341.579,-418.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1341.579,-418.8472C1415.483,-439.9264 1437.6432,-418.8472 1514.4946,-418.8472"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1341.579,-418.8472C1450.1513,-424.8368 1528.4338,-725.8803 1579.7417,-968.8472 1623.5615,-1176.3548 1666.1614,-1868.0974 1673.9101,-1998.534"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1670.4318,-1999.0054 1674.5156,-2008.7816 1677.4196,-1998.5925 1670.4318,-1999.0054"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1011.418,-2144.9254C1048.1227,-2155.454 1107.0661,-2170.0816 1159.3246,-2172.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-2172.8472C1393.7883,-2185.2558 1442.0652,-2087.0307 1675.1594,-2058.8472"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1011.765,-2122.7569C1063.1177,-2106.217 1159.2357,-2072.3191 1233.9104,-2028.8472 1286.6,-1998.174 1281.9764,-1956.6758 1341.579,-1943.8472"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M998.185,-2144.8545C1097.3968,-2193.6105 1493.6059,-2392.3915 1579.7417,-2498.8472 1610.5085,-2536.8722 1582.0416,-2567.3959 1615.7417,-2602.8472 1635.3644,-2623.4896 1656.4662,-2605.3597 1675.1594,-2626.8472"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1514.4946,-1219.8472C1608.1527,-1188.0399 1615.2838,-987.117 1675.1594,-1065.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-1181.8472C1359.9911,-1188.7722 1495.8682,-1226.173 1514.4946,-1219.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1216.5985,-1171.7232C1253.4596,-1167.6264 1301.7455,-1166.8656 1341.579,-1181.8472"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M1177.1035,-1170.7065C1193.9298,-1159.3193 1218.7995,-1140.173 1233.9104,-1117.8472 1268.2345,-1067.1348 1319.2537,-884.8358 1336.0197,-822.7366"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1339.4464,-823.471 1338.6581,-812.9055 1332.6856,-821.6565 1339.4464,-823.471"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1341.579,-1181.8472C1373.02,-1193.6724 1388.6259,-1182.9968 1413.2476,-1205.8472 1498.4047,-1284.8785 1449.3588,-1350.6443 1514.4946,-1446.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1514.4946,-1446.8472C1640.9222,-1633.5757 1668.557,-1918.4239 1673.9569,-1998.3401"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1670.4817,-1998.8469 1674.6014,-2008.6079 1677.468,-1998.4083 1670.4817,-1998.8469"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1211.0639,-1170.7757C1232.5104,-1166.1865 1257.5612,-1160.8259 1279.9494,-1156.0352"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.9798,-1159.394 1290.026,-1153.8789 1279.515,-1152.5489 1280.9798,-1159.394"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-1786.8472C1419.077,-1781.6892 1479.0258,-1696.9835 1503.0529,-1657.1941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1506.3342,-1658.5178 1508.3764,-1648.1216 1500.2968,-1654.9752 1506.3342,-1658.5178"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.0237,-1192.9059C1182.1847,-1275.2057 1309.3582,-1788.9918 1341.579,-1786.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-1219.8472C1394.7412,-1164.3502 1441.7252,-1244.5605 1514.4946,-1219.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1675.1594,-2096.8472C1985.5909,-2207.6905 2077.7464,-2689.7253 2094.5484,-2796.7464"/>
<polygon fill="#ff3d00" stroke="#ff3d00" points="2091.0931,-2797.3057 2096.0554,-2806.6665 2098.0137,-2796.2542 2091.0931,-2797.3057"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M975.6116,-1672.8472C1006.8716,-1683.7027 1019.711,-1670.9596 1048.7388,-1686.8472 1069.1464,-1698.0169 1066.7569,-1710.0862 1084.7388,-1724.8472 1218.1254,-1834.3422 1269.397,-1836.5155 1413.2476,-1931.8472 1458.9546,-1962.1379 1567.5181,-2046.7484 1615.7417,-2072.8472 1640.7895,-2086.4032 1652.4848,-2079.6131 1675.1594,-2096.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M1341.579,-1219.8472C1364.1695,-1194.9868 1390.4411,-1220.5097 1413.2476,-1195.8472 1458.0371,-1147.4128 1416.2428,-1108.9671 1449.2476,-1051.8472 1459.5553,-1034.0082 1476.3709,-1017.9469 1490.3492,-1006.5062"/>
<polygon fill="#fff400" stroke="#fff400" points="1492.9125,-1008.9426 1498.6025,-1000.0054 1488.581,-1003.4436 1492.9125,-1008.9426"/>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M975.6116,-1558.8472C1086.6456,-1518.7265 1144.9828,-1574.5011 1233.9104,-1496.8472 1283.6558,-1453.4082 1297.1649,-1268.7241 1341.579,-1219.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M975.6116,-1064.8472C1025.0674,-999.8789 1085.137,-1098.9494 1159.3246,-1064.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M798.0081,-1571.0374C810.4288,-1605.6936 848.1385,-1714.5309 866.4844,-1807.8472 896.3091,-1959.5512 880.4979,-2000.8106 902.4844,-2153.8472 923.3207,-2298.8786 958.7421,-2471.7564 971.1549,-2530.8503"/>
<polygon fill="#00ff66" stroke="#00ff66" points="967.7693,-2531.758 973.2582,-2540.8202 974.6186,-2530.3131 967.7693,-2531.758"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M801.6475,-1548.5646C816.8741,-1525.6497 850.7049,-1471.5279 866.4844,-1420.8472 885.9203,-1358.4228 861.2709,-1179.6017 902.4844,-1128.8472 905.1961,-1125.5077 908.3757,-1122.6126 911.8634,-1120.1028"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="913.7188,-1123.0712 920.4852,-1114.9186 910.1116,-1117.0722 913.7188,-1123.0712"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M794.7138,-1548.7426C801.254,-1455.9887 848.4574,-811.8827 902.4844,-746.8472 946.2006,-694.2235 1003.2889,-749.9811 1048.7388,-698.8472 1102.3599,-638.5203 1043.624,-590.3033 1084.7388,-520.8472 1096.0308,-501.7714 1115.251,-485.744 1131.3519,-474.6288"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="1133.4961,-477.407 1139.9058,-468.971 1129.6343,-471.5686 1133.4961,-477.407"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M798.7282,-1571.2598C811.8108,-1602.9447 848.3935,-1694.9301 866.4844,-1774.8472 896.0361,-1905.3928 838.1078,-1956.4969 902.4844,-2073.8472 912.4544,-2092.0213 930.3712,-2106.8603 945.9743,-2117.2347"/>
<polygon fill="#0066ff" stroke="#0066ff" points="944.4922,-2120.4382 954.8162,-2122.8185 948.2299,-2114.5196 944.4922,-2120.4382"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M827.5951,-1566.2114C864.974,-1571.8072 926.5188,-1576.5863 975.6116,-1558.8472"/>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M975.6116,-1558.8472C1123.1583,-1505.5331 1152.4778,-1274.8842 1158.0632,-1203.1924"/>
<polygon fill="#0028ff" stroke="#0028ff" points="1161.5625,-1203.3228 1158.7703,-1193.1026 1154.5796,-1202.8334 1161.5625,-1203.3228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M827.5643,-1560.2189C841.1098,-1562.0164 855.9806,-1566.3115 866.4844,-1575.8472 904.8838,-1610.7078 871.1293,-1645.5358 902.4844,-1686.8472 1067.204,-1903.8715 1198.7755,-1857.818 1413.2476,-2025.8472 1492.3568,-2087.8258 1512.7341,-2103.95 1579.7417,-2178.8472 1739.1539,-2357.0288 1785.3018,-2401.7677 1897.5798,-2612.8472 1931.3715,-2676.3746 1955.6994,-2758.6805 1965.9703,-2796.7823"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="1962.6561,-2797.9401 1968.5965,-2806.7129 1969.4234,-2796.1504 1962.6561,-2797.9401"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M827.6593,-1563.6229C840.3248,-1565.9668 854.5373,-1569.7506 866.4844,-1575.8472 924.2849,-1605.3432 914.582,-1650.795 975.6116,-1672.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M975.6116,-1672.8472C1219.8684,-1761.1061 1368.8868,-1231.7905 1514.4946,-1446.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M827.4551,-1563.3873C841.6607,-1566.6659 857.0753,-1572.9273 866.4844,-1584.8472 917.3947,-1649.3433 873.3776,-1876.0071 902.4844,-1952.8472 914.6965,-1985.0866 940.0132,-2016.2998 957.4047,-2035.2878"/>
<polygon fill="#ff007a" stroke="#ff007a" points="954.9153,-2037.7497 964.3118,-2042.6444 960.0185,-2032.9583 954.9153,-2037.7497"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-1558.8472C1058.714,-1528.8192 1088.5218,-1535.7118 1159.3246,-1482.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M801.7177,-1548.5861C817.0705,-1525.71 851.1172,-1471.6544 866.4844,-1420.8472 888.2887,-1348.7576 853.3054,-1140.8891 902.4844,-1083.8472 924.4114,-1058.4144 955.272,-1091.5666 975.6116,-1064.8472"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M975.6116,-1064.8472C1001.4207,-1030.9428 1021.7716,-1035.8381 1048.7388,-1002.8472 1096.8936,-943.9361 1134.7611,-861.0158 1150.8784,-822.7265"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1154.2446,-823.7457 1154.8381,-813.1675 1147.7775,-821.0668 1154.2446,-823.7457"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.1594,-2626.8472C1713.5358,-2669.3685 1770.0806,-2705.6553 1804.3569,-2725.5462"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1802.9813,-2728.7913 1813.4004,-2730.7133 1806.454,-2722.7134 1802.9813,-2728.7913"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.3976,-1559.1396C841.4155,-1560.6668 856.6967,-1565.0496 866.4844,-1575.8472 956.9706,-1675.6707 817.1021,-1772.6246 902.4844,-1876.8472 945.8394,-1929.769 984.5509,-1901.1771 1048.7388,-1924.8472 1132.205,-1955.6266 1161.5042,-1949.1624 1233.9104,-2000.8472 1423.5513,-2136.2163 1479.2603,-2184.6284 1579.7417,-2394.8472 1620.2013,-2479.4935 1556.8113,-2529.846 1615.7417,-2602.8472 1633.6313,-2625.0084 1656.0773,-2605.7042 1675.1594,-2626.8472"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-1710.8472C1193.0732,-1719.4311 1201.5794,-1721.9106 1233.9104,-1734.8472 1283.2487,-1754.5891 1288.5549,-1790.3764 1341.579,-1786.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-1672.8472C1054.028,-1701.182 1078.5188,-1690.2946 1159.3246,-1710.8472"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1233.9963,-88.8527 1084.6529,-88.8527 1084.6529,-66.8418 1233.9963,-66.8418 1233.9963,-88.8527"/>
<text text-anchor="middle" x="1159.3246" y="-74.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.1594,-380.8472C1745.5961,-386.0791 1805.524,-316.2459 1834.0785,-380.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1184.1668,-88.9156C1199.5334,-96.5138 1219.086,-107.6027 1233.9104,-120.8472 1294.0348,-174.5641 1282.6709,-211.7992 1341.579,-266.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-266.8472C1366.1221,-289.7821 1382.2923,-277.8033 1413.2476,-290.8472 1459.8645,-310.4907 1467.4701,-324.2005 1514.4946,-342.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1514.4946,-342.8472C1548.5995,-356.371 1638.5719,-378.1296 1675.1594,-380.8472"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1514.4946,-342.8472C1561.5191,-361.494 1569.7428,-373.7972 1615.7417,-394.8472 1641.6395,-406.6986 1648.0968,-409.972 1675.1594,-418.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1675.1594,-418.8472C1752.2989,-444.1452 1823.5083,-1775.3872 1833.0063,-1959.7522"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1829.514,-1959.994 1833.5212,-1969.8017 1836.5048,-1959.6357 1829.514,-1959.994"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1341.579,-266.8472C1366.6191,-289.2384 1390.4003,-266.2226 1413.2476,-290.8472 1457.5309,-338.5756 1413.1609,-378.6553 1449.2476,-432.8472 1489.4488,-493.2181 1545.2661,-467.0333 1579.7417,-530.8472 1580.8859,-532.9651 1662.3041,-1817.0141 1673.8128,-1998.5966"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1670.3297,-1998.9762 1674.4553,-2008.7347 1677.3157,-1998.5334 1670.3297,-1998.9762"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2097.5966,-3234.8472C2134.5874,-3255.6704 2183.3393,-3253.7424 2219.9628,-3247.7065"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2220.7282,-3251.1251 2229.951,-3245.9106 2219.4895,-3244.2355 2220.7282,-3251.1251"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1972.7382,-2828.9585C1980.5096,-2890.8961 2021.9616,-3192.2702 2097.5966,-3234.8472"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M2009.2579,-2817.8472C2020.0399,-2817.8472 2031.9988,-2817.8472 2043.5448,-2817.8472"/>
<polygon fill="#ff3d00" stroke="#ff3d00" points="2043.5452,-2821.3473 2053.5451,-2817.8472 2043.5451,-2814.3473 2043.5452,-2821.3473"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#51ff00" stroke-dasharray="5,2" d="M1971.9327,-2828.9054C1975.0802,-2889.3438 1992.7671,-3179.5224 2045.2053,-3248.8472 2047.6325,-3252.0561 2050.5768,-3254.872 2053.8178,-3257.3397"/>
<polygon fill="#51ff00" stroke="#51ff00" points="2052.0455,-3260.3605 2062.3601,-3262.7814 2055.8065,-3254.4567 2052.0455,-3260.3605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1359.8527 -.2403,-1359.8527 -.2403,-1337.8418 130.719,-1337.8418 130.719,-1359.8527"/>
<text text-anchor="middle" x="65.2394" y="-1345.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1971.3926,-3312.8472C2050.9103,-3305.8659 2073.2182,-3315.7158 2149.9878,-3293.8472 2184.647,-3283.9742 2221.5309,-3264.8823 2245.6492,-3251.0853"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2247.6642,-3253.9621 2254.5439,-3245.9047 2244.1412,-3247.9132 2247.6642,-3253.9621"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2669.8472C443.3253,-2658.4234 493.7918,-2648.6817 533.227,-2641.7917"/>
<polygon fill="#ff0000" stroke="#ff0000" points="534.0049,-2645.2093 543.2632,-2640.0581 532.8133,-2638.3114 534.0049,-2645.2093"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2745.8472C287.3067,-2802.2317 316.885,-2691.0723 399.0839,-2669.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1971.3926,-3140.8472C2027.4838,-3109.4078 2077.8369,-2905.5506 2092.975,-2838.8984"/>
<polygon fill="#ff3d00" stroke="#ff3d00" points="2096.4002,-2839.6191 2095.1707,-2829.0959 2089.5695,-2838.089 2096.4002,-2839.6191"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M601.1821,-3160.8472C711.5815,-3202.7276 748.6767,-3154.8056 866.4844,-3146.8472 1183.4822,-3125.433 1262.4746,-3081.8843 1579.7417,-3098.8472 1601.5936,-3100.0156 1952.3035,-3151.5468 1971.3926,-3140.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M223.8406,-2745.8472C266.9274,-2784.1263 267.5243,-2806.6266 317.2024,-2835.8472 326.9131,-2841.5591 338.0515,-2846.0802 348.921,-2849.6149"/>
<polygon fill="#ff7a00" stroke="#ff7a00" points="348.1941,-2853.0514 358.7789,-2852.5897 350.2164,-2846.3499 348.1941,-2853.0514"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M223.8406,-1026.8472C269.2534,-988.5352 362.3432,-1202.3882 390.7008,-1271.1139"/>
<polygon fill="#ffb700" stroke="#ffb700" points="387.5139,-1272.5678 394.541,-1280.4969 393.9924,-1269.9163 387.5139,-1272.5678"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M793.9417,-38.8472C892.651,-4.7878 1157.2321,-132.9669 1233.9104,-203.8472 1261.6515,-229.4908 1247.1239,-250.7153 1269.9104,-280.8472 1320.7188,-348.0344 1371.7855,-331.5225 1413.2476,-404.8472 1469.7703,-504.8065 1504.6938,-874.3697 1512.7171,-967.4547"/>
<polygon fill="#fff400" stroke="#fff400" points="1509.2466,-967.9516 1513.5802,-977.6196 1516.2215,-967.3593 1509.2466,-967.9516"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M601.1821,-2669.8472C635.9267,-2653.5653 657.0855,-2676.7439 685.3989,-2650.8472 723.9807,-2615.5588 705.0406,-2588.5084 721.3989,-2538.8472 744.9442,-2467.3677 773.7462,-2382.8409 786.8473,-2344.5455"/>
<polygon fill="#cbff00" stroke="#cbff00" points="790.1809,-2345.6141 790.1087,-2335.0195 783.5582,-2343.3467 790.1809,-2345.6141"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-2669.8472C486.0528,-2647.3905 519.8484,-2707.9618 601.1821,-2669.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M223.8406,-2745.8472C287.3067,-2802.2317 315.2592,-2808.4092 399.0839,-2821.8472"/>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M601.1821,-2745.8472C638.5899,-2735.1041 649.1077,-2735.908 685.3989,-2721.8472 713.4364,-2710.9844 743.9832,-2695.4291 765.5075,-2683.8014"/>
<polygon fill="#8eff00" stroke="#8eff00" points="767.3352,-2686.7912 774.433,-2678.9253 763.9792,-2680.6481 767.3352,-2686.7912"/>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M399.0839,-2821.8472C493.8367,-2837.0372 508.9477,-2772.3359 601.1821,-2745.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#51ff00" stroke-dasharray="5,2" d="M1971.3926,-3312.8472C2003.69,-3310.3668 2038.7678,-3298.7505 2063.7253,-3288.8351"/>
<polygon fill="#51ff00" stroke="#51ff00" points="2065.1679,-3292.0266 2073.099,-3285.0017 2062.5182,-3285.5474 2065.1679,-3292.0266"/>
<path fill="none" stroke="#51ff00" stroke-dasharray="5,2" d="M223.8406,-2745.8472C336.0774,-2848.9771 241.2469,-2943.6972 317.2024,-3075.8472 399.1223,-3218.3745 436.7897,-3312.8472 601.1821,-3312.8472 601.1821,-3312.8472 601.1821,-3312.8472 1675.1594,-3312.8472 1806.8186,-3312.8472 1840.12,-3322.929 1971.3926,-3312.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M975.6116,-.8472C1093.173,-.8695 1126.1688,-10.8106 1233.9104,-57.8472 1482.0337,-166.1702 1601.4904,-169.0785 1734.5771,-404.8472 1814.6067,-546.623 1831.7872,-1782.145 1833.8493,-1959.6443"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1830.3509,-1959.8232 1833.9637,-1969.783 1837.3505,-1959.7441 1830.3509,-1959.8232"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M223.8406,-570.8472C284.634,-466.5862 240.6786,-409.1763 317.2024,-315.8472 344.2384,-282.8739 364.3199,-290.5384 399.0839,-265.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M793.9417,-38.8472C871.5807,-10.9776 893.1916,2.5417 975.6116,-.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M601.1821,-189.8472C675.9907,-168.7669 655.8044,-104.5374 721.3989,-62.8472 750.0598,-44.6311 761.9787,-50.3208 793.9417,-38.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M66.3182,-1337.5438C73.858,-1259.4837 119.7341,-799.652 166.4788,-667.8472 183.2198,-620.6428 198.6121,-614.1143 223.8406,-570.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M399.0839,-265.8472C477.321,-210.2794 508.8166,-215.875 601.1821,-189.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M601.1821,-189.8472C689.9773,-164.8256 702.1476,-257.6543 793.9417,-266.8472"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M793.9417,-266.8472C1002.6891,-287.7528 1091.8556,-283.468 1233.9104,-437.8472 1258.1036,-464.1394 1318.5744,-707.1071 1336.4965,-780.774"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1333.1521,-781.8344 1338.9095,-790.7283 1339.955,-780.1852 1333.1521,-781.8344"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M793.9417,-2552.8472C831.3535,-2518.4142 893.6879,-2526.9509 934.7209,-2537.9939"/>
<polygon fill="#00ff66" stroke="#00ff66" points="933.8341,-2541.3804 944.4104,-2540.7539 935.7518,-2534.6482 933.8341,-2541.3804"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M399.0839,-265.8472C444.9952,-233.2387 512.7756,-241.5177 556.9577,-252.2329"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="556.2755,-255.6711 566.8313,-254.763 558.0132,-248.8902 556.2755,-255.6711"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M399.0839,-570.8472C525.6663,-555.3215 574.979,-526.0381 685.3989,-589.8472 810.8223,-662.3266 813.2422,-726.127 866.4844,-860.8472 902.5775,-952.1749 839.0323,-1003.8987 902.4844,-1078.8472 905.3128,-1082.1881 908.6079,-1085.0834 912.2049,-1087.5926"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="910.6688,-1090.7488 921.0682,-1092.7743 914.2018,-1084.7057 910.6688,-1090.7488"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M601.1821,-189.8472C877.4216,-112.0054 1024.2419,-122.8709 1233.9104,-318.8472 1272.7271,-355.1291 1240.891,-388.339 1269.9104,-432.8472 1281.7851,-451.0601 1300.3207,-467.1567 1315.5665,-478.5202"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="1313.9246,-481.6503 1324.0876,-484.6441 1318.0098,-475.966 1313.9246,-481.6503"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M601.1821,-380.8472C653.6951,-353.868 808.1149,-357.9871 866.4844,-366.8472 891.5139,-370.6466 1041.0146,-419.0375 1116.2027,-443.6588"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="1115.2699,-447.0363 1125.8626,-446.8252 1117.4503,-440.3845 1115.2699,-447.0363"/>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M223.8406,-570.8472C263.0727,-503.5639 321.7773,-580.3292 399.0839,-570.8472"/>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M399.0839,-570.8472C480.8375,-560.8199 453.7145,-480.6065 516.9653,-427.8472 549.8815,-400.3909 561.6902,-397.5121 601.1821,-380.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M223.8406,-1026.8472C267.7035,-989.8427 429.4143,-1025.6325 480.9653,-1050.8472 551.0736,-1085.1387 524.066,-1166.8397 601.1821,-1178.8472"/>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M601.1821,-1178.8472C776.4637,-1205.1293 986.2005,-1195.3864 1091.6764,-1187.6805"/>
<polygon fill="#0028ff" stroke="#0028ff" points="1092.1502,-1191.1549 1101.8614,-1186.9189 1091.6282,-1184.1744 1092.1502,-1191.1549"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M223.8406,-1026.8472C325.7185,-940.899 218.8725,-1221.8615 317.2024,-1311.8472 344.7624,-1337.0686 368.5331,-1309.3456 399.0839,-1330.8472"/>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M399.0839,-1330.8472C503.4526,-1404.3022 589.964,-1268.1086 685.3989,-1352.8472 747.057,-1407.5948 667.2086,-1472.6988 721.3989,-1534.8472 728.9061,-1543.4568 739.5232,-1549.1036 750.3246,-1552.8065"/>
<polygon fill="#1400ff" stroke="#1400ff" points="749.6321,-1556.2503 760.2121,-1555.6898 751.5918,-1549.5302 749.6321,-1556.2503"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#5100ff" stroke-dasharray="5,2" d="M975.6116,-.8472C1037.2528,-.8589 1102.1172,-38.1821 1135.8343,-60.8542"/>
<polygon fill="#5100ff" stroke="#5100ff" points="1134.2691,-64.0261 1144.4897,-66.8172 1138.2404,-58.2616 1134.2691,-64.0261"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M601.1821,-3160.8472C1006.3265,-3321.3736 1164.7735,-3231.934 1579.7417,-3098.8472 1725.5564,-3052.0822 1785.7698,-3070.4771 1897.5798,-2965.8472 1935.6501,-2930.2218 1956.8506,-2870.6699 1965.9586,-2839.0606"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="1969.4125,-2839.7 1968.6838,-2829.1303 1962.662,-2837.8475 1969.4125,-2839.7"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1721.8527 180.0456,-1721.8527 180.0456,-1699.8418 267.6355,-1699.8418 267.6355,-1721.8527"/>
<text text-anchor="middle" x="223.8406" y="-1707.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M67.2613,-1359.8642C77.0321,-1412.0885 120.7608,-1634.3285 166.4788,-1685.8472 169.4801,-1689.2294 173.022,-1692.1727 176.8492,-1694.7304"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="175.1677,-1697.8006 185.5846,-1699.7343 178.6471,-1691.7266 175.1677,-1697.8006"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M223.8406,-2745.8472C263.0585,-2779.6035 639.0205,-2706.7944 685.3989,-2683.8472 705.6797,-2673.8127 701.6153,-2658.8295 721.3989,-2647.8472 851.982,-2575.358 922.0269,-2650.9088 1048.7388,-2571.8472 1287.952,-2422.5907 1212.4119,-2232.8485 1449.2476,-2079.8472 1496.2467,-2049.4847 1558.1538,-2034.4233 1605.2757,-2026.9885"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1606.0269,-2030.4151 1615.3979,-2025.4721 1604.9897,-2023.4924 1606.0269,-2030.4151"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M793.9417,-2552.8472C866.2886,-2486.2608 842.6662,-2439.244 866.4844,-2343.8472 891.5481,-2243.462 851.121,-2203.6647 902.4844,-2113.8472 912.7748,-2095.8527 930.6961,-2081.0161 946.2213,-2070.5982"/>
<polygon fill="#ff007a" stroke="#ff007a" points="948.4664,-2073.3173 955.0096,-2064.9844 944.6981,-2067.4181 948.4664,-2073.3173"/>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M601.1821,-2669.8472C635.9267,-2653.5653 655.3223,-2674.6734 685.3989,-2650.8472 714.0677,-2628.1364 693.8723,-2600.9297 721.3989,-2576.8472 746.9579,-2554.4863 768.9542,-2575.8451 793.9417,-2552.8472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M223.8406,-2745.8472C436.1076,-2934.4289 124.7581,-2322.6187 317.2024,-2113.8472 342.523,-2086.3784 369.2608,-2117.3474 399.0839,-2094.8472"/>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M65.62,-1360.0444C70.037,-1486.7384 113.4402,-2647.7657 223.8406,-2745.8472"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="866.5271,-2756.8527 721.3562,-2756.8527 721.3562,-2734.8418 866.5271,-2734.8418 866.5271,-2756.8527"/>
<text text-anchor="middle" x="793.9417" y="-2742.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2745.8472C636.3124,-2735.7582 676.5527,-2734.2779 711.1485,-2735.8971"/>
<polygon fill="#ff0000" stroke="#ff0000" points="711.0379,-2739.3963 721.2182,-2736.4619 711.43,-2732.4073 711.0379,-2739.3963"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-686.8472C1206.4714,-712.5137 1213.6922,-732.1199 1233.9104,-781.8472 1262.1938,-851.4113 1223.2221,-1059.0313 1269.9104,-1117.8472 1272.4643,-1121.0646 1275.4589,-1123.869 1278.7489,-1126.3135"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1277.1037,-1129.4108 1287.453,-1131.6783 1280.7766,-1123.4518 1277.1037,-1129.4108"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-380.8472C723.6359,-329.1741 767.8382,-429.7744 866.4844,-518.8472 932.0151,-578.0184 906.5534,-629.8338 975.6116,-684.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-684.8472C1042.4985,-731.684 1087.608,-647.8051 1159.3246,-686.8472"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-620.8527 554.5531,-620.8527 554.5531,-598.8418 647.8111,-598.8418 647.8111,-620.8527"/>
<text text-anchor="middle" x="601.1821" y="-606.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-570.8472C427.6204,-567.3471 500.1317,-583.6561 550.0605,-596.2542"/>
<polygon fill="#cbff00" stroke="#cbff00" points="549.4817,-599.7186 560.0365,-598.7975 551.211,-592.9355 549.4817,-599.7186"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-998.8527 353.1239,-998.8527 353.1239,-976.8418 445.0438,-976.8418 445.0438,-998.8527"/>
<text text-anchor="middle" x="399.0839" y="-984.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-1026.8472C256.722,-999.1071 305.0881,-989.9426 342.6834,-987.3872"/>
<polygon fill="#00ff66" stroke="#00ff66" points="343.1829,-990.8654 352.9798,-986.8317 342.8057,-983.8756 343.1829,-990.8654"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M975.6116,-684.8472C1026.7343,-725.5728 1092.5749,-764.6424 1129.9517,-785.7256"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1128.3794,-788.8565 1138.8147,-790.6883 1131.7993,-782.7488 1128.3794,-788.8565"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1682.8527 334.3841,-1682.8527 334.3841,-1660.8418 463.7837,-1660.8418 463.7837,-1682.8527"/>
<text text-anchor="middle" x="399.0839" y="-1668.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-1671.8472C239.088,-1684.2155 283.5026,-1684.1129 323.7997,-1680.9701"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="324.267,-1684.4431 333.9358,-1680.1113 323.6759,-1677.4681 324.267,-1684.4431"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M67.2492,-1360.1153C76.1418,-1406.5439 116.3758,-1584.6749 223.8406,-1671.8472"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-698.8527 168.8556,-698.8527 168.8556,-676.8418 278.8255,-676.8418 278.8255,-698.8527"/>
<text text-anchor="middle" x="223.8406" y="-684.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M67.9257,-1337.6517C86.3652,-1260.8015 194.2244,-811.278 218.8402,-708.6872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.2612,-709.4302 221.1911,-698.8895 215.4544,-707.7969 222.2612,-709.4302"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-698.8527 340.6161,-698.8527 340.6161,-676.8418 457.5516,-676.8418 457.5516,-698.8527"/>
<text text-anchor="middle" x="399.0839" y="-684.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M67.3562,-1337.7287C76.6711,-1291.8959 118.3396,-1115.8521 223.8406,-1026.8472"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1026.8472C336.4257,-931.8659 211.265,-811.1905 317.2024,-708.8472 321.2923,-704.8961 326.0202,-701.6599 331.0991,-699.0128"/>
<polygon fill="#00ffff" stroke="#00ffff" points="332.8108,-702.0837 340.5584,-694.857 329.9952,-695.6749 332.8108,-702.0837"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-780.8527 323.0941,-780.8527 323.0941,-758.8418 475.0737,-758.8418 475.0737,-780.8527"/>
<text text-anchor="middle" x="399.0839" y="-766.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1026.8472C308.7939,-955.1772 235.2939,-869.9782 317.2024,-794.8472 321.2414,-791.1424 325.8158,-787.9862 330.6875,-785.2973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.2349,-788.4369 339.7261,-780.9448 329.1978,-782.1301 332.2349,-788.4369"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-739.8527 317.3208,-739.8527 317.3208,-717.8418 480.847,-717.8418 480.847,-739.8527"/>
<text text-anchor="middle" x="399.0839" y="-725.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1026.8472C323.1395,-943.0747 222.0013,-838.249 317.2024,-749.8472 318.9499,-748.2245 320.8056,-746.7232 322.7485,-745.3343"/>
<polygon fill="#00ffff" stroke="#00ffff" points="324.9798,-748.0778 331.7621,-739.9383 321.3843,-742.0718 324.9798,-748.0778"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-1771.8527 344.7839,-1771.8527 344.7839,-1749.8418 453.3838,-1749.8418 453.3838,-1771.8527"/>
<text text-anchor="middle" x="399.0839" y="-1757.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1671.8472C244.6977,-1688.7659 258.1447,-1677.0776 281.2024,-1690.8472 300.0974,-1702.131 298.8606,-1712.6848 317.2024,-1724.8472 329.5954,-1733.065 344.1736,-1740.172 357.5684,-1745.8494"/>
<polygon fill="#ff0000" stroke="#ff0000" points="356.4834,-1749.1868 367.0645,-1749.7262 359.1292,-1742.7061 356.4834,-1749.1868"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1330.8472C441.8671,-1360.9582 498.1887,-1380.5481 540.5056,-1392.1286"/>
<polygon fill="#ff0000" stroke="#ff0000" points="539.8351,-1395.5719 550.3988,-1394.7607 541.6348,-1388.8072 539.8351,-1395.5719"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2745.8472C279.1812,-2793.3781 273.9982,-2822.0666 317.2024,-2880.8472 402.6738,-2997.1337 397.2779,-3056.2072 516.9653,-3136.8472 549.2427,-3158.5943 566.2382,-3143.71 601.1821,-3160.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-3160.8472C654.3907,-3179.9867 1527.8124,-2903.2261 1579.7417,-2880.8472 1666.4235,-2843.4918 1762.6269,-2786.252 1807.8606,-2758.3228"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1809.8126,-2761.2306 1816.4639,-2752.9838 1806.1215,-2755.2828 1809.8126,-2761.2306"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1571.8977,-2828.8527 1457.0915,-2828.8527 1457.0915,-2806.8418 1571.8977,-2806.8418 1571.8977,-2828.8527"/>
<text text-anchor="middle" x="1514.4946" y="-2814.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2821.8472C791.6055,-2884.7728 1271.8557,-2844.2065 1446.7293,-2825.6645"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1447.2433,-2829.1295 1456.8133,-2824.5836 1446.4972,-2822.1694 1447.2433,-2829.1295"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2745.8472C287.7005,-2802.5815 261.4804,-2642.5924 317.2024,-2577.8472 390.3292,-2492.8789 415.5818,-2471.6858 516.9653,-2423.8472 661.0857,-2355.843 724.1796,-2415.5734 866.4844,-2343.8472 1058.5629,-2247.0336 1085.0585,-2184.1217 1233.9104,-2028.8472 1323.1284,-1935.7798 1339.4133,-1906.535 1413.2476,-1800.8472 1448.3495,-1750.6017 1485.0553,-1688.2952 1503.0981,-1656.9127"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1506.3467,-1658.2826 1508.2747,-1647.8646 1500.2708,-1654.8064 1506.3467,-1658.2826"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-2246.8472C944.7076,-2178.126 993.6369,-2173.5903 1159.3246,-2172.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2591.8472C437.0741,-2621.1341 490.7919,-2630.4303 533.2974,-2632.648"/>
<polygon fill="#ff0000" stroke="#ff0000" points="533.157,-2636.1451 543.2902,-2633.0515 533.4396,-2629.1508 533.157,-2636.1451"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M399.0839,-2591.8472C440.8688,-2624.0595 464.2975,-2580.9638 516.9653,-2577.8472 591.694,-2573.4253 610.8225,-2571.3443 685.3989,-2577.8472 815.8638,-2589.2236 844.6517,-2628.8472 975.6116,-2628.8472 975.6116,-2628.8472 975.6116,-2628.8472 1159.3246,-2628.8472 1389.2728,-2628.8472 1446.7599,-2615.4899 1675.1594,-2588.8472"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M224.2464,-1722.1021C227.8891,-1816.2094 258.1843,-2471.6725 399.0839,-2591.8472"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1675.1594,-2588.8472C1745.0618,-2578.7305 1768.8102,-2561.852 1834.0785,-2588.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M224.0182,-1722.0576C225.8829,-1833.7417 243.3106,-2744.2158 317.2024,-2835.8472 325.1534,-2845.7071 336.8844,-2851.7729 348.9977,-2855.478"/>
<polygon fill="#ff7a00" stroke="#ff7a00" points="348.1736,-2858.8798 358.7294,-2857.9707 349.9106,-2852.0988 348.1736,-2858.8798"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M399.0839,-808.8472C411.606,-773.6497 455.784,-817.4438 480.9653,-789.8472 560.1914,-703.0225 430.0972,-607.0258 516.9653,-527.8472 622.4699,-431.682 1016.8959,-544.4938 1159.3246,-534.8472"/>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M1159.3246,-534.8472C1287.1185,-521.9375 1335.9676,-570.2521 1413.2476,-672.8472 1431.7571,-697.4201 1489.8695,-900.9961 1508.6079,-967.7435"/>
<polygon fill="#fff400" stroke="#fff400" points="1505.291,-968.8784 1511.3577,-977.5643 1512.0317,-966.9909 1505.291,-968.8784"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M601.1821,-2323.8472C646.5389,-2319.362 698.1931,-2319.6491 736.6065,-2320.9003"/>
<polygon fill="#cbff00" stroke="#cbff00" points="736.9546,-2324.4149 747.0736,-2321.2755 737.2055,-2317.4194 736.9546,-2324.4149"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M601.1821,-2591.8472C638.1731,-2602.0433 651.2635,-2593.324 685.3989,-2610.8472 704.4434,-2620.6237 702.9206,-2632.0388 721.3989,-2642.8472 728.1903,-2646.8197 735.7092,-2650.2898 743.2586,-2653.278"/>
<polygon fill="#8eff00" stroke="#8eff00" points="742.1918,-2656.6152 752.7849,-2656.8068 744.6234,-2650.0511 742.1918,-2656.6152"/>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M399.0839,-2591.8472C470.2209,-2646.6872 514.5899,-2567.9793 601.1821,-2591.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#51ff00" stroke-dasharray="5,2" d="M223.9451,-1721.9332C225.0506,-1827.1341 236.2361,-2650.6561 317.2024,-2880.8472 388.825,-3084.474 385.3264,-3274.8472 601.1821,-3274.8472 601.1821,-3274.8472 601.1821,-3274.8472 1834.0785,-3274.8472 1902.7035,-3274.8472 1981.3803,-3274.5039 2034.769,-3274.2196"/>
<polygon fill="#51ff00" stroke="#51ff00" points="2035.1182,-3277.7179 2045.099,-3274.1637 2035.0802,-3270.718 2035.1182,-3277.7179"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M399.0839,-808.8472C411.6975,-773.6824 456.5049,-818.0848 480.9653,-789.8472 542.7339,-718.5405 456.384,-439.1653 516.9653,-366.8472 566.7232,-307.4496 624.9296,-370.297 685.3989,-321.8472 712.3927,-300.219 691.8195,-270.7778 721.3989,-252.8472 776.5411,-219.4209 802.108,-249.1506 866.4844,-252.8472 1032.8781,-262.4019 1086.149,-250.7452 1233.9104,-327.8472 1252.1254,-337.3518 1251.8861,-346.9858 1269.9104,-356.8472 1299.3794,-372.9703 1310.5176,-368.058 1341.579,-380.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1514.4946,-418.8472C1585.9012,-418.8472 1607.3084,-396.5955 1675.1594,-418.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1341.579,-380.8472C1417.4209,-401.8085 1435.8094,-418.8472 1514.4946,-418.8472"/>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M265.033,-1699.7494C271.3739,-1696.2883 277.1496,-1691.7618 281.2024,-1685.8472 335.451,-1606.678 253.8063,-894.9001 317.2024,-822.8472 341.5904,-795.129 386.6054,-843.5944 399.0839,-808.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M793.9417,-532.8472C892.9147,-527.6858 1153.0448,-548.5494 1233.9104,-605.8472 1295.5587,-649.5285 1325.6987,-740.0645 1336.6091,-780.9748"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1333.2222,-781.8578 1339.0821,-790.6846 1340.0056,-780.13 1333.2222,-781.8578"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-2323.8472C450.7729,-2355.684 463.9881,-2363.2034 516.9653,-2392.8472 553.9997,-2413.5701 571.1699,-2407.8432 601.1821,-2437.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M265.081,-1699.7821C271.417,-1696.3177 277.1787,-1691.7816 281.2024,-1685.8472 351.6373,-1581.9664 275.5832,-675.254 317.2024,-556.8472 366.2295,-417.3648 395.5804,-375.2552 516.9653,-290.8472 527.2371,-283.7045 539.5732,-278.5724 551.596,-274.8958"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="552.8641,-278.1765 561.5693,-272.1375 550.9982,-271.4298 552.8641,-278.1765"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M399.0839,-1064.8472C453.9779,-976.9393 795.8168,-1056.337 925.6567,-1090.24"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="924.8026,-1093.6343 935.364,-1092.7933 926.5833,-1086.8646 924.8026,-1093.6343"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M264.9919,-1699.7211C271.337,-1696.2629 277.1248,-1691.7447 281.2024,-1685.8472 372.058,-1554.4424 247.9883,-1111.8312 317.2024,-967.8472 359.3202,-880.2309 434.3847,-908.1747 480.9653,-822.8472 531.1734,-730.8749 444.7343,-665.7579 516.9653,-589.8472 603.6006,-498.7986 668.7683,-544.1237 793.9417,-532.8472"/>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M793.9417,-532.8472C957.7056,-506.0881 1152.0642,-498.6132 1259.6257,-496.569"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="1259.8242,-500.0661 1269.76,-496.3877 1259.6989,-493.0673 1259.8242,-500.0661"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M399.0839,-808.8472C411.3661,-773.5653 456.0691,-817.7013 480.9653,-789.8472 573.1049,-686.7611 418.3363,-577.7428 516.9653,-480.8472 601.4779,-397.82 930.5346,-434.8671 1048.7388,-442.8472 1065.3073,-443.9658 1083.1776,-446.0168 1099.6207,-448.2505"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="1099.2605,-451.7342 1109.6499,-449.6582 1100.2335,-444.8021 1099.2605,-451.7342"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M793.9417,-2246.8472C828.2536,-2231.2074 838.0146,-2227.5735 866.4844,-2202.8472 885.561,-2186.2791 881.7345,-2173.2647 902.4844,-2158.8472 908.1107,-2154.938 914.4019,-2151.5936 920.869,-2148.7443"/>
<polygon fill="#0066ff" stroke="#0066ff" points="922.4348,-2151.8873 930.4128,-2144.9157 919.8286,-2145.3905 922.4348,-2151.8873"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-2323.8472C475.5625,-2370.9526 511.7967,-2332.6865 601.1821,-2323.8472"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-2323.8472C659.2904,-2318.101 666.9034,-2291.8194 721.3989,-2270.8472 753.0928,-2258.6501 763.0405,-2260.9324 793.9417,-2246.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M264.5249,-1699.752C271.0003,-1696.2861 276.954,-1691.7572 281.2024,-1685.8472 335.1043,-1610.8634 249.1334,-1334.2541 317.2024,-1271.8472 370.8511,-1222.6612 408.1872,-1270.9574 480.9653,-1271.8472 571.8451,-1272.9584 595.7575,-1261.8544 685.3989,-1276.8472 818.8545,-1299.1682 850.8328,-1421.1816 975.6116,-1368.8472"/>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M975.6116,-1368.8472C1055.7969,-1330.4577 1120.577,-1241.7754 1146.7746,-1201.9036"/>
<polygon fill="#0028ff" stroke="#0028ff" points="1149.8406,-1203.6072 1152.3194,-1193.3064 1143.958,-1199.8131 1149.8406,-1203.6072"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M601.1821,-1634.8472C636.7629,-1619.0748 648.9525,-1624.5006 685.3989,-1610.8472 712.5735,-1600.6672 742.3315,-1586.4551 763.8052,-1575.6187"/>
<polygon fill="#1400ff" stroke="#1400ff" points="765.4397,-1578.7141 772.7589,-1571.0537 762.2602,-1572.4778 765.4397,-1578.7141"/>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M399.0839,-1710.8472C494.6325,-1701.9424 513.4527,-1673.7366 601.1821,-1634.8472"/>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M267.5155,-1713.0913C303.0326,-1714.3771 354.4018,-1715.0115 399.0839,-1710.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#5100ff" stroke-dasharray="5,2" d="M265.0694,-1699.7743C271.4066,-1696.3106 277.1717,-1691.7768 281.2024,-1685.8472 346.8905,-1589.2133 246.0844,-727.558 317.2024,-634.8472 363.5206,-574.466 431.5288,-642.7031 480.9653,-584.8472 555.6052,-497.4958 440.3203,-414.4447 516.9653,-328.8472 568.5038,-271.289 628.9146,-338.5605 685.3989,-285.8472 722.6979,-251.0385 683.6227,-211.1375 721.3989,-176.8472 818.531,-88.6784 977.214,-73.6486 1074.5428,-73.699"/>
<polygon fill="#5100ff" stroke="#5100ff" points="1074.6196,-77.1994 1084.6401,-73.7585 1074.6609,-70.1995 1074.6196,-77.1994"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M1675.1594,-3008.8472C1750.0586,-3004.3106 1766.9961,-2985.4691 1834.0785,-2951.8472"/>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M224.0844,-1722.0312C226.4922,-1827.9425 247.4198,-2652.1578 317.2024,-2732.8472 333.679,-2751.8991 1416.4043,-3024.5199 1675.1594,-3008.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M399.0839,-2323.8472C425.3912,-2340.0507 574.5341,-2148.484 601.1821,-2132.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M225.0577,-1722.1459C233.7143,-1800.0064 288.8177,-2255.9311 399.0839,-2323.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M601.1821,-2132.8472C634.7497,-2113.1501 652.1178,-2129.0247 685.3989,-2108.8472 705.2928,-2096.7862 701.117,-2082.2436 721.3989,-2070.8472 732.2456,-2064.7526 1147.0598,-1978.9381 1159.3246,-1976.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M601.1821,-2132.8472C628.8442,-2118.5897 816.5933,-2082.8829 915.2722,-2064.7624"/>
<polygon fill="#ff007a" stroke="#ff007a" points="916.1975,-2068.1512 925.403,-2062.9064 914.936,-2061.2658 916.1975,-2068.1512"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M399.0839,-2094.8472C460.3023,-2048.6607 451.7333,-2009.167 516.9653,-1968.8472 524.5061,-1964.1863 532.9642,-1960.3531 541.5342,-1957.212"/>
<polygon fill="#ff003d" stroke="#ff003d" points="542.8544,-1960.4607 551.2147,-1953.9525 540.6206,-1953.8266 542.8544,-1960.4607"/>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M224.5294,-1722.0793C229.423,-1795.2257 262.7804,-2197.6819 399.0839,-2094.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2591.8472C638.1731,-2602.0433 657.0171,-2585.0255 685.3989,-2610.8472 723.4484,-2645.4646 685.3097,-2684.1909 721.3989,-2720.8472 724.8948,-2724.3981 728.9179,-2727.445 733.2395,-2730.0594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="731.9678,-2733.3426 742.4561,-2734.8414 735.1916,-2727.1292 731.9678,-2733.3426"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1710.8472C589.7728,-1693.0756 1118.7473,-1649.8686 1233.9104,-1496.8472 1322.3625,-1379.3178 1178.3271,-1282.9535 1269.9104,-1167.8472 1272.4679,-1164.6328 1275.4653,-1161.8305 1278.7573,-1159.3877"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.7851,-1162.2494 1287.465,-1154.0257 1277.1147,-1156.2888 1280.7851,-1162.2494"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-1064.8472C422.5697,-1027.2367 458.3636,-1045.9957 480.9653,-1007.8472 557.2944,-879.0149 442.8466,-802.9638 516.9653,-672.8472 528.6398,-652.3525 549.9753,-636.5001 568.2497,-625.8233"/>
<polygon fill="#cbff00" stroke="#cbff00" points="570.1465,-628.7734 577.1885,-620.8575 566.7471,-622.6542 570.1465,-628.7734"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M264.5558,-1699.7741C271.0282,-1696.306 276.9729,-1691.7707 281.2024,-1685.8472 339.1116,-1604.7446 291.5733,-1335.1502 317.2024,-1238.8472 339.1829,-1156.2539 353.8146,-1137.342 399.0839,-1064.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M264.9601,-1699.6991C271.3085,-1696.2431 277.1056,-1691.7313 281.2024,-1685.8472 361.9627,-1569.8554 251.2081,-1175.8316 317.2024,-1050.8472 327.9714,-1030.4522 348.5803,-1014.6511 366.4272,-1003.9744"/>
<polygon fill="#00ff66" stroke="#00ff66" points="368.4703,-1006.8394 375.4415,-998.8611 365.0165,-1000.7508 368.4703,-1006.8394"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1064.8472C427.9895,-1016.9747 462.312,-1032.6934 516.9653,-1020.8472 616.8159,-999.2045 886.3501,-1038.5557 975.6116,-988.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M265.0567,-1699.7656C271.3952,-1696.3029 277.164,-1691.7716 281.2024,-1685.8472 342.3874,-1596.0881 249.0421,-793.4314 317.2024,-708.8472 321.0958,-704.0157 325.9367,-700.2073 331.3059,-697.2158"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.1108,-700.2401 340.7667,-692.9163 330.2146,-693.8673 333.1108,-700.2401"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265.0394,-1699.7538C271.3796,-1696.2922 277.1535,-1691.7644 281.2024,-1685.8472 337.1546,-1604.0771 256.6561,-873.2765 317.2024,-794.8472 319.6859,-791.6302 322.5731,-788.8151 325.7493,-786.3529"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.6593,-789.2859 334.1747,-780.9312 323.8714,-783.3993 327.6593,-789.2859"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M265.0488,-1699.7602C271.3882,-1696.298 277.1592,-1691.7683 281.2024,-1685.8472 339.8926,-1599.8969 251.8332,-830.8341 317.2024,-749.8472 318.1818,-748.6339 319.2209,-747.4851 320.3131,-746.3976"/>
<polygon fill="#00ffff" stroke="#00ffff" points="322.5967,-749.0529 328.2221,-740.0748 318.2257,-743.5853 322.5967,-749.0529"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.7327,-1721.9439C288.5972,-1729.3235 322.7678,-1739.0729 350.4307,-1746.9656"/>
<polygon fill="#ff0000" stroke="#ff0000" points="349.7239,-1750.4036 360.3004,-1749.7816 351.6445,-1743.6722 349.7239,-1750.4036"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-2257.8527 516.748,-2257.8527 516.748,-2235.8418 685.6163,-2235.8418 685.6163,-2257.8527"/>
<text text-anchor="middle" x="601.1821" y="-2243.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2323.8472C429.5047,-2342.5843 526.3861,-2290.9083 574.1012,-2263.1554"/>
<polygon fill="#ff0000" stroke="#ff0000" points="576.1068,-2266.0364 582.9544,-2257.9517 572.5597,-2260.0016 576.1068,-2266.0364"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M254.6288,-1699.7435C263.534,-1695.9274 273.0453,-1691.2373 281.2024,-1685.8472 299.5637,-1673.7143 299.0778,-1664.331 317.2024,-1651.8472 383.7534,-1606.0085 429.8512,-1635.4378 480.9653,-1572.8472 522.1475,-1522.4186 471.8637,-1477.8031 516.9653,-1430.8472 520.3528,-1427.3205 524.2127,-1424.2851 528.3737,-1421.6731"/>
<polygon fill="#ff0000" stroke="#ff0000" points="530.1312,-1424.7021 537.2825,-1416.8849 526.8172,-1418.5363 530.1312,-1424.7021"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2077,-1722.0829C227.6631,-1825.0744 255.7217,-2603.2175 317.2024,-2683.8472 374.8003,-2759.3849 424.4057,-2738.4893 516.9653,-2759.8472 637.4016,-2787.6377 674.1916,-2754.2347 793.9417,-2784.8472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1866.8472C687.8984,-1877.0955 706.8413,-1911.0333 793.9417,-1904.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-1904.8472C876.6053,-1898.9763 892.7605,-1864.7054 975.6116,-1862.8472"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-2144.8527 334.8633,-2144.8527 334.8633,-2122.8418 463.3044,-2122.8418 463.3044,-2144.8527"/>
<text text-anchor="middle" x="399.0839" y="-2130.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.9624,-1721.9696C231.0508,-1780.2279 261.9074,-2049.7817 317.2024,-2108.8472 320.3736,-2112.2347 323.989,-2115.1677 327.8932,-2117.7068"/>
<polygon fill="#ff0000" stroke="#ff0000" points="326.3968,-2120.8789 336.841,-2122.6595 329.7868,-2114.7545 326.3968,-2120.8789"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1916.8527 354.6193,-1916.8527 354.6193,-1894.8418 443.5485,-1894.8418 443.5485,-1916.8527"/>
<text text-anchor="middle" x="399.0839" y="-1902.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M226.7242,-1721.8769C235.1874,-1752.056 262.8515,-1836.6748 317.2024,-1880.8472 325.3314,-1887.4539 335.1904,-1892.3177 345.2107,-1895.8976"/>
<polygon fill="#00ff00" stroke="#00ff00" points="344.2256,-1899.2569 354.816,-1898.9513 346.3465,-1892.5859 344.2256,-1899.2569"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="858.7621,-1838.8527 729.1212,-1838.8527 729.1212,-1816.8418 858.7621,-1816.8418 858.7621,-1838.8527"/>
<text text-anchor="middle" x="793.9417" y="-1824.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M235.8864,-1722.1037C252.8273,-1737.387 285.2118,-1764.6491 317.2024,-1780.8472 434.8541,-1840.419 469.3084,-1867.0183 601.1821,-1866.8472"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1866.8472C628.3268,-1870.0553 696.9186,-1853.9949 744.4943,-1841.5135"/>
<polygon fill="#0000ff" stroke="#0000ff" points="745.5358,-1844.8584 754.305,-1838.9126 743.742,-1838.0921 745.5358,-1844.8584"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1716.1351,-2008.808C1750.215,-2002.0733 1798.6938,-1998.3844 1834.0785,-2019.8472"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1720.2742,-2008.7757C1738.6378,-2004.2691 1760.032,-1999.0188 1779.2823,-1994.2947"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1780.2486,-1997.6615 1789.1262,-1991.8789 1778.5802,-1990.8632 1780.2486,-1997.6615"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.8911,-2031.2159C1679.9998,-2091.4667 1702.5052,-2379.1333 1770.5771,-2602.8472 1783.9999,-2646.9603 1808.465,-2695.2418 1822.7927,-2721.7004"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1819.8629,-2723.6367 1827.7435,-2730.7182 1825.9991,-2720.268 1819.8629,-2723.6367"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.1594,-2058.8472C1693.2799,-2057.3577 1818.533,-2010.418 1834.0785,-2019.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-2014.8472C1343.1321,-1978.7051 1393.5153,-2024.5695 1579.7417,-2044.8472 1622.3518,-2049.487 1632.4416,-2062.3588 1675.1594,-2058.8472"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1025.901,-2048.7022C1143.0394,-2038.4646 1441.8461,-2022.4824 1675.1594,-2096.8472"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1341.579,-1943.8472C1442.1031,-1908.8816 1477.9923,-1937.6261 1579.7417,-1968.8472 1605.3585,-1976.7076 1632.0553,-1991.6445 1650.6736,-2003.3303"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1648.8195,-2006.2992 1659.1245,-2008.7606 1652.6036,-2000.4101 1648.8195,-2006.2992"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1025.8218,-2042.7629C1062.7022,-2034.7249 1114.0548,-2023.7487 1159.3246,-2014.8472"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1159.3246,-2014.8472C1193.4934,-2008.1286 1201.3374,-2003.1619 1233.9104,-1990.8472 1282.7499,-1972.3829 1290.5347,-1954.8338 1341.579,-1943.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M650.8411,-1952.3974C706.8903,-1963.8029 799.0325,-1987.9813 866.4844,-2032.8472 886.6754,-2046.2774 880.3931,-2063.8459 902.4844,-2073.8472 911.1876,-2077.7875 1571.3981,-2073.0339 1675.1594,-2058.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M610.2742,-1955.1336C627.8563,-1977.5935 666.4496,-2030.1068 685.3989,-2080.8472 719.7551,-2172.8424 658.0392,-2223.8205 721.3989,-2298.8472 725.9032,-2304.1809 731.6033,-2308.3785 737.8209,-2311.6816"/>
<polygon fill="#cbff00" stroke="#cbff00" points="736.6661,-2314.9999 747.2218,-2315.9093 739.5371,-2308.6157 736.6661,-2314.9999"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M625.9251,-1932.8253C645.8328,-1922.5009 672.5355,-1905.0275 685.3989,-1880.8472 761.6805,-1737.4556 656.305,-1299.6519 721.3989,-1150.8472 758.3155,-1066.4561 805.4081,-1071.7993 866.4844,-1002.8472 952.5032,-905.7364 969.6495,-877.6804 1048.7388,-774.8472 1149.5097,-643.8233 1131.7788,-566.6311 1269.9104,-475.8472 1293.2292,-460.5215 1486.5904,-418.8472 1514.4946,-418.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M1159.3246,-1064.8472C1263.2111,-1017.0933 1317.859,-876.125 1335.2911,-822.6962"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1338.6922,-823.5489 1338.368,-812.959 1332.0175,-821.4397 1338.6922,-823.5489"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M625.7741,-1932.7438C645.5897,-1922.3696 672.2419,-1904.869 685.3989,-1880.8472 737.6347,-1785.4763 675.7589,-1491.5447 721.3989,-1392.8472 759.3999,-1310.6693 824.2101,-1329.9108 866.4844,-1249.8472 908.451,-1170.3663 843.4677,-1118.637 902.4844,-1050.8472 924.945,-1025.0478 944.6524,-1041.3945 975.6116,-1026.8472"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M975.6116,-1026.8472C1051.1719,-991.5962 1083.5665,-1099.6713 1159.3246,-1064.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M793.9417,-2284.8472C813.1234,-2312.1028 843.1435,-2280.0564 866.4844,-2303.8472 914.1958,-2352.4785 873.6737,-2391.1113 902.4844,-2452.8472 916.8105,-2483.5455 941.4386,-2514.1902 958.1143,-2533.0742"/>
<polygon fill="#00ff66" stroke="#00ff66" points="955.6424,-2535.5595 964.9358,-2540.6471 960.8434,-2530.8745 955.6424,-2535.5595"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M614.1459,-1955.1276C635.4262,-1973.2443 679.5885,-2009.1865 721.3989,-2032.8472 797.2132,-2075.7509 821.1773,-2076.5791 902.4844,-2107.8472 912.5867,-2111.7323 923.5492,-2115.7392 933.8374,-2119.4089"/>
<polygon fill="#0066ff" stroke="#0066ff" points="932.8499,-2122.7721 943.4447,-2122.809 935.1854,-2116.1731 932.8499,-2122.7721"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M624.4014,-1932.8172C648.4137,-1921.599 687.1263,-1904.0367 721.3989,-1890.8472 753.0928,-1878.6501 765.8966,-1885.9979 793.9417,-1866.8472"/>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M793.9417,-1866.8472C821.4655,-1848.0525 843.7314,-1872.201 866.4844,-1847.8472 924.8608,-1785.3637 853.2374,-1728.7524 902.4844,-1658.8472 945.9126,-1597.2017 1002.6587,-1632.5366 1048.7388,-1572.8472 1060.5501,-1557.5476 1133.2059,-1281.8053 1153.8556,-1202.8251"/>
<polygon fill="#0028ff" stroke="#0028ff" points="1157.2722,-1203.594 1156.4125,-1193.0341 1150.4993,-1201.8253 1157.2722,-1203.594"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M622.7765,-1932.6553C641.7704,-1921.787 668.894,-1903.6131 685.3989,-1880.8472 721.8824,-1830.5245 772.0917,-1644.5651 788.5091,-1581.1761"/>
<polygon fill="#1400ff" stroke="#1400ff" points="791.9892,-1581.6964 791.0905,-1571.1397 785.2098,-1579.9526 791.9892,-1581.6964"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M609.1533,-1955.0791C627.0357,-1979.6916 672.6228,-2039.2579 721.3989,-2077.8472 1057.5939,-2343.8288 1195.6783,-2327.404 1579.7417,-2517.8472 1651.5969,-2553.4777 1840.1309,-2632.8802 1897.5798,-2688.8472 1930.193,-2720.6192 1952.9161,-2769.881 1963.8883,-2797.4264"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="1960.6533,-2798.7651 1967.5143,-2806.8383 1967.1853,-2796.2486 1960.6533,-2798.7651"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1159.3246,-1976.8472C1193.5334,-1970.335 1202.4029,-1967.6772 1233.9104,-1952.8472 1251.0893,-1944.7615 1251.7309,-1935.3243 1269.9104,-1929.8472 1401.7656,-1890.1226 1452.1795,-1874.9655 1579.7417,-1926.8472 1616.0896,-1941.6305 1646.162,-1977.6548 1662.3166,-2000.2803"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1659.6208,-2002.5361 1668.1813,-2008.7785 1665.3821,-1998.5602 1659.6208,-2002.5361"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M975.6116,-1938.8472C1058.9218,-1942.2249 1077.1318,-1990.8592 1159.3246,-1976.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M793.9417,-1942.8472C861.8024,-1952.4521 926.6704,-2006.38 957.2773,-2035.3823"/>
<polygon fill="#ff007a" stroke="#ff007a" points="955.0207,-2038.0691 964.6395,-2042.5108 959.89,-2033.0401 955.0207,-2038.0691"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-1866.8472C821.699,-1848.3991 836.1994,-1861.7622 866.4844,-1847.8472 973.6666,-1798.6005 985.0592,-1759.9129 1084.7388,-1696.8472 1149.4095,-1655.9311 1192.9717,-1675.5037 1233.9104,-1610.8472 1286.7473,-1527.3993 1209.4998,-1245.9873 1269.9104,-1167.8472 1272.4228,-1164.5974 1275.386,-1161.7684 1278.653,-1159.3058"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.6791,-1162.1673 1287.3156,-1153.9085 1276.9773,-1156.2261 1280.6791,-1162.1673"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M625.8353,-1932.7771C645.6883,-1922.4233 672.3609,-1904.9338 685.3989,-1880.8472 745.1831,-1770.4013 672.833,-1432.6652 721.3989,-1316.8472 758.7757,-1227.7127 821.0536,-1240.1586 866.4844,-1154.8472 897.0873,-1097.3801 858.0576,-1060.4422 902.4844,-1012.8472 925.8255,-987.8416 946.0118,-1005.9921 975.6116,-988.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.1594,-2740.8472C1702.9572,-2743.1169 1733.5808,-2743.75 1760.4643,-2743.6852"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1760.5908,-2747.1847 1770.5709,-2743.6281 1760.5512,-2740.1848 1760.5908,-2747.1847"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-2284.8472C813.1234,-2312.1028 840.6614,-2282.7765 866.4844,-2303.8472 894.5128,-2326.7175 874.43,-2354.0089 902.4844,-2376.8472 1020.5014,-2472.9219 1089.1268,-2415.9851 1233.9104,-2462.8472 1390.891,-2513.6572 1451.1614,-2494.4468 1579.7417,-2597.8472 1639.2827,-2645.7284 1599.0078,-2734.6296 1675.1594,-2740.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M610.1241,-1955.1911C627.4431,-1977.7518 665.5964,-2030.4336 685.3989,-2080.8472 715.2267,-2156.7834 667.3376,-2199.7459 721.3989,-2260.8472 743.9022,-2286.281 773.8724,-2257.452 793.9417,-2284.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M650.972,-1939.6351C690.0536,-1937.2794 745.7297,-1936.0235 793.9417,-1942.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-1942.8472C873.9064,-1954.1652 894.9161,-1935.5756 975.6116,-1938.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-1938.8472C1057.1948,-1942.1549 1084.091,-1970.5751 1159.3246,-1938.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-1938.8472C1199.0436,-1922.0967 1200.7989,-1904.4482 1233.9104,-1876.8472 1281.8178,-1836.9128 1279.3478,-1790.9892 1341.579,-1786.8472"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M616.1543,-1932.7788C633.0434,-1920.2627 661.2997,-1899.2306 685.3989,-1880.8472 701.5151,-1868.5536 703.5762,-1862.5021 721.3989,-1852.8472 728.6436,-1848.9227 736.6221,-1845.4352 744.557,-1842.4027"/>
<polygon fill="#0000ff" stroke="#0000ff" points="745.9475,-1845.6218 754.162,-1838.9305 743.5677,-1839.0387 745.9475,-1845.6218"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M866.6566,-2748.1102C996.7656,-2751.5425 1277.9271,-2756.16 1514.4946,-2740.8472"/>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1514.4946,-2740.8472C1719.6593,-2723.9917 1798.6992,-2552.8042 1971.3926,-2664.8472"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M809.7678,-2734.769C825.0465,-2723.7213 848.4535,-2705.8465 866.4844,-2687.8472 904.5968,-2649.8016 942.4355,-2598.9609 961.9776,-2571.4784"/>
<polygon fill="#00ff66" stroke="#00ff66" points="964.9783,-2573.2963 967.8775,-2563.1059 959.2562,-2569.2641 964.9783,-2573.2963"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1514.4946,-2740.8472C1585.7521,-2736.2348 1603.9556,-2735.4694 1675.1594,-2740.8472"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M1354.3034,-1131.7368C1368.6609,-1119.1829 1392.6935,-1098.1171 1413.2476,-1079.8472 1441.6294,-1054.6195 1474.2675,-1025.2128 1494.6391,-1006.8103"/>
<polygon fill="#fff400" stroke="#fff400" points="1496.9926,-1009.401 1502.0647,-1000.0991 1492.2989,-1004.2077 1496.9926,-1009.401"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1395.2671,-1153.9023C1402.1465,-1157.3612 1408.4493,-1161.898 1413.2476,-1167.8472 1454.431,-1218.9098 1433.7411,-1397.1055 1449.2476,-1460.8472 1463.3575,-1518.8484 1490.6807,-1583.9555 1505.0841,-1616.3039"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1501.9754,-1617.9246 1509.2734,-1625.605 1508.3579,-1615.0498 1501.9754,-1617.9246"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1569.8527 166.6166,-1569.8527 166.6166,-1547.8418 281.0645,-1547.8418 281.0645,-1569.8527"/>
<text text-anchor="middle" x="223.8406" y="-1555.6972" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M225.5695,-1547.5107C233.6792,-1495.8108 269.5637,-1283.0116 317.2024,-1238.8472 411.8033,-1151.1457 474.2632,-1155.7719 601.1821,-1178.8472"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M281.1856,-1561.5254C315.4706,-1562.4605 359.8545,-1562.5033 399.0839,-1558.8472"/>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M399.0839,-1558.8472C451.6162,-1553.9514 464.2975,-1547.9638 516.9653,-1544.8472 591.694,-1540.4253 610.7159,-1539.7113 685.3989,-1544.8472 706.8935,-1546.3254 730.6142,-1549.4316 750.384,-1552.436"/>
<polygon fill="#1400ff" stroke="#1400ff" points="749.9094,-1555.9042 760.3296,-1553.9886 750.9891,-1548.988 749.9094,-1555.9042"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M231.4835,-1569.9634C243.4696,-1587.807 266.8031,-1624.2531 281.2024,-1657.8472 303.6424,-1710.2008 281.9549,-1736.1029 317.2024,-1780.8472 334.9248,-1803.3446 500.7199,-1891.4292 570.482,-1927.9003"/>
<polygon fill="#ff003d" stroke="#ff003d" points="569.1783,-1931.1679 579.663,-1932.6918 572.417,-1924.9622 569.1783,-1931.1679"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-1142.8472C1052.11,-1171.3909 1077.861,-1148.3647 1159.3246,-1142.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-1142.8472C1193.2231,-1140.5513 1230.7496,-1140.1815 1262.8965,-1140.5258"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1263.088,-1144.0286 1273.1334,-1140.6612 1263.1806,-1137.0292 1263.088,-1144.0286"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.767,-1547.378C231.257,-1468.4185 271.0021,-1007.322 317.2024,-967.8472 372.5379,-920.567 408.6847,-959.3059 480.9653,-967.8472 657.3215,-988.6872 722.786,-968.5086 866.4844,-1072.8472 888.9352,-1089.1487 879.6668,-1108.0632 902.4844,-1123.8472 930.1009,-1142.9509 944.1502,-1131.1081 975.6116,-1142.8472"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M240.9627,-1569.8879C271.8478,-1589.8031 337.0384,-1631.8392 373.3274,-1655.239"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="371.5912,-1658.284 381.8922,-1660.7618 375.3847,-1652.401 371.5912,-1658.284"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1558.8472C629.897,-1554.5659 675.0017,-1647.5445 902.4844,-1686.8472 1015.4591,-1706.3662 1048.2138,-1682.5866 1159.3246,-1710.8472"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M793.9417,-570.8472C989.9983,-613.8989 1062.9477,-567.6645 1233.9104,-672.8472 1278.7785,-700.4518 1313.9223,-753.3026 1330.7343,-782.0453"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1327.7292,-783.8411 1335.7206,-790.7973 1333.8113,-780.3759 1327.7292,-783.8411"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M626.3447,-598.746C663.056,-583.9203 733.5106,-560.639 793.9417,-570.8472"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M602.4253,-620.9243C613.0114,-714.8739 688.4341,-1376.7349 721.3989,-1458.8472 734.2205,-1490.7846 759.2026,-1522.1102 776.2291,-1541.2022"/>
<polygon fill="#1400ff" stroke="#1400ff" points="773.8725,-1543.812 783.2001,-1548.8367 779.0418,-1539.092 773.8725,-1543.812"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#5100ff" stroke-dasharray="5,2" d="M607.8989,-598.5759C624.8804,-570.5573 671.7259,-496.1726 721.3989,-442.8472 758.4561,-403.0654 1054.5097,-162.6867 1137.6688,-95.3609"/>
<polygon fill="#5100ff" stroke="#5100ff" points="1140.1055,-97.8916 1145.6768,-88.8799 1135.7017,-92.4503 1140.1055,-97.8916"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.9417,-570.8472C827.4271,-576.5037 842.3067,-570.9995 866.4844,-594.8472 901.308,-629.1956 874.8497,-658.4886 902.4844,-698.8472 926.558,-734.0052 935.7197,-745.872 975.6116,-760.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-760.8472C1058.0215,-791.7835 1082.0132,-644.7593 1159.3246,-686.8472"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M975.6116,-760.8472C1013.4819,-775.0636 1057.6807,-785.1176 1093.2343,-791.7108"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1093.0333,-795.231 1103.496,-793.5628 1094.2766,-788.3423 1093.0333,-795.231"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.5043,-998.9096C524.9192,-1022.2547 730.0917,-1078.1657 902.4844,-1123.8472 934.9442,-1132.4486 944.0855,-1131.283 975.6116,-1142.8472"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M1215.4941,-801.8472C1236.6166,-801.8472 1260.6926,-801.8472 1282.1059,-801.8472"/>
<polygon fill="#00ff28" stroke="#00ff28" points="1282.3794,-805.3473 1292.3793,-801.8472 1282.3793,-798.3473 1282.3794,-805.3473"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.8646,-812.8613C1162.647,-857.523 1179.0349,-1027.063 1269.9104,-1117.8472 1273.5463,-1121.4795 1277.7377,-1124.5852 1282.2309,-1127.2406"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.6798,-1130.3784 1291.1772,-1131.812 1283.8649,-1124.145 1280.6798,-1130.3784"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.579,-1103.8472C1360.0851,-1131.1131 1391.7957,-1097.8328 1413.2476,-1122.8472 1462.4202,-1180.186 1431.9857,-1387.3101 1449.2476,-1460.8472 1462.8888,-1518.9604 1490.414,-1584.0192 1504.9703,-1616.3311"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1501.873,-1617.9745 1509.2067,-1625.6209 1508.242,-1615.0701 1501.873,-1617.9745"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1160.4408,-812.9745C1165.1956,-854.4769 1187.4637,-1001.851 1269.9104,-1079.8472 1294.3125,-1102.9321 1322.7144,-1076.0534 1341.579,-1103.8472"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M601.1821,-2437.8472C645.5508,-2482.604 822.2015,-2522.3525 916.1437,-2540.8528"/>
<polygon fill="#00ff66" stroke="#00ff66" points="915.5877,-2544.3102 926.0728,-2542.7897 916.928,-2537.4397 915.5877,-2544.3102"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M463.9213,-1682.987C470.4736,-1686.4723 476.387,-1690.9933 480.9653,-1696.8472 574.051,-1815.8704 445.2436,-2242.8531 516.9653,-2375.8472 539.0271,-2416.7565 568.3121,-2404.9862 601.1821,-2437.8472"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M431.857,-1660.7688C448.7138,-1653.5356 468.3199,-1642.4889 480.9653,-1626.8472 515.9718,-1583.5461 476.2153,-1544.7929 516.9653,-1506.8472 609.2848,-1420.8811 670.2193,-1469.461 793.9417,-1444.8472"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M461.9374,-1683.0409C469.0886,-1686.498 475.6895,-1690.9973 480.9653,-1696.8472 536.7724,-1758.7276 472.641,-1810.2855 516.9653,-1880.8472 529.537,-1900.8606 550.9256,-1916.7416 569.0012,-1927.5527"/>
<polygon fill="#ff003d" stroke="#ff003d" points="567.6675,-1930.8214 578.0874,-1932.739 571.1377,-1924.742 567.6675,-1930.8214"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M424.282,-1660.676C448.0844,-1650.1876 484.8283,-1634.1619 516.9653,-1620.8472 607.2543,-1583.4396 626.787,-1564.3421 721.3989,-1539.8472 768.9016,-1527.5489 1120.0063,-1512.204 1159.3246,-1482.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.3246,-1482.8472C1274.4826,-1389.2829 1164.8877,-1272.6608 1269.9104,-1167.8472 1273.5481,-1164.2168 1277.7407,-1161.1123 1282.2348,-1158.4578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1283.8688,-1161.5534 1291.1822,-1153.8875 1280.6845,-1155.3195 1283.8688,-1161.5534"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.9061,-1681.1839C662.4768,-1709.5853 1254.2004,-1792.6629 1341.579,-1786.8472"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M266.4108,-676.8343C301.7254,-668.0707 353.3722,-656.1109 399.0839,-648.8472"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-648.8472C448.3728,-641.0151 504.0336,-630.1209 544.4434,-621.8369"/>
<polygon fill="#cbff00" stroke="#cbff00" points="545.2875,-625.2366 554.3754,-619.7905 543.8748,-618.3806 545.2875,-625.2366"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M975.6116,-836.8472C1027.7855,-849.34 1089.1436,-831.1249 1126.0943,-816.638"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1127.4396,-819.8694 1135.3915,-812.8682 1124.8092,-813.3823 1127.4396,-819.8694"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-648.8472C502.8736,-632.3548 778.2056,-663.8283 866.4844,-720.8472 890.7141,-736.4972 883.2967,-753.3105 902.4844,-774.8472 930.8292,-806.6622 934.1728,-826.925 975.6116,-836.8472"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-687.8472C295.1003,-687.8472 313.1505,-687.8472 330.2066,-687.8472"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-691.3473 340.6733,-687.8472 330.6733,-684.3473 330.6733,-691.3473"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M438.5512,-676.8312C452.112,-672.7738 467.3115,-667.921 480.9653,-662.8472 511.22,-651.6047 544.7583,-636.5976 568.7063,-625.4226"/>
<polygon fill="#cbff00" stroke="#cbff00" points="570.4643,-628.4637 578.025,-621.0417 567.4861,-622.1288 570.4643,-628.4637"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M457.5723,-689.9601C548.113,-694.8987 726.3726,-711.3285 866.4844,-765.8472 920.4087,-786.8297 919.6086,-822.2949 975.6116,-836.8472"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M475.1125,-776.7809C591.086,-788.6418 805.1963,-815.9855 866.4844,-860.8472 893.4464,-880.5829 881.3848,-900.9387 902.4844,-926.8472 929.3916,-959.887 938.4799,-1009.7484 975.6116,-988.8472"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M975.6116,-988.8472C1004.9896,-971.3252 1021.4229,-985.4369 1048.7388,-964.8472 1099.7193,-926.4202 1135.1548,-857.355 1150.606,-822.7729"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1153.9817,-823.7863 1154.7547,-813.2197 1147.561,-820.9979 1153.9817,-823.7863"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M481.1126,-736.4424C597.0201,-748.2828 801.8299,-773.6042 866.4844,-809.8472 887.6373,-821.7048 880.3931,-840.8459 902.4844,-850.8472 980.4107,-886.1267 1082.7774,-842.9197 1131.3822,-817.6564"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1133.1833,-820.6626 1140.3632,-812.8716 1129.8918,-814.4847 1133.1833,-820.6626"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M409.1647,-1771.8539C427.3121,-1792.4331 465.0669,-1838.9162 480.9653,-1885.8472 515.9966,-1989.2571 464.1647,-2280.2811 516.9653,-2375.8472 539.4426,-2416.5297 568.46,-2404.8389 601.1821,-2437.8472"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M441.5167,-1749.7528C455.6414,-1744.2537 470.4383,-1736.2632 480.9653,-1724.8472 514.1238,-1688.8888 486.6298,-1659.2172 516.9653,-1620.8472 539.5792,-1592.2441 758.4112,-1453.0395 793.9417,-1444.8472"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M428.6795,-1749.7472C444.6055,-1743.3052 464.3361,-1734.5555 480.9653,-1724.8472 538.6053,-1691.1966 540.1647,-1661.8955 601.1821,-1634.8472"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M441.5089,-1771.9612C455.4676,-1777.3166 470.1609,-1785.0069 480.9653,-1795.8472 509.9272,-1824.9053 491.6633,-1848.5523 516.9653,-1880.8472 531.9249,-1899.9413 554.0366,-1916.1833 571.8494,-1927.3916"/>
<polygon fill="#ff003d" stroke="#ff003d" points="570.3493,-1930.5758 580.7118,-1932.7825 573.9871,-1924.5953 570.3493,-1930.5758"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.5472,-1756.0435C543.5195,-1750.3067 727.0971,-1747.9989 866.4844,-1807.8472 885.8862,-1816.1778 884.0982,-1828.4657 902.4844,-1838.8472 932.2707,-1855.6658 941.5597,-1859.597 975.6116,-1862.8472"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.6116,-1862.8472C1141.4234,-1873.0009 1175.7759,-1797.1429 1341.579,-1786.8472"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M637.7657,-2235.8066C706.2721,-2215.1319 853.7739,-2170.617 929.1733,-2147.862"/>
<polygon fill="#0066ff" stroke="#0066ff" points="930.3172,-2151.1727 938.8795,-2144.9327 928.2947,-2144.4713 930.3172,-2151.1727"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M620.4526,-1416.8899C638.8554,-1428.1554 666.5077,-1447.043 685.3989,-1468.8472 707.2785,-1494.1006 695.8789,-1513.2794 721.3989,-1534.8472 729.7259,-1541.8847 740.1432,-1546.9776 750.463,-1550.65"/>
<polygon fill="#1400ff" stroke="#1400ff" points="749.666,-1554.0689 760.2561,-1553.7529 751.7803,-1547.3959 749.666,-1554.0689"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M1854.0451,-2752.8983C1877.3332,-2765.7877 1916.0196,-2787.1996 1942.5642,-2801.8914"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="1940.9576,-2805.0025 1951.4018,-2806.7829 1944.3474,-2798.878 1940.9576,-2805.0025"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1531.9296,-2806.7542C1547.569,-2795.7108 1569.5734,-2777.208 1579.7417,-2754.8472 1645.1378,-2611.0377 1525.0333,-2174.191 1615.7417,-2044.8472 1617.9606,-2041.6832 1620.662,-2038.9179 1623.6754,-2036.5013"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1625.8101,-2039.2873 1632.2633,-2030.8845 1621.9786,-2033.429 1625.8101,-2039.2873"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1546.0427,-2806.7266C1556.8566,-2802.6607 1568.948,-2797.8294 1579.7417,-2792.8472 1623.5923,-2772.6068 1627.0001,-2737.2099 1675.1594,-2740.8472"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M1519.1297,-1647.8966C1541.3477,-1700.8609 1637.0808,-1929.0737 1666.5155,-1999.2414"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1663.4096,-2000.8854 1670.5055,-2008.753 1669.8646,-1998.1776 1663.4096,-2000.8854"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M460.8017,-2122.7397C468.3135,-2119.2787 475.3153,-2114.7553 480.9653,-2108.8472 525.3692,-2062.4156 472.3816,-2015.1062 516.9653,-1968.8472 523.8713,-1961.6818 532.728,-1956.5449 542.0924,-1952.868"/>
<polygon fill="#ff003d" stroke="#ff003d" points="543.2241,-1956.1801 551.5725,-1949.6567 540.9782,-1949.5502 543.2241,-1956.1801"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.7231,-2122.8121C457.5586,-2119.1553 470.0154,-2114.5296 480.9653,-2108.8472 498.9568,-2099.5107 498.6202,-2089.4681 516.9653,-2080.8472 649.2769,-2018.6703 1024.6206,-1995.6553 1159.3246,-1938.8472"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M443.4352,-1914.1865C472.2679,-1919.6078 510.2062,-1926.7413 541.6514,-1932.6538"/>
<polygon fill="#ff003d" stroke="#ff003d" points="541.1384,-1936.1186 551.613,-1934.5269 542.432,-1929.2392 541.1384,-1936.1186"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.556,-1907.5256C516.7242,-1909.8848 667.042,-1913.0402 793.9417,-1904.8472"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M838.3933,-1838.8673C874.964,-1847.3381 928.2892,-1858.3303 975.6116,-1862.8472"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacwatertoairmultispeedhpf90EfferentGraph = svgPanZoom('#sourcefilehvacwatertoairmultispeedhpf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilehvacwatertoairmultispeedhpf90AfferentGraph" width="641pt" height="155pt"
 viewBox="0.00 0.00 641.00 154.99" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph" class="graph" transform="scale(.2624 .2624) rotate(0) translate(4 586.6006)">
<title>sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-586.6006 2438.6443,-586.6006 2438.6443,4 -4,4"/>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~hvacwatertoairmultispeedhp.f90</title>
<polygon fill="none" stroke="#000000" points="172.8257,-451.2554 .0581,-451.2554 .0581,-429.2446 172.8257,-429.2446 172.8257,-451.2554"/>
<text text-anchor="middle" x="86.4419" y="-437.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACWatertoAirMultiSpeedHP.f90</text>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478.6547,-451.2554 352.2999,-451.2554 352.2999,-429.2446 478.6547,-429.2446 478.6547,-451.2554"/>
<text text-anchor="middle" x="415.4773" y="-437.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.6362,-574.25C331.1201,-582.4059 384.1181,-500.0108 405.361,-460.5695"/>
<polygon fill="#ff0000" stroke="#ff0000" points="408.5449,-462.0336 410.0677,-451.5488 402.3388,-458.7955 408.5449,-462.0336"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M94.3305,-451.6192C116.5549,-482.2442 183.2614,-564.7971 262.6362,-574.25"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="821.1953,-177.2554 656.1919,-177.2554 656.1919,-155.2446 821.1953,-155.2446 821.1953,-177.2554"/>
<text text-anchor="middle" x="738.6936" y="-163.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M111.9486,-429.1547C178.1961,-400.3794 361.2341,-321.1421 514.5659,-257.25 580.1579,-229.9184 656.9551,-198.9626 701.4911,-181.1135"/>
<polygon fill="#ff0000" stroke="#ff0000" points="703.0416,-184.2628 711.0236,-177.2958 700.4391,-177.7646 703.0416,-184.2628"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="989.6977,-526.2554 892.8345,-526.2554 892.8345,-504.2446 989.6977,-504.2446 989.6977,-526.2554"/>
<text text-anchor="middle" x="941.2661" y="-512.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.6362,-574.25C491.7052,-601.5302 765.699,-552.9815 883.1572,-528.3239"/>
<polygon fill="#ff0000" stroke="#ff0000" points="883.9673,-531.73 893.0235,-526.2313 882.5149,-524.8824 883.9673,-531.73"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="316.1422,-451.2554 209.1302,-451.2554 209.1302,-429.2446 316.1422,-429.2446 316.1422,-451.2554"/>
<text text-anchor="middle" x="262.6362" y="-437.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M172.9906,-440.25C181.6526,-440.25 190.3347,-440.25 198.7016,-440.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.7285,-443.7501 208.7285,-440.25 198.7285,-436.7501 198.7285,-443.7501"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1189.0565,-448.2554 1063.6293,-448.2554 1063.6293,-426.2446 1189.0565,-426.2446 1189.0565,-448.2554"/>
<text text-anchor="middle" x="1126.3429" y="-434.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M478.7929,-442.0674C505.1776,-442.3529 536.1192,-442.0749 564.045,-440.25"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1198.1907,-275.2554 1054.4951,-275.2554 1054.4951,-253.2446 1198.1907,-253.2446 1198.1907,-275.2554"/>
<text text-anchor="middle" x="1126.3429" y="-261.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M454.0148,-429.2276C494.9107,-416.7671 560.7783,-394.4881 613.5242,-366.25 630.9241,-356.9347 631.0716,-347.2524 649.5242,-340.25 803.684,-281.7496 862.906,-357.3368 1018.6692,-303.25 1036.6053,-297.0219 1037.1378,-287.5401 1054.6692,-280.25 1056.0304,-279.684 1057.4148,-279.1364 1058.8176,-278.6069"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1059.9615,-281.9148 1068.2911,-275.3673 1057.6965,-275.2913 1059.9615,-281.9148"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="613.5033,-288.2554 514.5868,-288.2554 514.5868,-266.2446 613.5033,-266.2446 613.5033,-288.2554"/>
<text text-anchor="middle" x="564.045" y="-274.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M424.7741,-429.0026C442.0168,-408.2684 480.3192,-362.7983 514.5659,-326.25 524.3822,-315.774 535.7381,-304.4735 545.0932,-295.3675"/>
<polygon fill="#ff0000" stroke="#ff0000" points="547.6459,-297.7678 552.403,-288.301 542.7806,-292.735 547.6459,-297.7678"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="598.8261,-357.2554 529.2639,-357.2554 529.2639,-335.2446 598.8261,-335.2446 598.8261,-357.2554"/>
<text text-anchor="middle" x="564.045" y="-343.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M430.1505,-429.0547C449.1208,-414.8122 483.4244,-389.8351 514.5659,-371.25 519.8604,-368.0903 525.6035,-364.9465 531.2392,-362.0084"/>
<polygon fill="#ff0000" stroke="#ff0000" points="533.1937,-364.9412 540.524,-357.2916 530.0233,-358.7004 533.1937,-364.9412"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M821.2757,-156.0354C879.3554,-152.522 957.3386,-155.4065 1018.6692,-185.25 1040.1757,-195.7151 1035.8947,-210.4322 1054.6692,-225.25 1066.0116,-234.202 1079.6939,-242.2118 1092.0508,-248.6089"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1090.6718,-251.8325 1101.1812,-253.1754 1093.8031,-245.5719 1090.6718,-251.8325"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1177.1292,-216.2554 1075.5566,-216.2554 1075.5566,-194.2446 1177.1292,-194.2446 1177.1292,-216.2554"/>
<text text-anchor="middle" x="1126.3429" y="-202.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M756.0352,-155.0263C779.4093,-140.6328 822.8367,-116.4345 863.863,-107.25 931.0039,-92.2193 954.9199,-81.3686 1018.6692,-107.25 1039.3455,-115.6443 1038.2836,-127.1012 1054.6692,-142.25 1071.448,-157.7623 1090.9527,-174.8474 1105.3752,-187.3073"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1103.3588,-190.1898 1113.2206,-194.0622 1107.9261,-184.8851 1103.3588,-190.1898"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M979.454,-504.1252C992.0784,-500.1284 1006.1044,-495.3402 1018.6692,-490.25 1045.92,-479.2102 1075.8456,-464.2368 1097.2165,-453.021"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1098.9064,-456.0867 1106.1057,-448.3136 1095.6304,-449.9005 1098.9064,-456.0867"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M316.5223,-440.25C324.7999,-440.25 333.4648,-440.25 342.0785,-440.25"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="342.1404,-443.7501 352.1404,-440.25 342.1404,-436.7501 342.1404,-443.7501"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M564.045,-440.25C641.5014,-435.1885 661.6923,-430.4566 738.6936,-440.25"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M303.4259,-451.3209C318.6668,-454.9316 336.2029,-458.4685 352.3887,-460.25 408.1308,-466.3854 422.857,-466.6804 478.5659,-460.25 517.3253,-455.776 525.1113,-442.7942 564.045,-440.25"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M415.4773,-346.25C456.5423,-329.3806 502.7689,-307.4277 532.5926,-292.8637"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="534.2349,-295.9566 541.6719,-288.4106 531.1524,-289.6718 534.2349,-295.9566"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M276.9579,-429.2125C303.0562,-409.6259 360.7287,-368.7407 415.4773,-346.25"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M415.4773,-346.25C448.1306,-332.8361 488.3333,-333.7649 518.6803,-337.5346"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="518.5877,-341.0553 528.9748,-338.9676 519.5529,-334.1222 518.5877,-341.0553"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2146.6088,-409.2554 2047.6512,-409.2554 2047.6512,-387.2446 2146.6088,-387.2446 2146.6088,-409.2554"/>
<text text-anchor="middle" x="2097.13" y="-395.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1189.155,-426.7222C1303.3561,-409.0655 1552.5496,-377.373 1761.791,-398.25"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1462.9983,-371.2554 1364.4402,-371.2554 1364.4402,-349.2446 1462.9983,-349.2446 1462.9983,-371.2554"/>
<text text-anchor="middle" x="1413.7192" y="-357.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1163.0719,-426.1972C1174.4852,-422.2989 1186.9659,-417.5503 1198.0166,-412.25 1237.3193,-393.3992 1237.9042,-365.5267 1281.1732,-360.25"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1151.3132,-275.2707C1181.5023,-288.1633 1234.124,-309.266 1281.1732,-321.25"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1761.791,-398.25C1857.6723,-408.5456 1969.8654,-405.5181 2037.122,-402.0982"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2037.72,-405.5715 2047.5211,-401.5479 2037.3501,-398.5813 2037.72,-405.5715"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1281.1732,-321.25C1359.9576,-341.3174 1382.6966,-328.2673 1463.1086,-340.25 1596.8592,-360.181 1627.5888,-381.6302 1761.791,-398.25"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1281.1732,-321.25C1310.6205,-328.7506 1343.3817,-338.3782 1368.9659,-346.1909"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1368.1634,-349.6058 1378.7504,-349.197 1370.2193,-342.9145 1368.1634,-349.6058"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M576.8383,-266.0782C592.6487,-253.0858 620.9758,-232.3823 649.5242,-224.25 774.5191,-188.6439 811.9716,-231.0414 941.2661,-244.25"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M941.2661,-244.25C974.9698,-247.1511 1012.0532,-251.0234 1044.118,-254.5877"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1044.0142,-258.0979 1054.3416,-255.7325 1044.7932,-251.1414 1044.0142,-258.0979"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1180.6532,-133.2554 1072.0326,-133.2554 1072.0326,-111.2446 1180.6532,-111.2446 1180.6532,-133.2554"/>
<text text-anchor="middle" x="1126.3429" y="-119.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M568.072,-266.1518C577.8559,-240.7965 605.369,-178.3404 649.5242,-146.25 783.8693,-48.6128 854.5303,-62.9507 1018.6692,-88.25 1042.978,-91.9968 1069.323,-100.238 1089.8691,-107.6681"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1088.8622,-111.0277 1099.4552,-111.2272 1091.2987,-104.4654 1088.8622,-111.0277"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M577.4499,-335.1974C588.1634,-325.8772 603.0667,-311.7685 613.5242,-297.25 634.6669,-267.8965 625.5046,-251.3 649.5242,-224.25 665.154,-206.6483 687.3257,-192.1957 705.6499,-182.12"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="707.3646,-185.1724 714.5579,-177.3938 704.0838,-178.9888 707.3646,-185.1724"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M573.2926,-357.3879C587.7536,-374.0263 617.4088,-405.1354 649.5242,-421.25 685.7411,-439.4227 698.4969,-435.1376 738.6936,-440.25"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M738.6936,-440.25C828.0107,-451.6098 851.3029,-434.6148 941.2661,-438.25"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2302.2269,-255.2554 2182.4164,-255.2554 2182.4164,-233.2446 2302.2269,-233.2446 2302.2269,-255.2554"/>
<text text-anchor="middle" x="2242.3217" y="-241.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M566.6901,-357.3477C574.1604,-386.0757 598.288,-463.1451 649.5242,-499.25 823.9026,-622.1301 914.4707,-529.3994 1126.3429,-554.25"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1007.414,-294.2554 875.1182,-294.2554 875.1182,-272.2446 1007.414,-272.2446 1007.414,-294.2554"/>
<text text-anchor="middle" x="941.2661" y="-280.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M738.6936,-283.25C779.9209,-267.8789 829.2335,-267.5318 868.8822,-271.1951"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="868.6994,-274.6947 879.0049,-272.2357 869.4153,-267.7314 868.6994,-274.6947"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="792.873,-490.2554 684.5142,-490.2554 684.5142,-468.2446 792.873,-468.2446 792.873,-490.2554"/>
<text text-anchor="middle" x="738.6936" y="-476.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M569.6806,-357.3227C581.4299,-379.2732 610.7089,-428.4118 649.5242,-454.25 657.1905,-459.3532 665.8904,-463.4244 674.7776,-466.6698"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="673.8612,-470.0532 684.4546,-469.8771 676.0635,-463.4087 673.8612,-470.0532"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="828.0328,-371.2554 649.3544,-371.2554 649.3544,-349.2446 828.0328,-349.2446 828.0328,-371.2554"/>
<text text-anchor="middle" x="738.6936" y="-357.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M598.968,-349.0495C610.8574,-350.0025 624.8033,-351.1204 639.1993,-352.2744"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="638.9702,-355.7672 649.2179,-353.0775 639.5296,-348.7896 638.9702,-355.7672"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="823.3912,-255.2554 653.996,-255.2554 653.996,-233.2446 823.3912,-233.2446 823.3912,-255.2554"/>
<text text-anchor="middle" x="738.6936" y="-241.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M575.1478,-335.0587C594.2784,-315.9848 632.99,-278.3537 649.5242,-269.25 657.1988,-265.0243 665.6465,-261.4649 674.1903,-258.4795"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="675.4097,-261.7635 683.8412,-255.3479 673.2492,-255.1053 675.4097,-261.7635"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="810.7947,-412.2554 666.5925,-412.2554 666.5925,-390.2446 810.7947,-390.2446 810.7947,-412.2554"/>
<text text-anchor="middle" x="738.6936" y="-398.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M589.1258,-357.3597C605.9761,-364.5407 628.8057,-373.7289 649.5242,-380.25 658.1027,-382.9501 667.2421,-385.4819 676.276,-387.7882"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="675.4576,-391.1911 686.0059,-390.1994 677.1414,-384.3967 675.4576,-391.1911"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="985.8839,-138.2554 896.6484,-138.2554 896.6484,-116.2446 985.8839,-116.2446 985.8839,-138.2554"/>
<text text-anchor="middle" x="941.2661" y="-124.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M738.6936,-283.25C776.6611,-269.0943 796.2683,-289.621 827.863,-264.25 857.9484,-240.091 839.6716,-215.3093 863.863,-185.25 877.2403,-168.6279 896.4066,-154.2178 912.3198,-143.9188"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="914.6176,-146.6103 921.245,-138.3442 910.9093,-140.6732 914.6176,-146.6103"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7684,-335.1295C602.8023,-326.7078 627.2696,-315.2597 649.5242,-307.25 688.1404,-293.3514 700.2382,-297.5876 738.6936,-283.25"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="982.2119,-216.2554 900.3203,-216.2554 900.3203,-194.2446 982.2119,-194.2446 982.2119,-216.2554"/>
<text text-anchor="middle" x="941.2661" y="-202.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M738.6936,-283.25C776.6611,-269.0943 791.9851,-283.0831 827.863,-264.25 847.3494,-254.0212 844.9261,-241.4633 863.863,-230.25 872.1599,-225.3371 881.5375,-221.2664 890.8289,-217.9382"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="892.0532,-221.2194 900.4314,-214.7344 889.8377,-214.5792 892.0532,-221.2194"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2124.7266,-387.133C2132.269,-383.3677 2140.1413,-378.708 2146.6194,-373.25 2184.4162,-341.4051 2215.7489,-291.8231 2231.4516,-264.3272"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2234.6899,-265.707 2236.5127,-255.2701 2228.5792,-262.2923 2234.6899,-265.707"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1463.1519,-356.9796C1530.7659,-353.2189 1655.7972,-348.8092 1761.791,-359.25"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1642.6148,-458.2554 1498.9397,-458.2554 1498.9397,-436.2446 1642.6148,-436.2446 1642.6148,-458.2554"/>
<text text-anchor="middle" x="1570.7772" y="-444.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1433.6107,-371.2686C1460.957,-386.4167 1510.3442,-413.774 1541.7989,-431.1979"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1540.1076,-434.2621 1550.5511,-436.0461 1543.4995,-428.1387 1540.1076,-434.2621"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2428.0426,-257.2554 2344.6256,-257.2554 2344.6256,-235.2446 2428.0426,-235.2446 2428.0426,-257.2554"/>
<text text-anchor="middle" x="2386.3341" y="-243.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1448,-245.0808C2312.8094,-245.2289 2323.8412,-245.3821 2334.2676,-245.5269"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2334.4084,-249.0291 2344.456,-245.6684 2334.5056,-242.0298 2334.4084,-249.0291"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2434.4552,-216.2554 2338.213,-216.2554 2338.213,-194.2446 2434.4552,-194.2446 2434.4552,-216.2554"/>
<text text-anchor="middle" x="2386.3341" y="-202.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2283.2046,-233.1785C2299.4709,-228.7734 2318.3611,-223.6578 2335.4961,-219.0174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2336.6115,-222.3415 2345.3489,-216.3492 2334.7817,-215.5849 2336.6115,-222.3415"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1761.791,-544.25C1843.201,-554.4239 1864.7893,-535.7244 1946.3884,-544.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1584.4962,-458.5248C1614.4139,-482.0861 1688.7172,-535.1179 1761.791,-544.25"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1844.9817,-477.2554 1678.6003,-477.2554 1678.6003,-455.2446 1844.9817,-455.2446 1844.9817,-477.2554"/>
<text text-anchor="middle" x="1761.791" y="-463.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1642.4472,-454.379C1650.8929,-455.219 1659.6043,-456.0856 1668.2936,-456.9499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1668.1692,-460.4547 1678.4665,-457.9618 1668.8621,-453.4891 1668.1692,-460.4547"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1946.3884,-544.25C2013.022,-551.212 2036.3292,-572.3882 2097.13,-544.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1778.6672,-477.4465C1810.0687,-497.3242 1880.2961,-537.3445 1946.3884,-544.25"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2011.3938,-477.2554 1881.3831,-477.2554 1881.3831,-455.2446 2011.3938,-455.2446 2011.3938,-477.2554"/>
<text text-anchor="middle" x="1946.3884" y="-463.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1845.1787,-466.25C1853.9003,-466.25 1862.729,-466.25 1871.3494,-466.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1871.3545,-469.7501 1881.3545,-466.25 1871.3544,-462.7501 1871.3545,-469.7501"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1970.9432,-455.1733C1996.0181,-443.8619 2035.1386,-426.2145 2063.1732,-413.568"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2064.9095,-416.6245 2072.5858,-409.322 2062.0311,-410.2436 2064.9095,-416.6245"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1955.4255,-477.3243C1978.6245,-504.341 2042.31,-569.6204 2097.13,-544.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2097.13,-544.25C2206.8942,-493.4519 2234.209,-325.5989 2240.5373,-265.7126"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2244.0422,-265.8286 2241.5158,-255.5394 2237.0744,-265.1584 2244.0422,-265.8286"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1007.5603,-276.4442C1019.4722,-275.2214 1032.0165,-273.9336 1044.3103,-272.6715"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1044.9685,-276.1224 1054.5587,-271.6194 1044.2535,-269.159 1044.9685,-276.1224"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M958.2137,-294.3054C989.7416,-313.9321 1060.2216,-353.4455 1126.3429,-360.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1126.3429,-360.25C1194.7949,-367.2943 1212.8658,-368.5801 1281.1732,-360.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1281.1732,-360.25C1304.8444,-357.3633 1331.0708,-356.8137 1353.9049,-357.182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1354.0604,-360.6863 1364.1361,-357.4108 1354.2169,-353.688 1354.0604,-360.6863"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M967.3906,-272.2399C999.5413,-258.6901 1054.298,-235.6131 1090.399,-220.3984"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1092.1966,-223.439 1100.0524,-216.3301 1089.478,-216.9885 1092.1966,-223.439"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M792.9793,-488.8973C820.6394,-493.8129 854.3084,-499.7964 882.5689,-504.8187"/>
<polygon fill="#ffda00" stroke="#ffda00" points="882.2566,-508.3179 892.7148,-506.6217 883.4815,-501.4259 882.2566,-508.3179"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M792.8875,-476.6875C833.7004,-475.1849 891.0203,-473.9832 941.2661,-476.25"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M941.2661,-476.25C992.2399,-478.5496 1049.5222,-463.6883 1086.6737,-451.6519"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1088.214,-454.8281 1096.5965,-448.3485 1086.0029,-448.1864 1088.214,-454.8281"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M941.2661,-476.25C976.6528,-477.8464 985.6564,-482.408 1018.6692,-495.25 1069.5252,-515.0331 1072.0163,-549.1197 1126.3429,-554.25"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1126.3429,-554.25C1407.5481,-580.8056 1481.5148,-509.2235 1761.791,-544.25"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M827.8731,-355.0816C906.6154,-351.748 1024.4166,-349.7608 1126.3429,-360.25"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1018.5724,-410.2554 863.9598,-410.2554 863.9598,-388.2446 1018.5724,-388.2446 1018.5724,-410.2554"/>
<text text-anchor="middle" x="941.2661" y="-396.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M795.9305,-371.2695C820.203,-375.9425 848.6671,-381.4225 873.9408,-386.2883"/>
<polygon fill="#48ff00" stroke="#48ff00" points="873.3382,-389.7365 883.8196,-388.1902 874.6616,-382.8627 873.3382,-389.7365"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M823.6512,-240.4136C859.9674,-239.7655 902.7807,-240.3184 941.2661,-244.25"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1004.7688,-22.2554 877.7634,-22.2554 877.7634,-.2446 1004.7688,-.2446 1004.7688,-22.2554"/>
<text text-anchor="middle" x="941.2661" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M763.392,-233.0507C783.0132,-223.1114 810.0297,-206.9624 827.863,-186.25 853.0386,-157.01 843.5943,-140.0824 863.863,-107.25 881.6929,-78.3681 907.1249,-48.4406 923.9049,-29.8395"/>
<polygon fill="#00ff91" stroke="#00ff91" points="926.572,-32.1093 930.7333,-22.3658 921.4042,-27.3876 926.572,-32.1093"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M941.2661,-438.25C978.0722,-439.7373 1019.0287,-439.6919 1053.0372,-439.1884"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1053.4152,-442.6828 1063.3563,-439.0186 1053.3,-435.6837 1053.4152,-442.6828"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M779.8249,-412.2673C820.4855,-422.3239 884.6475,-435.9622 941.2661,-438.25"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M986.1747,-135.1781C997.7286,-138.884 1009.4792,-144.3105 1018.6692,-152.25 1046.0434,-175.8994 1029.6084,-199.1617 1054.6692,-225.25 1063.8842,-234.8428 1075.9819,-242.6454 1087.6079,-248.6805"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1086.2436,-251.9091 1096.7664,-253.142 1089.3092,-245.616 1086.2436,-251.9091"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M986.068,-126.0396C1008.8223,-125.4249 1036.8792,-124.6669 1061.9063,-123.9908"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1062.1547,-127.4855 1072.0565,-123.7166 1061.9656,-120.488 1062.1547,-127.4855"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M979.454,-138.3748C992.0784,-142.3716 1006.1044,-147.1598 1018.6692,-152.25 1045.92,-163.2898 1075.8456,-178.2632 1097.2165,-189.479"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1095.6304,-192.5995 1106.1057,-194.1864 1098.9064,-186.4133 1095.6304,-192.5995"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M976.0776,-216.3474C1006.0644,-225.9068 1049.5162,-239.7587 1081.9892,-250.1106"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1081.0968,-253.4996 1091.6875,-253.2023 1083.2229,-246.8303 1081.0968,-253.4996"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M982.3406,-205.25C1006.7037,-205.25 1038.045,-205.25 1065.2643,-205.25"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1065.4715,-208.7501 1075.4715,-205.25 1065.4714,-201.7501 1065.4715,-208.7501"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1281.1732,-283.25C1321.4941,-299.1063 1364.1373,-325.9366 1389.8416,-343.3701"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1387.9718,-346.3319 1398.1956,-349.1112 1391.9365,-340.5629 1387.9718,-346.3319"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1761.791,-359.25C1934.3966,-377.5658 2134.3556,-295.081 2210.5912,-259.7009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2212.1186,-262.8504 2219.6822,-255.4314 2209.1428,-256.5144 2212.1186,-262.8504"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1146.7591,-216.2975C1161.1141,-224.0803 1180.7618,-234.7628 1198.0166,-244.25 1214.0554,-253.0686 1217.4963,-256.3702 1234.0166,-264.25 1254.4112,-273.9777 1260.145,-274.9806 1281.1732,-283.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1281.1732,-283.25C1293.7519,-288.1966 1748.3058,-358.3333 1761.791,-359.25"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1177.2159,-205.25C1234.6528,-205.25 1330.899,-205.25 1413.7192,-205.25 1413.7192,-205.25 1413.7192,-205.25 1946.3884,-205.25 2077.9143,-205.25 2111.0887,-214.0233 2242.3217,-205.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2242.3217,-205.25C2270.3912,-203.2306 2301.6179,-202.987 2327.7991,-203.348"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2327.881,-206.8498 2337.9393,-203.5209 2328.0005,-199.8508 2327.881,-206.8498"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M995.2955,-410.3433C1016.3912,-414.6747 1040.7365,-419.6733 1062.6757,-424.1778"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1062.0667,-427.6257 1072.5663,-426.2086 1063.4746,-420.7688 1062.0667,-427.6257"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M955.9491,-388.1215C971.8363,-375.8938 997.7069,-355.434 1018.6692,-336.25 1035.5949,-320.76 1036.0852,-312.7056 1054.6692,-299.25 1065.0969,-291.6999 1077.4034,-285.0176 1088.8489,-279.5686"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1090.5635,-282.6331 1098.2004,-275.2895 1087.6509,-276.2678 1090.5635,-282.6331"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1018.7771,-400.8425C1051.9384,-401.0032 1091.0697,-400.5019 1126.3429,-398.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1126.3429,-398.25C1197.0546,-393.7357 1210.8386,-368.8273 1281.1732,-360.25"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1126.3429,-398.25C1264.8059,-389.4105 1426.567,-416.7995 1511.5988,-434.1378"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1511.0802,-437.6045 1521.5815,-436.1993 1512.496,-430.7491 1511.0802,-437.6045"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1328.487,-255.2554 1233.8595,-255.2554 1233.8595,-233.2446 1328.487,-233.2446 1328.487,-255.2554"/>
<text text-anchor="middle" x="1281.1732" y="-241.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M964.6316,-388.0885C987.4965,-377.2234 1023.3547,-360.336 1054.6692,-346.25 1117.9732,-317.7743 1134.8723,-313.0782 1198.0166,-284.25 1215.1539,-276.426 1234.0935,-267.3498 1249.5635,-259.8227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1251.2501,-262.8942 1258.7003,-255.3612 1248.1786,-256.604 1251.2501,-262.8942"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1305.6095,-255.2611C1313.2115,-259.1873 1321.408,-263.9625 1328.3298,-269.25 1356.2243,-290.5585 1383.014,-321.3462 1398.9237,-341.0787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1396.285,-343.3843 1405.2403,-349.0461 1401.7703,-339.0355 1396.285,-343.3843"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2097.13,-244.25C2121.6677,-242.6096 2148.5902,-242.2195 2172.516,-242.365"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2172.5387,-245.8653 2182.5707,-242.4581 2172.6035,-238.8656 2172.5387,-245.8653"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1328.5783,-244.25C1385.9336,-244.25 1485.4295,-244.25 1570.7772,-244.25 1570.7772,-244.25 1570.7772,-244.25 1761.791,-244.25 1910.8306,-244.25 1948.4224,-254.1915 2097.13,-244.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2097.13,-244.25C2163.7332,-238.9092 2175.6534,-209.7069 2242.3217,-205.25"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M983.3733,-22.3114C1047.2515,-39.7216 1164.7414,-74.4029 1198.0166,-102.25 1237.6053,-135.3807 1262.7369,-192.4874 1274.0967,-223.2175"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1270.8933,-224.6554 1277.5416,-232.9046 1277.4886,-222.3099 1270.8933,-224.6554"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1179.3353,-27.2554 1073.3505,-27.2554 1073.3505,-5.2446 1179.3353,-5.2446 1179.3353,-27.2554"/>
<text text-anchor="middle" x="1126.3429" y="-13.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1004.959,-12.9707C1023.7509,-13.4784 1044.3061,-14.0337 1063.0714,-14.5407"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1063.199,-18.0453 1073.2899,-14.8167 1063.3881,-11.0479 1063.199,-18.0453"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoairmultispeedhp.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1152.2197,-27.3849C1167.1805,-34.8852 1185.4672,-46.0091 1198.0166,-60.25 1241.7045,-109.8264 1266.1409,-186.1548 1275.99,-222.9594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1272.702,-224.2268 1278.5835,-233.0392 1279.4812,-222.4825 1272.702,-224.2268"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacwatertoairmultispeedhpf90AfferentGraph = svgPanZoom('#sourcefilehvacwatertoairmultispeedhpf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/variablespeedcoils.html">VariableSpeedCoils</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html#src">HVACWatertoAirMultiSpeedHP.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">VariableSpeedCoils</span>
<a name="ln-2"></a>
<a name="ln-3"></a> <span class="c">! USE STATEMENTS:</span>
<a name="ln-4"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-5"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-6"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-7"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-8"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-9"></a><span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-10"></a><span class="k">Use </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">CurMnDy</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-11"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-12"></a><span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-13"></a><span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">,</span> <span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span>
<a name="ln-14"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-15"></a>
<a name="ln-16"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-17"></a>
<a name="ln-18"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-19"></a>
<a name="ln-20"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-21"></a>
<a name="ln-22"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletAirTemp</span>   <span class="o">=</span> <span class="mi">2</span><span class="mf">6.6667d0</span>   <span class="c">! 26.6667C or 80F</span>
<a name="ln-25"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletWetbulbTemp</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">9.44d0</span>   <span class="c">! 19.44 or 67F, cooling mode</span>
<a name="ln-26"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletAirHumRat</span> <span class="o">=</span> <span class="mf">0.01125d0</span>   <span class="c">! Humidity ratio corresponding to 80F dry bulb/67F wet bulb</span>
<a name="ln-27"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletWaterTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">9.4d0</span>      <span class="c">! 85 F cooling mode</span>
<a name="ln-28"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedAmbAirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.0d0</span>      <span class="c">! 95 F cooling mode</span>
<a name="ln-29"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletAirTempHeat</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.11d0</span>   <span class="c">! 21.11C or 70F, heating mode</span>
<a name="ln-30"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletWaterTempHeat</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.11d0</span>  <span class="c">! 21.11C or 70F, heating mode</span>
<a name="ln-31"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedAmbAirTempHeat</span> <span class="o">=</span> <span class="mf">8.33d0</span>  <span class="c">! 8.33 or 47F, heating mode</span>
<a name="ln-32"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedAmbAirWBHeat</span> <span class="o">=</span> <span class="mf">6.11d0</span>   <span class="c">!  8.33 or 43F, heating mode, rated wet bulb temperature</span>
<a name="ln-33"></a>
<a name="ln-34"></a><span class="c">! Airflow per total capacity range</span>
<a name="ln-35"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxRatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.00006041d0</span> <span class="c">! m3/s per watt = 450 cfm/ton</span>
<a name="ln-36"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinRatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.00004027d0</span> <span class="c">! m3/s per watt = 300 cfm/ton</span>
<a name="ln-37"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxHeatVolFlowPerRatedTotCap</span>  <span class="o">=</span> <span class="mf">0.00008056d0</span> <span class="c">! m3/s per watt = 600 cfm/ton</span>
<a name="ln-38"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxCoolVolFlowPerRatedTotCap</span>  <span class="o">=</span> <span class="mf">0.00006713d0</span> <span class="c">! m3/s per watt = 500 cfm/ton</span>
<a name="ln-39"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinOperVolFlowPerRatedTotCap</span>  <span class="o">=</span> <span class="mf">0.00002684d0</span> <span class="c">! m3/s per watt = 200 cfm/ton</span>
<a name="ln-40"></a>
<a name="ln-41"></a><span class="c">!Water Systems</span>
<a name="ln-42"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateDiscarded</span> <span class="o">=</span> <span class="mi">1001</span> <span class="c">! default mode where water is &quot;lost&quot;</span>
<a name="ln-43"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateToTank</span>    <span class="o">=</span> <span class="mi">1002</span> <span class="c">! collect coil condensate from air and store in water storage tank</span>
<a name="ln-44"></a>
<a name="ln-45"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterSupplyFromMains</span> <span class="o">=</span> <span class="mi">101</span>
<a name="ln-46"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterSupplyFromTank</span>  <span class="o">=</span> <span class="mi">102</span>
<a name="ln-47"></a>
<a name="ln-48"></a><span class="c">! Curve Types</span>
<a name="ln-49"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Linear</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-50"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Bilinear</span>    <span class="o">=</span> <span class="mi">2</span>
<a name="ln-51"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Quadratic</span>   <span class="o">=</span> <span class="mi">3</span>
<a name="ln-52"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Biquadratic</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-53"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Cubic</span>       <span class="o">=</span> <span class="mi">5</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="c">! Defrost strategy (heat pump only)</span>
<a name="ln-56"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ReverseCycle</span>     <span class="o">=</span> <span class="mi">1</span> <span class="c">! uses reverse cycle defrost strategy</span>
<a name="ln-57"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Resistive</span>        <span class="o">=</span> <span class="mi">2</span> <span class="c">! uses electric resistance heater for defrost</span>
<a name="ln-58"></a><span class="c">! Defrost control  (heat pump only)</span>
<a name="ln-59"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Timed</span>            <span class="o">=</span> <span class="mi">1</span> <span class="c">! defrost cycle is timed</span>
<a name="ln-60"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OnDemand</span>         <span class="o">=</span> <span class="mi">2</span> <span class="c">! defrost cycle occurs only when required</span>
<a name="ln-61"></a>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxSpedLevels</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c">! Maximum number of speed that supports</span>
<a name="ln-63"></a>
<a name="ln-64"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-65"></a><span class="k">TYPE</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">VariableSpeedCoilData</span> <span class="c">! variable speed coil</span>
<a name="ln-66"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! Name of the  Coil</span>
<a name="ln-67"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VarSpeedCoilType</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! type of coil</span>
<a name="ln-68"></a>
<a name="ln-69"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfSpeeds</span>    <span class="o">=</span><span class="mi">2</span>   <span class="c">! Number of speeds</span>
<a name="ln-70"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NormSpedLevel</span>    <span class="o">=</span><span class="n">MaxSpedLevels</span>   <span class="c">! Nominal speed level</span>
<a name="ln-71"></a>
<a name="ln-72"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterVolFlowRate</span>           <span class="o">=</span><span class="n">AUTOSIZE</span>  <span class="c">! Rated/Ref Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-73"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterMassFlowRate</span>          <span class="o">=</span><span class="n">AUTOSIZE</span>  <span class="c">! Rated/Ref Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-74"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRate</span>             <span class="o">=</span><span class="n">AUTOSIZE</span>  <span class="c">! Rated/Ref Air Volumetric Flow Rate [m3/s]</span>
<a name="ln-75"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapHeat</span>                    <span class="o">=</span><span class="n">AUTOSIZE</span>  <span class="c">! Rated/Ref Heating Capacity [W]</span>
<a name="ln-76"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolTotal</span>               <span class="o">=</span><span class="n">AUTOSIZE</span>  <span class="c">! Rated/Ref Total Cooling Capacity [W]</span>
<a name="ln-77"></a>
<a name="ln-78"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum ON/OFF cycles per hour for the compressor (cycles/hour)</span>
<a name="ln-79"></a>
<a name="ln-80"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">Twet_Rated</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s</span>
<a name="ln-81"></a>                                                   <span class="c">! condensate drain line (sec)</span>
<a name="ln-82"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">Gamma_Rated</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Initial moisture evaporation rate divided by steady-state</span>
<a name="ln-83"></a>                                                   <span class="c">! AC latent capacity (dimensionless)</span>
<a name="ln-84"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HOTGASREHEATFLG</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">!whether to use hot gas reheat</span>
<a name="ln-85"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Heat pump time constant [s]</span>
<a name="ln-86"></a>
<a name="ln-87"></a>  <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">PLFFPLR</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! index of part load curve as a function of part load ratio</span>
<a name="ln-88"></a>
<a name="ln-89"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolHeatType</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Type of WatertoAirHP ie. Heating or Cooling</span>
<a name="ln-90"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">VSCoilTypeOfNum</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! type of component in plant</span>
<a name="ln-91"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Simflag</span>                         <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! Heat Pump Simulation Flag</span>
<a name="ln-92"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignWaterMassFlowRate</span>         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! design water mass flow rate [kg/s]</span>
<a name="ln-93"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignWaterVolFlowRate</span>          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! design water volumetric flow rate [m3/s]</span>
<a name="ln-94"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignAirMassFlowRate</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Design Air Mass Flow Rate [kg/s]</span>
<a name="ln-95"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignAirVolFlowRate</span>            <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Design Air Volumetric Flow Rate [m3/s]</span>
<a name="ln-96"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolFlowRate</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air Volumetric Flow Rate[m3/s], real time</span>
<a name="ln-97"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air Mass Flow Rate[kg/s], real time</span>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirPressure</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">!air inlet pressure [pa]</span>
<a name="ln-99"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDBTemp</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Air Dry Bulb Temperature [C], real time</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Air Humidity Ratio [kg/kg], real time</span>
<a name="ln-101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Air Enthalpy [J/kg], real time</span>
<a name="ln-102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDBTemp</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Air Dry Bulb Temperature [C], real time</span>
<a name="ln-103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Air Humidity Ratio [kg/kg], real time</span>
<a name="ln-104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>               <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Air Enthalpy [J/kg], real time</span>
<a name="ln-105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterVolFlowRate</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Water Volumetric Flow Rate [m3/s], real time</span>
<a name="ln-106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>               <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Water Mass Flow Rate [kg/s], real time</span>
<a name="ln-107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterTemp</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Water Temperature [C]</span>
<a name="ln-108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterEnthalpy</span>              <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Water Enthalpy [J/kg]</span>
<a name="ln-109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTemp</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Water Temperature [C]</span>
<a name="ln-110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterEnthalpy</span>             <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Water Enthalpy [J/kg]</span>
<a name="ln-111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Power</span>                           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Power Consumption [W]</span>
<a name="ln-112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Load Side Total Heat Transfer Rate [W]</span>
<a name="ln-113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSensible</span>                       <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Sensible Load Side Heat Transfer Rate [W]</span>
<a name="ln-114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatent</span>                         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Latent Load Side Heat Transfer Rate [W]</span>
<a name="ln-115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Recoverable waste Heat Transfer Rate [W]</span>
<a name="ln-117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Energy</span>                          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Energy Consumption [J]</span>
<a name="ln-118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyLoadTotal</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Load Side Total Heat Transferred [J]</span>
<a name="ln-119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergySensible</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Sensible Load Side Heat Transferred [J]</span>
<a name="ln-120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyLatent</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Latent Load Side Heat Transferred [J]</span>
<a name="ln-121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergySource</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Source Side Heat Transferred [J]</span>
<a name="ln-122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COP</span>                             <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Heat Pump Coefficient of Performance [-]</span>
<a name="ln-123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFrac</span>                         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Duty Factor</span>
<a name="ln-124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Part Load Ratio</span>
<a name="ln-125"></a>
<a name="ln-126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedPowerHeat</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Heating Power Consumption[W]</span>
<a name="ln-127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCOPHeat</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Heating COP [W/W]</span>
<a name="ln-128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolSens</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Sensible Cooling Capacity [W]</span>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedPowerCool</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Cooling Power Consumption[W]</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCOPCool</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Cooling COP [W/W]</span>
<a name="ln-131"></a>
<a name="ln-132"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirInletNodeNum</span>              <span class="o">=</span><span class="mi">0</span>    <span class="c">! Node Number of the Air Inlet</span>
<a name="ln-133"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirOutletNodeNum</span>             <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node Number of the Air Outlet</span>
<a name="ln-134"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterInletNodeNum</span>            <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node Number of the Water Onlet</span>
<a name="ln-135"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterOutletNodeNum</span>           <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node Number of the Water Outlet</span>
<a name="ln-136"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopNum</span>                      <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant loop index for water side</span>
<a name="ln-137"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopSide</span>                     <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant loop side index</span>
<a name="ln-138"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">BranchNum</span>                    <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant branch index</span>
<a name="ln-139"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompNum</span>                      <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant component index</span>
<a name="ln-140"></a><span class="c">! set by parent object and &quot;pushed&quot; to this structure in SetVSWSHPData subroutine</span>
<a name="ln-141"></a>
<a name="ln-142"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">FindCompanionUpStreamCoil</span>    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>    <span class="c">! Flag to get the companion coil in Init.</span>
<a name="ln-143"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompanionCoolingCoilNum</span>      <span class="o">=</span><span class="mi">0</span>           <span class="c">! Heating coil companion cooling coil index</span>
<a name="ln-144"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompanionHeatingCoilNum</span>      <span class="o">=</span><span class="mi">0</span>           <span class="c">! Cooling coil companion heating coil index</span>
<a name="ln-145"></a>
<a name="ln-146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-147"></a>
<a name="ln-148"></a>  <span class="c">! beginning for multispeed coil type</span>
<a name="ln-149"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSErrIndex</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c">! index flag for num speeds/recurring messages</span>
<a name="ln-150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Percentage to the total cooling capacity for MS heat pump at the highest speed [dimensionless]</span>
<a name="ln-151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Rated cooling capacity for MS heat pump [W]</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Rated SHR for MS heat pump [dimensionless]</span>
<a name="ln-153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Rated COP for MS heat pump [dimensionless]</span>
<a name="ln-154"></a>
<a name="ln-155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-156"></a>  <span class="c">! Rated Air volume flow rate per total capacity through unit at rated conditions [m^3/w]</span>
<a name="ln-157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-158"></a>  <span class="c">! Air volume flow rate through unit at rated conditions [m3/s]</span>
<a name="ln-159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-160"></a>  <span class="c">! Air mass flow rate through unit at rated conditions [kg/s]</span>
<a name="ln-161"></a>
<a name="ln-162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedWaterVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-163"></a>  <span class="c">! Rated water volume flow rate per total  capacity through unit at rated conditions [m^3/w]</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-165"></a>  <span class="c">! Water volume flow rate through unit at rated conditions [m3/s]</span>
<a name="ln-166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-167"></a>  <span class="c">! Water mass flow rate through unit at rated conditions [kg/s]</span>
<a name="ln-168"></a>
<a name="ln-169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-170"></a>  <span class="c">! rated coil bypass factor</span>
<a name="ln-171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSEffectiveAo</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-172"></a>  <span class="c">! effective heat transfer surface at each speed</span>
<a name="ln-173"></a>
<a name="ln-174"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-175"></a>  <span class="c">! index of total capacity modifier curve</span>
<a name="ln-176"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-177"></a>  <span class="c">! index of total capacity modifier curve as a function of air flow</span>
<a name="ln-178"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>  <span class="c">! index of total capacity modifier curve as a function of water flow</span>
<a name="ln-180"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-181"></a>  <span class="c">! index of energy input ratio modifier curve as a function of temperature</span>
<a name="ln-182"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-183"></a>  <span class="c">! index of energy input ratio modifier curve as a function of air flow fraction</span>
<a name="ln-184"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-185"></a>  <span class="c">! index of energy input ratio modifier curve as a function of water flow fraction</span>
<a name="ln-186"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-187"></a>  <span class="c">! index of waste heat as a function of temperature</span>
<a name="ln-188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-189"></a>  <span class="c">! Waste heat fraction</span>
<a name="ln-190"></a>
<a name="ln-191"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">SpeedNumReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-192"></a>  <span class="c">!speed number for output</span>
<a name="ln-193"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">SpeedRatioReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-194"></a>  <span class="c">!speed ratio for output between two neighboring speeds</span>
<a name="ln-195"></a>  <span class="c">! End of multispeed water source coil input</span>
<a name="ln-196"></a>
<a name="ln-197"></a>  <span class="c">!----------------------------------------------------------------</span>
<a name="ln-198"></a>  <span class="c">!added variables and arrays for variable speed air-source heat pump</span>
<a name="ln-199"></a>  <span class="c">!defrosting</span>
<a name="ln-200"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DefrostStrategy</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! defrost strategy; 1=reverse-cycle, 2=resistive</span>
<a name="ln-201"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DefrostControl</span>         <span class="o">=</span> <span class="mi">0</span>   <span class="c">! defrost control; 1=timed, 2=on-demand</span>
<a name="ln-202"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFPLR</span>                <span class="o">=</span> <span class="mi">0</span>   <span class="c">! index of energy input ratio vs part-load ratio curve</span>
<a name="ln-203"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DefrostEIRFT</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! index of defrost mode total cooling capacity for reverse cycle heat pump</span>
<a name="ln-204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinOATCompressor</span>       <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Minimum OAT for heat pump compressor operation</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OATempCompressorOn</span>   <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! The outdoor tempearture when the compressor is automatically turned back on,</span>
<a name="ln-206"></a>                                           <span class="c">! if applicable, following automatic shut off. This field is used only for</span>
<a name="ln-207"></a>                                           <span class="c">! HSPF calculation.</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxOATDefrost</span>          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Maximum OAT for defrost operation</span>
<a name="ln-209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostTime</span>            <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Defrost time period in hours</span>
<a name="ln-210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostCapacity</span>        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Resistive defrost to nominal capacity (at 21.11C/8.33C) ratio</span>
<a name="ln-211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPCompressorRuntime</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! keep track of compressor runtime</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPCompressorRuntimeLast</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! keep track of last time step compressor runtime (if simulation downshifts)</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TimeLeftToDefrost</span>      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! keep track of time left to defrost heat pump</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostPower</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! power used during defrost</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostConsumption</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! energy used during defrost</span>
<a name="ln-216"></a>
<a name="ln-217"></a>  <span class="c">!crankcase heater</span>
<a name="ln-218"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ReportCoolingCoilCrankcasePower</span> <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! logical determines if the cooling coil crankcase heater power is reported</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! total crankcase heater capacity [W]</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterPower</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! report variable for average crankcase heater power [W]</span>
<a name="ln-221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxOATCrankcaseHeater</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! maximum OAT for crankcase heater operation [C]</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterConsumption</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! report variable for total crankcase heater energy consumption [J]</span>
<a name="ln-223"></a>
<a name="ln-224"></a>  <span class="c">!condenser evaporative precooling</span>
<a name="ln-225"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CondenserInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Node number of outdoor condenser</span>
<a name="ln-226"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CondenserType</span> <span class="o">=</span> <span class="n">AirCooled</span> <span class="c">! Type of condenser for DX cooling coil: AIR COOLED or EVAP COOLED</span>
<a name="ln-227"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ReportEvapCondVars</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! true if any performance mode includes an evap condenser</span>
<a name="ln-228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPower</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Nominal power input to the evap condenser water circulation pump [W]</span>
<a name="ln-229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span><span class="mf">0.0d0</span>    <span class="c">! Average power consumed by the evap condenser water circulation pump over</span>
<a name="ln-230"></a>                                           <span class="c">! the time step [W]</span>
<a name="ln-231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterConsumpRate</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Evap condenser water consumption rate [m3/s]</span>
<a name="ln-232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Electric energy consumed by the evap condenser water circulation pump [J]</span>
<a name="ln-233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterConsump</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Evap condenser water consumption [m3]</span>
<a name="ln-234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterConsumption</span>    <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Basin heater energy consumption (J)</span>
<a name="ln-235"></a>
<a name="ln-236"></a>
<a name="ln-237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterPowerFTempDiff</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Basin heater capacity per degree C below setpoint (W/C)</span>
<a name="ln-238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterSetPointTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! setpoint temperature for basin heater operation (C)</span>
<a name="ln-239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterPower</span>          <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Basin heater power (W)</span>
<a name="ln-240"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BasinHeaterSchedulePtr</span>  <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Pointer to basin heater schedule</span>
<a name="ln-241"></a>
<a name="ln-242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air flow rate through the evap condenser at high speed, volumetric flow rate</span>
<a name="ln-243"></a>                                                 <span class="c">! for water use calcs [m3/s]</span>
<a name="ln-244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! effectiveness of the evaporatively cooled condenser</span>
<a name="ln-245"></a>                                            <span class="c">! [high speed for multi-speed unit] (-)</span>
<a name="ln-246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedEvapCondVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!evap condenser air flow ratio to capacity</span>
<a name="ln-247"></a>
<a name="ln-248"></a>  <span class="c">!begin variables for Water System interactions</span>
<a name="ln-249"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">EvapWaterSupplyMode</span>                   <span class="o">=</span> <span class="n">WaterSupplyFromMains</span> <span class="c">!  where does water come from</span>
<a name="ln-250"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-251"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">EvapWaterSupTankID</span>                    <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-252"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">EvapWaterTankDemandARRID</span>              <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-253"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateCollectMode</span>                 <span class="o">=</span> <span class="n">CondensateDiscarded</span> <span class="c">!  where does water come from</span>
<a name="ln-254"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-255"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateTankID</span>                      <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateTankSupplyARRID</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-257"></a>
<a name="ln-258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondensateVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! rate of water condensation from air stream [m3/s]</span>
<a name="ln-259"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondensateVol</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! amount of water condensed from air stream [m3]</span>
<a name="ln-260"></a>
<a name="ln-261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondInletTemp</span>  <span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Evap condenser inlet temperature [C], report variable</span>
<a name="ln-262"></a>
<a name="ln-263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SourceAirMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! source air mass flow rate [kg/s]</span>
<a name="ln-264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">InletSourceAirTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!source air temperature entering the outdoor coil [C]</span>
<a name="ln-265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">InletSourceAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!source air enthalpy entering the outdoor coil [J/kg]</span>
<a name="ln-266"></a>
<a name="ln-267"></a>  <span class="c">!end variables for water system interactions</span>
<a name="ln-268"></a>
<a name="ln-269"></a><span class="k">END TYPE </span><span class="n">VariableSpeedCoilData</span>
<a name="ln-270"></a>
<a name="ln-271"></a>
<a name="ln-272"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-273"></a>  <span class="c">! Identifier is VarSpeedCoil</span>
<a name="ln-274"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">NumWatertoAirHPs</span>  <span class="o">=</span> <span class="mi">0</span>        <span class="c">! The Number of Water to Air Heat Pumps found in the Input</span>
<a name="ln-275"></a>
<a name="ln-276"></a><span class="kt">LOGICAL</span>        <span class="kd">::</span> <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! Flag set to make sure you get input once</span>
<a name="ln-277"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">VariableSpeedCoilData</span><span class="p">)</span> <span class="p">,</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">VarSpeedCoil</span>
<a name="ln-278"></a><span class="c">! LOGICAL, ALLOCATABLE, DIMENSION(:) :: MySizeFlag</span>
<a name="ln-279"></a>
<a name="ln-280"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Mass flow rate [Kg/s]</span>
<a name="ln-281"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Inlet Temperature [C]</span>
<a name="ln-282"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideInletEnth</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Inlet Enthalpy [J/kg]</span>
<a name="ln-283"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Mass flow rate [Kg/s]</span>
<a name="ln-284"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletDBTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Inlet Dry Bulb Temp [C]</span>
<a name="ln-285"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletWBTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Inlet Wet Bulb Temp [C]</span>
<a name="ln-286"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletHumRat</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Humidity ratio</span>
<a name="ln-287"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletEnth</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Inlet Enthalpy [J/kg]</span>
<a name="ln-288"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletDBTemp</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Dry Bulb Temp [C]</span>
<a name="ln-289"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Humidity ratio</span>
<a name="ln-290"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletEnth</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Enthalpy [J/kg]</span>
<a name="ln-291"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSensible</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load side sensible heat transfer rate [W]</span>
<a name="ln-292"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load side total heat transfer rate [W]</span>
<a name="ln-293"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Latent Capacity [W] rated at entering air conditions [Tdb=26.7C Twb=19.4C]</span>
<a name="ln-294"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Actual Latent Capacity [W]</span>
<a name="ln-295"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source side heat transfer rate [W]</span>
<a name="ln-296"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Winput</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Power Consumption [W]</span>
<a name="ln-297"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLRCorrLoadSideMdot</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Mdot corrected for Part Load Ratio of the unit</span>
<a name="ln-298"></a>
<a name="ln-299"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-300"></a>
<a name="ln-301"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-302"></a><span class="k">PUBLIC </span><span class="n">SimVariableSpeedCoils</span>
<a name="ln-303"></a>
<a name="ln-304"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-305"></a><span class="k">PRIVATE </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-306"></a>
<a name="ln-307"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-308"></a><span class="k">PRIVATE </span><span class="n">InitVarSpeedCoil</span>
<a name="ln-309"></a><span class="k">PRIVATE </span><span class="n">SizeVarSpeedCoil</span>
<a name="ln-310"></a>
<a name="ln-311"></a>          <span class="c">! Update routines to check convergence and update nodes</span>
<a name="ln-312"></a><span class="k">PUBLIC  </span><span class="n">CalcVarSpeedCoilCooling</span>
<a name="ln-313"></a><span class="k">PUBLIC  </span><span class="n">CalcVarSpeedCoilHeating</span>
<a name="ln-314"></a>
<a name="ln-315"></a>          <span class="c">! Update routine</span>
<a name="ln-316"></a><span class="k">PRIVATE </span><span class="n">UpdateVarSpeedCoil</span>
<a name="ln-317"></a>
<a name="ln-318"></a>          <span class="c">! Utility routines</span>
<a name="ln-319"></a><span class="k">PUBLIC  </span><span class="n">GetCoilIndexVariableSpeed</span>
<a name="ln-320"></a><span class="k">PUBLIC  </span><span class="n">GetCoilCapacityVariableSpeed</span>
<a name="ln-321"></a><span class="k">PUBLIC  </span><span class="n">GetCoilInletNodeVariableSpeed</span>
<a name="ln-322"></a><span class="k">PUBLIC  </span><span class="n">GetCoilOutletNodeVariableSpeed</span>
<a name="ln-323"></a><span class="k">PUBLIC  </span><span class="n">GetCoilAirFlowRateVariableSpeed</span>
<a name="ln-324"></a><span class="k">PUBLIC  </span><span class="n">GetVSCoilCondenserInletNode</span>
<a name="ln-325"></a><span class="k">PUBLIC  </span><span class="n">GetVSCoilMinOATCompressor</span>
<a name="ln-326"></a><span class="k">PUBLIC  </span><span class="n">GetVSCoilNumOfSpeeds</span>
<a name="ln-327"></a><span class="k">PUBLIC  </span><span class="n">SetVarSpeedCoilData</span>
<a name="ln-328"></a>        <span class="c">!SHR, bypass factor routines</span>
<a name="ln-329"></a><span class="k">PRIVATE </span><span class="n">CalcEffectiveSHR</span>
<a name="ln-330"></a><span class="k">PRIVATE </span><span class="n">CalcTotCapSHR_VSWSHP</span>
<a name="ln-331"></a><span class="k">PRIVATE </span><span class="n">CalcCBF</span>
<a name="ln-332"></a><span class="k">PRIVATE </span><span class="n">AdjustCBF</span>
<a name="ln-333"></a>
<a name="ln-334"></a><span class="k">CONTAINS</span>
<a name="ln-335"></a>
<a name="ln-336"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-337"></a><span class="c">!*************************************************************************</span>
<a name="ln-338"></a><span class="k">SUBROUTINE </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,&amp;</span>
<a name="ln-339"></a>           <span class="n">CyclingScheme</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-340"></a>           <span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRat</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-341"></a>           <span class="n">SensLoad</span><span class="p">,</span> <span class="n">LatentLoad</span><span class="p">)</span>
<a name="ln-342"></a>
<a name="ln-343"></a>          <span class="c">!       AUTHOR         Bo Shen, ORNL</span>
<a name="ln-344"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-345"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-346"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-347"></a>
<a name="ln-348"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-349"></a>          <span class="c">! This subroutine manages variable-speed Water to Air Heat Pump component simulation.</span>
<a name="ln-350"></a>
<a name="ln-351"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-352"></a>
<a name="ln-353"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-354"></a>          <span class="c">! N/A</span>
<a name="ln-355"></a>
<a name="ln-356"></a>
<a name="ln-357"></a>
<a name="ln-358"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-359"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-360"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimestepSys</span>
<a name="ln-361"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-362"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-363"></a>
<a name="ln-364"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-365"></a>
<a name="ln-366"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-367"></a>
<a name="ln-368"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CompName</span>                     <span class="c">! Coil Name</span>
<a name="ln-369"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">CompIndex</span>                    <span class="c">! Index for Component name</span>
<a name="ln-370"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">CyclingScheme</span>                <span class="c">! Continuous fan OR cycling compressor</span>
<a name="ln-371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>        <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HPTimeConstant</span>               <span class="c">! Heat pump time constant [s]</span>
<a name="ln-373"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FanDelayTime</span>                 <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-374"></a>                                                                    <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-375"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">CompOp</span>                       <span class="c">! compressor on/off. 0 = off; 1= on</span>
<a name="ln-376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">PartLoadFrac</span>
<a name="ln-377"></a>  <span class="c">! part-load ratio = load/total capacity, passed in by the parent object</span>
<a name="ln-378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">OnOffAirFlowRat</span>              <span class="c">! ratio of comp on to comp off air flow rate</span>
<a name="ln-379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">SensLoad</span>                     <span class="c">! Sensible demand load [W]</span>
<a name="ln-380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">LatentLoad</span>                   <span class="c">! Latent demand load [W]</span>
<a name="ln-381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">SpeedRatio</span>                   <span class="c">! compressor speed ratio</span>
<a name="ln-382"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">SpeedNum</span>                     <span class="c">! compressor speed number</span>
<a name="ln-383"></a>
<a name="ln-384"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-385"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-386"></a>
<a name="ln-387"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-388"></a>          <span class="c">! na</span>
<a name="ln-389"></a>
<a name="ln-390"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-391"></a>          <span class="c">! na</span>
<a name="ln-392"></a>
<a name="ln-393"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-394"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DXCoilNum</span>                         <span class="c">! The WatertoAirHP that you are currently loading input into</span>
<a name="ln-395"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>                 <span class="c">! ratio of comp on to comp off air flow rate</span>
<a name="ln-396"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RuntimeFrac</span>                       <span class="c">! run time fraction</span>
<a name="ln-397"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SpeedCal</span>                          <span class="c">! variable for error proof speed input</span>
<a name="ln-398"></a>
<a name="ln-399"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-400"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-401"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-402"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-403"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-404"></a>  <span class="k">End If</span>
<a name="ln-405"></a>
<a name="ln-406"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-407"></a><span class="k">    </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span> <span class="p">)</span>
<a name="ln-408"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-409"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;WaterToAirHPVSWEquationFit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-410"></a>    <span class="n">ENDIF</span>
<a name="ln-411"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">DXCoilNum</span>
<a name="ln-412"></a>  <span class="k">ELSE</span>
<a name="ln-413"></a><span class="k">    </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-414"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">&gt;</span> <span class="n">NumWatertoAirHPs</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DXCoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-415"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimVariableSpeedCoils: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-416"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-417"></a>                          <span class="s1">&#39;, Number of Water to Air HPs=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-418"></a>                          <span class="s1">&#39;, WaterToAir HP name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-419"></a>    <span class="n">ENDIF</span>
<a name="ln-420"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompName</span> <span class="o">/=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-421"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimVariableSpeedCoils: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-422"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-423"></a>                          <span class="s1">&#39;, WaterToAir HP name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored WaterToAir HP Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-424"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-425"></a>    <span class="n">ENDIF</span>
<a name="ln-426"></a>  <span class="n">ENDIF</span>
<a name="ln-427"></a>
<a name="ln-428"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">OnOffAirFlowRat</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-429"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRat</span>
<a name="ln-430"></a>  <span class="k">ELSE</span>
<a name="ln-431"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-432"></a>  <span class="k">END IF</span>
<a name="ln-433"></a>
<a name="ln-434"></a> <span class="c">!ERROR PROOF</span>
<a name="ln-435"></a> <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-436"></a><span class="k">    </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-437"></a> <span class="k">ELSE</span>
<a name="ln-438"></a><span class="k">    </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-439"></a> <span class="k">END IF</span>
<a name="ln-440"></a>
<a name="ln-441"></a><span class="k"> IF</span><span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-442"></a>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-443"></a>    <span class="c">! Cooling mode</span>
<a name="ln-444"></a>    <span class="k">CALL </span><span class="n">InitVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-445"></a>                                  <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-446"></a>    <span class="k">CALL </span><span class="n">CalcVarSpeedCoilCooling</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-447"></a>                <span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-448"></a>    <span class="k">CALL </span><span class="n">UpdateVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-449"></a> <span class="n">ELSEIF</span><span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-450"></a>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-451"></a>    <span class="c">! Heating mode</span>
<a name="ln-452"></a>    <span class="k">CALL </span><span class="n">InitVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-453"></a>                                  <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-454"></a>    <span class="k">CALL </span><span class="n">CalcVarSpeedCoilHeating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-455"></a>                <span class="n">SensLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-456"></a>    <span class="k">CALL </span><span class="n">UpdateVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-457"></a> <span class="k">ELSE</span>
<a name="ln-458"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimVariableSpeedCoils: WatertoAir heatpump not in either HEATING or COOLING mode&#39;</span><span class="p">)</span>
<a name="ln-459"></a> <span class="n">ENDIF</span>
<a name="ln-460"></a>
<a name="ln-461"></a> <span class="c">! two additional output variables</span>
<a name="ln-462"></a> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedNumReport</span> <span class="o">=</span> <span class="n">SpeedCal</span>
<a name="ln-463"></a> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedRatioReport</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-464"></a>
<a name="ln-465"></a> <span class="k">RETURN</span>
<a name="ln-466"></a>
<a name="ln-467"></a><span class="k">END SUBROUTINE </span><span class="n">SimVariableSpeedCoils</span>
<a name="ln-468"></a>
<a name="ln-469"></a><span class="k">SUBROUTINE </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-470"></a>
<a name="ln-471"></a>       <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-472"></a>          <span class="c">!       AUTHOR         Bo Shen</span>
<a name="ln-473"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-474"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-475"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-476"></a>
<a name="ln-477"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-478"></a>          <span class="c">! Obtains input data for HPs and stores it in HP data structures</span>
<a name="ln-479"></a>
<a name="ln-480"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-481"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-482"></a>
<a name="ln-483"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-484"></a>          <span class="c">! n/a</span>
<a name="ln-485"></a>
<a name="ln-486"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-487"></a>    <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-488"></a>    <span class="k">USE </span><span class="n">NodeInputManager</span>
<a name="ln-489"></a>    <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-490"></a>    <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-491"></a>    <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-492"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-493"></a>    <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">GetCurveType</span><span class="p">,</span> <span class="n">CurveValue</span><span class="p">,</span> <span class="n">SetCurveOutputMinMaxValues</span>
<a name="ln-494"></a>    <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-495"></a>    <span class="k">USE </span><span class="n">WaterManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupTankDemandComponent</span><span class="p">,</span> <span class="n">SetupTankSupplyComponent</span>
<a name="ln-496"></a>    <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-497"></a>
<a name="ln-498"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-499"></a>
<a name="ln-500"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-501"></a>          <span class="c">! na</span>
<a name="ln-502"></a>
<a name="ln-503"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-504"></a>    <span class="kt">CHARACTER</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetVarSpeedCoilInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-505"></a>
<a name="ln-506"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-507"></a>          <span class="c">! na</span>
<a name="ln-508"></a>
<a name="ln-509"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-510"></a>          <span class="c">! na</span>
<a name="ln-511"></a>
<a name="ln-512"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-513"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>                    <span class="c">! The Water to Air HP that you are currently loading input into</span>
<a name="ln-514"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCool</span>                      <span class="c">! Counter for cooling coil, water source</span>
<a name="ln-515"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCoolAS</span>                    <span class="c">! Counter for cooling coil, air source</span>
<a name="ln-516"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHeat</span>                      <span class="c">! Counter for heating coil, water source</span>
<a name="ln-517"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHeatAS</span>                    <span class="c">! Counter for heating coil, air source</span>
<a name="ln-518"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WatertoAirHPNum</span>              <span class="c">! Counter</span>
<a name="ln-519"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">I</span>                            <span class="c">! Loop index increment</span>
<a name="ln-520"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>                    <span class="c">! Number of variables in String format</span>
<a name="ln-521"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>                      <span class="c">! Number of variables in Numeric format</span>
<a name="ln-522"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumParams</span>                    <span class="c">! Total number of input fields</span>
<a name="ln-523"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>                    <span class="c">! Maximum number of numeric input fields</span>
<a name="ln-524"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>                  <span class="c">! Maximum number of alpha input fields</span>
<a name="ln-525"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-526"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AlfaFieldIncre</span>               <span class="c">!increment number of Alfa field</span>
<a name="ln-527"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>        <span class="c">! If errors detected in input</span>
<a name="ln-528"></a>    <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>                <span class="c">! Flag to verify name</span>
<a name="ln-529"></a>    <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>                <span class="c">! Flag for blank name</span>
<a name="ln-530"></a>    <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-531"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurveVal</span>                   <span class="c">! Used to verify modifier curves equal 1 at rated conditions</span>
<a name="ln-532"></a>    <span class="kt">CHARACTER</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CurrentModuleObject</span>                       <span class="c">! for ease in getting objects</span>
<a name="ln-533"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">AlphArray</span>        <span class="c">! Alpha input items for object</span>
<a name="ln-534"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>     <span class="c">! Alpha field names</span>
<a name="ln-535"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span>   <span class="c">! Numeric field names</span>
<a name="ln-536"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NumArray</span>                            <span class="c">! Numeric input items for object</span>
<a name="ln-537"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>                        <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-538"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>                      <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-539"></a>
<a name="ln-540"></a>    <span class="n">NumCool</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span>
<a name="ln-541"></a>    <span class="n">NumHeat</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span>
<a name="ln-542"></a>    <span class="n">NumCoolAS</span>  <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span><span class="p">)</span>
<a name="ln-543"></a>    <span class="n">NumHeatAS</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span><span class="p">)</span>
<a name="ln-544"></a>    <span class="n">NumWatertoAirHPs</span> <span class="o">=</span> <span class="n">NumCool</span><span class="o">+</span><span class="n">NumHeat</span><span class="o">+</span><span class="n">NumCoolAS</span><span class="o">+</span><span class="n">NumHeatAS</span>
<a name="ln-545"></a>    <span class="n">DXCoilNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-546"></a>
<a name="ln-547"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-548"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No Equipment found in SimWatertoAirHPSimple&#39;</span><span class="p">)</span>
<a name="ln-549"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-550"></a>    <span class="k">END IF</span>
<a name="ln-551"></a>
<a name="ln-552"></a>   <span class="c">! Allocate Arrays</span>
<a name="ln-553"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-554"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-555"></a>    <span class="n">ENDIF</span>
<a name="ln-556"></a>
<a name="ln-557"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-558"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-559"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-560"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-561"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-562"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-563"></a>
<a name="ln-564"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-565"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-566"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-567"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-568"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-569"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-570"></a>
<a name="ln-571"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-572"></a>    <span class="n">AlphArray</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-573"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-574"></a>    <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-575"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-576"></a>    <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-577"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-578"></a>    <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-579"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-580"></a>    <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-581"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-582"></a>    <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-583"></a>
<a name="ln-584"></a>    <span class="c">! Get the data for cooling coil, WATER SOURCE</span>
<a name="ln-585"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:VariableSpeedEquationFit&#39;</span> <span class="c">!for reporting</span>
<a name="ln-586"></a>
<a name="ln-587"></a>    <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCool</span>
<a name="ln-588"></a>
<a name="ln-589"></a>        <span class="n">DXCoilNum</span><span class="o">=</span> <span class="n">DXCoilNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-590"></a>        <span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-591"></a>
<a name="ln-592"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-593"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-594"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-595"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-596"></a>
<a name="ln-597"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-598"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-599"></a>
<a name="ln-600"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-601"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-602"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-603"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-604"></a>        <span class="n">ENDIF</span>
<a name="ln-605"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-606"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-607"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-608"></a>        <span class="n">ENDIF</span>
<a name="ln-609"></a>
<a name="ln-610"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-611"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span>  <span class="o">=</span> <span class="s1">&#39;COOLING&#39;</span>
<a name="ln-612"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span>  <span class="o">=</span> <span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span>
<a name="ln-613"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-614"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-615"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-616"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-617"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-618"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-619"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-620"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HOTGASREHEATFLG</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-621"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">=</span> <span class="n">WaterCooled</span>
<a name="ln-622"></a>
<a name="ln-623"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-624"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-625"></a>                                   <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-626"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-627"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-628"></a>                                   <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-629"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-630"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-631"></a>                                   <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-632"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-633"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-634"></a>                                   <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-635"></a>
<a name="ln-636"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-637"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-638"></a>
<a name="ln-639"></a>
<a name="ln-640"></a>     <span class="c">!   If (VarSpeedCoil(DXCoilNum)%NumOfSpeeds .LT. 2) Then</span>
<a name="ln-641"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-642"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-643"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 1.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-644"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-645"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-646"></a>        <span class="k">End If</span>
<a name="ln-647"></a>
<a name="ln-648"></a><span class="k">        If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-649"></a><span class="k">            </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-650"></a>        <span class="k">END IF</span>
<a name="ln-651"></a>
<a name="ln-652"></a><span class="k">        If</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-653"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-654"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-655"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be valid speed level&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-656"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-657"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-658"></a>        <span class="k">End If</span>
<a name="ln-659"></a>
<a name="ln-660"></a>        <span class="c">!part load curve</span>
<a name="ln-661"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-662"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-663"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-664"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-665"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-666"></a>          <span class="k">ELSE</span>
<a name="ln-667"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-668"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-669"></a>          <span class="k">END IF</span>
<a name="ln-670"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-671"></a>        <span class="k">ELSE</span>
<a name="ln-672"></a><span class="k">            </span><span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-673"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-674"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)&amp;</span>
<a name="ln-675"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-676"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-677"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-678"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-679"></a>            <span class="k">END IF</span>
<a name="ln-680"></a><span class="k">        END IF</span>
<a name="ln-681"></a>
<a name="ln-682"></a><span class="k">        Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-683"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-684"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-685"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-686"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-687"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-688"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-689"></a>
<a name="ln-690"></a>            <span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-691"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-692"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-693"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-694"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-695"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-696"></a>              <span class="k">ELSE</span>
<a name="ln-697"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-698"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))&amp;</span>
<a name="ln-699"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-700"></a>              <span class="k">END IF</span>
<a name="ln-701"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-702"></a>            <span class="k">ELSE</span>
<a name="ln-703"></a>              <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-704"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-705"></a>
<a name="ln-706"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-707"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span><span class="n">RatedInletWaterTemp</span><span class="p">)</span>
<a name="ln-708"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-709"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-710"></a>                            <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-711"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-712"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-713"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-714"></a>                <span class="k">END IF</span>
<a name="ln-715"></a>
<a name="ln-716"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-717"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-718"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-719"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-720"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-721"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-722"></a>              <span class="k">END SELECT</span>
<a name="ln-723"></a><span class="k">            END IF</span>
<a name="ln-724"></a>
<a name="ln-725"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-726"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-727"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-728"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-729"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-730"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-731"></a>              <span class="k">ELSE</span>
<a name="ln-732"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-733"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-734"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-735"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-736"></a>              <span class="k">END IF</span>
<a name="ln-737"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-738"></a>            <span class="k">ELSE</span>
<a name="ln-739"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-740"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-741"></a>
<a name="ln-742"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-743"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-744"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-745"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-746"></a>                        <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-747"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-748"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-749"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-750"></a>                <span class="k">END IF</span>
<a name="ln-751"></a>
<a name="ln-752"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-753"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-754"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-755"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-756"></a>                        <span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-757"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-758"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-759"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-760"></a>                <span class="k">END IF</span>
<a name="ln-761"></a>
<a name="ln-762"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-763"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-764"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-765"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-766"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-767"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-768"></a>              <span class="k">END SELECT</span>
<a name="ln-769"></a><span class="k">            END IF</span>
<a name="ln-770"></a>
<a name="ln-771"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-772"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-773"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-774"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-775"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-776"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-777"></a>              <span class="k">ELSE</span>
<a name="ln-778"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-779"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-780"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-781"></a>              <span class="k">END IF</span>
<a name="ln-782"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-783"></a>            <span class="k">ELSE</span>
<a name="ln-784"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-785"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-786"></a>
<a name="ln-787"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-788"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-789"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-790"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-791"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-792"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-793"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-794"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-795"></a>                <span class="k">END IF</span>
<a name="ln-796"></a>
<a name="ln-797"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-798"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-799"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-800"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-801"></a>                            <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-802"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-803"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-804"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-805"></a>                <span class="k">END IF</span>
<a name="ln-806"></a>
<a name="ln-807"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-808"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-809"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-810"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-811"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-812"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-813"></a>              <span class="k">END SELECT</span>
<a name="ln-814"></a><span class="k">            END IF</span>
<a name="ln-815"></a>
<a name="ln-816"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-817"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-818"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-819"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-820"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-821"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-822"></a>              <span class="k">ELSE</span>
<a name="ln-823"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-824"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-825"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-826"></a>              <span class="k">END IF</span>
<a name="ln-827"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-828"></a>            <span class="k">ELSE</span>
<a name="ln-829"></a>              <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-830"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-831"></a>
<a name="ln-832"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-833"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span><span class="n">RatedInletWaterTemp</span><span class="p">)</span>
<a name="ln-834"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-835"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-836"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-837"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-838"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-839"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-840"></a>                <span class="k">END IF</span>
<a name="ln-841"></a>
<a name="ln-842"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-843"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-844"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-845"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-846"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-847"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-848"></a>              <span class="k">END SELECT</span>
<a name="ln-849"></a><span class="k">            END IF</span>
<a name="ln-850"></a>
<a name="ln-851"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-852"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-853"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-854"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-855"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-856"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-857"></a>              <span class="k">ELSE</span>
<a name="ln-858"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-859"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))&amp;</span>
<a name="ln-860"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-861"></a>              <span class="k">END IF</span>
<a name="ln-862"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-863"></a>            <span class="k">ELSE</span>
<a name="ln-864"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-865"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-866"></a>
<a name="ln-867"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-868"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-869"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-870"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-871"></a>                            <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-872"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-873"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-874"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-875"></a>                <span class="k">END IF</span>
<a name="ln-876"></a>
<a name="ln-877"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-878"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-879"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-880"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-881"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-882"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-883"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-884"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-885"></a>                <span class="k">END IF</span>
<a name="ln-886"></a>
<a name="ln-887"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-888"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-889"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-890"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-891"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-892"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-893"></a>              <span class="k">END SELECT</span>
<a name="ln-894"></a><span class="k">            END IF</span>
<a name="ln-895"></a>
<a name="ln-896"></a><span class="k">           </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-897"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-898"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-899"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-900"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-901"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-902"></a>              <span class="k">ELSE</span>
<a name="ln-903"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-904"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-905"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-906"></a>              <span class="k">END IF</span>
<a name="ln-907"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-908"></a>            <span class="k">ELSE</span>
<a name="ln-909"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-910"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-911"></a>
<a name="ln-912"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-913"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-914"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-915"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-916"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-917"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-918"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-919"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-920"></a>                <span class="k">END IF</span>
<a name="ln-921"></a>
<a name="ln-922"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-923"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-924"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-925"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-926"></a>                            <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-927"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-928"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-929"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-930"></a>                <span class="k">END IF</span>
<a name="ln-931"></a>
<a name="ln-932"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-933"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-934"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-935"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-936"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-937"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-938"></a>              <span class="k">END SELECT</span>
<a name="ln-939"></a><span class="k">            END IF</span>
<a name="ln-940"></a>
<a name="ln-941"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-942"></a>            <span class="c">! Read waste heat modifier curve name</span>
<a name="ln-943"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-944"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-945"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-946"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-947"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-948"></a>              <span class="k">ELSE</span>
<a name="ln-949"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-950"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-951"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-952"></a>              <span class="k">END IF</span>
<a name="ln-953"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-954"></a>            <span class="k">ELSE</span>
<a name="ln-955"></a>              <span class="c">! Verify Curve Object, only legal types are BiQuadratic</span>
<a name="ln-956"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-957"></a>
<a name="ln-958"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-959"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWaterTemp</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">)</span>
<a name="ln-960"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-961"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-962"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-963"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-964"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-965"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-966"></a>                <span class="k">END IF</span>
<a name="ln-967"></a>
<a name="ln-968"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-969"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-970"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-971"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-972"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-973"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-974"></a>              <span class="k">END SELECT</span>
<a name="ln-975"></a><span class="k">            END IF</span>
<a name="ln-976"></a>
<a name="ln-977"></a><span class="k">        END DO</span>
<a name="ln-978"></a>
<a name="ln-979"></a><span class="k">        Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-980"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-981"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span>
<a name="ln-982"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-983"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-984"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-985"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-986"></a>        <span class="k">END DO</span>
<a name="ln-987"></a>
<a name="ln-988"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-989"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-990"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-991"></a>
<a name="ln-992"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-993"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-994"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-995"></a>
<a name="ln-996"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-997"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-998"></a>
<a name="ln-999"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1000"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1003"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1004"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPCOOLINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>        <span class="c">!for table output, being consistent with outher water-to-air coils</span>
<a name="ln-1007"></a><span class="c">!        IF (VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal /= AutoSize) THEN</span>
<a name="ln-1008"></a><span class="c">!            VarSpeedCoil(DXCoilNum)%RatedCapCoolSens = VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal &amp;</span>
<a name="ln-1009"></a><span class="c">!                *VarSpeedCoil(DXCoilNum)%MSRatedSHR(VarSpeedCoil(DXCoilNum)%NormSpedLevel)</span>
<a name="ln-1010"></a><span class="c">!        ELSE</span>
<a name="ln-1011"></a><span class="c">!            VarSpeedCoil(DXCoilNum)%RatedCapCoolSens = AUTOSIZE</span>
<a name="ln-1012"></a><span class="c">!        END IF</span>
<a name="ln-1013"></a>
<a name="ln-1014"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">=</span> <span class="n">AUTOSIZE</span> <span class="c">!always auto-sized, to be determined in the sizing calculation</span>
<a name="ln-1015"></a>
<a name="ln-1016"></a>        <span class="c">! BAN Sept 30 2103, CR9322, commented out, now it is redundant, it is reported from sizing routine</span>
<a name="ln-1017"></a>        <span class="c">!!create predefined report entries</span>
<a name="ln-1018"></a>        <span class="c">!CALL PreDefTableEntry(pdchCoolCoilType,VarSpeedCoil(DXCoilNum)%Name,CurrentModuleObject)</span>
<a name="ln-1019"></a>        <span class="c">!CALL PreDefTableEntry(pdchCoolCoilTotCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal)</span>
<a name="ln-1020"></a>        <span class="c">!CALL PreDefTableEntry(pdchCoolCoilSensCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolSens)</span>
<a name="ln-1021"></a>        <span class="c">!CALL PreDefTableEntry(pdchCoolCoilLatCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal &amp;</span>
<a name="ln-1022"></a>        <span class="c">!                         - VarSpeedCoil(DXCoilNum)%RatedCapCoolSens)</span>
<a name="ln-1023"></a>        <span class="c">!CALL PreDefTableEntry(pdchCoolCoilSHR,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolSens &amp;</span>
<a name="ln-1024"></a>        <span class="c">!                         / VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal)</span>
<a name="ln-1025"></a>        <span class="c">!CALL PreDefTableEntry(pdchCoolCoilNomEff,VarSpeedCoil(DXCoilNum)%Name,&amp;</span>
<a name="ln-1026"></a>        <span class="c">!        VarSpeedCoil(DXCoilNum)%MSRatedCOP(VarSpeedCoil(DXCoilNum)%NormSpedLevel))</span>
<a name="ln-1027"></a>   <span class="k">END DO</span>
<a name="ln-1028"></a>
<a name="ln-1029"></a>      <span class="c">!-------------------------AIR SOURCE, COOLING---BEGIN</span>
<a name="ln-1030"></a>   <span class="c">! Get the data for cooling coil, AIR SOURCE</span>
<a name="ln-1031"></a>     <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:DX:VariableSpeed&#39;</span> <span class="c">!for reporting</span>
<a name="ln-1032"></a>
<a name="ln-1033"></a>    <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCoolAS</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>        <span class="n">DXCoilNum</span><span class="o">=</span> <span class="n">DXCoilNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1036"></a>        <span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1037"></a>
<a name="ln-1038"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1039"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1040"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1041"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1042"></a>
<a name="ln-1043"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1044"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1045"></a>
<a name="ln-1046"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1047"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1048"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1049"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1050"></a>        <span class="n">ENDIF</span>
<a name="ln-1051"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1052"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1053"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1054"></a>        <span class="n">ENDIF</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1057"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span>  <span class="o">=</span> <span class="s1">&#39;COOLING&#39;</span>
<a name="ln-1058"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span>  <span class="o">=</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span>
<a name="ln-1059"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1060"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1061"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1062"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1063"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1064"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1067"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1068"></a>                                   <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1069"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1070"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1071"></a>                                   <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1072"></a>
<a name="ln-1073"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1074"></a>
<a name="ln-1075"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1076"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1077"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 1.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1078"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-1079"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1080"></a>        <span class="k">End If</span>
<a name="ln-1081"></a>
<a name="ln-1082"></a><span class="k">        If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1083"></a><span class="k">            </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1084"></a>        <span class="k">END IF</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a><span class="k">        If</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1087"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1088"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1089"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be valid speed level&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1090"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-1091"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1092"></a>        <span class="k">End If</span>
<a name="ln-1093"></a>
<a name="ln-1094"></a>        <span class="c">!part load curve</span>
<a name="ln-1095"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1096"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1097"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1098"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1099"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1100"></a>          <span class="k">ELSE</span>
<a name="ln-1101"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1102"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1103"></a>          <span class="k">END IF</span>
<a name="ln-1104"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1105"></a>        <span class="k">ELSE</span>
<a name="ln-1106"></a><span class="k">            </span><span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1107"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1108"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)&amp;</span>
<a name="ln-1109"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1110"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1111"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1112"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1113"></a>            <span class="k">END IF</span>
<a name="ln-1114"></a><span class="k">        END IF</span>
<a name="ln-1115"></a>
<a name="ln-1116"></a><span class="c">! outdoor condenser node</span>
<a name="ln-1117"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1118"></a><span class="k">         </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1119"></a>       <span class="k">ELSE</span>
<a name="ln-1120"></a><span class="k">        </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1121"></a>           <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1122"></a>                             <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a>         <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1125"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1126"></a>             <span class="s1">&#39;&quot;, may be invalid&#39;</span><span class="p">)</span>
<a name="ln-1127"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1128"></a>                                   <span class="s1">&#39;&quot;, node does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-1129"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This node needs to be included in an air system or the coil model will not be valid&#39;</span> <span class="p">&amp;</span>
<a name="ln-1130"></a>                                 <span class="o">//</span><span class="s1">&#39;, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-1131"></a>         <span class="k">END IF</span>
<a name="ln-1132"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-1133"></a>
<a name="ln-1134"></a>       <span class="k">IF</span> <span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1135"></a><span class="k">         </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">=</span> <span class="n">AirCooled</span>
<a name="ln-1136"></a>       <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;EvaporativelyCooled&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1137"></a><span class="k">         </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">=</span> <span class="n">EvapCooled</span>
<a name="ln-1138"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1139"></a>       <span class="k">ELSE</span>
<a name="ln-1140"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1141"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1142"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...must be AirCooled or EvaporativelyCooled.&#39;</span><span class="p">)</span>
<a name="ln-1143"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1144"></a>       <span class="k">END IF</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1147"></a>
<a name="ln-1148"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1149"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1150"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1151"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1152"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1153"></a>      <span class="k">END IF</span>
<a name="ln-1154"></a>
<a name="ln-1155"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-1156"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1157"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1158"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1159"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1160"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1161"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1162"></a>       <span class="k">END IF</span>
<a name="ln-1163"></a>
<a name="ln-1164"></a>  <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-1165"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1166"></a>
<a name="ln-1167"></a>  <span class="c">! Get Water System tank connections</span>
<a name="ln-1168"></a>  <span class="c">!  A7, \field Name of Water Storage Tank for Supply</span>
<a name="ln-1169"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1170"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1171"></a><span class="k">       </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromMains</span>
<a name="ln-1172"></a>     <span class="k">ELSE</span>
<a name="ln-1173"></a><span class="k">       </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromTank</span>
<a name="ln-1174"></a>       <span class="k">CALL </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1175"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1176"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span> <span class="p">)</span>
<a name="ln-1177"></a>     <span class="n">ENDIF</span>
<a name="ln-1178"></a>
<a name="ln-1179"></a>  <span class="c">!A8; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-1180"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1181"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1182"></a><span class="k">       </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-1183"></a>     <span class="k">ELSE</span>
<a name="ln-1184"></a><span class="k">       </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-1185"></a>       <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1186"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1187"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-1188"></a>     <span class="k">END IF</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a>  <span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-1191"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1192"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1193"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1194"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1195"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1196"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1197"></a>     <span class="k">END IF</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1200"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1201"></a><span class="k">      IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1202"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1203"></a>           <span class="s1">&#39;&quot;, freeze possible&#39;</span><span class="p">)</span>
<a name="ln-1204"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &lt; 2 {C}. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-1205"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1206"></a>      <span class="k">END IF</span>
<a name="ln-1207"></a><span class="k">    END IF</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1210"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-1211"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1212"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1213"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1214"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Basin heater will be available to operate throughout the simulation.&#39;</span><span class="p">)</span>
<a name="ln-1215"></a>      <span class="k">END IF</span>
<a name="ln-1216"></a><span class="k">    END IF</span>
<a name="ln-1217"></a>
<a name="ln-1218"></a><span class="k">    Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1219"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1220"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1221"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1222"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1223"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1224"></a>
<a name="ln-1225"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1226"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1227"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1228"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0 or &gt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-1229"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1230"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1231"></a>        <span class="k">END IF</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-1234"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1235"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1236"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1237"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1238"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1239"></a>          <span class="k">ELSE</span>
<a name="ln-1240"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1241"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))&amp;</span>
<a name="ln-1242"></a>                    <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1243"></a>          <span class="k">END IF</span>
<a name="ln-1244"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1245"></a>        <span class="k">ELSE</span>
<a name="ln-1246"></a>          <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-1247"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1248"></a>
<a name="ln-1249"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1250"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span><span class="n">RatedAmbAirTemp</span><span class="p">)</span>
<a name="ln-1251"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1252"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-1253"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1254"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1255"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1256"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1257"></a>            <span class="k">END IF</span>
<a name="ln-1258"></a>
<a name="ln-1259"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-1260"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1261"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1262"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1263"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1264"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1265"></a>          <span class="k">END SELECT</span>
<a name="ln-1266"></a><span class="k">        END IF</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-1269"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1270"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1271"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1272"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1273"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1274"></a>          <span class="k">ELSE</span>
<a name="ln-1275"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-1276"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1277"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1278"></a>                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1279"></a>          <span class="k">END IF</span>
<a name="ln-1280"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1281"></a>        <span class="k">ELSE</span>
<a name="ln-1282"></a>          <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1283"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1286"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1287"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1288"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1289"></a>                    <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1290"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1291"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1292"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1293"></a>            <span class="k">END IF</span>
<a name="ln-1294"></a>
<a name="ln-1295"></a><span class="k">          CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1296"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1297"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1298"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1299"></a>                    <span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1300"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1301"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1302"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1303"></a>            <span class="k">END IF</span>
<a name="ln-1304"></a>
<a name="ln-1305"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-1306"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1307"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1308"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1309"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1310"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1311"></a>          <span class="k">END SELECT</span>
<a name="ln-1312"></a><span class="k">        END IF</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-1315"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1316"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1317"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1318"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1319"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1320"></a>          <span class="k">ELSE</span>
<a name="ln-1321"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1322"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1323"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1324"></a>          <span class="k">END IF</span>
<a name="ln-1325"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1326"></a>        <span class="k">ELSE</span>
<a name="ln-1327"></a>          <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-1328"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1331"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span><span class="n">RatedAmbAirTemp</span><span class="p">)</span>
<a name="ln-1332"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1333"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-1334"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1335"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1336"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1337"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1338"></a>            <span class="k">END IF</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-1341"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1342"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1343"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1344"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1345"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1346"></a>          <span class="k">END SELECT</span>
<a name="ln-1347"></a><span class="k">        END IF</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-1350"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1351"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1352"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1353"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1354"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1355"></a>          <span class="k">ELSE</span>
<a name="ln-1356"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1357"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))&amp;</span>
<a name="ln-1358"></a>                    <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1359"></a>          <span class="k">END IF</span>
<a name="ln-1360"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1361"></a>        <span class="k">ELSE</span>
<a name="ln-1362"></a>          <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1363"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1364"></a>
<a name="ln-1365"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1366"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1367"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1368"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-1369"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1370"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1371"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1372"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1373"></a>            <span class="k">END IF</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a><span class="k">          CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1376"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1377"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1378"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1379"></a>                    <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1380"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1381"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1382"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1383"></a>            <span class="k">END IF</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-1386"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1387"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1388"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1389"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1390"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1391"></a>          <span class="k">END SELECT</span>
<a name="ln-1392"></a><span class="k">        END IF</span>
<a name="ln-1393"></a><span class="k">      END DO</span>
<a name="ln-1394"></a>
<a name="ln-1395"></a><span class="k">      Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1396"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1397"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span>
<a name="ln-1398"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1399"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1400"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedEvapCondVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1401"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1402"></a>      <span class="k">END DO</span>
<a name="ln-1403"></a>
<a name="ln-1404"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1405"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1406"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1407"></a>
<a name="ln-1408"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1409"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1410"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1411"></a>
<a name="ln-1412"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1413"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1416"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1417"></a>
<a name="ln-1418"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1420"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPCOOLINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a>
<a name="ln-1423"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">=</span> <span class="n">AUTOSIZE</span> <span class="c">!always auto-sized, to be determined in the sizing calculation</span>
<a name="ln-1424"></a>
<a name="ln-1425"></a>      <span class="c">! BAN Sept 30 2103, CR9322, commented out, now it is redundant, it is reported from sizing routine</span>
<a name="ln-1426"></a>        <span class="c">!create predefined report entries</span>
<a name="ln-1427"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilType,VarSpeedCoil(DXCoilNum)%Name,CurrentModuleObject)</span>
<a name="ln-1428"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilTotCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal)</span>
<a name="ln-1429"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilSensCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolSens)</span>
<a name="ln-1430"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilLatCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal &amp;</span>
<a name="ln-1431"></a>      <span class="c">!                           - VarSpeedCoil(DXCoilNum)%RatedCapCoolSens)</span>
<a name="ln-1432"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilSHR,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolSens &amp;</span>
<a name="ln-1433"></a>      <span class="c">!                           / VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal)</span>
<a name="ln-1434"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilNomEff,VarSpeedCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-1435"></a>      <span class="c">!      VarSpeedCoil(DXCoilNum)%MSRatedCOP(VarSpeedCoil(DXCoilNum)%NormSpedLevel))</span>
<a name="ln-1436"></a>
<a name="ln-1437"></a>   <span class="k">END DO</span>
<a name="ln-1438"></a>
<a name="ln-1439"></a>   <span class="c">!-------------------------AIR SOURCE COOLING---END</span>
<a name="ln-1440"></a>
<a name="ln-1441"></a>   <span class="c">! Get the data for heating coil, WATER SOURCE</span>
<a name="ln-1442"></a>   <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:VariableSpeedEquationFit&#39;</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a>   <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeat</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>        <span class="n">DXCoilNum</span><span class="o">=</span> <span class="n">DXCoilNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1447"></a>
<a name="ln-1448"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">WatertoAirHPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1449"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1450"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1451"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1452"></a>
<a name="ln-1453"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1454"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1455"></a>
<a name="ln-1456"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1457"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1458"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1459"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1460"></a>        <span class="n">ENDIF</span>
<a name="ln-1461"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1462"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1463"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1464"></a>        <span class="n">ENDIF</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1467"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span>  <span class="o">=</span> <span class="s1">&#39;HEATING&#39;</span>
<a name="ln-1468"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span>  <span class="o">=</span> <span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span>
<a name="ln-1469"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1470"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1471"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1472"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1473"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1474"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">=</span> <span class="n">WaterCooled</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1477"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1478"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1479"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1480"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1481"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1482"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1483"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1484"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1485"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1486"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1487"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1488"></a>
<a name="ln-1489"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1490"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1491"></a>
<a name="ln-1492"></a>
<a name="ln-1493"></a> <span class="c">!       If (VarSpeedCoil(DXCoilNum)%NumOfSpeeds .LT. 2) Then</span>
<a name="ln-1494"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1495"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1496"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 1.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1497"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-1498"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1499"></a>        <span class="k">End If</span>
<a name="ln-1500"></a>
<a name="ln-1501"></a><span class="k">        If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1502"></a><span class="k">            </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1503"></a>        <span class="k">END IF</span>
<a name="ln-1504"></a>
<a name="ln-1505"></a><span class="k">        If</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1506"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1507"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1508"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be valid speed level&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1509"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-1510"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1511"></a>        <span class="k">End If</span>
<a name="ln-1512"></a>
<a name="ln-1513"></a>        <span class="c">!part load curve</span>
<a name="ln-1514"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1515"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1516"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1517"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1518"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1519"></a>          <span class="k">ELSE</span>
<a name="ln-1520"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1521"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1522"></a>          <span class="k">END IF</span>
<a name="ln-1523"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1524"></a>        <span class="k">ELSE</span>
<a name="ln-1525"></a><span class="k">            </span><span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1526"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1527"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-1528"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1529"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1530"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1531"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1532"></a>            <span class="k">END IF</span>
<a name="ln-1533"></a><span class="k">        END IF</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a><span class="k">        Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1536"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1537"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1538"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1539"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1540"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1541"></a>
<a name="ln-1542"></a>            <span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1543"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1544"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1545"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1546"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1547"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1548"></a>              <span class="k">ELSE</span>
<a name="ln-1549"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1550"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1551"></a>                            <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1552"></a>              <span class="k">END IF</span>
<a name="ln-1553"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1554"></a>            <span class="k">ELSE</span>
<a name="ln-1555"></a>              <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-1556"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1557"></a>
<a name="ln-1558"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1559"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedInletWaterTempHeat</span><span class="p">)</span>
<a name="ln-1560"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1561"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1562"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1563"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1564"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1565"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1566"></a>                <span class="k">END IF</span>
<a name="ln-1567"></a>
<a name="ln-1568"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1569"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1570"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1571"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1572"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1573"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1574"></a>              <span class="k">END SELECT</span>
<a name="ln-1575"></a><span class="k">            END IF</span>
<a name="ln-1576"></a>
<a name="ln-1577"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1578"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1579"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1580"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1581"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1582"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1583"></a>              <span class="k">ELSE</span>
<a name="ln-1584"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1585"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1586"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1587"></a>              <span class="k">END IF</span>
<a name="ln-1588"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1589"></a>            <span class="k">ELSE</span>
<a name="ln-1590"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1591"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1592"></a>
<a name="ln-1593"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1594"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1595"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1596"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1597"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1598"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1599"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1600"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1601"></a>                <span class="k">END IF</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1604"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1605"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1606"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1607"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1608"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1609"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1610"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1611"></a>                <span class="k">END IF</span>
<a name="ln-1612"></a>
<a name="ln-1613"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1614"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1615"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1616"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1617"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1618"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1619"></a>              <span class="k">END SELECT</span>
<a name="ln-1620"></a><span class="k">            END IF</span>
<a name="ln-1621"></a>
<a name="ln-1622"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1623"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1624"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1625"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1626"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1627"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1628"></a>              <span class="k">ELSE</span>
<a name="ln-1629"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1630"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1631"></a>              <span class="k">END IF</span>
<a name="ln-1632"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1633"></a>            <span class="k">ELSE</span>
<a name="ln-1634"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1635"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1636"></a>
<a name="ln-1637"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1638"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1639"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1640"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1641"></a>                            <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1642"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1643"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1644"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1645"></a>                <span class="k">END IF</span>
<a name="ln-1646"></a>
<a name="ln-1647"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1648"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1649"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1650"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1651"></a>                            <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1652"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1653"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1654"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1655"></a>                <span class="k">END IF</span>
<a name="ln-1656"></a>
<a name="ln-1657"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1658"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1659"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1660"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1661"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1662"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1663"></a>              <span class="k">END SELECT</span>
<a name="ln-1664"></a><span class="k">            END IF</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1667"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1668"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1669"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1670"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1671"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1672"></a>              <span class="k">ELSE</span>
<a name="ln-1673"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1674"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1675"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1676"></a>              <span class="k">END IF</span>
<a name="ln-1677"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1678"></a>            <span class="k">ELSE</span>
<a name="ln-1679"></a>              <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-1680"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1681"></a>
<a name="ln-1682"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1683"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedInletWaterTempHeat</span><span class="p">)</span>
<a name="ln-1684"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1685"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1686"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1687"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1688"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1689"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1690"></a>                <span class="k">END IF</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1693"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1694"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1695"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1696"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1697"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1698"></a>              <span class="k">END SELECT</span>
<a name="ln-1699"></a><span class="k">            END IF</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1702"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1703"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1704"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1705"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1706"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1707"></a>              <span class="k">ELSE</span>
<a name="ln-1708"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1709"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1710"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1711"></a>              <span class="k">END IF</span>
<a name="ln-1712"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1713"></a>            <span class="k">ELSE</span>
<a name="ln-1714"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1715"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1718"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1719"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1720"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1721"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1722"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1723"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1724"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1725"></a>                <span class="k">END IF</span>
<a name="ln-1726"></a>
<a name="ln-1727"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1728"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1729"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1730"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1731"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1732"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1733"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1734"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1735"></a>                <span class="k">END IF</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1738"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1739"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1740"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1741"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1742"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1743"></a>              <span class="k">END SELECT</span>
<a name="ln-1744"></a><span class="k">            END IF</span>
<a name="ln-1745"></a>
<a name="ln-1746"></a><span class="k">           </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1747"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1748"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1749"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1750"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1751"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1752"></a>              <span class="k">ELSE</span>
<a name="ln-1753"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1754"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1755"></a>                        <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1756"></a>              <span class="k">END IF</span>
<a name="ln-1757"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1758"></a>            <span class="k">ELSE</span>
<a name="ln-1759"></a>              <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1760"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1761"></a>
<a name="ln-1762"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1763"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1764"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1765"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)&amp;</span>
<a name="ln-1766"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1767"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1768"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1769"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1770"></a>                <span class="k">END IF</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a><span class="k">              CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1773"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1774"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1775"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1776"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1777"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1778"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1779"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1780"></a>                <span class="k">END IF</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1783"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1784"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1785"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1786"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1787"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1788"></a>              <span class="k">END SELECT</span>
<a name="ln-1789"></a><span class="k">            END IF</span>
<a name="ln-1790"></a>
<a name="ln-1791"></a><span class="k">            </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">7</span>
<a name="ln-1792"></a>            <span class="c">! Read waste heat modifier curve name</span>
<a name="ln-1793"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1794"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1795"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1796"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1797"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1798"></a>              <span class="k">ELSE</span>
<a name="ln-1799"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1800"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1801"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1802"></a>              <span class="k">END IF</span>
<a name="ln-1803"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1804"></a>            <span class="k">ELSE</span>
<a name="ln-1805"></a>              <span class="c">! Verify Curve Object, only legal types are BiQuadratic</span>
<a name="ln-1806"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1809"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedInletWaterTempHeat</span><span class="p">)</span>
<a name="ln-1810"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1811"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1812"></a>                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1813"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1814"></a>                                                     <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1815"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1816"></a>                <span class="k">END IF</span>
<a name="ln-1817"></a>
<a name="ln-1818"></a><span class="k">              CASE </span><span class="n">DEFAULT</span>
<a name="ln-1819"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1820"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1821"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-1822"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1823"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1824"></a>              <span class="k">END SELECT</span>
<a name="ln-1825"></a><span class="k">            END IF</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a><span class="k">        END DO</span>
<a name="ln-1828"></a>
<a name="ln-1829"></a><span class="k">        Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1830"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1831"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span>
<a name="ln-1832"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1833"></a>                        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1834"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1835"></a>                        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1836"></a>        <span class="k">END DO</span>
<a name="ln-1837"></a>
<a name="ln-1838"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1839"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1840"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1843"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1844"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1845"></a>
<a name="ln-1846"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1847"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1848"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPHEATINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1849"></a>
<a name="ln-1850"></a>        <span class="c">!create predefined report entries</span>
<a name="ln-1851"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilType</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1852"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-1853"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-1854"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">))</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>   <span class="k">END DO</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a>   <span class="c">!-------------------------AIR SOURCE, HEATING---BEGIN</span>
<a name="ln-1859"></a>   <span class="c">! Get the data for heating coil, AIR SOURCE</span>
<a name="ln-1860"></a>   <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span>
<a name="ln-1861"></a>
<a name="ln-1862"></a>   <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeatAS</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a>      <span class="n">DXCoilNum</span><span class="o">=</span> <span class="n">DXCoilNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">WatertoAirHPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1867"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1868"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1869"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>      <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1872"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1873"></a>
<a name="ln-1874"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1875"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1876"></a><span class="k">         </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1877"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1878"></a>      <span class="n">ENDIF</span>
<a name="ln-1879"></a>      <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1880"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1881"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1882"></a>      <span class="n">ENDIF</span>
<a name="ln-1883"></a>
<a name="ln-1884"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1885"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span>  <span class="o">=</span> <span class="s1">&#39;HEATING&#39;</span>
<a name="ln-1886"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span>  <span class="o">=</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span>
<a name="ln-1887"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1888"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1889"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1890"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1891"></a>
<a name="ln-1892"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1893"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1894"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1895"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1896"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1897"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1898"></a>
<a name="ln-1899"></a>      <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1900"></a>
<a name="ln-1901"></a>
<a name="ln-1902"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1903"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1904"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 1.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1905"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-1906"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1907"></a>      <span class="k">End If</span>
<a name="ln-1908"></a>
<a name="ln-1909"></a><span class="k">      If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1910"></a><span class="k">        </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-1911"></a>      <span class="k">END IF</span>
<a name="ln-1912"></a>
<a name="ln-1913"></a><span class="k">      If</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1914"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1915"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1916"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be valid speed level&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1917"></a>                                                 <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-1918"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1919"></a>      <span class="k">End If</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a>      <span class="c">!part load curve</span>
<a name="ln-1922"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1923"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1924"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1925"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1926"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1927"></a>        <span class="k">ELSE</span>
<a name="ln-1928"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1929"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1930"></a>        <span class="k">END IF</span>
<a name="ln-1931"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1932"></a>      <span class="k">ELSE</span>
<a name="ln-1933"></a><span class="k">          </span><span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1934"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1935"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-1936"></a>                  <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-1937"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1938"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-1939"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1940"></a>          <span class="k">END IF</span>
<a name="ln-1941"></a><span class="k">      END IF</span>
<a name="ln-1942"></a>
<a name="ln-1943"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1944"></a>
<a name="ln-1945"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1946"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1947"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1948"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1949"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1950"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...field is required because &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &quot;ReverseCycle&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1951"></a>          <span class="k">ELSE</span>
<a name="ln-1952"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1953"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1954"></a>          <span class="k">END IF</span>
<a name="ln-1955"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1956"></a>        <span class="k">ELSE</span>
<a name="ln-1957"></a>          <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-1958"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">))</span>
<a name="ln-1959"></a>
<a name="ln-1960"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1961"></a>
<a name="ln-1962"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1963"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1964"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1965"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">)))</span>
<a name="ln-1966"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1967"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1968"></a>          <span class="k">END SELECT</span>
<a name="ln-1969"></a><span class="k">        END IF</span>
<a name="ln-1970"></a><span class="k">     END IF</span>
<a name="ln-1971"></a>
<a name="ln-1972"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">))</span>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">=</span> <span class="n">ReverseCycle</span>
<a name="ln-1973"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Resistive&#39;</span><span class="p">))</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">=</span> <span class="n">Resistive</span>
<a name="ln-1974"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1975"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1976"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1977"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...valid values for this field are ReverseCycle or Resistive.&#39;</span><span class="p">)</span>
<a name="ln-1978"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1979"></a>    <span class="k">END IF</span>
<a name="ln-1980"></a>
<a name="ln-1981"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;Timed&#39;</span><span class="p">))</span>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="o">=</span> <span class="n">Timed</span>
<a name="ln-1982"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;OnDemand&#39;</span><span class="p">))</span>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="o">=</span> <span class="n">OnDemand</span>
<a name="ln-1983"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1984"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1985"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1986"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...valid values for this field are Timed or OnDemand.&#39;</span><span class="p">)</span>
<a name="ln-1987"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1988"></a>    <span class="k">END IF</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a>  <span class="c">!Set minimum OAT for heat pump compressor operation</span>
<a name="ln-1991"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1992"></a>
<a name="ln-1993"></a>   <span class="c">! reserved for HSPF calculation</span>
<a name="ln-1994"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a>   <span class="c">!Set maximum outdoor temp for defrost to occur</span>
<a name="ln-1997"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1998"></a>
<a name="ln-1999"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-2000"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2001"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2002"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2003"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-2004"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2005"></a>     <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2006"></a>   <span class="k">END IF</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a>   <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-2009"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2010"></a>
<a name="ln-2011"></a>   <span class="c">!Set defrost time period</span>
<a name="ln-2012"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2013"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2014"></a><span class="k">     CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-2015"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0 for defrost control = TIMED.&#39;</span><span class="p">)</span>
<a name="ln-2016"></a>   <span class="k">END IF</span>
<a name="ln-2017"></a>
<a name="ln-2018"></a>  <span class="c">!Set defrost capacity (for resistive defrost)</span>
<a name="ln-2019"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2020"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2021"></a><span class="k">     CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-2022"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0 for defrost strategy = RESISTIVE.&#39;</span><span class="p">)</span>
<a name="ln-2023"></a>   <span class="k">END IF</span>
<a name="ln-2024"></a>
<a name="ln-2025"></a><span class="k">   Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-2026"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2027"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2028"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2029"></a>
<a name="ln-2030"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2031"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2032"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...too small &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2033"></a>            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2034"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2035"></a>        <span class="n">ENDIF</span>
<a name="ln-2036"></a>
<a name="ln-2037"></a>        <span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-2038"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2039"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2040"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2041"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2042"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2043"></a>          <span class="k">ELSE</span>
<a name="ln-2044"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2045"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2046"></a>                        <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2047"></a>          <span class="k">END IF</span>
<a name="ln-2048"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2049"></a>        <span class="k">ELSE</span>
<a name="ln-2050"></a>          <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-2051"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2052"></a>
<a name="ln-2053"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2054"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedAmbAirTempHeat</span><span class="p">)</span>
<a name="ln-2055"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2056"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-2057"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-2058"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2059"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-2060"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2061"></a>            <span class="k">END IF</span>
<a name="ln-2062"></a>
<a name="ln-2063"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-2064"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2065"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2066"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-2067"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2068"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2069"></a>          <span class="k">END SELECT</span>
<a name="ln-2070"></a><span class="k">        END IF</span>
<a name="ln-2071"></a>
<a name="ln-2072"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-2073"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2074"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2075"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2076"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2077"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2078"></a>          <span class="k">ELSE</span>
<a name="ln-2079"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2080"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-2081"></a>                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2082"></a>          <span class="k">END IF</span>
<a name="ln-2083"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2084"></a>        <span class="k">ELSE</span>
<a name="ln-2085"></a>          <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-2086"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2087"></a>
<a name="ln-2088"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2089"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2090"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2091"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-2092"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-2093"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2094"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-2095"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2096"></a>            <span class="k">END IF</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a><span class="k">          CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2099"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2100"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2101"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-2102"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-2103"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2104"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-2105"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2106"></a>            <span class="k">END IF</span>
<a name="ln-2107"></a>
<a name="ln-2108"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-2109"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2110"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2111"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-2112"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2113"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2114"></a>          <span class="k">END SELECT</span>
<a name="ln-2115"></a><span class="k">        END IF</span>
<a name="ln-2116"></a>
<a name="ln-2117"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-2118"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2119"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2120"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2121"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2122"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2123"></a>          <span class="k">ELSE</span>
<a name="ln-2124"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2125"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2126"></a>                    <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2127"></a>          <span class="k">END IF</span>
<a name="ln-2128"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2129"></a>        <span class="k">ELSE</span>
<a name="ln-2130"></a>          <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-2131"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2132"></a>
<a name="ln-2133"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2134"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedAmbAirTempHeat</span><span class="p">)</span>
<a name="ln-2135"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2136"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-2137"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-2138"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2139"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-2140"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2141"></a>            <span class="k">END IF</span>
<a name="ln-2142"></a>
<a name="ln-2143"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-2144"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2145"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2146"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2147"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2148"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2149"></a>          <span class="k">END SELECT</span>
<a name="ln-2150"></a><span class="k">        END IF</span>
<a name="ln-2151"></a>
<a name="ln-2152"></a><span class="k">        </span><span class="n">AlfaFieldIncre</span> <span class="o">=</span> <span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<a name="ln-2153"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2154"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2155"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2156"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2157"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2158"></a>          <span class="k">ELSE</span>
<a name="ln-2159"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2160"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2161"></a>          <span class="k">END IF</span>
<a name="ln-2162"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2163"></a>        <span class="k">ELSE</span>
<a name="ln-2164"></a>          <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-2165"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2168"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2169"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2170"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-2171"></a>                    <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-2172"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2173"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-2174"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2175"></a>            <span class="k">END IF</span>
<a name="ln-2176"></a>
<a name="ln-2177"></a><span class="k">          CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2178"></a>            <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2179"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2180"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2181"></a>                    <span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-2182"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2183"></a>                                                 <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-2184"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2185"></a>            <span class="k">END IF</span>
<a name="ln-2186"></a>
<a name="ln-2187"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-2188"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2189"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlfaFieldIncre</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2190"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-2191"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2192"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2193"></a>          <span class="k">END SELECT</span>
<a name="ln-2194"></a><span class="k">        END IF</span>
<a name="ln-2195"></a><span class="k">    END DO</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2198"></a>
<a name="ln-2199"></a><span class="k">    Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-2200"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2201"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span>
<a name="ln-2202"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2203"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2204"></a>    <span class="k">END DO</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2207"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2208"></a>         <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2211"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2212"></a>         <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2213"></a>
<a name="ln-2214"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2215"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2216"></a>         <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPHEATINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2217"></a>
<a name="ln-2218"></a>    <span class="c">!create predefined report entries</span>
<a name="ln-2219"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilType</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-2220"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-2221"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-2222"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">))</span>
<a name="ln-2223"></a>
<a name="ln-2224"></a>  <span class="k">END DO</span>
<a name="ln-2225"></a>
<a name="ln-2226"></a>   <span class="c">!-------------------------AIR SOURCE HEATING---END</span>
<a name="ln-2227"></a>
<a name="ln-2228"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">)</span>
<a name="ln-2229"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">)</span>
<a name="ln-2230"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-2231"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-2232"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-2233"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2236"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found getting input. Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-2237"></a>  <span class="n">ENDIF</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>  <span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span>
<a name="ln-2240"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2241"></a>        <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2242"></a>        <span class="c">! Setup Report variables for the Heat Pump</span>
<a name="ln-2243"></a>
<a name="ln-2244"></a>      <span class="c">!cooling and heating coils separately</span>
<a name="ln-2245"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2246"></a>       <span class="c">! air source cooling coils</span>
<a name="ln-2247"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2248"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2249"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2250"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2251"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2252"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2253"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2254"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2255"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2256"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2257"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2258"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2259"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2260"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2261"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2262"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2263"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2264"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2265"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2266"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2267"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2268"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2269"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2270"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2271"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Upper Speed Level []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2272"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedNumReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2273"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Neighboring Speed Levels Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2274"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedRatioReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2275"></a>
<a name="ln-2276"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2277"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2278"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2279"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume [m3]&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span><span class="p">,&amp;</span>
<a name="ln-2280"></a>                                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2281"></a>                                 <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;OnSiteWater&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2282"></a>                                 <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Condensate&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2283"></a>        <span class="n">ENDIF</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2286"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condenser Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2287"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2288"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Water Volume [m3]&#39;</span><span class="p">,&amp;</span>
<a name="ln-2289"></a>                            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2290"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2291"></a>                                      <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2292"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Mains Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2293"></a>                                        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2294"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2295"></a>                                      <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2296"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Power [W]&#39;</span><span class="p">,&amp;</span>
<a name="ln-2297"></a>                                        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2298"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2299"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2300"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-2301"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2302"></a>                                      <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2303"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2304"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2305"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2306"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2307"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2308"></a>                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2309"></a>          <span class="k">END IF</span>
<a name="ln-2310"></a><span class="k">        END IF</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Crankcase Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2313"></a>                            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-2314"></a>                           <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2315"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Crankcase Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2316"></a>                                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2317"></a>                                    <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2318"></a>                                    <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2319"></a>      <span class="k">ELSE</span>
<a name="ln-2320"></a>      <span class="c">! air source heating coils</span>
<a name="ln-2321"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2322"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2323"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2324"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2325"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2326"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2327"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2328"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2329"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2330"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2331"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Sensible Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2332"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2333"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2334"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2335"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2336"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2337"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2338"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2339"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2340"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2341"></a>
<a name="ln-2342"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2343"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2344"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Upper Speed Level []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2345"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedNumReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2346"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Neighboring Speed Levels Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2347"></a>              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedRatioReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2348"></a>
<a name="ln-2349"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2350"></a>                              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-2351"></a>                              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2352"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2353"></a>                              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-2354"></a>                             <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2355"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2356"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Crankcase Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2357"></a>                              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-2358"></a>                             <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2359"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Crankcase Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2360"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2361"></a>                                      <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2362"></a>                                      <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2363"></a>
<a name="ln-2364"></a>      <span class="k">END IF</span>
<a name="ln-2365"></a><span class="k">    ELSE</span>
<a name="ln-2366"></a>
<a name="ln-2367"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="o">==</span> <span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2368"></a>       <span class="c">! cooling WAHP coil</span>
<a name="ln-2369"></a>            <span class="c">! Setup Report variables for water source Heat Pump</span>
<a name="ln-2370"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2371"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2372"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2373"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2374"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2375"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2376"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2377"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2378"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2379"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2380"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2381"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2382"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2383"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2384"></a>
<a name="ln-2385"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2386"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2387"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2388"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2389"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2390"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2391"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2392"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2393"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2394"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2395"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2396"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2397"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2398"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2399"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2400"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2401"></a>
<a name="ln-2402"></a>
<a name="ln-2403"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Upper Speed Level []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2404"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedNumReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2405"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Neighboring Speed Levels Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2406"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedRatioReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2407"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Recoverable Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2408"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QWasteHeat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2409"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="o">==</span> <span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2410"></a>       <span class="c">! heating WAHP coil</span>
<a name="ln-2411"></a>            <span class="c">! Setup Report variables for water source Heat Pump</span>
<a name="ln-2412"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2413"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2414"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2415"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2416"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Sensible Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2417"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2418"></a>
<a name="ln-2419"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2420"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2421"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2422"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2423"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2424"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2425"></a>
<a name="ln-2426"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2427"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2428"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2429"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2430"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2431"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2432"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2433"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2434"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2435"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2436"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2437"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2438"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2439"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2440"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2441"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2442"></a>
<a name="ln-2443"></a>
<a name="ln-2444"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Upper Speed Level []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2445"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedNumReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2446"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Neighboring Speed Levels Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2447"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SpeedRatioReport</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2448"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Recoverable Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2449"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QWasteHeat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2450"></a>      <span class="n">ENDIF</span>
<a name="ln-2451"></a>    <span class="k">END IF</span>
<a name="ln-2452"></a><span class="k">   END DO</span>
<a name="ln-2453"></a>
<a name="ln-2454"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2455"></a><span class="k">     CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2456"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2457"></a>  <span class="k">END IF</span>
<a name="ln-2458"></a>
<a name="ln-2459"></a><span class="k">  RETURN</span>
<a name="ln-2460"></a>
<a name="ln-2461"></a><span class="k">END SUBROUTINE </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-2462"></a>
<a name="ln-2463"></a> <span class="c">! Beginning Initialization Section of the Module</span>
<a name="ln-2464"></a><span class="c">!******************************************************************************</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a><span class="k">SUBROUTINE </span><span class="n">InitVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2467"></a>                                  <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-2468"></a>
<a name="ln-2469"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2470"></a>          <span class="c">!       AUTHOR         Bo Shen, based on  MODULE WatertoAirHeatPumpSimple:InitSimpleWatertoAirHP</span>
<a name="ln-2471"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-2472"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2473"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2474"></a>
<a name="ln-2475"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2476"></a>          <span class="c">! This subroutine is for initializations of the variable speed Water to Air HP Components.</span>
<a name="ln-2477"></a>
<a name="ln-2478"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2479"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-2480"></a>
<a name="ln-2481"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-2482"></a>
<a name="ln-2483"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2484"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span>  <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-2485"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysSizingCalc</span>
<a name="ln-2486"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-2487"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-2488"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-2489"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2490"></a>
<a name="ln-2491"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>                  <span class="c">! Current DXCoilNum under simulation</span>
<a name="ln-2496"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span> <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-2497"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>        <span class="c">! Heat pump time constant [s]</span>
<a name="ln-2498"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>          <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-2499"></a>                                                    <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-2500"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensLoad</span>                 <span class="c">! Control zone sensible load[W]</span>
<a name="ln-2501"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentLoad</span>               <span class="c">! Control zone latent load[W]</span>
<a name="ln-2502"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>            <span class="c">! fan operating mode</span>
<a name="ln-2503"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>        <span class="c">! ratio of compressor on flow to average flow over time step</span>
<a name="ln-2504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>               <span class="c">! compressor speed ratio</span>
<a name="ln-2505"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>                 <span class="c">! compressor speed number</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>
<a name="ln-2508"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2509"></a>          <span class="c">! na</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2512"></a>          <span class="c">! na</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2515"></a>          <span class="c">! na</span>
<a name="ln-2516"></a>
<a name="ln-2517"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2518"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">AirInletNode</span>        <span class="c">! Node Number of the air inlet</span>
<a name="ln-2519"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">WaterInletNode</span>      <span class="c">! Node Number of the Water inlet</span>
<a name="ln-2520"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time allocation flag</span>
<a name="ln-2521"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! used for initializations each begin environment flag</span>
<a name="ln-2522"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>  <span class="c">! used for sizing PTHP inputs one time</span>
<a name="ln-2523"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-2524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">rho</span>                                    <span class="c">! local fluid density</span>
<a name="ln-2525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Cp</span>                                     <span class="c">! local fluid specific heat</span>
<a name="ln-2526"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedCal</span>                                   <span class="c">! calculated speed level</span>
<a name="ln-2527"></a>  <span class="kt">LOGICAL</span>     <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-2528"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>                        <span class="c">! TRUE when errors found, air loop initialization error</span>
<a name="ln-2529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedVolFlowPerRatedTotCap</span>               <span class="c">! Rated Air Volume Flow Rate divided by Rated Total Capacity [m3/s-W)</span>
<a name="ln-2530"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Mode</span>                                       <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-2531"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHeatPumpIndoorAirTemp</span>
<a name="ln-2532"></a>  <span class="c">! Indoor dry-bulb temperature to heat pump evaporator at rated conditions [C]</span>
<a name="ln-2533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHeatPumpIndoorHumRat</span>                <span class="c">! Inlet humidity ratio to heat pump evaporator at rated conditions [kg/kg]</span>
<a name="ln-2534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterFlowScale</span>                           <span class="c">! water flow scaling factor match rated flow rate</span>
<a name="ln-2535"></a>
<a name="ln-2536"></a>            <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2537"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SmallDifferenceTest</span><span class="o">=</span><span class="mf">0.00000001d0</span>
<a name="ln-2538"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;InitVarSpeedCoil&#39;</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>
<a name="ln-2541"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2542"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-2543"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-2544"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-2545"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-2546"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2547"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2548"></a>    <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2549"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2550"></a>
<a name="ln-2551"></a>  <span class="k">END IF</span>
<a name="ln-2552"></a>
<a name="ln-2553"></a><span class="c">! water source</span>
<a name="ln-2554"></a>  <span class="k">IF</span><span class="p">(</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2555"></a>    <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2556"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2557"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2558"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2559"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2560"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2561"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2562"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2563"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2564"></a>                                     <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-2565"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2566"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitVarSpeedCoil: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-2567"></a>        <span class="n">ENDIF</span>
<a name="ln-2568"></a>        <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2569"></a>      <span class="n">ENDIF</span>
<a name="ln-2570"></a>  <span class="k">ELSE</span>
<a name="ln-2571"></a><span class="k">    </span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2572"></a>  <span class="k">END IF</span>
<a name="ln-2573"></a>
<a name="ln-2574"></a><span class="k">  IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2575"></a>    <span class="c">! for each furnace, do the sizing once.</span>
<a name="ln-2576"></a>    <span class="k">CALL </span><span class="n">SizeVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a>    <span class="c">! Multispeed Cooling</span>
<a name="ln-2581"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span> <span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2582"></a>        <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2583"></a><span class="k">      Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-2584"></a>        <span class="c">! Check for zero capacity or zero max flow rate</span>
<a name="ln-2585"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2586"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VarSpeedCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2587"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2588"></a>                            <span class="s1">&#39; has zero rated total capacity at speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-2589"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2590"></a>        <span class="k">END IF</span>
<a name="ln-2591"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2592"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VarSpeedCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2593"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2594"></a>                            <span class="s1">&#39; has zero rated air flow rate at speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-2595"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2596"></a>        <span class="k">END IF</span>
<a name="ln-2597"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2598"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2599"></a>        <span class="n">ENDIF</span>
<a name="ln-2600"></a>        <span class="c">!</span>
<a name="ln-2601"></a>        <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-2602"></a>        <span class="c">!</span>
<a name="ln-2603"></a>        <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2604"></a>                                                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-2605"></a>       <span class="c">!note: variable-speed HP can exceed the flow rate restrictions at low speed levels</span>
<a name="ln-2606"></a><span class="c">!        IF (((MinRatedAirVolFlowPerRatedTotCap - RatedVolFlowPerRatedTotCap) &gt; SmallDifferenceTest).OR. &amp;</span>
<a name="ln-2607"></a><span class="c">!           ((RatedVolFlowPerRatedTotCap - MaxRatedAirVolFlowPerRatedTotCap) &gt; SmallDifferenceTest)) THEN</span>
<a name="ln-2608"></a><span class="c">!          CALL ShowSevereError (&#39;Sizing: &#39;//TRIM(VarSpeedCoil(DXCoilNum)%VarSpeedCoilType) &amp;</span>
<a name="ln-2609"></a><span class="c">!           // &#39; &quot;&#39;//TRIM(VarSpeedCoil(DXCoilNum)%Name)//  &amp;</span>
<a name="ln-2610"></a><span class="c">!                &#39;&quot;: Rated air volume flow rate per watt of rated total &#39;// &amp;</span>
<a name="ln-2611"></a><span class="c">!                &#39;cooling capacity is out of range at speed &#39;//TRIM(TrimSigDigits(Mode)))</span>
<a name="ln-2612"></a><span class="c">!          CALL ShowContinueError &amp;</span>
<a name="ln-2613"></a><span class="c">!           (&#39;Min Rated Vol Flow Per Watt=[&#39;//TRIM(TrimSigDigits(MinRatedAirVolFlowPerRatedTotCap,3))//&#39;], &#39;// &amp;</span>
<a name="ln-2614"></a><span class="c">!           &#39;Rated Vol Flow Per Watt=[&#39;//TRIM(TrimSigDigits(RatedVolFlowPerRatedTotCap,3))//&#39;],  &amp;</span>
<a name="ln-2615"></a><span class="c">!           Max Rated Vol Flow Per Watt=[&#39;// &amp;</span>
<a name="ln-2616"></a><span class="c">!           TRIM(TrimSigDigits(MaxRatedAirVolFlowPerRatedTotCap,3))//&#39;]. See Input-Output Reference Manual for valid range.&#39;)</span>
<a name="ln-2617"></a><span class="c">!        END IF</span>
<a name="ln-2618"></a><span class="c">!        VarSpeedCoil(DXCoilNum)%MSRatedAirMassFlowRate(Mode) = VarSpeedCoil(DXCoilNum)%MSRatedAirVolFlowRate(Mode)* &amp;</span>
<a name="ln-2619"></a><span class="c">!          PsyRhoAirFnPbTdbW(OutBaroPress,RatedInletAirTemp,RatedInletAirHumRat,RoutineName)</span>
<a name="ln-2620"></a><span class="c">!        ! get high speed rated coil bypass factor</span>
<a name="ln-2621"></a><span class="c">!        VarSpeedCoil(DXCoilNum)%MSRatedCBF(Mode) = CalcCBF(VarSpeedCoil(DXCoilNum)%VarSpeedCoilType, &amp;</span>
<a name="ln-2622"></a><span class="c">!               VarSpeedCoil(DXCoilNum)%Name,&amp;</span>
<a name="ln-2623"></a><span class="c">!                                           RatedInletAirTemp,RatedInletAirHumRat,VarSpeedCoil(DXCoilNum)%MSRatedTotCap(Mode),&amp;</span>
<a name="ln-2624"></a><span class="c">!                                           VarSpeedCoil(DXCoilNum)%MSRatedAirMassFlowRate(Mode), &amp;</span>
<a name="ln-2625"></a><span class="c">!                           VarSpeedCoil(DXCoilNum)%MSRatedSHR(Mode))</span>
<a name="ln-2626"></a>      <span class="k">END DO</span>
<a name="ln-2627"></a><span class="k">    END IF</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>    <span class="c">! Multispeed Heating</span>
<a name="ln-2630"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2631"></a>        <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2632"></a><span class="k">      </span><span class="n">RatedHeatPumpIndoorAirTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.11d0</span>  <span class="c">! 21.11C or 70F</span>
<a name="ln-2633"></a>      <span class="n">RatedHeatPumpIndoorHumRat</span> <span class="o">=</span> <span class="mf">0.00881d0</span> <span class="c">! Humidity ratio corresponding to 70F dry bulb/60F wet bulb</span>
<a name="ln-2634"></a>      <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-2635"></a>
<a name="ln-2636"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2637"></a>         <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RatedHeatPumpIndoorAirTemp</span><span class="p">,</span><span class="n">RatedHeatPumpIndoorHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2638"></a>        <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-2639"></a>        <span class="c">!</span>
<a name="ln-2640"></a>        <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2641"></a>                                                  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-2642"></a>        <span class="c">!note: variable-speed HP can exceed the flow rate restrictions at low speed levels</span>
<a name="ln-2643"></a><span class="c">!        IF (((MinRatedAirVolFlowPerRatedTotCap - RatedVolFlowPerRatedTotCap) &gt; SmallDifferenceTest).OR. &amp;</span>
<a name="ln-2644"></a><span class="c">!            ((RatedVolFlowperRatedTotCap - MaxRatedAirVolFlowPerRatedTotCap) &gt; SmallDifferenceTest)) THEN</span>
<a name="ln-2645"></a><span class="c">!          CALL ShowSevereError (&#39;Coil:Heating:DX:MultiSpeed &#39;//TRIM(VarSpeedCoil(DXCoilNum)%Name)//  &amp;</span>
<a name="ln-2646"></a><span class="c">!                              &#39;: Rated air volume flow rate per watt of rated total &#39;// &amp;</span>
<a name="ln-2647"></a><span class="c">!                &#39;heating capacity is out of range at speed &#39;//TRIM(TrimSigDigits(Mode)))</span>
<a name="ln-2648"></a><span class="c">!          CALL ShowContinueError(&#39;Min Rated Vol Flow Per Watt=[&#39;//TRIM(TrimSigDigits &amp;</span>
<a name="ln-2649"></a><span class="c">!           (MinRatedAirVolFlowPerRatedTotCap,3))//&#39;], &#39;// &amp;</span>
<a name="ln-2650"></a><span class="c">!           &#39;Rated Vol Flow Per Watt=[&#39;//TRIM(TrimSigDigits(RatedVolFlowPerRatedTotCap,3))//&#39;],  &amp;</span>
<a name="ln-2651"></a><span class="c">!               Max Rated Vol Flow Per Watt=[&#39;// &amp;</span>
<a name="ln-2652"></a><span class="c">!           TRIM(TrimSigDigits(MaxRatedAirVolFlowPerRatedTotCap,3))//&#39;]. See Input-Output Reference  &amp;</span>
<a name="ln-2653"></a><span class="c">!                Manual for valid range.&#39;)</span>
<a name="ln-2654"></a><span class="c">!        END IF</span>
<a name="ln-2655"></a>      <span class="k">End Do</span>
<a name="ln-2656"></a><span class="k">    END IF</span>
<a name="ln-2657"></a>
<a name="ln-2658"></a><span class="k">  END IF</span>
<a name="ln-2659"></a>
<a name="ln-2660"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2661"></a><span class="k">      </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-2662"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2663"></a><span class="k">     </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2664"></a>  <span class="k">ELSE</span>
<a name="ln-2665"></a><span class="k">     </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-2666"></a>  <span class="k">END IF</span>
<a name="ln-2667"></a>
<a name="ln-2668"></a><span class="k">  IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2669"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-2670"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirVolFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-2671"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-2672"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-2673"></a>  <span class="k">ELSE</span>
<a name="ln-2674"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-2675"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2676"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirVolFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-2677"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2678"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-2679"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2680"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-2681"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2682"></a>  <span class="k">END IF</span>
<a name="ln-2683"></a>
<a name="ln-2684"></a>
<a name="ln-2685"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-2686"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2687"></a>      <span class="c">! Do the initializations to start simulation</span>
<a name="ln-2688"></a>
<a name="ln-2689"></a>    <span class="n">AirInletNode</span>   <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-2690"></a>
<a name="ln-2691"></a>    <span class="c">!Initialize all report variables to a known state at beginning of simulation</span>
<a name="ln-2692"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirVolFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2693"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2694"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2695"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2696"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2697"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterVolFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2698"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2699"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2700"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2701"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2702"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2703"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2704"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2705"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2706"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2707"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2708"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2709"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2710"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2711"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2712"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2713"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2714"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2715"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2716"></a>
<a name="ln-2717"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">=</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-2718"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="o">=</span><span class="n">HPTimeConstant</span>
<a name="ln-2719"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="o">=</span><span class="n">FanDelayTime</span>
<a name="ln-2720"></a>
<a name="ln-2721"></a>
<a name="ln-2722"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2723"></a>        <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2724"></a><span class="k">        </span><span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-2725"></a>
<a name="ln-2726"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2727"></a>                                  <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2728"></a>                                  <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2729"></a>                                  <span class="s1">&#39;InitSimpleWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-2730"></a>        <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2731"></a>                                  <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2732"></a>                                  <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2733"></a>                                  <span class="s1">&#39;InitSimpleWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-2734"></a>
<a name="ln-2735"></a>    <span class="c">!    VarSpeedCoil(DXCoilNum)%DesignWaterMassFlowRate= &amp;</span>
<a name="ln-2736"></a>    <span class="c">!                             rho * VarSpeedCoil(DXCoilNum)%RatedWaterVolFlowRate</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>        <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2739"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2740"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2741"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2742"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2743"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2744"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2745"></a>
<a name="ln-2746"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-2747"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2748"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2749"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2750"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2751"></a>
<a name="ln-2752"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-2753"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2754"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2755"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2756"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2757"></a>    <span class="k">END IF</span>
<a name="ln-2758"></a>
<a name="ln-2759"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2762"></a>
<a name="ln-2763"></a>  <span class="k">END IF</span>  <span class="c">! End If for the Begin Environment initializations</span>
<a name="ln-2764"></a>
<a name="ln-2765"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2766"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2767"></a>  <span class="n">ENDIF</span>
<a name="ln-2768"></a>
<a name="ln-2769"></a>  <span class="c">! Do the following initializations (every time step): This should be the info from</span>
<a name="ln-2770"></a>  <span class="c">! the previous components outlets or the node data in this section.</span>
<a name="ln-2771"></a>  <span class="c">! First set the conditions for the air into the heat pump model</span>
<a name="ln-2772"></a>
<a name="ln-2773"></a>    <span class="c">! Set water and air inlet nodes</span>
<a name="ln-2774"></a>
<a name="ln-2775"></a>    <span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-2776"></a>    <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-2777"></a>
<a name="ln-2778"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SensLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LatentLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2779"></a>
<a name="ln-2780"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2781"></a><span class="k">        </span><span class="n">WaterFlowScale</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2782"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-2783"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="o">*</span><span class="n">WaterFlowScale</span>
<a name="ln-2784"></a>    <span class="k">ELSE</span>
<a name="ln-2785"></a><span class="k">        </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2786"></a>    <span class="k">END IF</span>
<a name="ln-2787"></a>
<a name="ln-2788"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2789"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-2790"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2791"></a><span class="c">!    VarSpeedCoil(DXCoilNum)%AirMassFlowRate   = VarSpeedCoil(DXCoilNum)%DesignAirVolFlowRate*  &amp;</span>
<a name="ln-2792"></a><span class="c">!             PsyRhoAirFnPbTdbW(OutBaroPress,Node(AirInletNode)%Temp,Node(AirInletNode)%HumRat)</span>
<a name="ln-2793"></a>        <span class="c">!If air flow is less than 25% rated flow. Then set air flow to the 25% of rated conditions</span>
<a name="ln-2794"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2795"></a>             <span class="mf">0.25d0</span><span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirVolFlowRate</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-2796"></a>                 <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2797"></a><span class="k">            </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2798"></a>              <span class="mf">0.25d0</span><span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirVolFlowRate</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2799"></a>                  <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>
<a name="ln-2800"></a>        <span class="k">END IF</span>
<a name="ln-2801"></a><span class="k">    ELSE</span> <span class="c">!CYCLIC FAN, NOT CORRECTION, WILL BE PROCESSED IN THE FOLLOWING SUBROUTINES</span>
<a name="ln-2802"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2803"></a>    <span class="k">END IF</span>
<a name="ln-2804"></a>
<a name="ln-2805"></a><span class="k">  ELSE</span> <span class="c">!heat pump is off</span>
<a name="ln-2806"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2807"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2808"></a>  <span class="n">ENDIF</span>
<a name="ln-2809"></a>
<a name="ln-2810"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2811"></a>        <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2812"></a><span class="k">      CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2813"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2814"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2815"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2816"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2817"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2818"></a>                                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2819"></a>
<a name="ln-2820"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2821"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-2822"></a>   <span class="k">ELSE</span>
<a name="ln-2823"></a><span class="k">       </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2824"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2825"></a>   <span class="k">END IF</span>
<a name="ln-2826"></a>
<a name="ln-2827"></a><span class="k">   </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2828"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2829"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-2830"></a>
<a name="ln-2831"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">=</span> <span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-2832"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>       <span class="o">=</span> <span class="n">HPTimeConstant</span>
<a name="ln-2833"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanDelayTime</span>         <span class="o">=</span> <span class="n">FanDelayTime</span>
<a name="ln-2834"></a>
<a name="ln-2835"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirPressure</span>    <span class="o">=</span> <span class="n">OutBaroPress</span> <span class="c">!temporary</span>
<a name="ln-2836"></a>   <span class="c">! Outlet variables</span>
<a name="ln-2837"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2838"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2839"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2840"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2841"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2842"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2843"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2844"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2845"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2846"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2847"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2848"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2849"></a>
<a name="ln-2850"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2851"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2852"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2853"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2854"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2855"></a>
<a name="ln-2856"></a>   <span class="c">! bug fix, must set zeros to the variables below, otherwise can&#39;t pass switch DD test</span>
<a name="ln-2857"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2858"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2859"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2860"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2861"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2862"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2863"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2864"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2865"></a>   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>  <span class="k">RETURN</span>
<a name="ln-2868"></a>
<a name="ln-2869"></a><span class="k">END SUBROUTINE </span><span class="n">InitVarSpeedCoil</span>
<a name="ln-2870"></a>
<a name="ln-2871"></a><span class="k">SUBROUTINE </span><span class="n">SizeVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-2872"></a>
<a name="ln-2873"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2874"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:SizeHVACWaterToAir</span>
<a name="ln-2875"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-2876"></a>          <span class="c">!       MODIFIED       August 2013 Daeho Kang, add component sizing table entries</span>
<a name="ln-2877"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2878"></a>
<a name="ln-2879"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2880"></a>          <span class="c">! This subroutine is for sizing WSHP Components for which nominal capacities</span>
<a name="ln-2881"></a>          <span class="c">! and flow rates have not been specified in the input</span>
<a name="ln-2882"></a>
<a name="ln-2883"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2884"></a>          <span class="c">! Obtains heating capacities and flow rates from the zone or system sizing arrays.</span>
<a name="ln-2885"></a>          <span class="c">!</span>
<a name="ln-2886"></a>          <span class="c">! NOTE: For WSHP&#39;s we are sizing the heating capacity to be</span>
<a name="ln-2887"></a>          <span class="c">! equal to the cooling capacity.  Thus the cooling and</span>
<a name="ln-2888"></a>          <span class="c">! and heating capacities of a DX heat pump system will be identical. In real life the ARI</span>
<a name="ln-2889"></a>          <span class="c">! heating and cooling capacities are close but not identical.</span>
<a name="ln-2890"></a>
<a name="ln-2891"></a>
<a name="ln-2892"></a>
<a name="ln-2893"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2894"></a>          <span class="c">! na</span>
<a name="ln-2895"></a>
<a name="ln-2896"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2897"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-2898"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">MyPlantSizingIndex</span>
<a name="ln-2899"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallAirVolFlow</span><span class="p">,</span> <span class="n">SmallLoad</span>
<a name="ln-2900"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-2901"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-2902"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-2903"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-2904"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-2905"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-2906"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-2907"></a>
<a name="ln-2908"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2909"></a>
<a name="ln-2910"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2911"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>
<a name="ln-2912"></a>
<a name="ln-2913"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2914"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SizeVarSpeedCoil&#39;</span>
<a name="ln-2915"></a>
<a name="ln-2916"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2917"></a>          <span class="c">! na</span>
<a name="ln-2918"></a>
<a name="ln-2919"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2920"></a>          <span class="c">! na</span>
<a name="ln-2921"></a>
<a name="ln-2922"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2923"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoair</span>
<a name="ln-2924"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>
<a name="ln-2925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixTemp</span>
<a name="ln-2926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixHumRat</span>
<a name="ln-2927"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixEnth</span>
<a name="ln-2928"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixWetBulb</span>
<a name="ln-2929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupTemp</span>
<a name="ln-2930"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHumRat</span>
<a name="ln-2931"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupEnth</span>
<a name="ln-2932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutTemp</span>
<a name="ln-2933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutAirFrac</span>
<a name="ln-2934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowRate</span>
<a name="ln-2935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2936"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2937"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapAtPeak</span>
<a name="ln-2938"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TimeStepNumAtMax</span>
<a name="ln-2939"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DDNum</span>
<a name="ln-2940"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PltSizNum</span>
<a name="ln-2941"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedCapCoolTotalAutosized</span>
<a name="ln-2942"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedCapCoolSensAutosized</span>
<a name="ln-2943"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedCapHeatAutosized</span>
<a name="ln-2944"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedAirFlowAutosized</span>
<a name="ln-2945"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedWaterFlowAutosized</span>
<a name="ln-2946"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-2947"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SystemCapacity</span>
<a name="ln-2948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-2949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cp</span>
<a name="ln-2950"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NormSpeed</span> <span class="c">!norminal speed level</span>
<a name="ln-2951"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UpperSpeed</span> <span class="c">!highest speed level</span>
<a name="ln-2952"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Mode</span> <span class="c">!speed level</span>
<a name="ln-2953"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoW</span> <span class="c">!water density</span>
<a name="ln-2954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoA</span> <span class="c">!air density</span>
<a name="ln-2955"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>  <span class="c">!sensible heat transfer ratio</span>
<a name="ln-2956"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirMassFlowRate</span>  <span class="c">!rated air mass flow rate</span>
<a name="ln-2957"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFRated</span>  <span class="c">!bypass factor at the rated condition, considering difference in flow rates</span>
<a name="ln-2958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedInletEnth</span> <span class="c">!rated inlet air enthalpy</span>
<a name="ln-2959"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal1</span> <span class="c">!placeholder for calculating SHR</span>
<a name="ln-2960"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal2</span> <span class="c">!placeholder for calculating SHR</span>
<a name="ln-2961"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal</span>  <span class="c">!placeholder for calculating SHR</span>
<a name="ln-2962"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span> <span class="c">!air mass flow ratio</span>
<a name="ln-2963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatio</span> <span class="c">!water mass flow rate</span>
<a name="ln-2964"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSourceTempCool</span> <span class="c">!rated source temperature, space cooling mode</span>
<a name="ln-2965"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentObjSubfix</span>   <span class="c">! Object subfix type for printing</span>
<a name="ln-2966"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">IsAutosize</span>                   <span class="c">! Indicator to autosize</span>
<a name="ln-2967"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HardSizeNoDesRun</span>             <span class="c">! Indicator to hardsize withouth sizing runs</span>
<a name="ln-2968"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HardSizeNoDesRunAirFlow</span>      <span class="c">! Indicator to hardsize withouth sizing runs for rated air flow field</span>
<a name="ln-2969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateDes</span>       <span class="c">! Autosized rated air flow for reporting</span>
<a name="ln-2970"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateUser</span>      <span class="c">! Hardsized rated air flow for reporting</span>
<a name="ln-2971"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolTotalDes</span>         <span class="c">! Autosized rated total cooling capacity for reporting</span>
<a name="ln-2972"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolTotalUser</span>        <span class="c">! Hardsized rated total cooling capacity for reporting</span>
<a name="ln-2973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapHeatDes</span>              <span class="c">! Autosized rated heating capacity for reporting</span>
<a name="ln-2974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapHeatUser</span>             <span class="c">! Hardsized rated heating capacity for reporting</span>
<a name="ln-2975"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterVolFlowRateDes</span>     <span class="c">! Autosized rated water flow for reporting</span>
<a name="ln-2976"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterVolFlowRateUser</span>    <span class="c">! Hardsized rated water flow for reporting</span>
<a name="ln-2977"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolSensDes</span>          <span class="c">! Autosized rated sensible cooling capacity for reporting</span>
<a name="ln-2978"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolSensUser</span>         <span class="c">! Hardsized rated sensible cooling capacity for reporting</span>
<a name="ln-2979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPowerDes</span>  <span class="c">! Autosized evaporative condenser pump power for reporting</span>
<a name="ln-2980"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPowerUser</span> <span class="c">! Hardsized evaporative condenser pump power for reporting</span>
<a name="ln-2981"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostCapacityDes</span>           <span class="c">! Autosized resistive defrost heater capacity for reporting</span>
<a name="ln-2982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostCapacityUser</span>          <span class="c">! Hardsized resistive defrost heater capacity for reporting</span>
<a name="ln-2983"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisAirSys</span>            <span class="c">! true if a particular air system had a Sizing:System object and system sizing done</span>
<a name="ln-2984"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisZone</span>              <span class="c">! true if a particular zone had a Sizing:Zone object and zone sizing was done</span>
<a name="ln-2985"></a>
<a name="ln-2986"></a>  <span class="n">UpperSpeed</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-2987"></a>  <span class="n">NormSpeed</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span>
<a name="ln-2988"></a>  <span class="n">PltSizNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2989"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2990"></a>  <span class="n">RatedAirFlowAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2991"></a>  <span class="n">RatedWaterFlowAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2992"></a>  <span class="n">RatedCapHeatAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2993"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2994"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SysSizingRunDone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2995"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2996"></a>  <span class="k">ELSE</span>
<a name="ln-2997"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2998"></a>  <span class="n">ENDIF</span>
<a name="ln-2999"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3000"></a><span class="k">    CALL </span><span class="n">CheckThisAirSystemForSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">,</span> <span class="n">SizingDesRunThisAirSys</span> <span class="p">)</span>
<a name="ln-3001"></a>  <span class="k">ELSE</span>
<a name="ln-3002"></a><span class="k">    </span><span class="n">SizingDesRunThisAirSys</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3003"></a>  <span class="n">ENDIF</span>
<a name="ln-3004"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3005"></a><span class="k">    CALL </span><span class="n">CheckThisZoneForSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">,</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span>
<a name="ln-3006"></a>  <span class="k">ELSE</span>
<a name="ln-3007"></a><span class="k">    </span><span class="n">SizingDesRunThisZone</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3008"></a>  <span class="n">ENDIF</span>
<a name="ln-3009"></a>  <span class="n">HardSizeNoDesRunAirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3010"></a>  <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3011"></a>  <span class="n">RatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3012"></a>  <span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3013"></a>  <span class="n">RatedCapCoolTotalUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3014"></a>  <span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3015"></a>  <span class="n">RatedCapHeatUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3016"></a>  <span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3017"></a>  <span class="n">RatedWaterVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3018"></a>  <span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3019"></a>  <span class="n">RatedCapCoolSensUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3020"></a>  <span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3021"></a>  <span class="n">EvapCondPumpElecNomPowerUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3022"></a>  <span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3023"></a>  <span class="n">DefrostCapacityUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3024"></a>
<a name="ln-3025"></a>  <span class="k">IF</span>  <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3026"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3027"></a><span class="k">    </span><span class="n">CurrentObjSubfix</span> <span class="o">=</span> <span class="s1">&#39;:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span>
<a name="ln-3028"></a>  <span class="k">ELSE</span>
<a name="ln-3029"></a><span class="k">   </span><span class="n">CurrentObjSubfix</span> <span class="o">=</span> <span class="s1">&#39;:DX:VARIABLESPEED&#39;</span>
<a name="ln-3030"></a>  <span class="k">END IF</span>
<a name="ln-3031"></a>
<a name="ln-3032"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3033"></a><span class="k">    </span><span class="n">RatedAirFlowAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3034"></a>  <span class="k">END IF</span>
<a name="ln-3035"></a>
<a name="ln-3036"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3037"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedAirFlowAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-3038"></a>      <span class="n">HardSizeNoDesRunAirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3039"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3040"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3041"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3042"></a>                            <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3043"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">)</span>
<a name="ln-3044"></a>      <span class="k">END IF</span>
<a name="ln-3045"></a><span class="k">    ELSE</span>
<a name="ln-3046"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3047"></a>                          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3048"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3049"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3050"></a>      <span class="k">ELSE</span>
<a name="ln-3051"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3052"></a>      <span class="k">END IF</span>
<a name="ln-3053"></a><span class="k">    END IF</span>
<a name="ln-3054"></a><span class="k">  END IF</span>
<a name="ln-3055"></a>
<a name="ln-3056"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3057"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedAirFlowAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-3058"></a>      <span class="n">HardSizeNoDesRunAirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3059"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3060"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3061"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3062"></a>                            <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3063"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">)</span>
<a name="ln-3064"></a>      <span class="k">END IF</span>
<a name="ln-3065"></a><span class="k">    ELSE</span>
<a name="ln-3066"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3067"></a>                          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3068"></a>      <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3069"></a>                               <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-3070"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3071"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3072"></a>      <span class="k">END IF</span>
<a name="ln-3073"></a><span class="k">    END IF</span>
<a name="ln-3074"></a><span class="k">  END IF</span>
<a name="ln-3075"></a>
<a name="ln-3076"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RatedAirFlowAutosized</span><span class="p">)</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span>
<a name="ln-3077"></a><span class="c">!    CALL ReportSizingOutput(&#39;COIL:&#39;//TRIM(VarSpeedCoil(DXCoilNum)%CoolHeatType)//TRIM(CurrentObjSubfix), &amp;</span>
<a name="ln-3078"></a><span class="c">!                             VarSpeedCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-3079"></a><span class="c">!                            &#39;Rated Air Flow Rate [m3/s]&#39;, &amp;</span>
<a name="ln-3080"></a><span class="c">!                             VarSpeedCoil(DXCoilNum)%RatedAirVolFlowRate)</span>
<a name="ln-3081"></a>
<a name="ln-3082"></a>    <span class="c">!RatedAirFlowAutosized = .TRUE.</span>
<a name="ln-3083"></a>
<a name="ln-3084"></a>  <span class="n">RatedCapCoolTotalAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3085"></a>  <span class="n">RatedCapCoolSensAutosized</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3086"></a>
<a name="ln-3087"></a><span class="c">! size rated total cooling capacity</span>
<a name="ln-3088"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3089"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3090"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3091"></a><span class="k">    </span><span class="n">RatedCapCoolTotalAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3092"></a>  <span class="k">END IF</span>
<a name="ln-3093"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SizingDesRunThisZone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3094"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3095"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedCapCoolTotalAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-3096"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3097"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3098"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3099"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3100"></a>                            <span class="s1">&#39;User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3101"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3102"></a>      <span class="k">END IF</span>
<a name="ln-3103"></a><span class="k">    ELSE</span>
<a name="ln-3104"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3105"></a>                          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3106"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-3107"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3108"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-3109"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-3110"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-3111"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-3112"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-3113"></a>        <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-3114"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-3115"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-3116"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-3117"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-3118"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-3119"></a>          <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-3120"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3121"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-3122"></a>            <span class="k">ELSE</span>
<a name="ln-3123"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3124"></a>            <span class="k">END IF</span>
<a name="ln-3125"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-3126"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3127"></a>                        <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-3128"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3129"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-3130"></a>          <span class="k">END IF</span>
<a name="ln-3131"></a><span class="k">        END IF</span>
<a name="ln-3132"></a><span class="k">        </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-3133"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3134"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3135"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3136"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3137"></a>
<a name="ln-3138"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3139"></a>                    <span class="n">MixWetBulb</span><span class="p">,</span><span class="n">RatedInletWaterTemp</span><span class="p">)</span>
<a name="ln-3140"></a><span class="c">!       The mixed air temp for zone equipment without an OA mixer is 0.</span>
<a name="ln-3141"></a><span class="c">!       This test avoids a negative capacity until a solution can be found.</span>
<a name="ln-3142"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MixEnth</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SupEnth</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3143"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-3144"></a>        <span class="k">ELSE</span>
<a name="ln-3145"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4800</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-3146"></a>        <span class="k">END IF</span>
<a name="ln-3147"></a><span class="k">        </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">CoolCapAtPeak</span><span class="p">)</span>
<a name="ln-3148"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3149"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3150"></a>        <span class="k">ELSE</span>
<a name="ln-3151"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-3152"></a>        <span class="k">END IF</span>
<a name="ln-3153"></a><span class="k">      ELSE</span>
<a name="ln-3154"></a><span class="k">        </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3155"></a>      <span class="k">END IF</span>
<a name="ln-3156"></a><span class="k">    END IF</span>
<a name="ln-3157"></a>
<a name="ln-3158"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3159"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedCapCoolTotalAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-3160"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3161"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3162"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3163"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3164"></a>                            <span class="s1">&#39;User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3165"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3166"></a>      <span class="k">END IF</span>
<a name="ln-3167"></a><span class="k">    ELSE</span>
<a name="ln-3168"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3169"></a>                          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3170"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-3171"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3172"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3173"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3174"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-3175"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-3176"></a>          <span class="k">ELSE</span>
<a name="ln-3177"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-3178"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-3179"></a>          <span class="k">END IF</span>
<a name="ln-3180"></a><span class="k">        ELSE</span>
<a name="ln-3181"></a><span class="k">          </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-3182"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-3183"></a>        <span class="k">END IF</span>
<a name="ln-3184"></a><span class="k">        </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-3185"></a>        <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-3186"></a>        <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-3187"></a>        <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-3188"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3189"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-3190"></a>        <span class="k">ELSE</span>
<a name="ln-3191"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3192"></a>        <span class="n">ENDIF</span>
<a name="ln-3193"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3194"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3195"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3196"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3197"></a>
<a name="ln-3198"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3199"></a>                <span class="n">MixWetBulb</span><span class="p">,</span><span class="n">RatedInletWaterTemp</span><span class="p">)</span>
<a name="ln-3200"></a><span class="c">!       The mixed air temp for zone equipment without an OA mixer is 0.</span>
<a name="ln-3201"></a><span class="c">!       This test avoids a negative capacity until a solution can be found.</span>
<a name="ln-3202"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MixEnth</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SupEnth</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3203"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-3204"></a>        <span class="k">ELSE</span>
<a name="ln-3205"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4800</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-3206"></a>        <span class="k">END IF</span>
<a name="ln-3207"></a><span class="k">        </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">CoolCapAtPeak</span><span class="p">)</span>
<a name="ln-3208"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3209"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3210"></a>        <span class="k">ELSE</span>
<a name="ln-3211"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-3212"></a>        <span class="k">END IF</span>
<a name="ln-3213"></a><span class="k">      ELSE</span>
<a name="ln-3214"></a><span class="k">        </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3215"></a>      <span class="k">END IF</span>
<a name="ln-3216"></a><span class="k">    END IF</span>
<a name="ln-3217"></a><span class="k">  END IF</span>
<a name="ln-3218"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RatedCapCoolTotalDes</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3219"></a><span class="k">    </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3220"></a>  <span class="k">END IF</span>
<a name="ln-3221"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3222"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3223"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">=</span> <span class="n">RatedCapCoolTotalDes</span>
<a name="ln-3224"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3225"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3226"></a>                            <span class="s1">&#39;Design Size Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3227"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3228"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3229"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-3230"></a>                                 <span class="o">-</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-3231"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3232"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">&amp;</span>
<a name="ln-3233"></a>                                   <span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3234"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-3235"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">))</span>
<a name="ln-3236"></a>      <span class="k">ELSE</span>
<a name="ln-3237"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3238"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3239"></a>      <span class="n">ENDIF</span>
<a name="ln-3240"></a>      <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstCoolCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-3241"></a>                                          <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-3242"></a>    <span class="k">ELSE</span>
<a name="ln-3243"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapCoolTotalDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3244"></a><span class="k">        </span><span class="n">RatedCapCoolTotalUser</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-3245"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3246"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3247"></a>                            <span class="s1">&#39;Design Size Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3248"></a>                             <span class="n">RatedCapCoolTotalDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3249"></a>                            <span class="s1">&#39;User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3250"></a>                             <span class="n">RatedCapCoolTotalUser</span><span class="p">)</span>
<a name="ln-3251"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3252"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedCapCoolTotalDes</span> <span class="o">-</span> <span class="n">RatedCapCoolTotalUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedCapCoolTotalUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3253"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-3254"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">))</span>
<a name="ln-3255"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Name =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3256"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Total Cooling Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3257"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapCoolTotalUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3258"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Total Cooling Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3259"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapCoolTotalDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3260"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3261"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3262"></a>          <span class="k">END IF</span>
<a name="ln-3263"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3264"></a>      <span class="k">END IF</span>
<a name="ln-3265"></a><span class="k">    END IF</span>
<a name="ln-3266"></a><span class="k">  END IF</span>
<a name="ln-3267"></a>
<a name="ln-3268"></a>  <span class="c">! Set the global DX cooling coil capacity variable for use by other objects</span>
<a name="ln-3269"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3270"></a><span class="k">    </span><span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-3271"></a>  <span class="k">END IF</span>
<a name="ln-3272"></a>
<a name="ln-3273"></a><span class="c">! size rated heating capacity</span>
<a name="ln-3274"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3275"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3276"></a><span class="k">    </span><span class="n">RatedCapHeatAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3277"></a>  <span class="k">END IF</span>
<a name="ln-3278"></a><span class="c">!   simply set heating capacity equal to the cooling capacity</span>
<a name="ln-3279"></a>    <span class="c">!VarSpeedCoil(DXCoilNum)%RatedCapHeat = DXCoolCap</span>
<a name="ln-3280"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3281"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3282"></a><span class="k">      </span><span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-3283"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">=</span> <span class="n">RatedCapHeatDes</span> <span class="c">!AVOID BEING ZERO</span>
<a name="ln-3284"></a>    <span class="k">ELSE</span>
<a name="ln-3285"></a><span class="k">      </span><span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="n">DXCoolCap</span> <span class="c">!previous code, can be risky</span>
<a name="ln-3286"></a>    <span class="k">END IF</span>
<a name="ln-3287"></a>  <span class="c">!END IF</span>
<a name="ln-3288"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RatedCapHeatAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3289"></a><span class="k">      IF</span><span class="p">(</span><span class="n">RatedCapHeatDes</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3290"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3291"></a>                      <span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3292"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3293"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Heating coil could not be autosized since cooling coil was not previously sized.&#39;</span><span class="p">)</span>
<a name="ln-3294"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Cooling coil must be upstream of heating coil.&#39;</span><span class="p">)</span>
<a name="ln-3295"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Manually sizing this heating coil will be required.&#39;</span><span class="p">)</span>
<a name="ln-3296"></a>      <span class="k">END IF</span>
<a name="ln-3297"></a><span class="k">    END IF</span>
<a name="ln-3298"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RatedCapHeatDes</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3299"></a><span class="k">      </span><span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3300"></a>    <span class="k">END IF</span>
<a name="ln-3301"></a><span class="k">  END IF</span>
<a name="ln-3302"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RatedCapHeatAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3303"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">=</span> <span class="n">RatedCapHeatDes</span>
<a name="ln-3304"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3305"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3306"></a>                            <span class="s1">&#39;Design Size Nominal Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3307"></a>                             <span class="n">RatedCapHeatDes</span><span class="p">)</span>
<a name="ln-3308"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-3309"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3310"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-3311"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">))</span>
<a name="ln-3312"></a>    <span class="k">ELSE</span>
<a name="ln-3313"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3314"></a>    <span class="n">ENDIF</span>
<a name="ln-3315"></a>    <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstHeatCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-3316"></a>                                          <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-3317"></a>  <span class="k">ELSE</span>
<a name="ln-3318"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapHeatDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3319"></a><span class="k">      </span><span class="n">RatedCapHeatUser</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-3320"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3321"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3322"></a>                            <span class="s1">&#39;Design Size Nominal Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3323"></a>                             <span class="n">RatedCapHeatDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3324"></a>                            <span class="s1">&#39;User-Specified Nominal Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3325"></a>                             <span class="n">RatedCapHeatUser</span><span class="p">)</span>
<a name="ln-3326"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3327"></a><span class="k">        IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedCapHeatDes</span> <span class="o">-</span> <span class="n">RatedCapHeatUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedCapHeatUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3328"></a><span class="k">          CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-3329"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">))</span>
<a name="ln-3330"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Name =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3331"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Total Heating Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3332"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapHeatUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3333"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Total Heating Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3334"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapHeatDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3335"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3336"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3337"></a>        <span class="k">END IF</span>
<a name="ln-3338"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-3339"></a>    <span class="k">END IF</span>
<a name="ln-3340"></a><span class="k">  END IF</span>
<a name="ln-3341"></a>
<a name="ln-3342"></a>  <span class="c">! FORCE BACK TO THE RATED AIR FLOW RATE WITH THE SAME RATIO DEFINED BY THE CATLOG DATA</span>
<a name="ln-3343"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRunAirFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3344"></a><span class="k">    IF</span><span class="p">((</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3345"></a>        <span class="p">(</span><span class="n">RatedAirFlowAutosized</span><span class="p">))</span>   <span class="k">THEN</span>
<a name="ln-3346"></a><span class="k">      </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-3347"></a>                             <span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3348"></a>    <span class="k">ELSE IF</span><span class="p">((</span><span class="n">RatedCapHeatAutosized</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3349"></a>        <span class="p">(</span><span class="n">RatedAirFlowAutosized</span><span class="p">))</span>   <span class="k">THEN</span>
<a name="ln-3350"></a><span class="k">      </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="p">&amp;</span>
<a name="ln-3351"></a>                               <span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3352"></a>    <span class="k">END IF</span>
<a name="ln-3353"></a>
<a name="ln-3354"></a>    <span class="c">! write the air flow sizing output</span>
<a name="ln-3355"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RatedAirFlowAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3356"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span>
<a name="ln-3357"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3358"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3359"></a>                            <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3360"></a>                             <span class="n">RatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-3361"></a>    <span class="k">ELSE</span>
<a name="ln-3362"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3363"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-3364"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3365"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3366"></a>                            <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3367"></a>                             <span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3368"></a>                            <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3369"></a>                             <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-3370"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3371"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3372"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for&#39;</span> <span class="p">&amp;</span>
<a name="ln-3373"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">))</span>
<a name="ln-3374"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Name =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3375"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3376"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3377"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Air Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3378"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3379"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3380"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3381"></a>          <span class="k">END IF</span>
<a name="ln-3382"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3383"></a>      <span class="k">END IF</span>
<a name="ln-3384"></a><span class="k">    END IF</span>
<a name="ln-3385"></a><span class="k">  END IF</span>
<a name="ln-3386"></a>
<a name="ln-3387"></a>  <span class="c">! Check that heat pump heating capacity is within 20% of cooling capacity. Check only for heating coil and report both.</span>
<a name="ln-3388"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3389"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3390"></a>
<a name="ln-3391"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3392"></a>
<a name="ln-3393"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-3394"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3395"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.2d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3396"></a>
<a name="ln-3397"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3398"></a>                            <span class="s1">&#39;:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3399"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...used with COIL:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3400"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3401"></a>                            <span class="s1">&#39;:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3402"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3403"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...heating capacity is disproportionate (&gt; 20% different) to total cooling capacity&#39;</span><span class="p">)</span>
<a name="ln-3404"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...heating capacity = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3405"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...cooling capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3406"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3407"></a>      <span class="k">END IF</span>
<a name="ln-3408"></a><span class="k">    END IF</span>
<a name="ln-3409"></a><span class="k">  END IF</span>
<a name="ln-3410"></a>
<a name="ln-3411"></a><span class="c">!ASSIGN CAPACITY</span>
<a name="ln-3412"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3413"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">UpperSpeed</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3414"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3415"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3416"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">UpperSpeed</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3417"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3418"></a>  <span class="k">END IF</span>
<a name="ln-3419"></a>
<a name="ln-3420"></a><span class="k">  </span><span class="n">rhoA</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3421"></a>  <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3422"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">UpperSpeed</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3423"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedPercentTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-3424"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3425"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-3426"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3427"></a>                <span class="n">rhoA</span>
<a name="ln-3428"></a>    <span class="c">! EVAPORATIVE PRECOOLING CONDENSER AIR FLOW RATE</span>
<a name="ln-3429"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3430"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedEvapCondVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-3431"></a>  <span class="k">END DO</span>
<a name="ln-3432"></a>
<a name="ln-3433"></a><span class="c">! size rated power</span>
<a name="ln-3434"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOPCool</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-3437"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOPCool</span>
<a name="ln-3438"></a>
<a name="ln-3439"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3440"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOPHeat</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-3441"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOPHeat</span>
<a name="ln-3442"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-3443"></a>  <span class="k">END IF</span>
<a name="ln-3444"></a>
<a name="ln-3445"></a><span class="c">! Size water volumetric flow rate</span>
<a name="ln-3446"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3447"></a>    <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3448"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span> <span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-3449"></a><span class="k">    </span><span class="n">RatedWaterFlowAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3450"></a>  <span class="k">END IF</span>
<a name="ln-3451"></a>
<a name="ln-3452"></a><span class="c">!!   if not found on a plant loop, check condenser loop and warn user if not found</span>
<a name="ln-3453"></a><span class="c">!    IF(PltSizNum == 0) THEN</span>
<a name="ln-3454"></a><span class="c">!</span>
<a name="ln-3455"></a><span class="c">!      PltSizNum = &amp;</span>
<a name="ln-3456"></a><span class="c">!          MyCondPlantSizingIndex(&#39;COIL:&#39;//TRIM(VarSpeedCoil(DXCoilNum)%CoolHeatType)// &amp;</span>
<a name="ln-3457"></a><span class="c">!               TRIM(CurrentObjSubfix), &amp;</span>
<a name="ln-3458"></a><span class="c">!                                 VarSpeedCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-3459"></a><span class="c">!                                 VarSpeedCoil(DXCoilNum)%WaterInletNodeNum, &amp;</span>
<a name="ln-3460"></a><span class="c">!                                 VarSpeedCoil(DXCoilNum)%WaterOutletNodeNum, ErrorsFound)</span>
<a name="ln-3461"></a><span class="c">!    END IF</span>
<a name="ln-3462"></a>
<a name="ln-3463"></a>  <span class="c">!   WSHP condenser can be on either a plant loop or condenser loop. Test each to find plant sizing number.</span>
<a name="ln-3464"></a><span class="c">!   first check to see if coil is connected to a plant loop, no warning on this CALL</span>
<a name="ln-3465"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RatedWaterFlowAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3466"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">WaterCooled</span><span class="p">)</span><span class="n">PltSizNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3467"></a>        <span class="n">MyPlantSizingIndex</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3468"></a>                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3469"></a>                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3470"></a>                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-3471"></a>
<a name="ln-3472"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3473"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3474"></a>                             <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3475"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3476"></a>                             <span class="s1">&#39;SizeHVACWaterToAir&#39;</span><span class="p">)</span>
<a name="ln-3477"></a>      <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3478"></a>                                  <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3479"></a>                                  <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3480"></a>                                 <span class="s1">&#39;SizeHVACWaterToAir&#39;</span><span class="p">)</span>
<a name="ln-3481"></a>
<a name="ln-3482"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3483"></a>
<a name="ln-3484"></a><span class="k">        </span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3485"></a>                                 <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-3486"></a>
<a name="ln-3487"></a>
<a name="ln-3488"></a><span class="c">!        CALL ReportSizingOutput(&#39;COIL:&#39;//TRIM(VarSpeedCoil(DXCoilNum)%CoolHeatType)//&amp;</span>
<a name="ln-3489"></a><span class="c">!                                TRIM(CurrentObjSubfix), &amp;</span>
<a name="ln-3490"></a><span class="c">!                                  VarSpeedCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-3491"></a><span class="c">!                                  &#39;Rated Water Flow Rate [m3/s]&#39;, VarSpeedCoil(DXCoilNum)%RatedWaterVolFlowRate)</span>
<a name="ln-3492"></a>
<a name="ln-3493"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3494"></a>
<a name="ln-3495"></a><span class="c">!       use companion heating coil capacity to calculate volumetric flow rate</span>
<a name="ln-3496"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3497"></a><span class="k">          </span><span class="n">SystemCapacity</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-3498"></a>        <span class="k">ELSE</span>
<a name="ln-3499"></a><span class="k">          </span><span class="n">SystemCapacity</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-3500"></a>        <span class="k">END IF</span>
<a name="ln-3501"></a>
<a name="ln-3502"></a><span class="k">        </span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3503"></a>                                <span class="n">SystemCapacity</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3504"></a>                                <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-3505"></a>
<a name="ln-3506"></a><span class="c">!        CALL ReportSizingOutput(&#39;COIL:&#39;//TRIM(VarSpeedCoil(DXCoilNum)%CoolHeatType)&amp;</span>
<a name="ln-3507"></a><span class="c">!                                //TRIM(CurrentObjSubfix), &amp;</span>
<a name="ln-3508"></a><span class="c">!                                  VarSpeedCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-3509"></a><span class="c">!                                  &#39;Rated Water Flow Rate [m3/s]&#39;, VarSpeedCoil(DXCoilNum)%RatedWaterVolFlowRate)</span>
<a name="ln-3510"></a>      <span class="k">END IF</span>
<a name="ln-3511"></a><span class="k">    ELSE</span>
<a name="ln-3512"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of water flow requires a loop Sizing:Plant object&#39;</span><span class="p">)</span>
<a name="ln-3513"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Autosizing also requires physical connection to a plant or condenser loop.&#39;</span><span class="p">)</span>
<a name="ln-3514"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3515"></a>                 <span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3516"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39; Object=&#39;</span> <span class="p">&amp;</span>
<a name="ln-3517"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3518"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3519"></a>    <span class="k">END IF</span>
<a name="ln-3520"></a><span class="k">  END IF</span>
<a name="ln-3521"></a>
<a name="ln-3522"></a>    <span class="c">!WRITE THE WATER SIZING OUTPUT</span>
<a name="ln-3523"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RatedWaterFlowAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3524"></a>      <span class="c">! FORCE BACK TO THE RATED WATER FLOW RATE WITH THE SAME RATIO DEFINED BY THE CATLOG DATA</span>
<a name="ln-3525"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-3526"></a><span class="k">       </span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-3527"></a>                        <span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3528"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">RatedCapHeatAutosized</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-3529"></a><span class="k">      </span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="p">&amp;</span>
<a name="ln-3530"></a>                        <span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3531"></a>    <span class="k">END IF</span>
<a name="ln-3532"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">=</span> <span class="n">RatedWaterVolFlowRateDes</span>
<a name="ln-3533"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3534"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3535"></a>                              <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3536"></a>                              <span class="s1">&#39;Design Size Rated Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-3537"></a>      <span class="c">! Ensure water flow rate at lower speed must be lower or</span>
<a name="ln-3538"></a>      <span class="c">! equal to the flow rate at higher speed. Otherwise, a severe error is isssued.</span>
<a name="ln-3539"></a>    <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3540"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3541"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3542"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VarSpeedCoilType</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3543"></a>                <span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3544"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3545"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate.&#39;</span><span class="p">)</span>
<a name="ln-3546"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3547"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3548"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-3549"></a>      <span class="k">End If</span>
<a name="ln-3550"></a><span class="k">    End Do</span>
<a name="ln-3551"></a><span class="k">  ELSE</span>
<a name="ln-3552"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedWaterVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3553"></a><span class="k">      </span><span class="n">RatedWaterVolFlowRateUser</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span>
<a name="ln-3554"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3555"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3556"></a>                            <span class="s1">&#39;Design Size Rated Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3557"></a>                             <span class="n">RatedWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3558"></a>                            <span class="s1">&#39;User-Specified Rated Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3559"></a>                             <span class="n">RatedWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-3560"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3561"></a><span class="k">        IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">RatedWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedWaterVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3562"></a><span class="k">          CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for&#39;</span> <span class="p">&amp;</span>
<a name="ln-3563"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">))</span>
<a name="ln-3564"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Name =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3565"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3566"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3567"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3568"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3569"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3570"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3571"></a>        <span class="k">END IF</span>
<a name="ln-3572"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-3573"></a>    <span class="k">END IF</span>
<a name="ln-3574"></a><span class="k">  END IF</span>
<a name="ln-3575"></a>
<a name="ln-3576"></a><span class="c">! Save component design water volumetric flow rate.</span>
<a name="ln-3577"></a><span class="c">! Use 1/2 flow since both cooling and heating coil will save flow yet only 1 will operate at a time</span>
<a name="ln-3578"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3579"></a><span class="k">    CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3580"></a>       <span class="mf">0.5d0</span><span class="o">*</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-3581"></a>  <span class="k">END IF</span>
<a name="ln-3582"></a>
<a name="ln-3583"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3584"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPHeatingEquationFit</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a><span class="k">    </span><span class="n">RatedSourceTempCool</span> <span class="o">=</span> <span class="n">RatedInletWaterTemp</span>
<a name="ln-3587"></a>
<a name="ln-3588"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3589"></a><span class="k">      </span><span class="n">rhoW</span> <span class="o">=</span> <span class="n">rho</span>
<a name="ln-3590"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilVSWAHPCoolingEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3591"></a><span class="k">      </span><span class="n">rhoW</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3592"></a>                                     <span class="n">RatedInletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3593"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3594"></a>                                     <span class="s1">&#39;SizeVarSpeedCoil&#39;</span><span class="p">)</span>
<a name="ln-3595"></a>    <span class="k">ELSE</span>
<a name="ln-3596"></a><span class="k">      </span><span class="n">rhoW</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3597"></a>                                     <span class="n">RatedInletWaterTempHeat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3598"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3599"></a>                                     <span class="s1">&#39;SizeVarSpeedCoil&#39;</span><span class="p">)</span>
<a name="ln-3600"></a>    <span class="k">END IF</span>
<a name="ln-3601"></a>
<a name="ln-3602"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">*</span> <span class="n">rhoW</span>
<a name="ln-3603"></a>    <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3604"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3605"></a>                    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-3606"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3607"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">rhoW</span>
<a name="ln-3608"></a>    <span class="k">END DO</span>
<a name="ln-3609"></a><span class="k">  ELSE</span>
<a name="ln-3610"></a><span class="k">      </span><span class="n">RatedSourceTempCool</span> <span class="o">=</span> <span class="n">RatedAmbAirTemp</span>
<a name="ln-3611"></a>  <span class="k">END IF</span>
<a name="ln-3612"></a>
<a name="ln-3613"></a>    <span class="c">! Ensure air flow rate at lower speed must be lower or</span>
<a name="ln-3614"></a>    <span class="c">! equal to the flow rate at higher speed. Otherwise, a severe error is isssued.</span>
<a name="ln-3615"></a>  <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3616"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3617"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VarSpeedCoilType</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3618"></a>                <span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3619"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3620"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate.&#39;</span><span class="p">)</span>
<a name="ln-3621"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3622"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3623"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-3624"></a>      <span class="k">End If</span>
<a name="ln-3625"></a><span class="k">  End Do</span>
<a name="ln-3626"></a>
<a name="ln-3627"></a>   <span class="c">! Ensure capacity at lower speed must be lower or equal to the capacity at higher speed.</span>
<a name="ln-3628"></a>  <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3629"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3630"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VarSpeedCoilType</span><span class="p">)&amp;</span>
<a name="ln-3631"></a>                <span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3632"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Total Cooling Capacity must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3633"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Total Cooling Capacity.&#39;</span><span class="p">)</span>
<a name="ln-3634"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3635"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3636"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-3637"></a>      <span class="k">End If</span>
<a name="ln-3638"></a><span class="k">  End Do</span>
<a name="ln-3639"></a>
<a name="ln-3640"></a>  <span class="c">!convert SHR to rated Bypass factor and effective air side surface area</span>
<a name="ln-3641"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3642"></a><span class="k">    Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-3643"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3644"></a>        <span class="n">CalcCBF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VarSpeedCoilType</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-3645"></a>                                           <span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),&amp;</span>
<a name="ln-3646"></a>                                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),&amp;</span>
<a name="ln-3647"></a>                                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-3648"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3649"></a><span class="k">            </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEffectiveAo</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">log</span><span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3650"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-3651"></a>        <span class="k">ELSE</span>
<a name="ln-3652"></a><span class="k">            </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEffectiveAo</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3653"></a>        <span class="k">END IF</span>
<a name="ln-3654"></a><span class="k">    End Do</span>
<a name="ln-3655"></a><span class="k">  END IF</span>
<a name="ln-3656"></a>
<a name="ln-3657"></a>  <span class="c">! size rated sensible cooling capacity</span>
<a name="ln-3658"></a>  <span class="n">RatedCapCoolSensAutosized</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">!always do that</span>
<a name="ln-3659"></a>
<a name="ln-3660"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFloW</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3661"></a><span class="k">     </span><span class="n">RatedAirMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3662"></a>           <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3663"></a>     <span class="n">RatedInletEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3664"></a>     <span class="n">CBFRated</span>  <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3665"></a>        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3666"></a>                <span class="n">RatedAirMassFlowRate</span><span class="p">)</span>
<a name="ln-3667"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CBFRated</span> <span class="o">&gt;</span> <span class="mf">0.999d0</span><span class="p">)</span> <span class="n">CBFRated</span> <span class="o">=</span> <span class="mf">0.999d0</span>
<a name="ln-3668"></a>    <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3669"></a>
<a name="ln-3670"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3671"></a><span class="k">      </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-3672"></a>                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedWaterVolFlowRate</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">)</span>
<a name="ln-3673"></a>    <span class="k">ELSE</span>
<a name="ln-3674"></a><span class="k">      </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3675"></a>    <span class="k">END IF</span>
<a name="ln-3676"></a>
<a name="ln-3677"></a><span class="k">    CALL </span><span class="n">CalcTotCapSHR_VSWSHP</span><span class="p">(</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RatedInletEnth</span><span class="p">,</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3678"></a>                     <span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="n">WaterMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3679"></a>                     <span class="n">RatedAirMassFlowRate</span><span class="p">,</span><span class="n">CBFRated</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3680"></a>                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3681"></a>                     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">),</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">NormSpeed</span><span class="p">),&amp;</span>
<a name="ln-3682"></a>                     <span class="mf">0.0d0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,&amp;</span>
<a name="ln-3683"></a>                     <span class="n">QLoadTotal1</span><span class="p">,</span> <span class="n">QLoadTotal2</span><span class="p">,</span> <span class="n">QLoadTotal</span><span class="p">,</span><span class="n">SHR</span><span class="p">,</span><span class="n">RatedSourceTempCool</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3684"></a>                     <span class="n">StdBaroPress</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3685"></a>
<a name="ln-3686"></a>    <span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">*</span> <span class="n">SHR</span>
<a name="ln-3687"></a>  <span class="k">ELSE</span>
<a name="ln-3688"></a><span class="k">    </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3689"></a>  <span class="k">END IF</span>
<a name="ln-3690"></a>
<a name="ln-3691"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RatedCapCoolSensDes</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3692"></a><span class="k">    </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3693"></a>  <span class="k">END IF</span>
<a name="ln-3694"></a>
<a name="ln-3695"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!always report for cooling mode</span>
<a name="ln-3696"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3697"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">=</span> <span class="n">RatedCapCoolSensDes</span>
<a name="ln-3698"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3699"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3700"></a>                            <span class="s1">&#39;Design Size Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3701"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-3702"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilSensCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolSens)</span>
<a name="ln-3703"></a>      <span class="c">!CALL PreDefTableEntry(pdchCoolCoilLatCap,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal &amp;</span>
<a name="ln-3704"></a>      <span class="c">!                           - VarSpeedCoil(DXCoilNum)%RatedCapCoolSens)</span>
<a name="ln-3705"></a>      <span class="c">!IF (VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal /= 0.0d0) THEN</span>
<a name="ln-3706"></a>      <span class="c">!  CALL PreDefTableEntry(pdchCoolCoilSHR,VarSpeedCoil(DXCoilNum)%Name,VarSpeedCoil(DXCoilNum)%RatedCapCoolSens &amp;</span>
<a name="ln-3707"></a>      <span class="c">!                           / VarSpeedCoil(DXCoilNum)%RatedCapCoolTotal)</span>
<a name="ln-3708"></a>      <span class="c">!ELSE</span>
<a name="ln-3709"></a>      <span class="c">!  CALL PreDefTableEntry(pdchCoolCoilSHR,VarSpeedCoil(DXCoilNum)%Name,0.0d0)</span>
<a name="ln-3710"></a>      <span class="c">!ENDIF</span>
<a name="ln-3711"></a>    <span class="k">ELSE</span>
<a name="ln-3712"></a>      <span class="c">! sensible capacity does not have an input field</span>
<a name="ln-3713"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RatedCapCoolSensDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapCoolSensDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3714"></a><span class="k">        </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">=</span> <span class="n">RatedCapCoolSensDes</span>
<a name="ln-3715"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">),&amp;</span>
<a name="ln-3716"></a>                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3717"></a>                            <span class="s1">&#39;Design Size Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3718"></a>                             <span class="n">RatedCapCoolSensDes</span><span class="p">)</span> <span class="c">!, &amp;</span>
<a name="ln-3719"></a><span class="c">!                            &#39;User-Specified Rated Sensible Cooling Capacity [W]&#39;, &amp;</span>
<a name="ln-3720"></a><span class="c">!                             RatedCapCoolSensUser)</span>
<a name="ln-3721"></a><span class="c">!       IF (DisplayExtraWarnings) THEN</span>
<a name="ln-3722"></a>  <span class="c">!       IF ((ABS(RatedCapCoolSensDes - RatedCapCoolSensUser)/RatedCapCoolSensUser) &gt; AutoVsHardSizingThreshold) THEN</span>
<a name="ln-3723"></a>  <span class="c">!          CALL ShowMessage(&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for:&#39; &amp;</span>
<a name="ln-3724"></a>  <span class="c">!                      //TRIM(VarSpeedCoil(DXCoilNum)%CoolHeatType)//&#39; &#39;//TRIM(CurrentObjSubfix))</span>
<a name="ln-3725"></a>  <span class="c">!          CALL ShowContinueError(&#39;Coil Name =&#39;//TRIM(VarSpeedCoil(DXCoilNum)%Name))</span>
<a name="ln-3726"></a>  <span class="c">!          CALL ShowContinueError(&#39;User-Specified Rated Sensible Cooling Capacity of &#39;// &amp;</span>
<a name="ln-3727"></a>  <span class="c">!                                    TRIM(RoundSigDigits(RatedCapCoolSensUser,2))// &#39; [W]&#39;)</span>
<a name="ln-3728"></a>  <span class="c">!          CALL ShowContinueError(&#39;differs from Design Size Rated Sensible Cooling Capacity of &#39; // &amp;</span>
<a name="ln-3729"></a>  <span class="c">!                                    TRIM(RoundSigDigits(RatedCapCoolSensDes,2))// &#39; [W]&#39;)</span>
<a name="ln-3730"></a>  <span class="c">!          CALL ShowContinueError(&#39;This may, or may not, indicate mismatched component sizes.&#39;)</span>
<a name="ln-3731"></a>  <span class="c">!          CALL ShowContinueError(&#39;Verify that the value entered is intended and is consistent with other components.&#39;)</span>
<a name="ln-3732"></a>  <span class="c">!        END IF</span>
<a name="ln-3733"></a><span class="c">!        ENDIF</span>
<a name="ln-3734"></a>      <span class="k">END IF</span>
<a name="ln-3735"></a><span class="k">    END IF</span>
<a name="ln-3736"></a><span class="k">    CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3737"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-3738"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-3739"></a>                                <span class="o">-</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-3740"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3741"></a><span class="k">       CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">&amp;</span>
<a name="ln-3742"></a>                                <span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3743"></a>    <span class="k">ELSE</span>
<a name="ln-3744"></a><span class="k">       CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3745"></a>    <span class="n">ENDIF</span>
<a name="ln-3746"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-3747"></a>                          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">))</span>
<a name="ln-3748"></a>    <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstCoolCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-3749"></a>                                            <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-3750"></a>  <span class="k">END IF</span>
<a name="ln-3751"></a>
<a name="ln-3752"></a> <span class="c">! START SIZING EVAP PRECOOLING PUMP POWER</span>
<a name="ln-3753"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3754"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-3755"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3756"></a><span class="k">      </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3757"></a>    <span class="k">END IF</span>
<a name="ln-3758"></a>   <span class="c">!     Auto size high speed evap condenser pump power to Total Capacity * 0.004266 w/w (15 w/ton)</span>
<a name="ln-3759"></a>    <span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">*</span><span class="mf">0.004266d0</span>
<a name="ln-3760"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3761"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">=</span> <span class="n">EvapCondPumpElecNomPowerDes</span>
<a name="ln-3762"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s2">&quot;AS VS COOLING COIL&quot;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3763"></a>                            <span class="s1">&#39;Design Size Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3764"></a>                             <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">)</span>
<a name="ln-3765"></a>    <span class="k">ELSE</span>
<a name="ln-3766"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3767"></a><span class="k">        </span><span class="n">EvapCondPumpElecNomPowerUser</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span>
<a name="ln-3768"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s2">&quot;AS VS COOLING COIL&quot;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3769"></a>                            <span class="s1">&#39;Design Size Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3770"></a>                             <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3771"></a>                            <span class="s1">&#39;User-Specified Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3772"></a>                             <span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span>
<a name="ln-3773"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3774"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">-</span> <span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span><span class="o">/</span><span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3775"></a>                      <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3776"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-3777"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">))</span>
<a name="ln-3778"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Name =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3779"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Evaporative Condenser Pump Rated Power Consumption of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3780"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3781"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Evaporative Condenser Pump Rated Power Consumption of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3782"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3783"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3784"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3785"></a>          <span class="k">END IF</span>
<a name="ln-3786"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3787"></a>      <span class="k">END IF</span>
<a name="ln-3788"></a><span class="k">    END IF</span>
<a name="ln-3789"></a><span class="k">  END IF</span>
<a name="ln-3790"></a>   <span class="c">! END SIZING EVAP PRE-COOLING PUMP POWER</span>
<a name="ln-3791"></a>
<a name="ln-3792"></a>   <span class="c">!SIZE DEFROST HEATER</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>    <span class="c">! Resistive Defrost Heater Capacity = capacity at the first stage</span>
<a name="ln-3795"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3796"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-3797"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3798"></a><span class="k">      </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3799"></a>    <span class="k">END IF</span>
<a name="ln-3800"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">==</span> <span class="n">Resistive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3801"></a><span class="k">      </span><span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-3802"></a>    <span class="k">ELSE</span>
<a name="ln-3803"></a><span class="k">      </span><span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3804"></a>    <span class="k">END IF</span>
<a name="ln-3805"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3806"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="n">DefrostCapacityDes</span>
<a name="ln-3807"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s2">&quot;AS VS HEATING COIL&quot;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3808"></a>                              <span class="s1">&#39;Design Size Resistive Defrost Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityDes</span><span class="p">)</span>
<a name="ln-3809"></a>    <span class="k">ELSE</span>
<a name="ln-3810"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DefrostCapacityDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-3811"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3812"></a><span class="k">        </span><span class="n">DefrostCapacityUser</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span>
<a name="ln-3813"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s2">&quot;AS VS HEATING COIL&quot;</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3814"></a>                              <span class="s1">&#39;Design Size Resistive Defrost Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3815"></a>                              <span class="s1">&#39;User-Specified Resistive Defrost Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityUser</span><span class="p">)</span>
<a name="ln-3816"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3817"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DefrostCapacityDes</span> <span class="o">-</span> <span class="n">DefrostCapacityUser</span><span class="p">)</span><span class="o">/</span><span class="n">DefrostCapacityUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3818"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeVarSpeedCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-3819"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentObjSubfix</span><span class="p">))</span>
<a name="ln-3820"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Name =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3821"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Resistive Defrost Heater Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3822"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DefrostCapacityUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3823"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Resistive Defrost Heater Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3824"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DefrostCapacityDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3825"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3826"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3827"></a>          <span class="k">END IF</span>
<a name="ln-3828"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3829"></a>      <span class="k">END IF</span>
<a name="ln-3830"></a><span class="k">    END IF</span>
<a name="ln-3831"></a><span class="k">  END IF</span>
<a name="ln-3832"></a>   <span class="c">!END SIZING DEFROST HEATER</span>
<a name="ln-3833"></a>
<a name="ln-3834"></a><span class="c">! test autosized sensible and total cooling capacity for total &gt; sensible</span>
<a name="ln-3835"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RatedCapCoolSensAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapCoolTotalAutosized</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3836"></a>     <span class="n">RatedCapCoolSensAutosized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3837"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3838"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3839"></a>                <span class="s1">&#39;:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3840"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3841"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Rated Sensible Cooling Capacity &gt; Rated Total Cooling Capacity&#39;</span><span class="p">)</span>
<a name="ln-3842"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Each of these capacity inputs have been autosized.&#39;</span><span class="p">)</span>
<a name="ln-3843"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Sensible Cooling Capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3844"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3845"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Total Cooling Capacity    = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3846"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3847"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;See eio file for further details.&#39;</span><span class="p">)</span>
<a name="ln-3848"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Total and Sensible Cooling Capacity Coefficients to ensure they are accurate.&#39;</span><span class="p">)</span>
<a name="ln-3849"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Zone and System Sizing objects to verify sizing inputs.&#39;</span><span class="p">)</span>
<a name="ln-3850"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sizing statistics:&#39;</span><span class="p">)</span>
<a name="ln-3851"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Air Dry-Bulb Temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3852"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Air Wet-Bulb Temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3853"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Condenser Water Temperature used = 24.4444 C&#39;</span><span class="p">)</span>
<a name="ln-3854"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Used design air and water flow rates (i.e., used 1 for ratioVL and ratioVS)&#39;</span><span class="p">)</span>
<a name="ln-3855"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTDB = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="n">MixTemp</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3856"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTWB = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3857"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTS  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3858"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Sensible Cooling Capacity = Rated Total Cooling Capacity * Sensible Heat Ratio&#39;</span><span class="p">)</span>
<a name="ln-3859"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Total Cooling Capacity Modifier = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotCapTempModFac</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3860"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity = Total Design Load / Total Cooling Capacity Modifier&#39;</span><span class="p">)</span>
<a name="ln-3861"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Carefully review the Load Side Total, Sensible, and Latent heat transfer rates&#39;</span><span class="p">)</span>
<a name="ln-3862"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... to ensure they meet the expected manufacturers performance specifications.&#39;</span><span class="p">)</span>
<a name="ln-3863"></a>    <span class="k">END IF</span>
<a name="ln-3864"></a><span class="k">  ELSE If</span><span class="p">(</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3865"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3866"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolHeatType</span><span class="p">)&amp;</span>
<a name="ln-3867"></a>                        <span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3868"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3869"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Rated Sensible Cooling Capacity &gt; Rated Total Cooling Capacity&#39;</span><span class="p">)</span>
<a name="ln-3870"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Only the rated total capacity input is autosized, consider autosizing both inputs.&#39;</span><span class="p">)</span>
<a name="ln-3871"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Sensible Cooling Capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3872"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3873"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Total Cooling Capacity    = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3874"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3875"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;See eio file for further details.&#39;</span><span class="p">)</span>
<a name="ln-3876"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Total and Sensible Cooling Capacity Coefficients to ensure they are accurate.&#39;</span><span class="p">)</span>
<a name="ln-3877"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Zone and System Sizing objects to verify sizing inputs.&#39;</span><span class="p">)</span>
<a name="ln-3878"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sizing statistics for Total Cooling Capacity:&#39;</span><span class="p">)</span>
<a name="ln-3879"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Air Wet-Bulb Temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3880"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Condenser Water Temperature used = 24.4444 C&#39;</span><span class="p">)</span>
<a name="ln-3881"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Used design air and water flow rates (i.e., used 1 for ratioVL and ratioVS)&#39;</span><span class="p">)</span>
<a name="ln-3882"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTWB = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3883"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTS  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3884"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Sensible Cooling Capacity = Rated Total Cooling Capacity * Sensible Heat Ratio&#39;</span><span class="p">)</span>
<a name="ln-3885"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Carefully review the Load Side Total, Sensible, and Latent heat transfer rates&#39;</span><span class="p">)</span>
<a name="ln-3886"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... to ensure they meet the expected manufacturers performance specifications.&#39;</span><span class="p">)</span>
<a name="ln-3887"></a>    <span class="k">END IF</span>
<a name="ln-3888"></a><span class="k">  END IF</span>
<a name="ln-3889"></a>
<a name="ln-3890"></a><span class="k">  RETURN</span>
<a name="ln-3891"></a>
<a name="ln-3892"></a><span class="k">END SUBROUTINE </span><span class="n">SizeVarSpeedCoil</span>
<a name="ln-3893"></a>
<a name="ln-3894"></a>
<a name="ln-3895"></a><span class="k">SUBROUTINE  </span><span class="n">CalcVarSpeedCoilCooling</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3896"></a>            <span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">SensDemand</span><span class="p">,</span><span class="n">LatentDemand</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3897"></a>            <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a>
<a name="ln-3900"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:CalcHPCoolingSimple</span>
<a name="ln-3901"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-3902"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3903"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3904"></a>
<a name="ln-3905"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3906"></a>          <span class="c">! This subroutine is for simulating the cooling mode of the Variable-Speed Water to Air HP Simple</span>
<a name="ln-3907"></a>
<a name="ln-3908"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3909"></a>          <span class="c">! Simulate the heat pump performance using the coefficients and rated conditions, interpolating between speed levels</span>
<a name="ln-3910"></a>          <span class="c">!</span>
<a name="ln-3911"></a>          <span class="c">! If the LatDegradModelSimFlag is enabled, the coil will be simulated twice:</span>
<a name="ln-3912"></a>          <span class="c">! (1)first simulation at the rated conditions (2) second simulation at the</span>
<a name="ln-3913"></a>          <span class="c">! actual operating conditions. Then call CalcEffectiveSHR and the effective SHR</span>
<a name="ln-3914"></a>          <span class="c">! is adjusted.</span>
<a name="ln-3915"></a>          <span class="c">!</span>
<a name="ln-3916"></a>          <span class="c">! If the LatDegradModelSimFlag is disabled, the cooling coil is only simulated</span>
<a name="ln-3917"></a>          <span class="c">! once at the actual operating conditions.</span>
<a name="ln-3918"></a>          <span class="c">!</span>
<a name="ln-3919"></a>          <span class="c">! Finally, adjust the heat pump outlet conditions based on the PartLoadRatio</span>
<a name="ln-3920"></a>          <span class="c">! and RuntimeFrac.</span>
<a name="ln-3921"></a>
<a name="ln-3922"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3923"></a>          <span class="c">! n/a</span>
<a name="ln-3924"></a>
<a name="ln-3925"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3926"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-3927"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">DXElecCoolingPower</span>
<a name="ln-3928"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">,</span><span class="n">PsyCpAirFnWTdb</span><span class="p">,</span><span class="n">PsyHFnTdbW</span><span class="p">,</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3929"></a>                                  <span class="n">PsyTwbFnTdbWPb</span><span class="p">,</span><span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyWFnTdbH</span>
<a name="ln-3930"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3931"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-3932"></a>  <span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-3933"></a>
<a name="ln-3934"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3935"></a>
<a name="ln-3936"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3937"></a>
<a name="ln-3938"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>              <span class="c">! Heat Pump Number</span>
<a name="ln-3939"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>      <span class="c">! Fan/Compressor cycling scheme indicator</span>
<a name="ln-3940"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensDemand</span>         <span class="c">! Cooling Sensible Demand [W] !unused1208</span>
<a name="ln-3941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentDemand</span>       <span class="c">! Cooling Latent Demand [W]</span>
<a name="ln-3942"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation flag</span>
<a name="ln-3943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! compressor part load ratio</span>
<a name="ln-3944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>     <span class="c">! Runtime Fraction of compressor or percent on time (on-time/cycle time)</span>
<a name="ln-3945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor on flow to average flow over time step</span>
<a name="ln-3946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>         <span class="c">! SpeedRatio varies between 1.0 (higher speed) and 0.0 (lower speed)</span>
<a name="ln-3947"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpeedNum</span>            <span class="c">! Speed number, high bound</span>
<a name="ln-3948"></a>
<a name="ln-3949"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3950"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Tref</span><span class="o">=</span><span class="mi">28</span><span class="mf">3.15d0</span>      <span class="c">! Reference Temperature for performance curves,10C [K]</span>
<a name="ln-3951"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcMultiSpeedVarSpeedCoilCooling&#39;</span>
<a name="ln-3952"></a>
<a name="ln-3953"></a>
<a name="ln-3954"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3955"></a>          <span class="c">! na</span>
<a name="ln-3956"></a>
<a name="ln-3957"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3958"></a>          <span class="c">! na</span>
<a name="ln-3959"></a>
<a name="ln-3960"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3961"></a>
<a name="ln-3962"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_rated</span>             <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-3963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_rated</span>            <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-3964"></a>
<a name="ln-3965"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRss</span>                  <span class="c">! Sensible heat ratio at steady state</span>
<a name="ln-3966"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHReff</span>                 <span class="c">! Effective sensible heat ratio at part-load condition</span>
<a name="ln-3967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpSource</span>                <span class="c">! Specific heat of water [J/kg_C]</span>
<a name="ln-3968"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>                  <span class="c">! Specific heat of air [J/kg_C]</span>
<a name="ln-3969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-3970"></a>
<a name="ln-3971"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LatDegradModelSimFlag</span>  <span class="c">! Latent degradation model simulation flag</span>
<a name="ln-3972"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumIteration</span>           <span class="c">! Iteration Counter</span>
<a name="ln-3973"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>          <span class="c">! No idea what this is for.</span>
<a name="ln-3974"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3975"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletDBTemp_Init</span> <span class="c">! rated conditions</span>
<a name="ln-3976"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletWBTemp_Init</span> <span class="c">! rated conditions</span>
<a name="ln-3977"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletHumRat_Init</span> <span class="c">! rated conditions</span>
<a name="ln-3978"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletEnth_Init</span> <span class="c">! rated conditions</span>
<a name="ln-3979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">CpAir_Init</span>                <span class="c">! rated conditions</span>
<a name="ln-3980"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletDBTemp_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-3981"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletWBTemp_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-3982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletHumRat_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-3983"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletEnth_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-3984"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CpAir_Unit</span>                <span class="c">! calc conditions for unit</span>
<a name="ln-3985"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>   <span class="c">! airflow ratio at low speed</span>
<a name="ln-3986"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatio</span>   <span class="c">! airflow ratio at high speed</span>
<a name="ln-3987"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapAirFFModFac</span> <span class="c">!air flow fraction modification</span>
<a name="ln-3988"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapWaterFFModFac</span> <span class="c">!water flow fraction modification</span>
<a name="ln-3989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-3990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRAirFFModFac</span> <span class="c">!air flow fraction modification</span>
<a name="ln-3991"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRWaterFFModFac</span> <span class="c">!water flow fraction modification</span>
<a name="ln-3992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-3993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFSpeed</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-3994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-3995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-3996"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxSpeed</span>           <span class="c">! maximum speed level</span>
<a name="ln-3997"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedCal</span>           <span class="c">! calculated speed level</span>
<a name="ln-3998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AoEff</span> <span class="c">!effective air side surface area</span>
<a name="ln-3999"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal1</span> <span class="c">!total capacity at low speed</span>
<a name="ln-4000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal2</span> <span class="c">!total capacity at high speed</span>
<a name="ln-4001"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Winput1</span> <span class="c">!power consumption at low speed</span>
<a name="ln-4002"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Winput2</span> <span class="c">!power consumption at high speed</span>
<a name="ln-4003"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat</span> <span class="c">!recoverable waste heat</span>
<a name="ln-4004"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat1</span> <span class="c">!recoverable waste heat at low speed</span>
<a name="ln-4005"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat2</span> <span class="c">!recoverable waste heat at high speed</span>
<a name="ln-4006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>  <span class="c">!part-load function</span>
<a name="ln-4007"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxHumRat</span>  <span class="c">!max possible humidity</span>
<a name="ln-4008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxOutletEnth</span> <span class="c">!max possible outlet enthalpy</span>
<a name="ln-4009"></a>
<a name="ln-4010"></a>  <span class="c">! ADDED VARIABLES FOR air source coil</span>
<a name="ln-4011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorCoilT</span>  <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Outdoor coil temperature (C)</span>
<a name="ln-4012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorCoildw</span>  <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Outdoor coil delta w assuming coil temp of OutdoorCoilT (kg/kg)</span>
<a name="ln-4013"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>   <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-4014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>   <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-4015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-4016"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorPressure</span>   <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-4017"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! power due to crankcase heater</span>
<a name="ln-4018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompAmbTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Ambient temperature at compressor</span>
<a name="ln-4019"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-4020"></a>                                 <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-4021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>       <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-4022"></a>                                 <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-4023"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>       <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-4024"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoSourceAir</span>         <span class="c">! Density of air [kg/m3]</span>
<a name="ln-4025"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoEvapCondWater</span>         <span class="c">! Density of water used for evaporative condenser [kg/m3]</span>
<a name="ln-4026"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondEffectSped</span>      <span class="c">! condenser evaporative effectiveness at the speed level</span>
<a name="ln-4027"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoWater</span>             <span class="c">! condensed water density</span>
<a name="ln-4028"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecHumIn</span>   <span class="c">!inlet air specific humidity</span>
<a name="ln-4029"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecHumOut</span>   <span class="c">!outlet air specific humidity</span>
<a name="ln-4030"></a>
<a name="ln-4031"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4032"></a>    <span class="c">!Set indoor air conditions to the rated condition</span>
<a name="ln-4033"></a>    <span class="n">LoadSideInletDBTemp_Init</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.7d0</span>
<a name="ln-4034"></a>    <span class="n">LoadSideInletHumRat_Init</span> <span class="o">=</span> <span class="mf">0.0111d0</span>
<a name="ln-4035"></a>    <span class="n">LoadSideInletEnth_Init</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">,</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:Init&#39;</span><span class="p">)</span>
<a name="ln-4036"></a>    <span class="n">CpAir_Init</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">,</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:Init&#39;</span><span class="p">)</span>
<a name="ln-4037"></a>    <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4038"></a>  <span class="n">ENDIF</span>
<a name="ln-4039"></a>  <span class="n">LoadSideInletWBTemp_Init</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4040"></a>
<a name="ln-4041"></a>  <span class="n">MaxSpeed</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumofSpeeds</span>
<a name="ln-4042"></a>
<a name="ln-4043"></a> <span class="c">! must be placed inside the loop, otherwise cause bug in release mode, need to be present at two places</span>
<a name="ln-4044"></a> <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4045"></a><span class="k">   </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">MaxSpeed</span>
<a name="ln-4046"></a> <span class="k">ELSE</span>
<a name="ln-4047"></a><span class="k">    </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-4048"></a> <span class="k">END IF</span>
<a name="ln-4049"></a>
<a name="ln-4050"></a>
<a name="ln-4051"></a> <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-4052"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4053"></a><span class="k">     </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span>
<a name="ln-4054"></a>  <span class="k">END IF</span>
<a name="ln-4055"></a>
<a name="ln-4056"></a><span class="k">  </span><span class="n">Twet_rated</span>             <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_rated</span>
<a name="ln-4057"></a>  <span class="n">Gamma_rated</span>            <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_rated</span>
<a name="ln-4058"></a>
<a name="ln-4059"></a>  <span class="n">LoadSideMassFlowRate</span>   <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>
<a name="ln-4060"></a>
<a name="ln-4061"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4062"></a>  <span class="c">! Get condenser outdoor node info from DX COOLING Coil</span>
<a name="ln-4063"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4064"></a><span class="k">        </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4065"></a>        <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4066"></a>        <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-4067"></a>        <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">OutAirWetBulb</span>
<a name="ln-4068"></a>      <span class="k">ELSE</span>
<a name="ln-4069"></a><span class="k">        </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-4070"></a>        <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-4071"></a>        <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-4072"></a>        <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-4073"></a>      <span class="n">ENDIF</span>
<a name="ln-4074"></a>
<a name="ln-4075"></a>     <span class="n">RhoSourceAir</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">)</span>
<a name="ln-4076"></a>
<a name="ln-4077"></a>     <span class="k">IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4078"></a><span class="k">         </span><span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoSourceAir</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4079"></a>     <span class="k">ELSE</span>
<a name="ln-4080"></a><span class="k">         </span><span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoSourceAir</span> <span class="o">*</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-4081"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-4082"></a>     <span class="n">ENDIF</span>
<a name="ln-4083"></a>
<a name="ln-4084"></a>     <span class="c">! AIR COOL OR EVAP COOLED CONDENSER</span>
<a name="ln-4085"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4086"></a><span class="k">      IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4087"></a><span class="k">         </span><span class="n">EvapCondEffectSped</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4088"></a>      <span class="k">ELSE</span>
<a name="ln-4089"></a><span class="k">         </span><span class="n">EvapCondEffectSped</span> <span class="o">=</span>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-4090"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4091"></a>      <span class="n">ENDIF</span>
<a name="ln-4092"></a>     <span class="c">! (Outdoor wet-bulb temp from DataEnvironment) + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-4093"></a>      <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">EvapCondEffectSped</span><span class="p">)</span>
<a name="ln-4094"></a>      <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-4095"></a>      <span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-4096"></a>     <span class="k">ELSE</span> <span class="c">!AIR COOLED CONDENSER</span>
<a name="ln-4097"></a>      <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorDryBulb</span> <span class="c">! Outdoor dry-bulb temp</span>
<a name="ln-4098"></a>      <span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-4099"></a>      <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-4100"></a>     <span class="k">END IF</span>
<a name="ln-4101"></a>
<a name="ln-4102"></a><span class="k">     </span><span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="n">CondAirMassFlow</span>
<a name="ln-4103"></a>     <span class="n">SourceSideInletTemp</span>    <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-4104"></a>     <span class="n">SourceSideInletEnth</span>    <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">CondInletHumrat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4105"></a>     <span class="n">CpSource</span>               <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">CondInletHumrat</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4106"></a>     <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-4107"></a>
<a name="ln-4108"></a>    <span class="c">! If used in a heat pump, the value of MaxOAT in the heating coil overrides that in the cooling coil (in GetInput)</span>
<a name="ln-4109"></a>     <span class="c">! Initialize crankcase heater, operates below OAT defined in input deck for HP DX heating coil</span>
<a name="ln-4110"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4111"></a><span class="k">       </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-4112"></a>     <span class="k">ELSE</span>
<a name="ln-4113"></a><span class="k">       </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4114"></a>     <span class="k">END IF</span>
<a name="ln-4115"></a><span class="k">  ELSE</span>
<a name="ln-4116"></a><span class="k">      </span><span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-4117"></a>      <span class="n">SourceSideInletTemp</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-4118"></a>      <span class="n">SourceSideInletEnth</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-4119"></a>      <span class="n">CpSource</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4120"></a>                                       <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4121"></a>                                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4122"></a>                                      <span class="s1">&#39;CalcVSHPCoolingSimple:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-4123"></a>  <span class="k">END IF</span>
<a name="ln-4124"></a>
<a name="ln-4125"></a>   <span class="c">!Check for flows, do not perform simulation if no flow in load side or source side.</span>
<a name="ln-4126"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LoadSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4127"></a><span class="k">    </span>
<a name="ln-4128"></a><span class="k">     IF</span><span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span>  <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4129"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4130"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4131"></a>        <span class="c">!ALLOW SIMULATION IF AIR-COOLED CONDENSER COIL</span>
<a name="ln-4132"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4133"></a>     <span class="k">ELSE         </span>
<a name="ln-4134"></a><span class="k">        </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4135"></a>        <span class="k">RETURN</span>
<a name="ln-4136"></a><span class="k">     END IF</span>
<a name="ln-4137"></a><span class="k">  ELSE</span>
<a name="ln-4138"></a><span class="k">     </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4139"></a>  <span class="n">ENDIF</span>
<a name="ln-4140"></a>
<a name="ln-4141"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4142"></a><span class="k">     </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4143"></a>     <span class="k">RETURN</span>
<a name="ln-4144"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-4145"></a>
<a name="ln-4146"></a>  <span class="c">!Loop the calculation at least once depending whether the latent degradation model</span>
<a name="ln-4147"></a>  <span class="c">!is enabled. 1st iteration to calculate the QLatent(rated) at (TDB,TWB)indoorair=(26.7C,19.4C)</span>
<a name="ln-4148"></a>  <span class="c">!and 2nd iteration to calculate the  QLatent(actual)</span>
<a name="ln-4149"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">PartLoadRatio</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Twet_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Gamma_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4150"></a>     <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4151"></a><span class="k">    </span><span class="n">LatDegradModelSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4152"></a>    <span class="c">!Set NumIteration=1 so that latent model would quit after 1 simulation with the actual condition</span>
<a name="ln-4153"></a>    <span class="n">NumIteration</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4154"></a>  <span class="k">ELSE</span>
<a name="ln-4155"></a><span class="k">    </span><span class="n">LatDegradModelSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4156"></a>    <span class="c">!Set NumIteration=0 so that latent model would simulate twice with rated and actual condition</span>
<a name="ln-4157"></a>    <span class="n">NumIteration</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4158"></a>  <span class="k">END IF</span>
<a name="ln-4159"></a>
<a name="ln-4160"></a>
<a name="ln-4161"></a>  <span class="c">!Set indoor air conditions to the actual condition</span>
<a name="ln-4162"></a>  <span class="n">LoadSideInletDBTemp_Unit</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-4163"></a>  <span class="n">LoadSideInletHumRat_Unit</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-4164"></a>  <span class="n">LoadSideInletWBTemp_Unit</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Unit</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Unit</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4165"></a>  <span class="n">LoadSideInletEnth_Unit</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-4166"></a>  <span class="n">CpAir_Unit</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat_Unit</span><span class="p">,</span><span class="n">LoadSideInletDBTemp_Unit</span><span class="p">)</span>
<a name="ln-4167"></a>
<a name="ln-4168"></a>  <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4169"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4170"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4171"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-4172"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4173"></a><span class="k">     </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-4174"></a>    <span class="k">END IF</span>
<a name="ln-4175"></a>    <span class="c">! calculate the run time fraction</span>
<a name="ln-4176"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-4177"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>    <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-4178"></a>
<a name="ln-4179"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4180"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-4181"></a>    <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4182"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4183"></a>    <span class="k">END IF</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a><span class="k">    </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span>
<a name="ln-4186"></a>  <span class="k">END IF</span>
<a name="ln-4187"></a>
<a name="ln-4188"></a>
<a name="ln-4189"></a><span class="n">LOOP</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-4190"></a><span class="k">    </span><span class="n">NumIteration</span><span class="o">=</span><span class="n">NumIteration</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4191"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4192"></a>    <span class="c">!Set indoor air conditions to the rated conditions</span>
<a name="ln-4193"></a>        <span class="n">LoadSideInletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp_Init</span>
<a name="ln-4194"></a>        <span class="n">LoadSideInletHumRat</span> <span class="o">=</span> <span class="n">LoadSideInletHumRat_Init</span>
<a name="ln-4195"></a>        <span class="n">LoadSideInletWBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletWBTemp_Init</span>
<a name="ln-4196"></a>        <span class="n">LoadSideInletEnth</span> <span class="o">=</span> <span class="n">LoadSideInletEnth_Init</span>
<a name="ln-4197"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="n">CpAir_Init</span>
<a name="ln-4198"></a>    <span class="k">ELSE</span>
<a name="ln-4199"></a>    <span class="c">!Set indoor air conditions to the actual condition</span>
<a name="ln-4200"></a>        <span class="n">LoadSideInletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp_Unit</span>
<a name="ln-4201"></a>        <span class="n">LoadSideInletHumRat</span> <span class="o">=</span> <span class="n">LoadSideInletHumRat_Unit</span>
<a name="ln-4202"></a>        <span class="n">LoadSideInletWBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletWBTemp_Unit</span>
<a name="ln-4203"></a>        <span class="n">LoadSideInletEnth</span> <span class="o">=</span> <span class="n">LoadSideInletEnth_Unit</span>
<a name="ln-4204"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="n">CpAir_Unit</span>
<a name="ln-4205"></a>    <span class="k">END IF</span>
<a name="ln-4206"></a>
<a name="ln-4207"></a>    <span class="c">! must be placed inside the loop, otherwise cause bug in release mode</span>
<a name="ln-4208"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4209"></a><span class="k">       </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">MaxSpeed</span>
<a name="ln-4210"></a>    <span class="k">ELSE</span>
<a name="ln-4211"></a><span class="k">       </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-4212"></a>    <span class="k">END IF</span>
<a name="ln-4213"></a>
<a name="ln-4214"></a><span class="k">    IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4215"></a><span class="k">        </span><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirMassFlowRate</span>
<a name="ln-4216"></a>
<a name="ln-4217"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4218"></a><span class="k">            </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4219"></a>        <span class="k">ELSE</span>
<a name="ln-4220"></a><span class="k">            </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-4221"></a>        <span class="k">END IF</span>
<a name="ln-4222"></a>
<a name="ln-4223"></a><span class="k">        </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletWBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4224"></a>        <span class="n">EIRAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4225"></a>
<a name="ln-4226"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4227"></a><span class="k">            </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4228"></a>        <span class="k">ELSE</span>
<a name="ln-4229"></a><span class="k">            </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4230"></a>        <span class="k">END IF</span>
<a name="ln-4231"></a>
<a name="ln-4232"></a><span class="k">        </span><span class="n">EIR</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">))</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRAirFFModFac</span> <span class="o">*</span> <span class="n">EIRWaterFFModFac</span>
<a name="ln-4233"></a>
<a name="ln-4234"></a>        <span class="n">CBFSpeed</span>  <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),&amp;</span>
<a name="ln-4235"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideMassFlowRate</span><span class="p">)</span>
<a name="ln-4236"></a>
<a name="ln-4237"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CBFSpeed</span> <span class="o">&gt;</span> <span class="mf">0.999d0</span><span class="p">)</span> <span class="n">CBFSpeed</span> <span class="o">=</span> <span class="mf">0.999d0</span>
<a name="ln-4238"></a>
<a name="ln-4239"></a>        <span class="k">CALL </span><span class="n">CalcTotCapSHR_VSWSHP</span><span class="p">(</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">LoadSideInletEnth</span><span class="p">,</span><span class="n">LoadSideInletWBTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4240"></a>                         <span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="n">WaterMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4241"></a>                         <span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="n">CBFSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4242"></a>                         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4243"></a>                         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),&amp;</span>
<a name="ln-4244"></a>                         <span class="mf">0.0d0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,&amp;</span>
<a name="ln-4245"></a>                         <span class="n">QLoadTotal1</span><span class="p">,</span> <span class="n">QLoadTotal2</span><span class="p">,</span> <span class="n">QLoadTotal</span><span class="p">,</span><span class="n">SHR</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4246"></a>                         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirPressure</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4247"></a>
<a name="ln-4248"></a>        <span class="n">Winput</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4249"></a>
<a name="ln-4250"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4251"></a><span class="k">            </span><span class="n">QWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4252"></a>        <span class="k">ELSE</span>
<a name="ln-4253"></a><span class="k">            </span><span class="n">QWasteHeat</span> <span class="o">=</span>  <span class="n">Winput</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4254"></a>            <span class="n">QWasteHeat</span> <span class="o">=</span> <span class="n">QWasteHeat</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletWBTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4255"></a>                        <span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4256"></a>        <span class="k">END IF</span>
<a name="ln-4257"></a><span class="k">    ELSE</span>
<a name="ln-4258"></a><span class="k">        </span><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirMassFlowRate</span>
<a name="ln-4259"></a>
<a name="ln-4260"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4261"></a><span class="k">            </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4262"></a>        <span class="k">ELSE</span>
<a name="ln-4263"></a><span class="k">            </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-4264"></a>        <span class="k">END IF</span>
<a name="ln-4265"></a>
<a name="ln-4266"></a><span class="k">        </span><span class="n">AoEff</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEffectiveAo</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="p">&amp;</span>
<a name="ln-4267"></a>            <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEffectiveAo</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4268"></a>
<a name="ln-4269"></a>        <span class="n">CBFSpeed</span>  <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">AoEff</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span><span class="p">)</span>
<a name="ln-4270"></a>
<a name="ln-4271"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CBFSpeed</span> <span class="o">&gt;</span> <span class="mf">0.999d0</span><span class="p">)</span> <span class="n">CBFSpeed</span> <span class="o">=</span> <span class="mf">0.999d0</span>
<a name="ln-4272"></a>
<a name="ln-4273"></a>        <span class="k">CALL </span><span class="n">CalcTotCapSHR_VSWSHP</span><span class="p">(</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">LoadSideInletEnth</span><span class="p">,</span><span class="n">LoadSideInletWBTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4274"></a>                 <span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="n">WaterMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4275"></a>                 <span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="n">CBFSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4276"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4277"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),&amp;</span>
<a name="ln-4278"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4279"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),&amp;</span>
<a name="ln-4280"></a>                 <span class="n">QLoadTotal1</span><span class="p">,</span> <span class="n">QLoadTotal2</span><span class="p">,</span> <span class="n">QLoadTotal</span><span class="p">,</span><span class="n">SHR</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4281"></a>                 <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirPressure</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-4282"></a>
<a name="ln-4283"></a>        <span class="n">SpeedCal</span> <span class="o">=</span>  <span class="n">SpeedNum</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4284"></a>        <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletWBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4285"></a>        <span class="n">EIRAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4286"></a>
<a name="ln-4287"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4288"></a><span class="k">            </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4289"></a>        <span class="k">ELSE</span>
<a name="ln-4290"></a><span class="k">            </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4291"></a>        <span class="k">END IF</span>
<a name="ln-4292"></a>
<a name="ln-4293"></a><span class="k">        </span><span class="n">EIR</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">))</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRAirFFModFac</span> <span class="o">*</span> <span class="n">EIRWaterFFModFac</span>
<a name="ln-4294"></a>        <span class="n">Winput1</span> <span class="o">=</span> <span class="n">QLoadTotal1</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4297"></a><span class="k">            </span><span class="n">QWasteHeat1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4298"></a>        <span class="k">ELSE</span>
<a name="ln-4299"></a><span class="k">            </span><span class="n">QWasteHeat1</span> <span class="o">=</span>  <span class="n">Winput1</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4300"></a>            <span class="n">QWasteHeat1</span> <span class="o">=</span> <span class="n">QWasteHeat1</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4301"></a>                <span class="n">LoadSideInletWBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4302"></a>        <span class="k">END IF</span>
<a name="ln-4303"></a>
<a name="ln-4304"></a><span class="k">        </span><span class="n">SpeedCal</span> <span class="o">=</span>  <span class="n">SpeedNum</span>
<a name="ln-4305"></a>        <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletWBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4306"></a>        <span class="n">EIRAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4307"></a>
<a name="ln-4308"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4309"></a><span class="k">            </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4310"></a>        <span class="k">ELSE</span>
<a name="ln-4311"></a><span class="k">            </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4312"></a>        <span class="k">END IF</span>
<a name="ln-4313"></a>
<a name="ln-4314"></a><span class="k">        </span><span class="n">EIR</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">))</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRAirFFModFac</span> <span class="o">*</span> <span class="n">EIRWaterFFModFac</span>
<a name="ln-4315"></a>        <span class="n">Winput2</span> <span class="o">=</span> <span class="n">QLoadTotal2</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4316"></a>
<a name="ln-4317"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4318"></a><span class="k">            </span><span class="n">QWasteHeat2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4319"></a>        <span class="k">ELSE</span>
<a name="ln-4320"></a><span class="k">            </span><span class="n">QWasteHeat2</span> <span class="o">=</span>  <span class="n">Winput2</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4321"></a>            <span class="n">QWasteHeat2</span> <span class="o">=</span> <span class="n">QWasteHeat2</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4322"></a>                    <span class="n">LoadSideInletWBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4323"></a>        <span class="k">END IF</span>
<a name="ln-4324"></a>
<a name="ln-4325"></a><span class="k">        </span><span class="n">Winput</span> <span class="o">=</span> <span class="n">Winput2</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Winput1</span>
<a name="ln-4326"></a>        <span class="n">QWasteHeat</span> <span class="o">=</span> <span class="n">QWasteHeat2</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">QWasteHeat1</span>
<a name="ln-4327"></a>    <span class="k">END IF</span>
<a name="ln-4328"></a>
<a name="ln-4329"></a><span class="k">    </span><span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">SHR</span>
<a name="ln-4330"></a>
<a name="ln-4331"></a>    <span class="n">Qsource</span> <span class="o">=</span>  <span class="n">QLoadTotal</span> <span class="o">+</span> <span class="n">Winput</span> <span class="o">-</span> <span class="n">QWasteHeat</span>
<a name="ln-4332"></a>
<a name="ln-4333"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Qsource</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4334"></a><span class="k">      </span><span class="n">Qsource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4335"></a>      <span class="n">QWasteHeat</span> <span class="o">=</span>  <span class="n">QLoadTotal</span> <span class="o">+</span> <span class="n">Winput</span>
<a name="ln-4336"></a>    <span class="k">END IF</span>
<a name="ln-4337"></a>
<a name="ln-4338"></a>  <span class="c">!Check if the Sensible Load is greater than the Total Cooling Load</span>
<a name="ln-4339"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">QSensible</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">QLoadTotal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4340"></a><span class="k">      </span><span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-4341"></a>    <span class="k">END IF</span>
<a name="ln-4342"></a>
<a name="ln-4343"></a><span class="k">    IF</span><span class="p">(</span><span class="n">LatDegradModelSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4344"></a>  <span class="c">!Calculate for SHReff using the Latent Degradation Model</span>
<a name="ln-4345"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4346"></a><span class="k">          </span><span class="n">QLatRated</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">QSensible</span>
<a name="ln-4347"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4348"></a><span class="k">          </span><span class="n">QLatActual</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">QSensible</span>
<a name="ln-4349"></a>          <span class="n">SHRss</span><span class="o">=</span><span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-4350"></a>          <span class="n">SHReff</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHRss</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4351"></a>                 <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">LoadSideInletDBTemp</span><span class="p">,</span> <span class="n">LoadSideInletWBTemp</span><span class="p">)</span>
<a name="ln-4352"></a><span class="c">!       Update sensible capacity based on effective SHR</span>
<a name="ln-4353"></a>          <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">SHReff</span>
<a name="ln-4354"></a>          <span class="k">EXIT </span><span class="n">LOOP</span>
<a name="ln-4355"></a>      <span class="k">END IF</span>
<a name="ln-4356"></a><span class="k">    ELSE</span>
<a name="ln-4357"></a>  <span class="c">!Assume SHReff=SHRss</span>
<a name="ln-4358"></a>      <span class="n">SHReff</span> <span class="o">=</span> <span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-4359"></a>      <span class="k">EXIT </span><span class="n">LOOP</span>
<a name="ln-4360"></a>    <span class="k">END IF</span>
<a name="ln-4361"></a><span class="k">  END DO </span><span class="n">LOOP</span>
<a name="ln-4362"></a>
<a name="ln-4363"></a>  <span class="c">! considering hot gas reheat here</span>
<a name="ln-4364"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HOTGASREHEATFLG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4365"></a><span class="k">    </span><span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">QWasteHeat</span>
<a name="ln-4366"></a>    <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QSensible</span> <span class="o">-</span><span class="n">QWasteHeat</span>
<a name="ln-4367"></a>    <span class="n">SHReff</span> <span class="o">=</span> <span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-4368"></a>  <span class="k">END IF</span>
<a name="ln-4369"></a>
<a name="ln-4370"></a><span class="k">  </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4371"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4372"></a>
<a name="ln-4373"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4374"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4375"></a>          <span class="c">!******************</span>
<a name="ln-4376"></a>          <span class="c">!             WATER CONSUMPTION IN m3 OF WATER FOR DIRECT</span>
<a name="ln-4377"></a>          <span class="c">!             H2O [m3/sec] = Delta W[KgH2O/Kg air]*Mass Flow Air[Kg air]</span>
<a name="ln-4378"></a>          <span class="c">!                                /RhoWater [kg H2O/m3 H2O]</span>
<a name="ln-4379"></a>          <span class="c">!******************</span>
<a name="ln-4380"></a>             <span class="n">RhoEvapCondWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-4381"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span>  <span class="p">(</span><span class="n">CondInletHumrat</span> <span class="o">-</span> <span class="n">OutdoorHumRat</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4382"></a>                      <span class="n">CondAirMassFlow</span><span class="o">/</span><span class="n">RhoEvapCondWater</span> <span class="o">*</span> <span class="n">RuntimeFrac</span>
<a name="ln-4383"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4384"></a>                                                       <span class="n">RuntimeFrac</span>
<a name="ln-4385"></a>          <span class="c">! Calculate basin heater power</span>
<a name="ln-4386"></a>            <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4387"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4388"></a>                                      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4389"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4390"></a>                                                 <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-4391"></a>       <span class="k">END IF</span>
<a name="ln-4392"></a>
<a name="ln-4393"></a><span class="k">       </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-4394"></a>
<a name="ln-4395"></a>        <span class="c">!set water system demand request (if needed)</span>
<a name="ln-4396"></a>       <span class="k">IF</span> <span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4397"></a><span class="k">           </span><span class="n">WaterStorage</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(&amp;</span>
<a name="ln-4398"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span><span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-4399"></a>       <span class="n">ENDIF</span>
<a name="ln-4400"></a>
<a name="ln-4401"></a>  <span class="k">END IF</span>
<a name="ln-4402"></a>
<a name="ln-4403"></a>  <span class="c">!calculate coil outlet state variables</span>
<a name="ln-4404"></a>  <span class="n">LoadSideOutletEnth</span>   <span class="o">=</span> <span class="n">LoadSideInletEnth</span> <span class="o">-</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-4405"></a>  <span class="n">LoadSideOutletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">-</span> <span class="n">QSensible</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span><span class="p">)</span>
<a name="ln-4406"></a>
<a name="ln-4407"></a>  <span class="n">MaxHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="mf">0.9999d0</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4408"></a>  <span class="n">MaxOutletEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">MaxHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4409"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">LoadSideOutletEnth</span> <span class="o">&gt;</span> <span class="n">MaxOutletEnth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4410"></a><span class="k">    </span><span class="n">LoadSideOutletEnth</span> <span class="o">=</span> <span class="n">MaxOutletEnth</span>
<a name="ln-4411"></a>    <span class="c">!QLoadTotal = LoadSideMassFlowRate * (LoadSideInletEnth - LoadSideOutletEnth)</span>
<a name="ln-4412"></a>  <span class="k">END IF</span>
<a name="ln-4413"></a><span class="k">  </span><span class="n">LoadsideOutletHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">LoadSideOutletEnth</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4414"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">LoadsideOutletHumRat</span> <span class="o">&gt;</span> <span class="n">MaxHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4415"></a><span class="k">    </span><span class="n">LoadsideOutletHumRat</span> <span class="o">=</span> <span class="n">MaxHumRat</span>
<a name="ln-4416"></a>  <span class="k">END IF</span>
<a name="ln-4417"></a>
<a name="ln-4418"></a><span class="k">  </span><span class="nb">Count</span> <span class="o">=</span> <span class="nb">Count</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4419"></a>  <span class="c">!Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-4420"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4421"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-4422"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadSideOutletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4423"></a>                                                  <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletEnth</span>
<a name="ln-4424"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadsideOutletHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4425"></a>                                                  <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletHumRat</span>
<a name="ln-4426"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4427"></a>                                                             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-4428"></a>                                                             <span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4429"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span>
<a name="ln-4430"></a>  <span class="k">ELSE</span>
<a name="ln-4431"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-4432"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LoadSideOutletEnth</span>
<a name="ln-4433"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">LoadsideOutletHumRat</span>
<a name="ln-4434"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">LoadSideOutletDBTemp</span>
<a name="ln-4435"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4436"></a>  <span class="k">END IF</span>
<a name="ln-4437"></a>
<a name="ln-4438"></a>   <span class="c">! scale heat transfer rates to PLR and power to RTF</span>
<a name="ln-4439"></a>  <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4440"></a>  <span class="n">QSensible</span>  <span class="o">=</span> <span class="n">QSensible</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4441"></a>  <span class="c">! count the powr separately</span>
<a name="ln-4442"></a>  <span class="n">Winput</span>     <span class="o">=</span> <span class="n">Winput</span><span class="o">*</span><span class="n">RuntimeFrac</span>  <span class="c">!+ VarSpeedCoil(DXCoilNum)%CrankcaseHeaterPower &amp;</span>
<a name="ln-4443"></a>                <span class="c">!+ VarSpeedCoil(DXCoilNum)%BasinHeaterPower + VarSpeedCoil(DXCoilNum)%EvapCondPumpElecPower</span>
<a name="ln-4444"></a>  <span class="n">QSource</span>    <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4445"></a>  <span class="n">QWasteHeat</span> <span class="o">=</span> <span class="n">QWasteHeat</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-4446"></a>
<a name="ln-4447"></a><span class="c">!  Add power to global variable so power can be summed by parent object</span>
<a name="ln-4448"></a>  <span class="n">DXElecCoolingPower</span> <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-4449"></a>
<a name="ln-4450"></a>  <span class="n">ReportingConstant</span><span class="o">=</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4451"></a>  <span class="c">!Update heat pump data structure</span>
<a name="ln-4452"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span>               <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-4453"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span>          <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-4454"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span>           <span class="o">=</span> <span class="n">QSensible</span>
<a name="ln-4455"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span>             <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">QSensible</span>
<a name="ln-4456"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span>             <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-4457"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="n">Winput</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4458"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4459"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4460"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="p">(</span><span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">QSensible</span><span class="p">)</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4461"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4462"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4463"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4464"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4465"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4466"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RunTimeFrac</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4467"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4468"></a>  <span class="k">ELSE</span>
<a name="ln-4469"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">Winput</span>
<a name="ln-4470"></a>  <span class="k">END IF</span>
<a name="ln-4471"></a><span class="k">  </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span>             <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-4472"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>       <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-4473"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>     <span class="o">=</span> <span class="n">PLRCorrLoadSideMdot</span>
<a name="ln-4474"></a>
<a name="ln-4475"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4476"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4477"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4478"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4479"></a>  <span class="k">ELSE</span>
<a name="ln-4480"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>   <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span>
<a name="ln-4481"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpSource</span><span class="p">)</span>
<a name="ln-4482"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SourceSideInletEnth</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-4483"></a>  <span class="k">END IF</span>
<a name="ln-4484"></a>
<a name="ln-4485"></a><span class="k">  </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QWasteHeat</span> <span class="o">=</span>  <span class="n">QWasteHeat</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4488"></a>      <span class="c">! calculate and report condensation rates  (how much water extracted from the air stream)</span>
<a name="ln-4489"></a>      <span class="c">! water flow of water in m3/s for water system interactions</span>
<a name="ln-4490"></a>      <span class="n">rhoWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">((</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span> <span class="o">+</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-4491"></a><span class="c">!     CR9155 Remove specific humidity calculations</span>
<a name="ln-4492"></a>      <span class="n">SpecHumIn</span> <span class="o">=</span> <span class="n">LoadSideInletHumRat</span>
<a name="ln-4493"></a>      <span class="n">SpecHumOut</span> <span class="o">=</span> <span class="n">LoadSideOutletHumRat</span>
<a name="ln-4494"></a>      <span class="c">!  mdot * del HumRat / rho water</span>
<a name="ln-4495"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-4496"></a>                <span class="p">(</span><span class="n">SpecHumIn</span> <span class="o">-</span> <span class="n">SpecHumOut</span><span class="p">)</span> <span class="o">/</span> <span class="n">rhoWater</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-4497"></a>      <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span>  <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4498"></a>  <span class="n">ENDIF</span>
<a name="ln-4499"></a>
<a name="ln-4500"></a>  <span class="k">RETURN</span>
<a name="ln-4501"></a><span class="k">END SUBROUTINE </span><span class="n">CalcVarSpeedCoilCooling</span>
<a name="ln-4502"></a>
<a name="ln-4503"></a><span class="k">SUBROUTINE  </span><span class="n">CalcVarSpeedCoilHeating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4504"></a>        <span class="n">SensDemand</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-4505"></a>
<a name="ln-4506"></a>
<a name="ln-4507"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:CalcHPHeatingSimple</span>
<a name="ln-4508"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-4509"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4510"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4511"></a>
<a name="ln-4512"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4513"></a>          <span class="c">! This subroutine is for simulating the heating mode of the Variable Speed Water to Air HP Simple</span>
<a name="ln-4514"></a>
<a name="ln-4515"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4516"></a>          <span class="c">! Simulate the heat pump performance using the coefficients and rated conditions</span>
<a name="ln-4517"></a>          <span class="c">!</span>
<a name="ln-4518"></a>          <span class="c">! Finally, adjust the heat pump outlet conditions based on the PartLoadRatio</span>
<a name="ln-4519"></a>          <span class="c">! and RuntimeFrac.</span>
<a name="ln-4520"></a>
<a name="ln-4521"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4522"></a>          <span class="c">! na</span>
<a name="ln-4523"></a>
<a name="ln-4524"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4525"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-4526"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span><span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">DXElecHeatingPower</span>
<a name="ln-4527"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span><span class="n">PsyWFnTdbTwbPb</span><span class="p">,</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span><span class="n">PsyCpAirFnWTdb</span><span class="p">,</span><span class="n">PsyTwbFnTdbWPb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4528"></a>                                 <span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyWFnTdbH</span><span class="p">,</span><span class="n">PsyHFnTdbW</span>
<a name="ln-4529"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span><span class="n">GetSpecificHeatGlycol</span>
<a name="ln-4530"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-4531"></a>
<a name="ln-4532"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4533"></a>
<a name="ln-4534"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4535"></a>
<a name="ln-4536"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>              <span class="c">! Heat Pump Number</span>
<a name="ln-4537"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>      <span class="c">! Fan/Compressor cycling scheme indicator</span>
<a name="ln-4538"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensDemand</span>         <span class="c">! Cooling Sensible Demand [W] !unused1208</span>
<a name="ln-4539"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation flag</span>
<a name="ln-4540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! compressor part load ratio</span>
<a name="ln-4541"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>        <span class="c">! Runtime Fraction of compressor or percent on time (on-time/cycle time)</span>
<a name="ln-4542"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor on flow to average flow over time step</span>
<a name="ln-4543"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>        <span class="c">! SpeedRatio varies between 1.0 (higher speed) and 0.0 (lower speed)</span>
<a name="ln-4544"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpeedNum</span>      <span class="c">! Speed number, high bound, i.e. SpeedNum - 1 is the other side</span>
<a name="ln-4545"></a>
<a name="ln-4546"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4547"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Tref</span><span class="o">=</span><span class="mi">28</span><span class="mf">3.15d0</span>      <span class="c">! Reference Temperature for performance curves,10C [K]</span>
<a name="ln-4548"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcVarSpeedCoilHeating&#39;</span>
<a name="ln-4549"></a>
<a name="ln-4550"></a>
<a name="ln-4551"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4552"></a>          <span class="c">! na</span>
<a name="ln-4553"></a>
<a name="ln-4554"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4555"></a>          <span class="c">! na</span>
<a name="ln-4556"></a>
<a name="ln-4557"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4558"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpSource</span>                <span class="c">! Specific heat of water [J/kg_C]</span>
<a name="ln-4559"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>                  <span class="c">! Specific heat of air [J/kg_C]</span>
<a name="ln-4560"></a>
<a name="ln-4561"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>   <span class="c">! airflow ratio at low speed</span>
<a name="ln-4562"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatio</span>   <span class="c">! airflow ratio at high speed</span>
<a name="ln-4563"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapAirFFModFac</span> <span class="c">!air flow fraction modification</span>
<a name="ln-4564"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapWaterFFModFac</span> <span class="c">!water flow fraction modification</span>
<a name="ln-4565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-4566"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRAirFFModFac</span> <span class="c">!air flow fraction modification</span>
<a name="ln-4567"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRWaterFFModFac</span> <span class="c">!water flow fraction modification</span>
<a name="ln-4568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-4569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">!total capacity temperature correctio fraction</span>
<a name="ln-4570"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxSpeed</span>           <span class="c">! maximum speed level</span>
<a name="ln-4571"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedCal</span>           <span class="c">! calculated speed level</span>
<a name="ln-4572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal1</span>      <span class="c">! heating capacit at low speed</span>
<a name="ln-4573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal2</span>      <span class="c">! heating capacity at high speed</span>
<a name="ln-4574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Winput1</span>          <span class="c">! power consumption at low speed</span>
<a name="ln-4575"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Winput2</span>          <span class="c">! power consumption at high speed</span>
<a name="ln-4576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat</span>       <span class="c">!recoverable waste heat</span>
<a name="ln-4577"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat1</span>      <span class="c">!recoverable waste heat at low speed</span>
<a name="ln-4578"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QWasteHeat2</span>      <span class="c">!recoverable waste heat at high speed</span>
<a name="ln-4579"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>  <span class="c">!part-load function</span>
<a name="ln-4580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-4581"></a>
<a name="ln-4582"></a> <span class="c">! ADDED VARIABLES FOR air source coil</span>
<a name="ln-4583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorCoilT</span>  <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Outdoor coil temperature (C)</span>
<a name="ln-4584"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorCoildw</span>  <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Outdoor coil delta w assuming coil temp of OutdoorCoilT (kg/kg)</span>
<a name="ln-4585"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>   <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-4586"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>   <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-4587"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-4588"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorPressure</span>   <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-4589"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FractionalDefrostTime</span>  <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Fraction of time step system is in defrost</span>
<a name="ln-4590"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatingCapacityMultiplier</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Multiplier for heating capacity when system is in defrost</span>
<a name="ln-4591"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InputPowerMultiplier</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Multiplier for power when system is in defrost</span>
<a name="ln-4592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LoadDueToDefrost</span>   <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Additional load due to defrost</span>
<a name="ln-4593"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! power due to crankcase heater</span>
<a name="ln-4594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">DefrostEIRTempModFac</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! EIR modifier for defrost (function of entering wetbulb, outside drybulb)</span>
<a name="ln-4595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotRatedCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! total rated capacity at the given speed and speed ratio for defrosting </span>
<a name="ln-4596"></a>
<a name="ln-4597"></a>  <span class="n">MaxSpeed</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumofSpeeds</span>
<a name="ln-4598"></a>
<a name="ln-4599"></a> <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-4600"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4601"></a><span class="k">     </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span>
<a name="ln-4602"></a>  <span class="k">END IF</span>
<a name="ln-4603"></a>
<a name="ln-4604"></a><span class="k">  </span><span class="n">LoadSideMassFlowRate</span>   <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>
<a name="ln-4605"></a>  <span class="n">LoadSideInletDBTemp</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-4606"></a>  <span class="n">LoadSideInletHumRat</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-4607"></a>
<a name="ln-4608"></a>  <span class="n">LoadSideInletWBTemp</span>    <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4609"></a>  <span class="n">LoadSideInletEnth</span>      <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-4610"></a>  <span class="n">CpAir</span>                  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4611"></a>
<a name="ln-4612"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4613"></a>    <span class="c">! Get condenser outdoor node info from DX Heating Coil</span>
<a name="ln-4614"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4615"></a><span class="k">        </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4616"></a>        <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4617"></a>        <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-4618"></a>        <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">)%</span><span class="n">OutAirWetBulb</span>
<a name="ln-4619"></a>      <span class="k">ELSE</span>
<a name="ln-4620"></a><span class="k">        </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-4621"></a>        <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-4622"></a>        <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-4623"></a>        <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-4624"></a>      <span class="n">ENDIF</span>
<a name="ln-4625"></a>      <span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! not used and avoid divided by zero</span>
<a name="ln-4626"></a>      <span class="n">SourceSideInletTemp</span>    <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-4627"></a>      <span class="n">SourceSideInletEnth</span>    <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4628"></a>      <span class="n">CpSource</span>               <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4629"></a>
<a name="ln-4630"></a>      <span class="c">! Initialize crankcase heater, operates below OAT defined in input deck for HP DX heating coil</span>
<a name="ln-4631"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4632"></a><span class="k">       </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-4633"></a>     <span class="k">ELSE</span>
<a name="ln-4634"></a><span class="k">       </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4635"></a>     <span class="k">END IF</span>
<a name="ln-4636"></a><span class="k">  ELSE</span>
<a name="ln-4637"></a><span class="k">      </span><span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-4638"></a>      <span class="n">SourceSideInletTemp</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-4639"></a>      <span class="n">SourceSideInletEnth</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-4640"></a>      <span class="n">CpSource</span>               <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4641"></a>                                       <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>                                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4643"></a>                                       <span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-4644"></a>  <span class="k">END IF</span>
<a name="ln-4645"></a>
<a name="ln-4646"></a> <span class="c">!Check for flows, do not perform simulation if no flow in load side or source side.</span>
<a name="ln-4647"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SourceSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-4648"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4649"></a>    <span class="k">RETURN</span>
<a name="ln-4650"></a><span class="k">  ELSE</span>
<a name="ln-4651"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4652"></a>  <span class="n">ENDIF</span>
<a name="ln-4653"></a>
<a name="ln-4654"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4655"></a>     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="o">&lt;</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-4656"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4657"></a>    <span class="k">RETURN</span>
<a name="ln-4658"></a><span class="k">  END IF</span>
<a name="ln-4659"></a>
<a name="ln-4660"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4661"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4662"></a>    <span class="k">RETURN</span>
<a name="ln-4663"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-4664"></a>
<a name="ln-4665"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4666"></a><span class="k">      </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">MaxSpeed</span>
<a name="ln-4667"></a>  <span class="k">ELSE</span>
<a name="ln-4668"></a><span class="k">      </span><span class="n">SpeedCal</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-4669"></a>  <span class="k">END IF</span>
<a name="ln-4670"></a>
<a name="ln-4671"></a><span class="k">  </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4672"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4673"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4674"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-4675"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4676"></a><span class="k">     </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-4677"></a>    <span class="k">END IF</span>
<a name="ln-4678"></a>    <span class="c">! calculate the run time fraction</span>
<a name="ln-4679"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-4680"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>    <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-4681"></a>
<a name="ln-4682"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4683"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-4684"></a>    <span class="k">ELSE IF</span><span class="p">(</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4685"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4686"></a>    <span class="k">END IF</span>
<a name="ln-4687"></a>
<a name="ln-4688"></a><span class="k">    </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span>
<a name="ln-4689"></a>  <span class="k">END IF</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a><span class="k">  IF</span><span class="p">((</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="n">MaxSpeed</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4692"></a><span class="k">    </span><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirMassFlowRate</span>
<a name="ln-4693"></a>
<a name="ln-4694"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4695"></a><span class="k">        </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4696"></a>    <span class="k">ELSE</span>
<a name="ln-4697"></a><span class="k">        </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-4698"></a>    <span class="k">END IF</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a><span class="k">    </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4701"></a>    <span class="n">TotCapAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4702"></a>
<a name="ln-4703"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4704"></a><span class="k">        </span><span class="n">TotCapWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4705"></a>    <span class="k">ELSE</span>
<a name="ln-4706"></a><span class="k">        </span><span class="n">TotCapWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4707"></a>    <span class="k">END IF</span>
<a name="ln-4708"></a>
<a name="ln-4709"></a><span class="k">    </span><span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapAirFFModFac</span> <span class="o">*</span> <span class="n">TotCapWaterFFModFac</span>
<a name="ln-4710"></a>    <span class="n">TotRatedCapacity</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span> <span class="c">! for defrosting power cal</span>
<a name="ln-4711"></a>
<a name="ln-4712"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4713"></a>    <span class="n">EIRAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4714"></a>
<a name="ln-4715"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4716"></a><span class="k">        </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-4717"></a>    <span class="k">ELSE</span>
<a name="ln-4718"></a><span class="k">        </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4719"></a>    <span class="k">END IF</span>
<a name="ln-4720"></a>
<a name="ln-4721"></a><span class="k">    </span><span class="n">EIR</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">))</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRAirFFModFac</span> <span class="o">*</span> <span class="n">EIRWaterFFModFac</span>
<a name="ln-4722"></a>    <span class="n">Winput</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4723"></a>
<a name="ln-4724"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4725"></a><span class="k">        </span><span class="n">QWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4726"></a>    <span class="k">ELSE</span>
<a name="ln-4727"></a><span class="k">        </span><span class="n">QWasteHeat</span> <span class="o">=</span>  <span class="n">Winput</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4728"></a>        <span class="n">QWasteHeat</span> <span class="o">=</span> <span class="n">QWasteHeat</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4729"></a>                    <span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4730"></a>    <span class="k">END IF</span>
<a name="ln-4731"></a>
<a name="ln-4732"></a><span class="k">  ELSE</span>
<a name="ln-4733"></a><span class="k">    </span><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">/</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignAirMassFlowRate</span>
<a name="ln-4734"></a>
<a name="ln-4735"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4736"></a><span class="k">        </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4737"></a>    <span class="k">ELSE</span>
<a name="ln-4738"></a><span class="k">        </span><span class="n">WaterMassFlowRatio</span> <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-4739"></a>    <span class="k">END IF</span>
<a name="ln-4740"></a>
<a name="ln-4741"></a><span class="k">    </span><span class="n">SpeedCal</span> <span class="o">=</span>  <span class="n">SpeedNum</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4742"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4743"></a>    <span class="n">TotCapAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4744"></a>
<a name="ln-4745"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4746"></a><span class="k">        </span><span class="n">TotCapWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4747"></a>    <span class="k">ELSE</span>
<a name="ln-4748"></a><span class="k">        </span><span class="n">TotCapWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4749"></a>    <span class="k">END IF</span>
<a name="ln-4750"></a>
<a name="ln-4751"></a><span class="k">    </span><span class="n">QLoadTotal1</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapAirFFModFac</span> <span class="o">*</span> <span class="n">TotCapWaterFFModFac</span>
<a name="ln-4752"></a>
<a name="ln-4753"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4754"></a>    <span class="n">EIRAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4755"></a>
<a name="ln-4756"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4757"></a><span class="k">        </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4758"></a>    <span class="k">ELSE</span>
<a name="ln-4759"></a><span class="k">        </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4760"></a>    <span class="k">END IF</span>
<a name="ln-4761"></a>
<a name="ln-4762"></a><span class="k">    </span><span class="n">EIR</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">))</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRAirFFModFac</span> <span class="o">*</span> <span class="n">EIRWaterFFModFac</span>
<a name="ln-4763"></a>    <span class="n">Winput1</span> <span class="o">=</span> <span class="n">QLoadTotal1</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4764"></a>
<a name="ln-4765"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4766"></a><span class="k">        </span><span class="n">QWasteHeat1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4767"></a>    <span class="k">ELSE</span>
<a name="ln-4768"></a><span class="k">        </span><span class="n">QWasteHeat1</span> <span class="o">=</span>  <span class="n">Winput1</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4769"></a>        <span class="n">QWasteHeat1</span> <span class="o">=</span> <span class="n">QWasteHeat1</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4770"></a>                <span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4771"></a>    <span class="k">END IF</span>
<a name="ln-4772"></a>
<a name="ln-4773"></a><span class="k">    </span><span class="n">SpeedCal</span> <span class="o">=</span>  <span class="n">SpeedNum</span>
<a name="ln-4774"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4775"></a>    <span class="n">TotCapAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4778"></a><span class="k">        </span><span class="n">TotCapWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4779"></a>    <span class="k">ELSE</span>
<a name="ln-4780"></a><span class="k">        </span><span class="n">TotCapWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4781"></a>    <span class="k">END IF</span>
<a name="ln-4782"></a>
<a name="ln-4783"></a><span class="k">    </span><span class="n">QLoadTotal2</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapAirFFModFac</span> <span class="o">*</span> <span class="n">TotCapWaterFFModFac</span>
<a name="ln-4784"></a>
<a name="ln-4785"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4786"></a>    <span class="n">EIRAirFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRAirFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4787"></a>
<a name="ln-4788"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4789"></a><span class="k">        </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4790"></a>    <span class="k">ELSE</span>
<a name="ln-4791"></a><span class="k">        </span><span class="n">EIRWaterFFModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRWaterFFlow</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-4792"></a>    <span class="k">END IF</span>
<a name="ln-4793"></a>
<a name="ln-4794"></a><span class="k">    </span><span class="n">EIR</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">))</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRAirFFModFac</span> <span class="o">*</span> <span class="n">EIRWaterFFModFac</span>
<a name="ln-4795"></a>    <span class="n">Winput2</span> <span class="o">=</span> <span class="n">QLoadTotal2</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4796"></a>
<a name="ln-4797"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4798"></a><span class="k">        </span><span class="n">QWasteHeat2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4799"></a>    <span class="k">ELSE</span>
<a name="ln-4800"></a><span class="k">        </span><span class="n">QWasteHeat2</span> <span class="o">=</span>  <span class="n">Winput2</span> <span class="o">*</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span>
<a name="ln-4801"></a>        <span class="n">QWasteHeat2</span> <span class="o">=</span> <span class="n">QWasteHeat2</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4802"></a>                <span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">)</span>
<a name="ln-4803"></a>    <span class="k">END IF</span>
<a name="ln-4804"></a>
<a name="ln-4805"></a><span class="k">    </span><span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal2</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">QLoadTotal1</span>
<a name="ln-4806"></a>    <span class="n">Winput</span> <span class="o">=</span> <span class="n">Winput2</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Winput1</span>
<a name="ln-4807"></a>    <span class="n">QWasteHeat</span> <span class="o">=</span> <span class="n">QWasteHeat2</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">QWasteHeat1</span>
<a name="ln-4808"></a>    <span class="n">TotRatedCapacity</span> <span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4809"></a>                       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedCal</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4810"></a>  <span class="k">END IF</span>
<a name="ln-4811"></a>
<a name="ln-4812"></a><span class="k">  </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!necessary to clear zero for water source coils</span>
<a name="ln-4813"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="mf">0.0d0</span> <span class="c">!clear the defrost power </span>
<a name="ln-4814"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4815"></a>    <span class="c">! Calculating adjustment factors for defrost</span>
<a name="ln-4816"></a>    <span class="c">! Calculate delta w through outdoor coil by assuming a coil temp of 0.82*DBT-9.7(F) per DOE2.1E</span>
<a name="ln-4817"></a>      <span class="n">OutdoorCoilT</span> <span class="o">=</span> <span class="mf">0.82d0</span> <span class="o">*</span> <span class="n">OutdoorDryBulb</span> <span class="o">-</span> <span class="mf">8.589d0</span>
<a name="ln-4818"></a>      <span class="n">OutdoorCoildw</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">1.0d-6</span><span class="p">,(</span><span class="n">OutdoorHumRat</span> <span class="o">-</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">OutdoorCoilT</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)))</span>
<a name="ln-4819"></a>
<a name="ln-4820"></a>    <span class="c">! Initializing defrost adjustment factors</span>
<a name="ln-4821"></a>      <span class="n">LoadDueToDefrost</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4822"></a>      <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4823"></a>      <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4824"></a>      <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4825"></a>    <span class="c">!</span>
<a name="ln-4826"></a>    <span class="c">! Check outdoor temperature to determine of defrost is active</span>
<a name="ln-4827"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4828"></a>    <span class="c">! Calculate defrost adjustment factors depending on defrost control type</span>
<a name="ln-4829"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Timed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4830"></a><span class="k">           </span><span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span>
<a name="ln-4831"></a>           <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.909d0</span> <span class="o">-</span> <span class="mi">10</span><span class="mf">7.33d0</span> <span class="o">*</span> <span class="n">OutdoorCoildw</span>
<a name="ln-4832"></a>           <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.90d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">6.45d0</span><span class="o">*</span><span class="n">OutdoorCoildw</span>
<a name="ln-4833"></a>         <span class="k">ELSE</span> <span class="c">!else defrost control is on-demand</span>
<a name="ln-4834"></a>           <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.01446d0</span> <span class="o">/</span> <span class="n">OutdoorCoildw</span><span class="p">)</span>
<a name="ln-4835"></a>           <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.875d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-4836"></a>           <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.954d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-4837"></a>         <span class="k">END IF</span>
<a name="ln-4838"></a>         <span class="c">! correction fractional defrost time shorten by runtime fraction</span>
<a name="ln-4839"></a>         <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="n">RuntimeFrac</span> <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-4840"></a>
<a name="ln-4841"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4842"></a>    <span class="c">! Calculate defrost adjustment factors depending on defrost control strategy</span>
<a name="ln-4843"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ReverseCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4844"></a><span class="k">             </span><span class="n">LoadDueToDefrost</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01d0</span> <span class="o">*</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4845"></a>                                <span class="p">(</span><span class="mf">7.222d0</span> <span class="o">-</span> <span class="n">OutdoorDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4846"></a>                                <span class="p">(</span><span class="n">TotRatedCapacity</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span>
<a name="ln-4847"></a>             <span class="n">DefrostEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">,&amp;</span>
<a name="ln-4848"></a>                                    <span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">LoadSideInletWBTemp</span><span class="p">),</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">))</span>
<a name="ln-4849"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="n">DefrostEIRTempModFac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4850"></a>                                               <span class="p">(</span><span class="n">TotRatedCapacity</span> <span class="p">&amp;</span>
<a name="ln-4851"></a>                                               <span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span><span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-4852"></a>           <span class="k">ELSE</span> <span class="c">! Defrost strategy is resistive</span>
<a name="ln-4853"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">&amp;</span>
<a name="ln-4854"></a>                                              <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-4855"></a>           <span class="k">END IF</span>
<a name="ln-4856"></a><span class="k">         ELSE</span> <span class="c">! Defrost is not active because (OutDryBulbTemp .GT. DXCoil(DXCoilNum)%MaxOATDefrost)</span>
<a name="ln-4857"></a>           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-4858"></a>         <span class="k">END IF</span>
<a name="ln-4859"></a><span class="k">      END IF</span>
<a name="ln-4860"></a>
<a name="ln-4861"></a><span class="k">      </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-4862"></a>    <span class="c">!! Modify total heating capacity based on defrost heating capacity multiplier</span>
<a name="ln-4863"></a>    <span class="c">!! MaxHeatCap passed from parent object VRF Condenser and is used to limit capacity of TU&#39;s to that available from condenser</span>
<a name="ln-4864"></a>    <span class="c">!  IF(PRESENT(MaxHeatCap))THEN</span>
<a name="ln-4865"></a>    <span class="c">!    TotCap = MIN(MaxHeatCap,TotCap * HeatingCapacityMultiplier)</span>
<a name="ln-4866"></a>    <span class="c">!  ELSE</span>
<a name="ln-4867"></a>    <span class="c">!    TotCap = TotCap * HeatingCapacityMultiplier</span>
<a name="ln-4868"></a>    <span class="c">!  END IF</span>
<a name="ln-4869"></a>      <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">HeatingCapacityMultiplier</span> <span class="o">-</span> <span class="n">LoadDueToDefrost</span>
<a name="ln-4870"></a>      <span class="c">! count the powr separately</span>
<a name="ln-4871"></a>      <span class="n">Winput</span> <span class="o">=</span> <span class="n">Winput</span> <span class="o">*</span> <span class="n">InputPowerMultiplier</span> <span class="c">!+ VarSpeedCoil(DXCoilNum)%DefrostPower</span>
<a name="ln-4872"></a>
<a name="ln-4873"></a>  <span class="k">END IF</span>
<a name="ln-4874"></a>
<a name="ln-4875"></a><span class="k">  </span><span class="n">Qsource</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">+</span> <span class="n">QWasteHeat</span> <span class="o">-</span><span class="n">Winput</span>
<a name="ln-4876"></a>  <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-4877"></a>
<a name="ln-4878"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Qsource</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4879"></a><span class="k">    </span><span class="n">Qsource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4880"></a>    <span class="n">QWasteHeat</span> <span class="o">=</span>  <span class="n">Winput</span> <span class="o">-</span> <span class="n">QLoadTotal</span>
<a name="ln-4881"></a>  <span class="k">END IF</span>
<a name="ln-4882"></a>
<a name="ln-4883"></a>  <span class="c">! calculate coil outlet state variables</span>
<a name="ln-4884"></a>  <span class="n">LoadSideOutletEnth</span>   <span class="o">=</span> <span class="n">LoadSideInletEnth</span> <span class="o">+</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-4885"></a>  <span class="n">LoadSideOutletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">+</span> <span class="n">QSensible</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span><span class="p">)</span>
<a name="ln-4886"></a>  <span class="n">LoadsideOutletHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">LoadSideOutletEnth</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4887"></a>
<a name="ln-4888"></a>  <span class="c">! Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-4889"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4890"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-4891"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadSideOutletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4892"></a>                                                  <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletEnth</span>
<a name="ln-4893"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadsideOutletHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4894"></a>                                                  <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletHumRat</span>
<a name="ln-4895"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4896"></a>                                                               <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4897"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span>
<a name="ln-4898"></a>  <span class="k">ELSE</span>
<a name="ln-4899"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-4900"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LoadSideOutletEnth</span>
<a name="ln-4901"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">LoadsideOutletHumRat</span>
<a name="ln-4902"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">LoadSideOutletDBTemp</span>
<a name="ln-4903"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4904"></a>  <span class="k">END IF</span>
<a name="ln-4905"></a>
<a name="ln-4906"></a>
<a name="ln-4907"></a>   <span class="c">! scale heat transfer rates to PLR and power to RTF</span>
<a name="ln-4908"></a>  <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4909"></a>  <span class="n">QSensible</span>  <span class="o">=</span> <span class="n">QSensible</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4910"></a>  <span class="c">! count the powr separately</span>
<a name="ln-4911"></a>  <span class="n">Winput</span>     <span class="o">=</span> <span class="n">Winput</span><span class="o">*</span><span class="n">RuntimeFrac</span> <span class="c">!+ VarSpeedCoil(DXCoilNum)%CrankcaseHeaterPower</span>
<a name="ln-4912"></a>  <span class="n">QSource</span>    <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4913"></a>  <span class="n">QWasteHeat</span> <span class="o">=</span> <span class="n">QWasteHeat</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4914"></a>
<a name="ln-4915"></a><span class="c">!  Add power to global variable so power can be summed by parent object</span>
<a name="ln-4916"></a>  <span class="n">DXElecHeatingPower</span> <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-4917"></a>
<a name="ln-4918"></a>  <span class="n">ReportingConstant</span><span class="o">=</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4919"></a>  <span class="c">!Update heat pump data structure</span>
<a name="ln-4920"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span>               <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-4921"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span>          <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-4922"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span>           <span class="o">=</span> <span class="n">QSensible</span>
<a name="ln-4923"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span>             <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-4924"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="n">Winput</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4925"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4926"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4927"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4928"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4929"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4930"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-4931"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RunTimeFrac</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4932"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4933"></a>  <span class="k">ELSE</span>
<a name="ln-4934"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">Winput</span>
<a name="ln-4935"></a>  <span class="k">END IF</span>
<a name="ln-4936"></a><span class="k">  </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span>             <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-4937"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>       <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-4938"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>     <span class="o">=</span> <span class="n">PLRCorrLoadSideMdot</span>
<a name="ln-4939"></a>
<a name="ln-4940"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">VSCoilTypeOfNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4941"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4942"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4943"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4944"></a>  <span class="k">ELSE</span>
<a name="ln-4945"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>   <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span>
<a name="ln-4946"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpSource</span><span class="p">)</span>
<a name="ln-4947"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SourceSideInletEnth</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-4948"></a>  <span class="k">END IF</span>
<a name="ln-4949"></a>
<a name="ln-4950"></a><span class="k">  </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QWasteHeat</span> <span class="o">=</span>  <span class="n">QWasteHeat</span>
<a name="ln-4951"></a>  <span class="k">RETURN</span>
<a name="ln-4952"></a><span class="k">END SUBROUTINE </span><span class="n">CalcVarSpeedCoilHeating</span>
<a name="ln-4953"></a>
<a name="ln-4954"></a><span class="k">FUNCTION </span><span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilCapacity</span><span class="p">)</span>
<a name="ln-4955"></a>
<a name="ln-4956"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4957"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:GetCoilCapacity</span>
<a name="ln-4958"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-4959"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4960"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4961"></a>
<a name="ln-4962"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4963"></a>          <span class="c">! This function looks up the rated coil capacity at the nominal speed level for the given coil and returns it.  If</span>
<a name="ln-4964"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-4965"></a>          <span class="c">! as negative.</span>
<a name="ln-4966"></a>
<a name="ln-4967"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4968"></a>          <span class="c">! na</span>
<a name="ln-4969"></a>
<a name="ln-4970"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4971"></a>          <span class="c">! na</span>
<a name="ln-4972"></a>
<a name="ln-4973"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4974"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-4975"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-4976"></a>
<a name="ln-4977"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4978"></a>
<a name="ln-4979"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4980"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-4981"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-4982"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-4983"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CoilCapacity</span> <span class="c">! returned capacity of matched coil</span>
<a name="ln-4984"></a>
<a name="ln-4985"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4986"></a>          <span class="c">! na</span>
<a name="ln-4987"></a>
<a name="ln-4988"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4989"></a>          <span class="c">! na</span>
<a name="ln-4990"></a>
<a name="ln-4991"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4992"></a>          <span class="c">! na</span>
<a name="ln-4993"></a>
<a name="ln-4994"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4995"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-4996"></a>
<a name="ln-4997"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-4998"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-4999"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5000"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5001"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5002"></a>  <span class="k">End If</span>
<a name="ln-5003"></a>
<a name="ln-5004"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5005"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5006"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5007"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5008"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-5009"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5010"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5011"></a>        <span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5012"></a><span class="k">        </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-5013"></a>      <span class="k">ELSE</span>
<a name="ln-5014"></a><span class="k">        </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-5015"></a>      <span class="n">ENDIF</span>
<a name="ln-5016"></a>    <span class="n">ENDIF</span>
<a name="ln-5017"></a>  <span class="k">ELSE</span>
<a name="ln-5018"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5019"></a>  <span class="n">ENDIF</span>
<a name="ln-5020"></a>
<a name="ln-5021"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5022"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilCapacityVariableSpeed: Could not find CoilType=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5023"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5024"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5025"></a>    <span class="n">CoilCapacity</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5026"></a>  <span class="n">ENDIF</span>
<a name="ln-5027"></a>
<a name="ln-5028"></a>  <span class="k">RETURN</span>
<a name="ln-5029"></a>
<a name="ln-5030"></a><span class="k">END FUNCTION </span><span class="n">GetCoilCapacityVariableSpeed</span>
<a name="ln-5031"></a>
<a name="ln-5032"></a><span class="k">FUNCTION </span><span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)</span>
<a name="ln-5033"></a>
<a name="ln-5034"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5035"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:GetCoilIndex</span>
<a name="ln-5036"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5037"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5038"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5039"></a>
<a name="ln-5040"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5041"></a>          <span class="c">! This function looks up the coil index for the given coil and returns it.  If</span>
<a name="ln-5042"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and index is returned</span>
<a name="ln-5043"></a>          <span class="c">! as zero.</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5046"></a>          <span class="c">! na</span>
<a name="ln-5047"></a>
<a name="ln-5048"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5049"></a>          <span class="c">! na</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5052"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5053"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5054"></a>
<a name="ln-5055"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5056"></a>
<a name="ln-5057"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5058"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5059"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5060"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5061"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IndexNum</span>     <span class="c">! returned index of matched coil</span>
<a name="ln-5062"></a>
<a name="ln-5063"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5064"></a>          <span class="c">! na</span>
<a name="ln-5065"></a>
<a name="ln-5066"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5067"></a>          <span class="c">! na</span>
<a name="ln-5068"></a>
<a name="ln-5069"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5070"></a>          <span class="c">! na</span>
<a name="ln-5071"></a>
<a name="ln-5072"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5073"></a>          <span class="c">! na</span>
<a name="ln-5074"></a>
<a name="ln-5075"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5076"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5077"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5078"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5079"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5080"></a>  <span class="k">End If</span>
<a name="ln-5081"></a>
<a name="ln-5082"></a><span class="k">  </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-5083"></a>
<a name="ln-5084"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IndexNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5085"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilIndexVariableSpeed: Could not find CoilType=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5086"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5087"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5088"></a>  <span class="n">ENDIF</span>
<a name="ln-5089"></a>
<a name="ln-5090"></a>  <span class="k">RETURN</span>
<a name="ln-5091"></a>
<a name="ln-5092"></a><span class="k">END FUNCTION </span><span class="n">GetCoilIndexVariableSpeed</span>
<a name="ln-5093"></a>
<a name="ln-5094"></a><span class="k">FUNCTION </span><span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilAirFlowRate</span><span class="p">)</span>
<a name="ln-5095"></a>
<a name="ln-5096"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5097"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:GetCoilAirFlowRate</span>
<a name="ln-5098"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5099"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5100"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5101"></a>
<a name="ln-5102"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5103"></a>          <span class="c">! This function looks up the max coil air flow rate for the given coil and returns it.  If</span>
<a name="ln-5104"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-5105"></a>          <span class="c">! as negative.</span>
<a name="ln-5106"></a>
<a name="ln-5107"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5108"></a>          <span class="c">! na</span>
<a name="ln-5109"></a>
<a name="ln-5110"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5111"></a>          <span class="c">! na</span>
<a name="ln-5112"></a>
<a name="ln-5113"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5114"></a><span class="c">!  USE FluidProperties, ONLY: FindGlycol</span>
<a name="ln-5115"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-5116"></a>
<a name="ln-5117"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5118"></a>
<a name="ln-5119"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5120"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5121"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5122"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CoilAirFlowRate</span> <span class="c">! returned air volume flow rate of matched coil</span>
<a name="ln-5124"></a>
<a name="ln-5125"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5126"></a>          <span class="c">! na</span>
<a name="ln-5127"></a>
<a name="ln-5128"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5129"></a>          <span class="c">! na</span>
<a name="ln-5130"></a>
<a name="ln-5131"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5132"></a>          <span class="c">! na</span>
<a name="ln-5133"></a>
<a name="ln-5134"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5135"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5136"></a>
<a name="ln-5137"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5138"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5139"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5140"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5141"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5142"></a>  <span class="k">End If</span>
<a name="ln-5143"></a>
<a name="ln-5144"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5145"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5146"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5147"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5148"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-5149"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5150"></a>      <span class="c">!CoilAirFlowRate=VarSpeedCoil(WhichCoil)%RatedAirVolFlowRate</span>
<a name="ln-5151"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">==</span> <span class="n">AUTOSIZE</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!means autosize</span>
<a name="ln-5152"></a>        <span class="n">CoilAirFlowRate</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-5153"></a>      <span class="k">ELSE</span>
<a name="ln-5154"></a><span class="k">        </span><span class="n">CoilAirFlowRate</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5155"></a>            <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5156"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-5157"></a>      <span class="k">END IF</span> <span class="c">! use largest air flow rate</span>
<a name="ln-5158"></a>    <span class="n">ENDIF</span>
<a name="ln-5159"></a>  <span class="k">ELSE</span>
<a name="ln-5160"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5161"></a>  <span class="n">ENDIF</span>
<a name="ln-5162"></a>
<a name="ln-5163"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5164"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilAirFlowRateVariableSpeed: Could not find CoilType=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5165"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5166"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5167"></a>    <span class="n">CoilAirFlowRate</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5168"></a>  <span class="n">ENDIF</span>
<a name="ln-5169"></a>
<a name="ln-5170"></a>  <span class="k">RETURN</span>
<a name="ln-5171"></a>
<a name="ln-5172"></a><span class="k">END FUNCTION </span><span class="n">GetCoilAirFlowRateVariableSpeed</span>
<a name="ln-5173"></a>
<a name="ln-5174"></a>
<a name="ln-5175"></a><span class="k">FUNCTION </span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-5176"></a>
<a name="ln-5177"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5178"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:GetCoilInletNode</span>
<a name="ln-5179"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5180"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5181"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5182"></a>
<a name="ln-5183"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5184"></a>          <span class="c">! This function looks up the given coil and returns the inlet node.  If</span>
<a name="ln-5185"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-5186"></a>          <span class="c">! as zero.</span>
<a name="ln-5187"></a>
<a name="ln-5188"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5189"></a>          <span class="c">! na</span>
<a name="ln-5190"></a>
<a name="ln-5191"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5192"></a>          <span class="c">! na</span>
<a name="ln-5193"></a>
<a name="ln-5194"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5195"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5196"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5197"></a>
<a name="ln-5198"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5199"></a>
<a name="ln-5200"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5201"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5202"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5203"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5204"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned outlet node of matched coil</span>
<a name="ln-5205"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5206"></a>          <span class="c">! na</span>
<a name="ln-5207"></a>
<a name="ln-5208"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5209"></a>          <span class="c">! na</span>
<a name="ln-5210"></a>
<a name="ln-5211"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5212"></a>          <span class="c">! na</span>
<a name="ln-5213"></a>
<a name="ln-5214"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5215"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5216"></a>
<a name="ln-5217"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5218"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5219"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5220"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5221"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5222"></a>  <span class="k">End If</span>
<a name="ln-5223"></a>
<a name="ln-5224"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5225"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5226"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-5227"></a>  <span class="n">ENDIF</span>
<a name="ln-5228"></a>
<a name="ln-5229"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5230"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilInletNodeVariableSpeed: Could not find CoilType=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5231"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5232"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5233"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5234"></a>  <span class="n">ENDIF</span>
<a name="ln-5235"></a>
<a name="ln-5236"></a>  <span class="k">RETURN</span>
<a name="ln-5237"></a>
<a name="ln-5238"></a><span class="k">END FUNCTION </span><span class="n">GetCoilInletNodeVariableSpeed</span>
<a name="ln-5239"></a>
<a name="ln-5240"></a>
<a name="ln-5241"></a><span class="k">FUNCTION </span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-5242"></a>
<a name="ln-5243"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5244"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:GetCoilOutletNode</span>
<a name="ln-5245"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5246"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5247"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5248"></a>
<a name="ln-5249"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5250"></a>          <span class="c">! This function looks up the given coil and returns the outlet node.  If</span>
<a name="ln-5251"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-5252"></a>          <span class="c">! as zero.</span>
<a name="ln-5253"></a>
<a name="ln-5254"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5255"></a>          <span class="c">! na</span>
<a name="ln-5256"></a>
<a name="ln-5257"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5258"></a>          <span class="c">! na</span>
<a name="ln-5259"></a>
<a name="ln-5260"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5261"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5262"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5263"></a>
<a name="ln-5264"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5265"></a>
<a name="ln-5266"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5267"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5268"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5269"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5270"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned outlet node of matched coil</span>
<a name="ln-5271"></a>
<a name="ln-5272"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5273"></a>          <span class="c">! na</span>
<a name="ln-5274"></a>
<a name="ln-5275"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5276"></a>          <span class="c">! na</span>
<a name="ln-5277"></a>
<a name="ln-5278"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5279"></a>          <span class="c">! na</span>
<a name="ln-5280"></a>
<a name="ln-5281"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5282"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5283"></a>
<a name="ln-5284"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5285"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5286"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5287"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5288"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5289"></a>  <span class="k">End If</span>
<a name="ln-5290"></a>
<a name="ln-5291"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5292"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5293"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-5294"></a>  <span class="n">ENDIF</span>
<a name="ln-5295"></a>
<a name="ln-5296"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5297"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilOutletNodeVariableSpeed: Could not find CoilType=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5298"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5299"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5300"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5301"></a>  <span class="n">ENDIF</span>
<a name="ln-5302"></a>
<a name="ln-5303"></a>  <span class="k">RETURN</span>
<a name="ln-5304"></a>
<a name="ln-5305"></a><span class="k">END FUNCTION </span><span class="n">GetCoilOutletNodeVariableSpeed</span>
<a name="ln-5306"></a>
<a name="ln-5307"></a><span class="k">FUNCTION </span><span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CondNode</span><span class="p">)</span>
<a name="ln-5308"></a>
<a name="ln-5309"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5310"></a>          <span class="c">!       AUTHOR         Bo Shen, based on DXCoil:GetCoilCondenserInletNode</span>
<a name="ln-5311"></a>          <span class="c">!       DATE WRITTEN   July 2012</span>
<a name="ln-5312"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5313"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5314"></a>
<a name="ln-5315"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5316"></a>          <span class="c">! This function looks up the given coil and returns the condenser inlet node.  If</span>
<a name="ln-5317"></a>          <span class="c">! incorrect coil  name is given, errorsfound is returned as true.</span>
<a name="ln-5318"></a>
<a name="ln-5319"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5320"></a>          <span class="c">! na</span>
<a name="ln-5321"></a>
<a name="ln-5322"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5323"></a>          <span class="c">! na</span>
<a name="ln-5324"></a>
<a name="ln-5325"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5326"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5327"></a>
<a name="ln-5328"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5329"></a>
<a name="ln-5330"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5331"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5332"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5333"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CondNode</span>     <span class="c">! returned condenser node number of matched coil</span>
<a name="ln-5334"></a>
<a name="ln-5335"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5336"></a>          <span class="c">! na</span>
<a name="ln-5337"></a>
<a name="ln-5338"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5339"></a>          <span class="c">! na</span>
<a name="ln-5340"></a>
<a name="ln-5341"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5342"></a>          <span class="c">! na</span>
<a name="ln-5343"></a>
<a name="ln-5344"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5345"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5346"></a>
<a name="ln-5347"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5348"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5349"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5350"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5351"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5352"></a>  <span class="k">End If</span>
<a name="ln-5353"></a>
<a name="ln-5354"></a><span class="k">   </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5355"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5356"></a><span class="k">    </span><span class="n">CondNode</span><span class="o">=</span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span>
<a name="ln-5357"></a>   <span class="k">ELSE</span>
<a name="ln-5358"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilCondenserInletNode: Invalid VS DX Coil, Type= VS DX Cooling Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5359"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5360"></a>    <span class="n">CondNode</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5361"></a>  <span class="n">ENDIF</span>
<a name="ln-5362"></a>
<a name="ln-5363"></a>  <span class="k">RETURN</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a><span class="k">END FUNCTION </span><span class="n">GetVSCoilCondenserInletNode</span>
<a name="ln-5366"></a>
<a name="ln-5367"></a>
<a name="ln-5368"></a><span class="k">FUNCTION </span><span class="n">GetVSCoilMinOATCompressor</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">MinOAT</span><span class="p">)</span>
<a name="ln-5369"></a>
<a name="ln-5370"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5371"></a>          <span class="c">!       AUTHOR         Bo Shen</span>
<a name="ln-5372"></a>          <span class="c">!       DATE WRITTEN   July 2012</span>
<a name="ln-5373"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5374"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5375"></a>
<a name="ln-5376"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5377"></a>          <span class="c">! This function looks up the given coil and returns min OAT for compressor operation.  If</span>
<a name="ln-5378"></a>          <span class="c">! incorrect coil  name is given, errorsfound is returned as true.</span>
<a name="ln-5379"></a>
<a name="ln-5380"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5381"></a>          <span class="c">! na</span>
<a name="ln-5382"></a>
<a name="ln-5383"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5384"></a>          <span class="c">! na</span>
<a name="ln-5385"></a>
<a name="ln-5386"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5387"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5388"></a>
<a name="ln-5389"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5390"></a>
<a name="ln-5391"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5392"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5393"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">MinOAT</span>     <span class="c">! returned min OAT for compressor operation</span>
<a name="ln-5395"></a>
<a name="ln-5396"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5397"></a>          <span class="c">! na</span>
<a name="ln-5398"></a>
<a name="ln-5399"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5400"></a>          <span class="c">! na</span>
<a name="ln-5401"></a>
<a name="ln-5402"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5403"></a>          <span class="c">! na</span>
<a name="ln-5404"></a>
<a name="ln-5405"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5406"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5407"></a>
<a name="ln-5408"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5409"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5410"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5411"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5412"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5413"></a>  <span class="k">End If</span>
<a name="ln-5414"></a>
<a name="ln-5415"></a><span class="k">   </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5416"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5417"></a><span class="k">    </span><span class="n">MinOAT</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">MinOATCompressor</span>
<a name="ln-5418"></a>   <span class="k">ELSE</span>
<a name="ln-5419"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetVSCoilMinOATCompressor: Invalid VS DX Coil, Type= VS DX Cooling Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5420"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5421"></a>    <span class="n">MinOAT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5422"></a>  <span class="n">ENDIF</span>
<a name="ln-5423"></a>
<a name="ln-5424"></a>  <span class="k">RETURN</span>
<a name="ln-5425"></a>
<a name="ln-5426"></a><span class="k">END FUNCTION </span><span class="n">GetVSCoilMinOATCompressor</span>
<a name="ln-5427"></a>
<a name="ln-5428"></a>
<a name="ln-5429"></a><span class="k">FUNCTION </span><span class="n">GetVSCoilNumOfSpeeds</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Speeds</span><span class="p">)</span>
<a name="ln-5430"></a>
<a name="ln-5431"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5432"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5433"></a>          <span class="c">!       DATE WRITTEN   March 2013</span>
<a name="ln-5434"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5435"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5438"></a>          <span class="c">! This function looks up the given coil and returns number of speeds.  If</span>
<a name="ln-5439"></a>          <span class="c">! incorrect coil name is given, errorsfound is returned as true.</span>
<a name="ln-5440"></a>
<a name="ln-5441"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5442"></a>          <span class="c">! na</span>
<a name="ln-5443"></a>
<a name="ln-5444"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5445"></a>          <span class="c">! na</span>
<a name="ln-5446"></a>
<a name="ln-5447"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5448"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5449"></a>
<a name="ln-5450"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5451"></a>
<a name="ln-5452"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5453"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5454"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5455"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">Speeds</span>     <span class="c">! returned number of speeds</span>
<a name="ln-5456"></a>
<a name="ln-5457"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5458"></a>          <span class="c">! na</span>
<a name="ln-5459"></a>
<a name="ln-5460"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5461"></a>          <span class="c">! na</span>
<a name="ln-5462"></a>
<a name="ln-5463"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5464"></a>          <span class="c">! na</span>
<a name="ln-5465"></a>
<a name="ln-5466"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5467"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5468"></a>
<a name="ln-5469"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5470"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5471"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5472"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5473"></a>  <span class="k">End If</span>
<a name="ln-5474"></a>
<a name="ln-5475"></a><span class="k">   </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">VarSpeedCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5476"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5477"></a><span class="k">    </span><span class="n">Speeds</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-5478"></a>   <span class="k">ELSE</span>
<a name="ln-5479"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetVSCoilNumOfSpeeds: Invalid VS DX Coil, Type= VS DX Cooling Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5480"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5481"></a>    <span class="n">Speeds</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5482"></a>  <span class="n">ENDIF</span>
<a name="ln-5483"></a>
<a name="ln-5484"></a>  <span class="k">RETURN</span>
<a name="ln-5485"></a>
<a name="ln-5486"></a><span class="k">END FUNCTION </span><span class="n">GetVSCoilNumOfSpeeds</span>
<a name="ln-5487"></a>
<a name="ln-5488"></a>
<a name="ln-5489"></a><span class="k">SUBROUTINE </span><span class="n">SetVarSpeedCoilData</span><span class="p">(</span><span class="n">WSHPNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CompanionCoolingCoilNum</span><span class="p">,</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)</span>
<a name="ln-5490"></a>
<a name="ln-5491"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5492"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:SetWSHPData</span>
<a name="ln-5493"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5494"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5495"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5496"></a>
<a name="ln-5497"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5498"></a>          <span class="c">! This routine was designed to &quot;push&quot; information from a parent object to</span>
<a name="ln-5499"></a>          <span class="c">! this WSHP coil object.</span>
<a name="ln-5500"></a>
<a name="ln-5501"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5502"></a>          <span class="c">! na</span>
<a name="ln-5503"></a>
<a name="ln-5504"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5505"></a>          <span class="c">! na</span>
<a name="ln-5506"></a>
<a name="ln-5507"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5508"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-5509"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-5510"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5511"></a>
<a name="ln-5512"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5513"></a>
<a name="ln-5514"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5515"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WSHPNum</span>  <span class="c">! Number of OA Controller</span>
<a name="ln-5516"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>    <span class="c">! Set to true if certain errors found</span>
<a name="ln-5517"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span>      <span class="kd">::</span> <span class="n">CompanionCoolingCoilNum</span>  <span class="c">! Index to cooling coil for heating coil = SimpleWSHPNum</span>
<a name="ln-5518"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span>      <span class="kd">::</span> <span class="n">CompanionHeatingCoilNum</span>  <span class="c">! Index to heating coil for cooling coil = SimpleWSHPNum</span>
<a name="ln-5519"></a>
<a name="ln-5520"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5521"></a>          <span class="c">! na</span>
<a name="ln-5522"></a>
<a name="ln-5523"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5524"></a>          <span class="c">! na</span>
<a name="ln-5525"></a>
<a name="ln-5526"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5527"></a>          <span class="c">! na</span>
<a name="ln-5528"></a>
<a name="ln-5529"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5530"></a>          <span class="c">! na</span>
<a name="ln-5531"></a>
<a name="ln-5532"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5533"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5534"></a>    <span class="k">CALL </span><span class="n">GetVarSpeedCoilInput</span>
<a name="ln-5535"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5536"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5537"></a>  <span class="k">End If</span>
<a name="ln-5538"></a>
<a name="ln-5539"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">WSHPNum</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">WSHPNum</span> <span class="o">&gt;</span> <span class="n">NumWatertoAirHPs</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5540"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetVarSpeedCoilData: called with VS WSHP Coil Number out of range=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5541"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WSHPNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be &gt;0 and &lt;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">)))</span>
<a name="ln-5542"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5543"></a>    <span class="k">RETURN</span>
<a name="ln-5544"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5545"></a>
<a name="ln-5546"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompanionCoolingCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5547"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WSHPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="o">=</span><span class="n">CompanionCoolingCoilNum</span>
<a name="ln-5548"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WSHPNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5549"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">WSHPNum</span>
<a name="ln-5550"></a>  <span class="n">ENDIF</span>
<a name="ln-5551"></a>
<a name="ln-5552"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompanionHeatingCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5553"></a><span class="k">    </span><span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">WSHPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">CompanionHeatingCoilNum</span>
<a name="ln-5554"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="o">=</span><span class="n">WSHPNum</span>
<a name="ln-5555"></a>  <span class="n">ENDIF</span>
<a name="ln-5556"></a>
<a name="ln-5557"></a>  <span class="k">RETURN</span>
<a name="ln-5558"></a>
<a name="ln-5559"></a><span class="k">END SUBROUTINE </span><span class="n">SetVarSpeedCoilData</span>
<a name="ln-5560"></a>
<a name="ln-5561"></a><span class="k">SUBROUTINE </span><span class="n">UpdateVarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5562"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5563"></a>          <span class="c">!       AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:UpdateSimpleWSHP</span>
<a name="ln-5564"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5565"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5566"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5567"></a>
<a name="ln-5568"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5569"></a>          <span class="c">! This subroutine updates the Water to Air Heat Pump outlet nodes.</span>
<a name="ln-5570"></a>
<a name="ln-5571"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5572"></a>          <span class="c">! Data is moved from the HP data structure to the HP outlet nodes.</span>
<a name="ln-5573"></a>
<a name="ln-5574"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5575"></a>          <span class="c">! na</span>
<a name="ln-5576"></a>
<a name="ln-5577"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5578"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-5579"></a>  <span class="k">USe </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-5580"></a>  <span class="k">USE </span><span class="n">DataContaminantBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Contaminant</span>
<a name="ln-5581"></a>
<a name="ln-5582"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5583"></a>
<a name="ln-5584"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5585"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>
<a name="ln-5586"></a>
<a name="ln-5587"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5588"></a>          <span class="c">! na</span>
<a name="ln-5589"></a>
<a name="ln-5590"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5591"></a>          <span class="c">! na</span>
<a name="ln-5592"></a>
<a name="ln-5593"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5594"></a>          <span class="c">! na</span>
<a name="ln-5595"></a>
<a name="ln-5596"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5597"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">AirInletNode</span>
<a name="ln-5598"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">WaterInletNode</span>
<a name="ln-5599"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">AirOutletNode</span>
<a name="ln-5600"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">WaterOutletNode</span>
<a name="ln-5601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-5602"></a>
<a name="ln-5603"></a>
<a name="ln-5604"></a>  <span class="c">!WatertoAirHP(DXCoilNum)%Simflag=.FALSE.</span>
<a name="ln-5605"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Simflag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5606"></a>    <span class="c">! Heatpump is off; just pass through conditions</span>
<a name="ln-5607"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5608"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5609"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5610"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5611"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5612"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5613"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5614"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5615"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5616"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5617"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">COP</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5618"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RunFrac</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5619"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5620"></a>
<a name="ln-5621"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>     <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-5622"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>     <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-5623"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>   <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-5624"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-5625"></a>    <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-5626"></a>  <span class="k">END IF</span>
<a name="ln-5627"></a>
<a name="ln-5628"></a><span class="k">  </span><span class="n">AirInletNode</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-5629"></a>  <span class="n">WaterInletNode</span>  <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-5630"></a>  <span class="n">AirOutletNode</span>   <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-5631"></a>  <span class="n">WaterOutletNode</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-5632"></a>
<a name="ln-5633"></a>
<a name="ln-5634"></a>  <span class="c">! Set the air outlet  nodes of the WatertoAirHPSimple</span>
<a name="ln-5635"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>     <span class="c">!LoadSideMassFlowRate</span>
<a name="ln-5636"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                  <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>
<a name="ln-5637"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>                <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-5638"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>              <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-5639"></a>
<a name="ln-5640"></a>   <span class="c">! Set the air outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-5641"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Quality</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-5642"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Press</span>                 <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-5643"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-5644"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>    <span class="c">!LoadSideMassFlowRate</span>
<a name="ln-5645"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-5646"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>     <span class="c">!LoadSideMassFlowRate</span>
<a name="ln-5647"></a>
<a name="ln-5648"></a>   <span class="c">! Set the water outlet node of the WatertoAirHPSimple</span>
<a name="ln-5649"></a>   <span class="c">! Set the water outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-5650"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterInletNode</span> <span class="o">/=</span><span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterOutletNode</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5651"></a><span class="k">    CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">WaterInletNode</span> <span class="p">,</span> <span class="n">WaterOutletNode</span><span class="p">)</span>
<a name="ln-5652"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>
<a name="ln-5653"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>            <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span>
<a name="ln-5654"></a>  <span class="k">END IF</span>
<a name="ln-5655"></a>
<a name="ln-5656"></a><span class="k">  </span><span class="n">ReportingConstant</span>                         <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-5657"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Energy</span>          <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5658"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5659"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySensible</span>  <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5660"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergyLatent</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5661"></a>  <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EnergySource</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5662"></a>
<a name="ln-5663"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">CO2Simulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5664"></a><span class="k">     </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-5665"></a>   <span class="k">End If</span>
<a name="ln-5666"></a>
<a name="ln-5667"></a><span class="k">  RETURN</span>
<a name="ln-5668"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateVarSpeedCoil</span>
<a name="ln-5669"></a>
<a name="ln-5670"></a><span class="k">FUNCTION </span><span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SHRss</span><span class="p">,</span> <span class="n">CyclingScheme</span><span class="p">,</span> <span class="n">RTF</span><span class="p">,</span> <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">EnteringDB</span><span class="p">,</span> <span class="n">EnteringWB</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SHReff</span><span class="p">)</span>
<a name="ln-5671"></a>
<a name="ln-5672"></a>        <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5673"></a>        <span class="c">!    AUTHOR         Bo Shen, based on WatertoAirHeatPumpSimple:CalcEffectiveSHR</span>
<a name="ln-5674"></a>        <span class="c">!    DATE WRITTEN   March 2012</span>
<a name="ln-5675"></a>        <span class="c">!    MODIFIED       na</span>
<a name="ln-5676"></a>        <span class="c">!    RE-ENGINEERED  na</span>
<a name="ln-5677"></a>
<a name="ln-5678"></a>        <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5679"></a>        <span class="c">!    Adjust sensible heat ratio to account for degradation of DX coil latent</span>
<a name="ln-5680"></a>        <span class="c">!    capacity at part-load (cycling) conditions.</span>
<a name="ln-5681"></a>
<a name="ln-5682"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5683"></a>        <span class="c">!    With model parameters entered by the user, the part-load latent performance</span>
<a name="ln-5684"></a>        <span class="c">!    of a DX cooling coil is determined for a constant air flow system with</span>
<a name="ln-5685"></a>        <span class="c">!    a cooling coil that cycles on/off. The model calculates the time</span>
<a name="ln-5686"></a>        <span class="c">!    required for condensate to begin falling from the cooling coil.</span>
<a name="ln-5687"></a>        <span class="c">!    Runtimes greater than this are integrated to a &quot;part-load&quot; latent</span>
<a name="ln-5688"></a>        <span class="c">!    capacity which is used to determine the &quot;part-load&quot; sensible heat ratio.</span>
<a name="ln-5689"></a>        <span class="c">!    See reference below for additional details (linear decay model, Eq. 8b).</span>
<a name="ln-5690"></a>
<a name="ln-5691"></a>        <span class="c">!    For cycling fan operation, a modified version of Henderson and Rengarajan (1996)</span>
<a name="ln-5692"></a>        <span class="c">!    model is used by ultilizing the fan delay time as the time-off (or time duration</span>
<a name="ln-5693"></a>        <span class="c">!    for the re-evaporation of moisture from time coil). Refer to Tang, C.C. (2005)</span>
<a name="ln-5694"></a>
<a name="ln-5695"></a>        <span class="c">! REFERENCES:</span>
<a name="ln-5696"></a>        <span class="c">! na</span>
<a name="ln-5697"></a>
<a name="ln-5698"></a>
<a name="ln-5699"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5700"></a>
<a name="ln-5701"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5702"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>         <span class="c">! Index number for cooling coil</span>
<a name="ln-5703"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span> <span class="c">! Fan/compressor cycling scheme indicator</span>
<a name="ln-5704"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRss</span>         <span class="c">! Steady-state sensible heat ratio</span>
<a name="ln-5705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RTF</span>           <span class="c">! Compressor run-time fraction</span>
<a name="ln-5706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>     <span class="c">! Rated latent capacity</span>
<a name="ln-5707"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>    <span class="c">! Actual latent capacity</span>
<a name="ln-5708"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringDB</span>    <span class="c">! Entering air dry-bulb temperature</span>
<a name="ln-5709"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringWB</span>    <span class="c">! Entering air wet-bulb temperature</span>
<a name="ln-5710"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SHReff</span>        <span class="c">! Effective sensible heat ratio, includes degradation due to cycling effects</span>
<a name="ln-5711"></a>
<a name="ln-5712"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5713"></a>          <span class="c">! na</span>
<a name="ln-5714"></a>
<a name="ln-5715"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5716"></a>          <span class="c">! na</span>
<a name="ln-5717"></a>
<a name="ln-5718"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5719"></a>          <span class="c">! na</span>
<a name="ln-5720"></a>
<a name="ln-5721"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5722"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet</span>                 <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s condensate drain line</span>
<a name="ln-5723"></a>                                    <span class="c">! at the current operating conditions (sec)</span>
<a name="ln-5724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">Gamma</span>                <span class="c">! Initial moisture evaporation rate divided by steady-state AC latent capacity</span>
<a name="ln-5725"></a>                                    <span class="c">! at the current operating conditions</span>
<a name="ln-5726"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_rated</span>           <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-5727"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_rated</span>          <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-5728"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_max</span>             <span class="c">! Maximum allowed value for Twet</span>
<a name="ln-5729"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>  <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-5730"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>       <span class="c">! Heat pump time constant [s]</span>
<a name="ln-5731"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>         <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-5732"></a>                                    <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-5733"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ton</span>                  <span class="c">! Coil on time (sec)</span>
<a name="ln-5734"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toff</span>                 <span class="c">! Coil off time (sec)</span>
<a name="ln-5735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toffa</span>                <span class="c">! Actual coil off time (sec). Equations valid for Toff &lt;= (2.0 * Twet/Gamma)</span>
<a name="ln-5736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aa</span>                   <span class="c">! Intermediate variable</span>
<a name="ln-5737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To1</span>                  <span class="c">! Intermediate variable (first guess at To). To = time to the start of moisture removal</span>
<a name="ln-5738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To2</span>                  <span class="c">! Intermediate variable (second guess at To). To = time to the start of moisture removal</span>
<a name="ln-5739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Error</span>                <span class="c">! Error for iteration (DO) loop</span>
<a name="ln-5740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LHRmult</span>              <span class="c">! Latent Heat Ratio (LHR) multiplier. The effective latent heat ratio LHR = (1-SHRss)*LHRmult</span>
<a name="ln-5741"></a>
<a name="ln-5742"></a>   <span class="n">Twet_rated</span>               <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_Rated</span>
<a name="ln-5743"></a>   <span class="n">Gamma_rated</span>              <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span>
<a name="ln-5744"></a>   <span class="n">MaxONOFFCyclesperHour</span>    <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-5745"></a>   <span class="n">HPTimeConstant</span>           <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>
<a name="ln-5746"></a>   <span class="n">FanDelayTime</span>             <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanDelayTime</span>
<a name="ln-5747"></a>
<a name="ln-5748"></a><span class="c">!  No moisture evaporation (latent degradation) occurs for runtime fraction of 1.0</span>
<a name="ln-5749"></a><span class="c">!  All latent degradation model parameters cause divide by 0.0 if not greater than 0.0</span>
<a name="ln-5750"></a><span class="c">!  Latent degradation model parameters initialize to 0.0 meaning no evaporation model used.</span>
<a name="ln-5751"></a>   <span class="k">IF</span><span class="p">((</span><span class="n">RTF</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatRated</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatActual</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Twet_rated</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5752"></a>      <span class="p">(</span><span class="n">Gamma_rated</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">HPTimeConstant</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">RTF</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5753"></a><span class="k">     </span><span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span>
<a name="ln-5754"></a>     <span class="k">RETURN</span>
<a name="ln-5755"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-5756"></a>
<a name="ln-5757"></a>   <span class="n">Twet_max</span>   <span class="o">=</span> <span class="mi">999</span><span class="mf">9.0d0</span> <span class="c">! high limit for Twet</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a><span class="c">!  Calculate the model parameters at the actual operating conditions</span>
<a name="ln-5760"></a>   <span class="n">Twet</span>    <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Twet_rated</span><span class="o">*</span><span class="n">QLatRated</span> <span class="o">/</span><span class="p">(</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">),</span><span class="n">Twet_max</span><span class="p">)</span>
<a name="ln-5761"></a>   <span class="nb">Gamma</span>   <span class="o">=</span> <span class="n">Gamma_rated</span><span class="o">*</span><span class="n">QLatRated</span><span class="o">*</span><span class="p">(</span><span class="n">EnteringDB</span><span class="o">-</span><span class="n">EnteringWB</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="mf">6.7d0</span><span class="o">-</span><span class="mi">1</span><span class="mf">9.4d0</span><span class="p">)</span><span class="o">*</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">)</span>
<a name="ln-5762"></a>
<a name="ln-5763"></a><span class="c">!  Calculate the compressor on and off times using a converntional thermostat curve</span>
<a name="ln-5764"></a>   <span class="n">Ton</span>  <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RTF</span><span class="p">))</span>   <span class="c">! duration of cooling coil on-cycle (sec)</span>
<a name="ln-5765"></a>
<a name="ln-5766"></a>   <span class="k">IF</span> <span class="p">((</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">FanDelayTime</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5767"></a>    <span class="c">! For CycFanCycCoil, moisture is evaporated from the cooling coil back to the air stream</span>
<a name="ln-5768"></a>    <span class="c">! until the fan cycle off. Assume no evaporation from the coil after the fan shuts off.</span>
<a name="ln-5769"></a>        <span class="n">Toff</span> <span class="o">=</span> <span class="n">FanDelayTime</span>
<a name="ln-5770"></a>   <span class="k">ELSE</span>
<a name="ln-5771"></a>    <span class="c">! For ContFanCycCoil, moisture is evaporated from the cooling coil back to the air stream</span>
<a name="ln-5772"></a>    <span class="c">! for the entire heat pump off-cycle.</span>
<a name="ln-5773"></a>        <span class="n">Toff</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">*</span><span class="n">RTF</span><span class="p">)</span>        <span class="c">! duration of cooling coil off-cycle (sec)</span>
<a name="ln-5774"></a>   <span class="k">END IF</span>
<a name="ln-5775"></a>
<a name="ln-5776"></a><span class="c">!  Cap Toff to meet the equation restriction</span>
<a name="ln-5777"></a>   <span class="k">IF</span><span class="p">(</span><span class="nb">Gamma</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5778"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Toff</span><span class="p">,</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Twet</span><span class="o">/</span><span class="nb">Gamma</span><span class="p">)</span>
<a name="ln-5779"></a>   <span class="k">ELSE</span>
<a name="ln-5780"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="n">Toff</span>
<a name="ln-5781"></a>   <span class="k">END IF</span>
<a name="ln-5782"></a>
<a name="ln-5783"></a><span class="c">!  Use sucessive substitution to solve for To</span>
<a name="ln-5784"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Gamma</span><span class="o">*</span><span class="n">Toffa</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.25d0</span><span class="o">/</span><span class="n">Twet</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">Gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Toffa</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5785"></a>
<a name="ln-5786"></a>   <span class="n">To1</span> <span class="o">=</span> <span class="n">aa</span><span class="o">+</span><span class="n">HPTimeConstant</span>
<a name="ln-5787"></a>   <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5788"></a>   <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Error</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-5789"></a>       <span class="n">To2</span> <span class="o">=</span> <span class="n">aa</span><span class="o">-</span><span class="n">HPTimeConstant</span><span class="o">*</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">To1</span><span class="o">/</span><span class="n">HPTimeConstant</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-5790"></a>       <span class="n">Error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">To2</span><span class="o">-</span><span class="n">To1</span><span class="p">)</span><span class="o">/</span><span class="n">To1</span><span class="p">)</span>
<a name="ln-5791"></a>       <span class="n">To1</span> <span class="o">=</span> <span class="n">To2</span>
<a name="ln-5792"></a>   <span class="k">END DO</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a><span class="c">!  Adjust Sensible Heat Ratio (SHR) using Latent Heat Ratio (LHR) multiplier</span>
<a name="ln-5795"></a><span class="c">!  Floating underflow errors occur when -Ton/HPTimeConstant is a large negative number.</span>
<a name="ln-5796"></a><span class="c">!  Cap lower limit at -700 to avoid the underflow errors.</span>
<a name="ln-5797"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="mf">0.0d0</span><span class="p">,</span><span class="o">-</span><span class="n">Ton</span><span class="o">/</span><span class="n">HPTimeConstant</span><span class="p">))</span>
<a name="ln-5798"></a><span class="c">!  Calculate latent heat ratio multiplier</span>
<a name="ln-5799"></a>   <span class="n">LHRmult</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(((</span><span class="n">Ton</span><span class="o">-</span><span class="n">To2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Ton</span><span class="o">+</span><span class="n">HPTimeConstant</span><span class="o">*</span><span class="p">(</span><span class="n">aa</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-5800"></a>
<a name="ln-5801"></a><span class="c">!  Calculate part-load or &quot;effective&quot; sensible heat ratio</span>
<a name="ln-5802"></a>   <span class="n">SHReff</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SHRss</span><span class="p">)</span><span class="o">*</span><span class="n">LHRmult</span>
<a name="ln-5803"></a>
<a name="ln-5804"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SHRss</span><span class="p">)</span> <span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span> <span class="c">! Effective SHR can be less than the steady-state SHR</span>
<a name="ln-5805"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHReff</span><span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Effective sensible heat ratio can&#39;t be greater than 1.0</span>
<a name="ln-5806"></a>
<a name="ln-5807"></a> <span class="k">RETURN</span>
<a name="ln-5808"></a>
<a name="ln-5809"></a><span class="k">END FUNCTION </span><span class="n">CalcEffectiveSHR</span>
<a name="ln-5810"></a>
<a name="ln-5811"></a><span class="k">SUBROUTINE </span><span class="n">CalcTotCapSHR_VSWSHP</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">InletHumRat</span><span class="p">,</span><span class="n">InletEnthalpy</span><span class="p">,</span><span class="n">InletWetBulb</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="n">WaterMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5812"></a>                         <span class="n">AirMassFlow</span><span class="p">,</span><span class="n">CBF</span><span class="p">,</span> <span class="n">TotCapNom1</span><span class="p">,</span><span class="n">CCapFTemp1</span><span class="p">,</span><span class="n">CCapAirFFlow1</span><span class="p">,</span> <span class="n">CCapWaterFFlow1</span><span class="p">,&amp;</span>
<a name="ln-5813"></a>                          <span class="n">TotCapNom2</span><span class="p">,</span><span class="n">CCapFTemp2</span><span class="p">,</span><span class="n">CCapAirFFlow2</span><span class="p">,</span> <span class="n">CCapWaterFFlow2</span><span class="p">,&amp;</span>
<a name="ln-5814"></a>                         <span class="n">TotCap1</span><span class="p">,</span> <span class="n">TotCap2</span><span class="p">,</span> <span class="n">TotCapSpeed</span><span class="p">,</span><span class="n">SHR</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">NumSpeeds</span><span class="p">)</span>
<a name="ln-5815"></a>
<a name="ln-5816"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5817"></a>          <span class="c">!       AUTHOR         Bo Shen, , based on DX:CalcTotCapSHR, introducing two speed levels</span>
<a name="ln-5818"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-5819"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5820"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5821"></a>
<a name="ln-5822"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5823"></a>          <span class="c">! Calculates total capacity and sensible heat ratio of a DX coil at the specified conditions</span>
<a name="ln-5824"></a>
<a name="ln-5825"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5826"></a>          <span class="c">! With the rated performance data entered by the user, the model employs some of the</span>
<a name="ln-5827"></a>          <span class="c">! DOE-2.1E curve fits to adjust the capacity and SHR of the unit as a function</span>
<a name="ln-5828"></a>          <span class="c">! of entering air temperatures and supply air flow rate (actual vs rated flow). The model</span>
<a name="ln-5829"></a>          <span class="c">! does NOT employ the exact same methodology to calculate performance as DOE-2, although</span>
<a name="ln-5830"></a>          <span class="c">! some of the DOE-2 curve fits are employed by this model.</span>
<a name="ln-5831"></a>
<a name="ln-5832"></a>          <span class="c">! The model checks for coil dryout conditions, and adjusts the calculated performance</span>
<a name="ln-5833"></a>          <span class="c">! appropriately.</span>
<a name="ln-5834"></a>
<a name="ln-5835"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5836"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit page 4-81.</span>
<a name="ln-5837"></a>          <span class="c">!</span>
<a name="ln-5838"></a>          <span class="c">! Henderson, H.I. Jr., K. Rengarajan and D.B. Shirey, III. 1992.The impact of comfort</span>
<a name="ln-5839"></a>          <span class="c">! control on air conditioner energy use in humid climates. ASHRAE Transactions 98(2):</span>
<a name="ln-5840"></a>          <span class="c">! 104-113.</span>
<a name="ln-5841"></a>          <span class="c">!</span>
<a name="ln-5842"></a>          <span class="c">! Henderson, H.I. Jr., Danny Parker and Y.J. Huang. 2000.Improving DOE-2&#39;s RESYS routine:</span>
<a name="ln-5843"></a>          <span class="c">! User Defined Functions to Provide More Accurate Part Load Energy Use and Humidity</span>
<a name="ln-5844"></a>          <span class="c">! Predictions. Proceedings of ACEEE Conference.</span>
<a name="ln-5845"></a>
<a name="ln-5846"></a>
<a name="ln-5847"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5848"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-5849"></a>
<a name="ln-5850"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5851"></a>
<a name="ln-5852"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5853"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletDryBulb</span>       <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-5854"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletHumRat</span>        <span class="c">! inlet air humidity ratio [kg water / kg dry air]</span>
<a name="ln-5855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletEnthalpy</span>      <span class="c">! inlet air specific enthalpy [J/kg]</span>
<a name="ln-5856"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWetBulb</span>       <span class="c">! inlet air wet bulb temperature [C]</span>
<a name="ln-5857"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>   <span class="c">! Ratio of actual air mass flow to nominal air mass flow</span>
<a name="ln-5858"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatio</span>   <span class="c">! Ratio of actual water mass flow to nominal water mass flow</span>
<a name="ln-5859"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>        <span class="c">! actual mass flow for capacity and SHR calculation</span>
<a name="ln-5860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBF</span>                <span class="c">! coil bypass factor</span>
<a name="ln-5861"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumSpeeds</span>            <span class="c">! number of speeds for input</span>
<a name="ln-5862"></a>
<a name="ln-5863"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapNom1</span>         <span class="c">! nominal total capacity at low speed [W]</span>
<a name="ln-5864"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapFTemp1</span>           <span class="c">! capacity modifier curve index, function of entering wetbulb at low speed</span>
<a name="ln-5865"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapAirFFlow1</span>        <span class="c">! capacity modifier curve, function of actual air flow vs rated flow at low speed</span>
<a name="ln-5866"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapWaterFFlow1</span>      <span class="c">! capacity modifier curve, function of actual water flow vs rated flow at low speed</span>
<a name="ln-5867"></a>
<a name="ln-5868"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapNom2</span>         <span class="c">! nominal total capacity at high speed [W]</span>
<a name="ln-5869"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapFTemp2</span>           <span class="c">! capacity modifier curve index, function of entering wetbulb at high speed</span>
<a name="ln-5870"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapAirFFlow2</span>        <span class="c">! capacity modifier curve, function of actual air flow vs rated flow at high speed</span>
<a name="ln-5871"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapWaterFFlow2</span>      <span class="c">! capacity modifier curve, function of actual water flow vs rated flow at high speed</span>
<a name="ln-5872"></a>
<a name="ln-5873"></a>
<a name="ln-5874"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TotCap1</span>           <span class="c">! total capacity at the given conditions [W] at low speed</span>
<a name="ln-5875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TotCap2</span>           <span class="c">! total capacity at the given conditions [W] at high speed</span>
<a name="ln-5876"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TotCapSpeed</span>       <span class="c">! integrated total capacity corresponding to the speed ratio</span>
<a name="ln-5877"></a>
<a name="ln-5878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SHR</span>               <span class="c">! sensible heat ratio at the given conditions</span>
<a name="ln-5879"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>      <span class="c">! Condenser inlet temperature [C]</span>
<a name="ln-5880"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pressure</span>           <span class="c">! air pressure [Pa]</span>
<a name="ln-5881"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>         <span class="c">! from 0.0 to 1.0</span>
<a name="ln-5882"></a>
<a name="ln-5883"></a>
<a name="ln-5884"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5885"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcTotCapSHR_VSWSHP&#39;</span>
<a name="ln-5886"></a>
<a name="ln-5887"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5888"></a>          <span class="c">! na</span>
<a name="ln-5889"></a>
<a name="ln-5890"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5891"></a>          <span class="c">! na</span>
<a name="ln-5892"></a>
<a name="ln-5893"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWetBulbCalc</span>    <span class="c">! calculated inlet wetbulb temperature used for finding dry coil point [C]</span>
<a name="ln-5895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletHumRatCalc</span>     <span class="c">! calculated inlet humidity ratio used for finding dry coil point [kg water / kg dry air]</span>
<a name="ln-5896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac1</span>
<a name="ln-5897"></a>  <span class="c">! Total capacity modifier (function of entering wetbulb, outside water inlet temp) at low speed</span>
<a name="ln-5898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapAirFlowModFac1</span>
<a name="ln-5899"></a>  <span class="c">! Total capacity modifier (function of actual supply air flow vs nominal flow) at low speed</span>
<a name="ln-5900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapWaterFlowModFac1</span>
<a name="ln-5901"></a>  <span class="c">! Total capacity modifier (function of actual supply water flow vs nominal flow) at low speed</span>
<a name="ln-5902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac2</span>
<a name="ln-5903"></a>  <span class="c">! Total capacity modifier (function of entering wetbulb, outside water inlet temp) at high speed</span>
<a name="ln-5904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapAirFlowModFac2</span>
<a name="ln-5905"></a>  <span class="c">! Total capacity modifier (function of actual supply air flow vs nominal flow) at high speed</span>
<a name="ln-5906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapWaterFlowModFac2</span>
<a name="ln-5907"></a>  <span class="c">! Total capacity modifier (function of actual supply water flow vs nominal flow) at high speed</span>
<a name="ln-5908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hDelta</span>              <span class="c">! Change in air enthalpy across the cooling coil [J/kg]</span>
<a name="ln-5909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>                <span class="c">! Apparatus dew point enthalpy [J/kg]</span>
<a name="ln-5910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>                <span class="c">! Apparatus dew point temperature [C]</span>
<a name="ln-5911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>                <span class="c">! Apparatus dew point humidity ratio [kg/kg]</span>
<a name="ln-5912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>            <span class="c">! Enthalpy at inlet dry-bulb and wADP [J/kg]</span>
<a name="ln-5913"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRCalc</span>             <span class="c">! temporary calculated value of SHR</span>
<a name="ln-5914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapCalc</span>          <span class="c">! temporary calculated value of total capacity [W]</span>
<a name="ln-5915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapCalc1</span>          <span class="c">! temporary calculated value of total capacity [W] at low speed</span>
<a name="ln-5916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapCalc2</span>          <span class="c">! temporary calculated value of total capacity [W] at high speed</span>
<a name="ln-5917"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Counter</span>             <span class="c">! Counter for dry evaporator iterations</span>
<a name="ln-5918"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxIter</span>             <span class="c">! Maximum number of iterations for dry evaporator calculations</span>
<a name="ln-5919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RF</span>                  <span class="c">! Relaxation factor for dry evaporator iterations</span>
<a name="ln-5920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tolerance</span>           <span class="c">! Error tolerance for dry evaporator iterations</span>
<a name="ln-5921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>              <span class="c">! Deviation of humidity ratio in dry evaporator iteration loop</span>
<a name="ln-5922"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">LoopOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>     <span class="c">! flag to control the loop iteration</span>
<a name="ln-5923"></a>
<a name="ln-5924"></a>  <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">30</span>
<a name="ln-5925"></a>  <span class="n">RF</span> <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-5926"></a>  <span class="n">Counter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5927"></a>  <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">0.01d0</span>
<a name="ln-5928"></a>  <span class="n">werror</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5929"></a>
<a name="ln-5930"></a>  <span class="n">InletWetBulbCalc</span> <span class="o">=</span> <span class="n">InletWetBulb</span>
<a name="ln-5931"></a>  <span class="n">InletHumRatCalc</span> <span class="o">=</span> <span class="n">InletHumRat</span>
<a name="ln-5932"></a>  <span class="n">LoopOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5933"></a>
<a name="ln-5934"></a><span class="c">!  DO WHILE (ABS(werror) .gt. Tolerance .OR. Counter == 0)</span>
<a name="ln-5935"></a><span class="c">!   Get capacity modifying factor (function of inlet wetbulb &amp; outside drybulb) for off-rated conditions</span>
<a name="ln-5936"></a>  <span class="k">DO WHILE</span><span class="p">(</span><span class="n">LoopOn</span><span class="p">)</span>
<a name="ln-5937"></a>    <span class="n">TotCapTempModFac1</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapFTemp1</span><span class="p">,</span><span class="n">InletWetBulbCalc</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-5938"></a><span class="c">!   Get capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-5939"></a>    <span class="n">TotCapAirFlowModFac1</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapAirFFlow1</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-5940"></a>    <span class="c">!Get capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-5941"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CCapWaterFFlow1</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5942"></a><span class="k">        </span><span class="n">TotCapWaterFlowModFac1</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5943"></a>    <span class="k">ELSE</span>
<a name="ln-5944"></a><span class="k">        </span><span class="n">TotCapWaterFlowModFac1</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapWaterFFlow1</span><span class="p">,</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-5945"></a>    <span class="k">END IF</span>
<a name="ln-5946"></a>
<a name="ln-5947"></a><span class="c">!   Get total capacity</span>
<a name="ln-5948"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">NumSpeeds</span>  <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!ONLY ONE SPEED</span>
<a name="ln-5949"></a>        <span class="n">TotCapCalc</span> <span class="o">=</span> <span class="n">TotCapNom1</span> <span class="o">*</span> <span class="n">TotCapAirFlowModFac1</span> <span class="o">*</span> <span class="n">TotCapWaterFlowModFac1</span> <span class="o">*</span> <span class="n">TotCapTempModFac1</span>
<a name="ln-5950"></a>        <span class="n">TotCapCalc1</span> <span class="o">=</span> <span class="n">TotCapCalc</span>
<a name="ln-5951"></a>        <span class="n">TotCapCalc2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5952"></a>    <span class="k">ELSE</span>
<a name="ln-5953"></a><span class="k">        </span><span class="n">TotCapTempModFac2</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapFTemp2</span><span class="p">,</span><span class="n">InletWetBulbCalc</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-5954"></a>        <span class="n">TotCapAirFlowModFac2</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapAirFFlow2</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-5955"></a>
<a name="ln-5956"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CCapWaterFFlow2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5957"></a><span class="k">            </span><span class="n">TotCapWaterFlowModFac2</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5958"></a>        <span class="k">ELSE</span>
<a name="ln-5959"></a><span class="k">            </span><span class="n">TotCapWaterFlowModFac2</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapWaterFFlow2</span><span class="p">,</span><span class="n">WaterMassFlowRatio</span><span class="p">)</span>
<a name="ln-5960"></a>        <span class="k">END IF</span>
<a name="ln-5961"></a>
<a name="ln-5962"></a><span class="k">        </span><span class="n">TotCapCalc1</span> <span class="o">=</span> <span class="n">TotCapNom1</span> <span class="o">*</span> <span class="n">TotCapAirFlowModFac1</span> <span class="o">*</span> <span class="n">TotCapWaterFlowModFac1</span> <span class="o">*</span> <span class="n">TotCapTempModFac1</span>
<a name="ln-5963"></a>        <span class="n">TotCapCalc2</span> <span class="o">=</span> <span class="n">TotCapNom2</span> <span class="o">*</span> <span class="n">TotCapAirFlowModFac2</span> <span class="o">*</span> <span class="n">TotCapWaterFlowModFac2</span> <span class="o">*</span> <span class="n">TotCapTempModFac2</span>
<a name="ln-5964"></a>
<a name="ln-5965"></a>        <span class="n">TotCapCalc</span> <span class="o">=</span> <span class="n">TotCapCalc2</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SpeedRatio</span> <span class="p">)</span> <span class="o">*</span> <span class="n">TotCapCalc1</span>
<a name="ln-5966"></a>
<a name="ln-5967"></a>    <span class="k">END IF</span>
<a name="ln-5968"></a>
<a name="ln-5969"></a><span class="c">!   Calculate apparatus dew point conditions using TotCap and CBF</span>
<a name="ln-5970"></a>    <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCapCalc</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-5971"></a>    <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-5972"></a>    <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">Pressure</span><span class="p">)</span>
<a name="ln-5973"></a>    <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">)</span>
<a name="ln-5974"></a>    <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">wADP</span><span class="p">)</span>
<a name="ln-5975"></a>    <span class="n">SHRCalc</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-5976"></a><span class="c">!</span>
<a name="ln-5977"></a><span class="c">!   Check for dry evaporator conditions (win &lt; wadp)</span>
<a name="ln-5978"></a><span class="c">!</span>
<a name="ln-5979"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">wADP</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">InletHumRatCalc</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5980"></a><span class="k">      If</span><span class="p">(</span><span class="n">InletHumRatCalc</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">InletHumRatCalc</span><span class="o">=</span><span class="mf">0.00001d0</span>
<a name="ln-5981"></a>      <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">InletHumRatCalc</span> <span class="o">-</span> <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">InletHumRatCalc</span>
<a name="ln-5982"></a><span class="c">!</span>
<a name="ln-5983"></a><span class="c">!     Increase InletHumRatCalc at constant inlet air temp to find coil dry-out point. Then use the</span>
<a name="ln-5984"></a><span class="c">!     capacity at the dry-out point to determine exiting conditions from coil. This is required</span>
<a name="ln-5985"></a><span class="c">!     since the TotCapTempModFac doesn&#39;t work properly with dry-coil conditions.</span>
<a name="ln-5986"></a><span class="c">!</span>
<a name="ln-5987"></a>      <span class="n">InletHumRatCalc</span> <span class="o">=</span> <span class="n">RF</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RF</span><span class="p">)</span><span class="o">*</span><span class="n">InletHumRatCalc</span>
<a name="ln-5988"></a>      <span class="n">InletWetBulbCalc</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">InletHumRatCalc</span><span class="p">,</span><span class="n">Pressure</span><span class="p">)</span>
<a name="ln-5989"></a>      <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5990"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5991"></a><span class="k">        </span><span class="n">LoopOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">!go to 50   ! Recalculate with modified inlet conditions</span>
<a name="ln-5992"></a>      <span class="k">ELSE</span>
<a name="ln-5993"></a><span class="k">        </span><span class="n">LoopOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5994"></a>      <span class="k">END IF</span>
<a name="ln-5995"></a><span class="k">    ELSE</span>
<a name="ln-5996"></a><span class="k">      </span><span class="n">LoopOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5997"></a>    <span class="k">END IF</span>
<a name="ln-5998"></a><span class="k">  END DO</span>
<a name="ln-5999"></a>
<a name="ln-6000"></a><span class="c">! END DO</span>
<a name="ln-6001"></a>
<a name="ln-6002"></a><span class="c">!  Calculate full load output conditions</span>
<a name="ln-6003"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SHRCalc</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHRCalc</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-6004"></a>
<a name="ln-6005"></a>  <span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRCalc</span>
<a name="ln-6006"></a>  <span class="n">TotCap1</span> <span class="o">=</span> <span class="n">TotCapCalc1</span>
<a name="ln-6007"></a>  <span class="n">TotCap2</span> <span class="o">=</span> <span class="n">TotCapCalc2</span>
<a name="ln-6008"></a>  <span class="n">TotCapSpeed</span> <span class="o">=</span> <span class="n">TotCapCalc</span>
<a name="ln-6009"></a>
<a name="ln-6010"></a> <span class="c">! IF(SHR &lt; 0.3d0) SHR = 0.3d0</span>
<a name="ln-6011"></a>
<a name="ln-6012"></a>  <span class="k">RETURN</span>
<a name="ln-6013"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTotCapSHR_VSWSHP</span>
<a name="ln-6014"></a>
<a name="ln-6015"></a><span class="k">FUNCTION </span><span class="n">AdjustCBF</span><span class="p">(</span><span class="n">CBFNom</span><span class="p">,</span><span class="n">AirMassFlowRateNom</span><span class="p">,</span><span class="n">AirMassFlowRate</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CBFAdj</span><span class="p">)</span>
<a name="ln-6016"></a>
<a name="ln-6017"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-6018"></a>          <span class="c">!       AUTHOR         Fred Buhl using Don Shirey&#39;s code</span>
<a name="ln-6019"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-6020"></a>          <span class="c">!       Modified       BOs March 2012</span>
<a name="ln-6021"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6022"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6023"></a>
<a name="ln-6024"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-6025"></a>          <span class="c">!    Adjust coil bypass factor for actual air flow rate.</span>
<a name="ln-6026"></a>
<a name="ln-6027"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6028"></a>          <span class="c">! Uses relation CBF = exp(-NTU) whereNTU = A0/(m*cp). Relationship models the cooling coil</span>
<a name="ln-6029"></a>          <span class="c">! as a heat exchanger with Cmin/Cmax = 0.</span>
<a name="ln-6030"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6031"></a>          <span class="c">! na</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6034"></a>          <span class="c">! na</span>
<a name="ln-6035"></a>
<a name="ln-6036"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6037"></a>
<a name="ln-6038"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-6039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFNom</span>                <span class="c">! nominal coil bypass factor</span>
<a name="ln-6040"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRateNom</span>    <span class="c">! nominal air mass flow rate [kg/s]</span>
<a name="ln-6041"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>       <span class="c">! actual air mass flow rate [kg/s]</span>
<a name="ln-6042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CBFAdj</span>                <span class="c">! the result - the adjusted coil bypass factor</span>
<a name="ln-6043"></a>
<a name="ln-6044"></a>
<a name="ln-6045"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-6046"></a>          <span class="c">! na</span>
<a name="ln-6047"></a>
<a name="ln-6048"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6049"></a>          <span class="c">! na</span>
<a name="ln-6050"></a>
<a name="ln-6051"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6052"></a>          <span class="c">! na</span>
<a name="ln-6053"></a>
<a name="ln-6054"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A0</span>  <span class="c">! intermediate variable</span>
<a name="ln-6056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADiff</span>  <span class="c">! intermediate variable</span>
<a name="ln-6057"></a>
<a name="ln-6058"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CBFNom</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6059"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="o">-</span><span class="nb">log</span><span class="p">(</span><span class="n">CBFNom</span><span class="p">)</span><span class="o">*</span><span class="n">AirMassFlowRateNom</span>
<a name="ln-6060"></a>  <span class="k">ELSE</span>
<a name="ln-6061"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6062"></a>  <span class="k">END IF</span>
<a name="ln-6063"></a><span class="k">  </span><span class="n">ADiff</span><span class="o">=-</span><span class="n">A0</span><span class="o">/</span><span class="n">AirMassFlowRate</span>
<a name="ln-6064"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ADiff</span> <span class="o">&gt;=</span> <span class="n">EXP_LowerLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6065"></a><span class="k">     </span><span class="n">CBFAdj</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">ADiff</span><span class="p">)</span>
<a name="ln-6066"></a>  <span class="k">ELSE</span>
<a name="ln-6067"></a><span class="k">     </span><span class="n">CBFAdj</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6068"></a>  <span class="k">END IF</span>
<a name="ln-6069"></a>
<a name="ln-6070"></a><span class="k">  RETURN</span>
<a name="ln-6071"></a><span class="k">END FUNCTION </span><span class="n">AdjustCBF</span>
<a name="ln-6072"></a>
<a name="ln-6073"></a><span class="k">FUNCTION </span><span class="n">CalcCBF</span><span class="p">(</span><span class="n">UnitType</span><span class="p">,</span><span class="n">UnitName</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">TotCap</span><span class="p">,</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="n">SHR</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-6074"></a>
<a name="ln-6075"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-6076"></a>          <span class="c">!       AUTHOR         Fred Buhl using Don Shirey&#39;s code</span>
<a name="ln-6077"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-6078"></a>          <span class="c">!       Modified by BOS Mark 2012</span>
<a name="ln-6079"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6080"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6081"></a>
<a name="ln-6082"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-6083"></a>          <span class="c">! Calculate the coil bypass factor for a coil given the total capacity at the entering conditions,</span>
<a name="ln-6084"></a>          <span class="c">! air mass flow rate at the entering conditions, and the sensible heat ratio (SHR) at the</span>
<a name="ln-6085"></a>          <span class="c">! entering conditions.</span>
<a name="ln-6086"></a>
<a name="ln-6087"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6088"></a>          <span class="c">! calculate SlopeRated (deltahumrat/deltaT) using rated unit information provided by</span>
<a name="ln-6089"></a>          <span class="c">! user. Then hunt along saturation curve of psychrometric chart until the slope of the line</span>
<a name="ln-6090"></a>          <span class="c">! between the saturation point and rated inlet air humidity ratio and T is the same as SlopeRated.</span>
<a name="ln-6091"></a>          <span class="c">! When the slopes are equal, then we have located the apparatus dewpoint of the coil at rated</span>
<a name="ln-6092"></a>          <span class="c">! conditions. From this information, coil bypass factor is calculated.</span>
<a name="ln-6093"></a>
<a name="ln-6094"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6095"></a>          <span class="c">! na</span>
<a name="ln-6096"></a>
<a name="ln-6097"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6098"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-6099"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdRhoAir</span>
<a name="ln-6100"></a>
<a name="ln-6101"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6102"></a>
<a name="ln-6103"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-6104"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitType</span>
<a name="ln-6105"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitName</span>
<a name="ln-6106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirTemp</span>          <span class="c">! inlet air temperature [C]</span>
<a name="ln-6107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>        <span class="c">! inlet air humidity ratio [kg water / kg dry air]</span>
<a name="ln-6108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>                <span class="c">! total cooling  capacity [Watts]</span>
<a name="ln-6109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>       <span class="c">! the air mass flow rate at the given capacity [kg/s]</span>
<a name="ln-6110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>                   <span class="c">! sensible heat ratio at the given capacity and flow rate</span>
<a name="ln-6111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CBF</span>                   <span class="c">! the result - the coil bypass factor</span>
<a name="ln-6112"></a>
<a name="ln-6113"></a>
<a name="ln-6114"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-6115"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcCBF&#39;</span>
<a name="ln-6116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SmallDifferenceTest</span><span class="o">=</span><span class="mf">0.00000001d0</span>
<a name="ln-6117"></a>
<a name="ln-6118"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6119"></a>          <span class="c">! na</span>
<a name="ln-6120"></a>
<a name="ln-6121"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6122"></a>          <span class="c">! na</span>
<a name="ln-6123"></a>
<a name="ln-6124"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>  <span class="c">! Enthalpy of inlet air to evaporator at given conditions [J/kg]</span>
<a name="ln-6126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaH</span>            <span class="c">! Enthalpy drop across evaporator at given conditions [J/kg]</span>
<a name="ln-6127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaT</span>            <span class="c">! Temperature drop across evaporator at given conditions [C]</span>
<a name="ln-6128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaHumRat</span>       <span class="c">! Humidity ratio drop across evaporator at given conditions [kg/kg]</span>
<a name="ln-6129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>     <span class="c">! Outlet dry-bulb temperature from evaporator at given conditions [C]</span>
<a name="ln-6130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span> <span class="c">! Enthalpy of outlet air at given conditions [J/kg]</span>
<a name="ln-6131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>   <span class="c">! Outlet humidity ratio from evaporator at given conditions [kg/kg]</span>
<a name="ln-6132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirRH</span>       <span class="c">! relative humidity of the outlet air</span>
<a name="ln-6133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Error</span>                <span class="c">! Error term used in given coil bypass factor (CBF) calculations</span>
<a name="ln-6134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorLast</span>            <span class="c">! Error term, from previous iteration</span>
<a name="ln-6135"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Iter</span>                 <span class="c">! Iteration loop counter in CBF calculations</span>
<a name="ln-6136"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IterMax</span>              <span class="c">! Maximum number of iterations in CBF calculations</span>
<a name="ln-6137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADPTemp</span>              <span class="c">! Apparatus dewpoint temperature used in CBF calculations [C]</span>
<a name="ln-6138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADPHumRat</span>            <span class="c">! Apparatus dewpoint humidity used in CBF calculations [kg/kg]</span>
<a name="ln-6139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADPEnthalpy</span>          <span class="c">! Air enthalpy at apparatus dew point [J/kg]</span>
<a name="ln-6140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaADPTemp</span>         <span class="c">! Change in Apparatus Dew Point used in CBF calculations [C]</span>
<a name="ln-6141"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SlopeAtConds</span>          <span class="c">! Slope (DeltaHumRat/DeltaT) at given conditions</span>
<a name="ln-6142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Slope</span>                <span class="c">! Calculated Slope used while hunting for Tadp</span>
<a name="ln-6143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tolerance</span>            <span class="c">! Convergence tolerance for CBF calculations</span>
<a name="ln-6144"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTinHumRatOut</span>        <span class="c">! Air enthalpy at inlet air temp and outlet air humidity ratio [J/kg]</span>
<a name="ln-6145"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>    <span class="c">! Set to true if errors in CBF calculation, fatal at end of routine</span>
<a name="ln-6146"></a>
<a name="ln-6147"></a>  <span class="n">DeltaH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6148"></a>  <span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6149"></a>  <span class="n">DeltaHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6150"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span>  <span class="n">InletAirTemp</span>
<a name="ln-6151"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-6152"></a>  <span class="n">SlopeAtConds</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6153"></a>  <span class="n">Slope</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6154"></a>  <span class="n">IterMax</span> <span class="o">=</span> <span class="mi">50</span>
<a name="ln-6155"></a>  <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6156"></a>
<a name="ln-6157"></a>  <span class="n">DeltaH</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlowRate</span>
<a name="ln-6158"></a>  <span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-6159"></a>  <span class="n">HTinHumRatOut</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">DeltaH</span>
<a name="ln-6160"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">HTinHumRatOut</span><span class="p">)</span>
<a name="ln-6161"></a>  <span class="n">DeltaHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-6162"></a>  <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">DeltaH</span>
<a name="ln-6163"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-6164"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-6165"></a><span class="c">!  Pressure will have to be pass into this subroutine to fix this one</span>
<a name="ln-6166"></a>  <span class="n">OutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="s1">&#39;CalcCBF&#39;</span><span class="p">)</span>
<a name="ln-6167"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutletAirRH</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6168"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;For object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;, name = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6169"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;Calculated outlet air relative humidity greater than 1. The combination of&#39;</span><span class="p">)</span>
<a name="ln-6170"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;rated air volume flow rate, total cooling capacity and sensible heat ratio yields coil exiting&#39;</span><span class="p">)</span>
<a name="ln-6171"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;air conditions above the saturation curve. Possible fixes are to reduce the rated total cooling&#39;</span><span class="p">)</span>
<a name="ln-6172"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;capacity, increase the rated air volume flow rate, or reduce the rated sensible heat&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6173"></a>                             <span class="s1">&#39; ratio for this coil.&#39;</span><span class="p">)</span>
<a name="ln-6174"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;If autosizing, it is recommended that all three of these values be autosized.&#39;</span><span class="p">)</span>
<a name="ln-6175"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inputs used for calculating cooling coil bypass factor.&#39;</span><span class="p">)</span>
<a name="ln-6176"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6177"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6178"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-6179"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-6180"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Total Cooling Capacity used in calculation = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-6181"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate used in calculation     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-6182"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate used in calculation   = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6183"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-6184"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">TotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6185"></a><span class="k">       IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6186"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6187"></a>           <span class="p">((</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span> <span class="p">&amp;</span>
<a name="ln-6188"></a>             <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6189"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate per Watt of Rated Cooling Capacity is also out of bounds at = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6190"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6191"></a>                                <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W&#39;</span><span class="p">)</span>
<a name="ln-6192"></a>       <span class="k">END IF</span>
<a name="ln-6193"></a><span class="k">     END IF</span>
<a name="ln-6194"></a><span class="k">     CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6195"></a>     <span class="k">CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;Check and revise the input data for this coil before rerunning the simulation.&#39;</span><span class="p">)</span>
<a name="ln-6196"></a>  <span class="k">END IF</span>
<a name="ln-6197"></a><span class="k">  </span><span class="n">DeltaT</span> <span class="o">=</span> <span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-6198"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaT</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6199"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;For object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;, name = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6200"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;Calculated coil delta T is less than or equal to 0. The combination of&#39;</span><span class="p">)</span>
<a name="ln-6201"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;rated air volume flow rate, total cooling capacity and sensible heat ratio yields coil exiting&#39;</span><span class="p">)</span>
<a name="ln-6202"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;air conditions that are not reasonable. Possible fixes are to adjust the rated total cooling&#39;</span><span class="p">)</span>
<a name="ln-6203"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;capacity, rated air volume flow rate, or rated sensible heat&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6204"></a>                             <span class="s1">&#39; ratio for this coil.&#39;</span><span class="p">)</span>
<a name="ln-6205"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;If autosizing, it is recommended that all three of these values be autosized.&#39;</span><span class="p">)</span>
<a name="ln-6206"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inputs used for calculating cooling coil bypass factor.&#39;</span><span class="p">)</span>
<a name="ln-6207"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6208"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6209"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-6210"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-6211"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Total Cooling Capacity used in calculation = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-6212"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate used in calculation     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-6213"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate used in calculation   = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6214"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-6215"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">TotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6216"></a><span class="k">       IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6217"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6218"></a>           <span class="p">((</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span> <span class="p">&amp;</span>
<a name="ln-6219"></a>             <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6220"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate per Watt of Rated Cooling Capacity is also out of bounds at = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6221"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6222"></a>                                <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W&#39;</span><span class="p">)</span>
<a name="ln-6223"></a>       <span class="k">END IF</span>
<a name="ln-6224"></a><span class="k">     END IF</span>
<a name="ln-6225"></a><span class="k">     CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6226"></a>     <span class="k">CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;Check and revise the input data for this coil before rerunning the simulation.&#39;</span><span class="p">)</span>
<a name="ln-6227"></a>  <span class="k">END IF</span>
<a name="ln-6228"></a>  <span class="c">! Calculate slope at given conditions</span>
<a name="ln-6229"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaT</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SlopeAtConds</span> <span class="o">=</span> <span class="n">DeltaHumRat</span><span class="o">/</span><span class="n">DeltaT</span>
<a name="ln-6230"></a>
<a name="ln-6231"></a><span class="c">!  IF (SlopeAtConds .le. .0000001d0 .or. OutletAirHumRat .le. 0.0d0) THEN</span>
<a name="ln-6232"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SlopeAtConds</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">OutletAirHumRat</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6233"></a><span class="c">!   Invalid conditions, slope can&#39;t be less than zero (SHR &gt; 1) or</span>
<a name="ln-6234"></a><span class="c">!   outlet air humidity ratio can&#39;t be less than zero.</span>
<a name="ln-6235"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6236"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Invalid slope or outlet air condition when calculating cooling coil bypass factor.&#39;</span><span class="p">)</span>
<a name="ln-6237"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Slope = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SlopeAtConds</span><span class="p">,</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-6238"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6239"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6240"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-6241"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-6242"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Total Cooling Capacity used in calculation = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-6243"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate used in calculation     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-6244"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate used in calculation   = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6245"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-6246"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">TotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6247"></a><span class="k">       IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6248"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6249"></a>           <span class="p">((</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span> <span class="p">&amp;</span>
<a name="ln-6250"></a>             <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6251"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate per Watt of Rated Cooling Capacity is also out of bounds at = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6252"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6253"></a>                                <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W&#39;</span><span class="p">)</span>
<a name="ln-6254"></a>       <span class="k">END IF</span>
<a name="ln-6255"></a><span class="k">    END IF</span>
<a name="ln-6256"></a><span class="k">    CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6257"></a>    <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6258"></a>    <span class="n">CBF</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Objexx:Return Suppress static testing from complaining about return value not set</span>
<a name="ln-6259"></a>  <span class="k">ELSE</span>
<a name="ln-6260"></a>
<a name="ln-6261"></a><span class="c">!   First guess for Tadp is outlet air dew point</span>
<a name="ln-6262"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-6263"></a><span class="c">!  Pressure will have to be pass into this subroutine to fix this one</span>
<a name="ln-6264"></a>    <span class="n">ADPTemp</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-6265"></a>
<a name="ln-6266"></a>    <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.d0</span>         <span class="c">! initial conditions for iteration</span>
<a name="ln-6267"></a>    <span class="n">ErrorLast</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-6268"></a>    <span class="n">Iter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6269"></a>    <span class="n">DeltaADPTemp</span> <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-6270"></a>    <span class="k">DO WHILE</span> <span class="p">((</span><span class="n">Iter</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">IterMax</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">Tolerance</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">))</span>
<a name="ln-6271"></a><span class="c">!     Do for IterMax iterations or until the error gets below .1%</span>
<a name="ln-6272"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Iter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">ADPTemp</span> <span class="o">=</span> <span class="n">ADPTemp</span> <span class="o">+</span> <span class="n">DeltaADPTemp</span>
<a name="ln-6273"></a>      <span class="n">Iter</span> <span class="o">=</span> <span class="n">Iter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6274"></a>
<a name="ln-6275"></a><span class="c">!     Find new slope using guessed Tadp</span>
<a name="ln-6276"></a>
<a name="ln-6277"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-6278"></a><span class="c">!  Pressure will have to be pass into this subroutine to fix this one</span>
<a name="ln-6279"></a>      <span class="n">ADPHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">ADPTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-6280"></a>      <span class="n">Slope</span>     <span class="o">=</span> <span class="p">(</span><span class="n">InletAirHumRat</span><span class="o">-</span><span class="n">ADPHumRat</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="o">-</span><span class="n">ADPTemp</span><span class="p">)</span>
<a name="ln-6281"></a>
<a name="ln-6282"></a><span class="c">!     check for convergence (slopes are equal to within error tolerance)</span>
<a name="ln-6283"></a>
<a name="ln-6284"></a>      <span class="n">Error</span>     <span class="o">=</span> <span class="p">(</span><span class="n">Slope</span><span class="o">-</span><span class="n">SlopeAtConds</span><span class="p">)</span><span class="o">/</span><span class="n">SlopeAtConds</span>
<a name="ln-6285"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Error</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">ErrorLast</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="n">DeltaADPTemp</span> <span class="o">=</span> <span class="o">-</span><span class="n">DeltaADPTemp</span><span class="o">/</span><span class="mf">2.d0</span>
<a name="ln-6286"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Error</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">ErrorLast</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="n">DeltaADPTemp</span> <span class="o">=</span> <span class="o">-</span><span class="n">DeltaADPTemp</span><span class="o">/</span><span class="mf">2.d0</span>
<a name="ln-6287"></a>      <span class="n">ErrorLast</span> <span class="o">=</span> <span class="n">Error</span>
<a name="ln-6288"></a>
<a name="ln-6289"></a>      <span class="n">Tolerance</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Error</span><span class="p">)</span>
<a name="ln-6290"></a>
<a name="ln-6291"></a>    <span class="k">END DO</span>
<a name="ln-6292"></a>
<a name="ln-6293"></a><span class="c">!   Calculate Bypass Factor from Enthalpies</span>
<a name="ln-6294"></a>
<a name="ln-6295"></a>    <span class="n">InletAirEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-6296"></a>    <span class="n">OutletAirEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-6297"></a>    <span class="n">ADPEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ADPTemp</span><span class="p">,</span><span class="n">ADPHumRat</span><span class="p">)</span>
<a name="ln-6298"></a>    <span class="n">CBF</span> <span class="o">=</span> <span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="o">-</span><span class="n">ADPEnthalpy</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">ADPEnthalpy</span><span class="p">)</span>
<a name="ln-6299"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Iter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">IterMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6300"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-6301"></a>                          <span class="s1">&#39;&quot; -- coil bypass factor calculation did not converge after max iterations.&#39;</span><span class="p">)</span>
<a name="ln-6302"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The RatedSHR of [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6303"></a>         <span class="s1">&#39;], entered by the user or autosized (see *.eio file),&#39;</span><span class="p">)</span>
<a name="ln-6304"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;may be causing this. The line defined by the coil rated inlet air conditions&#39;</span><span class="p">)</span>
<a name="ln-6305"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;(26.7C drybulb and 19.4C wetbulb) and the RatedSHR (i.e., slope of the line) must intersect&#39;</span><span class="p">)</span>
<a name="ln-6306"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the saturation curve of the psychrometric chart. If the RatedSHR is too low, then this&#39;</span><span class="p">)</span>
<a name="ln-6307"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;intersection may not occur and the coil bypass factor calculation will not converge.&#39;</span><span class="p">)</span>
<a name="ln-6308"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;If autosizing the SHR, recheck the design supply air humidity ratio and design supply air&#39;</span><span class="p">)</span>
<a name="ln-6309"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;temperature values in the Sizing:System and Sizing:Zone objects. In general, the temperatures&#39;</span><span class="p">)</span>
<a name="ln-6310"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;and humidity ratios specified in these two objects should be the same for each system&#39;</span><span class="p">)</span>
<a name="ln-6311"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;and the zones that it serves.&#39;</span><span class="p">)</span>
<a name="ln-6312"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6313"></a>      <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! Didn&#39;t converge within MaxIter iterations</span>
<a name="ln-6314"></a>    <span class="n">ENDIF</span>
<a name="ln-6315"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CBF</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6316"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; -- negative coil bypass factor calculated.&#39;</span><span class="p">)</span>
<a name="ln-6317"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6318"></a>      <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! Negative CBF not valid</span>
<a name="ln-6319"></a>    <span class="n">ENDIF</span>
<a name="ln-6320"></a>  <span class="k">END IF</span>
<a name="ln-6321"></a>
<a name="ln-6322"></a><span class="c">! Show fatal error for specific coil that caused a CBF error</span>
<a name="ln-6323"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CBFErrors</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6324"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-6325"></a>                        <span class="s1">&#39;&quot; Errors found in calculating coil bypass factors&#39;</span><span class="p">)</span>
<a name="ln-6326"></a>  <span class="k">END IF</span>
<a name="ln-6327"></a>
<a name="ln-6328"></a><span class="k">  RETURN</span>
<a name="ln-6329"></a><span class="k">END FUNCTION </span><span class="n">CalcCBF</span>
<a name="ln-6330"></a>
<a name="ln-6331"></a><span class="c">!     NOTICE</span>
<a name="ln-6332"></a><span class="c">!</span>
<a name="ln-6333"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-6334"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-6335"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-6336"></a><span class="c">!</span>
<a name="ln-6337"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-6338"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-6339"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-6340"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-6341"></a><span class="c">!</span>
<a name="ln-6342"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-6343"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-6344"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-6345"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-6346"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-6347"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-6348"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-6349"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-6350"></a><span class="c">!     permit others to do so.</span>
<a name="ln-6351"></a><span class="c">!</span>
<a name="ln-6352"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-6353"></a>
<a name="ln-6354"></a><span class="k">END MODULE </span><span class="n">VariableSpeedCoils</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
