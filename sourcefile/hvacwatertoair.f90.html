<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HVACWatertoAir.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HVACWatertoAir.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.9% of total for source files.">3322 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HVACWatertoAir.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HVACWatertoAir.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/watertoairheatpump.html">WatertoAirHeatPump</a>

      <a class="list-group-item" href="../module/watertoairheatpumpsimple.html">WatertoAirHeatPumpSimple</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html#src">HVACWatertoAir.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacwatertoair.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilehvacwatertoairf90EfferentGraph" width="641pt" height="817pt"
 viewBox="0.00 0.00 641.00 817.42" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph" class="graph" transform="scale(.2824 .2824) rotate(0) translate(4 2890.2738)">
<title>sourcefile~~hvacwatertoair.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2890.2738 2265.6133,-2890.2738 2265.6133,4 -4,4"/>
<!-- sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~hvacwatertoair.f90</title>
<polygon fill="none" stroke="#000000" points="2261.3873,-1967.2817 2155.2931,-1967.2817 2155.2931,-1945.2709 2261.3873,-1945.2709 2261.3873,-1967.2817"/>
<text text-anchor="middle" x="2208.3402" y="-1953.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACWatertoAir.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-2250.2817 543.4891,-2250.2817 543.4891,-2228.2709 658.8752,-2228.2709 658.8752,-2250.2817"/>
<text text-anchor="middle" x="601.1821" y="-2236.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-2734.2763C1529.9225,-2745.2637 1585.1286,-2670.5715 1803.1578,-2696.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M658.9861,-2247.3647C668.9162,-2251.1047 678.3045,-2256.5036 685.3989,-2264.2763 740.3989,-2324.5341 683.3664,-2372.0993 721.3989,-2444.2763 776.3679,-2548.5947 804.2671,-2575.6426 906.5706,-2634.2763 986.8293,-2680.2754 1218.418,-2727.2689 1310.6583,-2734.2763"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-992.2817 762.616,-992.2817 762.616,-970.2709 829.3535,-970.2709 829.3535,-992.2817"/>
<text text-anchor="middle" x="795.9847" y="-978.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M610.8653,-2227.9995C629.4834,-2205.517 669.8087,-2152.7476 685.3989,-2100.2763 720.0383,-1983.6922 648.7538,-1103.8183 721.3989,-1006.2763 728.8553,-996.2645 740.4958,-990.215 752.382,-986.5747"/>
<polygon fill="#0048ff" stroke="#0048ff" points="753.5052,-989.9007 762.3377,-984.0494 751.784,-983.1156 753.5052,-989.9007"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.6605,-2027.2817 1739.6552,-2027.2817 1739.6552,-2005.2709 1866.6605,-2005.2709 1866.6605,-2027.2817"/>
<text text-anchor="middle" x="1803.1578" y="-2013.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M652.1367,-2250.364C663.4893,-2253.9221 675.1799,-2258.4895 685.3989,-2264.2763 704.286,-2274.9717 701.1703,-2289.4077 721.3989,-2297.2763 855.4778,-2349.4308 1183.6461,-2310.9125 1310.6583,-2240.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-2240.2763C1390.2662,-2194.0613 1391.5621,-2128.9347 1483.574,-2126.2763"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2110.4605,-1947.2817 2022.8913,-1947.2817 2022.8913,-1925.2709 2110.4605,-1925.2709 2110.4605,-1947.2817"/>
<text text-anchor="middle" x="2066.6759" y="-1933.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2110.3358,-1942.4402C2121.2767,-1943.9848 2133.237,-1945.6733 2144.925,-1947.3234"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2144.7025,-1950.8266 2155.0936,-1948.759 2145.6811,-1943.8954 2144.7025,-1950.8266"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-2289.2817 358.7923,-2289.2817 358.7923,-2267.2709 439.3754,-2267.2709 439.3754,-2289.2817"/>
<text text-anchor="middle" x="399.0839" y="-2275.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2658.2763C856.0732,-2686.8077 1022.9195,-2711.2687 1088.825,-2720.2763 1186.7038,-2733.6538 1211.8701,-2733.9444 1310.6583,-2734.2763"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M406.0109,-2289.2821C422.7251,-2315.2402 467.5551,-2381.3983 516.9653,-2425.2763 582.9252,-2483.851 618.3773,-2472.9194 685.3989,-2530.2763 742.5176,-2579.1583 724.8932,-2633.8224 795.9847,-2658.2763"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1803.1578,-2621.2763C1867.8744,-2608.7985 1885.426,-2601.5238 1940.4719,-2565.2763"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M795.9847,-2658.2763C944.1105,-2716.4702 986.7603,-2582.2763 1145.9073,-2582.2763 1145.9073,-2582.2763 1145.9073,-2582.2763 1483.574,-2582.2763 1581.9683,-2582.2763 1606.0813,-2593.6066 1703.6565,-2606.2763 1748.0067,-2612.035 1759.2441,-2629.7432 1803.1578,-2621.2763"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1978.0983,-1988.2817 1902.8455,-1988.2817 1902.8455,-1966.2709 1978.0983,-1966.2709 1978.0983,-1988.2817"/>
<text text-anchor="middle" x="1940.4719" y="-1974.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M601.1821,-2411.2763C760.0437,-2480.895 806.251,-2506.2763 979.6978,-2506.2763 979.6978,-2506.2763 979.6978,-2506.2763 1145.9073,-2506.2763 1221.864,-2506.2763 1742.3517,-2363.7957 1803.1578,-2318.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1337.2817 551.623,-1337.2817 551.623,-1315.2709 650.7412,-1315.2709 650.7412,-1337.2817"/>
<text text-anchor="middle" x="601.1821" y="-1323.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M439.6432,-2275.5622C454.9774,-2272.3613 471.0931,-2265.9341 480.9653,-2253.2763 529.8856,-2190.5529 500.0552,-1616.0032 516.9653,-1538.2763 532.9721,-1464.7016 571.6544,-1383.4789 590.5023,-1346.5496"/>
<polygon fill="#ff0048" stroke="#ff0048" points="593.7742,-1347.8419 595.2571,-1337.3514 587.5559,-1344.6275 593.7742,-1347.8419"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.2363,-2289.6395C443.0056,-2315.5829 523.0115,-2379.386 601.1821,-2411.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2411.2763C726.8447,-2462.5413 1076.1589,-2355.5787 1202.9897,-2307.2763 1255.6606,-2287.2171 1261.9153,-2268.5732 1310.6583,-2240.2763"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1794.2817 350.2841,-1794.2817 350.2841,-1772.2709 447.8836,-1772.2709 447.8836,-1794.2817"/>
<text text-anchor="middle" x="399.0839" y="-1780.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2086.2763C640.3345,-2144.2607 655.3125,-2156.1106 685.3989,-2219.2763 706.9752,-2264.5752 691.2412,-2286.1759 721.3989,-2326.2763 738.6416,-2349.2037 1117.2198,-2620.2763 1145.9073,-2620.2763 1145.9073,-2620.2763 1145.9073,-2620.2763 1483.574,-2620.2763 1629.5723,-2620.2763 1658.1384,-2679.398 1803.1578,-2696.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.1578,-2696.2763C1864.0547,-2700.2824 1881.3716,-2681.0569 1940.4719,-2696.2763"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M601.1821,-2086.2763C640.2402,-2144.3244 651.9515,-2157.8241 685.3989,-2219.2763 703.6517,-2252.8116 690.7719,-2274.4779 721.3989,-2297.2763 770.0927,-2333.5234 1748.151,-2425.6019 1803.1578,-2451.2763"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M412.479,-1794.3171C429.7636,-1809.0258 460.088,-1836.4432 480.9653,-1864.2763 548.2932,-1954.036 538.3925,-1993.2854 601.1821,-2086.2763"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1549.0691,-916.2817 1418.0789,-916.2817 1418.0789,-894.2709 1549.0691,-894.2709 1549.0691,-916.2817"/>
<text text-anchor="middle" x="1483.574" y="-902.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M979.6978,-1670.2763C1007.6556,-1651.6757 1025.2352,-1670.4186 1052.825,-1651.2763 1148.2888,-1585.0419 1161.9397,-1545.9742 1202.9897,-1437.2763 1254.3338,-1301.3205 1170.6746,-1240.5465 1238.9897,-1112.2763 1288.4504,-1019.4078 1398.3393,-950.7709 1452.3627,-921.2547"/>
<polygon fill="#daff00" stroke="#daff00" points="1454.3118,-924.1807 1461.4642,-916.3644 1450.9986,-918.0144 1454.3118,-924.1807"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="842.6086,-1832.2817 749.3609,-1832.2817 749.3609,-1810.2709 842.6086,-1810.2709 842.6086,-1832.2817"/>
<text text-anchor="middle" x="795.9847" y="-1818.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M601.1821,-1782.2763C654.9316,-1780.4434 715.4743,-1795.3119 754.5945,-1807.2165"/>
<polygon fill="#91ff00" stroke="#91ff00" points="753.7164,-1810.6088 764.3049,-1810.245 755.8006,-1803.9263 753.7164,-1810.6088"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-1485.2817 930.3078,-1485.2817 930.3078,-1463.2709 1029.0877,-1463.2709 1029.0877,-1485.2817"/>
<text text-anchor="middle" x="979.6978" y="-1471.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M601.1821,-1666.2763C635.3717,-1647.6798 649.954,-1658.3516 685.3989,-1642.2763 792.0028,-1593.9283 801.2544,-1550.3685 906.5706,-1499.2763 914.5519,-1495.4043 923.2884,-1491.8647 931.8576,-1488.7442"/>
<polygon fill="#00ff48" stroke="#00ff48" points="933.1278,-1492.008 941.4123,-1485.4037 930.8175,-1485.4002 933.1278,-1492.008"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-881.2817 924.5597,-881.2817 924.5597,-859.2709 1034.8358,-859.2709 1034.8358,-881.2817"/>
<text text-anchor="middle" x="979.6978" y="-867.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M601.1821,-1590.2763C624.4916,-1559.1086 660.2987,-1596.0208 685.3989,-1566.2763 780.5484,-1453.5213 639.1923,-1358.7883 721.3989,-1236.2763 763.4347,-1173.6306 822.1112,-1213.0965 870.5706,-1155.2763 903.0707,-1116.4982 888.8998,-1094.6867 906.5706,-1047.2763 927.9457,-989.9271 956.3908,-923.5362 970.6866,-890.7585"/>
<polygon fill="#00ff91" stroke="#00ff91" points="974.0005,-891.9158 974.804,-881.3515 967.5879,-889.109 974.0005,-891.9158"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M407.8657,-1772.0591C426.5737,-1748.5095 472.3068,-1692.7543 516.9653,-1652.2763 551.4032,-1621.0622 573.1308,-1627.3359 601.1821,-1590.2763"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-1262.2817 1096.3585,-1262.2817 1096.3585,-1240.2709 1195.4562,-1240.2709 1195.4562,-1262.2817"/>
<text text-anchor="middle" x="1145.9073" y="-1248.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M601.1821,-1666.2763C635.0945,-1647.1789 648.1106,-1653.4272 685.3989,-1642.2763 768.0246,-1617.5674 790.5172,-1616.3542 870.5706,-1584.2763 891.5351,-1575.8757 1039.3756,-1512.4201 1052.825,-1494.2763 1111.3035,-1415.3857 1028.5519,-1353.8045 1088.825,-1276.2763 1091.3306,-1273.0533 1094.3379,-1270.2372 1097.6443,-1267.7782"/>
<polygon fill="#00daff" stroke="#00daff" points="1099.7091,-1270.6163 1106.3645,-1262.3727 1096.021,-1264.6666 1099.7091,-1270.6163"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-1642.2817 906.4431,-1642.2817 906.4431,-1620.2709 1052.9524,-1620.2709 1052.9524,-1642.2817"/>
<text text-anchor="middle" x="979.6978" y="-1628.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M601.1821,-1782.2763C687.7108,-1779.3256 713.5492,-1808.7393 795.9847,-1782.2763"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M795.9847,-1782.2763C829.1414,-1771.6326 845.6048,-1782.5531 870.5706,-1758.2763 905.0362,-1724.7617 872.4096,-1690.1014 906.5706,-1656.2763 910.2307,-1652.6521 914.4377,-1649.5527 918.9451,-1646.9021"/>
<polygon fill="#0091ff" stroke="#0091ff" points="920.592,-1649.9913 927.9188,-1642.3383 917.4186,-1643.7518 920.592,-1649.9913"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M406.972,-1771.9869C424.0553,-1746.8466 464.2759,-1683.7682 480.9653,-1624.2763 511.2344,-1516.378 445.1028,-1207.265 516.9653,-1121.2763 566.5097,-1061.9929 625.2531,-1126.77 685.3989,-1078.2763 713.2508,-1055.8202 694.3905,-1029.74 721.3989,-1006.2763 730.25,-998.5869 741.5528,-993.2433 752.6675,-989.5368"/>
<polygon fill="#0048ff" stroke="#0048ff" points="753.7226,-992.8747 762.3202,-986.6834 751.7382,-986.1619 753.7226,-992.8747"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M601.1821,-1858.2763C709.1682,-1916.935 630.9454,-2024.0898 721.3989,-2107.2763 786.2754,-2166.9407 821.4039,-2155.5729 906.5706,-2178.2763 930.927,-2184.7692 1782.7335,-2333.0493 1803.1578,-2318.2763"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1703.5743,-1492.2817 1584.9032,-1492.2817 1584.9032,-1470.2709 1703.5743,-1470.2709 1703.5743,-1492.2817"/>
<text text-anchor="middle" x="1644.2388" y="-1478.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1145.9073,-1670.2763C1244.1385,-1618.7431 1283.5389,-1640.7338 1382.3269,-1590.2763 1431.5007,-1565.1601 1433.1464,-1540.7695 1483.574,-1518.2763"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-1601.2817 929.5705,-1601.2817 929.5705,-1579.2709 1029.825,-1579.2709 1029.825,-1601.2817"/>
<text text-anchor="middle" x="979.6978" y="-1587.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M601.1821,-1782.2763C659.3622,-1780.2923 666.9123,-1750.7717 721.3989,-1730.2763 753.9925,-1718.0161 761.7418,-1712.6068 795.9847,-1706.2763"/>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M448.1051,-1783.8321C489.0422,-1784.1045 548.933,-1784.0581 601.1821,-1782.2763"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M405.1996,-1772.2697C419.3209,-1746.676 454.9769,-1681.0174 480.9653,-1624.2763 493.2906,-1597.3663 567.7976,-1410.2776 592.9193,-1347.0782"/>
<polygon fill="#ff0048" stroke="#ff0048" points="596.3214,-1347.9943 596.7618,-1337.4086 589.8163,-1345.4092 596.3214,-1347.9943"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1379.0561,-764.2817 1242.2606,-764.2817 1242.2606,-742.2709 1379.0561,-742.2709 1379.0561,-764.2817"/>
<text text-anchor="middle" x="1310.6583" y="-750.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1782.2763C829.1414,-1771.6326 839.9268,-1774.8175 870.5706,-1758.2763 925.3986,-1728.6806 929.8765,-1707.6911 979.6978,-1670.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1670.2763C1006.5492,-1650.1114 1028.3236,-1674.2394 1052.825,-1651.2763 1090.0499,-1616.3884 1069.7531,-1589.5957 1088.825,-1542.2763 1132.6813,-1433.4641 1172.7786,-1417.6375 1202.9897,-1304.2763 1230.9918,-1199.2045 1190.5537,-913.6321 1238.9897,-816.2763 1248.5781,-797.0038 1266.8966,-781.0652 1282.6128,-770.0411"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1284.6354,-772.8991 1291.0043,-764.4323 1280.7455,-767.0794 1284.6354,-772.8991"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-764.2817 1088.7424,-764.2817 1088.7424,-742.2709 1203.0723,-742.2709 1203.0723,-764.2817"/>
<text text-anchor="middle" x="1145.9073" y="-750.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M414.5915,-1772.1747C431.3767,-1759.9698 458.7261,-1739.5296 480.9653,-1720.2763 497.8366,-1705.6703 497.3455,-1695.9083 516.9653,-1685.2763 550.7008,-1666.995 568.4957,-1686.3732 601.1821,-1666.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1666.2763C640.7759,-1641.9325 656.8192,-1640.93 685.3989,-1604.2763 711.3828,-1570.9519 699.4667,-1552.3964 721.3989,-1516.2763 774.6182,-1428.6298 823.5362,-1431.3915 870.5706,-1340.2763 900.2377,-1282.8048 872.2825,-1254.1165 906.5706,-1199.2763 951.7494,-1127.0173 1010.833,-1149.4327 1052.825,-1075.2763 1101.4292,-989.4427 1056.4425,-949.449 1088.825,-856.2763 1099.544,-825.4347 1119.105,-792.9874 1132.304,-772.9412"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1135.3665,-774.6588 1138.0358,-764.4057 1129.5552,-770.7563 1135.3665,-774.6588"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-460.2817 1090.0905,-460.2817 1090.0905,-438.2709 1201.7241,-438.2709 1201.7241,-460.2817"/>
<text text-anchor="middle" x="1145.9073" y="-446.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1590.2763C624.6714,-1559.2439 659.8241,-1595.6137 685.3989,-1566.2763 760.3213,-1480.3314 661.4501,-1409.261 721.3989,-1312.2763 763.7603,-1243.7445 824.1212,-1275.106 870.5706,-1209.2763 906.1236,-1158.8893 878.8784,-1130.3763 906.5706,-1075.2763 953.6376,-981.6257 1013.2752,-987.341 1052.825,-890.2763 1110.497,-748.735 1041.6249,-693.6453 1088.825,-548.2763 1098.5044,-518.4652 1117.9757,-487.7458 1131.4674,-468.5921"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1134.356,-470.5702 1137.3649,-460.4116 1128.6777,-466.4766 1134.356,-470.5702"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1069.2817 532.6734,-1069.2817 532.6734,-1047.2709 669.6908,-1047.2709 669.6908,-1069.2817"/>
<text text-anchor="middle" x="601.1821" y="-1055.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.9942,-1771.9931C424.1216,-1746.8651 464.4248,-1683.8097 480.9653,-1624.2763 513.2196,-1508.1856 441.735,-1177.3921 516.9653,-1083.2763 519.5171,-1080.0839 522.4575,-1077.2859 525.6771,-1074.8347"/>
<polygon fill="#ff0000" stroke="#ff0000" points="527.626,-1077.7433 534.1929,-1069.429 523.8745,-1071.8334 527.626,-1077.7433"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M437.5414,-1794.3774C479.1257,-1807.0984 546.761,-1829.8966 601.1821,-1858.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-2126.2763C1700.4796,-2104.9067 1755.8969,-2059.5107 1784.0553,-2034.2271"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1786.5429,-2036.6954 1791.5718,-2027.3701 1781.8252,-2031.524 1786.5429,-2036.6954"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-2050.2763C1388.8146,-2080.914 1399.6621,-2128.7007 1483.574,-2126.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-2126.2763C1554.9508,-2124.2141 1577.4883,-2151.6392 1644.2388,-2126.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1858.2763C707.8358,-1913.8944 753.4114,-1857.035 870.5706,-1884.2763 1074.1853,-1931.6199 1116.0317,-1973.9816 1310.6583,-2050.2763"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1537.2997,-994.2817 1429.8483,-994.2817 1429.8483,-972.2709 1537.2997,-972.2709 1537.2997,-994.2817"/>
<text text-anchor="middle" x="1483.574" y="-980.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1670.2763C1259.928,-1609.1349 1221.2093,-1313.8058 1238.9897,-1274.2763 1278.4267,-1186.6002 1333.826,-1195.2826 1382.3269,-1112.2763 1407.0034,-1070.044 1384.3095,-1043.4233 1418.3269,-1008.2763 1421.7331,-1004.757 1425.6879,-1001.7259 1429.9334,-999.1166"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1431.7727,-1002.1032 1438.9737,-994.3318 1428.4981,-995.9163 1431.7727,-1002.1032"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1670.2763C1041.2006,-1629.3579 1080.4917,-1704.5941 1145.9073,-1670.2763"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1509.6884,-894.2163C1548.6263,-879.5949 1619.9265,-860.5522 1644.2388,-905.2763"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M842.8832,-1812.6559C1047.3141,-1776.1027 1859.5592,-1641.7774 2066.6759,-1775.2763"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-2098.2817 745.8318,-2098.2817 745.8318,-2076.2709 846.1377,-2076.2709 846.1377,-2098.2817"/>
<text text-anchor="middle" x="795.9847" y="-2084.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M807.5712,-2098.3127C826.9898,-2116.4521 867.7989,-2153.0678 906.5706,-2178.2763 1122.0155,-2318.3542 1700.7696,-2603.642 1940.4719,-2696.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1940.4719,-2696.2763C1997.1993,-2710.8847 2019.0218,-2768.3421 2066.6759,-2734.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2066.6759,-2734.2763C2130.8505,-2688.4007 2193.9805,-2097.8008 2206.2144,-1977.5575"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2209.7153,-1977.7245 2207.2378,-1967.4234 2202.7507,-1977.0211 2209.7153,-1977.7245"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1803.1578,-2451.2763C1873.4231,-2488.0783 1874.2253,-2608.8994 1940.4719,-2565.2763"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M979.6978,-2164.2763C1094.9643,-2204.2022 1122.4324,-2218.2922 1238.9897,-2254.2763 1443.4445,-2317.3965 1510.2694,-2288.6939 1703.6565,-2380.2763 1752.7559,-2403.5283 1755.0323,-2426.0702 1803.1578,-2451.2763"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1940.4719,-2565.2763C2054.1435,-2490.4242 1931.3554,-2065.1966 2014.2847,-1957.2763 2015.3519,-1955.8874 2016.5256,-1954.5901 2017.7856,-1953.3783"/>
<polygon fill="#ff4800" stroke="#ff4800" points="2019.928,-1956.1464 2025.8062,-1947.3318 2015.7141,-1950.5568 2019.928,-1956.1464"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M802.0865,-2076.2241C816.6987,-2049.1865 853.7316,-1977.1706 870.5706,-1912.2763 908.9586,-1764.3359 850.1738,-1712.3305 906.5706,-1570.2763 918.638,-1539.8804 943.177,-1510.8605 960.4921,-1492.8393"/>
<polygon fill="#00ff48" stroke="#00ff48" points="963.3336,-1494.9429 967.8687,-1485.3678 958.3523,-1490.0249 963.3336,-1494.9429"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M801.9415,-2076.1851C816.2318,-2049.061 852.604,-1976.8675 870.5706,-1912.2763 901.3612,-1801.5816 833.3858,-1744.8504 906.5706,-1656.2763 909.3107,-1652.96 912.5115,-1650.0823 916.0146,-1647.5852"/>
<polygon fill="#0091ff" stroke="#0091ff" points="917.8705,-1650.5536 924.6628,-1642.4225 914.2824,-1644.5431 917.8705,-1650.5536"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1803.1578,-2318.2763C1914.4392,-2243.1223 1935.5546,-2061.1576 1939.5461,-1998.7229"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1943.0534,-1998.6864 1940.11,-1988.5087 1936.064,-1998.3005 1943.0534,-1998.6864"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M979.6978,-2164.2763C1065.0346,-2191.6899 1293.6859,-2174.985 1382.3269,-2188.2763 1527.6626,-2210.0687 1566.109,-2214.5263 1703.6565,-2266.2763 1750.3582,-2283.8471 1761.8069,-2346.2027 1803.1578,-2318.2763"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M835.9259,-2098.3513C847.3829,-2102.1407 859.7075,-2106.8237 870.5706,-2112.2763 887.9801,-2121.0149 889.2953,-2128.2751 906.5706,-2137.2763 937.2955,-2153.2854 946.9605,-2152.9368 979.6978,-2164.2763"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M838.7155,-2076.1889C891.6169,-2061.2874 983.2363,-2031.5696 1052.825,-1988.2763 1222.0078,-1883.0223 1256.0101,-1838.3715 1382.3269,-1684.2763 1437.112,-1617.4434 1405.1937,-1554.671 1483.574,-1518.2763"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M833.9708,-2098.3452C898.4143,-2115.5988 1033.1566,-2145.0724 1145.9073,-2126.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2126.2763C1292.6628,-2094.8906 1333.6002,-2131.762 1483.574,-2126.2763"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2118.9586,-1988.2817 2014.3932,-1988.2817 2014.3932,-1966.2709 2118.9586,-1966.2709 2118.9586,-1988.2817"/>
<text text-anchor="middle" x="2066.6759" y="-1974.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2119.024,-1969.5163C2127.5215,-1968.2567 2136.4007,-1966.9405 2145.124,-1965.6473"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2145.882,-1969.0733 2155.2606,-1964.1447 2144.8555,-1962.149 2145.882,-1969.0733"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1026.9828,-1463.2486C1169.6501,-1430.4389 1589.3954,-1337.468 1644.2388,-1366.2763"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M990.3543,-1485.4993C1006.0395,-1502.5615 1035.3664,-1536.6122 1052.825,-1570.2763 1077.2864,-1617.4435 1056.4899,-1642.1153 1088.825,-1684.2763 1089.8146,-1685.5666 1482.0002,-1935.8669 1483.574,-1936.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-1936.2763C1553.4554,-1950.9558 1580.826,-1903.4477 1644.2388,-1936.2763"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-908.2763C1396.6964,-940.9979 1392.6343,-1036.5323 1483.574,-1022.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-1022.2763C1513.4128,-1017.5987 1522.9319,-1018.8322 1548.821,-1003.2763 1600.9287,-971.9665 1619.5898,-849.707 1644.2388,-905.2763"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M984.6721,-881.6789C1007.9457,-935.0288 1106.2385,-1160.344 1136.8005,-1230.4009"/>
<polygon fill="#00daff" stroke="#00daff" points="1133.7458,-1232.1519 1140.9524,-1239.9182 1140.1619,-1229.3529 1133.7458,-1232.1519"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1002.8556,-881.4187C1045.3003,-902.4978 1137.2319,-951.2474 1202.9897,-1008.2763 1315.8254,-1106.1338 1316.1681,-1157.3197 1418.3269,-1266.2763 1445.6882,-1295.4583 1455.6838,-1299.5993 1483.574,-1328.2763"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1483.574,-1328.2763C1538.9229,-1372.935 1598.0094,-1432.7647 1626.6492,-1462.6495"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1624.4581,-1465.4235 1633.8913,-1470.2469 1629.5249,-1460.5937 1624.4581,-1465.4235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-870.2763C1179.1281,-866.3495 1254.2845,-803.3416 1290.4588,-771.4585"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1293.2124,-773.6942 1298.3657,-764.437 1288.5643,-768.4601 1293.2124,-773.6942"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1034.9134,-873.5153C1067.3501,-874.6119 1109.084,-874.6289 1145.9073,-870.2763"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1022.5419,-859.2226C1032.8718,-855.6021 1043.5854,-850.9983 1052.825,-845.2763 1084.6016,-825.5974 1113.9746,-793.2215 1130.9123,-772.5919"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1133.8458,-774.5288 1137.3807,-764.541 1128.3889,-770.1444 1133.8458,-774.5288"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1034.8351,-859.2139C1041.7141,-855.7534 1048.0101,-851.2182 1052.825,-845.2763 1094.6809,-793.6228 1067.7964,-611.3461 1088.825,-548.2763 1098.7388,-518.5423 1118.1552,-487.8049 1131.5705,-468.626"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1134.4595,-470.603 1137.4311,-460.4334 1128.7663,-466.5303 1134.4595,-470.603"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-870.2763C1220.533,-861.4553 1240.4213,-881.564 1310.6583,-908.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-908.2763C1342.0556,-920.2172 1352.4439,-916.9343 1382.3269,-932.2763 1399.8847,-941.2905 1400.9659,-948.8888 1418.3269,-958.2763 1425.2294,-962.0087 1432.8097,-965.4511 1440.2844,-968.5117"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1439.0493,-971.7868 1449.6369,-972.1775 1441.6038,-965.2696 1439.0493,-971.7868"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1382.4959,-192.2817 1238.8208,-192.2817 1238.8208,-170.2709 1382.4959,-170.2709 1382.4959,-192.2817"/>
<text text-anchor="middle" x="1310.6583" y="-178.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1315.2125,-192.6057C1342.8083,-260.9198 1491.5544,-624.4026 1644.2388,-905.2763"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M1314.0067,-192.3275C1325.5281,-230.8126 1363.8408,-362.6829 1382.3269,-474.2763 1397.1297,-563.6347 1363.7522,-807.9877 1418.3269,-880.2763 1420.7652,-883.506 1423.6759,-886.3184 1426.8946,-888.7676"/>
<polygon fill="#daff00" stroke="#daff00" points="1425.1072,-891.7781 1435.4359,-894.1379 1428.8332,-885.8521 1425.1072,-891.7781"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1314.0426,-192.3216C1325.6813,-230.7875 1364.3311,-362.6028 1382.3269,-474.2763 1398.3224,-573.5368 1373.5215,-835.2709 1418.3269,-925.2763 1426.7169,-942.1302 1442.327,-956.2841 1456.175,-966.3899"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1454.2754,-969.3317 1464.4894,-972.1471 1458.2604,-963.5767 1454.2754,-969.3317"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-1252.2763C1569.2799,-1270.1789 1566.7261,-1325.5602 1644.2388,-1366.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-1366.2763C1668.2577,-1378.8931 1680.0064,-1366.981 1703.6565,-1380.2763 1758.5851,-1411.1553 1744.5216,-1458.2011 1803.1578,-1481.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1195.4843,-1245.2418C1261.888,-1238.5554 1383.0078,-1231.2697 1483.574,-1252.2763"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1175.8037,-1262.3779C1184.8279,-1266.2492 1194.5686,-1270.9702 1202.9897,-1276.2763 1237.8218,-1298.2236 1446.4295,-1536.0314 1483.574,-1518.2763"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1483.574,-1518.2763C1511.9594,-1504.9325 1545.4819,-1496.2329 1574.5428,-1490.6466"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1575.4159,-1494.045 1584.6202,-1488.798 1574.1528,-1487.1598 1575.4159,-1494.045"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1019.8004,-1642.3241C1030.8189,-1646.0647 1042.5544,-1650.729 1052.825,-1656.2763 1070.6595,-1665.9092 1069.6523,-1677.698 1088.825,-1684.2763 1136.8185,-1700.7433 1152.5893,-1690.1356 1202.9897,-1684.2763 1403.1261,-1661.0095 1453.1115,-1644.0435 1644.2388,-1580.2763"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1053.0081,-1624.9214C1154.0675,-1613.9606 1339.9675,-1585.7849 1483.574,-1518.2763"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1031.5075,-1642.3073C1039.3668,-1645.7673 1046.8365,-1650.3108 1052.825,-1656.2763 1087.4779,-1690.7968 1055.9913,-1724.021 1088.825,-1760.2763 1217.7695,-1902.6583 1295.5849,-1896.7867 1483.574,-1936.2763"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1022.2763C1295.8591,-1016.2192 1335.3106,-1045.5185 1483.574,-1022.2763"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1145.9073,-1022.2763C1193.2905,-1021.6157 1196.8748,-1052.5523 1238.9897,-1074.2763 1442.5709,-1179.2889 1565.542,-1114.527 1703.6565,-1297.2763 1757.5848,-1368.6327 1680.0125,-1428.6235 1739.6565,-1495.2763 1778.9455,-1539.1821 1821.6118,-1495.3016 1866.6592,-1533.2763 1931.5488,-1587.9779 2030.4023,-1840.2083 2058.7984,-1915.1946"/>
<polygon fill="#ff4800" stroke="#ff4800" points="2055.6641,-1916.803 2062.4643,-1924.9275 2062.2148,-1914.3356 2055.6641,-1916.803"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M829.6789,-984.6222C878.7995,-989.5743 972.9261,-999.344 1052.825,-1009.2763 1094.2774,-1014.4293 1104.4686,-1017.0148 1145.9073,-1022.2763"/>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M1145.9073,-1022.2763C1173.4213,-1021.6487 1184.1696,-1018.3565 1202.9897,-998.2763 1236.4387,-962.5879 1199.1457,-922.6478 1238.9897,-894.2763 1300.8269,-850.2444 1395.4217,-873.0022 1446.973,-890.7903"/>
<polygon fill="#daff00" stroke="#daff00" points="1446.0923,-894.1923 1456.6869,-894.2605 1448.4472,-887.6003 1446.0923,-894.1923"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M829.5999,-984.4519C844.3987,-987.6398 860.6435,-993.9303 870.5706,-1006.2763 917.488,-1064.6264 884.0951,-1269.8562 906.5706,-1341.2763 920.2373,-1384.7051 948.7673,-1430.0964 965.8718,-1455.0181"/>
<polygon fill="#00ff48" stroke="#00ff48" points="963.0128,-1457.0372 971.6078,-1463.2321 968.7519,-1453.0294 963.0128,-1457.0372"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M814.2715,-970.2274C846.6508,-950.6637 914.2271,-909.8339 952.2278,-886.8738"/>
<polygon fill="#00ff91" stroke="#00ff91" points="954.4633,-889.6124 961.2123,-881.4453 950.8433,-883.621 954.4633,-889.6124"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M979.6978,-1213.2763C998.4423,-1222.3081 1046.7248,-1232.8801 1086.4499,-1240.5769"/>
<polygon fill="#00daff" stroke="#00daff" points="1085.8625,-1244.0279 1096.342,-1242.469 1087.1777,-1237.1525 1085.8625,-1244.0279"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M804.3889,-992.3397C820.5771,-1014.3503 855.788,-1065.7846 870.5706,-1115.2763 902.135,-1220.9536 837.06,-1524.6476 906.5706,-1610.2763 907.6866,-1611.6511 908.8863,-1612.9396 910.1579,-1614.1469"/>
<polygon fill="#0091ff" stroke="#0091ff" points="908.0628,-1616.9507 918.1434,-1620.2112 912.2963,-1611.376 908.0628,-1616.9507"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M829.568,-992.0035C842.4571,-996.2587 857.262,-1001.315 870.5706,-1006.2763 1023.2803,-1063.2056 1402.8437,-1212.8068 1548.821,-1285.2763 1620.3164,-1320.7697 1656.474,-1311.8933 1703.6565,-1376.2763 1745.973,-1434.0193 1716.0916,-1465.6772 1739.6565,-1533.2763 1782.7799,-1656.9815 1818.4397,-1677.4671 1866.6592,-1799.2763 1886.0599,-1848.2853 1881.2796,-1864.0976 1902.6592,-1912.2763 1909.664,-1928.0616 1919.5258,-1944.8888 1927.4218,-1957.4665"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1924.6553,-1959.6365 1932.9968,-1966.1687 1930.5495,-1955.8604 1924.6553,-1959.6365"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1310.6583,-1288.2763C1347.5275,-1302.2838 1452.8791,-1303.5099 1483.574,-1328.2763"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M804.2929,-992.369C820.3126,-1014.4309 855.242,-1065.951 870.5706,-1115.2763 920.784,-1276.8564 844.9368,-1336.6984 906.5706,-1494.2763 918.4832,-1524.7332 943.0561,-1553.7397 960.4214,-1571.7412"/>
<polygon fill="#ff0091" stroke="#ff0091" points="958.2948,-1574.5674 967.8215,-1579.2034 963.2652,-1569.6383 958.2948,-1574.5674"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-831.2763C1002.8383,-818.2847 1156.7645,-785.0594 1246.3257,-766.4356"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1247.302,-769.8076 1256.3826,-764.3493 1245.8802,-762.9535 1247.302,-769.8076"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-831.2763C1023.2092,-806.848 1075.6586,-783.1283 1109.8437,-768.3854"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1111.5924,-771.444 1119.4071,-764.2898 1108.8367,-765.0092 1111.5924,-771.444"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M812.4064,-970.2524C828.675,-958.7251 853.5566,-939.3956 870.5706,-918.2763 892.0238,-891.6466 879.7466,-871.4862 906.5706,-850.2763 932.9112,-829.4486 950.4167,-847.7153 979.6978,-831.2763"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M799.8237,-970.0857C815.8487,-924.5719 881.1885,-750.4528 979.6978,-638.2763"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.6248,-985.2588C844.0655,-988.6268 860.011,-994.8357 870.5706,-1006.2763 915.6065,-1055.0703 871.5552,-1094.8581 906.5706,-1151.2763 929.0402,-1187.4804 941.3113,-1194.7802 979.6978,-1213.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1288.2763C1410.1957,-1326.0929 1460.3489,-1255.0272 1548.821,-1314.2763 1576.5837,-1332.8687 1562.3915,-1355.5102 1584.821,-1380.2763 1627.7277,-1427.6527 1671.8876,-1405.8124 1703.6565,-1461.2763 1762.33,-1563.7118 1669.9388,-1896.0133 1739.6565,-1991.2763 1742.029,-1994.5181 1744.887,-1997.3398 1748.0603,-1999.7957"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1746.1872,-2002.7523 1756.5006,-2005.178 1749.9509,-1996.8502 1746.1872,-2002.7523"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1213.2763C1024.5446,-1234.8853 1155.1978,-1217.3437 1202.9897,-1231.2763 1254.9707,-1246.4301 1260.3497,-1268.2589 1310.6583,-1288.2763"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1022.2763C1225.9032,-1032.4334 1230.1131,-942.408 1310.6583,-946.2763"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-114.2817 721.313,-114.2817 721.313,-92.2709 870.6565,-92.2709 870.6565,-114.2817"/>
<text text-anchor="middle" x="795.9847" y="-100.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.1578,-1481.2763C1830.0509,-1491.8596 1840.1587,-1483.745 1866.6592,-1495.2763 1921.9236,-1519.3238 1939.9763,-1525.7477 1978.2847,-1572.2763 2040.8318,-1648.2448 1986.784,-1717.8251 2066.6759,-1775.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M849.3413,-92.2294C867.4761,-88.5899 887.8796,-84.6213 906.5706,-81.2763 1159.2065,-36.0644 1313.3492,87.798 1483.574,-104.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-104.2763C1509.9061,-132.3711 1530.6939,-127.3041 1548.821,-161.2763 1705.7618,-455.3995 1509.0647,-600.5357 1644.2388,-905.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2066.6759,-1775.2763C2132.2613,-1815.4747 2179.4018,-1897.767 2198.6866,-1935.9639"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2195.6222,-1937.6636 2203.1825,-1945.086 2201.901,-1934.569 2195.6222,-1937.6636"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-905.2763C1671.1585,-965.965 1747.6566,-1444.8427 1803.1578,-1481.2763"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M870.811,-95.6353C1011.2393,-82.9951 1306.931,-64.9698 1382.3269,-128.2763 1646.1462,-349.7935 1499.2002,-544.383 1548.821,-885.2763 1580.5942,-1103.557 1519.1749,-1169.69 1584.821,-1380.2763 1594.4292,-1411.0984 1614.9582,-1442.5194 1629.176,-1461.9524"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1626.4041,-1464.0899 1635.2025,-1469.9923 1632.0053,-1459.8914 1626.4041,-1464.0899"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1942.2453,-1966.2443C1950.5871,-1917.3869 1988.8204,-1725.0939 2066.6759,-1775.2763"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1974.6245,-1966.1811C1989.4959,-1961.3498 2007.1062,-1955.6288 2022.9213,-1950.4909"/>
<polygon fill="#ff4800" stroke="#ff4800" points="2024.0667,-1953.7989 2032.496,-1947.3804 2021.9038,-1947.1414 2024.0667,-1953.7989"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1978.3373,-1977.2763C1986.4782,-1977.2763 1995.2901,-1977.2763 2004.0886,-1977.2763"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2004.3702,-1980.7764 2014.3702,-1977.2763 2004.3702,-1973.7764 2004.3702,-1980.7764"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-571.2817 -.2403,-571.2817 -.2403,-549.2709 130.719,-549.2709 130.719,-571.2817"/>
<text text-anchor="middle" x="65.2394" y="-557.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1940.4719,-2734.2763C1975.3832,-2690.3745 2021.0454,-2766.8956 2066.6759,-2734.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2239.2763C444.6963,-2262.085 503.6622,-2258.9938 546.1148,-2252.0602"/>
<polygon fill="#ff0000" stroke="#ff0000" points="546.7452,-2255.5032 555.9912,-2250.3299 545.5372,-2248.6082 546.7452,-2255.5032"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M795.9847,-2696.2763C1016.3595,-2738.7785 1583.8441,-2668.9521 1803.1578,-2621.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M223.8406,-1972.2763C311.2493,-2070.6567 223.0156,-2161.3641 317.2024,-2253.2763 325.9286,-2261.7918 337.4699,-2267.4169 349.1262,-2271.1296"/>
<polygon fill="#ff9100" stroke="#ff9100" points="348.3147,-2274.5364 358.8852,-2273.82 350.1751,-2267.7882 348.3147,-2274.5364"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M223.8406,-1972.2763C265.9828,-2019.7083 273.8687,-1910.6224 317.2024,-1864.2763 337.858,-1842.1848 362.6883,-1817.923 379.5502,-1801.7668"/>
<polygon fill="#ffda00" stroke="#ffda00" points="382.3146,-1803.9668 387.1345,-1794.5317 377.4829,-1798.9018 382.3146,-1803.9668"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M1145.9073,-66.2763C1252.1826,-90.9106 1310.8531,-49.8581 1382.3269,-132.2763 1433.1736,-190.9089 1474.1815,-764.9808 1482.165,-883.8144"/>
<polygon fill="#daff00" stroke="#daff00" points="1478.6955,-884.39 1482.8519,-894.1355 1485.6801,-883.9251 1478.6955,-884.39"/>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M795.9847,-64.2763C951.1388,-74.9929 996.3221,-23.7101 1145.9073,-66.2763"/>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M601.1821,-64.2763C687.5798,-69.8762 709.6892,-57.2767 795.9847,-64.2763"/>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M223.8406,-134.2763C269.0205,-95.1304 409.6415,-51.8616 601.1821,-64.2763"/>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M66.5829,-548.9197C73.8324,-489.4323 110.0582,-214.1601 166.4788,-153.2763 184.7333,-133.5778 203.0903,-151.3258 223.8406,-134.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M223.8406,-1972.2763C275.5718,-2030.5009 321.534,-1979.5037 399.0839,-1972.2763"/>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M399.0839,-1972.2763C546.4089,-1958.546 706.6772,-1873.5373 769.0462,-1837.4498"/>
<polygon fill="#91ff00" stroke="#91ff00" points="770.9962,-1840.3641 777.8623,-1832.2952 767.463,-1834.3211 770.9962,-1840.3641"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M399.0839,-2239.2763C409.3113,-2244.3906 589.8492,-2279.7997 601.1821,-2278.2763"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M601.1821,-2278.2763C639.2105,-2273.1644 653.9629,-2281.2778 685.3989,-2259.2763 740.46,-2220.7401 774.5608,-2145.1386 788.5908,-2108.3656"/>
<polygon fill="#48ff00" stroke="#48ff00" points="791.985,-2109.2772 792.1598,-2098.6838 785.417,-2106.856 791.985,-2109.2772"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1940.4719,-2734.2763C2000.9574,-2687.6037 2054.3659,-2116.9043 2064.8256,-1998.6431"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2068.3395,-1998.6375 2065.7264,-1988.37 2061.3662,-1998.0261 2068.3395,-1998.6375"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-2696.2763C1294.6384,-2798.0885 1537.5412,-3045.1911 1940.4719,-2734.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M795.9847,-1898.2763C826.9539,-1870.3199 849.6535,-1877.3752 870.5706,-1841.2763 931.4862,-1736.1471 860.2059,-1682.5847 906.5706,-1570.2763 919.0501,-1540.0473 943.4986,-1510.9907 960.6804,-1492.9155"/>
<polygon fill="#00ff48" stroke="#00ff48" points="963.5164,-1495.0207 967.9944,-1485.4186 958.5059,-1490.1324 963.5164,-1495.0207"/>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M399.0839,-1972.2763C527.4465,-1963.27 559.5797,-1956.2503 685.3989,-1929.2763 697.8764,-1926.6013 786.5124,-1906.8271 795.9847,-1898.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M223.8406,-311.2763C249.4845,-297.9579 455.6843,-336.2814 480.9653,-350.2763 512.6954,-367.8412 876.5363,-824.9474 906.5706,-845.2763 912.3189,-849.1671 918.7303,-852.5063 925.3021,-855.358"/>
<polygon fill="#00ff91" stroke="#00ff91" points="924.4006,-858.7654 934.9867,-859.1946 926.9788,-852.2575 924.4006,-858.7654"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M1145.9073,-66.2763C1208.6493,-80.8197 1266.59,-134.2078 1294.0166,-162.8413"/>
<polygon fill="#00ffda" stroke="#00ffda" points="1291.5293,-165.3057 1300.9217,-170.2082 1296.6366,-160.5186 1291.5293,-165.3057"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M223.8406,-1972.2763C291.4125,-2048.3299 248.4633,-1838.2767 317.2024,-1763.2763 385.8291,-1688.3986 423.116,-1691.1169 516.9653,-1652.2763 588.8889,-1622.5099 627.3972,-1656.1881 685.3989,-1604.2763 716.8866,-1576.0947 693.01,-1547.5772 721.3989,-1516.2763 833.305,-1392.8914 933.8688,-1457.8793 1052.825,-1341.2763 1076.4084,-1318.1594 1064.4135,-1298.517 1088.825,-1276.2763 1092.675,-1272.7686 1097.0956,-1269.6961 1101.736,-1267.0192"/>
<polygon fill="#00daff" stroke="#00daff" points="1103.5395,-1270.0277 1110.8386,-1262.3483 1100.3437,-1263.7998 1103.5395,-1270.0277"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M223.8406,-791.2763C320.5715,-857.1876 370.2464,-810.2964 480.9653,-848.2763 536.8974,-867.4627 548.9317,-877.5923 601.1821,-905.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-64.2763C651.5257,-67.5393 707.9341,-79.8052 747.0424,-89.721"/>
<polygon fill="#0000ff" stroke="#0000ff" points="746.2894,-93.1412 756.8467,-92.2495 748.0376,-86.363 746.2894,-93.1412"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1145.9073,-2544.2763C1389.9479,-2464.6686 1475.2016,-2511.3297 1703.6565,-2394.2763 1753.1813,-2368.9013 1759.239,-2352.4484 1803.1578,-2318.2763"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-860.2817 180.0456,-860.2817 180.0456,-838.2709 267.6355,-838.2709 267.6355,-860.2817"/>
<text text-anchor="middle" x="223.8406" y="-846.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M67.6225,-571.328C75.9267,-607.8722 106.4087,-726.9364 166.4788,-805.2763 174.5933,-815.8588 185.8531,-825.2363 196.2496,-832.5861"/>
<polygon fill="#da00ff" stroke="#da00ff" points="194.4407,-835.5875 204.6916,-838.2651 198.3478,-829.7794 194.4407,-835.5875"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M399.0839,-2239.2763C415.8977,-2247.6841 1036.166,-2072.987 1052.825,-2064.2763 1080.0892,-2050.0203 1379.571,-1784.2174 1382.3269,-1780.2763 1453.8661,-1677.9712 1368.7463,-1567.2539 1483.574,-1518.2763"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M223.8406,-1972.2763C300.7014,-2058.197 232.8096,-2135.7408 317.2024,-2214.2763 345.0572,-2240.1979 365.4674,-2221.4507 399.0839,-2239.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M795.9847,-1898.2763C828.7193,-1872.4093 849.2363,-1877.1302 870.5706,-1841.2763 923.4787,-1752.36 838.0971,-1688.8441 906.5706,-1611.2763 910.3403,-1607.0059 914.9152,-1603.5783 919.9169,-1600.8307"/>
<polygon fill="#ff0091" stroke="#ff0091" points="921.6321,-1603.8963 929.2994,-1596.5844 918.7458,-1597.519 921.6321,-1603.8963"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M223.8406,-1972.2763C338.2049,-2100.9957 198.0161,-1720.5442 317.2024,-1596.2763 343.4524,-1568.9071 361.2519,-1574.8994 399.0839,-1572.2763"/>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M65.7211,-571.4821C71.2702,-698.2882 124.7155,-1860.7089 223.8406,-1972.2763"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5702,-2288.2817 723.3993,-2288.2817 723.3993,-2266.2709 868.5702,-2266.2709 868.5702,-2288.2817"/>
<text text-anchor="middle" x="795.9847" y="-2274.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2278.2763C637.6385,-2273.3757 678.28,-2272.4588 712.97,-2273.025"/>
<polygon fill="#ff0000" stroke="#ff0000" points="712.989,-2276.5261 723.0592,-2273.2337 713.1338,-2269.5276 712.989,-2276.5261"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-64.2763C971.5276,-73.8034 1200.6183,-288.7318 1202.9897,-292.2763 1255.6468,-370.9805 1217.9592,-409.9463 1238.9897,-502.2763 1258.6596,-588.6327 1290.0665,-689.4237 1303.8256,-732.2793"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1300.5228,-733.4412 1306.9255,-741.8825 1307.1843,-731.2908 1300.5228,-733.4412"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-755.2763C1012.1888,-753.5217 1048.3022,-752.9247 1078.5439,-752.806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1078.569,-756.306 1088.561,-752.7831 1078.553,-749.3061 1078.569,-756.306"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-791.2763C258.4565,-816.5207 275.1748,-775.5963 317.2024,-767.2763 405.1471,-749.8664 427.5311,-745.5136 516.9653,-739.2763 673.7731,-728.3402 713.6651,-736.8451 870.5706,-746.2763 919.1485,-749.1962 931.1029,-757.9006 979.6978,-755.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M69.8721,-571.5029C85.6807,-608.4686 141.1425,-727.6411 223.8406,-791.2763"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-152.2817 554.5531,-152.2817 554.5531,-130.2709 647.8111,-130.2709 647.8111,-152.2817"/>
<text text-anchor="middle" x="601.1821" y="-138.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-134.2763C282.7046,-83.2739 321.2545,-137.2429 399.0839,-134.2763"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-134.2763C447.9771,-132.4127 503.5324,-134.6529 544.005,-137.0809"/>
<polygon fill="#00ff00" stroke="#00ff00" points="544.0189,-140.5884 554.2171,-137.7166 544.4539,-133.602 544.0189,-140.5884"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-225.2817 353.1239,-225.2817 353.1239,-203.2709 445.0438,-203.2709 445.0438,-225.2817"/>
<text text-anchor="middle" x="399.0839" y="-211.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-311.2763C270.343,-287.1249 270.6425,-263.3167 317.2024,-239.2763 325.3493,-235.0698 334.3244,-231.4389 343.2555,-228.3505"/>
<polygon fill="#00ffff" stroke="#00ffff" points="344.4653,-231.6375 352.8882,-225.2106 342.2958,-224.9821 344.4653,-231.6375"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-311.2763C263.7651,-290.5824 273.2645,-281.8506 317.2024,-272.2763 421.2171,-249.611 695.9529,-219.8566 795.9847,-256.2763"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-611.2817 334.3841,-611.2817 334.3841,-589.2709 463.7837,-589.2709 463.7837,-611.2817"/>
<text text-anchor="middle" x="399.0839" y="-597.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-311.2763C334.2875,-253.9147 227.3031,-489.2124 317.2024,-575.2763 320.9971,-578.9091 325.3047,-582.0153 329.9113,-584.6711"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="328.5713,-587.9138 339.0824,-589.2432 331.6945,-581.6492 328.5713,-587.9138"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-879.2817 344.7839,-879.2817 344.7839,-857.2709 453.3838,-857.2709 453.3838,-879.2817"/>
<text text-anchor="middle" x="399.0839" y="-865.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-791.2763C266.2912,-818.3219 319.8551,-840.3186 356.5213,-853.7733"/>
<polygon fill="#ff0000" stroke="#ff0000" points="355.3319,-857.065 365.9262,-857.1732 357.7117,-850.4819 355.3319,-857.065"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-184.2817 168.8556,-184.2817 168.8556,-162.2709 278.8255,-162.2709 278.8255,-184.2817"/>
<text text-anchor="middle" x="223.8406" y="-170.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M69.225,-549.148C82.3434,-512.6967 125.6707,-393.6975 166.4788,-297.2763 182.0911,-260.3876 202.0672,-218.2074 213.8559,-193.7696"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.1608,-194.9752 218.3703,-184.4496 210.861,-191.9236 217.1608,-194.9752"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-184.2817 340.6161,-184.2817 340.6161,-162.2709 457.5516,-162.2709 457.5516,-184.2817"/>
<text text-anchor="middle" x="399.0839" y="-170.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M68.0543,-549.1354C79.1847,-507.792 124.4558,-362.8926 223.8406,-311.2763"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-311.2763C282.8794,-280.614 261.3442,-230.4098 317.2024,-194.2763 321.5575,-191.4591 326.2708,-189.0194 331.1604,-186.9069"/>
<polygon fill="#00ffff" stroke="#00ffff" points="332.6503,-190.0841 340.7329,-183.2341 330.1427,-183.5486 332.6503,-190.0841"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-381.2817 323.0941,-381.2817 323.0941,-359.2709 475.0737,-359.2709 475.0737,-381.2817"/>
<text text-anchor="middle" x="399.0839" y="-367.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-311.2763C263.0304,-290.9227 275.323,-331.2682 317.2024,-345.2763 328.3226,-348.9959 340.3651,-352.7971 351.7053,-356.2764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.8636,-359.6787 361.4494,-359.241 352.9012,-352.9818 350.8636,-359.6787"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-303.2817 317.3208,-303.2817 317.3208,-281.2709 480.847,-281.2709 480.847,-303.2817"/>
<text text-anchor="middle" x="399.0839" y="-289.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-311.2763C248.9958,-298.2117 278.8892,-292.1138 306.7989,-289.6515"/>
<polygon fill="#00ffff" stroke="#00ffff" points="307.263,-293.1269 316.9793,-288.9027 306.7494,-286.1458 307.263,-293.1269"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-791.2763C249.6317,-807.708 259.9847,-807.2537 281.2024,-829.2763 302.5154,-851.3978 296.3675,-865.704 317.2024,-888.2763 391.6123,-968.8912 418.5756,-984.7472 516.9653,-1033.2763 525.4929,-1037.4824 534.8616,-1041.1225 544.1561,-1044.2229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.187,-1047.5871 553.7767,-1047.2595 545.294,-1040.9118 543.187,-1047.5871"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2544.2763C1470.029,-2489.7914 1731.2329,-2124.6413 1790.5142,-2035.7541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1793.4534,-2037.6546 1796.0431,-2027.3812 1787.612,-2033.7974 1793.4534,-2037.6546"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2696.2763C877.8543,-2718.2995 1061.4598,-2551.7772 1145.9073,-2544.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2506.2763C526.3585,-2605.0955 572.5775,-2610.5007 721.3989,-2672.2763 753.5612,-2685.6268 763.107,-2684.8001 795.9847,-2696.2763"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540.9771,-2176.2817 1426.1709,-2176.2817 1426.1709,-2154.2709 1540.9771,-2154.2709 1540.9771,-2176.2817"/>
<text text-anchor="middle" x="1483.574" y="-2162.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2506.2763C472.9508,-2559.7782 1117.3611,-2371.6849 1202.9897,-2340.2763 1285.9793,-2309.8357 1308.5875,-2303.0246 1382.3269,-2254.2763 1414.0707,-2233.2909 1446.3348,-2203.0595 1465.6524,-2183.793"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1468.3172,-2186.0761 1472.8646,-2176.5068 1463.3422,-2181.1517 1468.3172,-2186.0761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1972.2763C390.3782,-2158.4443 201.785,-2353.0886 399.0839,-2506.2763"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1972.2763C301.0438,-2059.6444 365.5142,-2040.5413 480.9653,-2024.2763 832.1956,-1974.7941 921.0783,-1899.537 1202.9897,-1684.2763 1286.0319,-1620.8673 1335.1798,-1625.5172 1382.3269,-1532.2763 1434.9953,-1428.1161 1348.9282,-1102.1226 1418.3269,-1008.2763 1420.733,-1005.0226 1423.62,-1002.1924 1426.8216,-999.7305"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1428.759,-1002.6464 1435.3336,-994.3382 1425.0129,-996.7331 1428.759,-1002.6464"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.5931,-838.2108C258.0987,-830.6714 272.9253,-819.4827 281.2024,-805.2763 339.4872,-705.2397 254.1228,-644.3609 317.2024,-547.2763 363.9203,-475.3737 425.7873,-510.9112 480.9653,-445.2763 508.4227,-412.6154 489.601,-389.0152 516.9653,-356.2763 610.9939,-243.7797 649.3667,-180.2763 795.9847,-180.2763 795.9847,-180.2763 795.9847,-180.2763 979.6978,-180.2763 1206.1758,-180.2763 1328.6974,60.9676 1483.574,-104.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2200.2763C408.8592,-2209.7362 478.5087,-2221.7407 533.3458,-2229.9157"/>
<polygon fill="#ff0000" stroke="#ff0000" points="532.9916,-2233.4012 543.395,-2231.3961 534.0119,-2226.4759 532.9916,-2233.4012"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M979.6978,-1974.2763C1202.9382,-1936.1189 1257.096,-1898.2763 1483.574,-1898.2763 1483.574,-1898.2763 1483.574,-1898.2763 1644.2388,-1898.2763 1775.8979,-1898.2763 1813.6789,-1862.8125 1940.4719,-1898.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M224.4002,-860.3357C231.0014,-990.3903 294.1979,-2224.2653 317.2024,-2253.2763 325.0723,-2263.2011 336.7762,-2269.2885 348.8894,-2272.9937"/>
<polygon fill="#ff9100" stroke="#ff9100" points="348.071,-2276.3969 358.6263,-2275.4822 349.8044,-2269.6149 348.071,-2276.3969"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M399.0839,-561.2763C429.4031,-527.1528 445.9063,-528.5087 480.9653,-499.2763 497.6358,-485.3764 498.5722,-477.8004 516.9653,-466.2763 794.9076,-292.1325 925.0475,-368.4202 1202.9897,-194.2763 1221.3828,-182.7522 1218.7611,-169.1449 1238.9897,-161.2763 1298.3616,-138.1816 1335.1933,-118.4184 1382.3269,-161.2763 1413.542,-189.6598 1412.6199,-497.474 1418.3269,-539.2763 1436.3373,-671.198 1467.6888,-828.1677 1479.1858,-884.1561"/>
<polygon fill="#daff00" stroke="#daff00" points="1475.8197,-885.1624 1481.2685,-894.2487 1482.6752,-883.7477 1475.8197,-885.1624"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M399.0839,-1878.2763C440.8386,-1913.3446 463.3338,-1854.1201 516.9653,-1844.2763 593.0245,-1830.316 682.3119,-1824.8243 739.0091,-1822.6671"/>
<polygon fill="#91ff00" stroke="#91ff00" points="739.3377,-1826.1577 749.206,-1822.3018 739.087,-1819.1622 739.3377,-1826.1577"/>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M224.4504,-860.477C230.0152,-961.5366 272.8034,-1714.4219 317.2024,-1803.2763 339.2614,-1847.4223 361.8486,-1845.8879 399.0839,-1878.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M399.0839,-2010.2763C440.5546,-2061.5118 454.522,-2079.1641 516.9653,-2100.2763 593.238,-2126.0642 687.9397,-2112.934 745.0833,-2100.5199"/>
<polygon fill="#48ff00" stroke="#48ff00" points="745.9691,-2103.9082 754.9579,-2098.3001 744.4338,-2097.0786 745.9691,-2103.9082"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1974.2763C1345.1802,-1955.1093 1440.1172,-2023.6046 1803.1578,-1977.2763"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1803.1578,-1977.2763C1847.9858,-1972.2643 1857.7735,-1961.7427 1902.6592,-1957.2763 1936.1053,-1953.9482 1944.8812,-1953.5444 1978.2847,-1957.2763 1990.8695,-1958.6823 2004.278,-1961.1811 2016.7483,-1963.9465"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2015.9829,-1967.3618 2026.5145,-1966.2058 2017.5606,-1960.5419 2015.9829,-1967.3618"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M601.1821,-1552.2763C617.072,-1551.1616 817.7236,-1508.7689 920.2428,-1486.9597"/>
<polygon fill="#00ff48" stroke="#00ff48" points="921.0951,-1490.3568 930.1474,-1484.8517 919.6379,-1483.5101 921.0951,-1490.3568"/>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M399.0839,-1610.2763C440.1543,-1646.1436 464.5496,-1591.304 516.9653,-1576.2763 554.378,-1565.5501 562.2948,-1553.8694 601.1821,-1552.2763"/>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M224.5221,-860.4432C229.9862,-948.4361 267.7372,-1528.2406 317.2024,-1586.2763 341.8019,-1615.1381 370.5202,-1585.3313 399.0839,-1610.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M267.5369,-848.7116C283.2014,-848.5347 300.993,-848.3631 317.2024,-848.2763 389.9849,-847.8865 408.1995,-846.6722 480.9653,-848.2763 636.4658,-851.7043 819.0397,-861.1376 914.3118,-866.4718"/>
<polygon fill="#00ff91" stroke="#00ff91" points="914.1919,-869.9705 924.3729,-867.0381 914.5854,-862.9816 914.1919,-869.9705"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M399.0839,-561.2763C461.3185,-493.9214 706.8541,-469.8535 795.9847,-448.2763"/>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M795.9847,-448.2763C991.1922,-418.7091 1034.8292,-373.7278 1202.9897,-270.2763 1236.9076,-249.4102 1271.6112,-218.6957 1292.1381,-199.3514"/>
<polygon fill="#00ffda" stroke="#00ffda" points="1294.7103,-201.7347 1299.5281,-192.2986 1289.8774,-196.6708 1294.7103,-201.7347"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M399.0839,-1058.2763C432.4009,-1075.1773 445.7299,-1064.8612 480.9653,-1077.2763 536.9168,-1096.9906 542.3761,-1127.4609 601.1821,-1135.2763"/>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M601.1821,-1135.2763C720.1934,-1151.0931 773.5535,-1044.5547 870.5706,-1115.2763 912.8222,-1146.0761 865.9101,-1194.4045 906.5706,-1227.2763 956.6045,-1267.7261 1033.1036,-1268.1805 1086.0897,-1262.1297"/>
<polygon fill="#00daff" stroke="#00daff" points="1086.5393,-1265.6009 1096.028,-1260.8877 1085.6712,-1258.6549 1086.5393,-1265.6009"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M224.5455,-860.3631C230.3441,-950.2857 271.1187,-1558.5206 317.2024,-1624.2763 374.2995,-1705.7468 421.0319,-1698.9268 516.9653,-1725.2763 636.8223,-1758.1967 674.8451,-1772.1088 795.9847,-1744.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M228.7863,-860.3296C245.926,-897.0739 306.8233,-1015.2342 399.0839,-1058.2763"/>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M399.0839,-1058.2763C403.1196,-1060.1591 650.3923,-1010.6249 752.5531,-990.0446"/>
<polygon fill="#0048ff" stroke="#0048ff" points="753.4382,-993.4367 762.5495,-988.0299 752.0551,-986.5747 753.4382,-993.4367"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-561.2763C441.4868,-514.5395 450.7376,-500.6714 480.9653,-445.2763 501.4038,-407.8209 492.5454,-391.2665 516.9653,-356.2763 590.9024,-250.3353 716.9036,-157.2263 770.5692,-120.2426"/>
<polygon fill="#0000ff" stroke="#0000ff" points="772.8475,-122.9251 779.1327,-114.3959 768.9004,-117.144 772.8475,-122.9251"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M245.4917,-838.1511C257.9603,-830.5898 272.7835,-819.3992 281.2024,-805.2763 333.0579,-718.2877 248.1181,-654.326 317.2024,-580.2763 342.6872,-552.9598 373.7308,-588.7152 399.0839,-561.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1803.1578,-1977.2763C1832.6978,-1973.5067 1866.1043,-1973.4159 1892.5704,-1974.3113"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1892.5869,-1977.8146 1902.7177,-1974.7137 1892.8643,-1970.8201 1892.5869,-1977.8146"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M399.0839,-1878.2763C596.4281,-2049.9325 719.7936,-2003.6084 979.6978,-1974.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M601.1821,-1552.2763C721.324,-1547.3545 750.9222,-1539.2166 870.5706,-1527.2763 968.4378,-1517.5096 1215.1254,-1456.8912 1310.6583,-1480.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M795.9847,-1706.2763C859.6999,-1694.4973 849.5436,-1642.0381 906.5706,-1611.2763 911.0336,-1608.8688 915.8026,-1606.7112 920.6854,-1604.7825"/>
<polygon fill="#ff0091" stroke="#ff0091" points="921.954,-1608.0456 930.1652,-1601.3504 919.571,-1601.4637 921.954,-1608.0456"/>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M601.1821,-1552.2763C640.0694,-1550.6832 652.6694,-1555.2159 685.3989,-1576.2763 749.1885,-1617.3228 721.3941,-1720.0659 795.9847,-1706.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M399.0839,-1572.2763C514.3426,-1564.2847 576.1188,-1405.3355 594.9083,-1347.2756"/>
<polygon fill="#ff0048" stroke="#ff0048" points="598.3604,-1347.9634 598.0083,-1337.3744 591.6802,-1345.8718 598.3604,-1347.9634"/>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M224.0634,-860.5141C226.1817,-952.8584 246.2403,-1582.874 399.0839,-1572.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2200.2763C421.9951,-2222.448 654.7111,-2210.6293 685.3989,-2219.2763 716.986,-2228.1767 749.8835,-2246.8308 771.4975,-2260.5917"/>
<polygon fill="#ff0000" stroke="#ff0000" points="769.7426,-2263.6255 780.033,-2266.1469 773.561,-2257.7587 769.7426,-2263.6255"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1768,-860.3373C227.4471,-965.3117 254.8272,-1787.2961 317.2024,-2024.2763 339.1623,-2107.708 338.2703,-2139.0816 399.0839,-2200.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-676.2763C658.3652,-665.37 665.3889,-640.1423 721.3989,-624.2763 864.6016,-583.7112 905.5832,-598.0115 1052.825,-576.2763 1094.2117,-570.167 1107.8722,-544.8545 1145.9073,-562.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M239.7091,-838.1482C251.5327,-829.6116 267.8685,-817.2903 281.2024,-805.2763 298.486,-789.7035 297.5071,-779.6589 317.2024,-767.2763 429.4044,-696.7338 469.8159,-693.8386 601.1821,-676.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M251.1813,-838.1934C312.5541,-814.2401 466.46,-759.3085 601.1821,-753.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-753.2763C768.7603,-738.464 812.0762,-769.5894 979.6978,-755.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M246.0408,-838.1296C258.5426,-830.6251 273.2099,-819.501 281.2024,-805.2763 354.3391,-675.1119 231.7422,-593.7031 317.2024,-471.2763 363.6804,-404.6938 432.7727,-455.6285 480.9653,-390.2763 540.8103,-309.1229 450.4176,-242.0306 516.9653,-166.2763 524.2866,-157.9422 534.2459,-152.3258 544.7532,-148.5555"/>
<polygon fill="#00ff00" stroke="#00ff00" points="545.951,-151.8494 554.4969,-145.587 543.9109,-145.1533 545.951,-151.8494"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M246.2483,-838.2435C258.8238,-830.7794 273.4954,-819.6577 281.2024,-805.2763 337.2768,-700.6401 259.1486,-375.8275 317.2024,-272.2763 327.553,-253.8138 346.5227,-239.8116 363.5987,-230.1945"/>
<polygon fill="#00ffff" stroke="#00ffff" points="365.6289,-233.0796 372.8237,-225.3024 362.3493,-226.8954 365.6289,-233.0796"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M795.9847,-448.2763C875.3427,-429.0649 898.3724,-440.9999 979.6978,-448.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-854.0218C287.918,-856.2236 312.4607,-858.8846 334.8156,-861.3083"/>
<polygon fill="#ff0000" stroke="#ff0000" points="334.5907,-864.8043 344.9098,-862.4027 335.3453,-857.8451 334.5907,-864.8043"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M246.2933,-838.2674C258.8846,-830.8119 273.5573,-819.6906 281.2024,-805.2763 344.9326,-685.1178 230.6988,-299.237 317.2024,-194.2763 321.089,-189.5605 325.8776,-185.8232 331.1719,-182.8708"/>
<polygon fill="#00ffff" stroke="#00ffff" points="332.8514,-185.9515 340.4895,-178.6092 329.9397,-179.5857 332.8514,-185.9515"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M246.1434,-838.1866C258.6816,-830.7023 273.351,-819.5793 281.2024,-805.2763 325.2137,-725.1 259.6192,-466.3355 317.2024,-395.2763 319.8123,-392.0556 322.8255,-389.2399 326.123,-386.7792"/>
<polygon fill="#ff0000" stroke="#ff0000" points="328.1903,-389.6153 334.8378,-381.3654 324.4965,-383.6693 328.1903,-389.6153"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M246.1882,-838.2111C258.7424,-830.7355 273.4127,-819.6131 281.2024,-805.2763 378.0481,-627.0328 216.9852,-526.6462 317.2024,-350.2763 327.6591,-331.8737 346.6343,-317.8745 363.6866,-308.2441"/>
<polygon fill="#00ffff" stroke="#00ffff" points="365.7124,-311.1308 372.8959,-303.3432 362.4238,-304.9514 365.7124,-311.1308"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-1716.2817 516.748,-1716.2817 516.748,-1694.2709 685.6163,-1694.2709 685.6163,-1716.2817"/>
<text text-anchor="middle" x="601.1821" y="-1702.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1610.2763C444.9788,-1650.3569 461.1366,-1655.8643 516.9653,-1680.2763 526.293,-1684.355 536.4821,-1688.0064 546.4491,-1691.176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="545.7159,-1694.6115 556.3021,-1694.183 547.7592,-1687.9163 545.7159,-1694.6115"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1058.2763C444.0268,-1079.2434 500.9505,-1077.0573 542.9241,-1070.8935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.6579,-1074.3209 552.9866,-1069.2984 542.5619,-1067.4072 543.6579,-1074.3209"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2010.2763C464.3294,-2087.8755 1214.2059,-2019.0426 1310.6583,-2050.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0039,-860.6107C225.7278,-973.5302 242.0501,-1894.0614 317.2024,-1986.2763 341.1599,-2015.6732 374.5816,-1981.3319 399.0839,-2010.2763"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-676.2763C730.8059,-641.0176 1082.9923,-672.8932 1202.9897,-733.2763 1224.3548,-744.0273 1221.5702,-756.887 1238.9897,-773.2763 1268.6312,-801.1646 1276.2056,-808.6111 1310.6583,-830.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-830.2763C1346.8483,-852.9471 1355.5701,-860.9934 1382.3269,-894.2763 1402.775,-919.7118 1393.6232,-936.95 1418.3269,-958.2763 1422.5737,-961.9425 1427.4157,-965.1 1432.4992,-967.813"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1431.2976,-971.1164 1441.8338,-972.23 1434.2917,-964.789 1431.2976,-971.1164"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1108.2817 334.8633,-1108.2817 334.8633,-1086.2709 463.3044,-1086.2709 463.3044,-1108.2817"/>
<text text-anchor="middle" x="399.0839" y="-1094.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.1761,-860.4486C230.1052,-896.6755 250.5913,-1012.0239 317.2024,-1072.2763 321.2671,-1075.953 325.8597,-1079.0892 330.7439,-1081.7643"/>
<polygon fill="#ff0000" stroke="#ff0000" points="329.268,-1084.9381 339.799,-1086.0987 332.2903,-1078.6242 329.268,-1084.9381"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1298.2817 354.6193,-1298.2817 354.6193,-1276.2709 443.5485,-1276.2709 443.5485,-1298.2817"/>
<text text-anchor="middle" x="399.0839" y="-1284.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.6067,-860.2832C228.1955,-905.8869 246.2888,-1083.3654 317.2024,-1206.2763 332.0206,-1231.9599 357.1459,-1255.0672 375.6654,-1269.9651"/>
<polygon fill="#00ff00" stroke="#00ff00" points="373.6164,-1272.8059 383.6488,-1276.2122 377.9303,-1267.2931 373.6164,-1272.8059"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860.8052,-1146.2817 731.1643,-1146.2817 731.1643,-1124.2709 860.8052,-1124.2709 860.8052,-1146.2817"/>
<text text-anchor="middle" x="795.9847" y="-1132.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1135.2763C640.5597,-1140.5096 684.8116,-1140.9407 721.1754,-1139.8745"/>
<polygon fill="#0000ff" stroke="#0000ff" points="721.3354,-1143.3712 731.2121,-1139.5368 721.1,-1136.3752 721.3354,-1143.3712"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1703.9142,-1471.1108C1734.5832,-1468.3773 1771.9644,-1469.0007 1803.1578,-1481.2763"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.8954,-1492.6225C1649.025,-1560.3545 1673.4032,-1911.0588 1739.6565,-1991.2763 1742.4151,-1994.6164 1745.6811,-1997.5123 1749.2532,-2000.0229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1747.6571,-2003.1449 1758.049,-2005.2091 1751.2125,-1997.115 1747.6571,-2003.1449"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1518.2763C1461.3899,-1513.8357 1501.1197,-1627.7806 1644.2388,-1580.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-1580.2763C1722.929,-1553.2109 1725.7234,-1450.8033 1803.1578,-1481.2763"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1029.9065,-1598.6784C1177.6831,-1624.9667 1620.7575,-1715.0458 1940.4719,-1898.2763"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M1940.4719,-1898.2763C1967.587,-1905.8603 1997.7926,-1914.9328 2021.8536,-1922.3108"/>
<polygon fill="#ff4800" stroke="#ff4800" points="2020.8376,-1925.66 2031.4248,-1925.2555 2022.8961,-1918.9695 2020.8376,-1925.66"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1017.9361,-1579.2654C1092.1787,-1558.3351 1253.5586,-1515.1487 1310.6583,-1518.2763"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1310.6583,-1518.2763C1387.4764,-1516.0132 1414.0242,-1550.9713 1483.574,-1518.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1327.2763C1055.3062,-1330.548 1070.2863,-1287.3108 1145.9073,-1290.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M650.9585,-1323.563C690.3999,-1322.0666 746.8513,-1321.3777 795.9847,-1326.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1290.2763C1187.5876,-1291.9108 1197.3631,-1299.6042 1238.9897,-1302.2763 1302.5643,-1306.3574 1320.2897,-1316.7597 1382.3269,-1302.2763 1431.1994,-1290.8664 1434.6107,-1241.2624 1483.574,-1252.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1326.2763C877.2334,-1334.3768 898.1227,-1323.7465 979.6978,-1327.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M606.7341,-1337.4412C621.9095,-1368.4581 664.3504,-1458.636 685.3989,-1538.2763 700.1907,-1594.2434 684.4163,-1751.7409 721.3989,-1796.2763 726.4293,-1802.3341 732.9771,-1806.9313 740.1037,-1810.4185"/>
<polygon fill="#91ff00" stroke="#91ff00" points="738.7919,-1813.6635 749.3695,-1814.2685 741.4779,-1807.1993 738.7919,-1813.6635"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M629.6323,-1337.4004C696.9301,-1363.7139 865.9303,-1429.7931 941.796,-1459.4567"/>
<polygon fill="#00ff48" stroke="#00ff48" points="940.8458,-1462.8431 951.4338,-1463.2251 943.3949,-1456.3238 940.8458,-1462.8431"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M608.3438,-1337.6413C625.5995,-1364.4792 671.7395,-1433.0736 721.3989,-1480.2763 794.282,-1549.5538 815.8464,-1566.9123 906.5706,-1610.2763 911.7621,-1612.7577 917.3043,-1615.0027 922.9275,-1617.0199"/>
<polygon fill="#0091ff" stroke="#0091ff" points="921.8258,-1620.342 932.4197,-1620.2012 924.0503,-1613.7048 921.8258,-1620.342"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M607.5094,-1315.0163C622.7599,-1287.4888 662.0123,-1214.2786 685.3989,-1149.2763 707.5862,-1087.6076 676.8692,-1054.3639 721.3989,-1006.2763 729.5805,-997.441 740.9741,-991.7262 752.3965,-988.0305"/>
<polygon fill="#0048ff" stroke="#0048ff" points="753.6565,-991.3135 762.3619,-985.2747 751.7908,-984.5667 753.6565,-991.3135"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1145.9073,-1290.2763C1192.3426,-1297.2813 1195.2726,-1323.1267 1238.9897,-1340.2763 1437.656,-1418.21 1559.8402,-1303.6095 1703.6565,-1461.2763 1770.1308,-1534.1525 1703.1853,-1588.6268 1739.6565,-1680.2763 1786.0323,-1796.8151 1883.8269,-1913.9117 1923.3555,-1958.4783"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1920.9651,-1961.0555 1930.2428,-1966.1717 1926.1806,-1956.3866 1920.9651,-1961.0555"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1310.6583,-1480.2763C1349.0397,-1488.9198 1447.6437,-1534.303 1483.574,-1518.2763"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M979.6978,-1327.2763C1088.4053,-1334.0902 1109.7309,-1372.0042 1202.9897,-1428.2763 1220.3449,-1438.7483 1221.125,-1446.6995 1238.9897,-1456.2763 1268.5953,-1472.1471 1277.8878,-1472.8964 1310.6583,-1480.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M615.4451,-1337.3164C637.7861,-1354.5264 682.5047,-1388.6428 721.3989,-1416.2763 805.2834,-1475.8744 907.1974,-1543.0232 953.9751,-1573.5589"/>
<polygon fill="#ff0091" stroke="#ff0091" points="952.2853,-1576.6354 962.5738,-1579.1648 956.1083,-1570.7715 952.2853,-1576.6354"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M604.82,-1315.1193C616.4763,-1280.923 656.0055,-1176.2065 721.3989,-1115.2763 895.081,-953.4484 1031.835,-1048.7749 1202.9897,-884.2763 1227.6448,-860.5801 1217.8002,-843.1163 1238.9897,-816.2763 1252.7195,-798.8853 1271.6658,-782.4697 1286.63,-770.7574"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1289.0879,-773.2843 1294.911,-764.4331 1284.8392,-767.7211 1289.0879,-773.2843"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M607.7506,-1315.0992C623.5366,-1287.7557 663.888,-1214.9231 685.3989,-1149.2763 711.8896,-1068.4322 677.4129,-1034.0964 721.3989,-961.2763 759.359,-898.4323 906.6467,-762.6166 979.6978,-755.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M979.6978,-638.2763C1007.814,-606.2592 1023.7795,-607.453 1052.825,-576.2763 1085.3532,-541.3612 1116.8007,-495.0115 1133.5167,-469.0557"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1136.5622,-470.7892 1138.9834,-460.4747 1130.6585,-467.028 1136.5622,-470.7892"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M608.1062,-1315.2075C624.6818,-1288.1046 666.6537,-1215.7657 685.3989,-1149.2763 726.6322,-1003.0218 642.5246,-939.1586 721.3989,-809.2763 792.8616,-691.5988 888.8517,-741.7264 979.6978,-638.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1326.2763C1066.6786,-1354.6922 1533.9981,-1879.205 1644.2388,-1936.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-1936.2763C1688.7706,-1956.5956 1695.5592,-1970.0305 1739.6565,-1991.2763 1747.0932,-1994.8593 1755.1855,-1998.3437 1763.0257,-2001.5178"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1761.8164,-2004.8033 1772.403,-2005.2215 1764.3878,-1998.2927 1761.8164,-2004.8033"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M625.3829,-1315.1826C676.5937,-1291.9374 799.9782,-1237.1437 906.5706,-1199.2763 1036.0666,-1153.2723 1080.2209,-1173.0291 1202.9897,-1111.2763 1220.8568,-1102.2892 1221.2806,-1093.5707 1238.9897,-1084.2763 1268.7334,-1068.6658 1280.4927,-1075.055 1310.6583,-1060.2763"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M606.1853,-1315.1533C620.0764,-1285.5076 662.0436,-1203.8918 721.3989,-1160.2763 726.7967,-1156.31 732.8639,-1152.9458 739.1459,-1150.0986"/>
<polygon fill="#0000ff" stroke="#0000ff" points="740.5235,-1153.3166 748.4506,-1146.2871 737.8701,-1146.839 740.5235,-1153.3166"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M868.801,-2284.6881C1071.0705,-2306.0841 1635.8685,-2371.5385 1803.1578,-2451.2763"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M802.4733,-2266.216C817.5981,-2239.7988 855.0829,-2170.511 870.5706,-2107.2763 927.4749,-1874.941 822.5394,-1794.2329 906.5706,-1570.2763 918.0593,-1539.657 942.7253,-1510.6861 960.2277,-1492.7372"/>
<polygon fill="#00ff48" stroke="#00ff48" points="963.0788,-1494.8373 967.6923,-1485.2996 958.138,-1489.8786 963.0788,-1494.8373"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.0389,-2266.2234C878.5496,-2249.2925 974.5185,-2215.0153 1052.825,-2178.2763 1095.7257,-2158.1486 1099.8216,-2137.3079 1145.9073,-2126.2763"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M1361.0468,-764.325C1368.8859,-767.7849 1376.3524,-772.3237 1382.3269,-778.2763 1416.3826,-812.2075 1384.7888,-845.8336 1418.3269,-880.2763 1421.7438,-883.7853 1425.7058,-886.8093 1429.956,-889.414"/>
<polygon fill="#daff00" stroke="#daff00" points="1428.5257,-892.6168 1439.0027,-894.1927 1431.7952,-886.4272 1428.5257,-892.6168"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1327.7773,-764.3068C1343.9718,-775.5633 1367.8876,-794.4445 1382.3269,-816.2763 1410.471,-858.8295 1390.301,-882.6452 1418.3269,-925.2763 1428.8759,-941.3227 1444.9657,-955.6929 1458.5275,-966.1155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1456.4539,-968.935 1466.5729,-972.0745 1460.6203,-963.31 1456.4539,-968.935"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1197.5948,-764.3154C1262.9907,-778.697 1368.7877,-803.5077 1382.3269,-816.2763 1419.4432,-851.2799 1381.6146,-889.8493 1418.3269,-925.2763 1461.7948,-967.2224 1510.5206,-916.5643 1548.821,-963.2763 1607.7945,-1035.2015 1556.5408,-1291.6685 1584.821,-1380.2763 1594.691,-1411.2008 1615.3405,-1442.813 1629.4976,-1462.2418"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1626.6982,-1464.3427 1635.4833,-1470.2649 1632.3089,-1460.1568 1626.6982,-1464.3427"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1203.0669,-753.2763C1212.4478,-753.2763 1222.3115,-753.2763 1232.1031,-753.2763"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1232.2576,-756.7764 1242.2576,-753.2763 1232.2575,-749.7764 1232.2576,-756.7764"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1163.2166,-764.4932C1181.5173,-776.0237 1211.4869,-793.982 1238.9897,-806.2763 1269.6565,-819.9849 1281.9916,-812.7666 1310.6583,-830.2763"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-611.2817 166.6166,-611.2817 166.6166,-589.2709 281.0645,-589.2709 281.0645,-611.2817"/>
<text text-anchor="middle" x="223.8406" y="-597.1263" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M601.1821,-905.2763C651.2649,-931.8118 712.715,-954.2485 753.0393,-967.7162"/>
<polygon fill="#0048ff" stroke="#0048ff" points="751.9715,-971.0494 762.5647,-970.8618 754.1667,-964.4025 751.9715,-971.0494"/>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M399.0839,-639.2763C535.8574,-697.0465 469.9859,-835.7642 601.1821,-905.2763"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M228.4453,-611.647C239.488,-639.4203 267.5685,-713.1351 281.2024,-777.2763 296.9994,-851.5938 279.3903,-1051.3757 317.2024,-1117.2763 348.0541,-1171.0461 507.8443,-1270.5569 573.2374,-1309.7741"/>
<polygon fill="#ff0048" stroke="#ff0048" points="571.7938,-1312.9885 582.1741,-1315.1101 575.3825,-1306.9784 571.7938,-1312.9885"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-562.2763C1223.2998,-599.2385 1278.7026,-691.4364 1300.4645,-732.7206"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1297.4669,-734.5446 1305.1549,-741.8347 1303.691,-731.3414 1297.4669,-734.5446"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.6433,-589.1944C246.0858,-569.6039 279.0177,-529.06 317.2024,-509.2763 479.4307,-425.2248 539.4578,-451.0133 721.3989,-434.2763 787.4187,-428.203 813.5605,-400.4333 870.5706,-434.2763 899.3026,-451.3326 880.2249,-479.7251 906.5706,-500.2763 993.2111,-567.8611 1046.7524,-514.9204 1145.9073,-562.2763"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-639.2763C495.717,-680.0921 767.4414,-643.0864 870.5706,-662.2763 959.6148,-678.8454 1059.4855,-717.0681 1110.9902,-738.3272"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1109.7529,-741.6032 1120.33,-742.2159 1112.4435,-735.141 1109.7529,-741.6032"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M274.8045,-611.3663C325.4977,-622.4351 396.1723,-637.9852 399.0839,-639.2763"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M281.2218,-600.2763C294.877,-600.2763 309.649,-600.2763 323.9664,-600.2763"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="324.2888,-603.7764 334.2888,-600.2763 324.2887,-596.7764 324.2888,-603.7764"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.7613,-589.1172C256.4551,-576.5468 287.3265,-556.6513 317.2024,-547.2763 599.326,-458.7462 684.7882,-507.7165 979.6978,-486.2763"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M603.7886,-152.5156C624.5633,-242.0974 763.2275,-840.0253 791.1073,-960.2443"/>
<polygon fill="#0048ff" stroke="#0048ff" points="787.7188,-961.126 793.3875,-970.0768 794.5378,-959.5446 787.7188,-961.126"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M647.8422,-132.1744C672.1956,-127.4238 702.4206,-121.5278 729.206,-116.3028"/>
<polygon fill="#0000ff" stroke="#0000ff" points="730.1391,-119.6868 739.284,-114.3369 728.7988,-112.8163 730.1391,-119.6868"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-218.2763C1022.4824,-222.6548 1154.4854,-351.0549 1202.9897,-429.2763 1235.994,-482.5012 1287.8722,-668.6157 1304.9783,-731.9704"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1301.6977,-733.2493 1307.6719,-741.9991 1308.4581,-731.4335 1301.6977,-733.2493"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M647.9347,-143.106C721.9835,-147.6436 869.1689,-163.4241 979.6978,-218.2763"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M617.2203,-152.3754C656.4995,-179.2857 757.1327,-246.5177 795.9847,-256.2763"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.216,-209.7691C565.3748,-198.7862 885.2223,-174.6079 979.6978,-218.2763"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1152.5589,-460.4781C1163.3595,-478.741 1185.2861,-516.1243 1202.9897,-548.2763 1239.8553,-615.2288 1281.349,-695.8046 1300.2626,-732.8395"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1297.3152,-734.7643 1304.9758,-742.0831 1303.5514,-731.5845 1297.3152,-734.7643"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-488.2763C1399.1412,-559.2845 1355.9141,-622.9416 1382.3269,-733.2763 1402.5396,-817.711 1375.5845,-849.706 1418.3269,-925.2763 1427.7191,-941.882 1443.6496,-956.1802 1457.4181,-966.4254"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1455.4551,-969.3243 1465.6336,-972.2652 1459.5107,-963.6188 1455.4551,-969.3243"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1201.9541,-450.6495C1236.5663,-454.1661 1280.0547,-463.7167 1310.6583,-488.2763"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M460.8203,-611.3661C468.3293,-614.8298 475.3253,-619.3587 480.9653,-625.2763 525.8844,-672.4068 482.9851,-711.7393 516.9653,-767.2763 568.9749,-852.2801 627.2411,-834.3547 685.3989,-915.2763 709.5812,-948.9238 690.0267,-974.2075 721.3989,-1001.2763 747.2986,-1023.6233 775.1843,-993.119 795.9847,-1020.2763"/>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M795.9847,-1020.2763C830.4423,-1061.4378 849.0854,-1066.0831 870.5706,-1115.2763 911.2795,-1208.485 873.5793,-1245.0647 906.5706,-1341.2763 921.2735,-1384.1543 949.2365,-1429.4618 965.9999,-1454.5727"/>
<polygon fill="#00ff48" stroke="#00ff48" points="963.3151,-1456.8497 971.8253,-1463.1606 969.1082,-1452.9201 963.3151,-1456.8497"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M463.8327,-611.4859C470.4002,-614.9592 476.3415,-619.4583 480.9653,-625.2763 553.5861,-716.6521 487.3713,-1036.3715 516.9653,-1149.2763 532.8388,-1209.8355 569.3898,-1274.763 588.7019,-1306.5062"/>
<polygon fill="#ff0048" stroke="#ff0048" points="585.8688,-1308.5798 594.0999,-1315.2505 591.8253,-1304.9027 585.8688,-1308.5798"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-524.2763C836.9551,-516.5672 940.7213,-547.4833 979.6978,-562.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-562.2763C1048.7617,-588.4886 1078.7466,-531.5136 1145.9073,-562.2763"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-562.2763C1061.1174,-593.178 1116.0617,-690.6429 1136.7456,-733.1376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1133.6113,-734.6967 1141.0556,-742.2354 1139.9373,-731.6997 1133.6113,-734.6967"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.2445,-589.2118C533.3511,-574.3136 674.9804,-547.0448 795.9847,-524.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-524.2763C878.9768,-516.2573 896.4055,-490.0697 979.6978,-486.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-486.2763C1016.4337,-484.6032 1281.9777,-465.2599 1310.6583,-488.2763"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M453.4475,-874.3092C462.9504,-876.6331 472.4954,-879.8437 480.9653,-884.2763 500.7368,-894.6235 498.2553,-907.1145 516.9653,-919.2763 599.0449,-972.6295 628.3334,-970.9048 721.3989,-1001.2763 753.9189,-1011.8891 773.6607,-994.3569 795.9847,-1020.2763"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M453.3489,-874.4688C504.2323,-880.9423 576.1246,-892 601.1821,-905.2763"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M404.8731,-879.624C418.8957,-907.3318 455.4074,-980.8177 480.9653,-1044.2763 499.3957,-1090.0376 498.3372,-1103.5951 516.9653,-1149.2763 540.6048,-1207.2466 573.76,-1273.3062 590.5464,-1305.8913"/>
<polygon fill="#ff0048" stroke="#ff0048" points="587.496,-1307.612 595.2018,-1314.8832 593.7123,-1304.3936 587.496,-1307.612"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.6932,-857.2549C437.867,-829.1944 518.1047,-756.9961 601.1821,-753.2763"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.3974,-861.0132C546.1135,-849.02 740.9702,-825.5764 906.5706,-817.2763 971.491,-814.0224 987.8436,-815.6392 1052.825,-817.2763 1110.1758,-818.7212 1261.6996,-800.3723 1310.6583,-830.2763"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M256.6405,-162.2412C291.503,-151.3996 348.4718,-136.2054 399.0839,-134.2763"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M795.9847,-256.2763C931.9678,-290.8577 1071.4856,-391.2529 1124.0852,-431.893"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1122.0087,-434.712 1132.0462,-438.1031 1126.3141,-429.1927 1122.0087,-434.712"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M253.1332,-162.1784C262.3571,-158.2476 272.423,-153.4916 281.2024,-148.2763 298.6292,-137.9241 298.0297,-126.8546 317.2024,-120.2763 337.7838,-113.2147 670.4444,-114.1502 685.3989,-121.2763 755.4164,-154.641 723.3746,-229.0106 795.9847,-256.2763"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-173.2763C295.1003,-173.2763 313.1505,-173.2763 330.2066,-173.2763"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-176.7764 340.6733,-173.2763 330.6733,-169.7764 330.6733,-176.7764"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M457.5391,-164.0206C484.8289,-159.6995 517.192,-154.5752 544.2844,-150.2854"/>
<polygon fill="#00ff00" stroke="#00ff00" points="545.0587,-153.7065 554.3882,-148.6856 543.9639,-146.7927 545.0587,-153.7065"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M457.5915,-183.9951C535.3068,-198.5782 676.6721,-226.308 795.9847,-256.2763"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M474.9001,-370.1348C512.8244,-370.1 559.4295,-370.1116 601.1821,-370.2763"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M979.6978,-448.2763C1012.3646,-453.3282 1049.0761,-454.0592 1079.672,-453.3247"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1079.9073,-456.8194 1089.7988,-453.0236 1079.6991,-449.8225 1079.9073,-456.8194"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-370.2763C721.4657,-370.7509 754.6582,-364.1408 870.5706,-396.2763 922.3436,-410.6299 926.603,-440.0653 979.6978,-448.2763"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M446.2181,-303.3163C457.9242,-306.9546 470.1956,-311.5702 480.9653,-317.2763 499.1202,-326.8953 498.7213,-336.8276 516.9653,-346.2763 551.5253,-364.1751 562.5967,-365.1851 601.1821,-370.2763"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M637.697,-1716.3129C685.4217,-1730.0905 766.4034,-1751.0728 795.9847,-1744.2763"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M795.9847,-1744.2763C829.9236,-1736.4787 843.5998,-1742.3042 870.5706,-1720.2763 895.8471,-1699.6321 881.4819,-1677.1484 906.5706,-1656.2763 911.1298,-1652.4833 916.2949,-1649.2548 921.7206,-1646.5089"/>
<polygon fill="#0091ff" stroke="#0091ff" points="923.3457,-1649.616 931.0367,-1642.329 920.4802,-1643.2293 923.3457,-1649.616"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M625.3389,-1047.1078C649.4379,-1036.1373 687.6353,-1019.2104 721.3989,-1006.2763 731.4501,-1002.4259 742.3816,-998.5769 752.6989,-995.0932"/>
<polygon fill="#0048ff" stroke="#0048ff" points="753.9724,-998.3582 762.3537,-991.8771 751.76,-991.717 753.9724,-998.3582"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1842.1392,-2005.2048C1857.898,-2000.729 1876.2395,-1995.5196 1892.7841,-1990.8206"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1894.1508,-1994.071 1902.8141,-1987.9719 1892.2382,-1987.3373 1894.1508,-1994.071"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1484.802,-2153.9285C1492.777,-2081.1814 1538.348,-1679.7341 1584.821,-1566.2763 1595.0494,-1541.305 1613.6669,-1516.4387 1627.3449,-1500.1135"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1630.1115,-1502.2642 1633.9767,-1492.3996 1624.8035,-1497.7007 1630.1115,-1502.2642"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1541.1334,-2154.9458C1572.2328,-2148.4634 1610.9676,-2138.9182 1644.2388,-2126.2763"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1485.2249,-994.3744C1492.5626,-1042.0817 1524.5431,-1233.9413 1584.821,-1380.2763 1597.1289,-1410.1558 1617.0389,-1441.8408 1630.3786,-1461.5871"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1627.6201,-1463.7531 1636.1657,-1470.016 1633.3909,-1459.791 1627.6201,-1463.7531"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M411.1495,-1108.4247C427.4893,-1123.6963 457.3265,-1152.2046 480.9653,-1178.2763 521.2664,-1222.7252 564.7622,-1278.4225 586.727,-1307.1591"/>
<polygon fill="#ff0048" stroke="#ff0048" points="583.983,-1309.3328 592.8251,-1315.1695 589.5527,-1305.0927 583.983,-1309.3328"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-946.2763C1354.755,-948.3941 1403.8735,-959.8079 1438.4573,-969.4056"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1437.6796,-972.823 1448.2551,-972.1841 1439.5894,-966.0886 1437.6796,-972.823"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.686,-1086.1374C459.7209,-1082.5818 471.071,-1078.0282 480.9653,-1072.2763 499.9918,-1061.2156 498.3018,-1049.9391 516.9653,-1038.2763 599.3018,-986.8245 626.1079,-979.8828 721.3989,-961.2763 978.5211,-911.0707 1048.982,-933.7088 1310.6583,-946.2763"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M443.4352,-1295.835C472.2679,-1301.399 510.2062,-1308.7202 541.6514,-1314.7883"/>
<polygon fill="#ff0048" stroke="#ff0048" points="541.1309,-1318.2524 551.613,-1316.7107 542.4573,-1311.3792 541.1309,-1318.2524"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.4577,-1289.2343C550.731,-1292.6863 831.5981,-1294.0405 1052.825,-1227.2763 1125.4212,-1205.3674 1148.5347,-1199.0481 1202.9897,-1146.2763 1225.8718,-1124.1015 1214.2922,-1104.4094 1238.9897,-1084.2763 1265.0261,-1063.0518 1280.4463,-1074.9598 1310.6583,-1060.2763"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M860.6634,-1130.3449C980.3747,-1120.4841 1231.5001,-1096.1571 1310.6583,-1060.2763"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1060.2763C1358.3803,-1036.8964 1369.5458,-1029.3573 1418.3269,-1008.2763 1426.4105,-1004.783 1435.1561,-1001.2605 1443.5384,-998.0064"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1445.062,-1001.171 1453.1501,-994.3275 1442.5597,-994.6335 1445.062,-1001.171"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacwatertoairf90EfferentGraph = svgPanZoom('#sourcefilehvacwatertoairf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacwatertoair.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilehvacwatertoairf90AfferentGraph" width="641pt" height="156pt"
 viewBox="0.00 0.00 641.00 156.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph" class="graph" transform="scale(.2909 .2909) rotate(0) translate(4 533.1841)">
<title>sourcefile~~hvacwatertoair.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-533.1841 2199.6243,-533.1841 2199.6243,4 -4,4"/>
<!-- sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~hvacwatertoair.f90</title>
<polygon fill="none" stroke="#000000" points="106.3202,-331.4831 .226,-331.4831 .226,-309.4722 106.3202,-309.4722 106.3202,-331.4831"/>
<text text-anchor="middle" x="53.2731" y="-317.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACWatertoAir.f90</text>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="268.8121,-331.4831 142.4574,-331.4831 142.4574,-309.4722 268.8121,-309.4722 268.8121,-331.4831"/>
<text text-anchor="middle" x="205.6348" y="-317.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M106.5618,-320.4776C114.8884,-320.4776 123.6173,-320.4776 132.2969,-320.4776"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.4363,-323.9777 142.4363,-320.4776 132.4362,-316.9777 132.4363,-323.9777"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="582.1753,-195.4831 417.1719,-195.4831 417.1719,-173.4722 582.1753,-173.4722 582.1753,-195.4831"/>
<text text-anchor="middle" x="499.6736" y="-181.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M73.0701,-309.3533C114.5857,-286.5706 214.3938,-234.6354 304.7234,-209.4776 337.4923,-200.3512 374.3019,-194.5416 407.0363,-190.8495"/>
<polygon fill="#ff0000" stroke="#ff0000" points="407.4878,-194.3212 417.0555,-189.7704 406.7381,-187.3615 407.4878,-194.3212"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="750.6777,-512.4831 653.8145,-512.4831 653.8145,-490.4722 750.6777,-490.4722 750.6777,-512.4831"/>
<text text-anchor="middle" x="702.2461" y="-498.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M71.7829,-331.6059C123.2722,-361.9198 273.4278,-445.9902 410.5042,-480.4776 489.4805,-500.3475 583.9984,-503.5637 643.5924,-503.1938"/>
<polygon fill="#ff0000" stroke="#ff0000" points="643.9734,-506.6903 653.9381,-503.0912 643.9039,-499.6906 643.9734,-506.6903"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="950.0364,-431.4831 824.6093,-431.4831 824.6093,-409.4722 950.0364,-409.4722 950.0364,-431.4831"/>
<text text-anchor="middle" x="887.3229" y="-417.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.4392,-331.5594C267.1481,-348.7567 343.2474,-382.0162 410.5042,-402.4776 449.2704,-414.2714 459.6252,-415.3097 499.6736,-421.4776"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="959.1707,-258.4831 815.475,-258.4831 815.475,-236.4722 959.1707,-236.4722 959.1707,-258.4831"/>
<text text-anchor="middle" x="887.3229" y="-244.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M339.6138,-223.4776C412.0154,-188.0838 622.1573,-218.505 702.2461,-227.4776"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="751.7044,-80.4831 652.7878,-80.4831 652.7878,-58.4722 751.7044,-58.4722 751.7044,-80.4831"/>
<text text-anchor="middle" x="702.2461" y="-66.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M219.015,-309.1887C242.3675,-289.8633 292.5728,-249.9678 339.6138,-223.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M339.6138,-223.4776C375.3312,-203.3641 374.6188,-184.29 410.5042,-164.4776 485.7088,-122.9569 581.9412,-96.0479 642.8619,-81.8188"/>
<polygon fill="#ff0000" stroke="#ff0000" points="643.7353,-85.2094 652.6982,-79.5599 642.1685,-78.387 643.7353,-85.2094"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374.3949,-331.4831 304.8327,-331.4831 304.8327,-309.4722 374.3949,-309.4722 374.3949,-331.4831"/>
<text text-anchor="middle" x="339.6138" y="-317.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M269.0931,-320.4776C277.7483,-320.4776 286.4824,-320.4776 294.7152,-320.4776"/>
<polygon fill="#ff0000" stroke="#ff0000" points="294.8317,-323.9777 304.8317,-320.4776 294.8316,-316.9777 294.8317,-323.9777"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M702.2461,-227.4776C735.8641,-231.244 772.9318,-235.274 805.0081,-238.7224"/>
<polygon fill="#00ff00" stroke="#00ff00" points="804.9199,-242.2329 815.2364,-239.8205 805.6672,-235.2729 804.9199,-242.2329"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M540.4157,-195.5785C581.0517,-206.0669 645.4371,-221.1131 702.2461,-227.4776"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="938.1092,-199.4831 836.5366,-199.4831 836.5366,-177.4722 938.1092,-177.4722 938.1092,-199.4831"/>
<text text-anchor="middle" x="887.3229" y="-185.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M520.915,-173.467C550.7877,-158.217 603.8999,-132.0217 624.843,-127.4776 692.0813,-112.8888 713.2308,-109.5215 779.6492,-127.4776 797.5305,-132.3118 799.561,-139.2971 815.6492,-148.4776 829.5922,-156.4341 845.1437,-165.1341 858.1878,-172.3824"/>
<polygon fill="#00ff00" stroke="#00ff00" points="856.7413,-175.5825 867.1839,-177.3724 860.1367,-169.4611 856.7413,-175.5825"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M750.6268,-492.8288C760.6547,-489.8293 770.8391,-485.8206 779.6492,-480.4776 799.819,-468.2455 795.6033,-453.9117 815.6492,-441.4776 819.2441,-439.2478 823.0868,-437.2452 827.0557,-435.4482"/>
<polygon fill="#0000ff" stroke="#0000ff" points="828.54,-438.6232 836.4885,-431.6181 825.9064,-432.1374 828.54,-438.6232"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1907.5887,-393.4831 1808.6312,-393.4831 1808.6312,-371.4722 1907.5887,-371.4722 1907.5887,-393.4831"/>
<text text-anchor="middle" x="1858.11" y="-379.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.1338,-410.1663C1064.3329,-392.8771 1313.5233,-361.8659 1522.771,-382.4776"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1223.9783,-354.4831 1125.4202,-354.4831 1125.4202,-332.4722 1223.9783,-332.4722 1223.9783,-354.4831"/>
<text text-anchor="middle" x="1174.6992" y="-340.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.0519,-409.4248C935.4652,-405.5265 947.9459,-400.7779 958.9966,-395.4776 998.2993,-376.6268 998.8841,-348.7543 1042.1532,-343.4776"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1042.1532,-304.4776C1120.9376,-324.545 1143.696,-311.3653 1224.0886,-323.4776 1357.8913,-343.6369 1388.2136,-368.1993 1522.771,-382.4776"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1522.771,-382.4776C1619.0521,-387.8791 1731.1276,-386.2908 1798.2514,-384.4966"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1798.7304,-387.9847 1808.6291,-384.2079 1798.5356,-380.9874 1798.7304,-387.9847"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M913.776,-258.5843C944.2873,-271.0722 996.1631,-291.3197 1042.1532,-304.4776"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1042.1532,-304.4776C1071.6004,-311.9782 1104.3617,-321.6058 1129.9459,-329.4186"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1129.1434,-332.8334 1139.7304,-332.4247 1131.1993,-326.1421 1129.1434,-332.8334"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M722.3133,-80.5349C739.4351,-90.8137 763.7397,-107.5186 779.6492,-127.4776 804.205,-158.2837 788.9301,-179.5278 815.6492,-208.4776 824.595,-218.1704 836.5148,-225.9715 848.0618,-231.9749"/>
<polygon fill="#00ffff" stroke="#00ffff" points="846.6544,-235.1823 857.1784,-236.4058 849.7144,-228.8865 846.6544,-235.1823"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="941.6331,-139.4831 833.0126,-139.4831 833.0126,-117.4722 941.6331,-117.4722 941.6331,-139.4831"/>
<text text-anchor="middle" x="887.3229" y="-125.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M737.0576,-80.5751C767.0443,-90.1344 810.4962,-103.9863 842.9692,-114.3383"/>
<polygon fill="#00ffff" stroke="#00ffff" points="842.0768,-117.7273 852.6674,-117.4299 844.2029,-111.0579 842.0768,-117.7273"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M349.1333,-309.4673C362.2296,-294.6126 386.8758,-267.6874 410.5042,-247.4776 430.558,-230.3252 455.1716,-213.1967 473.4548,-201.1388"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="475.4092,-204.0429 481.874,-195.649 471.5857,-198.1793 475.4092,-204.0429"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M345.8578,-331.522C356.604,-349.4485 380.3736,-384.664 410.5042,-402.4776 445.3847,-423.0996 459.6252,-415.3097 499.6736,-421.4776"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M499.6736,-421.4776C588.6567,-435.1821 612.2142,-421.7209 702.2461,-421.4776"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2063.2069,-365.4831 1943.3964,-365.4831 1943.3964,-343.4722 2063.2069,-343.4722 2063.2069,-365.4831"/>
<text text-anchor="middle" x="2003.3016" y="-351.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M344.2215,-309.2566C358.1841,-275.4176 399.7288,-175.9877 410.5042,-164.4776 484.3869,-85.5569 519.9964,-75.8279 624.843,-49.4776 912.6561,22.8562 976.2804,44.9744 1707.3684,-192.4776"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1858.11,-268.4776C1902.1624,-289.1037 1950.1455,-319.1494 1978.4309,-337.7205"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1976.6216,-340.7201 1986.8924,-343.3203 1980.4849,-334.8827 1976.6216,-340.7201"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1707.3684,-192.4776C1755.5035,-208.0413 1763.3579,-221.8834 1808.6206,-244.4776 1830.4923,-255.3955 1835.9713,-258.1119 1858.11,-268.4776"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="768.394,-277.4831 636.0982,-277.4831 636.0982,-255.4722 768.394,-255.4722 768.394,-277.4831"/>
<text text-anchor="middle" x="702.2461" y="-263.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M499.6736,-261.4776C544.4346,-246.5414 597.9023,-248.6297 638.6645,-254.0027"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="638.3487,-257.4929 648.741,-255.4312 639.3313,-250.5622 638.3487,-257.4929"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553.853,-471.4831 445.4942,-471.4831 445.4942,-449.4722 553.853,-449.4722 553.853,-471.4831"/>
<text text-anchor="middle" x="499.6736" y="-457.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M343.2948,-331.5556C351.5169,-354.5586 373.6064,-407.668 410.5042,-435.4776 417.953,-441.0918 426.6052,-445.4453 435.5329,-448.8212"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="434.6904,-452.2308 445.2846,-452.1142 436.9299,-445.5987 434.6904,-452.2308"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="589.0128,-352.4831 410.3344,-352.4831 410.3344,-330.4722 589.0128,-330.4722 589.0128,-352.4831"/>
<text text-anchor="middle" x="499.6736" y="-338.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M374.7396,-325.0862C384.1102,-326.3156 394.6952,-327.7044 405.6409,-329.1404"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="405.3996,-332.6387 415.77,-330.4694 406.3103,-325.6982 405.3996,-332.6387"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="584.3712,-311.4831 414.976,-311.4831 414.976,-289.4722 584.3712,-289.4722 584.3712,-311.4831"/>
<text text-anchor="middle" x="499.6736" y="-297.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M374.7396,-316.0885C383.8054,-314.9557 394.0078,-313.6809 404.5739,-312.3606"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="405.3015,-315.797 414.7904,-311.0841 404.4336,-308.851 405.3015,-315.797"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="571.7747,-393.4831 427.5725,-393.4831 427.5725,-371.4722 571.7747,-371.4722 571.7747,-393.4831"/>
<text text-anchor="middle" x="499.6736" y="-379.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M355.5376,-331.5148C369.4715,-340.7165 390.5499,-353.558 410.5042,-361.4776 417.3134,-364.1801 424.5591,-366.59 431.8638,-368.725"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="431.2555,-372.1877 441.8259,-371.4678 433.1137,-365.4388 431.2555,-372.1877"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="746.8639,-158.4831 657.6283,-158.4831 657.6283,-136.4722 746.8639,-136.4722 746.8639,-158.4831"/>
<text text-anchor="middle" x="702.2461" y="-144.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M499.6736,-261.4776C544.2911,-246.5893 552.183,-233.9467 588.843,-204.4776 606.4789,-190.301 605.2648,-179.822 624.843,-168.4776 631.8663,-164.4081 639.7048,-161.1029 647.623,-158.4252"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="648.7405,-161.7434 657.2716,-155.4607 646.6846,-155.0521 648.7405,-161.7434"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M355.8141,-309.4425C369.7486,-300.4243 390.6795,-287.9811 410.5042,-280.4776 448.401,-266.134 461.2365,-274.3036 499.6736,-261.4776"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="743.1919,-199.4831 661.3003,-199.4831 661.3003,-177.4722 743.1919,-177.4722 743.1919,-199.4831"/>
<text text-anchor="middle" x="702.2461" y="-185.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M499.6736,-261.4776C556.1911,-242.6184 568.6587,-233.3076 624.843,-213.4776 635.2424,-209.8072 646.4999,-206.0497 657.1244,-202.5998"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="658.2147,-205.9258 666.6608,-199.5293 656.0693,-199.2626 658.2147,-205.9258"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1907.6706,-372.9199C1916.8772,-371.1445 1926.6353,-369.2626 1936.2622,-367.4061"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1937.0621,-370.8164 1946.2184,-365.486 1935.7366,-363.943 1937.0621,-370.8164"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1199.5003,-332.458C1291.106,-293.435 1617.5281,-169.3467 1858.11,-268.4776"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1403.5948,-469.4831 1259.9196,-469.4831 1259.9196,-447.4722 1403.5948,-447.4722 1403.5948,-469.4831"/>
<text text-anchor="middle" x="1331.7572" y="-455.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1189.7586,-354.5043C1217.2457,-374.6308 1275.7201,-417.4465 1308.4078,-441.3809"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1306.3765,-444.2315 1316.5126,-447.3154 1310.512,-438.5836 1306.3765,-444.2315"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2189.0226,-365.4831 2105.6056,-365.4831 2105.6056,-343.4722 2189.0226,-343.4722 2189.0226,-365.4831"/>
<text text-anchor="middle" x="2147.3141" y="-351.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2063.1248,-354.4776C2073.7894,-354.4776 2084.8212,-354.4776 2095.2475,-354.4776"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2095.4361,-357.9777 2105.436,-354.4776 2095.436,-350.9777 2095.4361,-357.9777"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2195.4352,-296.4831 2099.193,-296.4831 2099.193,-274.4722 2195.4352,-274.4722 2195.4352,-296.4831"/>
<text text-anchor="middle" x="2147.3141" y="-282.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2026.4397,-343.3916C2050.4796,-331.8735 2088.279,-313.7628 2115.2037,-300.8625"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2116.7274,-304.0135 2124.2334,-296.5362 2113.7028,-297.7007 2116.7274,-304.0135"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1522.771,-497.4776C1604.7082,-501.6491 1625.4387,-493.1623 1707.3684,-497.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1369.0209,-469.5573C1407.2113,-480.0871 1468.518,-494.7155 1522.771,-497.4776"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1605.9617,-469.4831 1439.5803,-469.4831 1439.5803,-447.4722 1605.9617,-447.4722 1605.9617,-469.4831"/>
<text text-anchor="middle" x="1522.771" y="-455.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1403.4271,-458.4776C1411.8729,-458.4776 1420.5843,-458.4776 1429.2735,-458.4776"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1429.4465,-461.9777 1439.4465,-458.4776 1429.4465,-454.9777 1429.4465,-461.9777"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.3684,-497.4776C1774.2719,-501.0015 1794.6118,-518.8431 1858.11,-497.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1558.754,-469.556C1595.6388,-480.0848 1654.8685,-494.7124 1707.3684,-497.4776"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1772.3737,-469.4831 1642.3631,-469.4831 1642.3631,-447.4722 1772.3737,-447.4722 1772.3737,-469.4831"/>
<text text-anchor="middle" x="1707.3684" y="-455.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1606.1586,-458.4776C1614.8802,-458.4776 1623.709,-458.4776 1632.3294,-458.4776"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1632.3345,-461.9777 1642.3344,-458.4776 1632.3344,-454.9777 1632.3345,-461.9777"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1729.2875,-447.4266C1755.0761,-434.4246 1798.0653,-412.7506 1827.223,-398.0501"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1828.8108,-401.1693 1836.1644,-393.542 1825.6594,-394.9187 1828.8108,-401.1693"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1735.0962,-469.5069C1772.0548,-483.5427 1835.4357,-505.1069 1858.11,-497.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1858.11,-497.4776C1921.5573,-476.1293 1970.5309,-408.2208 1991.7662,-374.2399"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1994.8017,-375.9844 1997.0091,-365.6221 1988.8214,-372.3462 1994.8017,-375.9844"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M768.5403,-259.6719C780.4522,-258.449 792.9965,-257.1612 805.2903,-255.8991"/>
<polygon fill="#ff0000" stroke="#ff0000" points="805.9484,-259.35 815.5387,-254.847 805.2335,-252.3866 805.9484,-259.35"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1042.1532,-343.4776C1065.8244,-340.5909 1092.0508,-340.0413 1114.8849,-340.4097"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1115.0403,-343.9139 1125.1161,-340.6384 1115.1969,-336.9157 1115.0403,-343.9139"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M719.1937,-277.533C750.7216,-297.1597 821.2016,-336.6731 887.3229,-343.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M887.3229,-343.4776C955.7748,-350.522 973.8458,-351.8077 1042.1532,-343.4776"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M728.3705,-255.4676C760.5213,-241.9177 815.2779,-218.8407 851.379,-203.6261"/>
<polygon fill="#ff0000" stroke="#ff0000" points="853.1766,-206.6667 861.0323,-199.5577 850.458,-200.2161 853.1766,-206.6667"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M553.9593,-471.4649C581.6194,-477.0632 615.2884,-483.8777 643.5488,-489.5975"/>
<polygon fill="#ffda00" stroke="#ffda00" points="643.1991,-493.0976 653.6947,-491.651 644.5878,-486.2367 643.1991,-493.0976"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M535.1367,-449.4657C575.2679,-437.9889 642.7939,-421.6382 702.2461,-421.4776"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M516.1652,-471.5715C539.2744,-486.3806 583.1502,-511.8591 624.843,-521.4776 691.8848,-536.9442 710.8781,-523.5647 779.6492,-521.4776 955.4697,-516.1418 999.3084,-484.0836 1174.6992,-497.4776"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M588.8524,-337.0283C667.5943,-334.2682 785.3952,-332.9883 887.3229,-343.4776"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="779.5524,-393.4831 624.9398,-393.4831 624.9398,-371.4722 779.5524,-371.4722 779.5524,-393.4831"/>
<text text-anchor="middle" x="702.2461" y="-379.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M554.2258,-352.5188C579.8917,-357.7135 610.6854,-363.946 637.5232,-369.3779"/>
<polygon fill="#48ff00" stroke="#48ff00" points="637.1009,-372.8634 647.5965,-371.4167 638.4896,-366.0025 637.1009,-372.8634"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M584.4022,-302.7459C640.3538,-302.6563 715.0025,-299.497 779.6492,-286.4776 805.2243,-281.327 832.8704,-271.21 853.7451,-262.5711"/>
<polygon fill="#00ff91" stroke="#00ff91" points="855.2737,-265.7248 863.1183,-258.6035 852.545,-259.2785 855.2737,-265.7248"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="765.7488,-471.4831 638.7434,-471.4831 638.7434,-449.4722 765.7488,-449.4722 765.7488,-471.4831"/>
<text text-anchor="middle" x="702.2461" y="-457.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M574.3237,-311.4999C579.6006,-314.1901 584.5297,-317.4746 588.843,-321.4776 627.7884,-357.6214 587.3952,-397.7845 624.843,-435.4776 628.3296,-438.9871 632.3114,-442.0042 636.5875,-444.598"/>
<polygon fill="#00ff91" stroke="#00ff91" points="635.2279,-447.836 645.714,-449.3497 638.4606,-441.6271 635.2279,-447.836"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M702.2461,-421.4776C739.0821,-421.3781 780.0417,-421.1672 814.0446,-420.9646"/>
<polygon fill="#0091ff" stroke="#0091ff" points="814.383,-424.4627 824.3616,-420.9021 814.3405,-417.4628 814.383,-424.4627"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M534.7748,-393.5042C574.861,-405.093 642.6149,-421.6387 702.2461,-421.4776"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M747.0296,-154.9911C758.2084,-158.0866 769.8055,-162.4227 779.6492,-168.4776 800.0213,-181.0087 796.8747,-193.6598 815.6492,-208.4776 826.9916,-217.4297 840.6739,-225.4394 853.0308,-231.8366"/>
<polygon fill="#4800ff" stroke="#4800ff" points="851.6518,-235.0602 862.1612,-236.4031 854.7831,-228.7995 851.6518,-235.0602"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M747.048,-142.8783C769.8023,-140.5423 797.8592,-137.662 822.8863,-135.0927"/>
<polygon fill="#4800ff" stroke="#4800ff" points="823.4462,-138.5537 833.0365,-134.0507 822.7313,-131.5903 823.4462,-138.5537"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M747.048,-157.4026C771.2377,-162.7613 801.4202,-169.4476 827.5845,-175.2438"/>
<polygon fill="#4800ff" stroke="#4800ff" points="826.8743,-178.6713 837.3947,-177.417 828.3884,-171.837 826.8743,-178.6713"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M737.0576,-199.5751C767.0443,-209.1344 810.4962,-222.9863 842.9692,-233.3383"/>
<polygon fill="#ff00da" stroke="#ff00da" points="842.0768,-236.7273 852.6674,-236.4299 844.2029,-230.0579 842.0768,-236.7273"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M743.3206,-188.4776C767.6837,-188.4776 799.025,-188.4776 826.2443,-188.4776"/>
<polygon fill="#ff00da" stroke="#ff00da" points="826.4515,-191.9777 836.4514,-188.4776 826.4514,-184.9777 826.4515,-191.9777"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1042.1532,-192.4776C1106.3454,-210.368 1148.5439,-285.6465 1165.8266,-322.699"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1162.7422,-324.374 1170.038,-332.0565 1169.1255,-321.5011 1162.7422,-324.374"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1522.771,-192.4776C1604.7064,-188.2721 1629.3377,-167.1338 1707.3684,-192.4776"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1042.1532,-192.4776C1247.9192,-249.8246 1309.4439,-203.4272 1522.771,-192.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M937.9823,-182.8498C968.7947,-181.1117 1008.5504,-181.9115 1042.1532,-192.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1858.11,-230.4776C1938.9558,-240.6387 2031.2695,-259.4748 2089.4126,-272.2401"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2088.9864,-275.7304 2099.5061,-274.4706 2090.4969,-268.8953 2088.9864,-275.7304"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1522.771,-192.4776C1633.3949,-180.9931 1665.5281,-148.4654 1772.6206,-178.4776 1815.4429,-190.4784 1814.6176,-221.1945 1858.11,-230.4776"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M756.2755,-393.571C777.3711,-397.9023 801.7165,-402.9009 823.6557,-407.4055"/>
<polygon fill="#ff0000" stroke="#ff0000" points="823.0467,-410.8534 833.5463,-409.4362 824.4546,-403.9964 823.0467,-410.8534"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717.3917,-371.43C749.6011,-347.9356 825.101,-292.864 863.6977,-264.7105"/>
<polygon fill="#ff0000" stroke="#ff0000" points="866.2111,-267.2094 872.2276,-258.4886 862.0859,-261.554 866.2111,-267.2094"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M779.7135,-380.5219C812.8674,-380.083 852.005,-380.0931 887.3229,-381.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M887.3229,-381.4776C958.1242,-384.2532 971.8186,-352.055 1042.1532,-343.4776"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M887.3229,-381.4776C1031.1683,-387.1166 1197.6019,-424.3629 1280.0071,-444.9145"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1279.3203,-448.3507 1289.8719,-447.3954 1281.0276,-441.5621 1279.3203,-448.3507"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1089.467,-469.4831 994.8394,-469.4831 994.8394,-447.4722 1089.467,-447.4722 1089.467,-469.4831"/>
<text text-anchor="middle" x="1042.1532" y="-455.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M887.3229,-381.4776C920.2528,-382.7685 929.0977,-386.6174 958.9966,-400.4776 981.7677,-411.0336 1004.9714,-427.825 1021.0608,-440.6304"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1019.254,-443.6725 1029.2196,-447.2695 1023.6722,-438.2429 1019.254,-443.6725"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1054.8623,-447.4509C1077.7634,-427.5814 1126.1521,-385.5982 1153.9269,-361.5001"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1156.5742,-363.837 1161.8339,-354.6399 1151.9868,-358.5497 1156.5742,-363.837"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1067.9436,-469.636C1094.2159,-480.1428 1136.4225,-494.6771 1174.6992,-497.4776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1174.6992,-497.4776C1328.9854,-508.7661 1368.2725,-489.6119 1522.771,-497.4776"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1060.7026,-447.4644C1148.2628,-396.7311 1529.6869,-189.7196 1858.11,-230.4776"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M750.8155,-471.492C770.7852,-475.4916 794.2149,-479.5098 815.6492,-481.4776 879.0923,-487.3023 895.8656,-490.0473 958.9966,-481.4776 972.7169,-479.6152 987.371,-476.0989 1000.4955,-472.3661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1001.5992,-475.6895 1010.1931,-469.4931 999.6108,-468.9779 1001.5992,-475.6895"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~hvacwatertoair.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="940.3153,-472.4831 834.3304,-472.4831 834.3304,-450.4722 940.3153,-450.4722 940.3153,-472.4831"/>
<text text-anchor="middle" x="887.3229" y="-458.3276" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M765.939,-460.8218C784.7309,-460.9233 805.2861,-461.0344 824.0514,-461.1358"/>
<polygon fill="#ff0000" stroke="#ff0000" points="824.2511,-464.6368 834.2699,-461.191 824.289,-457.6369 824.2511,-464.6368"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatertoair.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M940.6067,-460.4452C954.8254,-460.1697 970.2508,-459.8708 984.6836,-459.5912"/>
<polygon fill="#ff0000" stroke="#ff0000" points="985.0558,-463.0847 994.9861,-459.3915 984.9202,-456.086 985.0558,-463.0847"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacwatertoairf90AfferentGraph = svgPanZoom('#sourcefilehvacwatertoairf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/watertoairheatpump.html">WatertoAirHeatPump</a>

      <a class="list-group-item" href="../module/watertoairheatpumpsimple.html">WatertoAirHeatPumpSimple</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html#src">HVACWatertoAir.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! Two modules contained in this file:</span>
<a name="ln-2"></a><span class="c">! WatertoAirHeatPump</span>
<a name="ln-3"></a><span class="c">! WatertoAirHeatPumpSimple</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="k">MODULE </span><span class="n">WatertoAirHeatPump</span>
<a name="ln-6"></a>  <span class="c">! Module containing the Water to Air Heat Pump simulation routines</span>
<a name="ln-7"></a>
<a name="ln-8"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-9"></a>  <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-10"></a>  <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-11"></a>  <span class="c">!       MODIFIED       Dan Fisher, Kenneth Tang (Jan 2004)</span>
<a name="ln-12"></a>  <span class="c">!                      Brent Griffith, plant upgrades, fluid props</span>
<a name="ln-13"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14"></a>
<a name="ln-15"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-16"></a>  <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-17"></a>  <span class="c">! manage the Water to Air Heat Pump Component</span>
<a name="ln-18"></a>
<a name="ln-19"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-20"></a>  <span class="c">!</span>
<a name="ln-21"></a>
<a name="ln-22"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-23"></a>  <span class="c">! Jin, H. 2002. Parameter Estimation Based Models of Water Source Heat Pumps. Phd Thesis.</span>
<a name="ln-24"></a>  <span class="c">! Oklahoma State University.</span>
<a name="ln-25"></a>
<a name="ln-26"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-27"></a>  <span class="c">!</span>
<a name="ln-28"></a>
<a name="ln-29"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-30"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-32"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-33"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-34"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CycFanCycCoil</span><span class="p">,</span> <span class="n">ContFanCycCoil</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-35"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-36"></a><span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_CoilWAHPCoolingParamEst</span><span class="p">,</span>  <span class="n">TypeOf_CoilWAHPHeatingParamEst</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-37"></a>
<a name="ln-38"></a>
<a name="ln-39"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-40"></a>
<a name="ln-41"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-42"></a>
<a name="ln-43"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-44"></a>
<a name="ln-45"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-46"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CompressorType_Reciprocating</span> <span class="o">=</span><span class="mi">1</span>
<a name="ln-47"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CompressorType_Rotary</span>        <span class="o">=</span><span class="mi">2</span>
<a name="ln-48"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CompressorType_Scroll</span>        <span class="o">=</span><span class="mi">3</span>
<a name="ln-49"></a>
<a name="ln-50"></a>
<a name="ln-51"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-52"></a><span class="k">TYPE </span><span class="n">WatertoAirHPEquipConditions</span>
<a name="ln-53"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>                 <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Name of the Water to Air Heat pump</span>
<a name="ln-54"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WatertoAirHPType</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! Type of WatertoAirHP ie. Heating or Cooling</span>
<a name="ln-55"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WAHPPlantTypeOfNum</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! type of component in plant</span>
<a name="ln-56"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Refrigerant</span>          <span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! Refrigerant name</span>
<a name="ln-57"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">Simflag</span>              <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-58"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirMassFlowRate</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet Air Mass Flow through the Water to Air Heat Pump being Simulated [kg/s]</span>
<a name="ln-59"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirMassFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet Air Mass Flow through the Water to Air Heat Pump being Simulated [kg/s]</span>
<a name="ln-60"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDBTemp</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet Air Dry Bulb Temperature [C]</span>
<a name="ln-61"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet Air Humidity Ratio [kg/kg]</span>
<a name="ln-62"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDBTemp</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet Air Dry Bulb Temperature [C]</span>
<a name="ln-63"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet Air Humidity Ratio [kg/kg]</span>
<a name="ln-64"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet Air Enthalpy [J/kg]</span>
<a name="ln-65"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet Air Enthalpy [J/kg]</span>
<a name="ln-66"></a>
<a name="ln-67"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterTemp</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet Water Temperature [C]</span>
<a name="ln-68"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTemp</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet Water Temperature [C]</span>
<a name="ln-69"></a>
<a name="ln-70"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterMassFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet Water Mass Flow Rate [kg/s]</span>
<a name="ln-71"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterMassFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet Water Mass Flow Rate [kg/s]</span>
<a name="ln-72"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignWaterMassFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Design Water Mass Flow Rate [kg/s]</span>
<a name="ln-73"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignWaterVolFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Design Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-74"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterEnthalpy</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Water Enthalpy [J/kg]</span>
<a name="ln-75"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterEnthalpy</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Water Enthalpy [J/kg]</span>
<a name="ln-76"></a>
<a name="ln-77"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Power</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Power Consumption [W]</span>
<a name="ln-78"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Energy</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Energy Consumption [J]</span>
<a name="ln-79"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSensible</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible Load Side Heat Transfer Rate [W]</span>
<a name="ln-80"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatent</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Latent Load Side Heat Transfer Rate [W]</span>
<a name="ln-81"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-82"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergySensible</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Sensible Load Side Heat Transferred [J]</span>
<a name="ln-83"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyLatent</span> <span class="o">=</span><span class="mf">0.0d0</span>          <span class="c">! Latent Load Side Heat Transferred [J]</span>
<a name="ln-84"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergySource</span> <span class="o">=</span><span class="mf">0.0d0</span>          <span class="c">! Source Side Heat Transferred [J]</span>
<a name="ln-85"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFrac</span>           <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Duty Factor</span>
<a name="ln-86"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Part Load Ratio</span>
<a name="ln-87"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCapacity</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal Heating Capacity</span>
<a name="ln-88"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCapacity</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal Cooling Capacity</span>
<a name="ln-89"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Total Heat Transfer Rate [W]</span>
<a name="ln-90"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyLoadTotal</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! Load Side Total Heat Transferred [J]</span>
<a name="ln-91"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_Rated</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal Time for Condensate Removal to Begin [s]</span>
<a name="ln-92"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_Rated</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Ratio of Initial Moisture Evaporation Rate and Steady-state Latent Capacity</span>
<a name="ln-93"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-94"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Heat pump time constant [s]</span>
<a name="ln-95"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-96"></a>                                             <span class="c">! shut off after compressor cycle off [s]</span>
<a name="ln-97"></a>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideUACoeff</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Heat Transfer coefficient [W/C]</span>
<a name="ln-99"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideTotalUACoeff</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Total Heat Transfer coefficient [W/C]</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutsideUACoeff</span><span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Load Side Outside Heat Transfer coefficient [W/C]</span>
<a name="ln-101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompPistonDisp</span>        <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Compressor Piston Displacement [m3/s]</span>
<a name="ln-102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompClearanceFactor</span>   <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Compressor Clearance Factor</span>
<a name="ln-103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompSucPressDrop</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Suction Pressure Drop [Pa]</span>
<a name="ln-104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuperheatTemp</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Superheat Temperature [C]</span>
<a name="ln-105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PowerLosses</span>           <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Constant Part of the Compressor Power Losses [W]</span>
<a name="ln-106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LossFactor</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Compressor Power Loss Factor</span>
<a name="ln-107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefVolFlowRate</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Refrigerant Volume Flow rate at the beginning</span>
<a name="ln-108"></a>                                    <span class="c">! of the Compression [m3/s]</span>
<a name="ln-109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolumeRatio</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Built-in-volume ratio [~]</span>
<a name="ln-110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LeakRateCoeff</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Coefficient for the relationship between</span>
<a name="ln-111"></a>                                    <span class="c">! Pressure Ratio and Leakage Rate [~]</span>
<a name="ln-112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideHTR1</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Heat Transfer Resistance coefficient 1 [~]</span>
<a name="ln-113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideHTR2</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Heat Transfer Resistance coefficient 2 [k/kW]</span>
<a name="ln-114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighPressCutOff</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! High Pressure Cut-off [Pa]</span>
<a name="ln-115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowPressCutOff</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Low Pressure Cut-off [Pa]</span>
<a name="ln-116"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompressorType</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Type of Compressor ie. Reciprocating,Rotary or Scroll</span>
<a name="ln-117"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">AirInletNodeNum</span>   <span class="o">=</span><span class="mi">0</span>   <span class="c">! air side coil inlet node number</span>
<a name="ln-118"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">AirOutletNodeNum</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! air side coil outlet node number</span>
<a name="ln-119"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WaterInletNodeNum</span> <span class="o">=</span><span class="mi">0</span>   <span class="c">! water side coil inlet node number</span>
<a name="ln-120"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WaterOutletNodeNum</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! water side coil outlet node number</span>
<a name="ln-121"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LowPressClgError</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! count for low pressure errors (cooling)</span>
<a name="ln-122"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HighPressClgError</span> <span class="o">=</span><span class="mi">0</span>   <span class="c">! count for high pressure errors (cooling)</span>
<a name="ln-123"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LowPressHtgError</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! count for low pressure errors (heating)</span>
<a name="ln-124"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HighPressHtgError</span> <span class="o">=</span><span class="mi">0</span>   <span class="c">! count for high pressure errors (heating)</span>
<a name="ln-125"></a>
<a name="ln-126"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LoopNum</span>           <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant loop index for water side</span>
<a name="ln-127"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LoopSide</span>          <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant loop side index</span>
<a name="ln-128"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BranchNum</span>         <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant branch index</span>
<a name="ln-129"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompNum</span>           <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant component index</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="k">END TYPE </span><span class="n">WatertoAirHPEquipConditions</span>
<a name="ln-132"></a>
<a name="ln-133"></a>
<a name="ln-134"></a><span class="c">! Output Variables Type definition</span>
<a name="ln-135"></a>
<a name="ln-136"></a>  <span class="c">!MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-137"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWatertoAirHPs</span>  <span class="o">=</span><span class="mi">0</span> <span class="c">! The Number of Water to Air Heat Pumps found in the Input</span>
<a name="ln-138"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">WatertoAirHPEquipConditions</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WatertoAirHP</span>
<a name="ln-139"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-140"></a>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">RefrigIndex</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Refrigerant index</span>
<a name="ln-143"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">WaterIndex</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Water index</span>
<a name="ln-144"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span> <span class="c">! Flag set to make sure you get input once</span>
<a name="ln-145"></a><span class="c">! Subroutine Specifications for the Module</span>
<a name="ln-146"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-147"></a><span class="k">PUBLIC  </span><span class="n">SimWatertoAirHP</span>
<a name="ln-148"></a>
<a name="ln-149"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-150"></a><span class="k">PRIVATE </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-151"></a>
<a name="ln-152"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-153"></a><span class="k">PRIVATE </span><span class="n">InitWatertoAirHP</span>
<a name="ln-154"></a>
<a name="ln-155"></a>          <span class="c">! Computational routines</span>
<a name="ln-156"></a><span class="k">PRIVATE </span><span class="n">CalcWatertoAirHPCooling</span>
<a name="ln-157"></a><span class="k">PRIVATE </span><span class="n">CalcWatertoAirHPHeating</span>
<a name="ln-158"></a>
<a name="ln-159"></a>          <span class="c">! Update routine to check convergence and update nodes</span>
<a name="ln-160"></a><span class="k">PRIVATE </span><span class="n">UpdateWatertoAirHP</span>
<a name="ln-161"></a>
<a name="ln-162"></a>          <span class="c">! Utility routines</span>
<a name="ln-163"></a><span class="k">PUBLIC  </span><span class="n">GetCoilIndex</span>
<a name="ln-164"></a><span class="k">PUBLIC  </span><span class="n">GetCoilCapacity</span>
<a name="ln-165"></a><span class="k">PUBLIC  </span><span class="n">GetCoilInletNode</span>
<a name="ln-166"></a><span class="k">PUBLIC  </span><span class="n">GetCoilOutletNode</span>
<a name="ln-167"></a>
<a name="ln-168"></a><span class="k">CONTAINS</span>
<a name="ln-169"></a>
<a name="ln-170"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-171"></a><span class="c">!*************************************************************************</span>
<a name="ln-172"></a>
<a name="ln-173"></a>
<a name="ln-174"></a><span class="k">SUBROUTINE </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">DesignAirflow</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-175"></a>           <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-176"></a>           <span class="n">FanDelayTime</span><span class="p">,</span><span class="n">InitFlag</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-177"></a>
<a name="ln-178"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-179"></a>          <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-180"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-181"></a>          <span class="c">!       MODIFIED       Dan Fisher, Kenneth Tang (Jan 2004)</span>
<a name="ln-182"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-183"></a>
<a name="ln-184"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-185"></a>          <span class="c">! This subroutine manages Water to Air Heat Pump component simulation.</span>
<a name="ln-186"></a>
<a name="ln-187"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-188"></a>          <span class="c">! na</span>
<a name="ln-189"></a>
<a name="ln-190"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-191"></a>          <span class="c">! na</span>
<a name="ln-192"></a>
<a name="ln-193"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-194"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-195"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-196"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-197"></a>
<a name="ln-198"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-199"></a>
<a name="ln-200"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-201"></a>
<a name="ln-202"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">DesignAirflow</span>         <span class="c">!design air flow rate</span>
<a name="ln-203"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">RuntimeFrac</span>           <span class="c">!compressor run time fraction</span>
<a name="ln-204"></a>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span> <span class="c">!Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>        <span class="c">!Heat pump time constant [s]</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>          <span class="c">!Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-208"></a>                                                <span class="c">!shut off after compressor cycle off  [s]</span>
<a name="ln-209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">SensLoad</span>              <span class="c">!sensible load</span>
<a name="ln-210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">LatentLoad</span>            <span class="c">!latent load</span>
<a name="ln-211"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">!first iteration flag</span>
<a name="ln-212"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">Initflag</span>      <span class="c">!initialization flag used to suppress property routine errors</span>
<a name="ln-213"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>  <span class="c">!component name</span>
<a name="ln-214"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span> <span class="c">! Index for Component name</span>
<a name="ln-215"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>      <span class="c">!cycling scheme--either continuous fan/cycling compressor or</span>
<a name="ln-216"></a>                                            <span class="c">!cycling fan/cycling compressor</span>
<a name="ln-217"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-219"></a>
<a name="ln-220"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-221"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-222"></a>
<a name="ln-223"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-224"></a>          <span class="c">! na</span>
<a name="ln-225"></a>
<a name="ln-226"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-227"></a>          <span class="c">! na</span>
<a name="ln-228"></a>
<a name="ln-229"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-230"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPNum</span>     <span class="c">! The WatertoAirHP that you are currently loading input into</span>
<a name="ln-231"></a>
<a name="ln-232"></a>          <span class="c">! FLOW:</span>
<a name="ln-233"></a>
<a name="ln-234"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-235"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-236"></a>    <span class="n">WaterIndex</span><span class="o">=</span><span class="n">FindGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span> <span class="c">!Initialize the WaterIndex once</span>
<a name="ln-237"></a>    <span class="k">CALL </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-238"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-239"></a>  <span class="k">End If</span>
<a name="ln-240"></a>
<a name="ln-241"></a>
<a name="ln-242"></a><span class="k"> IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-243"></a><span class="k">    </span><span class="n">HPNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-244"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HPNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-245"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;WaterToAir HP not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-246"></a>    <span class="n">ENDIF</span>
<a name="ln-247"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">HPNum</span>
<a name="ln-248"></a>  <span class="k">ELSE</span>
<a name="ln-249"></a><span class="k">    </span><span class="n">HPNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-250"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HPNum</span> <span class="o">&gt;</span> <span class="n">NumWatertoAirHPs</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">HPNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-251"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWatertoAirHP: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-252"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-253"></a>                          <span class="s1">&#39;, Number of Water to Air HPs=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-254"></a>                          <span class="s1">&#39;, WaterToAir HP name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-255"></a>    <span class="n">ENDIF</span>
<a name="ln-256"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-257"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompName</span> <span class="o">/=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-258"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWatertoAirHP: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-259"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-260"></a>                            <span class="s1">&#39;, WaterToAir HP name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored WaterToAir HP Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-261"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-262"></a>      <span class="n">ENDIF</span>
<a name="ln-263"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-264"></a>    <span class="n">ENDIF</span>
<a name="ln-265"></a>  <span class="n">ENDIF</span>
<a name="ln-266"></a>  <span class="c">! Calculate the Correct Water to Air HP Model with the current HPNum</span>
<a name="ln-267"></a>
<a name="ln-268"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPCoolingParamEst</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-269"></a><span class="k">    CALL </span><span class="n">InitWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span> <span class="n">InitFlag</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-270"></a>                          <span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">DesignAirflow</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-271"></a>    <span class="k">CALL </span><span class="n">CalcWatertoAirHPCooling</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">initflag</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="k">CALL </span><span class="n">UpdateWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-274"></a>
<a name="ln-275"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPHeatingParamEst</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-276"></a><span class="k">    CALL </span><span class="n">InitWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span> <span class="n">InitFlag</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-277"></a>                          <span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">DesignAirflow</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-278"></a>    <span class="k">CALL </span><span class="n">CalcWatertoAirHPHeating</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">initflag</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="k">CALL </span><span class="n">UpdateWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-281"></a>
<a name="ln-282"></a>  <span class="k">ELSE</span>
<a name="ln-283"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimWatertoAirHP: AirtoAir heatpump not in either HEATING or COOLING&#39;</span><span class="p">)</span>
<a name="ln-284"></a>  <span class="n">ENDIF</span>
<a name="ln-285"></a>
<a name="ln-286"></a>
<a name="ln-287"></a>  <span class="k">RETURN</span>
<a name="ln-288"></a>
<a name="ln-289"></a><span class="k">END SUBROUTINE </span><span class="n">SimWatertoAirHP</span>
<a name="ln-290"></a>
<a name="ln-291"></a>
<a name="ln-292"></a><span class="c">! Get Input Section of the Module</span>
<a name="ln-293"></a><span class="c">!******************************************************************************</span>
<a name="ln-294"></a><span class="k">SUBROUTINE </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-295"></a>
<a name="ln-296"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-297"></a>          <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-298"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-299"></a>          <span class="c">!       MODIFIED       Dan Fisher, Kenneth Tang (Jan 2004)</span>
<a name="ln-300"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-301"></a>
<a name="ln-302"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-303"></a>          <span class="c">! Obtains input data for HPs and stores it in HP data structures</span>
<a name="ln-304"></a>
<a name="ln-305"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-306"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-307"></a>
<a name="ln-308"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-309"></a>          <span class="c">! na</span>
<a name="ln-310"></a>
<a name="ln-311"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-312"></a>  <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-313"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span>
<a name="ln-314"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-315"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CheckFluidPropertyName</span><span class="p">,</span> <span class="n">FindGlycol</span>
<a name="ln-316"></a>  <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-317"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-318"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-319"></a>
<a name="ln-320"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-321"></a>
<a name="ln-322"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-323"></a>          <span class="c">! na</span>
<a name="ln-324"></a>
<a name="ln-325"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-326"></a>    <span class="kt">CHARACTER</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetWatertoAirHPInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-327"></a>
<a name="ln-328"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-329"></a>          <span class="c">! na</span>
<a name="ln-330"></a>
<a name="ln-331"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-332"></a>          <span class="c">! na</span>
<a name="ln-333"></a>
<a name="ln-334"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-335"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HPNum</span>      <span class="c">! The Water to Air HP that you are currently loading input into</span>
<a name="ln-336"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCool</span>
<a name="ln-337"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHeat</span>
<a name="ln-338"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WatertoAirHPNum</span>
<a name="ln-339"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumFluids</span>
<a name="ln-340"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-341"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumParams</span>
<a name="ln-342"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>
<a name="ln-343"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>     <span class="c">! Maximum number of numeric input fields</span>
<a name="ln-344"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! Maximum number of alpha input fields</span>
<a name="ln-345"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-346"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>   <span class="c">! If errors detected in input</span>
<a name="ln-347"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>                 <span class="c">! Flag to verify name</span>
<a name="ln-348"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>                 <span class="c">! Flag for blank name</span>
<a name="ln-349"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-350"></a>  <span class="kt">CHARACTER</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CurrentModuleObject</span>     <span class="c">! for ease in getting objects</span>
<a name="ln-351"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">AlphArray</span>      <span class="c">! Alpha input items for object</span>
<a name="ln-352"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-353"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NumArray</span>          <span class="c">! Numeric input items for object</span>
<a name="ln-355"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>      <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-356"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>    <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-357"></a>
<a name="ln-358"></a>
<a name="ln-359"></a>          <span class="c">! FLOW</span>
<a name="ln-360"></a>
<a name="ln-361"></a>    <span class="n">NumCool</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:ParameterEstimation&#39;</span><span class="p">)</span>
<a name="ln-362"></a>    <span class="n">NumHeat</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:ParameterEstimation&#39;</span><span class="p">)</span>
<a name="ln-363"></a>    <span class="n">NumWatertoAirHPs</span> <span class="o">=</span> <span class="n">NumCool</span><span class="o">+</span><span class="n">NumHeat</span>
<a name="ln-364"></a>    <span class="n">HPNum</span><span class="o">=</span> <span class="mi">0</span>
<a name="ln-365"></a>
<a name="ln-366"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-367"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No Equipment found in SimWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-368"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-369"></a>    <span class="k">END IF</span>
<a name="ln-370"></a>
<a name="ln-371"></a>   <span class="c">! Allocate Arrays</span>
<a name="ln-372"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-373"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-374"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-375"></a>      <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-376"></a>    <span class="n">ENDIF</span>
<a name="ln-377"></a>
<a name="ln-378"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:ParameterEstimation&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-379"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-380"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-381"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:ParameterEstimation&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-382"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-383"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-384"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-385"></a>    <span class="n">AlphArray</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-386"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-387"></a>    <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-388"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-389"></a>    <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-390"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-391"></a>    <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-392"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-393"></a>    <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-394"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-395"></a>    <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-396"></a>
<a name="ln-397"></a>      <span class="c">! Get the data for detailed cooling Heat Pump</span>
<a name="ln-398"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:ParameterEstimation&#39;</span>
<a name="ln-399"></a>
<a name="ln-400"></a>    <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCool</span>
<a name="ln-401"></a>
<a name="ln-402"></a>        <span class="n">HPNum</span><span class="o">=</span> <span class="n">HPNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-403"></a>
<a name="ln-404"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">HPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-405"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,&amp;</span>
<a name="ln-406"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-407"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-408"></a>
<a name="ln-409"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-410"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-411"></a>
<a name="ln-412"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">HPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-413"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-414"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-415"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-416"></a>        <span class="n">ENDIF</span>
<a name="ln-417"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-418"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-419"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-420"></a>        <span class="n">ENDIF</span>
<a name="ln-421"></a>
<a name="ln-422"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-423"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span>  <span class="o">=</span> <span class="s1">&#39;COOLING&#39;</span>
<a name="ln-424"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span> <span class="o">=</span> <span class="n">TypeOf_CoilWAHPCoolingParamEst</span>
<a name="ln-425"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Refrigerant</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-426"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-427"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolingCapacity</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-428"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-429"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-430"></a>
<a name="ln-431"></a>
<a name="ln-432"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-433"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-434"></a>
<a name="ln-435"></a>
<a name="ln-436"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-437"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-438"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-439"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-440"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-441"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-442"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-443"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-444"></a>                             <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-445"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-446"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-447"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-448"></a>
<a name="ln-449"></a>
<a name="ln-450"></a>        <span class="c">!2010-01-13 ESL: Jason Glazer noted that these were out of order previously, but they are good now</span>
<a name="ln-451"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideTotalUACoeff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-452"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideOutsideUACoeff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-453"></a>
<a name="ln-454"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideOutsideUACoeff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">rTinyValue</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-455"></a>            <span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideTotalUACoeff</span>   <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">rTinyValue</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-456"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Input problem for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-457"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; One or both load side UA values entered are below tolerance, likely zero or blank.&#39;</span><span class="p">)</span>
<a name="ln-458"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Verify inputs, as the parameter syntax for this object went through a change with&#39;</span><span class="p">)</span>
<a name="ln-459"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the release of EnergyPlus version 5.&#39;</span><span class="p">)</span>
<a name="ln-460"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-461"></a>        <span class="k">END IF</span>
<a name="ln-462"></a>
<a name="ln-463"></a><span class="k">        </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-464"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PowerLosses</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-465"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LossFactor</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-466"></a>
<a name="ln-467"></a>        <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-468"></a>
<a name="ln-469"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;RECIPROCATING&#39;</span><span class="p">)</span>
<a name="ln-470"></a>            <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span><span class="o">=</span><span class="n">CompressorType_Reciprocating</span>
<a name="ln-471"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-472"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-473"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-474"></a>
<a name="ln-475"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTARY&#39;</span><span class="p">)</span>
<a name="ln-476"></a>            <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span><span class="o">=</span><span class="n">CompressorType_Rotary</span>
<a name="ln-477"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-478"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-479"></a>
<a name="ln-480"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCROLL&#39;</span><span class="p">)</span>
<a name="ln-481"></a>            <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span><span class="o">=</span><span class="n">CompressorType_Scroll</span>
<a name="ln-482"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RefVolFlowRate</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-483"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">VolumeRatio</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-484"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LeakRateCoeff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-485"></a>
<a name="ln-486"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-487"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-488"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;) entered.&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-489"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-490"></a>
<a name="ln-491"></a>        <span class="k">END SELECT</span>
<a name="ln-492"></a>
<a name="ln-493"></a><span class="k">        </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-494"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR1</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-495"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR2</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-496"></a>
<a name="ln-497"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-498"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-499"></a>
<a name="ln-500"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-501"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-502"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-503"></a>
<a name="ln-504"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-505"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-506"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-507"></a>
<a name="ln-508"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-509"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-510"></a>
<a name="ln-511"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-512"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-513"></a>
<a name="ln-514"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-515"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-516"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPCOOLINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-517"></a>
<a name="ln-518"></a>        <span class="c">! save the design source side flow rate for use by plant loop sizing algorithms</span>
<a name="ln-519"></a>        <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-520"></a>
<a name="ln-521"></a>        <span class="c">!create predefined report entries</span>
<a name="ln-522"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilType</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-523"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolingCapacity</span><span class="p">)</span>
<a name="ln-524"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-525"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-526"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-527"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-528"></a>
<a name="ln-529"></a>   <span class="k">END DO</span>
<a name="ln-530"></a>
<a name="ln-531"></a>
<a name="ln-532"></a><span class="k">   </span><span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:ParameterEstimation&#39;</span>
<a name="ln-533"></a>
<a name="ln-534"></a>   <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeat</span>
<a name="ln-535"></a>
<a name="ln-536"></a>        <span class="n">HPNum</span><span class="o">=</span> <span class="n">HPNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-537"></a>
<a name="ln-538"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">WatertoAirHPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-539"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,&amp;</span>
<a name="ln-540"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-541"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-542"></a>
<a name="ln-543"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-544"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-545"></a>
<a name="ln-546"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">HPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-547"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-548"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-549"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-550"></a>        <span class="n">ENDIF</span>
<a name="ln-551"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-552"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-553"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-554"></a>        <span class="n">ENDIF</span>
<a name="ln-555"></a>
<a name="ln-556"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-557"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span>  <span class="o">=</span> <span class="s1">&#39;HEATING&#39;</span>
<a name="ln-558"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span> <span class="o">=</span> <span class="n">TypeOf_CoilWAHPHeatingParamEst</span>
<a name="ln-559"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Refrigerant</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-560"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-561"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatingCapacity</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-562"></a>
<a name="ln-563"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-564"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-565"></a>
<a name="ln-566"></a>
<a name="ln-567"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-568"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-569"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-570"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-571"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-572"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-573"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-574"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-575"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-576"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-577"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-578"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-579"></a>
<a name="ln-580"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideTotalUACoeff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-581"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideTotalUACoeff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">rTinyValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-582"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Input problem for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-583"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Load side UA value is less than tolerance, likely zero or blank.&#39;</span><span class="p">)</span>
<a name="ln-584"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Verify inputs, as the parameter syntax for this object went through a change with&#39;</span><span class="p">)</span>
<a name="ln-585"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the release of EnergyPlus version 5.&#39;</span><span class="p">)</span>
<a name="ln-586"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-587"></a>        <span class="k">END IF</span>
<a name="ln-588"></a>
<a name="ln-589"></a><span class="k">        </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-590"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PowerLosses</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-591"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LossFactor</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-592"></a>
<a name="ln-593"></a>        <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-594"></a>
<a name="ln-595"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;RECIPROCATING&#39;</span><span class="p">)</span>
<a name="ln-596"></a>            <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span><span class="o">=</span><span class="n">CompressorType_Reciprocating</span>
<a name="ln-597"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-598"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-599"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-600"></a>
<a name="ln-601"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTARY&#39;</span><span class="p">)</span>
<a name="ln-602"></a>            <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span><span class="o">=</span><span class="n">CompressorType_Rotary</span>
<a name="ln-603"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-604"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-605"></a>
<a name="ln-606"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCROLL&#39;</span><span class="p">)</span>
<a name="ln-607"></a>            <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span><span class="o">=</span><span class="n">CompressorType_Scroll</span>
<a name="ln-608"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RefVolFlowRate</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-609"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">VolumeRatio</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-610"></a>            <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LeakRateCoeff</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-611"></a>
<a name="ln-612"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-613"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-614"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;) entered.&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-615"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-616"></a>
<a name="ln-617"></a>        <span class="k">END SELECT</span>
<a name="ln-618"></a>
<a name="ln-619"></a><span class="k">        </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-620"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR1</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-621"></a>        <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR2</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-622"></a>
<a name="ln-623"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-624"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-625"></a>
<a name="ln-626"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-627"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-628"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-629"></a>
<a name="ln-630"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-631"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-632"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-633"></a>
<a name="ln-634"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-635"></a>             <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-636"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPHEATINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-637"></a>
<a name="ln-638"></a>        <span class="c">! save the design source side flow rate for use by plant loop sizing algorithms</span>
<a name="ln-639"></a>        <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-640"></a>
<a name="ln-641"></a>        <span class="c">!create predefined report entries</span>
<a name="ln-642"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilType</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-643"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatingCapacity</span><span class="p">)</span>
<a name="ln-644"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-645"></a>
<a name="ln-646"></a>    <span class="k">END DO</span>
<a name="ln-647"></a>
<a name="ln-648"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">)</span>
<a name="ln-649"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">)</span>
<a name="ln-650"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-651"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-652"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-653"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-654"></a>
<a name="ln-655"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-656"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found getting input. Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-657"></a>  <span class="n">ENDIF</span>
<a name="ln-658"></a>
<a name="ln-659"></a>
<a name="ln-660"></a>  <span class="k">DO </span><span class="n">HPNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span>
<a name="ln-661"></a>
<a name="ln-662"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span> <span class="o">==</span> <span class="n">TypeOf_CoilWAHPCoolingParamEst</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-663"></a>        <span class="c">! COOLING COIL: Setup Report variables for the Heat Pump</span>
<a name="ln-664"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-665"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-666"></a>
<a name="ln-667"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-668"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-669"></a>
<a name="ln-670"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-671"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-672"></a>
<a name="ln-673"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-674"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-675"></a>
<a name="ln-676"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-677"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-678"></a>
<a name="ln-679"></a>
<a name="ln-680"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-681"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-682"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-683"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-684"></a>
<a name="ln-685"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-686"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-687"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-688"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-689"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-690"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-691"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-692"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-693"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-694"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-695"></a>
<a name="ln-696"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-697"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-698"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-699"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-700"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-701"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-702"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span> <span class="o">==</span> <span class="n">TypeOf_CoilWAHPHeatingParamEst</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-703"></a>        <span class="c">! HEATING COIL Setup Report variables for the Heat Pump</span>
<a name="ln-704"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-705"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-706"></a>
<a name="ln-707"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-708"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-709"></a>
<a name="ln-710"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Sensible Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-711"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-712"></a>
<a name="ln-713"></a>
<a name="ln-714"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-715"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-716"></a>
<a name="ln-717"></a>
<a name="ln-718"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-719"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-720"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-721"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-722"></a>
<a name="ln-723"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-724"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-725"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-726"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-727"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-728"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-729"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-730"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-731"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-732"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-733"></a>
<a name="ln-734"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-735"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-736"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-737"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-738"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-739"></a>           <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-740"></a>
<a name="ln-741"></a>    <span class="n">ENDIF</span>
<a name="ln-742"></a>
<a name="ln-743"></a>
<a name="ln-744"></a>
<a name="ln-745"></a>  <span class="k">END DO</span>
<a name="ln-746"></a>
<a name="ln-747"></a>
<a name="ln-748"></a><span class="k">  RETURN</span>
<a name="ln-749"></a>
<a name="ln-750"></a><span class="k">END SUBROUTINE </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-751"></a><span class="c">! End of Get Input subroutines for the HB Module</span>
<a name="ln-752"></a><span class="c">!******************************************************************************</span>
<a name="ln-753"></a>
<a name="ln-754"></a>
<a name="ln-755"></a> <span class="c">! Beginning Initialization Section of the Module</span>
<a name="ln-756"></a><span class="c">!******************************************************************************</span>
<a name="ln-757"></a>
<a name="ln-758"></a><span class="k">SUBROUTINE </span><span class="n">InitWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">InitFlag</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-759"></a>                            <span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">DesignAirFlow</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-760"></a>
<a name="ln-761"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-762"></a>          <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-763"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-764"></a>          <span class="c">!       MODIFIED       Dan Fisher, Kenneth Tang (Jan 2004)</span>
<a name="ln-765"></a>          <span class="c">!                      Brent Griffith, Sept 2010, plant upgrades, general fluid properties</span>
<a name="ln-766"></a>
<a name="ln-767"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-768"></a>
<a name="ln-769"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-770"></a>          <span class="c">! This subroutine is for initializations of the Water to Air HP Components.</span>
<a name="ln-771"></a>
<a name="ln-772"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-773"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-774"></a>
<a name="ln-775"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-776"></a>
<a name="ln-777"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-778"></a>
<a name="ln-779"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-780"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-781"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-782"></a>
<a name="ln-783"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-784"></a>
<a name="ln-785"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-786"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">HPNum</span>  <span class="c">! index to main heat pump data structure</span>
<a name="ln-787"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span> <span class="c">!Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-788"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>        <span class="c">!Heat pump time constant [s]</span>
<a name="ln-789"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>          <span class="c">!Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-790"></a>                                               <span class="c">!shut off after compressor cycle off  [s]</span>
<a name="ln-791"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensLoad</span>
<a name="ln-792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentLoad</span>
<a name="ln-793"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignAirFlow</span>
<a name="ln-794"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InitFlag</span>
<a name="ln-795"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-796"></a>
<a name="ln-797"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-798"></a><span class="c">! REAL(r64), PARAMETER        :: CpWater=4210.d0          ! Specific heat of water J/kg_C</span>
<a name="ln-799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">TempTOL</span><span class="o">=</span><span class="mf">0.2d0</span>            <span class="c">! air temperature tolerance to trigger resimulation</span>
<a name="ln-800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">EnthTOL</span><span class="o">=</span><span class="mf">0.2d0</span>            <span class="c">! air enthalpy tolerance to trigger resimulation</span>
<a name="ln-801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">HumRatTOL</span><span class="o">=</span><span class="mf">0.2d0</span>          <span class="c">! air humidity ratio tolerance</span>
<a name="ln-802"></a>
<a name="ln-803"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-804"></a>          <span class="c">! na</span>
<a name="ln-805"></a>
<a name="ln-806"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-807"></a>          <span class="c">! na</span>
<a name="ln-808"></a>
<a name="ln-809"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-810"></a><span class="c">!  INTEGER             :: WatertoAirHPNum          ! heat pump number</span>
<a name="ln-811"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">AirInletNode</span>             <span class="c">! air inlet node number</span>
<a name="ln-812"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterInletNode</span>           <span class="c">! water inlet node number</span>
<a name="ln-813"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PlantOutletNode</span>
<a name="ln-814"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-815"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-816"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>  <span class="c">! local fluid specific heat</span>
<a name="ln-819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temptemp</span>
<a name="ln-820"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-821"></a>
<a name="ln-822"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-823"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-824"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-825"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-826"></a>    <span class="n">MyPlantScanFlag</span>   <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-827"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-828"></a>  <span class="k">END IF</span>
<a name="ln-829"></a>
<a name="ln-830"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-831"></a><span class="k">    </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-832"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-833"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-834"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-835"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-836"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-837"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-838"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-839"></a>
<a name="ln-840"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="o">==</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-841"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">rTinyValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-842"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Input problem for water to air heat pump, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-843"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Source side UA value is less than tolerance, likely zero or blank.&#39;</span><span class="p">)</span>
<a name="ln-844"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Verify inputs, as the parameter syntax for this object went through a change with&#39;</span><span class="p">)</span>
<a name="ln-845"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the release of EnergyPlus version 5.&#39;</span><span class="p">)</span>
<a name="ln-846"></a>        <span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-847"></a>      <span class="k">END IF</span>
<a name="ln-848"></a><span class="k">    ELSE</span>
<a name="ln-849"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR1</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">rTinyValue</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">rTinyValue</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-850"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Input problem for water to air heat pump, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-851"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; A source side heat transfer resistance value is less than tolerance, likely zero or blank.&#39;</span><span class="p">)</span>
<a name="ln-852"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Verify inputs, as the parameter syntax for this object went through a change with&#39;</span><span class="p">)</span>
<a name="ln-853"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the release of EnergyPlus version 5.&#39;</span><span class="p">)</span>
<a name="ln-854"></a>        <span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-855"></a>      <span class="k">END IF</span>
<a name="ln-856"></a><span class="k">    END IF</span>
<a name="ln-857"></a>
<a name="ln-858"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-859"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWatertoAirHP: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-860"></a>    <span class="n">ENDIF</span>
<a name="ln-861"></a>
<a name="ln-862"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-863"></a>  <span class="n">ENDIF</span>
<a name="ln-864"></a>
<a name="ln-865"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-866"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-867"></a>    <span class="c">! Do the initializations to start simulation</span>
<a name="ln-868"></a>    <span class="c">! Set water and air inlet nodes</span>
<a name="ln-869"></a>    <span class="n">AirInletNode</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-870"></a>    <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-871"></a>
<a name="ln-872"></a>      <span class="c">!Initialize all report variables to a known state at beginning of simulation</span>
<a name="ln-873"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-874"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-875"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-876"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-877"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-878"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-879"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-880"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-881"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-882"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-883"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-884"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-885"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-886"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-887"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-888"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-889"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-890"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-891"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-892"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-893"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-894"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-895"></a>
<a name="ln-896"></a>      <span class="c">! The rest of the one time initializations</span>
<a name="ln-897"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-898"></a>                              <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-899"></a>                              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-900"></a>                              <span class="s1">&#39;InitWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-901"></a>    <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-902"></a>                              <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-903"></a>                              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-904"></a>                              <span class="s1">&#39;InitWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-905"></a>
<a name="ln-906"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterVolFlowRate</span>
<a name="ln-907"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">=</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-908"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="o">=</span><span class="n">HPTimeConstant</span>
<a name="ln-909"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="o">=</span><span class="n">FanDelayTime</span>
<a name="ln-910"></a>
<a name="ln-911"></a>    <span class="n">PlantOutletNode</span> <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-912"></a>                         <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-913"></a>    <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-914"></a>                                 <span class="n">WaterInletNode</span><span class="p">,</span> <span class="n">PlantOutletNode</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-915"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-916"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-917"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-918"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-919"></a>
<a name="ln-920"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-921"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-922"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-923"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-924"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-925"></a>
<a name="ln-926"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">PlantOutletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-927"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">PlantOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-928"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">PlantOutletNode</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-929"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">PlantOutletNode</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-930"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">PlantOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-931"></a>
<a name="ln-932"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-933"></a>
<a name="ln-934"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-935"></a>  <span class="k">END IF</span>  <span class="c">! End If for the Begin Environment initializations</span>
<a name="ln-936"></a>
<a name="ln-937"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-938"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-939"></a>  <span class="n">ENDIF</span>
<a name="ln-940"></a>
<a name="ln-941"></a>
<a name="ln-942"></a>  <span class="c">! Do the following initializations (every time step): This should be the info from</span>
<a name="ln-943"></a>  <span class="c">! the previous components outlets or the node data in this section.</span>
<a name="ln-944"></a>  <span class="c">! First set the conditions for the air into the heat pump model</span>
<a name="ln-945"></a>
<a name="ln-946"></a>  <span class="c">! Set water and air inlet nodes</span>
<a name="ln-947"></a>   <span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-948"></a>   <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-949"></a>
<a name="ln-950"></a><span class="c">!  ! Set heat pump simulation flag to false if the air loop and water loop conditions have not changed</span>
<a name="ln-951"></a><span class="c">!  IF( .NOT. (BeginEnvrnFlag .and. MyEnvrnFlag) .AND. (&amp;</span>
<a name="ln-952"></a><span class="c">!  WatertoAirHP(HPNum)%InletWaterTemp      &gt;= (Node(WaterInletNode)%Temp + TempTOL) .OR. &amp;</span>
<a name="ln-953"></a><span class="c">!  WatertoAirHP(HPNum)%InletWaterTemp      &lt;= (Node(WaterInletNode)%Temp - TempTOL) .OR. &amp;</span>
<a name="ln-954"></a><span class="c">!  WatertoAirHP(HPNum)%InletWaterEnthalpy  &gt;= (Node(WaterInletNode)%Enthalpy + EnthTOL) .OR. &amp;</span>
<a name="ln-955"></a><span class="c">!  WatertoAirHP(HPNum)%InletWaterEnthalpy  &lt;= (Node(WaterInletNode)%Enthalpy - EnthTOL) .OR. &amp;!!</span>
<a name="ln-956"></a>
<a name="ln-957"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirDBTemp      &gt;= (Node(AirInletNode)%Temp + TempTOL) .OR. &amp;</span>
<a name="ln-958"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirDBTemp      &lt;= (Node(AirInletNode)%Temp - TempTOL) .OR. &amp;</span>
<a name="ln-959"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirHumRat      &gt;= (Node(AirInletNode)%HumRat + HumRatTOL) .OR. &amp;</span>
<a name="ln-960"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirHumRat      &lt;= (Node(AirInletNode)%HumRat - HumRatTOL) .OR. &amp;</span>
<a name="ln-961"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirEnthalpy    &gt;= (Node(AirInletNode)%Enthalpy + EnthTOL) .OR. &amp;</span>
<a name="ln-962"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirEnthalpy    &lt;= (Node(AirInletNode)%Enthalpy - EnthTOL) .OR. &amp;</span>
<a name="ln-963"></a><span class="c">!  WatertoAirHP(HPNum)%InletAirMassFlowRate &gt; 0.0))THEN</span>
<a name="ln-964"></a><span class="c">!    WatertoAirHP(HPNum)%SimFlag =.TRUE.</span>
<a name="ln-965"></a><span class="c">!  ELSE</span>
<a name="ln-966"></a><span class="c">!    WatertoAirHP(HPNum)%SimFlag =.FALSE.</span>
<a name="ln-967"></a><span class="c">!  ENDIF</span>
<a name="ln-968"></a>
<a name="ln-969"></a>
<a name="ln-970"></a>  <span class="k">IF</span><span class="p">(((</span><span class="n">SensLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LatentLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SensLoad</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">InitFlag</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-971"></a>     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-972"></a>    <span class="c">!set the water side flow rate to the design flow rate unless constrained by</span>
<a name="ln-973"></a>    <span class="c">!the demand side manager (MIN/MAX available). now done by call to setcomponentFlowRate</span>
<a name="ln-974"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-975"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">DesignAirFlow</span> <span class="c">!This is required instead of the node temperature</span>
<a name="ln-976"></a>                                                             <span class="c">!because the air loop operates handles part load for</span>
<a name="ln-977"></a>                                                             <span class="c">!cycling equipment by modulating the air flow rate</span>
<a name="ln-978"></a>                                                             <span class="c">!the heat pump model requires an accurate (i.e. full load</span>
<a name="ln-979"></a>                                                             <span class="c">!flow rate for accurate simulation.</span>
<a name="ln-980"></a>  <span class="k">ELSE</span> <span class="c">!heat pump is off</span>
<a name="ln-981"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-982"></a>
<a name="ln-983"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-984"></a>  <span class="n">ENDIF</span>
<a name="ln-985"></a>  <span class="c">!constrain water flow provided by plant</span>
<a name="ln-986"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-987"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-988"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-989"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-990"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-991"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-992"></a>                                 <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-993"></a>
<a name="ln-994"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-995"></a><span class="c">!  IF (WatertoAirHP(HPNum)%InletWaterTemp &lt; 0.0) THEN  ! Debug trap</span>
<a name="ln-996"></a><span class="c">!    Temptemp         = Node(WaterInletNode)%Temp</span>
<a name="ln-997"></a><span class="c">!  ENDIF</span>
<a name="ln-998"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-999"></a>
<a name="ln-1000"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1001"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-1002"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-1003"></a>
<a name="ln-1004"></a>
<a name="ln-1005"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1006"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1007"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1008"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1009"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1010"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1011"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1012"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1013"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1014"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1015"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1016"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1017"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1018"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1019"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1020"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a>  <span class="k">RETURN</span>
<a name="ln-1023"></a>
<a name="ln-1024"></a><span class="k">END SUBROUTINE </span><span class="n">InitWatertoAirHP</span>
<a name="ln-1025"></a>
<a name="ln-1026"></a> <span class="c">! End Initialization Section of the Module</span>
<a name="ln-1027"></a><span class="c">!******************************************************************************</span>
<a name="ln-1028"></a>
<a name="ln-1029"></a>
<a name="ln-1030"></a><span class="c">! Begin Algorithm Section of the Module</span>
<a name="ln-1031"></a><span class="c">!******************************************************************************</span>
<a name="ln-1032"></a><span class="k">SUBROUTINE </span><span class="n">CalcWatertoAirHPCooling</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">initflag</span><span class="p">,</span><span class="n">SensDemand</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-1033"></a>
<a name="ln-1034"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1035"></a>          <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-1036"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-1037"></a>          <span class="c">!       MODIFIED       Dan Fisher, Kenneth Tang (Jan 2004), R. Raustad (Oct 2006) Revised iteration technique</span>
<a name="ln-1038"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1041"></a>          <span class="c">! Simulates a parameter estimation based water to air heat pump model</span>
<a name="ln-1042"></a>
<a name="ln-1043"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1044"></a>          <span class="c">! na</span>
<a name="ln-1045"></a>
<a name="ln-1046"></a>  <span class="k">USE </span><span class="n">FluidProperties</span>
<a name="ln-1047"></a><span class="c">!  USE DataZoneEnergyDemands</span>
<a name="ln-1048"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span><span class="p">,</span><span class="n">GetCurveIndex</span>
<a name="ln-1049"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span><span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyWFnTdbH</span><span class="p">,</span><span class="n">PsyTwbFnTdbWPb</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!,PsyHFnTdbRhPb,PsyWFnTdpPb</span>
<a name="ln-1050"></a>                                  <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="n">PsyTsatFnHPb</span>
<a name="ln-1051"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-1052"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-1053"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-1054"></a>
<a name="ln-1055"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1056"></a>
<a name="ln-1057"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1058"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">HPNum</span>               <span class="c">!heat pump number</span>
<a name="ln-1059"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">RuntimeFrac</span>
<a name="ln-1060"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">SensDemand</span>
<a name="ln-1061"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">CyclingScheme</span>       <span class="c">!fan/compressor cycling scheme indicator</span>
<a name="ln-1062"></a>   <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>   <span class="n">FirstHVACIteration</span>  <span class="c">!first iteration flag</span>
<a name="ln-1063"></a>   <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span>   <span class="n">initflag</span>            <span class="c">!suppress property errors if true</span>
<a name="ln-1064"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">CompOp</span>
<a name="ln-1065"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-1066"></a>
<a name="ln-1067"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1068"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">CpWater</span><span class="o">=</span><span class="mi">421</span><span class="mf">0.d0</span>             <span class="c">! Specific heat of water J/kg_C</span>
<a name="ln-1069"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">DegreeofSuperheat</span><span class="o">=</span><span class="mi">8</span><span class="mf">0.d0</span>    <span class="c">! Initial guess of degree of superheat</span>
<a name="ln-1070"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="nb">gamma</span><span class="o">=</span> <span class="mf">1.114d0</span>             <span class="c">! Expansion Coefficient</span>
<a name="ln-1071"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">RelaxParam</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="n">d0</span>          <span class="c">! Relaxation Parameter</span>
<a name="ln-1072"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">ERR</span><span class="o">=</span><span class="mf">0.01d0</span>                 <span class="c">! Error Value</span>
<a name="ln-1073"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">ERR1</span><span class="o">=</span><span class="mf">0.001d0</span>               <span class="c">! Error Value</span>
<a name="ln-1074"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">PB</span><span class="o">=</span><span class="mf">1.013d5</span>               <span class="c">! Barometric Pressure (Pa)</span>
<a name="ln-1075"></a>
<a name="ln-1076"></a>
<a name="ln-1077"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">STOP1</span><span class="o">=</span><span class="mi">100000</span>             <span class="c">! Iteration stopper1</span>
<a name="ln-1078"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">STOP2</span><span class="o">=</span><span class="mi">100000</span>             <span class="c">! Iteration stopper2</span>
<a name="ln-1079"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">STOP3</span><span class="o">=</span><span class="mi">100000</span>             <span class="c">! Iteration stopper3</span>
<a name="ln-1080"></a>
<a name="ln-1081"></a>
<a name="ln-1082"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1083"></a>          <span class="c">! na</span>
<a name="ln-1084"></a>
<a name="ln-1085"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1086"></a>          <span class="c">! na</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1089"></a><span class="c">!      INTEGER                :: NumIteration1            ! Number of Iteration1</span>
<a name="ln-1090"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumIteration2</span>            <span class="c">! Number of Iteration2</span>
<a name="ln-1091"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumIteration3</span>            <span class="c">! Number of Iteration3</span>
<a name="ln-1092"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumIteration4</span>            <span class="c">! Number of Iteration4 (use of latent degradation model ONLY)</span>
<a name="ln-1093"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideFluidIndex</span>     <span class="c">! Source Side Fluid Index</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a>      <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompressorType</span>           <span class="c">! Type of Compressor ie. Reciprocating,Rotary or Scroll</span>
<a name="ln-1096"></a>      <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideFluidName</span>   <span class="c">! Name of source side fluid</span>
<a name="ln-1097"></a>      <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Refrigerant</span>           <span class="c">! Name of refrigerant</span>
<a name="ln-1098"></a><span class="c">!      CHARACTER(len=25) :: CErrCount</span>
<a name="ln-1099"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">NominalCoolingCapacity</span>   <span class="c">! Nominal Cooling Capacity (W)</span>
<a name="ln-1100"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideTotalUA</span>          <span class="c">! Load Side Total Heat Transfer coefficient [W/C]</span>
<a name="ln-1101"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideoutsideUA</span>        <span class="c">! Load Side Outside Heat Transfer coefficient [W/C]</span>
<a name="ln-1102"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideUA</span>             <span class="c">! Source Side Heat Transfer coefficient [W/C]</span>
<a name="ln-1103"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PressureDrop</span>             <span class="c">! Suction or Discharge Pressure Drop [Pa]</span>
<a name="ln-1104"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ClearanceFactor</span>          <span class="c">! Compressor Clearance Factor</span>
<a name="ln-1105"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PistonDisp</span>               <span class="c">! Compressor Piston Displacement [m3/s]</span>
<a name="ln-1106"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ShTemp</span>                   <span class="c">! Superheat Temperature [C]</span>
<a name="ln-1107"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LosFac</span>                   <span class="c">! Compressor Power Loss Factor</span>
<a name="ln-1108"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PowerLos</span>                 <span class="c">! Constant Part of Power Losses [kW]</span>
<a name="ln-1109"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">RefVolFlowRate</span>           <span class="c">! Refrigerant Volume Flow rate at the beginning</span>
<a name="ln-1110"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">VolumeRatio</span>              <span class="c">! Built-in-volume ratio [~]</span>
<a name="ln-1111"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LeakRateCoeff</span>            <span class="c">! Coefficient for the relationship between</span>
<a name="ln-1112"></a>                                                   <span class="c">! Pressure Ratio and Leakage Rate [~]</span>
<a name="ln-1113"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideHTRes1</span>         <span class="c">! Source Side Heat Transfer Resistance coefficient 1 [~]</span>
<a name="ln-1114"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideHTRes2</span>         <span class="c">! Source Side Heat Transfer Resistance coefficient 2 [K/kW]</span>
<a name="ln-1115"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">HighPressCutOff</span>          <span class="c">! High Pressure Cut-off [Pa]</span>
<a name="ln-1116"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LowPressCutOff</span>           <span class="c">! Low Pressure Cut-off [Pa]</span>
<a name="ln-1117"></a>
<a name="ln-1118"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Quality</span>                  <span class="c">! Quality of Refrigerant</span>
<a name="ln-1119"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span>   <span class="c">! Source Side Mass Flow Rate [kg/s]</span>
<a name="ln-1120"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>      <span class="c">! Source Side Inlet Temperature [C]</span>
<a name="ln-1121"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideWaterInletEnth</span> <span class="c">! Source Side Outlet Enthalpy [J/kg]</span>
<a name="ln-1122"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideoutletTemp</span>     <span class="c">! Source Side Outlet Temperature [C]</span>
<a name="ln-1123"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideVolFlowRate</span>    <span class="c">! Source Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-1124"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">DegradFactor</span>             <span class="c">! Degradation Factor [~]</span>
<a name="ln-1125"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CpFluid</span>                  <span class="c">! Specific heat of source side fluid(J/kg)</span>
<a name="ln-1126"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>     <span class="c">! Load Side Mass Flow Rate [kg/s]</span>
<a name="ln-1127"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletWBTemp</span>      <span class="c">! Wet-bulb temperature of indoor inlet air [C]</span>
<a name="ln-1128"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletDBTemp</span>      <span class="c">! Load Side Inlet Dry Bulb Temp [C]</span>
<a name="ln-1129"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletHumRat</span>      <span class="c">! Load Side Inlet Humidity Ratio [kg/kg]</span>
<a name="ln-1130"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideoutletDBTemp</span>     <span class="c">! Load Side Outlet Dry Bulb Temperature [C]</span>
<a name="ln-1131"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadsideOutletHumRat</span>     <span class="c">! Load Side Outlet Humidity Ratio [kg/kg]</span>
<a name="ln-1132"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideAirInletEnth</span>     <span class="c">! Load Side Inlet Enthalpy [J/kg]</span>
<a name="ln-1133"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideAirOutletEnth</span>    <span class="c">! Load Side Outlet Enthalpy [J/kg]</span>
<a name="ln-1134"></a><span class="c">!      REAL(r64)        :: EffectiveSurfaceTemp1    ! Effective Surface Temperature Guess #1 [C]</span>
<a name="ln-1135"></a><span class="c">!      REAL(r64)        :: EffectiveSurfaceTemp2    ! Effective Surface Temperature Guess #2 [C]</span>
<a name="ln-1136"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">EffectiveSurfaceTemp</span>     <span class="c">! Effective Surface Temperature [C]</span>
<a name="ln-1137"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">EffectiveSatEnth</span>         <span class="c">! Saturated Enthalpy of Air Corresponding to the Effective Surface</span>
<a name="ln-1138"></a>                                                   <span class="c">! Temperature [J/kg]</span>
<a name="ln-1139"></a><span class="c">!      REAL(r64)        :: EffectiveSatEnth1        ! Guess of the Saturated Enthalpy of Air Corresponding to the</span>
<a name="ln-1140"></a><span class="c">!                                                   ! Effective Surface Temperature [J/kg]</span>
<a name="ln-1141"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QSource</span>                  <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-1142"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QLoadTotal</span>               <span class="c">! Load Side Total Heat Transfer Rate [W]</span>
<a name="ln-1143"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QSensible</span>                <span class="c">! Load Side Sensible Heat Transfer Rate [W]</span>
<a name="ln-1144"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Power</span>                    <span class="c">! Power Consumption [W]</span>
<a name="ln-1145"></a><span class="c">!      REAL(r64)        :: EvapTemp1                ! Evaporating Temperature Guess #1 [C]</span>
<a name="ln-1146"></a><span class="c">!      REAL(r64)        :: EvapTemp2                ! Evaporating Temperature Guess #2 [C]</span>
<a name="ln-1147"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">EvapTemp</span>                 <span class="c">! Evaporating Temperature [C]</span>
<a name="ln-1148"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ANTUWET</span>                  <span class="c">! Number of Transfer Unit for Wet Condition</span>
<a name="ln-1149"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">EffectWET</span>                <span class="c">! Load Side Heat Exchanger Effectiveness</span>
<a name="ln-1150"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">EvapSatEnth</span>              <span class="c">! Saturated Enthalpy of Air Corresponding to the Evaporating</span>
<a name="ln-1151"></a>                                                   <span class="c">! Temperature [J/kg]</span>
<a name="ln-1152"></a><span class="c">!      REAL(r64)        :: EvapSatEnth1             ! Guess of the Saturated Enthalpy of Air Corresponding to the</span>
<a name="ln-1153"></a><span class="c">!                                                   ! Evaporating Temperature [J/kg]</span>
<a name="ln-1154"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideEffect</span>         <span class="c">! Source Side Heat Exchanger Effectiveness</span>
<a name="ln-1155"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideEffec</span>            <span class="c">! Load Side Effectiveness based on Outside Heat Transfer Coefficient</span>
<a name="ln-1156"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideTemp</span>           <span class="c">! Source Side Saturated Refrigerant Temperature [C]</span>
<a name="ln-1157"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideTemp</span>             <span class="c">! Load Side Saturated Refrigerant Temperature [C]</span>
<a name="ln-1158"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSidePressure</span>       <span class="c">! Source Side Saturated Refrigerant Pressure [Pa]</span>
<a name="ln-1159"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSidePressure</span>         <span class="c">! Load Side Saturated Refrigerant Pressure [Pa]</span>
<a name="ln-1160"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SuctionPr</span>                <span class="c">! Compressor Suction Pressure [Pa]</span>
<a name="ln-1161"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">DischargePr</span>              <span class="c">! Compressor Discharge Pressure [Pa]</span>
<a name="ln-1162"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompressInletTemp</span>        <span class="c">! Temperature of the Refrigerant Entering the Compressor [C]</span>
<a name="ln-1163"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MassRef</span>                  <span class="c">! Mass Flow Rate of Refrigerant [kg/s]</span>
<a name="ln-1164"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SourceSideOutletEnth</span>     <span class="c">! Enthalpy of Refrigerant leaving the Source Side Heat Exchanger [J/kg]</span>
<a name="ln-1165"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideOutletEnth</span>       <span class="c">! Enthalpy of Refrigerant leaving the Load Side Heat Exchanger [J/kg]</span>
<a name="ln-1166"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CpAir</span>                    <span class="c">! Specific Heat of Air [J/kg_C]</span>
<a name="ln-1167"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">initialQSource</span>           <span class="c">! Guess Source Side Heat Transfer Rate [W]</span>
<a name="ln-1168"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">initialQLoadTotal</span>        <span class="c">! Guess Load Side Heat Transfer rate [W]</span>
<a name="ln-1169"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SuperHeatEnth</span>            <span class="c">! Enthalpy of the Superheated Refrigerant [J/kg]</span>
<a name="ln-1170"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompSuctionTemp1</span>         <span class="c">! Guess of the Temperature of the Refrigerant Entering the</span>
<a name="ln-1171"></a>                                                   <span class="c">! Compressor #1 [C]</span>
<a name="ln-1172"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompSuctionTemp2</span>         <span class="c">! Guess of the Temperature of the Refrigerant Entering the</span>
<a name="ln-1173"></a>                                                   <span class="c">! Compressor #2 [C]</span>
<a name="ln-1174"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">CompSuctionTemp</span>          <span class="c">! Temperature of the Refrigerant Entering the Compressor [C]</span>
<a name="ln-1175"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompSuctionEnth</span>          <span class="c">! Enthalpy of the Refrigerant Entering the Compressor [J/kg]</span>
<a name="ln-1176"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompSuctionDensity</span>       <span class="c">! Density of the Refrigerant Entering the Compressorkg/m3</span>
<a name="ln-1177"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompSuctionSatTemp</span>       <span class="c">! Temperature of Saturated Refrigerant at Compressor Suction Pressure [C]</span>
<a name="ln-1178"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Twet_rated</span>               <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-1179"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Gamma_rated</span>              <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-1180"></a>      <span class="kt">LOGICAL</span>          <span class="kd">::</span> <span class="n">LatDegradModelSimFlag</span>    <span class="c">! Latent degradation model simulation flag</span>
<a name="ln-1181"></a>      <span class="kt">LOGICAL</span>          <span class="kd">::</span> <span class="n">FinalSimFlag</span>             <span class="c">! Final Simulation Flag</span>
<a name="ln-1182"></a>      <span class="kt">LOGICAL</span>          <span class="kd">::</span> <span class="n">Converged</span>                <span class="c">! overall convergence Flag</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QLatRated</span>                <span class="c">! Qlatent at rated conditions of indoor(TDB,TWB)=(26.7C,19.4C)</span>
<a name="ln-1185"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QLatActual</span>               <span class="c">! Qlatent at actual operating conditions</span>
<a name="ln-1186"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SHRss</span>                    <span class="c">! Sensible heat ratio at steady state</span>
<a name="ln-1187"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SHReff</span>                   <span class="c">! Effective sensible heat ratio at part-load condition</span>
<a name="ln-1188"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                   <span class="c">! Parameter array passed to RegulaFalsi function</span>
<a name="ln-1189"></a>      <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">SolFlag</span>                  <span class="c">! Solution flag returned from RegulaFalsi function</span>
<a name="ln-1190"></a>      <span class="kt">LOGICAL</span>          <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1191"></a>      <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1192"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletDBTemp_Init</span> <span class="c">! rated conditions</span>
<a name="ln-1193"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletHumRat_Init</span> <span class="c">! rated conditions</span>
<a name="ln-1194"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideAirInletEnth_Init</span> <span class="c">! rated conditions</span>
<a name="ln-1195"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletDBTemp_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-1196"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletHumRat_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-1197"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideAirInletEnth_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1200"></a>      <span class="c">!Set indoor air conditions to the rated condition</span>
<a name="ln-1201"></a>      <span class="n">LoadSideInletDBTemp_Init</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.7d0</span>
<a name="ln-1202"></a>      <span class="n">LoadSideInletHumRat_Init</span> <span class="o">=</span> <span class="mf">0.0111d0</span>
<a name="ln-1203"></a>      <span class="n">LoadSideAirInletEnth_Init</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">)</span>
<a name="ln-1204"></a>      <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1205"></a>    <span class="n">ENDIF</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a> <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-1208"></a>    <span class="n">NominalCoolingCapacity</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolingCapacity</span>
<a name="ln-1209"></a>    <span class="n">CompressorType</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span>
<a name="ln-1210"></a>    <span class="n">Refrigerant</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Refrigerant</span>
<a name="ln-1211"></a>    <span class="n">LoadSideTotalUA</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideTotalUACoeff</span>
<a name="ln-1212"></a>    <span class="n">LoadSideoutsideUA</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideOutsideUACoeff</span>
<a name="ln-1213"></a>    <span class="n">PistonDisp</span>        <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span>
<a name="ln-1214"></a>    <span class="n">ClearanceFactor</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span>
<a name="ln-1215"></a>    <span class="n">PressureDrop</span>      <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span>
<a name="ln-1216"></a>    <span class="n">ShTemp</span>            <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span>
<a name="ln-1217"></a>    <span class="n">PowerLos</span>          <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PowerLosses</span>
<a name="ln-1218"></a>    <span class="n">LosFac</span>            <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LossFactor</span>
<a name="ln-1219"></a>    <span class="n">RefVolFlowRate</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RefVolFlowRate</span>
<a name="ln-1220"></a>    <span class="n">VolumeRatio</span>       <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">VolumeRatio</span>
<a name="ln-1221"></a>    <span class="n">LeakRateCoeff</span>     <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LeakRateCoeff</span>
<a name="ln-1222"></a>    <span class="n">SourceSideUA</span>      <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span>
<a name="ln-1223"></a>    <span class="n">SourceSideHTRes1</span>  <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR1</span>
<a name="ln-1224"></a>    <span class="n">SourceSideHTRes2</span>  <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR2</span>
<a name="ln-1225"></a>    <span class="n">HighPressCutOff</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>
<a name="ln-1226"></a>    <span class="n">LowPressCutOff</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>
<a name="ln-1227"></a>
<a name="ln-1228"></a>    <span class="n">LoadSideMassFlowRate</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-1229"></a>                               <span class="c">!Set indoor air conditions to the actual condition</span>
<a name="ln-1230"></a>    <span class="n">LoadSideInletDBTemp_Unit</span><span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-1231"></a>    <span class="n">LoadSideInletHumRat_Unit</span><span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-1232"></a>    <span class="n">cpair</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat_Unit</span><span class="p">,</span><span class="n">LoadSideInletDBTemp_Unit</span><span class="p">)</span>
<a name="ln-1233"></a>    <span class="n">LoadSideAirInletEnth_Unit</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Unit</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Unit</span><span class="p">)</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a>    <span class="n">SourceSideInletTemp</span>      <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-1236"></a>    <span class="n">SourceSideWaterInletEnth</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-1237"></a>    <span class="n">SourceSideFluidName</span>      <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span>
<a name="ln-1238"></a>    <span class="n">SourceSideFluidIndex</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span>
<a name="ln-1239"></a>    <span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-1240"></a>    <span class="n">SourceSideVolFlowRate</span>  <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span> <span class="o">/</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">SourceSideFluidName</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1241"></a>                                                        <span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideFluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1242"></a>                                                       <span class="s1">&#39;CalcWatertoAirHPCooling:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-1243"></a>
<a name="ln-1244"></a>    <span class="n">Twet_rated</span>  <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Twet_Rated</span>
<a name="ln-1245"></a>    <span class="n">Gamma_rated</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a>    <span class="n">FinalSimFlag</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1248"></a>
<a name="ln-1249"></a><span class="c">! If heat pump is not operating, return</span>
<a name="ln-1250"></a><span class="k">IF</span> <span class="p">(</span><span class="n">SensDemand</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LoadSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SourceSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1251"></a><span class="k">   </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1252"></a>   <span class="k">RETURN</span>
<a name="ln-1253"></a><span class="k">ELSE</span>
<a name="ln-1254"></a><span class="k">   </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1255"></a><span class="n">ENDIF</span>
<a name="ln-1256"></a>
<a name="ln-1257"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1258"></a><span class="k">   </span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1259"></a>   <span class="k">RETURN</span>
<a name="ln-1260"></a><span class="n">ENDIF</span>
<a name="ln-1261"></a>
<a name="ln-1262"></a><span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1263"></a><span class="k">  </span><span class="n">initialQSource</span> <span class="o">=</span> <span class="n">NominalCoolingCapacity</span>
<a name="ln-1264"></a>  <span class="n">initialQLoadTotal</span> <span class="o">=</span> <span class="n">NominalCoolingCapacity</span>
<a name="ln-1265"></a><span class="n">ENDIF</span>
<a name="ln-1266"></a>
<a name="ln-1267"></a><span class="k">IF</span><span class="p">(</span><span class="n">initialQLoadTotal</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span>  <span class="n">initialQLoadTotal</span> <span class="o">=</span> <span class="n">NominalCoolingCapacity</span>
<a name="ln-1268"></a><span class="k">IF</span><span class="p">(</span><span class="n">initialQSource</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span>  <span class="n">initialQSource</span> <span class="o">=</span> <span class="n">NominalCoolingCapacity</span>
<a name="ln-1269"></a>
<a name="ln-1270"></a>
<a name="ln-1271"></a><span class="c">!Loop the calculation at least twice depending whether the latent degradation model</span>
<a name="ln-1272"></a><span class="c">!is enabled. 1st iteration to calculate the QLatent(rated) at (TDB,TWB)indoorair=(26.7C,19.4C)</span>
<a name="ln-1273"></a><span class="c">!and 2nd iteration to calculate the  QLatent(actual)</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a><span class="n">QLatRated</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1276"></a><span class="n">QLatActual</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1277"></a><span class="c">!IF((RuntimeFrac .GE. 1.0) .OR. (Twet_rated .LE. 0.0) .OR. (Gamma_rated .LE. 0.0)) THEN</span>
<a name="ln-1278"></a><span class="c">! Cycling fan does not required latent degradation model, only the constant fan case</span>
<a name="ln-1279"></a><span class="k">IF</span><span class="p">((</span><span class="n">RuntimeFrac</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Twet_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Gamma_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1280"></a><span class="k">  </span><span class="n">LatDegradModelSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1281"></a>  <span class="c">!Set NumIteration4=1 so that latent model would quit after 1 simulation with the actual condition</span>
<a name="ln-1282"></a>  <span class="n">NumIteration4</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1283"></a><span class="k">ELSE</span>
<a name="ln-1284"></a><span class="k">  </span><span class="n">LatDegradModelSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1285"></a>  <span class="c">!Set NumIteration4=0 so that latent model would simulate twice with rated and actual condition</span>
<a name="ln-1286"></a>  <span class="n">NumIteration4</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1287"></a><span class="k">END IF</span>
<a name="ln-1288"></a>
<a name="ln-1289"></a><span class="n">LOOPLatentDegradationModel</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-1290"></a><span class="n">NumIteration4</span><span class="o">=</span><span class="n">NumIteration4</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1291"></a><span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration4</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1292"></a>  <span class="c">!Set indoor air conditions to the rated condition</span>
<a name="ln-1293"></a>  <span class="n">LoadSideInletDBTemp</span>  <span class="o">=</span> <span class="n">LoadSideInletDBTemp_Init</span>
<a name="ln-1294"></a>  <span class="n">LoadSideInletHumRat</span>  <span class="o">=</span> <span class="n">LoadSideInletHumRat_Init</span>
<a name="ln-1295"></a>  <span class="n">LoadSideAirInletEnth</span> <span class="o">=</span> <span class="n">LoadSideAirInletEnth_Init</span>
<a name="ln-1296"></a><span class="k">ELSE</span>
<a name="ln-1297"></a>  <span class="c">!Set indoor air conditions to the actual condition</span>
<a name="ln-1298"></a>  <span class="n">LoadSideInletDBTemp</span>  <span class="o">=</span> <span class="n">LoadSideInletDBTemp_Unit</span>
<a name="ln-1299"></a>  <span class="n">LoadSideInletHumRat</span>  <span class="o">=</span> <span class="n">LoadSideInletHumRat_Unit</span>
<a name="ln-1300"></a>  <span class="n">LoadSideAirInletEnth</span> <span class="o">=</span> <span class="n">LoadSideAirInletEnth_Unit</span>
<a name="ln-1301"></a><span class="k">END IF</span>
<a name="ln-1302"></a>
<a name="ln-1303"></a>  <span class="c">!Outerloop: Calculate source side heat transfer</span>
<a name="ln-1304"></a>  <span class="n">NumIteration2</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1305"></a>  <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1306"></a>  <span class="n">FinalSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1307"></a>  <span class="n">LOOPSourceEnth</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-1308"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Converged</span><span class="p">)</span> <span class="n">FinalSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1309"></a>
<a name="ln-1310"></a>    <span class="n">NumIteration2</span><span class="o">=</span><span class="n">NumIteration2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration2</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">STOP2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1313"></a><span class="k">      </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1314"></a>      <span class="k">RETURN</span>
<a name="ln-1315"></a><span class="k">    END IF</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a>    <span class="c">!Innerloop: Calculate load side heat transfer</span>
<a name="ln-1318"></a>    <span class="n">NumIteration3</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1319"></a>    <span class="n">LOOPLoadEnth</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a><span class="k">      </span><span class="n">NumIteration3</span><span class="o">=</span><span class="n">NumIteration3</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1322"></a>
<a name="ln-1323"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration3</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">STOP3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1324"></a><span class="k">        </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1325"></a>        <span class="k">RETURN</span>
<a name="ln-1326"></a><span class="k">      END IF</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>      <span class="c">! Determine Effectiveness of Source Side</span>
<a name="ln-1329"></a>      <span class="n">CpFluid</span><span class="o">=</span><span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">SourceSideFluidName</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideFluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1330"></a>                                    <span class="s1">&#39;CalcWatertoAirHPCooling:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a><span class="c">!      IF (SourceSideFluidName==&#39;WATER&#39;) THEN</span>
<a name="ln-1333"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSideFluidIndex</span> <span class="o">==</span> <span class="n">WaterIndex</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! SourceSideFluidName==&#39;Water&#39;</span>
<a name="ln-1334"></a>        <span class="n">SourceSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">SourceSideUA</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpFluid</span> <span class="o">*</span> <span class="n">SourceSideMassFlowRate</span><span class="p">))</span>
<a name="ln-1335"></a>      <span class="k">ELSE</span>
<a name="ln-1336"></a><span class="k">        </span><span class="n">DegradFactor</span><span class="o">=</span><span class="n">DegradF</span><span class="p">(</span><span class="n">SourceSideFluidName</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideFluidIndex</span><span class="p">)</span>
<a name="ln-1337"></a>        <span class="n">SourceSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">((</span><span class="n">SourceSideHTRes1</span> <span class="o">*</span> <span class="n">SourceSideVolFlowRate</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8d0</span><span class="p">))</span> <span class="o">/</span> <span class="n">DegradFactor</span> <span class="o">+</span> <span class="n">SourceSideHTRes2</span><span class="p">)</span>
<a name="ln-1338"></a>      <span class="k">END IF</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a>      <span class="c">! Determine Source Side Tempertaure (Condensing Temp in this case)</span>
<a name="ln-1341"></a>      <span class="n">SourceSideTemp</span> <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">+</span><span class="n">initialQSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideEffect</span> <span class="o">*</span> <span class="n">CpFluid</span> <span class="o">*</span> <span class="n">SourceSideMassFlowRate</span><span class="p">)</span>
<a name="ln-1342"></a>
<a name="ln-1343"></a>      <span class="c">! Compute the Effective Surface Temperature</span>
<a name="ln-1344"></a>      <span class="n">LoadSideEffec</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">LoadSideoutsideUA</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">CpAir</span><span class="p">))</span>
<a name="ln-1345"></a>      <span class="n">EffectiveSatEnth</span><span class="o">=</span><span class="n">LoadSideAirInletEnth</span><span class="o">-</span><span class="n">initialQloadTotal</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideEffec</span><span class="o">*</span><span class="n">LoadSideMassFlowRate</span><span class="p">)</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a><span class="c">!      ! Set up the Initial Range of Effective Surface Temperature</span>
<a name="ln-1348"></a><span class="c">!      IF(.NOT. Converged)THEN</span>
<a name="ln-1349"></a><span class="c">!        EffectiveSurfaceTemp1=-100.</span>
<a name="ln-1350"></a><span class="c">!        EffectiveSurfaceTemp2=200.</span>
<a name="ln-1351"></a><span class="c">!      END IF</span>
<a name="ln-1352"></a><span class="c">!</span>
<a name="ln-1353"></a><span class="c">!      ! Iterate to calculate the effective surface temp from the corresponding enthalpy</span>
<a name="ln-1354"></a><span class="c">!      NumIteration1=0</span>
<a name="ln-1355"></a><span class="c">!      LOOP1: DO</span>
<a name="ln-1356"></a><span class="c">!</span>
<a name="ln-1357"></a><span class="c">!        NumIteration1=NumIteration1+1</span>
<a name="ln-1358"></a><span class="c">!        IF (NumIteration1.GT.STOP1) THEN</span>
<a name="ln-1359"></a><span class="c">!          WatertoAirHP(HPNum)%SimFlag = .FALSE.</span>
<a name="ln-1360"></a><span class="c">!          RETURN</span>
<a name="ln-1361"></a><span class="c">!        END IF</span>
<a name="ln-1362"></a><span class="c">!</span>
<a name="ln-1363"></a><span class="c">!        EffectiveSurfaceTemp=0.5d0*(EffectiveSurfaceTemp1+EffectiveSurfaceTemp2)</span>
<a name="ln-1364"></a><span class="c">!        EffectiveSatEnth1=PsyHFnTdbRhPb(EffectiveSurfaceTemp,1.0,PB)</span>
<a name="ln-1365"></a><span class="c">!</span>
<a name="ln-1366"></a><span class="c">!        IF(ABS(EffectiveSatEnth-EffectiveSatEnth1).LT.0.01 .OR. &amp;</span>
<a name="ln-1367"></a><span class="c">!          ABS(EffectiveSurfaceTemp1-EffectiveSurfaceTemp2).LT.0.001) THEN</span>
<a name="ln-1368"></a><span class="c">!          EXIT LOOP1</span>
<a name="ln-1369"></a><span class="c">!        END IF</span>
<a name="ln-1370"></a><span class="c">!</span>
<a name="ln-1371"></a><span class="c">!        IF(EffectiveSatEnth1.LT.EffectiveSatEnth) THEN</span>
<a name="ln-1372"></a><span class="c">!          EffectiveSurfaceTemp1=EffectiveSurfaceTemp</span>
<a name="ln-1373"></a><span class="c">!        ELSE</span>
<a name="ln-1374"></a><span class="c">!          EffectiveSurfaceTemp2=EffectiveSurfaceTemp</span>
<a name="ln-1375"></a><span class="c">!        END IF</span>
<a name="ln-1376"></a><span class="c">!      END DO LOOP1</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>      <span class="n">EffectiveSurfaceTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EffectiveSatEnth</span><span class="p">,</span><span class="n">PB</span><span class="p">)</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>      <span class="n">QSensible</span><span class="o">=</span><span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">CpAir</span><span class="o">*</span><span class="p">(</span><span class="n">LoadSideInletDBTemp</span><span class="o">-</span><span class="n">EffectiveSurfaceTemp</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideEffec</span>
<a name="ln-1381"></a>      <span class="n">ANTUWET</span><span class="o">=</span><span class="n">LoadSideTotalUA</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">CpAir</span><span class="p">)</span>
<a name="ln-1382"></a>      <span class="n">EffectWET</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">ANTUWET</span><span class="p">)</span>
<a name="ln-1383"></a>      <span class="n">EvapSatEnth</span><span class="o">=</span><span class="n">LoadsideAirInletEnth</span><span class="o">-</span><span class="n">initialQloadTotal</span><span class="o">/</span><span class="p">(</span><span class="n">EffectWET</span><span class="o">*</span><span class="n">LoadSideMassFlowRate</span><span class="p">)</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a><span class="c">!      ! Iterate to compute Evaporating Temperature</span>
<a name="ln-1386"></a><span class="c">!      IF(.NOT. Converged)THEN</span>
<a name="ln-1387"></a><span class="c">!        EvapTemp1=-150</span>
<a name="ln-1388"></a><span class="c">!        EvapTemp2=100</span>
<a name="ln-1389"></a><span class="c">!      END IF</span>
<a name="ln-1390"></a><span class="c">!      NumIteration1=0</span>
<a name="ln-1391"></a><span class="c">!      LOOP2: DO</span>
<a name="ln-1392"></a><span class="c">!        NumIteration1=NumIteration1+1</span>
<a name="ln-1393"></a><span class="c">!</span>
<a name="ln-1394"></a><span class="c">!        IF (NumIteration1.GT.STOP1) THEN</span>
<a name="ln-1395"></a><span class="c">!          WatertoAirHP(HPNum)%SimFlag = .FALSE.</span>
<a name="ln-1396"></a><span class="c">!          RETURN</span>
<a name="ln-1397"></a><span class="c">!        END IF</span>
<a name="ln-1398"></a><span class="c">!        EvapTemp=0.5d0*(EvapTemp1+EvapTemp2)</span>
<a name="ln-1399"></a><span class="c">!        EvapSatEnth1=PsyHFnTdbRhPb(EvapTemp,1.0,PB)</span>
<a name="ln-1400"></a><span class="c">!        IF(ABS((EvapSatEnth-EvapSatEnth1)/EvapSatEnth).LT.ERR1) THEN</span>
<a name="ln-1401"></a><span class="c">!         EXIT LOOP2</span>
<a name="ln-1402"></a><span class="c">!        END IF</span>
<a name="ln-1403"></a><span class="c">!        IF(EvapSatEnth1.LT.EvapSatEnth) THEN</span>
<a name="ln-1404"></a><span class="c">!         EvapTemp1=EvapTemp</span>
<a name="ln-1405"></a><span class="c">!        ELSE</span>
<a name="ln-1406"></a><span class="c">!         EvapTemp2=EvapTemp</span>
<a name="ln-1407"></a><span class="c">!        END IF</span>
<a name="ln-1408"></a><span class="c">!      END DO LOOP2</span>
<a name="ln-1409"></a>
<a name="ln-1410"></a>      <span class="n">EvapTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapSatEnth</span><span class="p">,</span><span class="n">PB</span><span class="p">)</span>
<a name="ln-1411"></a>
<a name="ln-1412"></a>      <span class="c">! Load Side Saturated Temperature (Evaporating Temp in this case)</span>
<a name="ln-1413"></a>      <span class="n">LoadSideTemp</span><span class="o">=</span><span class="n">EvapTemp</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>      <span class="c">! Determine the Load Side and Source Side Saturated Temp (evaporating and condensing pressures)</span>
<a name="ln-1416"></a>      <span class="n">SourceSidePressure</span> <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span><span class="n">SourceSideTemp</span><span class="p">,</span><span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:SourceSideTemp&#39;</span><span class="p">)</span>
<a name="ln-1417"></a>      <span class="n">LoadSidePressure</span> <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span><span class="n">LoadSideTemp</span><span class="p">,</span><span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:LoadSideTemp&#39;</span><span class="p">)</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">LoadSidePressure</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1420"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1421"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;WaterToAir Heat pump:cooling [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1422"></a>                 <span class="s1">&#39;] shut off on low pressure &lt; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowPressCutoff</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1423"></a>                 <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LowPressClgError</span><span class="p">,</span><span class="n">LoadSidePressure</span><span class="p">,</span><span class="n">LoadSidePressure</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1424"></a>                 <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[Pa]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[Pa]&#39;</span><span class="p">)</span>
<a name="ln-1425"></a>          <span class="n">ENDIF</span>
<a name="ln-1426"></a>          <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1427"></a>          <span class="k">RETURN</span>
<a name="ln-1428"></a><span class="k">      END IF</span>
<a name="ln-1429"></a>
<a name="ln-1430"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SourceSidePressure</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1431"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1432"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;WaterToAir Heat pump:cooling [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1433"></a>                 <span class="s1">&#39;] shut off on high pressure &gt; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighPressCutOff</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1434"></a>                 <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HighPressClgError</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1435"></a>                 <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;SourceSideInletTemp[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;SourceSideInletTemp[C]&#39;</span><span class="p">)</span>
<a name="ln-1436"></a>          <span class="n">ENDIF</span>
<a name="ln-1437"></a>          <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1438"></a>         <span class="k">RETURN</span>
<a name="ln-1439"></a><span class="k">      END IF</span>
<a name="ln-1440"></a>
<a name="ln-1441"></a>      <span class="c">! Determine Suction Pressure &amp; Discharge Pressure at Compressor Exit</span>
<a name="ln-1442"></a>      <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">CompressorType</span><span class="p">)</span>
<a name="ln-1443"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Reciprocating</span><span class="p">)</span> <span class="c">! RECIPROCATING</span>
<a name="ln-1444"></a>          <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span> <span class="o">-</span> <span class="n">PressureDrop</span>
<a name="ln-1445"></a>          <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span> <span class="o">+</span> <span class="n">PressureDrop</span>
<a name="ln-1446"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Rotary</span><span class="p">)</span> <span class="c">! ROTARY</span>
<a name="ln-1447"></a>          <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span>
<a name="ln-1448"></a>          <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span> <span class="o">+</span> <span class="n">PressureDrop</span>
<a name="ln-1449"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Scroll</span><span class="p">)</span> <span class="c">! SCROLL</span>
<a name="ln-1450"></a>          <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span>
<a name="ln-1451"></a>          <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span>
<a name="ln-1452"></a>      <span class="k">END SELECT</span>
<a name="ln-1453"></a>
<a name="ln-1454"></a>      <span class="c">! Determine the Load Side Outlet Enthalpy (Saturated Gas)</span>
<a name="ln-1455"></a>      <span class="n">Quality</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1456"></a>      <span class="n">LoadSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">LoadSideTemp</span><span class="p">,</span> <span class="n">Quality</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1457"></a>         <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:LoadSideTemp&#39;</span><span class="p">)</span>
<a name="ln-1458"></a>
<a name="ln-1459"></a>      <span class="c">! Determine Source Side Outlet Enthalpy (Saturated Liquid)</span>
<a name="ln-1460"></a>      <span class="n">Quality</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1461"></a>      <span class="n">SourceSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">SourceSideTemp</span><span class="p">,</span> <span class="n">Quality</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1462"></a>         <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:SourceSideTemp&#39;</span><span class="p">)</span>
<a name="ln-1463"></a>      <span class="c">! Determine Superheated Temperature of the Load Side outlet/compressor Inlet</span>
<a name="ln-1464"></a>      <span class="n">CompressInletTemp</span> <span class="o">=</span> <span class="n">LoadSideTemp</span> <span class="o">+</span> <span class="n">ShTemp</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>      <span class="c">! Determine the Enthalpy of the Superheated Fluid at Load Side Outlet/Compressor Inlet</span>
<a name="ln-1467"></a>      <span class="n">SuperHeatEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompressInletTemp</span><span class="p">,</span> <span class="n">LoadSidePressure</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1468"></a>         <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:CompressInletTemp&#39;</span><span class="p">)</span>
<a name="ln-1469"></a>
<a name="ln-1470"></a>      <span class="c">! Determining the suction state of the fluid from inlet state involves interation</span>
<a name="ln-1471"></a>      <span class="c">! Method employed...</span>
<a name="ln-1472"></a>      <span class="c">! Determine the saturated temp at suction pressure, shoot out into the superheated region find the enthalpy</span>
<a name="ln-1473"></a>      <span class="c">! check that with the inlet enthalpy ( as suction loss is isenthalpic). Iterate till desired accuracy is reached</span>
<a name="ln-1474"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Converged</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1475"></a><span class="k">      </span><span class="n">CompSuctionSatTemp</span> <span class="o">=</span> <span class="n">GetSatTemperatureRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1476"></a>         <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:SuctionPr&#39;</span><span class="p">)</span>
<a name="ln-1477"></a>      <span class="n">CompSuctionTemp1</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span>
<a name="ln-1478"></a>
<a name="ln-1479"></a>      <span class="c">! Shoot into the Superheated Region</span>
<a name="ln-1480"></a>      <span class="n">CompSuctionTemp2</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span> <span class="o">+</span> <span class="n">DegreeofSuperheat</span>
<a name="ln-1481"></a>    <span class="k">END IF</span>
<a name="ln-1482"></a>      <span class="c">! Iterate to find the Suction State</span>
<a name="ln-1483"></a><span class="c">!      NumIteration1=0</span>
<a name="ln-1484"></a><span class="c">!</span>
<a name="ln-1485"></a><span class="c">!       LOOP: DO</span>
<a name="ln-1486"></a><span class="c">!</span>
<a name="ln-1487"></a><span class="c">!           NumIteration1=NumIteration1+1</span>
<a name="ln-1488"></a><span class="c">!</span>
<a name="ln-1489"></a><span class="c">!           IF (NumIteration1.GT.STOP1) THEN</span>
<a name="ln-1490"></a><span class="c">!             WatertoAirHP(HPNum)%SimFlag = .FALSE.</span>
<a name="ln-1491"></a><span class="c">!             RETURN</span>
<a name="ln-1492"></a><span class="c">!           END IF</span>
<a name="ln-1493"></a><span class="c">!</span>
<a name="ln-1494"></a><span class="c">!               CompSuctionTemp = 0.5d0 * ( CompSuctionTemp1 + CompSuctionTemp2 )</span>
<a name="ln-1495"></a><span class="c">!               CompSuctionEnth = GetSupHeatEnthalpyRefrig(Refrigerant, CompSuctionTemp, SuctionPr, RefrigIndex)</span>
<a name="ln-1496"></a><span class="c">!               CompSuctionDensity = GetSupHeatDensityRefrig(Refrigerant, CompSuctionTemp, SuctionPr, RefrigIndex)</span>
<a name="ln-1497"></a><span class="c">!</span>
<a name="ln-1498"></a><span class="c">!               IF (ABS(CompsuctionEnth-SuperHeatEnth)/SuperHeatEnth &lt; ERR)  THEN</span>
<a name="ln-1499"></a><span class="c">!                   EXIT LOOP</span>
<a name="ln-1500"></a><span class="c">!               END IF</span>
<a name="ln-1501"></a><span class="c">!</span>
<a name="ln-1502"></a><span class="c">!               IF ( CompsuctionEnth &lt; SuperHeatEnth ) THEN</span>
<a name="ln-1503"></a><span class="c">!                   CompSuctionTemp1 = CompSuctionTemp</span>
<a name="ln-1504"></a><span class="c">!               ELSE</span>
<a name="ln-1505"></a><span class="c">!                   CompSuctionTemp2 = CompSuctionTemp</span>
<a name="ln-1506"></a><span class="c">!               END IF</span>
<a name="ln-1507"></a><span class="c">!        END DO LOOP</span>
<a name="ln-1508"></a>
<a name="ln-1509"></a><span class="c">!  Do not need the name of the refrigerant if we already have the index (from above CALLs)</span>
<a name="ln-1510"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SuctionPr</span>
<a name="ln-1511"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">RefrigIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1512"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SuperHeatEnth</span>
<a name="ln-1513"></a>
<a name="ln-1514"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ERR</span><span class="p">,</span> <span class="n">STOP1</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">CalcCompSuctionTempResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1515"></a>                            <span class="n">CompSuctionTemp1</span><span class="p">,</span> <span class="n">CompSuctionTemp2</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-1516"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1517"></a><span class="k">        </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1518"></a>        <span class="k">RETURN</span>
<a name="ln-1519"></a><span class="k">      END IF</span>
<a name="ln-1520"></a><span class="k">      </span><span class="n">CompSuctionEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1521"></a>         <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-1522"></a>      <span class="n">CompSuctionDensity</span> <span class="o">=</span> <span class="n">GetSupHeatDensityRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1523"></a>         <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPCooling:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-1524"></a>
<a name="ln-1525"></a>      <span class="c">! Find Refrigerant Flow Rate</span>
<a name="ln-1526"></a>      <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">CompressorType</span><span class="p">)</span>
<a name="ln-1527"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Reciprocating</span><span class="p">)</span> <span class="c">! RECIPROCATING</span>
<a name="ln-1528"></a>          <span class="n">MassRef</span> <span class="o">=</span> <span class="n">PistonDisp</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1529"></a>                <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">ClearanceFactor</span><span class="o">-</span><span class="n">ClearanceFactor</span><span class="o">*</span><span class="p">((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)))</span>
<a name="ln-1530"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Rotary</span><span class="p">)</span> <span class="c">! ROTARY</span>
<a name="ln-1531"></a>          <span class="n">MassRef</span> <span class="o">=</span> <span class="n">PistonDisp</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span>
<a name="ln-1532"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Scroll</span><span class="p">)</span> <span class="c">! SCROLL</span>
<a name="ln-1533"></a>          <span class="n">MassRef</span> <span class="o">=</span> <span class="n">RefVolFlowRate</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span> <span class="o">-</span> <span class="n">LeakRateCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span>
<a name="ln-1534"></a>      <span class="k">END SELECT</span>
<a name="ln-1535"></a>
<a name="ln-1536"></a>      <span class="c">! Find the Load Side Heat Transfer</span>
<a name="ln-1537"></a>      <span class="n">QloadTotal</span> <span class="o">=</span> <span class="n">MassRef</span> <span class="o">*</span> <span class="p">(</span> <span class="n">LoadSideOutletEnth</span> <span class="o">-</span> <span class="n">SourceSideOutletEnth</span> <span class="p">)</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QloadTotal</span> <span class="o">-</span> <span class="n">initialQloadTotal</span><span class="p">)</span><span class="o">/</span><span class="n">initialQloadTotal</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ERR</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1540"></a><span class="k">          EXIT </span><span class="n">LOOPLoadEnth</span>
<a name="ln-1541"></a>      <span class="k">ELSE</span>
<a name="ln-1542"></a><span class="k">          </span><span class="n">initialQLoadTotal</span> <span class="o">=</span> <span class="n">initialQLoadTotal</span><span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QloadTotal</span><span class="o">-</span><span class="n">initialQLoadTotal</span><span class="p">)</span>
<a name="ln-1543"></a>      <span class="k">END IF</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a>
<a name="ln-1546"></a><span class="k">    END DO </span><span class="n">LOOPLoadEnth</span>
<a name="ln-1547"></a>
<a name="ln-1548"></a>    <span class="c">! Determine the Power Consumption</span>
<a name="ln-1549"></a>      <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">CompressorType</span><span class="p">)</span>
<a name="ln-1550"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Reciprocating</span><span class="p">)</span> <span class="c">! RECIPROCATING</span>
<a name="ln-1551"></a>          <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLos</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">LosFac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MassRef</span><span class="o">*</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1552"></a>                <span class="n">SuctionPr</span> <span class="o">/</span><span class="n">CompSuctionDensity</span>  <span class="p">&amp;</span>
<a name="ln-1553"></a>                <span class="o">*</span><span class="p">(((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">/</span><span class="nb">gamma</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-1554"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Rotary</span><span class="p">)</span> <span class="c">! ROTARY</span>
<a name="ln-1555"></a>          <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLos</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">LosFac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MassRef</span><span class="o">*</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1556"></a>                <span class="n">SuctionPr</span> <span class="o">/</span><span class="n">CompSuctionDensity</span>  <span class="p">&amp;</span>
<a name="ln-1557"></a>                <span class="o">*</span><span class="p">(((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">/</span><span class="nb">gamma</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-1558"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Scroll</span><span class="p">)</span> <span class="c">! SCROLL</span>
<a name="ln-1559"></a>          <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLos</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">LosFac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="o">*</span> <span class="n">SuctionPr</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1560"></a>                  <span class="n">RefVolFlowRate</span> <span class="o">*</span> <span class="p">(((</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1561"></a>                 <span class="p">((</span><span class="n">DischargePr</span> <span class="o">/</span> <span class="n">SuctionPr</span><span class="p">)</span> <span class="o">/</span> <span class="n">VolumeRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1562"></a>                 <span class="n">VolumeRatio</span> <span class="o">**</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1563"></a>      <span class="k">END SELECT</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a>    <span class="c">! Determine the Sourceside Heat Rate</span>
<a name="ln-1566"></a>    <span class="n">QSource</span> <span class="o">=</span> <span class="n">Power</span> <span class="o">+</span> <span class="n">QLoadTotal</span>
<a name="ln-1567"></a>
<a name="ln-1568"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QSource</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="p">)</span><span class="o">/</span><span class="n">initialQSource</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ERR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1569"></a><span class="k">      </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1570"></a>    <span class="k">ELSE</span>
<a name="ln-1571"></a><span class="k">      </span><span class="n">initialQSource</span><span class="o">=</span> <span class="n">initialQSource</span><span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QSource</span><span class="o">-</span><span class="n">initialQSource</span><span class="p">)</span>
<a name="ln-1572"></a>    <span class="k">END IF</span>
<a name="ln-1573"></a>
<a name="ln-1574"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FinalSimFlag</span><span class="p">)</span>  <span class="k">EXIT </span><span class="n">LOOPSourceEnth</span>
<a name="ln-1575"></a>
<a name="ln-1576"></a>  <span class="k">END DO </span><span class="n">LOOPSourceEnth</span>
<a name="ln-1577"></a>
<a name="ln-1578"></a>
<a name="ln-1579"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SuctionPr</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1580"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Heat pump:cooling shut down on low pressure&#39;</span><span class="p">)</span>
<a name="ln-1581"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1582"></a>  <span class="k">END IF</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DischargePr</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1585"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Heat pump:cooling shut down on high pressure&#39;</span><span class="p">)</span>
<a name="ln-1586"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1587"></a>  <span class="k">END IF</span>
<a name="ln-1588"></a>
<a name="ln-1589"></a>
<a name="ln-1590"></a><span class="k">  IF</span><span class="p">(</span><span class="n">QSensible</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">QLoadTotal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1591"></a><span class="k">     </span><span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-1592"></a>  <span class="k">END IF</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a><span class="k">  IF</span><span class="p">(</span><span class="n">LatDegradModelSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1595"></a><span class="k">    IF</span><span class="p">(</span><span class="n">NumIteration4</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1596"></a><span class="k">    </span><span class="n">QLatRated</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">QSensible</span>
<a name="ln-1597"></a>
<a name="ln-1598"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">NumIteration4</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1599"></a><span class="k">    </span><span class="n">QLatActual</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">QSensible</span>
<a name="ln-1600"></a>    <span class="n">SHRss</span><span class="o">=</span><span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-1601"></a>    <span class="n">LoadSideInletWBTemp</span><span class="o">=</span><span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">PB</span><span class="p">)</span>
<a name="ln-1602"></a>    <span class="n">SHReff</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span> <span class="n">SHRss</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1603"></a>                          <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">LoadSideInletDBTemp</span><span class="p">,</span> <span class="n">LoadSideInletWBTemp</span><span class="p">)</span>
<a name="ln-1604"></a><span class="c">!   Update sensible capacity based on effective SHR</span>
<a name="ln-1605"></a>    <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">SHReff</span>
<a name="ln-1606"></a>    <span class="k">EXIT </span><span class="n">LOOPLatentDegradationModel</span>
<a name="ln-1607"></a>    <span class="k">END IF</span>
<a name="ln-1608"></a><span class="k">  ELSE</span>
<a name="ln-1609"></a>
<a name="ln-1610"></a><span class="k">    </span><span class="n">SHReff</span> <span class="o">=</span> <span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-1611"></a>    <span class="k">EXIT </span><span class="n">LOOPLatentDegradationModel</span>
<a name="ln-1612"></a>  <span class="k">END IF</span>
<a name="ln-1613"></a><span class="k">  END DO </span><span class="n">LOOPLatentDegradationModel</span>
<a name="ln-1614"></a>
<a name="ln-1615"></a>   <span class="c">!calculate coil outlet state variables</span>
<a name="ln-1616"></a>   <span class="n">LoadSideAirOutletEnth</span><span class="o">=</span> <span class="n">LoadSideAirInletEnth</span> <span class="o">-</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-1617"></a>   <span class="n">LoadSideOutletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">-</span> <span class="n">QSensible</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span><span class="p">)</span>
<a name="ln-1618"></a>   <span class="n">LoadsideOutletHumRat</span> <span class="o">=</span>  <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">LoadSideAirOutletEnth</span><span class="p">)</span>
<a name="ln-1619"></a>   <span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span><span class="p">)</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>    <span class="c">! Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-1622"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1623"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-1624"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadSideAirOutletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1625"></a>                                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideAirInletEnth</span>
<a name="ln-1626"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span><span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadsideOutletHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1627"></a>                                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletHumRat</span>
<a name="ln-1628"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-1629"></a>  <span class="k">ELSE</span>
<a name="ln-1630"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-1631"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LoadSideAirOutletEnth</span>
<a name="ln-1632"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">LoadsideOutletHumRat</span>
<a name="ln-1633"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span> <span class="o">=</span> <span class="n">LoadSideOutletDBTemp</span>
<a name="ln-1634"></a>  <span class="k">END IF</span>
<a name="ln-1635"></a>
<a name="ln-1636"></a>   <span class="c">!scale heat transfer rates and power to run time</span>
<a name="ln-1637"></a>   <span class="n">QLoadTotal</span><span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-1638"></a>   <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QSensible</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-1639"></a>   <span class="n">Power</span> <span class="o">=</span> <span class="n">Power</span><span class="o">*</span><span class="n">RuntimeFrac</span>
<a name="ln-1640"></a>   <span class="n">QSource</span> <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-1641"></a>
<a name="ln-1642"></a> <span class="c">!Update heat pump data structure</span>
<a name="ln-1643"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="n">Power</span>
<a name="ln-1644"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="n">QLoadTotal</span>
<a name="ln-1645"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="n">QSensible</span>
<a name="ln-1646"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">QSensible</span>
<a name="ln-1647"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="n">QSource</span>
<a name="ln-1648"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-1649"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a><span class="c">!  Air-side outlet conditions are already calculated above</span>
<a name="ln-1652"></a><span class="c">!  WatertoAirHP(HPNum)%OutletAirDBTemp=LoadSideOutletDBTemp</span>
<a name="ln-1653"></a><span class="c">!  WatertoAirHP(HPNum)%OutletAirHumRat=LoadsideOutletHumRat</span>
<a name="ln-1654"></a><span class="c">!  WatertoAirHP(HPNum)%OutletAirEnthalpy = LoadSideAirOutletEnth</span>
<a name="ln-1655"></a>
<a name="ln-1656"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span><span class="o">=</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-1657"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="n">SourceSideOutletTemp</span>
<a name="ln-1658"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="o">=</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-1659"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SourceSideWaterInletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1660"></a>        <span class="n">QSource</span><span class="o">/</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-1661"></a>
<a name="ln-1662"></a>  <span class="k">RETURN</span>
<a name="ln-1663"></a><span class="k">  END SUBROUTINE </span><span class="n">CalcWatertoAirHPCooling</span>
<a name="ln-1664"></a>
<a name="ln-1665"></a><span class="k">FUNCTION </span><span class="n">CalcCompSuctionTempResidual</span><span class="p">(</span><span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-1666"></a>
<a name="ln-1667"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1668"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-1669"></a>          <span class="c">!       DATE WRITTEN   October 2006</span>
<a name="ln-1670"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1671"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1672"></a>
<a name="ln-1673"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1674"></a>          <span class="c">! To calculate the compressor suction temperature for water to air HP&#39;s</span>
<a name="ln-1675"></a>
<a name="ln-1676"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1677"></a>          <span class="c">! Use SolveRegulaFalsi to call this Function to converge on a solution</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1680"></a>          <span class="c">! na</span>
<a name="ln-1681"></a>
<a name="ln-1682"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1683"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">,</span> <span class="n">GetSupHeatDensityRefrig</span>
<a name="ln-1684"></a>
<a name="ln-1685"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                             <span class="kd">::</span> <span class="n">CompSuctionTemp</span>  <span class="c">! HP compressor suction temperature (C)</span>
<a name="ln-1689"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span>     <span class="kd">::</span> <span class="n">Par</span>              <span class="c">! Function parameters</span>
<a name="ln-1690"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                    <span class="kd">::</span> <span class="n">Residuum</span>         <span class="c">! Result (force to 0)</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1693"></a>          <span class="c">! na</span>
<a name="ln-1694"></a>
<a name="ln-1695"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1696"></a>          <span class="c">! na</span>
<a name="ln-1697"></a>
<a name="ln-1698"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1699"></a>          <span class="c">! na</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1702"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Refrigerant</span>           <span class="c">! Name of refrigerant</span>
<a name="ln-1703"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SuctionPR</span>
<a name="ln-1704"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">RefrigIndex</span>
<a name="ln-1705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompSuctionEnth</span>
<a name="ln-1706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SuperHeatEnth</span>
<a name="ln-1707"></a>
<a name="ln-1708"></a><span class="c">! Convert parameters to usable variables</span>
<a name="ln-1709"></a>  <span class="n">Refrigerant</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1710"></a>  <span class="n">SuctionPr</span>    <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1711"></a>  <span class="n">RefrigIndex</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1712"></a>  <span class="n">SuperHeatEnth</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1713"></a>
<a name="ln-1714"></a>  <span class="n">CompSuctionEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1715"></a>          <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWaterToAirHPHeating:CalcCompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a><span class="c">! Calculate residual based on output calculation flag</span>
<a name="ln-1718"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">CompsuctionEnth</span><span class="o">-</span><span class="n">SuperHeatEnth</span><span class="p">)</span><span class="o">/</span><span class="n">SuperHeatEnth</span>
<a name="ln-1719"></a>
<a name="ln-1720"></a><span class="k">RETURN</span>
<a name="ln-1721"></a><span class="k">END FUNCTION </span><span class="n">CalcCompSuctionTempResidual</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a><span class="k">SUBROUTINE </span><span class="n">CalcWatertoAirHPHeating</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">InitFlag</span><span class="p">,</span> <span class="n">SensDemand</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-1724"></a>
<a name="ln-1725"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1726"></a>          <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-1727"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-1728"></a>          <span class="c">!       MODIFIED       R. Raustad (Oct 2006) Revised iteration technique</span>
<a name="ln-1729"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1730"></a>
<a name="ln-1731"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1732"></a>          <span class="c">! Simulates a parameter estimation based water to air heat pump model</span>
<a name="ln-1733"></a>
<a name="ln-1734"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1735"></a>          <span class="c">! na</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a>  <span class="k">USE </span><span class="n">FluidProperties</span>
<a name="ln-1738"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span><span class="n">PsyCpAirFnWTdb</span><span class="p">,</span><span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyWFnTdbH</span> <span class="c">!,PsyHFnTdbRhPb,PsyWFnTdpPb</span>
<a name="ln-1739"></a><span class="c">!  USE DataZoneEnergyDemands</span>
<a name="ln-1740"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-1741"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-1742"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-1743"></a>
<a name="ln-1744"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1745"></a>
<a name="ln-1746"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1747"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>                 <span class="c">!heat pump number</span>
<a name="ln-1748"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-1749"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensDemand</span>
<a name="ln-1750"></a>   <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CyclingScheme</span>         <span class="c">!fan/compressor cycling scheme indicator</span>
<a name="ln-1751"></a>   <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>    <span class="c">!first iteration flag</span>
<a name="ln-1752"></a>   <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InitFlag</span>              <span class="c">!first iteration flag</span>
<a name="ln-1753"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-1754"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1757"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">CpWater</span><span class="o">=</span><span class="mi">421</span><span class="mf">0.d0</span>             <span class="c">! Specific heat of water J/kg_C</span>
<a name="ln-1758"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">DegreeofSuperheat</span><span class="o">=</span><span class="mi">8</span><span class="mf">0.d0</span>    <span class="c">! Initial guess of degree of superheat</span>
<a name="ln-1759"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="nb">gamma</span><span class="o">=</span> <span class="mf">1.114d0</span>             <span class="c">! Expnasion Coefficient</span>
<a name="ln-1760"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">RelaxParam</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="n">d0</span>          <span class="c">! Relaxation Parameter</span>
<a name="ln-1761"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">ERR</span><span class="o">=</span><span class="mf">0.01d0</span>                 <span class="c">! Error Value</span>
<a name="ln-1762"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">ERR1</span><span class="o">=</span><span class="mf">0.01d0</span>                <span class="c">! Error Value</span>
<a name="ln-1763"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">PB</span><span class="o">=</span><span class="mf">1.013d5</span>               <span class="c">! Barometric Pressure (Pa)</span>
<a name="ln-1764"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">STOP1</span><span class="o">=</span><span class="mi">10000</span>              <span class="c">! Iteration stopper1</span>
<a name="ln-1765"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">STOP2</span><span class="o">=</span><span class="mi">100000</span>             <span class="c">! Iteration stopper2</span>
<a name="ln-1766"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">STOP3</span><span class="o">=</span><span class="mi">100000</span>             <span class="c">! Iteration stopper3</span>
<a name="ln-1767"></a>
<a name="ln-1768"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1769"></a>          <span class="c">! na</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1772"></a>          <span class="c">! na</span>
<a name="ln-1773"></a>
<a name="ln-1774"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1775"></a><span class="c">!      INTEGER                :: NumIteration1            ! Number of Iteration1</span>
<a name="ln-1776"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumIteration2</span>            <span class="c">! Number of Iteration2</span>
<a name="ln-1777"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumIteration3</span>            <span class="c">! Number of Iteration3</span>
<a name="ln-1778"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideFluidIndex</span>     <span class="c">! Source Side Fluid Index</span>
<a name="ln-1779"></a>
<a name="ln-1780"></a>      <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompressorType</span>           <span class="c">! Type of Compressor ie. Reciprocating,Rotary or Scroll</span>
<a name="ln-1781"></a>      <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideFluidName</span>   <span class="c">! Name of source side fluid</span>
<a name="ln-1782"></a>      <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Refrigerant</span>           <span class="c">! Name of refrigerant</span>
<a name="ln-1783"></a><span class="c">!      CHARACTER(len=25) :: CErrCount</span>
<a name="ln-1784"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">NominalHeatingCapacity</span>   <span class="c">! Nominal Heating Capacity(W)</span>
<a name="ln-1785"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideUA</span>               <span class="c">! Load Side Heat Transfer coefficient [W/C]</span>
<a name="ln-1786"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideUA</span>             <span class="c">! Source Side Heat Transfer coefficient [W/C]</span>
<a name="ln-1787"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PressureDrop</span>             <span class="c">! Suction or Discharge Pressure Drop [Pa]</span>
<a name="ln-1788"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ClearanceFactor</span>          <span class="c">! Compressor Clearance Factor</span>
<a name="ln-1789"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PistonDisp</span>               <span class="c">! Compressor Piston Displacement [m3/s]</span>
<a name="ln-1790"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ShTemp</span>                   <span class="c">! Superheat Temperature [C]</span>
<a name="ln-1791"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LosFac</span>                   <span class="c">! Compressor Power Loss Factor</span>
<a name="ln-1792"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PowerLos</span>                 <span class="c">! Constant Part of Power Losses [kW]</span>
<a name="ln-1793"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">RefVolFlowRate</span>           <span class="c">! Refrigerant Volume Flow rate at the beginning</span>
<a name="ln-1794"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">VolumeRatio</span>              <span class="c">! Built-in-volume ratio [~]</span>
<a name="ln-1795"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LeakRateCoeff</span>            <span class="c">! Coefficient for the relationship between</span>
<a name="ln-1796"></a>                                                         <span class="c">! Pressure Ratio and Leakage Rate [~]</span>
<a name="ln-1797"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideHTRes1</span>         <span class="c">! Source Side Heat Transfer Resistance coefficient 1 [~]</span>
<a name="ln-1798"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideHTRes2</span>         <span class="c">! Source Side Heat Transfer Resistance coefficient 2 [K/kW]</span>
<a name="ln-1799"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">HighPressCutOff</span>          <span class="c">! High Pressure Cut-off [Pa]</span>
<a name="ln-1800"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LowPressCutOff</span>           <span class="c">! Low Pressure Cut-off [Pa]</span>
<a name="ln-1801"></a>
<a name="ln-1802"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Quality</span>
<a name="ln-1803"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span>   <span class="c">! Source Side Mass Flow Rate [kg/s]</span>
<a name="ln-1804"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>      <span class="c">! Source Side Inlet Temperature [C]</span>
<a name="ln-1805"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideWaterInletEnth</span> <span class="c">! Source Side Inlet Water Enthalpy [J/kg]</span>
<a name="ln-1806"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideoutletTemp</span>     <span class="c">! Source Side Outlet Temperature [C]</span>
<a name="ln-1807"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideVolFlowRate</span>    <span class="c">! Source Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-1808"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpFluid</span>                  <span class="c">! Specific heat of source side fluid(J/kg)</span>
<a name="ln-1809"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>     <span class="c">! Load Side Mass Flow Rate [kg/s]</span>
<a name="ln-1810"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideInletDBTemp</span>      <span class="c">! Load Side Inlet Dry Bulb Temp [C]</span>
<a name="ln-1811"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideInletHumRat</span>      <span class="c">! Load Side Inlet Humidity Ratio [kg/kg]</span>
<a name="ln-1812"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideoutletDBTemp</span>     <span class="c">! Load Side Outlet Dry Bulb Temperature [C]</span>
<a name="ln-1813"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadsideOutletHumRat</span>     <span class="c">! Load Side Outlet Humidity Ratio [kg/kg]</span>
<a name="ln-1814"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideAirInletEnth</span>     <span class="c">! Load Side Inlet Enthalpy [J/kg]</span>
<a name="ln-1815"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideAirOutletEnth</span>    <span class="c">! Load Side Outlet Enthalpy [J/kg]</span>
<a name="ln-1816"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpAir</span>                    <span class="c">! Specific Heat of Air [J/kg_C]</span>
<a name="ln-1817"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DegradFactor</span>             <span class="c">! Degradation Factor [~]</span>
<a name="ln-1818"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">QSource</span>                  <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-1819"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">QLoadTotal</span>               <span class="c">! Load Side Heat Transfer Rate [W]</span>
<a name="ln-1820"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Power</span>                    <span class="c">! Power Consumption [W]</span>
<a name="ln-1821"></a>
<a name="ln-1822"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideEffect</span>         <span class="c">! Source Side Heat Exchanger Effectiveness</span>
<a name="ln-1823"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideEffect</span>           <span class="c">! Load Side Effectiveness based on Outside Heat Transfer Coefficient</span>
<a name="ln-1824"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideTemp</span>           <span class="c">! Source Side Saturated Refrigerant Temperature [C]</span>
<a name="ln-1825"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideTemp</span>             <span class="c">! Load Side Saturated Refrigerant Temperature [C]</span>
<a name="ln-1826"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSidePressure</span>       <span class="c">! Source Side Saturated Refrigerant Pressure [Pa]</span>
<a name="ln-1827"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSidePressure</span>         <span class="c">! Load Side Saturated Refrigerant Pressure [Pa]</span>
<a name="ln-1828"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SuctionPr</span>                <span class="c">! Compressor Suction Pressure [Pa]</span>
<a name="ln-1829"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DischargePr</span>              <span class="c">! Compressor Discharge Pressure [Pa]</span>
<a name="ln-1830"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompressInletTemp</span>        <span class="c">! Temperature of the Refrigerant Entering the Compressor [C]</span>
<a name="ln-1831"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">MassRef</span>                  <span class="c">! Mass Flow Rate of Refrigerant [kg/s]</span>
<a name="ln-1832"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideOutletEnth</span>     <span class="c">! Enthalpy of Refrigerant leaving the Source Side Heat Exchanger [J/kg]</span>
<a name="ln-1833"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideOutletEnth</span>       <span class="c">! Enthalpy of Refrigerant leaving the Load Side Heat Exchanger [J/kg]</span>
<a name="ln-1834"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>              <span class="kd">::</span> <span class="n">initialQSource</span>           <span class="c">! Guess Source Side Heat Transfer Rate [W]</span>
<a name="ln-1835"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>              <span class="kd">::</span> <span class="n">initialQLoad</span>             <span class="c">! Guess Load Side Heat Transfer rate [W]</span>
<a name="ln-1836"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SuperHeatEnth</span>            <span class="c">! Enthalpy of the Superheated Refrigerant [J/kg]</span>
<a name="ln-1837"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionTemp1</span>         <span class="c">! Guess of the Temperature of the Refrigerant Entering the</span>
<a name="ln-1838"></a>                                                         <span class="c">! Compressor #1 [C]</span>
<a name="ln-1839"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionTemp2</span>         <span class="c">! Guess of the Temperature of the Refrigerant Entering the</span>
<a name="ln-1840"></a>                                                         <span class="c">! Compressor #2 [C]</span>
<a name="ln-1841"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionTemp</span>          <span class="c">! Temperature of the Refrigerant Entering the Compressor [C]</span>
<a name="ln-1842"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionEnth</span>          <span class="c">! Enthalpy of the Refrigerant Entering the Compressor [J/kg]</span>
<a name="ln-1843"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionDensity</span>       <span class="c">! Density of the Refrigerant Entering the Compressorkg/m3</span>
<a name="ln-1844"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionSatTemp</span>       <span class="c">! Temperature of Saturated Refrigerant at Compressor Suction Pressure [C]</span>
<a name="ln-1845"></a>      <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">FinalSimFlag</span>             <span class="c">! Final Simulation Flag</span>
<a name="ln-1846"></a>      <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">Converged</span>                <span class="c">! Overall convergence Flag</span>
<a name="ln-1847"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                   <span class="c">! Parameter array passed to RegulaFalsi function</span>
<a name="ln-1848"></a>      <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SolFlag</span>                  <span class="c">! Solution flag returned from RegulaFalsi function</span>
<a name="ln-1849"></a>
<a name="ln-1850"></a>
<a name="ln-1851"></a> <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-1852"></a>
<a name="ln-1853"></a>    <span class="n">NominalHeatingCapacity</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatingCapacity</span>
<a name="ln-1854"></a>    <span class="n">CompressorType</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompressorType</span>
<a name="ln-1855"></a>    <span class="n">Refrigerant</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Refrigerant</span>
<a name="ln-1856"></a>
<a name="ln-1857"></a>    <span class="n">LoadSideUA</span>        <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoadSideTotalUACoeff</span>
<a name="ln-1858"></a>    <span class="n">PistonDisp</span>        <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span>
<a name="ln-1859"></a>    <span class="n">ClearanceFactor</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span>
<a name="ln-1860"></a>    <span class="n">PressureDrop</span>      <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span>
<a name="ln-1861"></a>    <span class="n">ShTemp</span>            <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span>
<a name="ln-1862"></a>    <span class="n">PowerLos</span>          <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PowerLosses</span>
<a name="ln-1863"></a>    <span class="n">LosFac</span>            <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LossFactor</span>
<a name="ln-1864"></a>    <span class="n">RefVolFlowRate</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RefVolFlowRate</span>
<a name="ln-1865"></a>    <span class="n">VolumeRatio</span>       <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">VolumeRatio</span>
<a name="ln-1866"></a>    <span class="n">LeakRateCoeff</span>     <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LeakRateCoeff</span>
<a name="ln-1867"></a>    <span class="n">HighPressCutOff</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>
<a name="ln-1868"></a>    <span class="n">LowPressCutOff</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>
<a name="ln-1869"></a>    <span class="n">SourceSideUA</span>             <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span>
<a name="ln-1870"></a>    <span class="n">SourceSideHTRes1</span>         <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR1</span>
<a name="ln-1871"></a>    <span class="n">SourceSideHTRes2</span>         <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SourceSideHTR2</span>
<a name="ln-1872"></a>
<a name="ln-1873"></a>    <span class="n">LoadSideMassFlowRate</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-1874"></a>    <span class="n">LoadsideInletDBTemp</span>     <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-1875"></a>    <span class="n">LoadsideInletHumRat</span>     <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-1876"></a>    <span class="n">cpair</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">LoadSideInletDBTemp</span><span class="p">)</span>
<a name="ln-1877"></a>
<a name="ln-1878"></a>    <span class="n">SourceSideInletTemp</span>      <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-1879"></a>    <span class="n">SourceSideWaterInletEnth</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-1880"></a>    <span class="n">SourceSideFluidName</span>      <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span>
<a name="ln-1881"></a>    <span class="n">SourceSideFluidIndex</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span>
<a name="ln-1882"></a>    <span class="n">SourceSideMassFlowRate</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-1883"></a>    <span class="n">SourceSideVolFlowRate</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">/</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">SourceSideFluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1884"></a>                                                                             <span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideFluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1885"></a>                                                                            <span class="s1">&#39;CalcWatertoAirHPHeating:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a><span class="c">! Load Side Inlet Air Enthalpy</span>
<a name="ln-1888"></a>    <span class="n">LoadSideAirInletEnth</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a><span class="c">! If heat pump is not operating, return</span>
<a name="ln-1891"></a><span class="k">IF</span> <span class="p">(</span><span class="n">SensDemand</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LoadSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SourceSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1892"></a><span class="k">   </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1893"></a>   <span class="k">RETURN</span>
<a name="ln-1894"></a><span class="k">ELSE</span>
<a name="ln-1895"></a><span class="k">   </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1896"></a><span class="n">ENDIF</span>
<a name="ln-1897"></a>
<a name="ln-1898"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1899"></a><span class="k">   </span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1900"></a>   <span class="k">RETURN</span>
<a name="ln-1901"></a><span class="n">ENDIF</span>
<a name="ln-1902"></a>
<a name="ln-1903"></a><span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1904"></a><span class="k">  </span><span class="n">initialQLoad</span> <span class="o">=</span> <span class="n">NominalHeatingCapacity</span>
<a name="ln-1905"></a>  <span class="n">initialQSource</span> <span class="o">=</span> <span class="n">NominalHeatingCapacity</span>
<a name="ln-1906"></a><span class="k">END IF</span>
<a name="ln-1907"></a>
<a name="ln-1908"></a><span class="k">IF</span><span class="p">(</span><span class="n">initialQLoad</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span>  <span class="n">initialQLoad</span> <span class="o">=</span> <span class="n">NominalHeatingCapacity</span>
<a name="ln-1909"></a><span class="k">IF</span><span class="p">(</span><span class="n">initialQSource</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span>  <span class="n">initialQSource</span> <span class="o">=</span> <span class="n">NominalHeatingCapacity</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a> <span class="c">!Outerloop: calculate load side heat transfer</span>
<a name="ln-1912"></a>  <span class="n">NumIteration3</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1913"></a>  <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1914"></a>  <span class="n">FinalSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1915"></a>  <span class="n">LOOPLoadEnth</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-1916"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Converged</span><span class="p">)</span> <span class="n">FinalSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1917"></a>
<a name="ln-1918"></a>    <span class="n">NumIteration3</span><span class="o">=</span><span class="n">NumIteration3</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1919"></a>
<a name="ln-1920"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration3</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">STOP3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1921"></a><span class="k">      </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1922"></a>      <span class="k">RETURN</span>
<a name="ln-1923"></a><span class="k">    END IF</span>
<a name="ln-1924"></a>
<a name="ln-1925"></a>    <span class="c">!Innerloop: calculate load side heat transfer</span>
<a name="ln-1926"></a>    <span class="n">NumIteration2</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1927"></a>    <span class="n">LOOPSourceEnth</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-1928"></a>
<a name="ln-1929"></a><span class="k">       </span><span class="n">NumIteration2</span><span class="o">=</span><span class="n">NumIteration2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1930"></a>
<a name="ln-1931"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration2</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">STOP2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1932"></a><span class="k">         </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1933"></a>         <span class="k">RETURN</span>
<a name="ln-1934"></a><span class="k">       END IF</span>
<a name="ln-1935"></a>
<a name="ln-1936"></a>      <span class="c">! Determine Effectiveness of Source Side</span>
<a name="ln-1937"></a>      <span class="n">CpFluid</span><span class="o">=</span><span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">SourceSideFluidName</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideFluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1938"></a>                                   <span class="s1">&#39;CalcWatertoAirHPHeating:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-1939"></a>
<a name="ln-1940"></a><span class="c">!      IF (SourceSideFluidName==&#39;WATER&#39;) THEN</span>
<a name="ln-1941"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSideFluidIndex</span><span class="o">==</span> <span class="n">WaterIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1942"></a><span class="k">        </span><span class="n">SourceSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">SourceSideUA</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpFluid</span> <span class="o">*</span> <span class="n">SourceSideMassFlowRate</span><span class="p">))</span>  <span class="c">! SourceSideFluidName==&#39;Water&#39;</span>
<a name="ln-1943"></a>      <span class="k">ELSE</span>
<a name="ln-1944"></a><span class="k">        </span><span class="n">DegradFactor</span><span class="o">=</span><span class="n">DegradF</span><span class="p">(</span><span class="n">SourceSideFluidName</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideFluidIndex</span><span class="p">)</span>
<a name="ln-1945"></a>        <span class="n">SourceSideEffect</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">((</span><span class="n">SourceSideHTRes1</span> <span class="o">*</span> <span class="n">SourceSideVolFlowRate</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8d0</span><span class="p">))</span> <span class="o">/</span> <span class="n">DegradFactor</span> <span class="o">+</span> <span class="n">SourceSideHTRes2</span><span class="p">)</span>
<a name="ln-1946"></a>      <span class="k">END IF</span>
<a name="ln-1947"></a>
<a name="ln-1948"></a>       <span class="c">! Determine Load Side Effectiveness</span>
<a name="ln-1949"></a>       <span class="n">LoadSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">LoadSideUA</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpAir</span> <span class="o">*</span> <span class="n">LoadSideMassFlowRate</span><span class="p">))</span>
<a name="ln-1950"></a>
<a name="ln-1951"></a>
<a name="ln-1952"></a>       <span class="c">! Determine Source Side Tempertaure (Evap. Temp for this mode)</span>
<a name="ln-1953"></a>       <span class="n">SourceSideTemp</span> <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideEffect</span> <span class="o">*</span> <span class="n">CpFluid</span> <span class="o">*</span> <span class="n">SourceSideMassFlowRate</span><span class="p">)</span>
<a name="ln-1954"></a>
<a name="ln-1955"></a>       <span class="c">! Determine Load Side Tempertaure (Condensing Temp for this mode)</span>
<a name="ln-1956"></a>       <span class="n">LoadSideTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">+</span> <span class="n">initialQLoad</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideEffect</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="n">LoadSideMassFlowRate</span><span class="p">)</span>
<a name="ln-1957"></a>
<a name="ln-1958"></a>       <span class="c">! Determine the Load Side and Source Side Saturated Temp (evaporating and condensing pressures)</span>
<a name="ln-1959"></a>       <span class="n">SourceSidePressure</span> <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span><span class="n">SourceSideTemp</span><span class="p">,</span><span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:SourceSideTemp&#39;</span><span class="p">)</span>
<a name="ln-1960"></a>       <span class="n">LoadSidePressure</span> <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span><span class="n">LoadSideTemp</span><span class="p">,</span><span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:LoadSideTemp&#39;</span><span class="p">)</span>
<a name="ln-1961"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSidePressure</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1962"></a><span class="k">         IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1963"></a><span class="k">           CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;WaterToAir Heat pump:heating [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1964"></a>                <span class="s1">&#39;] shut off on low pressure &lt; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowPressCutoff</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1965"></a>                <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LowPressHtgError</span><span class="p">,</span><span class="n">SourceSidePressure</span><span class="p">,</span><span class="n">SourceSidePressure</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1966"></a>                 <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[Pa]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[Pa]&#39;</span> <span class="p">)</span>
<a name="ln-1967"></a>         <span class="n">ENDIF</span>
<a name="ln-1968"></a>         <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1969"></a>         <span class="k">RETURN</span>
<a name="ln-1970"></a><span class="k">       END IF</span>
<a name="ln-1971"></a>
<a name="ln-1972"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">LoadSidePressure</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1973"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1974"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;WaterToAir Heat pump:heating [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1975"></a>                 <span class="s1">&#39;] shut off on high pressure &gt; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighPressCutOff</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1976"></a>                 <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HighPressHtgError</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="n">SourceSideInletTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1977"></a>                 <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;SourceSideInletTemp[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;SourceSideInletTemp[C]&#39;</span><span class="p">)</span>
<a name="ln-1978"></a>          <span class="n">ENDIF</span>
<a name="ln-1979"></a><span class="c">!         CALL ShowWarningError(&#39;Heat pump:heating shut off on high pressure&#39;)</span>
<a name="ln-1980"></a><span class="c">!         WRITE(CErrCount,*) SourceSideInletTemp</span>
<a name="ln-1981"></a><span class="c">!         CErrCount=ADJUSTL(CErrCount)</span>
<a name="ln-1982"></a><span class="c">!         CALL ShowContinueError(&#39;Source side inlet temperature too low, T=&#39;//TRIM(CErrCount))</span>
<a name="ln-1983"></a><span class="c">!         CALL ShowContinueError(&#39;Heat pump heating demand not met by plant side&#39;)</span>
<a name="ln-1984"></a>         <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1985"></a>         <span class="k">RETURN</span>
<a name="ln-1986"></a><span class="k">       END IF</span>
<a name="ln-1987"></a>
<a name="ln-1988"></a>       <span class="c">! Determine Suction Pressure at Compressor Entrance &amp; Discharge Pressure at Compressor Exit</span>
<a name="ln-1989"></a>      <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">CompressorType</span><span class="p">)</span>
<a name="ln-1990"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Reciprocating</span><span class="p">)</span> <span class="c">! RECIPROCATING</span>
<a name="ln-1991"></a>          <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span> <span class="o">-</span> <span class="n">PressureDrop</span>
<a name="ln-1992"></a>          <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span> <span class="o">+</span> <span class="n">PressureDrop</span>
<a name="ln-1993"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Rotary</span><span class="p">)</span> <span class="c">! ROTARY</span>
<a name="ln-1994"></a>          <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span>
<a name="ln-1995"></a>           <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span> <span class="o">+</span> <span class="n">PressureDrop</span>
<a name="ln-1996"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Scroll</span><span class="p">)</span> <span class="c">! SCROLL</span>
<a name="ln-1997"></a>          <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span>
<a name="ln-1998"></a>           <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span>
<a name="ln-1999"></a>       <span class="k">END SELECT</span>
<a name="ln-2000"></a>
<a name="ln-2001"></a>       <span class="c">! Determine the Source Side Outlet Enthalpy</span>
<a name="ln-2002"></a>       <span class="c">! Quality of the refrigerant leaving the evaporator is saturated gas</span>
<a name="ln-2003"></a>       <span class="n">Quality</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2004"></a>       <span class="n">SourceSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">SourceSideTemp</span><span class="p">,</span> <span class="n">Quality</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2005"></a>            <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:SourceSideTemp&#39;</span><span class="p">)</span>
<a name="ln-2006"></a>
<a name="ln-2007"></a>       <span class="c">! Determine Load Side Outlet Enthalpy</span>
<a name="ln-2008"></a>       <span class="c">! Quality of the refrigerant leaving the condenser is saturated liguid</span>
<a name="ln-2009"></a>       <span class="n">Quality</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2010"></a>       <span class="n">LoadSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">LoadSideTemp</span><span class="p">,</span> <span class="n">Quality</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2011"></a>            <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:LoadSideTemp&#39;</span><span class="p">)</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>
<a name="ln-2014"></a>       <span class="c">! Determine Superheated Temperature of the Source Side outlet/compressor Inlet</span>
<a name="ln-2015"></a>       <span class="n">CompressInletTemp</span> <span class="o">=</span> <span class="n">SourceSideTemp</span> <span class="o">+</span> <span class="n">ShTemp</span>
<a name="ln-2016"></a>
<a name="ln-2017"></a>       <span class="c">! Determine the Enathalpy of the Superheated Fluid at Source Side Outlet/Compressor Inlet</span>
<a name="ln-2018"></a>       <span class="n">SuperHeatEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompressInletTemp</span><span class="p">,</span> <span class="n">SourceSidePressure</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2019"></a>            <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:CompressInletTemp&#39;</span><span class="p">)</span>
<a name="ln-2020"></a>
<a name="ln-2021"></a>       <span class="c">! Determining the suction state of the fluid from inlet state involves interation</span>
<a name="ln-2022"></a>       <span class="c">! Method employed...</span>
<a name="ln-2023"></a>       <span class="c">! Determine the saturated temp at suction pressure, shoot out into the superheated region find the enthalpy</span>
<a name="ln-2024"></a>       <span class="c">! check that with the inlet enthalpy ( as suction loss is isenthalpic). Iterate till desired accuracy is reached</span>
<a name="ln-2025"></a>
<a name="ln-2026"></a>       <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">converged</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2027"></a><span class="k">         </span><span class="n">CompSuctionSatTemp</span> <span class="o">=</span> <span class="n">GetSatTemperatureRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span> <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:SuctionPr&#39;</span><span class="p">)</span>
<a name="ln-2028"></a>         <span class="n">CompSuctionTemp1</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span>
<a name="ln-2029"></a>
<a name="ln-2030"></a>         <span class="c">! Shoot into the Superheated Region</span>
<a name="ln-2031"></a>         <span class="n">CompSuctionTemp2</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span> <span class="o">+</span> <span class="n">DegreeofSuperheat</span>
<a name="ln-2032"></a>       <span class="k">END IF</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a><span class="c">!       ! Iterate to find the Suction State</span>
<a name="ln-2035"></a><span class="c">!       NumIteration1=0</span>
<a name="ln-2036"></a><span class="c">!</span>
<a name="ln-2037"></a><span class="c">!       LOOP: DO</span>
<a name="ln-2038"></a><span class="c">!</span>
<a name="ln-2039"></a><span class="c">!           NumIteration1=NumIteration1+1</span>
<a name="ln-2040"></a><span class="c">!</span>
<a name="ln-2041"></a><span class="c">!           IF (NumIteration1.GT.STOP1) THEN</span>
<a name="ln-2042"></a><span class="c">!             WatertoAirHP(HPNum)%SimFlag = .FALSE.</span>
<a name="ln-2043"></a><span class="c">!             RETURN</span>
<a name="ln-2044"></a><span class="c">!           END IF</span>
<a name="ln-2045"></a><span class="c">!</span>
<a name="ln-2046"></a><span class="c">!               CompSuctionTemp = 0.5d0 * ( CompSuctionTemp1 + CompSuctionTemp2 )</span>
<a name="ln-2047"></a><span class="c">!               CompSuctionEnth = GetSupHeatEnthalpyRefrig(Refrigerant, CompSuctionTemp, SuctionPr, RefrigIndex)</span>
<a name="ln-2048"></a><span class="c">!               CompSuctionDensity = GetSupHeatDensityRefrig(Refrigerant, CompSuctionTemp, SuctionPr, RefrigIndex)</span>
<a name="ln-2049"></a><span class="c">!</span>
<a name="ln-2050"></a><span class="c">!               IF (ABS(CompsuctionEnth-SuperHeatEnth)/SuperHeatEnth &lt; ERR)  THEN</span>
<a name="ln-2051"></a><span class="c">!                   EXIT LOOP</span>
<a name="ln-2052"></a><span class="c">!               END IF</span>
<a name="ln-2053"></a><span class="c">!</span>
<a name="ln-2054"></a><span class="c">!               IF ( CompsuctionEnth &lt; SuperHeatEnth ) THEN</span>
<a name="ln-2055"></a><span class="c">!                   CompSuctionTemp1 = CompSuctionTemp</span>
<a name="ln-2056"></a><span class="c">!               ELSE</span>
<a name="ln-2057"></a><span class="c">!                   CompSuctionTemp2 = CompSuctionTemp</span>
<a name="ln-2058"></a><span class="c">!               END IF</span>
<a name="ln-2059"></a><span class="c">!        END DO LOOP</span>
<a name="ln-2060"></a>
<a name="ln-2061"></a><span class="c">!       Do not need the name of the refrigerant if we already have the index (from above CALLs)</span>
<a name="ln-2062"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SuctionPr</span>
<a name="ln-2063"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">RefrigIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-2064"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SuperHeatEnth</span>
<a name="ln-2065"></a>
<a name="ln-2066"></a>        <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ERR</span><span class="p">,</span> <span class="n">STOP1</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">CalcCompSuctionTempResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2067"></a>                              <span class="n">CompSuctionTemp1</span><span class="p">,</span> <span class="n">CompSuctionTemp2</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-2068"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2069"></a><span class="k">          </span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2070"></a>          <span class="k">RETURN</span>
<a name="ln-2071"></a><span class="k">        END IF</span>
<a name="ln-2072"></a><span class="k">        </span><span class="n">CompSuctionEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2073"></a>           <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-2074"></a>        <span class="n">CompSuctionDensity</span> <span class="o">=</span> <span class="n">GetSupHeatDensityRefrig</span><span class="p">(</span><span class="n">Refrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2075"></a>           <span class="n">RefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcWatertoAirHPHeating:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-2076"></a>
<a name="ln-2077"></a>        <span class="c">! Find Refrigerant Flow Rate</span>
<a name="ln-2078"></a>        <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">CompressorType</span><span class="p">)</span>
<a name="ln-2079"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Reciprocating</span><span class="p">)</span> <span class="c">! RECIPROCATING</span>
<a name="ln-2080"></a>            <span class="n">MassRef</span> <span class="o">=</span> <span class="n">PistonDisp</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2081"></a>                <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ClearanceFactor</span><span class="o">-</span><span class="n">ClearanceFactor</span><span class="o">*</span><span class="p">((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)))</span>
<a name="ln-2082"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Rotary</span><span class="p">)</span> <span class="c">! ROTARY</span>
<a name="ln-2083"></a>            <span class="n">MassRef</span> <span class="o">=</span> <span class="n">PistonDisp</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span>
<a name="ln-2084"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Scroll</span><span class="p">)</span> <span class="c">! SCROLL</span>
<a name="ln-2085"></a>            <span class="n">MassRef</span> <span class="o">=</span> <span class="n">RefVolFlowRate</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span> <span class="o">-</span> <span class="n">LeakRateCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span>
<a name="ln-2086"></a>        <span class="k">END SELECT</span>
<a name="ln-2087"></a>
<a name="ln-2088"></a>        <span class="c">! Find the Source Side Heat Transfer</span>
<a name="ln-2089"></a>        <span class="n">QSource</span> <span class="o">=</span> <span class="n">MassRef</span> <span class="o">*</span> <span class="p">(</span> <span class="n">SourceSideOutletEnth</span> <span class="o">-</span> <span class="n">LoadSideOutletEnth</span> <span class="p">)</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a>        <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QSource</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="p">)</span><span class="o">/</span><span class="n">initialQSource</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ERR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2092"></a><span class="k">            EXIT </span><span class="n">LOOPSourceEnth</span>
<a name="ln-2093"></a>        <span class="k">ELSE</span>
<a name="ln-2094"></a><span class="k">            </span><span class="n">initialQSource</span><span class="o">=</span> <span class="n">initialQSource</span><span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QSource</span><span class="o">-</span><span class="n">initialQSource</span><span class="p">)</span>
<a name="ln-2095"></a>        <span class="k">END IF</span>
<a name="ln-2096"></a>
<a name="ln-2097"></a><span class="k">    END DO </span><span class="n">LOOPSourceEnth</span>
<a name="ln-2098"></a>
<a name="ln-2099"></a>    <span class="c">! Determine the Power Consumption</span>
<a name="ln-2100"></a>      <span class="k">SELECT CASE</span>  <span class="p">(</span><span class="n">CompressorType</span><span class="p">)</span>
<a name="ln-2101"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Reciprocating</span><span class="p">)</span> <span class="c">! RECIPROCATING</span>
<a name="ln-2102"></a>          <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLos</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">LosFac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MassRef</span><span class="o">*</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2103"></a>                <span class="n">SuctionPr</span> <span class="o">/</span><span class="n">CompSuctionDensity</span>  <span class="p">&amp;</span>
<a name="ln-2104"></a>                <span class="o">*</span><span class="p">(((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">gamma</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-2105"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Rotary</span><span class="p">)</span> <span class="c">! ROTARY</span>
<a name="ln-2106"></a>          <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLos</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">LosFac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MassRef</span><span class="o">*</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2107"></a>              <span class="n">SuctionPr</span> <span class="o">/</span><span class="n">CompSuctionDensity</span>  <span class="p">&amp;</span>
<a name="ln-2108"></a>              <span class="o">*</span><span class="p">(((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">gamma</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-2109"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CompressorType_Scroll</span><span class="p">)</span> <span class="c">! SCROLL</span>
<a name="ln-2110"></a>          <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLos</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">LosFac</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SuctionPr</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2111"></a>              <span class="n">RefVolFlowRate</span> <span class="o">*</span> <span class="p">(((</span><span class="nb">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2112"></a>             <span class="p">((</span><span class="n">DischargePr</span> <span class="o">/</span> <span class="n">SuctionPr</span><span class="p">)</span> <span class="o">/</span> <span class="n">VolumeRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2113"></a>             <span class="n">VolumeRatio</span> <span class="o">**</span><span class="p">(</span><span class="nb">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2114"></a>      <span class="k">END SELECT</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a>    <span class="c">! Determine the Load Side Heat Rate</span>
<a name="ln-2117"></a>    <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">Power</span> <span class="o">+</span> <span class="n">QSource</span>
<a name="ln-2118"></a>
<a name="ln-2119"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">initialQLoad</span><span class="p">)</span><span class="o">/</span><span class="n">initialQLoad</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ERR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2120"></a><span class="k">      </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2121"></a>    <span class="k">ELSE</span>
<a name="ln-2122"></a><span class="k">        </span><span class="n">initialQLoad</span><span class="o">=</span> <span class="n">initialQLoad</span><span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">initialQLoad</span><span class="p">)</span>
<a name="ln-2123"></a>    <span class="k">END IF</span>
<a name="ln-2124"></a>
<a name="ln-2125"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FinalSimFlag</span><span class="p">)</span>  <span class="k">EXIT </span><span class="n">LOOPLoadEnth</span>
<a name="ln-2126"></a>  <span class="k">END DO </span><span class="n">LOOPLoadEnth</span>
<a name="ln-2127"></a>
<a name="ln-2128"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SuctionPr</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2129"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Heat pump:heating shut down on low pressure&#39;</span><span class="p">)</span>
<a name="ln-2130"></a>              <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2131"></a>              <span class="k">RETURN</span>
<a name="ln-2132"></a><span class="k">  END IF</span>
<a name="ln-2133"></a>
<a name="ln-2134"></a>
<a name="ln-2135"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DischargePr</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2136"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Heat pump:heating shut down on high pressure&#39;</span><span class="p">)</span>
<a name="ln-2137"></a>              <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2138"></a>              <span class="k">RETURN</span>
<a name="ln-2139"></a><span class="k">   END IF</span>
<a name="ln-2140"></a>
<a name="ln-2141"></a>   <span class="c">!calculate coil outlet state variables</span>
<a name="ln-2142"></a>   <span class="n">LoadSideAirOutletEnth</span><span class="o">=</span> <span class="n">LoadSideAirInletEnth</span> <span class="o">+</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-2143"></a>   <span class="n">LoadSideOutletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">+</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span><span class="p">)</span>
<a name="ln-2144"></a>   <span class="n">LoadsideOutletHumRat</span> <span class="o">=</span>  <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">LoadSideAirOutletEnth</span><span class="p">)</span>
<a name="ln-2145"></a>   <span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span><span class="p">)</span>
<a name="ln-2146"></a>
<a name="ln-2147"></a>    <span class="c">! Calculate actual outlet conditions for the run time fraction</span>
<a name="ln-2148"></a>    <span class="c">! Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-2149"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2150"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-2151"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadSideAirOutletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2152"></a>                                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideAirInletEnth</span>
<a name="ln-2153"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadsideOutletHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2154"></a>                                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadsideInletHumRat</span>
<a name="ln-2155"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-2156"></a>  <span class="k">ELSE</span>
<a name="ln-2157"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-2158"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LoadSideAirOutletEnth</span>
<a name="ln-2159"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">LoadsideOutletHumRat</span>
<a name="ln-2160"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span> <span class="o">=</span> <span class="n">LoadSideOutletDBTemp</span>
<a name="ln-2161"></a>  <span class="k">END IF</span>
<a name="ln-2162"></a>   <span class="c">!scale heat transfer rates and power to run time</span>
<a name="ln-2163"></a>   <span class="n">QLoadTotal</span><span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-2164"></a>   <span class="n">Power</span> <span class="o">=</span> <span class="n">Power</span><span class="o">*</span><span class="n">RuntimeFrac</span>
<a name="ln-2165"></a>   <span class="n">QSource</span> <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a> <span class="c">!Update heat pump data structure</span>
<a name="ln-2168"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="n">Power</span>
<a name="ln-2169"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="n">QLoadTotal</span>
<a name="ln-2170"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="n">QLoadTotal</span>
<a name="ln-2171"></a>
<a name="ln-2172"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="n">QSource</span>
<a name="ln-2173"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span> <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-2174"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-2175"></a>
<a name="ln-2176"></a><span class="c">!  Air-side outlet conditions are already calculated above</span>
<a name="ln-2177"></a><span class="c">!  WatertoAirHP(HPNum)%OutletAirDBTemp=LoadSideOutletDBTemp</span>
<a name="ln-2178"></a><span class="c">!  WatertoAirHP(HPNum)%OutletAirHumRat=LoadsideOutletHumRat</span>
<a name="ln-2179"></a><span class="c">!  WatertoAirHP(HPNum)%OutletAirEnthalpy = LoadSideAirOutletEnth</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span><span class="o">=</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-2182"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="n">SourceSideOutletTemp</span>
<a name="ln-2183"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="o">=</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-2184"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SourceSideWaterInletEnth</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-2185"></a>        <span class="n">QSource</span><span class="o">/</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-2186"></a>
<a name="ln-2187"></a>  <span class="k">RETURN</span>
<a name="ln-2188"></a><span class="k">  END SUBROUTINE </span><span class="n">CalcWatertoAirHPHeating</span>
<a name="ln-2189"></a>
<a name="ln-2190"></a><span class="c">! End Algorithm Section of the Module</span>
<a name="ln-2191"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2192"></a>
<a name="ln-2193"></a>
<a name="ln-2194"></a><span class="c">! End Algorithm Section of the Module</span>
<a name="ln-2195"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a><span class="c">! Beginning of Update subroutines for the WatertoAirHP Module</span>
<a name="ln-2198"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2199"></a>
<a name="ln-2200"></a><span class="k">SUBROUTINE </span><span class="n">UpdateWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-2201"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2202"></a>          <span class="c">!       AUTHOR         Hui Jin</span>
<a name="ln-2203"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-2204"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2205"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2206"></a>
<a name="ln-2207"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2208"></a>          <span class="c">! This subroutine updates the Water to Air Heat Pump outlet nodes.</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2211"></a>          <span class="c">! Data is moved from the HP data structure to the HP outlet nodes.</span>
<a name="ln-2212"></a>
<a name="ln-2213"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2214"></a>
<a name="ln-2215"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2216"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-2217"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-2218"></a>  <span class="k">USE </span><span class="n">DataContaminantBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Contaminant</span>
<a name="ln-2219"></a>
<a name="ln-2220"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2221"></a>
<a name="ln-2222"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2223"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2226"></a>          <span class="c">! na</span>
<a name="ln-2227"></a>
<a name="ln-2228"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2229"></a>          <span class="c">! na</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2232"></a>          <span class="c">! na</span>
<a name="ln-2233"></a>
<a name="ln-2234"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2235"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">AirInletNode</span>
<a name="ln-2236"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">WaterInletNode</span>
<a name="ln-2237"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">AirOutletNode</span>
<a name="ln-2238"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">WaterOutletNode</span>
<a name="ln-2239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-2240"></a>
<a name="ln-2241"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-2242"></a> <span class="c">!WatertoAirHP(HPNum)%Simflag=.FALSE.</span>
<a name="ln-2243"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Simflag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2244"></a>    <span class="c">! Heatpump is off; just pass through conditions</span>
<a name="ln-2245"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2246"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2247"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2248"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2249"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2250"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2251"></a>  <span class="c">! These will be overwritten below based on variables above that are already set to 0.</span>
<a name="ln-2252"></a>  <span class="c">!  WatertoAirHP(HPNum)%EnergyLoadTotal=0.0</span>
<a name="ln-2253"></a>  <span class="c">!  WatertoAirHP(HPNum)%EnergySensible=0.0</span>
<a name="ln-2254"></a>  <span class="c">!  WatertoAirHP(HPNum)%EnergySource=0.0</span>
<a name="ln-2255"></a>  <span class="c">!  WatertoAirHP(HPNum)%EnergyLatent=0.0</span>
<a name="ln-2256"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2257"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2258"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-2259"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-2260"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-2261"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-2262"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-2263"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-2264"></a>    <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-2265"></a>  <span class="k">END IF</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a><span class="k">  </span><span class="n">AirInletNode</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-2268"></a>  <span class="n">WaterInletNode</span>  <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-2269"></a>  <span class="n">AirOutletNode</span>   <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-2270"></a>  <span class="n">WaterOutletNode</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-2271"></a>
<a name="ln-2272"></a>
<a name="ln-2273"></a>   <span class="c">! Set the outlet air nodes of the WatertoAirHP</span>
<a name="ln-2274"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2275"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>
<a name="ln-2276"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-2277"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-2278"></a>
<a name="ln-2279"></a>   <span class="c">! Set the outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-2280"></a>  <span class="k">CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">,</span> <span class="n">WaterOutletNode</span><span class="p">)</span>
<a name="ln-2281"></a>   <span class="c">! Set the outlet water nodes for the heat pump</span>
<a name="ln-2282"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>
<a name="ln-2283"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>     <span class="c">! Set the outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-2286"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Quality</span>             <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-2287"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Press</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-2288"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-2289"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-2290"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-2291"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-2292"></a>
<a name="ln-2293"></a>     <span class="c">! Pass through the load side mass flow rates</span>
<a name="ln-2294"></a>  <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2295"></a>  <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-2296"></a>
<a name="ln-2297"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span>          <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2298"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2299"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span>  <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2300"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2301"></a>  <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span>    <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2302"></a>
<a name="ln-2303"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">CO2Simulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2304"></a><span class="k">     </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-2305"></a>  <span class="k">End If</span>
<a name="ln-2306"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">GenericContamSimulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2307"></a><span class="k">     </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">GenContam</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">GenContam</span>
<a name="ln-2308"></a>  <span class="k">End If</span>
<a name="ln-2309"></a>
<a name="ln-2310"></a><span class="k">  RETURN</span>
<a name="ln-2311"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateWatertoAirHP</span>
<a name="ln-2312"></a><span class="c">!        End of Update subroutines for the WatertoAirHP Module</span>
<a name="ln-2313"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2314"></a>
<a name="ln-2315"></a><span class="k">FUNCTION </span><span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">SHRss</span><span class="p">,</span> <span class="n">CyclingScheme</span><span class="p">,</span> <span class="n">RTF</span><span class="p">,</span> <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">EnteringDB</span><span class="p">,</span> <span class="n">EnteringWB</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SHReff</span><span class="p">)</span>
<a name="ln-2316"></a>
<a name="ln-2317"></a>        <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2318"></a>        <span class="c">!    AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-2319"></a>        <span class="c">!    DATE WRITTEN   September 2003</span>
<a name="ln-2320"></a>        <span class="c">!    MODIFIED       Kenneth Tang (Aug 2004) Added capability for simulating CycFanCycCoil</span>
<a name="ln-2321"></a>        <span class="c">!    RE-ENGINEERED  na</span>
<a name="ln-2322"></a>
<a name="ln-2323"></a>        <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2324"></a>        <span class="c">!    Adjust sensible heat ratio to account for degradation of DX coil latent</span>
<a name="ln-2325"></a>        <span class="c">!    capacity at part-load (cycling) conditions.</span>
<a name="ln-2326"></a>
<a name="ln-2327"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2328"></a>        <span class="c">!    With model parameters entered by the user, the part-load latent performance</span>
<a name="ln-2329"></a>        <span class="c">!    of a DX cooling coil is determined for a constant air flow system with</span>
<a name="ln-2330"></a>        <span class="c">!    a cooling coil that cycles on/off. The model calculates the time</span>
<a name="ln-2331"></a>        <span class="c">!    required for condensate to begin falling from the cooling coil.</span>
<a name="ln-2332"></a>        <span class="c">!    Runtimes greater than this are integrated to a &quot;part-load&quot; latent</span>
<a name="ln-2333"></a>        <span class="c">!    capacity which is used to determine the &quot;part-load&quot; sensible heat ratio.</span>
<a name="ln-2334"></a>        <span class="c">!    See reference below for additional details (linear decay model, Eq. 8b).</span>
<a name="ln-2335"></a>        <span class="c">!</span>
<a name="ln-2336"></a>        <span class="c">! REFERENCES:</span>
<a name="ln-2337"></a>        <span class="c">!   &quot;A Model to Predict the Latent Capacity of Air Conditioners and</span>
<a name="ln-2338"></a>        <span class="c">!    Heat Pumps at Part-Load Conditions with Constant Fan Operation&quot;</span>
<a name="ln-2339"></a>        <span class="c">!    1996 ASHRAE Transactions, Volume 102, Part 1, Pp. 266 - 274,</span>
<a name="ln-2340"></a>        <span class="c">!    Hugh I. Henderson, Jr., P.E., Kannan Rengarajan, P.E.</span>
<a name="ln-2341"></a>
<a name="ln-2342"></a>        <span class="c">! USE STATEMENTS:</span>
<a name="ln-2343"></a>
<a name="ln-2344"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2347"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>   <span class="c">! Index number for cooling coil</span>
<a name="ln-2348"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span> <span class="c">!fan/compressor cycling scheme indicator</span>
<a name="ln-2349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRss</span>       <span class="c">! Steady-state sensible heat ratio</span>
<a name="ln-2350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RTF</span>         <span class="c">! Compressor run-time fraction</span>
<a name="ln-2351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>   <span class="c">! Rated latent capacity</span>
<a name="ln-2352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>  <span class="c">! Actual latent capacity</span>
<a name="ln-2353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringDB</span>  <span class="c">! Entering air dry-bulb temperature</span>
<a name="ln-2354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringWB</span>  <span class="c">! Entering air wet-bulb temperature</span>
<a name="ln-2355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SHReff</span>      <span class="c">! Effective sensible heat ratio, includes degradation due to cycling effects</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2358"></a>          <span class="c">! na</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2361"></a>          <span class="c">! na</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2364"></a>          <span class="c">! na</span>
<a name="ln-2365"></a>
<a name="ln-2366"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet</span>        <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s condensate drain line</span>
<a name="ln-2368"></a>                         <span class="c">!   at the current operating conditions (sec)</span>
<a name="ln-2369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">Gamma</span>       <span class="c">! Initial moisture evaporation rate divided by steady-state AC latent capacity</span>
<a name="ln-2370"></a>                         <span class="c">!   at the current operating conditions</span>
<a name="ln-2371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_rated</span>  <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-2372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_rated</span> <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-2373"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_max</span>    <span class="c">! Maximum allowed value for Twet</span>
<a name="ln-2374"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>  <span class="c">!Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-2375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>         <span class="c">!Heat pump time constant [s]</span>
<a name="ln-2376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>           <span class="c">!Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-2377"></a>                                    <span class="c">!shut off after compressor cycle off  [s]</span>
<a name="ln-2378"></a>
<a name="ln-2379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ton</span>         <span class="c">! Coil on time (sec)</span>
<a name="ln-2380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toff</span>        <span class="c">! Coil off time (sec)</span>
<a name="ln-2381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toffa</span>       <span class="c">! Actual coil off time (sec). Equations valid for Toff &lt;= (2.0 * Twet/Gamma)</span>
<a name="ln-2382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aa</span>          <span class="c">! Intermediate variable</span>
<a name="ln-2383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To1</span>         <span class="c">! Intermediate variable (first guess at To). To = time to the start of moisture removal</span>
<a name="ln-2384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To2</span>         <span class="c">! Intermediate variable (second guess at To). To = time to the start of moisture removal</span>
<a name="ln-2385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Error</span>       <span class="c">! Error for iteration (DO) loop</span>
<a name="ln-2386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LHRmult</span>     <span class="c">! Latent Heat Ratio (LHR) multiplier. The effective latent heat ratio LHR = (1-SHRss)*LHRmult</span>
<a name="ln-2387"></a>
<a name="ln-2388"></a>   <span class="n">Twet_rated</span>  <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Twet_Rated</span>
<a name="ln-2389"></a>   <span class="n">Gamma_rated</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span>
<a name="ln-2390"></a>   <span class="n">MaxONOFFCyclesperHour</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-2391"></a>   <span class="n">HPTimeConstant</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>
<a name="ln-2392"></a>   <span class="n">FanDelayTime</span> <span class="o">=</span> <span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanDelayTime</span>
<a name="ln-2393"></a>
<a name="ln-2394"></a>
<a name="ln-2395"></a>
<a name="ln-2396"></a><span class="c">!  No moisture evaporation (latent degradation) occurs for runtime fraction of 1.0</span>
<a name="ln-2397"></a><span class="c">!  All latent degradation model parameters cause divide by 0.0 if not greater than 0.0</span>
<a name="ln-2398"></a><span class="c">!  Latent degradation model parameters initialize to 0.0 meaning no evaporation model used.</span>
<a name="ln-2399"></a>   <span class="k">IF</span><span class="p">((</span><span class="n">RTF</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatRated</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatActual</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Twet_rated</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2400"></a>      <span class="p">(</span><span class="n">Gamma_rated</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">HPTimeConstant</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">RTF</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2401"></a><span class="k">     </span><span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span>
<a name="ln-2402"></a>     <span class="k">RETURN</span>
<a name="ln-2403"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-2404"></a>
<a name="ln-2405"></a>   <span class="n">Twet_max</span>   <span class="o">=</span> <span class="mi">999</span><span class="mf">9.0d0</span> <span class="c">! high limit for Twet</span>
<a name="ln-2406"></a>
<a name="ln-2407"></a><span class="c">!  Calculate the model parameters at the actual operating conditions</span>
<a name="ln-2408"></a>   <span class="n">Twet</span>    <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Twet_rated</span><span class="o">*</span><span class="n">QLatRated</span> <span class="o">/</span><span class="p">(</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">),</span><span class="n">Twet_max</span><span class="p">)</span>
<a name="ln-2409"></a>   <span class="nb">Gamma</span>   <span class="o">=</span> <span class="n">Gamma_rated</span><span class="o">*</span><span class="n">QLatRated</span><span class="o">*</span><span class="p">(</span><span class="n">EnteringDB</span><span class="o">-</span><span class="n">EnteringWB</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="mf">6.7d0</span><span class="o">-</span><span class="mi">1</span><span class="mf">9.4d0</span><span class="p">)</span><span class="o">*</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">)</span>
<a name="ln-2410"></a>
<a name="ln-2411"></a><span class="c">!  Calculate the compressor on and off times using a converntional thermostat curve</span>
<a name="ln-2412"></a>   <span class="n">Ton</span>  <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RTF</span><span class="p">))</span>   <span class="c">! duration of cooling coil on-cycle (sec)</span>
<a name="ln-2413"></a>
<a name="ln-2414"></a>   <span class="k">IF</span> <span class="p">((</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">FanDelayTime</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2415"></a><span class="c">!  For CycFanCycCoil, moisture is evaporated from the cooling coil back to the air stream</span>
<a name="ln-2416"></a><span class="c">!  until the fan cycle off. Assume no evaporation from the coil after the fan shuts off.</span>
<a name="ln-2417"></a>   <span class="n">Toff</span> <span class="o">=</span> <span class="n">FanDelayTime</span>
<a name="ln-2418"></a>   <span class="k">ELSE</span>
<a name="ln-2419"></a><span class="c">!  For ContFanCycCoil, moisture is evaporated from the cooling coil back to the air stream</span>
<a name="ln-2420"></a><span class="c">!  for the entire heat pump off-cycle.</span>
<a name="ln-2421"></a>   <span class="n">Toff</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">*</span><span class="n">RTF</span><span class="p">)</span>        <span class="c">! duration of cooling coil off-cycle (sec)</span>
<a name="ln-2422"></a>   <span class="k">END IF</span>
<a name="ln-2423"></a>
<a name="ln-2424"></a><span class="c">!  Cap Toff to meet the equation restriction</span>
<a name="ln-2425"></a>   <span class="k">IF</span><span class="p">(</span><span class="nb">Gamma</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2426"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Toff</span><span class="p">,</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Twet</span><span class="o">/</span><span class="nb">Gamma</span><span class="p">)</span>
<a name="ln-2427"></a>   <span class="k">ELSE</span>
<a name="ln-2428"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="n">Toff</span>
<a name="ln-2429"></a>   <span class="k">END IF</span>
<a name="ln-2430"></a>
<a name="ln-2431"></a><span class="c">!  Use sucessive substitution to solve for To</span>
<a name="ln-2432"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Gamma</span><span class="o">*</span><span class="n">Toffa</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.25d0</span><span class="o">/</span><span class="n">Twet</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">Gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Toffa</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2433"></a>
<a name="ln-2434"></a>   <span class="n">To1</span> <span class="o">=</span> <span class="n">aa</span><span class="o">+</span><span class="n">HPTimeConstant</span>
<a name="ln-2435"></a>   <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2436"></a>   <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Error</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-2437"></a>       <span class="n">To2</span> <span class="o">=</span> <span class="n">aa</span><span class="o">-</span><span class="n">HPTimeConstant</span><span class="o">*</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">To1</span><span class="o">/</span><span class="n">HPTimeConstant</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2438"></a>       <span class="n">Error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">To2</span><span class="o">-</span><span class="n">To1</span><span class="p">)</span><span class="o">/</span><span class="n">To1</span><span class="p">)</span>
<a name="ln-2439"></a>       <span class="n">To1</span> <span class="o">=</span> <span class="n">To2</span>
<a name="ln-2440"></a>   <span class="k">END DO</span>
<a name="ln-2441"></a>
<a name="ln-2442"></a><span class="c">!  Adjust Sensible Heat Ratio (SHR) using Latent Heat Ratio (LHR) multiplier</span>
<a name="ln-2443"></a><span class="c">!  Floating underflow errors occur when -Ton/HPTimeConstant is a large negative number.</span>
<a name="ln-2444"></a><span class="c">!  Cap lower limit at -700 to avoid the underflow errors.</span>
<a name="ln-2445"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="mf">0.0d0</span><span class="p">,</span><span class="o">-</span><span class="n">Ton</span><span class="o">/</span><span class="n">HPTimeConstant</span><span class="p">))</span>
<a name="ln-2446"></a><span class="c">!  Calculate latent heat ratio multiplier</span>
<a name="ln-2447"></a>   <span class="n">LHRmult</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(((</span><span class="n">Ton</span><span class="o">-</span><span class="n">To2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Ton</span><span class="o">+</span><span class="n">HPTimeConstant</span><span class="o">*</span><span class="p">(</span><span class="n">aa</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2448"></a>
<a name="ln-2449"></a><span class="c">!  Calculate part-load or &quot;effective&quot; sensible heat ratio</span>
<a name="ln-2450"></a>   <span class="n">SHReff</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHRss</span><span class="p">)</span><span class="o">*</span><span class="n">LHRmult</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SHRss</span><span class="p">)</span> <span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span> <span class="c">! Effective SHR can be less than the steady-state SHR</span>
<a name="ln-2453"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHReff</span><span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Effective sensible heat ratio can&#39;t be greater than 1.0</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a> <span class="k">RETURN</span>
<a name="ln-2456"></a>
<a name="ln-2457"></a><span class="k">END FUNCTION </span><span class="n">CalcEffectiveSHR</span>
<a name="ln-2458"></a>
<a name="ln-2459"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">DegradF</span><span class="p">(</span><span class="n">FluidName</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">FluidIndex</span><span class="p">)</span>
<a name="ln-2460"></a><span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2461"></a>        <span class="c">!    AUTHOR         Kenneth Tang</span>
<a name="ln-2462"></a>        <span class="c">!    DATE WRITTEN   October 2004</span>
<a name="ln-2463"></a>        <span class="c">!    MODIFIED       na</span>
<a name="ln-2464"></a>        <span class="c">!    RE-ENGINEERED  na</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a>        <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2467"></a>        <span class="c">!    Calculate the degradation factor to predict the heat pump performance</span>
<a name="ln-2468"></a>        <span class="c">!    when antifreeze is used.</span>
<a name="ln-2469"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2470"></a>        <span class="c">!    Use FluidProperties to calculate the properties of water and glycol</span>
<a name="ln-2471"></a>        <span class="c">!    at the given temperature. Then substitute the properties into the equation.</span>
<a name="ln-2472"></a>        <span class="c">!</span>
<a name="ln-2473"></a>        <span class="c">! REFERENCES:</span>
<a name="ln-2474"></a>        <span class="c">!    Jin, H. 2002. Parameter Estimation Based Models of Water Source Heat Pumps. Phd Thesis.</span>
<a name="ln-2475"></a>        <span class="c">!    Oklahoma State University.</span>
<a name="ln-2476"></a>
<a name="ln-2477"></a>        <span class="c">! USE STATEMENTS:</span>
<a name="ln-2478"></a>  <span class="k">USE </span><span class="n">FluidProperties</span>
<a name="ln-2479"></a>
<a name="ln-2480"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2481"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidName</span>  <span class="c">!Name of glycol used in source side</span>
<a name="ln-2482"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temp</span>           <span class="c">! Temperature of the fluid</span>
<a name="ln-2483"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidIndex</span>    <span class="c">! Index number for the fluid</span>
<a name="ln-2484"></a>
<a name="ln-2485"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2486"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CalledFrom</span><span class="o">=</span><span class="s1">&#39;HVACWaterToAir:DegradF&#39;</span>
<a name="ln-2487"></a>
<a name="ln-2488"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2489"></a>          <span class="c">! na</span>
<a name="ln-2490"></a>
<a name="ln-2491"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2492"></a>          <span class="c">! na</span>
<a name="ln-2493"></a>
<a name="ln-2494"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VisWater</span>          <span class="c">!Viscosity of water [mPa-s]</span>
<a name="ln-2496"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DensityWater</span>      <span class="c">!Density of water [kg/m3]</span>
<a name="ln-2497"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span>           <span class="c">!Specific heat of water [J/kg-K]</span>
<a name="ln-2498"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondWater</span>         <span class="c">!Conductivity of water [W/m-K]</span>
<a name="ln-2499"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VisCoolant</span>        <span class="c">!Viscosity of water [mPa-s]</span>
<a name="ln-2500"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DensityCoolant</span>    <span class="c">!Density of water [kg/m3]</span>
<a name="ln-2501"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpCoolant</span>         <span class="c">!Specific heat of water [J/kg-K]</span>
<a name="ln-2502"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondCoolant</span>       <span class="c">!Conductivity of water [W/m-K]</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a> <span class="n">VisWater</span> <span class="o">=</span> <span class="n">GetViscosityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">WaterIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2505"></a> <span class="n">DensityWater</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">WaterIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2506"></a> <span class="n">CpWater</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">WaterIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2507"></a> <span class="n">CondWater</span> <span class="o">=</span>  <span class="n">GetConductivityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">WaterIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2508"></a> <span class="n">VisCoolant</span> <span class="o">=</span> <span class="n">GetViscosityGlycol</span><span class="p">(</span><span class="n">FluidName</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">FluidIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2509"></a> <span class="n">DensityCoolant</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">FluidName</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">FluidIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2510"></a> <span class="n">CpCoolant</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">FluidName</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">FluidIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2511"></a> <span class="n">CondCoolant</span> <span class="o">=</span>  <span class="n">GetConductivityGlycol</span><span class="p">(</span><span class="n">FluidName</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">FluidIndex</span><span class="p">,</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a> <span class="n">DegradF</span> <span class="o">=</span> <span class="p">(</span><span class="n">VisCoolant</span> <span class="o">/</span> <span class="n">VisWater</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.47d0</span><span class="p">)</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-2514"></a>           <span class="p">(</span><span class="n">DensityCoolant</span> <span class="o">/</span> <span class="n">DensityWater</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">CpCoolant</span> <span class="o">/</span> <span class="n">CpWater</span><span class="p">)</span><span class="o">**</span><span class="mf">0.33d0</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-2515"></a>             <span class="p">(</span><span class="n">CondCoolant</span> <span class="o">/</span> <span class="n">CondWater</span><span class="p">)</span><span class="o">**</span><span class="mf">0.67d0</span>
<a name="ln-2516"></a>
<a name="ln-2517"></a><span class="k">END FUNCTION </span><span class="n">DegradF</span>
<a name="ln-2518"></a>
<a name="ln-2519"></a><span class="k">FUNCTION </span><span class="n">GetCoilIndex</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)</span>
<a name="ln-2520"></a>
<a name="ln-2521"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2522"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-2523"></a>          <span class="c">!       DATE WRITTEN   August 2007</span>
<a name="ln-2524"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2525"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2526"></a>
<a name="ln-2527"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2528"></a>          <span class="c">! This function looks up the given coil and returns the index.  If</span>
<a name="ln-2529"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-2530"></a>          <span class="c">! as zero.</span>
<a name="ln-2531"></a>
<a name="ln-2532"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2533"></a>          <span class="c">! na</span>
<a name="ln-2534"></a>
<a name="ln-2535"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2536"></a>          <span class="c">! na</span>
<a name="ln-2537"></a>
<a name="ln-2538"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2539"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-2540"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-2541"></a>
<a name="ln-2542"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2543"></a>
<a name="ln-2544"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2545"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>      <span class="c">! must match coil types in this module</span>
<a name="ln-2546"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>      <span class="c">! must match coil names for the coil type</span>
<a name="ln-2547"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>   <span class="c">! set to true if problem</span>
<a name="ln-2548"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IndexNum</span>      <span class="c">! returned index of matched coil</span>
<a name="ln-2549"></a>
<a name="ln-2550"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2551"></a>          <span class="c">! na</span>
<a name="ln-2552"></a>
<a name="ln-2553"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2554"></a>          <span class="c">! na</span>
<a name="ln-2555"></a>
<a name="ln-2556"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2557"></a>          <span class="c">! na</span>
<a name="ln-2558"></a>
<a name="ln-2559"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2560"></a>          <span class="c">! na</span>
<a name="ln-2561"></a>
<a name="ln-2562"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-2563"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-2564"></a>    <span class="k">CALL </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-2565"></a>    <span class="n">WaterIndex</span><span class="o">=</span><span class="n">FindGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span> <span class="c">!Initialize the WaterIndex once</span>
<a name="ln-2566"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2567"></a>  <span class="k">End If</span>
<a name="ln-2568"></a>
<a name="ln-2569"></a><span class="k">  </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-2570"></a>
<a name="ln-2571"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IndexNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2572"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2573"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2574"></a>  <span class="n">ENDIF</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a>  <span class="k">RETURN</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a><span class="k">END FUNCTION </span><span class="n">GetCoilIndex</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a><span class="k">FUNCTION </span><span class="n">GetCoilCapacity</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilCapacity</span><span class="p">)</span>
<a name="ln-2581"></a>
<a name="ln-2582"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2583"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2584"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2585"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2586"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2589"></a>          <span class="c">! This function looks up the coil capacity for the given coil and returns it.  If</span>
<a name="ln-2590"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-2591"></a>          <span class="c">! as negative.</span>
<a name="ln-2592"></a>
<a name="ln-2593"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2594"></a>          <span class="c">! na</span>
<a name="ln-2595"></a>
<a name="ln-2596"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2597"></a>          <span class="c">! na</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2600"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-2601"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2606"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-2607"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-2608"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-2609"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CoilCapacity</span> <span class="c">! returned capacity of matched coil</span>
<a name="ln-2610"></a>
<a name="ln-2611"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2612"></a>          <span class="c">! na</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2615"></a>          <span class="c">! na</span>
<a name="ln-2616"></a>
<a name="ln-2617"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2618"></a>          <span class="c">! na</span>
<a name="ln-2619"></a>
<a name="ln-2620"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2621"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-2622"></a>
<a name="ln-2623"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-2624"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-2625"></a>    <span class="n">WaterIndex</span><span class="o">=</span><span class="n">FindGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span> <span class="c">!Initialize the WaterIndex once</span>
<a name="ln-2626"></a>    <span class="k">CALL </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-2627"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2628"></a>  <span class="k">End If</span>
<a name="ln-2629"></a>
<a name="ln-2630"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2631"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2632"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterToAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-2633"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2634"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2635"></a><span class="k">        </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">HeatingCapacity</span>
<a name="ln-2636"></a>      <span class="k">ELSE</span>
<a name="ln-2637"></a><span class="k">        </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">WaterToAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">CoolingCapacity</span>
<a name="ln-2638"></a>      <span class="n">ENDIF</span>
<a name="ln-2639"></a>    <span class="n">ENDIF</span>
<a name="ln-2640"></a>  <span class="k">ELSE</span>
<a name="ln-2641"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2642"></a>  <span class="n">ENDIF</span>
<a name="ln-2643"></a>
<a name="ln-2644"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2645"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2646"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2647"></a>    <span class="n">CoilCapacity</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-2648"></a>  <span class="n">ENDIF</span>
<a name="ln-2649"></a>
<a name="ln-2650"></a>  <span class="k">RETURN</span>
<a name="ln-2651"></a>
<a name="ln-2652"></a><span class="k">END FUNCTION </span><span class="n">GetCoilCapacity</span>
<a name="ln-2653"></a>
<a name="ln-2654"></a><span class="k">FUNCTION </span><span class="n">GetCoilInletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-2655"></a>
<a name="ln-2656"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2657"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2658"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2659"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2660"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2661"></a>
<a name="ln-2662"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2663"></a>          <span class="c">! This function looks up the given coil and returns the inlet node.  If</span>
<a name="ln-2664"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-2665"></a>          <span class="c">! as zero.</span>
<a name="ln-2666"></a>
<a name="ln-2667"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2668"></a>          <span class="c">! na</span>
<a name="ln-2669"></a>
<a name="ln-2670"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2671"></a>          <span class="c">! na</span>
<a name="ln-2672"></a>
<a name="ln-2673"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2674"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-2675"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-2676"></a>
<a name="ln-2677"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2680"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-2681"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-2682"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-2683"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned outlet node of matched coil</span>
<a name="ln-2684"></a>
<a name="ln-2685"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2686"></a>          <span class="c">! na</span>
<a name="ln-2687"></a>
<a name="ln-2688"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2689"></a>          <span class="c">! na</span>
<a name="ln-2690"></a>
<a name="ln-2691"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2692"></a>          <span class="c">! na</span>
<a name="ln-2693"></a>
<a name="ln-2694"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2695"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-2696"></a>
<a name="ln-2697"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-2698"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-2699"></a>    <span class="k">CALL </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-2700"></a>    <span class="n">WaterIndex</span><span class="o">=</span><span class="n">FindGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span> <span class="c">!Initialize the WaterIndex once</span>
<a name="ln-2701"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2702"></a>  <span class="k">End If</span>
<a name="ln-2703"></a>
<a name="ln-2704"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-2705"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2706"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-2707"></a>  <span class="n">ENDIF</span>
<a name="ln-2708"></a>
<a name="ln-2709"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2710"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2711"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2712"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2713"></a>  <span class="n">ENDIF</span>
<a name="ln-2714"></a>
<a name="ln-2715"></a>  <span class="k">RETURN</span>
<a name="ln-2716"></a>
<a name="ln-2717"></a><span class="k">END FUNCTION </span><span class="n">GetCoilInletNode</span>
<a name="ln-2718"></a>
<a name="ln-2719"></a><span class="k">FUNCTION </span><span class="n">GetCoilOutletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-2720"></a>
<a name="ln-2721"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2722"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-2723"></a>          <span class="c">!       DATE WRITTEN   July 2007</span>
<a name="ln-2724"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2725"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2726"></a>
<a name="ln-2727"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2728"></a>          <span class="c">! This function looks up the given coil and returns the outlet node.  If</span>
<a name="ln-2729"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-2730"></a>          <span class="c">! as zero.</span>
<a name="ln-2731"></a>
<a name="ln-2732"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2733"></a>          <span class="c">! na</span>
<a name="ln-2734"></a>
<a name="ln-2735"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2736"></a>          <span class="c">! na</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2739"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-2740"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-2741"></a>
<a name="ln-2742"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2743"></a>
<a name="ln-2744"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2745"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-2746"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-2747"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-2748"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned outlet node of matched coil</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2751"></a>          <span class="c">! na</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2754"></a>          <span class="c">! na</span>
<a name="ln-2755"></a>
<a name="ln-2756"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2757"></a>          <span class="c">! na</span>
<a name="ln-2758"></a>
<a name="ln-2759"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2760"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-2763"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-2764"></a>    <span class="k">CALL </span><span class="n">GetWatertoAirHPInput</span>
<a name="ln-2765"></a>    <span class="n">WaterIndex</span><span class="o">=</span><span class="n">FindGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span> <span class="c">!Initialize the WaterIndex once</span>
<a name="ln-2766"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2767"></a>  <span class="k">End If</span>
<a name="ln-2768"></a>
<a name="ln-2769"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-2770"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2771"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">WatertoAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-2772"></a>  <span class="n">ENDIF</span>
<a name="ln-2773"></a>
<a name="ln-2774"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2775"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2776"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2777"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2778"></a>  <span class="n">ENDIF</span>
<a name="ln-2779"></a>
<a name="ln-2780"></a>  <span class="k">RETURN</span>
<a name="ln-2781"></a>
<a name="ln-2782"></a><span class="k">END FUNCTION </span><span class="n">GetCoilOutletNode</span>
<a name="ln-2783"></a>
<a name="ln-2784"></a><span class="k">END MODULE </span><span class="n">WatertoAirHeatPump</span>
<a name="ln-2785"></a>
<a name="ln-2786"></a><span class="c">!********************************************************************************************</span>
<a name="ln-2787"></a><span class="c">!END First module for parameter estimation heat pumps</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a><span class="c">! **********************************************!! BREAK IN MODULES  !!****************************************</span>
<a name="ln-2790"></a>
<a name="ln-2791"></a><span class="c">!begin second module for equation fit model.</span>
<a name="ln-2792"></a><span class="c">!********************************************************************************************</span>
<a name="ln-2793"></a><span class="k">MODULE </span><span class="n">WatertoAirHeatPumpSimple</span>
<a name="ln-2794"></a>
<a name="ln-2795"></a><span class="c">! Module containing the Water to Air Heat Pump simulation routines</span>
<a name="ln-2796"></a>
<a name="ln-2797"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-2798"></a>  <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-2799"></a>  <span class="c">!       DATE WRITTEN   Nov 2003</span>
<a name="ln-2800"></a>  <span class="c">!       MODIFIED       Brent Griffith, Sept 2010 plant upgrades</span>
<a name="ln-2801"></a>  <span class="c">!</span>
<a name="ln-2802"></a>  <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-2803"></a>
<a name="ln-2804"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-2805"></a>  <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-2806"></a>  <span class="c">! manage the Water to Air Heat Pump Simple Component</span>
<a name="ln-2807"></a>
<a name="ln-2808"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2809"></a>  <span class="c">!</span>
<a name="ln-2810"></a>
<a name="ln-2811"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-2812"></a>  <span class="c">! (1) Lash.T.A.,1992.Simulation and Analysis of a Water Loop Heat Pump System.</span>
<a name="ln-2813"></a>  <span class="c">! M.S. Thesis, University of Illinois at Urbana Champaign.</span>
<a name="ln-2814"></a>  <span class="c">! (2) Shenoy, Arun. 2004. Simulation, Modeling and Analysis of Water to Air Heat Pump.</span>
<a name="ln-2815"></a>  <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-2816"></a>  <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-2817"></a>  <span class="c">! (3) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-2818"></a>  <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-2819"></a>  <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-2820"></a>
<a name="ln-2821"></a>  <span class="c">!</span>
<a name="ln-2822"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-2823"></a>
<a name="ln-2824"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-2825"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-2826"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-2827"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-2828"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-2829"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-2830"></a><span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-2831"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">OutBaroPress</span>
<a name="ln-2832"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CycFanCycCoil</span><span class="p">,</span> <span class="n">ContFanCycCoil</span><span class="p">,</span> <span class="n">WaterCycling</span><span class="p">,</span> <span class="n">WaterConstant</span><span class="p">,</span> <span class="n">WaterConstantOnDemand</span><span class="p">,</span> <span class="n">Heating</span><span class="p">,</span> <span class="n">Cooling</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2833"></a>                           <span class="n">TimestepSys</span>
<a name="ln-2834"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-2835"></a><span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_CoilWAHPHeatingEquationFit</span><span class="p">,</span> <span class="n">TypeOf_CoilWAHPCoolingEquationFit</span>
<a name="ln-2836"></a>
<a name="ln-2837"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-2838"></a><span class="k">PRIVATE</span>               <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a> <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-2841"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>    <span class="kd">::</span> <span class="n">CelsiustoKelvin</span><span class="o">=</span><span class="n">KelvinConv</span>     <span class="c">! Conversion from Celsius to Kelvin</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a><span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2844"></a><span class="k">TYPE </span><span class="n">SimpleWatertoAirHPConditions</span>
<a name="ln-2845"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>            <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Name of the Water to Air Heat pump</span>
<a name="ln-2846"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WatertoAirHPType</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Type of WatertoAirHP ie. Heating or Cooling</span>
<a name="ln-2847"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WAHPPlantTypeOfNum</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! type of component in plant</span>
<a name="ln-2848"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Simflag</span>                         <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! Heat Pump Simulation Flag</span>
<a name="ln-2849"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolFlowRate</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air Volumetric Flow Rate[m3/s]</span>
<a name="ln-2850"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air Mass Flow Rate[kg/s]</span>
<a name="ln-2851"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDBTemp</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Air Dry Bulb Temperature [C]</span>
<a name="ln-2852"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Air Humidity Ratio [kg/kg]</span>
<a name="ln-2853"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Air Enthalpy [J/kg]</span>
<a name="ln-2854"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDBTemp</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Air Dry Bulb Temperature [C]</span>
<a name="ln-2855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Air Humidity Ratio [kg/kg]</span>
<a name="ln-2856"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>               <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Air Enthalpy [J/kg]</span>
<a name="ln-2857"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterVolFlowRate</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-2858"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>               <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Water Mass Flow Rate [kg/s]</span>
<a name="ln-2859"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignWaterMassFlowRate</span>         <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterTemp</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Water Temperature [C]</span>
<a name="ln-2861"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterEnthalpy</span>              <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Inlet Water Enthalpy [J/kg]</span>
<a name="ln-2862"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTemp</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Water Temperature [C]</span>
<a name="ln-2863"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterEnthalpy</span>             <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Outlet Water Enthalpy [J/kg]</span>
<a name="ln-2864"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Power</span>                           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Power Consumption [W]</span>
<a name="ln-2865"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Load Side Total Heat Transfer Rate [W]</span>
<a name="ln-2866"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSensible</span>                       <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Sensible Load Side Heat Transfer Rate [W]</span>
<a name="ln-2867"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatent</span>                         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Latent Load Side Heat Transfer Rate [W]</span>
<a name="ln-2868"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-2869"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Energy</span>                          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Energy Consumption [J]</span>
<a name="ln-2870"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyLoadTotal</span>                 <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Load Side Total Heat Transferred [J]</span>
<a name="ln-2871"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergySensible</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Sensible Load Side Heat Transferred [J]</span>
<a name="ln-2872"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyLatent</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Latent Load Side Heat Transferred [J]</span>
<a name="ln-2873"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergySource</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Source Side Heat Transferred [J]</span>
<a name="ln-2874"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COP</span>                             <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Heat Pump Coefficient of Performance [-]</span>
<a name="ln-2875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFrac</span>                         <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Duty Factor</span>
<a name="ln-2876"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Part Load Ratio</span>
<a name="ln-2877"></a>
<a name="ln-2878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterVolFlowRate</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-2879"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRate</span>             <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Air Volumetric Flow Rate [m3/s]</span>
<a name="ln-2880"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapHeat</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Heating Capacity [W]</span>
<a name="ln-2881"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedPowerHeat</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Heating Power Consumption[W]</span>
<a name="ln-2882"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCOPHeat</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Heating COP [W/W]</span>
<a name="ln-2883"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolTotal</span>               <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Total Cooling Capacity [W]</span>
<a name="ln-2884"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolSens</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Sensible Cooling Capacity [W]</span>
<a name="ln-2885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedPowerCool</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Cooling Power Consumption[W]</span>
<a name="ln-2886"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCOPCool</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Rated/Ref Cooling COP [W/W]</span>
<a name="ln-2887"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCap1</span>                        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 1st coefficient of the Heating capacity performance curve</span>
<a name="ln-2888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCap2</span>                        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 2nd coefficient of the Heating capacity performance curve</span>
<a name="ln-2889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCap3</span>                        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 3rd coefficient of the Heating capacity performance curve</span>
<a name="ln-2890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCap4</span>                        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 4th coefficient of the Heating capacity performance curve</span>
<a name="ln-2891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCap5</span>                        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 5th coefficient of the Heating capacity performance curve</span>
<a name="ln-2892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPower1</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 1st coefficient of the Heating power consumption curve</span>
<a name="ln-2893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPower2</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 2nd coefficient of the Heating power consumption curve</span>
<a name="ln-2894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPower3</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 3rd coefficient of the Heating power consumption curve</span>
<a name="ln-2895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPower4</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 4th coefficient of the Heating power consumption curve</span>
<a name="ln-2896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPower5</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 5th coefficient of the Heating power consumption curve</span>
<a name="ln-2897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolCap1</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 1st coefficient of the Total Cooling capacity performance curve</span>
<a name="ln-2898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolCap2</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 2nd coefficient of the Total Cooling capacity performance curve</span>
<a name="ln-2899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolCap3</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 3rd coefficient of the Total Cooling capacity performance curve</span>
<a name="ln-2900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolCap4</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 4th coefficient of the Total Cooling capacity performance curve</span>
<a name="ln-2901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolCap5</span>                   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 5th coefficient of the Total Cooling capacity performance curve</span>
<a name="ln-2902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolCap1</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 1st coefficient of the Sensible Cooling capacity performance curve</span>
<a name="ln-2903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolCap2</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 2nd coefficient of the Sensible Cooling capacity performance curve</span>
<a name="ln-2904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolCap3</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 3rd coefficient of the Sensible Cooling capacity performance curve</span>
<a name="ln-2905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolCap4</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 4th coefficient of the Sensible Cooling capacity performance curve</span>
<a name="ln-2906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolCap5</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 5th coefficient of the Sensible Cooling capacity performance curve</span>
<a name="ln-2907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolCap6</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 6th coefficient of the Sensible Cooling capacity performance curve</span>
<a name="ln-2908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPower1</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 1st coefficient of the Cooling power consumption curve</span>
<a name="ln-2909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPower2</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 2nd coefficient of the Cooling power consumption curve</span>
<a name="ln-2910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPower3</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 3rd coefficient of the Cooling power consumption curve</span>
<a name="ln-2911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPower4</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 4th coefficient of the Cooling power consumption curve</span>
<a name="ln-2912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPower5</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! 5th coefficient of the Cooling power consumption curve</span>
<a name="ln-2913"></a>
<a name="ln-2914"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirInletNodeNum</span>              <span class="o">=</span><span class="mi">0</span>    <span class="c">! Node Number of the Air Inlet</span>
<a name="ln-2915"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirOutletNodeNum</span>             <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node Number of the Air Outlet</span>
<a name="ln-2916"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterInletNodeNum</span>            <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node Number of the Water Onlet</span>
<a name="ln-2917"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterOutletNodeNum</span>           <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node Number of the Water Outlet</span>
<a name="ln-2918"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopNum</span>                      <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant loop index for water side</span>
<a name="ln-2919"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopSide</span>                     <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant loop side index</span>
<a name="ln-2920"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">BranchNum</span>                    <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant branch index</span>
<a name="ln-2921"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompNum</span>                      <span class="o">=</span><span class="mi">0</span>    <span class="c">! plant component index</span>
<a name="ln-2922"></a>
<a name="ln-2923"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WaterCyclingMode</span>                <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Heat Pump Coil water flow mode; See definitions in DataHVACGlobals,</span>
<a name="ln-2924"></a>                                                       <span class="c">! 1=water cycling, 2=water constant, 3=water constant on demand (old mode)</span>
<a name="ln-2925"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LastOperatingMode</span>               <span class="o">=</span> <span class="n">WaterCycling</span>  <span class="c">! type of coil calling for water flow, either heating or cooling,</span>
<a name="ln-2926"></a>                                                               <span class="c">! start it at 1 so there will be water flow from the start,</span>
<a name="ln-2927"></a>                                                               <span class="c">! even if there is no load.</span>
<a name="ln-2928"></a>                                                               <span class="c">! Gets updated only during the first iteration of each timestep</span>
<a name="ln-2929"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">WaterFlowMode</span>                   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! whether the water flow through the coil is called</span>
<a name="ln-2930"></a>                                                               <span class="c">! because there is a load on the coil, or not.</span>
<a name="ln-2931"></a>                                                               <span class="c">! Gets updated each iteration</span>
<a name="ln-2932"></a>
<a name="ln-2933"></a><span class="c">! set by parent object and &quot;pushed&quot; to this structure in SetSimpleWSHPData subroutine</span>
<a name="ln-2934"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompanionCoolingCoilNum</span>      <span class="o">=</span><span class="mi">0</span>    <span class="c">! Heating coil companion cooling coil index</span>
<a name="ln-2935"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompanionHeatingCoilNum</span>      <span class="o">=</span><span class="mi">0</span>    <span class="c">! Cooling coil companion heating coil index</span>
<a name="ln-2936"></a>
<a name="ln-2937"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_Rated</span>                      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Nominal Time for Condensate Removal to Begin [s]</span>
<a name="ln-2938"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_Rated</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Ratio of Initial Moisture Evaporation Rate</span>
<a name="ln-2939"></a>                                                   <span class="c">! and Steady-state Latent Capacity</span>
<a name="ln-2940"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-2941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>                  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Heat pump time constant [s]</span>
<a name="ln-2942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>                    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-2943"></a> <span class="k">END TYPE </span><span class="n">SimpleWatertoAirHPConditions</span>
<a name="ln-2944"></a>
<a name="ln-2945"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-2946"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SimpleWatertoAirHPConditions</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SimpleWatertoAirHP</span>
<a name="ln-2947"></a>
<a name="ln-2948"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">NumWatertoAirHPs</span>  <span class="o">=</span> <span class="mi">0</span>        <span class="c">! The Number of Water to Air Heat Pumps found in the Input</span>
<a name="ln-2949"></a><span class="c">!INTEGER        :: WaterIndex = 0                   ! Water index</span>
<a name="ln-2950"></a><span class="c">!INTEGER        :: Count = 0</span>
<a name="ln-2951"></a><span class="kt">LOGICAL</span>        <span class="kd">::</span> <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! Flag set to make sure you get input once</span>
<a name="ln-2952"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>
<a name="ln-2953"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SimpleHPTimeStepFlag</span>  <span class="c">! determines whether the previous operating mode for the coil and it&#39;s partner has been initialized</span>
<a name="ln-2954"></a>
<a name="ln-2955"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Mass flow rate [Kg/s]</span>
<a name="ln-2956"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Inlet Temperature [C]</span>
<a name="ln-2957"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideInletEnth</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source Side Inlet Enthalpy [J/kg]</span>
<a name="ln-2958"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Mass flow rate [Kg/s]</span>
<a name="ln-2959"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletDBTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Inlet Dry Bulb Temp [C]</span>
<a name="ln-2960"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletWBTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Inlet Wet Bulb Temp [C]</span>
<a name="ln-2961"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletHumRat</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Humidity ratio</span>
<a name="ln-2962"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletEnth</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Inlet Enthalpy [J/kg]</span>
<a name="ln-2963"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletDBTemp</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Dry Bulb Temp [C]</span>
<a name="ln-2964"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Humidity ratio</span>
<a name="ln-2965"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletEnth</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Outlet Enthalpy [J/kg]</span>
<a name="ln-2966"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSensible</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load side sensible heat transfer rate [W]</span>
<a name="ln-2967"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoadTotal</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load side total heat transfer rate [W]</span>
<a name="ln-2968"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Latent Capacity [W] rated at entering air conditions [Tdb=26.7C Twb=19.4C]</span>
<a name="ln-2969"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Actual Latent Capacity [W]</span>
<a name="ln-2970"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Source side heat transfer rate [W]</span>
<a name="ln-2971"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Winput</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Power Consumption [W]</span>
<a name="ln-2972"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLRCorrLoadSideMdot</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Load Side Mdot corrected for Part Load Ratio of the unit</span>
<a name="ln-2973"></a>
<a name="ln-2974"></a>          <span class="c">! Subroutine Specifications for the Module</span>
<a name="ln-2975"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a><span class="k">PUBLIC  </span><span class="n">SimWatertoAirHPSimple</span>
<a name="ln-2978"></a>
<a name="ln-2979"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-2980"></a><span class="k">PRIVATE </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-2981"></a>
<a name="ln-2982"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-2983"></a><span class="k">PRIVATE </span><span class="n">InitSimpleWatertoAirHP</span>
<a name="ln-2984"></a><span class="k">PRIVATE </span><span class="n">SizeHVACWaterToAir</span>
<a name="ln-2985"></a>
<a name="ln-2986"></a>          <span class="c">! Algorithms for the module</span>
<a name="ln-2987"></a><span class="k">PRIVATE </span><span class="n">CalcHPCoolingSimple</span>
<a name="ln-2988"></a><span class="k">PRIVATE </span><span class="n">CalcHPHeatingSimple</span>
<a name="ln-2989"></a>
<a name="ln-2990"></a>          <span class="c">! Update routine</span>
<a name="ln-2991"></a><span class="k">PRIVATE </span><span class="n">UpdateSimpleWatertoAirHP</span>
<a name="ln-2992"></a>
<a name="ln-2993"></a>          <span class="c">! Utility routines</span>
<a name="ln-2994"></a><span class="k">PUBLIC  </span><span class="n">GetCoilIndex</span>
<a name="ln-2995"></a><span class="k">PUBLIC  </span><span class="n">GetCoilCapacity</span>
<a name="ln-2996"></a><span class="k">PUBLIC  </span><span class="n">GetCoilInletNode</span>
<a name="ln-2997"></a><span class="k">PUBLIC  </span><span class="n">GetCoilOutletNode</span>
<a name="ln-2998"></a><span class="k">PUBLIC  </span><span class="n">GetCoilAirFlowRate</span>
<a name="ln-2999"></a><span class="k">PUBLIC  </span><span class="n">SetSimpleWSHPData</span>
<a name="ln-3000"></a>
<a name="ln-3001"></a><span class="k">CONTAINS</span>
<a name="ln-3002"></a>
<a name="ln-3003"></a>
<a name="ln-3004"></a>
<a name="ln-3005"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-3006"></a><span class="c">!*************************************************************************</span>
<a name="ln-3007"></a><span class="k">SUBROUTINE </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3008"></a>           <span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3009"></a>           <span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">OnOffAirFlowRat</span><span class="p">)</span>
<a name="ln-3010"></a>
<a name="ln-3011"></a>          <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-3012"></a>          <span class="c">!       DATE WRITTEN   Nov 2003</span>
<a name="ln-3013"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3014"></a>          <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-3015"></a>
<a name="ln-3016"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3017"></a>          <span class="c">! This subroutine manages Simple Water to Air Heat Pump component simulation.</span>
<a name="ln-3018"></a>
<a name="ln-3019"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3020"></a>
<a name="ln-3021"></a>
<a name="ln-3022"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3023"></a>          <span class="c">! (1) Lash.T.A.,1992.Simulation and Analysis of a Water Loop Heat Pump System.</span>
<a name="ln-3024"></a>          <span class="c">! M.S. Thesis, University of Illinois at Urbana Champaign.</span>
<a name="ln-3025"></a>          <span class="c">! (2) Shenoy, Arun. 2004. Simulation, Modeling and Analysis of Water to Air Heat Pump.</span>
<a name="ln-3026"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-3027"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-3028"></a>          <span class="c">! (3) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-3029"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-3030"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-3031"></a>
<a name="ln-3032"></a>
<a name="ln-3033"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3034"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-3035"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-3036"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-3037"></a>
<a name="ln-3038"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3039"></a>
<a name="ln-3040"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3041"></a>
<a name="ln-3042"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>                <span class="c">! Coil Name</span>
<a name="ln-3043"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span>               <span class="c">! Index for Component name</span>
<a name="ln-3044"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SensLoad</span>                <span class="c">! Sensible demand load [W]</span>
<a name="ln-3045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LatentLoad</span>              <span class="c">! Latent demand load [W]</span>
<a name="ln-3046"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CyclingScheme</span>           <span class="c">! Continuous fan OR cycling compressor</span>
<a name="ln-3047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">RuntimeFrac</span>             <span class="c">! Compressor run time fraction  or</span>
<a name="ln-3048"></a>                                                          <span class="c">! percent on-time (on-time/cycle time)</span>
<a name="ln-3049"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>   <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-3050"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HPTimeConstant</span>           <span class="c">! Heat pump time constant [s]</span>
<a name="ln-3051"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FanDelayTime</span>             <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-3052"></a>                                                          <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-3053"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-3054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-3055"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-3056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRat</span>      <span class="c">! ratio of comp on to comp off air flow rate</span>
<a name="ln-3057"></a>
<a name="ln-3058"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3059"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-3060"></a>
<a name="ln-3061"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3062"></a>          <span class="c">! na</span>
<a name="ln-3063"></a>
<a name="ln-3064"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3065"></a>          <span class="c">! na</span>
<a name="ln-3066"></a>
<a name="ln-3067"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3068"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HPNum</span>                       <span class="c">! The WatertoAirHP that you are currently loading input into</span>
<a name="ln-3069"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>           <span class="c">! ratio of comp on to comp off air flow rate</span>
<a name="ln-3070"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterPartLoad</span>               <span class="c">! The part load ratio of water</span>
<a name="ln-3071"></a>
<a name="ln-3072"></a>           <span class="c">! FLOW:</span>
<a name="ln-3073"></a>
<a name="ln-3074"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-3075"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-3076"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-3077"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-3078"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3079"></a>  <span class="k">End If</span>
<a name="ln-3080"></a>
<a name="ln-3081"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3082"></a><span class="k">    </span><span class="n">HPNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span> <span class="p">)</span>
<a name="ln-3083"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HPNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3084"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;WaterToAirHPSimple not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-3085"></a>    <span class="n">ENDIF</span>
<a name="ln-3086"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">HPNum</span>
<a name="ln-3087"></a>  <span class="k">ELSE</span>
<a name="ln-3088"></a><span class="k">    </span><span class="n">HPNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-3089"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HPNum</span> <span class="o">&gt;</span> <span class="n">NumWatertoAirHPs</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">HPNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3090"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWatertoAirHPSimple: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3091"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3092"></a>                          <span class="s1">&#39;, Number of Water to Air HPs=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3093"></a>                          <span class="s1">&#39;, WaterToAir HP name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-3094"></a>    <span class="n">ENDIF</span>
<a name="ln-3095"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompName</span> <span class="o">/=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3096"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWatertoAirHPSimple: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3097"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3098"></a>                          <span class="s1">&#39;, WaterToAir HP name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored WaterToAir HP Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3099"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3100"></a>    <span class="n">ENDIF</span>
<a name="ln-3101"></a>  <span class="n">ENDIF</span>
<a name="ln-3102"></a>
<a name="ln-3103"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">OnOffAirFlowRat</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3104"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRat</span>
<a name="ln-3105"></a>  <span class="k">ELSE</span>
<a name="ln-3106"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3107"></a>  <span class="k">END IF</span>
<a name="ln-3108"></a>
<a name="ln-3109"></a>  <span class="c">! Calculate the Correct Water to Air HP Model with the current HPNum</span>
<a name="ln-3110"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span><span class="p">)</span><span class="o">==</span><span class="n">WaterCycling</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3111"></a><span class="k">    </span><span class="n">WaterPartLoad</span> <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-3112"></a>        <span class="c">!IF (WaterPartLoad &lt; 0.1d0)THEN</span>
<a name="ln-3113"></a>  <span class="c">! WaterPartLoad = 0.1d0</span>
<a name="ln-3114"></a>  <span class="c">!ENDIF</span>
<a name="ln-3115"></a>  <span class="k">ELSE</span>
<a name="ln-3116"></a><span class="k">    </span><span class="n">WaterPartLoad</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3117"></a>  <span class="n">ENDIF</span>
<a name="ln-3118"></a>
<a name="ln-3119"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPCoolingEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3120"></a>    <span class="c">! Cooling mode</span>
<a name="ln-3121"></a>    <span class="k">CALL </span><span class="n">InitSimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3122"></a>                                <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3123"></a>    <span class="k">CALL </span><span class="n">CalcHPCoolingSimple</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3124"></a>                                <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">)</span>
<a name="ln-3125"></a>    <span class="k">CALL </span><span class="n">UpdateSimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-3126"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPHeatingEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3127"></a>    <span class="c">! Heating mode</span>
<a name="ln-3128"></a>    <span class="k">CALL </span><span class="n">InitSimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">constant_zero</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3129"></a>                                <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3130"></a>    <span class="k">CALL </span><span class="n">CalcHPHeatingSimple</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">)</span>
<a name="ln-3131"></a>    <span class="k">CALL </span><span class="n">UpdateSimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-3132"></a>  <span class="k">ELSE</span>
<a name="ln-3133"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimWatertoAirHPSimple: WatertoAir heatpump not in either HEATING or COOLING mode&#39;</span><span class="p">)</span>
<a name="ln-3134"></a>  <span class="n">ENDIF</span>
<a name="ln-3135"></a>
<a name="ln-3136"></a>  <span class="k">RETURN</span>
<a name="ln-3137"></a>
<a name="ln-3138"></a><span class="k">END SUBROUTINE </span><span class="n">SimWatertoAirHPSimple</span>
<a name="ln-3139"></a>
<a name="ln-3140"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-3141"></a><span class="c">!*************************************************************************</span>
<a name="ln-3142"></a>
<a name="ln-3143"></a><span class="k">SUBROUTINE </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-3144"></a>
<a name="ln-3145"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3146"></a>          <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-3147"></a>          <span class="c">!       DATE WRITTEN   Nov 2003</span>
<a name="ln-3148"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3149"></a>          <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-3150"></a>
<a name="ln-3151"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3152"></a>          <span class="c">! Obtains input data for HPs and stores it in HP data structures</span>
<a name="ln-3153"></a>
<a name="ln-3154"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3155"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-3156"></a>
<a name="ln-3157"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3158"></a>          <span class="c">! (1) Lash.T.A.,1992.Simulation and Analysis of a Water loop Heat Pump System.</span>
<a name="ln-3159"></a>          <span class="c">! M.S. Thesis, University of Illinois at Urbana Champaign.</span>
<a name="ln-3160"></a>          <span class="c">! (2) Shenoy, Arun. 2004. Simulation, Modeling and Analysis of Water to Air Heat Pump.</span>
<a name="ln-3161"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-3162"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-3163"></a>          <span class="c">! (3) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-3164"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-3165"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-3166"></a>
<a name="ln-3167"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3168"></a>    <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-3169"></a>    <span class="k">USE </span><span class="n">NodeInputManager</span>
<a name="ln-3170"></a>    <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-3171"></a>    <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-3172"></a>    <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-3173"></a>
<a name="ln-3174"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3175"></a>
<a name="ln-3176"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3177"></a>          <span class="c">! na</span>
<a name="ln-3178"></a>
<a name="ln-3179"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3180"></a>    <span class="kt">CHARACTER</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetSimpleWatertoAirHPInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-3181"></a>
<a name="ln-3182"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3183"></a>          <span class="c">! na</span>
<a name="ln-3184"></a>
<a name="ln-3185"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3186"></a>          <span class="c">! na</span>
<a name="ln-3187"></a>
<a name="ln-3188"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3189"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HPNum</span>                    <span class="c">! The Water to Air HP that you are currently loading input into</span>
<a name="ln-3190"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCool</span>                  <span class="c">! Counter for cooling coil</span>
<a name="ln-3191"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHeat</span>                  <span class="c">! Counter for heating coil</span>
<a name="ln-3192"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WatertoAirHPNum</span>          <span class="c">! Counter</span>
<a name="ln-3193"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>                <span class="c">! Number of variables in String format</span>
<a name="ln-3194"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>                  <span class="c">! Number of variables in Numeric format</span>
<a name="ln-3195"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumParams</span>                <span class="c">! Total number of input fields</span>
<a name="ln-3196"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>                <span class="c">! Maximum number of numeric input fields</span>
<a name="ln-3197"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>              <span class="c">! Maximum number of alpha input fields</span>
<a name="ln-3198"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-3199"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>     <span class="c">! If errors detected in input</span>
<a name="ln-3200"></a>    <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>             <span class="c">! Flag to verify name</span>
<a name="ln-3201"></a>    <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>             <span class="c">! Flag for blank name</span>
<a name="ln-3202"></a>    <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-3203"></a>    <span class="kt">CHARACTER</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CurrentModuleObject</span>     <span class="c">! for ease in getting objects</span>
<a name="ln-3204"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">AlphArray</span>      <span class="c">! Alpha input items for object</span>
<a name="ln-3205"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-3206"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-3207"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NumArray</span>          <span class="c">! Numeric input items for object</span>
<a name="ln-3208"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>      <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-3209"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>    <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-3210"></a>
<a name="ln-3211"></a>    <span class="n">NumCool</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:EquationFit&#39;</span><span class="p">)</span>
<a name="ln-3212"></a>    <span class="n">NumHeat</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:EquationFit&#39;</span><span class="p">)</span>
<a name="ln-3213"></a>    <span class="n">NumWatertoAirHPs</span> <span class="o">=</span> <span class="n">NumCool</span><span class="o">+</span><span class="n">NumHeat</span>
<a name="ln-3214"></a>    <span class="n">HPNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3215"></a>
<a name="ln-3216"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3217"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No Equipment found in SimWatertoAirHPSimple&#39;</span><span class="p">)</span>
<a name="ln-3218"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3219"></a>    <span class="k">END IF</span>
<a name="ln-3220"></a>
<a name="ln-3221"></a>   <span class="c">! Allocate Arrays</span>
<a name="ln-3222"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3223"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-3224"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-3225"></a>      <span class="n">SimpleHPTimeStepFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3226"></a>    <span class="n">ENDIF</span>
<a name="ln-3227"></a>
<a name="ln-3228"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:EquationFit&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-3229"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-3230"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-3231"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:EquationFit&#39;</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-3232"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-3233"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-3234"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-3235"></a>    <span class="n">AlphArray</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-3236"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-3237"></a>    <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-3238"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-3239"></a>    <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3240"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-3241"></a>    <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-3242"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-3243"></a>    <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3244"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-3245"></a>    <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3246"></a>
<a name="ln-3247"></a>
<a name="ln-3248"></a>      <span class="c">! Get the data for cooling coil</span>
<a name="ln-3249"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:EquationFit&#39;</span>
<a name="ln-3250"></a>
<a name="ln-3251"></a>    <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCool</span>
<a name="ln-3252"></a>
<a name="ln-3253"></a>        <span class="n">HPNum</span><span class="o">=</span> <span class="n">HPNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3254"></a>
<a name="ln-3255"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">HPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3256"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3257"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3258"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-3259"></a>
<a name="ln-3260"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3261"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3262"></a>
<a name="ln-3263"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleWatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">HPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3264"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3265"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3266"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3267"></a>        <span class="n">ENDIF</span>
<a name="ln-3268"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3269"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3270"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3271"></a>        <span class="n">ENDIF</span>
<a name="ln-3272"></a>
<a name="ln-3273"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3274"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span>  <span class="o">=</span> <span class="s1">&#39;COOLING&#39;</span>
<a name="ln-3275"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span>  <span class="o">=</span> <span class="n">TypeOf_CoilWAHPCoolingEquationFit</span>
<a name="ln-3276"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3277"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3278"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3279"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3280"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCOPCool</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3281"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap1</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3282"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap2</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3283"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap3</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3284"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap4</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3285"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap5</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3286"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap1</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3287"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap2</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3288"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap3</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3289"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap4</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3290"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap5</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-3291"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap6</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-3292"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower1</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-3293"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower2</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-3294"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower3</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3295"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower4</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3296"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower5</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-3297"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-3298"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-3299"></a>
<a name="ln-3300"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3301"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3302"></a>                                   <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3303"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3304"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3305"></a>                                   <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3306"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3307"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3308"></a>                                   <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3309"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3310"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3311"></a>                                   <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3312"></a>
<a name="ln-3313"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-3314"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-3315"></a>
<a name="ln-3316"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3317"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3318"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-3319"></a>
<a name="ln-3320"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3321"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3322"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-3323"></a>
<a name="ln-3324"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3325"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3326"></a>
<a name="ln-3327"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3328"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3329"></a>
<a name="ln-3330"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3331"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3332"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPCOOLINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-3333"></a>
<a name="ln-3334"></a>        <span class="c">!create predefined report entries</span>
<a name="ln-3335"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilType</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-3336"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3337"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-3338"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-3339"></a>                                 <span class="o">-</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-3340"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">&amp;</span>
<a name="ln-3341"></a>                                 <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3342"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span> <span class="p">&amp;</span>
<a name="ln-3343"></a>                                 <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-3344"></a>
<a name="ln-3345"></a>   <span class="k">END DO</span>
<a name="ln-3346"></a>
<a name="ln-3347"></a>      <span class="c">! Get the data for heating coil</span>
<a name="ln-3348"></a>   <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:EquationFit&#39;</span>
<a name="ln-3349"></a>
<a name="ln-3350"></a>   <span class="k">DO </span><span class="n">WatertoAirHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeat</span>
<a name="ln-3351"></a>
<a name="ln-3352"></a>        <span class="n">HPNum</span><span class="o">=</span> <span class="n">HPNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3353"></a>
<a name="ln-3354"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">WatertoAirHPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3355"></a>                           <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3356"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3357"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-3358"></a>
<a name="ln-3359"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3360"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3361"></a>
<a name="ln-3362"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleWatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">HPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3363"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3364"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3365"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3366"></a>        <span class="n">ENDIF</span>
<a name="ln-3367"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3368"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3369"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3370"></a>        <span class="n">ENDIF</span>
<a name="ln-3371"></a>
<a name="ln-3372"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3373"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span>  <span class="o">=</span> <span class="s1">&#39;HEATING&#39;</span>
<a name="ln-3374"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span>  <span class="o">=</span> <span class="n">TypeOf_CoilWAHPHeatingEquationFit</span>
<a name="ln-3375"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3376"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3377"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3378"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCOPHeat</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3379"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap1</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3380"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap2</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3381"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap3</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3382"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap4</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3383"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap5</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3384"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower1</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3385"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower2</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3386"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower3</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3387"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower4</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3388"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower5</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3389"></a>
<a name="ln-3390"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3391"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3392"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3393"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3394"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3395"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3396"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3397"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3398"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3399"></a>        <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3400"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3401"></a>                         <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3402"></a>
<a name="ln-3403"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-3404"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-3405"></a>
<a name="ln-3406"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3407"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3408"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-3409"></a>
<a name="ln-3410"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3411"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3412"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-3413"></a>
<a name="ln-3414"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3415"></a>             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Summed&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3416"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPHEATINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-3417"></a>
<a name="ln-3418"></a>        <span class="c">!create predefined report entries</span>
<a name="ln-3419"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilType</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-3420"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-3421"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                                 <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-3423"></a>
<a name="ln-3424"></a>   <span class="k">END DO</span>
<a name="ln-3425"></a>
<a name="ln-3426"></a><span class="k">  DEALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">)</span>
<a name="ln-3427"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">)</span>
<a name="ln-3428"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-3429"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-3430"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-3431"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-3432"></a>
<a name="ln-3433"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3434"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found getting input. Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-3435"></a>  <span class="n">ENDIF</span>
<a name="ln-3436"></a>
<a name="ln-3437"></a>  <span class="k">DO </span><span class="n">HPNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span>
<a name="ln-3438"></a>
<a name="ln-3439"></a>    <span class="k">IF</span> <span class="p">(</span>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span> <span class="n">TypeOf_CoilWAHPCoolingEquationFit</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3440"></a>          <span class="c">! COOLING COIL  Setup Report variables for the Heat Pump</span>
<a name="ln-3441"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3442"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3443"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3444"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3445"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3446"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3447"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3448"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3449"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3450"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3451"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3452"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3453"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3454"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3455"></a>
<a name="ln-3456"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3457"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3458"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3459"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3460"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3461"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3462"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3463"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3464"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3465"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3466"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3467"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3468"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3469"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3470"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3471"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3472"></a>
<a name="ln-3473"></a>    <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span> <span class="n">TypeOf_CoilWAHPHeatingEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3474"></a>          <span class="c">! HEATING COIL Setup Report variables for the Heat Pump</span>
<a name="ln-3475"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3476"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3477"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3478"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3479"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Sensible Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3480"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3481"></a>
<a name="ln-3482"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3483"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3484"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3485"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3486"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3487"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3488"></a>
<a name="ln-3489"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3490"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3491"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3492"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3493"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Inlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3494"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3495"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3496"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3497"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Air Outlet Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3498"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3499"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3500"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3501"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3502"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3503"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3504"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3505"></a>
<a name="ln-3506"></a>    <span class="n">ENDIF</span>
<a name="ln-3507"></a>
<a name="ln-3508"></a>
<a name="ln-3509"></a>
<a name="ln-3510"></a>   <span class="k">END DO</span>
<a name="ln-3511"></a>
<a name="ln-3512"></a><span class="k">  RETURN</span>
<a name="ln-3513"></a>
<a name="ln-3514"></a><span class="k">END SUBROUTINE </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-3515"></a>
<a name="ln-3516"></a> <span class="c">! Beginning Initialization Section of the Module</span>
<a name="ln-3517"></a><span class="c">!******************************************************************************</span>
<a name="ln-3518"></a>
<a name="ln-3519"></a><span class="k">SUBROUTINE </span><span class="n">InitSimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">FanDelayTime</span><span class="p">,</span><span class="n">SensLoad</span><span class="p">,</span><span class="n">LatentLoad</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3520"></a>                                  <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3521"></a>
<a name="ln-3522"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3523"></a>          <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-3524"></a>          <span class="c">!       DATE WRITTEN   Nov 2003</span>
<a name="ln-3525"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3526"></a>          <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-3527"></a>
<a name="ln-3528"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3529"></a>          <span class="c">! This subroutine is for initializations of the Simple Water to Air HP Components.</span>
<a name="ln-3530"></a>
<a name="ln-3531"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3532"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-3533"></a>
<a name="ln-3534"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3535"></a>
<a name="ln-3536"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3537"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span>  <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-3538"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysSizingCalc</span>
<a name="ln-3539"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3540"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-3541"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-3542"></a>
<a name="ln-3543"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3544"></a>
<a name="ln-3545"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3546"></a>
<a name="ln-3547"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>                 <span class="c">! Current HPNum under simulation</span>
<a name="ln-3548"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span> <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-3549"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>        <span class="c">! Heat pump time constant [s]</span>
<a name="ln-3550"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>          <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-3551"></a>                                               <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-3552"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensLoad</span>              <span class="c">! Control zone sensible load[W]</span>
<a name="ln-3553"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentLoad</span>            <span class="c">! Control zone latent load[W]</span>
<a name="ln-3554"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>         <span class="c">! fan operating mode</span>
<a name="ln-3555"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>     <span class="c">! ratio of compressor on flow to average flow over time step</span>
<a name="ln-3556"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterPartLoad</span>
<a name="ln-3557"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! Iteration flag</span>
<a name="ln-3558"></a>
<a name="ln-3559"></a>
<a name="ln-3560"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3561"></a>          <span class="c">! na</span>
<a name="ln-3562"></a>
<a name="ln-3563"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3564"></a>          <span class="c">! na</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3567"></a>          <span class="c">! na</span>
<a name="ln-3568"></a>
<a name="ln-3569"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3570"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">AirInletNode</span>        <span class="c">! Node Number of the air inlet</span>
<a name="ln-3571"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">WaterInletNode</span>      <span class="c">! Node Number of the Water inlet</span>
<a name="ln-3572"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time allocation flag</span>
<a name="ln-3573"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! used for initializations each begin environment flag</span>
<a name="ln-3574"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>  <span class="c">! used for sizing PTHP inputs one time</span>
<a name="ln-3575"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-3576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-3577"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Cp</span>  <span class="c">! local fluid specific heat</span>
<a name="ln-3578"></a>  <span class="kt">LOGICAL</span>     <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-3579"></a>
<a name="ln-3580"></a>
<a name="ln-3581"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3582"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-3583"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-3584"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-3585"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">))</span>
<a name="ln-3586"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3587"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3588"></a>    <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3589"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3590"></a>
<a name="ln-3591"></a>  <span class="k">END IF</span>
<a name="ln-3592"></a>
<a name="ln-3593"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3594"></a><span class="k">    </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3595"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3596"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3597"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3598"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3599"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3600"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3601"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-3602"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3603"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitSimpleWatertoAirHP: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-3604"></a>    <span class="n">ENDIF</span>
<a name="ln-3605"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3606"></a>  <span class="n">ENDIF</span>
<a name="ln-3607"></a>
<a name="ln-3608"></a>
<a name="ln-3609"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3610"></a>    <span class="c">! for each furnace, do the sizing once.</span>
<a name="ln-3611"></a>    <span class="k">CALL </span><span class="n">SizeHVACWaterToAir</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-3612"></a>
<a name="ln-3613"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3614"></a>
<a name="ln-3615"></a>  <span class="k">END IF</span>
<a name="ln-3616"></a>
<a name="ln-3617"></a><span class="k">  IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3618"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3619"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPCoolingEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3620"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3621"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3622"></a><span class="k">            </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Cooling</span>
<a name="ln-3623"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Cooling</span>
<a name="ln-3624"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3625"></a><span class="k">            </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Heating</span>
<a name="ln-3626"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Heating</span>
<a name="ln-3627"></a>          <span class="k">END IF</span>
<a name="ln-3628"></a><span class="k">          </span><span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3629"></a>        <span class="k">ELSE</span>
<a name="ln-3630"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3631"></a><span class="k">            </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Cooling</span>
<a name="ln-3632"></a>          <span class="n">ENDIF</span>
<a name="ln-3633"></a>        <span class="n">ENDIF</span>
<a name="ln-3634"></a>        <span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3635"></a>      <span class="k">ELSE</span>
<a name="ln-3636"></a>        <span class="c">! it is a heating coil</span>
<a name="ln-3637"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3638"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3639"></a><span class="k">            </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Heating</span>
<a name="ln-3640"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Heating</span>
<a name="ln-3641"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3642"></a><span class="k">            </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Cooling</span>
<a name="ln-3643"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Cooling</span>
<a name="ln-3644"></a>          <span class="k">END IF</span>
<a name="ln-3645"></a><span class="k">          </span><span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3646"></a>        <span class="k">ELSE</span>
<a name="ln-3647"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3648"></a><span class="k">            </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span> <span class="o">=</span> <span class="n">Heating</span>
<a name="ln-3649"></a>          <span class="n">ENDIF</span>
<a name="ln-3650"></a>        <span class="n">ENDIF</span>
<a name="ln-3651"></a>        <span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3652"></a>      <span class="k">END IF</span>
<a name="ln-3653"></a><span class="k">    END IF</span>
<a name="ln-3654"></a><span class="k">  ELSE</span>
<a name="ln-3655"></a><span class="k">    </span><span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3656"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPCoolingEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3657"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3658"></a>      <span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3659"></a>    <span class="k">ELSE</span>
<a name="ln-3660"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3661"></a>      <span class="n">SimpleHPTimeStepFlag</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3662"></a>    <span class="k">END IF</span>
<a name="ln-3663"></a><span class="k">  END IF</span>
<a name="ln-3664"></a>
<a name="ln-3665"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-3666"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3667"></a>      <span class="c">! Do the initializations to start simulation</span>
<a name="ln-3668"></a>
<a name="ln-3669"></a>    <span class="n">AirInletNode</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-3670"></a>    <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-3671"></a>
<a name="ln-3672"></a>    <span class="c">!Initialize all report variables to a known state at beginning of simulation</span>
<a name="ln-3673"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirVolFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3674"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3675"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3676"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3677"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3678"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterVolFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3679"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3680"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3681"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3682"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3683"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3684"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3685"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3686"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3687"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3688"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3689"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3690"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3691"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3692"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3693"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3694"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3695"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3696"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3697"></a>
<a name="ln-3698"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3699"></a>                              <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3700"></a>                              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3701"></a>                              <span class="s1">&#39;InitSimpleWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-3702"></a>    <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3703"></a>                              <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3704"></a>                              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3705"></a>                              <span class="s1">&#39;InitSimpleWatertoAirHP&#39;</span><span class="p">)</span>
<a name="ln-3706"></a>
<a name="ln-3707"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3708"></a>                             <span class="n">rho</span> <span class="o">*</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span>
<a name="ln-3709"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">=</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-3710"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="o">=</span><span class="n">HPTimeConstant</span>
<a name="ln-3711"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="o">=</span><span class="n">FanDelayTime</span>
<a name="ln-3712"></a>
<a name="ln-3713"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3714"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3715"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3716"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3717"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3718"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3719"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-3720"></a>
<a name="ln-3721"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-3722"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3723"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3724"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3725"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3726"></a>
<a name="ln-3727"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-3728"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3729"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3730"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3731"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3732"></a>
<a name="ln-3733"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3734"></a>
<a name="ln-3735"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3736"></a>
<a name="ln-3737"></a>  <span class="k">END IF</span>  <span class="c">! End If for the Begin Environment initializations</span>
<a name="ln-3738"></a>
<a name="ln-3739"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3740"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3741"></a>  <span class="n">ENDIF</span>
<a name="ln-3742"></a>
<a name="ln-3743"></a>  <span class="c">! Do the following initializations (every time step): This should be the info from</span>
<a name="ln-3744"></a>  <span class="c">! the previous components outlets or the node data in this section.</span>
<a name="ln-3745"></a>  <span class="c">! First set the conditions for the air into the heat pump model</span>
<a name="ln-3746"></a>
<a name="ln-3747"></a>  <span class="c">! Set water and air inlet nodes</span>
<a name="ln-3748"></a>
<a name="ln-3749"></a>  <span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-3750"></a>  <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-3751"></a>
<a name="ln-3752"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SensLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LatentLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3753"></a>
<a name="ln-3754"></a>   <span class="c">! changed the water mass flow rate to be equal to the design times run time fraction in order to account for</span>
<a name="ln-3755"></a>   <span class="c">! cycling of equipment</span>
<a name="ln-3756"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="o">*</span><span class="n">WaterPartLoad</span>
<a name="ln-3757"></a>
<a name="ln-3758"></a><span class="c">!    SimpleWatertoAirHP(HPNum)%WaterMassFlowRate =    SimpleWatertoAirHP(HPNum)%DesignWaterMassFlowRate</span>
<a name="ln-3759"></a>
<a name="ln-3760"></a><span class="c">! Model requires the values to be calculated at full design flow rate for air and then scaled to part load ratio.</span>
<a name="ln-3761"></a><span class="c">! So always start the calculations by setting the air flow rate to design flow rate.</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a><span class="c">!    SimpleWatertoAirHP(HPNum)%AirMassFlowRate   = Node(AirInletNode)%MassFlowRate</span>
<a name="ln-3764"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3765"></a>             <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>
<a name="ln-3766"></a>    <span class="c">!If air flow is less than 25% rated flow. Then set air flow to the 25% of rated conditions</span>
<a name="ln-3767"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3768"></a>         <span class="mf">0.25d0</span><span class="o">*</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3769"></a>             <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3770"></a><span class="k">        </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3771"></a>          <span class="mf">0.25d0</span><span class="o">*</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3772"></a>              <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>
<a name="ln-3773"></a>    <span class="k">END IF</span>
<a name="ln-3774"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3775"></a>  <span class="k">ELSE</span> <span class="c">!heat pump is off</span>
<a name="ln-3776"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowMode</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3777"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3778"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3779"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span><span class="p">)</span><span class="o">==</span><span class="n">WaterConstant</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3780"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPCoolingEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3781"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3782"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3783"></a>            <span class="c">! do nothing, there will be flow through this coil</span>
<a name="ln-3784"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span><span class="o">==</span><span class="n">Cooling</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3785"></a>            <span class="c">! set the flow rate to full design flow</span>
<a name="ln-3786"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-3787"></a>          <span class="k">END IF</span>
<a name="ln-3788"></a><span class="k">        ELSE</span>
<a name="ln-3789"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span><span class="o">==</span><span class="n">Cooling</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3790"></a>            <span class="c">! set the flow rate to full design flow</span>
<a name="ln-3791"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-3792"></a>          <span class="k">END IF</span>
<a name="ln-3793"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3794"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WAHPPlantTypeOfNum</span><span class="o">==</span><span class="n">TypeOf_CoilWAHPHeatingEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3795"></a>        <span class="c">! It&#39;s a heating coil</span>
<a name="ln-3796"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3797"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">QLoadTotal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3798"></a>            <span class="c">! do nothing, there will be flow through this coil</span>
<a name="ln-3799"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span><span class="o">==</span><span class="n">Heating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3800"></a>            <span class="c">! set the flow rate to full design flow</span>
<a name="ln-3801"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-3802"></a>          <span class="k">END IF</span>
<a name="ln-3803"></a><span class="k">        ELSE</span>
<a name="ln-3804"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LastOperatingMode</span><span class="o">==</span><span class="n">Heating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3805"></a>            <span class="c">! set the flow rate to full design flow</span>
<a name="ln-3806"></a>            <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span>
<a name="ln-3807"></a>          <span class="k">END IF</span>
<a name="ln-3808"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3809"></a>      <span class="k">END IF</span>
<a name="ln-3810"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-3811"></a>  <span class="n">ENDIF</span>
<a name="ln-3812"></a>
<a name="ln-3813"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3814"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3815"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3816"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3817"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3818"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3819"></a>                                 <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-3820"></a>
<a name="ln-3821"></a>
<a name="ln-3822"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3823"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3824"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-3825"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3826"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-3827"></a>
<a name="ln-3828"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">=</span> <span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-3829"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>       <span class="o">=</span> <span class="n">HPTimeConstant</span>
<a name="ln-3830"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanDelayTime</span>         <span class="o">=</span> <span class="n">FanDelayTime</span>
<a name="ln-3831"></a>
<a name="ln-3832"></a>   <span class="c">! Outlet variables</span>
<a name="ln-3833"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3834"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3835"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3836"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3837"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3838"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3839"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3840"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3841"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3842"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3843"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3844"></a>
<a name="ln-3845"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3846"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3847"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3848"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3849"></a>   <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3850"></a>
<a name="ln-3851"></a>  <span class="k">RETURN</span>
<a name="ln-3852"></a>
<a name="ln-3853"></a><span class="k">END SUBROUTINE </span><span class="n">InitSimpleWatertoAirHP</span>
<a name="ln-3854"></a>
<a name="ln-3855"></a><span class="k">SUBROUTINE </span><span class="n">SizeHVACWaterToAir</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-3856"></a>
<a name="ln-3857"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3858"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-3859"></a>          <span class="c">!       DATE WRITTEN   June 2009</span>
<a name="ln-3860"></a>          <span class="c">!       MODIFIED       August 2013 Daeho Kang, add component sizing table entries</span>
<a name="ln-3861"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3862"></a>
<a name="ln-3863"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3864"></a>          <span class="c">! This subroutine is for sizing WSHP Components for which nominal capacities</span>
<a name="ln-3865"></a>          <span class="c">! and flow rates have not been specified in the input</span>
<a name="ln-3866"></a>
<a name="ln-3867"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3868"></a>          <span class="c">! Obtains heating capacities and flow rates from the zone or system sizing arrays.</span>
<a name="ln-3869"></a>          <span class="c">!</span>
<a name="ln-3870"></a>          <span class="c">! NOTE: For WSHP&#39;s we are sizing the heating capacity to be</span>
<a name="ln-3871"></a>          <span class="c">! equal to the cooling capacity.  Thus the cooling and</span>
<a name="ln-3872"></a>          <span class="c">! and heating capacities of a DX heat pump system will be identical. In real life the ARI</span>
<a name="ln-3873"></a>          <span class="c">! heating and cooling capacities are close but not identical.</span>
<a name="ln-3874"></a>
<a name="ln-3875"></a>
<a name="ln-3876"></a>
<a name="ln-3877"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3878"></a>          <span class="c">! na</span>
<a name="ln-3879"></a>
<a name="ln-3880"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3881"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-3882"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">MyPlantSizingIndex</span>
<a name="ln-3883"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallAirVolFlow</span><span class="p">,</span> <span class="n">SmallLoad</span>
<a name="ln-3884"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-3885"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-3886"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-3887"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-3888"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-3889"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3890"></a>
<a name="ln-3891"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3892"></a>
<a name="ln-3893"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3894"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>
<a name="ln-3895"></a>
<a name="ln-3896"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3897"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SizeWaterToAirCoil&#39;</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3900"></a>          <span class="c">! na</span>
<a name="ln-3901"></a>
<a name="ln-3902"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3903"></a>          <span class="c">! na</span>
<a name="ln-3904"></a>
<a name="ln-3905"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoair</span>
<a name="ln-3907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>
<a name="ln-3908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixTemp</span>
<a name="ln-3909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixHumRat</span>
<a name="ln-3910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixEnth</span>
<a name="ln-3911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixWetBulb</span>
<a name="ln-3912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupTemp</span>
<a name="ln-3913"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHumRat</span>
<a name="ln-3914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupEnth</span>
<a name="ln-3915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutTemp</span>
<a name="ln-3916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTDB</span>
<a name="ln-3917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTWB</span>
<a name="ln-3918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTS</span>
<a name="ln-3919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutAirFrac</span>
<a name="ln-3920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowRate</span>
<a name="ln-3921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-3922"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3923"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapAtPeak</span>
<a name="ln-3924"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapTempModFac</span>
<a name="ln-3925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff1</span>         <span class="c">! 1st coefficient of the total cooling capacity performance curve</span>
<a name="ln-3926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff2</span>         <span class="c">! 2nd coefficient of the total cooling capacity performance curve</span>
<a name="ln-3927"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff3</span>         <span class="c">! 3rd coefficient of the total cooling capacity performance curve</span>
<a name="ln-3928"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff4</span>         <span class="c">! 4th coefficient of the total cooling capacity performance curve</span>
<a name="ln-3929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff5</span>         <span class="c">! 5th coefficient of the total cooling capacity performance curve</span>
<a name="ln-3930"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff1</span>          <span class="c">! 1st coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-3931"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff2</span>          <span class="c">! 2nd coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-3932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff3</span>          <span class="c">! 3rd coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-3933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff4</span>          <span class="c">! 4th coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-3934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff5</span>          <span class="c">! 5th coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-3935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff6</span>          <span class="c">! 6th coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-3936"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TimeStepNumAtMax</span>
<a name="ln-3937"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DDNum</span>
<a name="ln-3938"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PltSizNum</span>
<a name="ln-3939"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedCapCoolTotalAutosized</span>
<a name="ln-3940"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedCapCoolSensAutosized</span>
<a name="ln-3941"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-3942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SystemCapacity</span>
<a name="ln-3943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-3944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cp</span>
<a name="ln-3945"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">IsAutosize</span>                <span class="c">! Indicator to autosize</span>
<a name="ln-3946"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HardSizeNoDesRun</span>          <span class="c">! Indicator to hardsize and no sizing run</span>
<a name="ln-3947"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateDes</span>    <span class="c">! Autosized rated air flow for reporting</span>
<a name="ln-3948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateUser</span>   <span class="c">! Hardsized rated air flow for reporting</span>
<a name="ln-3949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolTotalDes</span>      <span class="c">! Autosized rated cooling capacity for reporting</span>
<a name="ln-3950"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolTotalUser</span>     <span class="c">! Hardsized rated cooling capacity for reporting</span>
<a name="ln-3951"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolSensDes</span>       <span class="c">! Autosized rated sensible cooling capacity for reporting</span>
<a name="ln-3952"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapCoolSensUser</span>      <span class="c">! Hardsized rated sensible cooling capacity for reporting</span>
<a name="ln-3953"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapHeatDes</span>           <span class="c">! Autosized rated heating capacity for reporting</span>
<a name="ln-3954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCapHeatUser</span>          <span class="c">! Hardsized rated heating capacity for reporting</span>
<a name="ln-3955"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterVolFlowRateDes</span>  <span class="c">! Autosized rated water flow rate for reporting</span>
<a name="ln-3956"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedWaterVolFlowRateUser</span> <span class="c">! Hardsized rated water flow rate for reporting</span>
<a name="ln-3957"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisAirSys</span>            <span class="c">! true if a particular air system had a Sizing:System object and system sizing done</span>
<a name="ln-3958"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisZone</span>              <span class="c">! true if a particular zone had a Sizing:Zone object and zone sizing was done</span>
<a name="ln-3959"></a>
<a name="ln-3960"></a>  <span class="n">PltSizNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3961"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3962"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3963"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SysSizingRunDone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3964"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3965"></a>  <span class="k">ELSE</span>
<a name="ln-3966"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3967"></a>  <span class="n">ENDIF</span>
<a name="ln-3968"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3969"></a><span class="k">    CALL </span><span class="n">CheckThisAirSystemForSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">,</span> <span class="n">SizingDesRunThisAirSys</span> <span class="p">)</span>
<a name="ln-3970"></a>  <span class="k">ELSE</span>
<a name="ln-3971"></a><span class="k">    </span><span class="n">SizingDesRunThisAirSys</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3972"></a>  <span class="n">ENDIF</span>
<a name="ln-3973"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3974"></a><span class="k">    CALL </span><span class="n">CheckThisZoneForSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">,</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span>
<a name="ln-3975"></a>  <span class="k">ELSE</span>
<a name="ln-3976"></a><span class="k">    </span><span class="n">SizingDesRunThisZone</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3977"></a>  <span class="n">ENDIF</span>
<a name="ln-3978"></a>  <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3979"></a>  <span class="n">RatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3980"></a>  <span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3981"></a>  <span class="n">RatedCapCoolTotalUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3982"></a>  <span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3983"></a>  <span class="n">RatedCapCoolSensUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3984"></a>  <span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3985"></a>  <span class="n">RatedCapHeatUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3986"></a>  <span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3987"></a>  <span class="n">RatedWaterVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3988"></a>
<a name="ln-3989"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3990"></a><span class="k">    </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3991"></a>  <span class="k">END IF</span>
<a name="ln-3992"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3993"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-3994"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3995"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3996"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3997"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3998"></a>                            <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3999"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">)</span>
<a name="ln-4000"></a>      <span class="k">END IF</span>
<a name="ln-4001"></a><span class="k">    ELSE</span>
<a name="ln-4002"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4003"></a>                          <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4004"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4005"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-4006"></a>      <span class="k">ELSE</span>
<a name="ln-4007"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4008"></a>      <span class="k">END IF</span>
<a name="ln-4009"></a><span class="k">    END IF</span>
<a name="ln-4010"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4011"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-4012"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4013"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4014"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4015"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4016"></a>                            <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4017"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">)</span>
<a name="ln-4018"></a>      <span class="k">END IF</span>
<a name="ln-4019"></a><span class="k">    ELSE</span>
<a name="ln-4020"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4021"></a>                          <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4022"></a>      <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4023"></a>                                            <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-4024"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4025"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4026"></a>      <span class="k">END IF</span>
<a name="ln-4027"></a><span class="k">    END IF</span>
<a name="ln-4028"></a><span class="k">  END IF</span>
<a name="ln-4029"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4030"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4031"></a><span class="k">      </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span>
<a name="ln-4032"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4033"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4034"></a>                            <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4035"></a>                             <span class="n">RatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-4036"></a>    <span class="k">ELSE</span>
<a name="ln-4037"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-4038"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4039"></a><span class="k">        </span><span class="n">RatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-4040"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4041"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4042"></a>                            <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4043"></a>                             <span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4044"></a>                            <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4045"></a>                             <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-4046"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4047"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4048"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeHVACWaterToAir: Potential issue with equipment sizing for coil &#39;</span> <span class="p">&amp;</span>
<a name="ln-4049"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4050"></a>                                  <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4051"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Air Volume Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4052"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-4053"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Air Volume Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4054"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-4055"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-4056"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-4057"></a>          <span class="k">END IF</span>
<a name="ln-4058"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4059"></a>      <span class="k">END IF</span>
<a name="ln-4060"></a><span class="k">    END IF</span>
<a name="ln-4061"></a><span class="k">  END IF</span>
<a name="ln-4062"></a>
<a name="ln-4063"></a><span class="k">  </span><span class="n">RatedCapCoolTotalAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4064"></a>  <span class="n">RatedCapCoolSensAutosized</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4065"></a>
<a name="ln-4066"></a><span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4067"></a><span class="c">! size rated total cooling capacity</span>
<a name="ln-4068"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4069"></a>      <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4070"></a><span class="k">    </span><span class="n">RatedCapCoolTotalAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4071"></a>  <span class="k">END IF</span>
<a name="ln-4072"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4073"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4074"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedCapCoolTotalAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-4075"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4076"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4077"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4078"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4079"></a>                            <span class="s1">&#39;User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4080"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-4081"></a>      <span class="k">END IF</span>
<a name="ln-4082"></a><span class="k">    ELSE</span>
<a name="ln-4083"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4084"></a>                          <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4085"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-4086"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4087"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-4088"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-4089"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-4090"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-4091"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-4092"></a>        <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-4093"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-4094"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-4095"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-4096"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-4097"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-4098"></a>          <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-4099"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4100"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-4101"></a>            <span class="k">ELSE</span>
<a name="ln-4102"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4103"></a>            <span class="k">END IF</span>
<a name="ln-4104"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-4105"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4106"></a>                        <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-4107"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4108"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-4109"></a>          <span class="k">END IF</span>
<a name="ln-4110"></a><span class="k">        END IF</span>
<a name="ln-4111"></a><span class="k">        </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-4112"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4113"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4114"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4115"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4116"></a>        <span class="n">TotalCapCoeff1</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap1</span>
<a name="ln-4117"></a>        <span class="n">TotalCapCoeff2</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap2</span>
<a name="ln-4118"></a>        <span class="n">TotalCapCoeff3</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap3</span>
<a name="ln-4119"></a>        <span class="n">TotalCapCoeff4</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap4</span>
<a name="ln-4120"></a>        <span class="n">TotalCapCoeff5</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap5</span>
<a name="ln-4121"></a>        <span class="n">ratioTWB</span>         <span class="o">=</span> <span class="p">(</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4122"></a>        <span class="c">! rated condenser water inlet temperature of 85F</span>
<a name="ln-4123"></a>        <span class="n">ratioTS</span>          <span class="o">=</span> <span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span><span class="p">)</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4124"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">TotalCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">TotalCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">TotalCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4125"></a>                             <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">TotalCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">TotalCapCoeff5</span><span class="p">)</span>
<a name="ln-4126"></a><span class="c">!       The mixed air temp for zone equipment without an OA mixer is 0.</span>
<a name="ln-4127"></a><span class="c">!       This test avoids a negative capacity until a solution can be found.</span>
<a name="ln-4128"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MixEnth</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SupEnth</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4129"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-4130"></a>        <span class="k">ELSE</span>
<a name="ln-4131"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4800</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-4132"></a>        <span class="k">END IF</span>
<a name="ln-4133"></a><span class="k">        </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">CoolCapAtPeak</span><span class="p">)</span>
<a name="ln-4134"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4135"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-4136"></a>        <span class="k">ELSE</span>
<a name="ln-4137"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-4138"></a>        <span class="k">END IF</span>
<a name="ln-4139"></a><span class="k">      ELSE</span>
<a name="ln-4140"></a><span class="k">        </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4141"></a>      <span class="k">END IF</span>
<a name="ln-4142"></a><span class="k">    END IF</span>
<a name="ln-4143"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4144"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedCapCoolTotalAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-4145"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4146"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4147"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4148"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4149"></a>                            <span class="s1">&#39;User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4150"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-4151"></a>      <span class="k">END IF</span>
<a name="ln-4152"></a><span class="k">    ELSE</span>
<a name="ln-4153"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4154"></a>                          <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4155"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-4156"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4157"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4158"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4159"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-4160"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-4161"></a>          <span class="k">ELSE</span>
<a name="ln-4162"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-4163"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-4164"></a>          <span class="k">END IF</span>
<a name="ln-4165"></a><span class="k">        ELSE</span>
<a name="ln-4166"></a><span class="k">          </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-4167"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-4168"></a>        <span class="k">END IF</span>
<a name="ln-4169"></a><span class="k">        </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-4170"></a>        <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-4171"></a>        <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-4172"></a>        <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-4173"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4174"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-4175"></a>        <span class="k">ELSE</span>
<a name="ln-4176"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4177"></a>        <span class="n">ENDIF</span>
<a name="ln-4178"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4179"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4180"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4181"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4182"></a>        <span class="n">TotalCapCoeff1</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap1</span>
<a name="ln-4183"></a>        <span class="n">TotalCapCoeff2</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap2</span>
<a name="ln-4184"></a>        <span class="n">TotalCapCoeff3</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap3</span>
<a name="ln-4185"></a>        <span class="n">TotalCapCoeff4</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap4</span>
<a name="ln-4186"></a>        <span class="n">TotalCapCoeff5</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap5</span>
<a name="ln-4187"></a>        <span class="n">ratioTWB</span>         <span class="o">=</span> <span class="p">(</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4188"></a>        <span class="c">! rated condenser water inlet temperature of 85F</span>
<a name="ln-4189"></a>        <span class="n">ratioTS</span>          <span class="o">=</span> <span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span><span class="p">)</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4190"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">TotalCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">TotalCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">TotalCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4191"></a>                             <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">TotalCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">TotalCapCoeff5</span><span class="p">)</span>
<a name="ln-4192"></a><span class="c">!       The mixed air temp for zone equipment without an OA mixer is 0.</span>
<a name="ln-4193"></a><span class="c">!       This test avoids a negative capacity until a solution can be found.</span>
<a name="ln-4194"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MixEnth</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SupEnth</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4195"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-4196"></a>        <span class="k">ELSE</span>
<a name="ln-4197"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4800</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)</span>
<a name="ln-4198"></a>        <span class="k">END IF</span>
<a name="ln-4199"></a><span class="k">        </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">CoolCapAtPeak</span><span class="p">)</span>
<a name="ln-4200"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4201"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-4202"></a>        <span class="k">ELSE</span>
<a name="ln-4203"></a><span class="k">          </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-4204"></a>        <span class="k">END IF</span>
<a name="ln-4205"></a><span class="k">      ELSE</span>
<a name="ln-4206"></a><span class="k">        </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4207"></a>      <span class="k">END IF</span>
<a name="ln-4208"></a><span class="k">    END IF</span>
<a name="ln-4209"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RatedCapCoolTotalDes</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4210"></a><span class="k">      </span><span class="n">RatedCapCoolTotalDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4211"></a>    <span class="k">END IF</span>
<a name="ln-4212"></a><span class="k">  END IF</span>
<a name="ln-4213"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4214"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4215"></a><span class="k">      </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">=</span> <span class="n">RatedCapCoolTotalDes</span>
<a name="ln-4216"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4217"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4218"></a>                            <span class="s1">&#39;Design Size Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4219"></a>                             <span class="n">RatedCapCoolTotalDes</span><span class="p">)</span>
<a name="ln-4220"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-4221"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-4222"></a>                                 <span class="o">-</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-4223"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4224"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">&amp;</span>
<a name="ln-4225"></a>                                   <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-4226"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span> <span class="p">&amp;</span>
<a name="ln-4227"></a>                                   <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-4228"></a>      <span class="k">ELSE</span>
<a name="ln-4229"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4230"></a>        <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4231"></a>      <span class="n">ENDIF</span>
<a name="ln-4232"></a>    <span class="k">ELSE</span> <span class="c">! Hardsized with sizing data</span>
<a name="ln-4233"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapCoolTotalDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-4234"></a>                     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4235"></a><span class="k">        </span><span class="n">RatedCapCoolTotalUser</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-4236"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4237"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4238"></a>                            <span class="s1">&#39;Design Size Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4239"></a>                             <span class="n">RatedCapCoolTotalDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4240"></a>                            <span class="s1">&#39;User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4241"></a>                             <span class="n">RatedCapCoolTotalUser</span><span class="p">)</span>
<a name="ln-4242"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4243"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedCapCoolTotalDes</span> <span class="o">-</span> <span class="n">RatedCapCoolTotalUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedCapCoolTotalUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4244"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeHVACWaterToAir: Potential issue with equipment sizing for coil &#39;</span> <span class="p">&amp;</span>
<a name="ln-4245"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4246"></a>                                  <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4247"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Total Cooling Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4248"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapCoolTotalUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-4249"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Total Cooling Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4250"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapCoolTotalDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-4251"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-4252"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-4253"></a>          <span class="k">END IF</span>
<a name="ln-4254"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4255"></a>      <span class="k">END IF</span>
<a name="ln-4256"></a><span class="k">    END IF</span>
<a name="ln-4257"></a><span class="k">  END IF</span>
<a name="ln-4258"></a>
<a name="ln-4259"></a><span class="c">! Set the global DX cooling coil capacity variable for use by other objects</span>
<a name="ln-4260"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4261"></a><span class="k">    </span><span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-4262"></a>  <span class="k">END IF</span>
<a name="ln-4263"></a>
<a name="ln-4264"></a><span class="c">! size rated sensible cooling capacity</span>
<a name="ln-4265"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4266"></a>      <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4267"></a><span class="k">    </span><span class="n">RatedCapCoolSensAutosized</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4268"></a>  <span class="k">END IF</span>
<a name="ln-4269"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span>  <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4270"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4271"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedCapCoolSensAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-4272"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4273"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4274"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4275"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4276"></a>                            <span class="s1">&#39;User-Specified Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4277"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-4278"></a>      <span class="k">END IF</span>
<a name="ln-4279"></a><span class="k">    ELSE</span>
<a name="ln-4280"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4281"></a>                          <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4282"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-4283"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4284"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-4285"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-4286"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-4287"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-4288"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-4289"></a>        <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-4290"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-4291"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-4292"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-4293"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-4294"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-4295"></a>          <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-4296"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4297"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-4298"></a>            <span class="k">ELSE</span>
<a name="ln-4299"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4300"></a>            <span class="k">END IF</span>
<a name="ln-4301"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-4302"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4303"></a>                        <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-4304"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4305"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-4306"></a>          <span class="k">END IF</span>
<a name="ln-4307"></a><span class="k">        END IF</span>
<a name="ln-4308"></a><span class="k">        </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-4309"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4310"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4311"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4312"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4313"></a>        <span class="n">SensCapCoeff1</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap1</span>
<a name="ln-4314"></a>        <span class="n">SensCapCoeff2</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap2</span>
<a name="ln-4315"></a>        <span class="n">SensCapCoeff3</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap3</span>
<a name="ln-4316"></a>        <span class="n">SensCapCoeff4</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap4</span>
<a name="ln-4317"></a>        <span class="n">SensCapCoeff5</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap5</span>
<a name="ln-4318"></a>        <span class="n">SensCapCoeff6</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap6</span>
<a name="ln-4319"></a>        <span class="n">ratioTDB</span>         <span class="o">=</span> <span class="p">(</span><span class="n">MixTemp</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4320"></a>        <span class="n">ratioTWB</span>         <span class="o">=</span> <span class="p">(</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4321"></a>        <span class="c">! rated condenser water inlet temperature of 85F</span>
<a name="ln-4322"></a>        <span class="n">ratioTS</span>          <span class="o">=</span> <span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span><span class="p">)</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4323"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4324"></a>        <span class="n">SensCapTempModFac</span> <span class="o">=</span> <span class="n">SensCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTDB</span> <span class="o">*</span> <span class="n">SensCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">SensCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4325"></a>                            <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">SensCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">SensCapCoeff5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">SensCapCoeff6</span><span class="p">)</span>
<a name="ln-4326"></a><span class="c">!       The mixed air temp for zone equipment without an OA mixer is 0.</span>
<a name="ln-4327"></a><span class="c">!       This test avoids a negative capacity until a solution can be found.</span>
<a name="ln-4328"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MixTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SupTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4329"></a><span class="k">          </span><span class="n">SensCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixTemp</span><span class="o">-</span><span class="n">SupTemp</span><span class="p">)</span>
<a name="ln-4330"></a>        <span class="k">ELSE</span>
<a name="ln-4331"></a><span class="k">          </span><span class="n">SensCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="mf">4.0d0</span><span class="o">-</span><span class="n">SupTemp</span><span class="p">)</span>
<a name="ln-4332"></a>        <span class="k">END IF</span>
<a name="ln-4333"></a><span class="k">        </span><span class="n">SensCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">SensCapAtPeak</span><span class="p">)</span>
<a name="ln-4334"></a>        <span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="n">SensCapAtPeak</span> <span class="o">/</span> <span class="n">SensCapTempModFac</span>
<a name="ln-4335"></a>      <span class="k">ELSE</span>
<a name="ln-4336"></a><span class="k">        </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4337"></a>      <span class="k">END IF</span>
<a name="ln-4338"></a><span class="k">    END IF</span>
<a name="ln-4339"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4340"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RatedCapCoolSensAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-4341"></a>      <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4342"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4343"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4344"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4345"></a>                            <span class="s1">&#39;User-Specified Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4346"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-4347"></a>      <span class="k">END IF</span>
<a name="ln-4348"></a><span class="k">    ELSE</span>
<a name="ln-4349"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4350"></a>                          <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4351"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-4352"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4353"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4354"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4355"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-4356"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-4357"></a>          <span class="k">ELSE</span>
<a name="ln-4358"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-4359"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-4360"></a>          <span class="k">END IF</span>
<a name="ln-4361"></a><span class="k">        ELSE</span>
<a name="ln-4362"></a><span class="k">          </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-4363"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-4364"></a>        <span class="k">END IF</span>
<a name="ln-4365"></a><span class="k">        </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-4366"></a>        <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-4367"></a>        <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-4368"></a>        <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-4369"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4370"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-4371"></a>        <span class="k">ELSE</span>
<a name="ln-4372"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4373"></a>        <span class="n">ENDIF</span>
<a name="ln-4374"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4375"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4376"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4377"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4378"></a>        <span class="n">SensCapCoeff1</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap1</span>
<a name="ln-4379"></a>        <span class="n">SensCapCoeff2</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap2</span>
<a name="ln-4380"></a>        <span class="n">SensCapCoeff3</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap3</span>
<a name="ln-4381"></a>        <span class="n">SensCapCoeff4</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap4</span>
<a name="ln-4382"></a>        <span class="n">SensCapCoeff5</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap5</span>
<a name="ln-4383"></a>        <span class="n">SensCapCoeff6</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap6</span>
<a name="ln-4384"></a>        <span class="n">ratioTDB</span>         <span class="o">=</span> <span class="p">(</span><span class="n">MixTemp</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4385"></a>        <span class="n">ratioTWB</span>         <span class="o">=</span> <span class="p">(</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4386"></a>        <span class="c">! rated condenser water inlet temperature of 85F</span>
<a name="ln-4387"></a>        <span class="n">ratioTS</span>          <span class="o">=</span> <span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span><span class="p">)</span><span class="o">+</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">28</span><span class="mf">3.15d0</span>
<a name="ln-4388"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4389"></a>        <span class="n">SensCapTempModFac</span> <span class="o">=</span> <span class="n">SensCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTDB</span> <span class="o">*</span> <span class="n">SensCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">SensCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4390"></a>                            <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">SensCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">SensCapCoeff5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">SensCapCoeff6</span><span class="p">)</span>
<a name="ln-4391"></a><span class="c">!       The mixed air temp for zone equipment without an OA mixer is 0.</span>
<a name="ln-4392"></a><span class="c">!       This test avoids a negative capacity until a solution can be found.</span>
<a name="ln-4393"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MixTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SupTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4394"></a><span class="k">          </span><span class="n">SensCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixTemp</span><span class="o">-</span><span class="n">SupTemp</span><span class="p">)</span>
<a name="ln-4395"></a>        <span class="k">ELSE</span>
<a name="ln-4396"></a><span class="k">          </span><span class="n">SensCapAtPeak</span> <span class="o">=</span> <span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="mf">4.0d0</span><span class="o">-</span><span class="n">SupTemp</span><span class="p">)</span>
<a name="ln-4397"></a>        <span class="k">END IF</span>
<a name="ln-4398"></a><span class="k">        </span><span class="n">SensCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">SensCapAtPeak</span><span class="p">)</span>
<a name="ln-4399"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4400"></a><span class="k">          </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="n">SensCapAtPeak</span> <span class="o">/</span> <span class="n">SensCapTempModFac</span>
<a name="ln-4401"></a>        <span class="k">ELSE</span>
<a name="ln-4402"></a><span class="k">          </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="n">SensCapAtPeak</span>
<a name="ln-4403"></a>        <span class="k">END IF</span>
<a name="ln-4404"></a><span class="k">      ELSE</span>
<a name="ln-4405"></a><span class="k">        </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4406"></a>      <span class="k">END IF</span>
<a name="ln-4407"></a><span class="k">    END IF</span>
<a name="ln-4408"></a><span class="k">  END IF</span>
<a name="ln-4409"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RatedCapCoolSensDes</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4410"></a><span class="k">    </span><span class="n">RatedCapCoolSensDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4411"></a>  <span class="k">END IF</span>
<a name="ln-4412"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4413"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RatedCapCoolSensAutosized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4414"></a><span class="k">      </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">=</span> <span class="n">RatedCapCoolSensDes</span>
<a name="ln-4415"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4416"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4417"></a>                            <span class="s1">&#39;Design Size Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4418"></a>                             <span class="n">RatedCapCoolSensDes</span><span class="p">)</span>
<a name="ln-4419"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-4420"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">&amp;</span>
<a name="ln-4421"></a>                                 <span class="o">-</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">)</span>
<a name="ln-4422"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4423"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">&amp;</span>
<a name="ln-4424"></a>                                 <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span>
<a name="ln-4425"></a>      <span class="k">ELSE</span>
<a name="ln-4426"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4427"></a>      <span class="n">ENDIF</span>
<a name="ln-4428"></a>    <span class="k">ELSE</span>
<a name="ln-4429"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapCoolSensDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4430"></a><span class="k">        </span><span class="n">RatedCapCoolSensUser</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span>
<a name="ln-4431"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4432"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4433"></a>                            <span class="s1">&#39;Design Size Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4434"></a>                             <span class="n">RatedCapCoolSensDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4435"></a>                            <span class="s1">&#39;User-Specified Rated Sensible Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4436"></a>                             <span class="n">RatedCapCoolSensUser</span><span class="p">)</span>
<a name="ln-4437"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4438"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedCapCoolSensDes</span> <span class="o">-</span> <span class="n">RatedCapCoolSensUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedCapCoolSensUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4439"></a><span class="k">            CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeHVACWaterToAir: Potential issue with equipment sizing for coil &#39;</span> <span class="p">&amp;</span>
<a name="ln-4440"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4441"></a>                                  <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4442"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Sensible Cooling Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4443"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapCoolSensUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-4444"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Sensible Cooling Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4445"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapCoolSensDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-4446"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-4447"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-4448"></a>          <span class="k">END IF</span>
<a name="ln-4449"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4450"></a>      <span class="k">END IF</span>
<a name="ln-4451"></a><span class="k">    END IF</span>
<a name="ln-4452"></a><span class="k">  END IF</span>
<a name="ln-4453"></a>
<a name="ln-4454"></a><span class="c">! test autosized sensible and total cooling capacity for total &gt; sensible</span>
<a name="ln-4455"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RatedCapCoolSensAutosized</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapCoolTotalAutosized</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4456"></a>     <span class="n">RatedCapCoolSensAutosized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4457"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4458"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4459"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4460"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Rated Sensible Cooling Capacity &gt; Rated Total Cooling Capacity&#39;</span><span class="p">)</span>
<a name="ln-4461"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Each of these capacity inputs have been autosized.&#39;</span><span class="p">)</span>
<a name="ln-4462"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Sensible Cooling Capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4463"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4464"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Total Cooling Capacity    = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4465"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4466"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;See eio file for further details.&#39;</span><span class="p">)</span>
<a name="ln-4467"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Total and Sensible Cooling Capacity Coefficients to ensure they are accurate.&#39;</span><span class="p">)</span>
<a name="ln-4468"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Zone and System Sizing objects to verify sizing inputs.&#39;</span><span class="p">)</span>
<a name="ln-4469"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sizing statistics:&#39;</span><span class="p">)</span>
<a name="ln-4470"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Air Dry-Bulb Temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4471"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Air Wet-Bulb Temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4472"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Condenser Water Temperature used = 24.4444 C&#39;</span><span class="p">)</span>
<a name="ln-4473"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Used design air and water flow rates (i.e., used 1 for ratioVL and ratioVS)&#39;</span><span class="p">)</span>
<a name="ln-4474"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTDB = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="n">MixTemp</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4475"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTWB = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4476"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTS  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4477"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sensible Cooling Capacity Modifier = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SensCapTempModFac</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4478"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Sensible Cooling Capacity = Sensible Design Load / Sensible Cooling Capacity Modifier&#39;</span><span class="p">)</span>
<a name="ln-4479"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Total Cooling Capacity Modifier = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotCapTempModFac</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4480"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity = Total Design Load / Total Cooling Capacity Modifier&#39;</span><span class="p">)</span>
<a name="ln-4481"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Carefully review the Load Side Total, Sensible, and Latent heat transfer rates&#39;</span><span class="p">)</span>
<a name="ln-4482"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... to ensure they meet the expected manufacturers performance specifications.&#39;</span><span class="p">)</span>
<a name="ln-4483"></a>    <span class="k">END IF</span>
<a name="ln-4484"></a><span class="k">  ELSE If</span><span class="p">(</span><span class="n">RatedCapCoolTotalAutosized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4485"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4486"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4487"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4488"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Rated Sensible Cooling Capacity &gt; Rated Total Cooling Capacity&#39;</span><span class="p">)</span>
<a name="ln-4489"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Only the rated total capacity input is autosized, consider autosizing both inputs.&#39;</span><span class="p">)</span>
<a name="ln-4490"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Sensible Cooling Capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4491"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4492"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Rated Total Cooling Capacity    = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4493"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4494"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;See eio file for further details.&#39;</span><span class="p">)</span>
<a name="ln-4495"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Total and Sensible Cooling Capacity Coefficients to ensure they are accurate.&#39;</span><span class="p">)</span>
<a name="ln-4496"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Zone and System Sizing objects to verify sizing inputs.&#39;</span><span class="p">)</span>
<a name="ln-4497"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sizing statistics for Total Cooling Capacity:&#39;</span><span class="p">)</span>
<a name="ln-4498"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Air Wet-Bulb Temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4499"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entering Condenser Water Temperature used = 24.4444 C&#39;</span><span class="p">)</span>
<a name="ln-4500"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Used design air and water flow rates (i.e., used 1 for ratioVL and ratioVS)&#39;</span><span class="p">)</span>
<a name="ln-4501"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTWB = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="n">MixWetBulb</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4502"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ratioTS  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(((</span><span class="mi">8</span><span class="mf">5.0d0</span><span class="o">+</span><span class="mi">28</span><span class="mf">3.15d0</span><span class="p">)</span><span class="o">/</span><span class="mi">27</span><span class="mf">3.15d0</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4503"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sensible Cooling Capacity Modifier = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SensCapTempModFac</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4504"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Sensible Cooling Capacity = Sensible Design Load / Sensible Cooling Capacity Modifier&#39;</span><span class="p">)</span>
<a name="ln-4505"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Carefully review the Load Side Total, Sensible, and Latent heat transfer rates&#39;</span><span class="p">)</span>
<a name="ln-4506"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... to ensure they meet the expected manufacturers performance specifications.&#39;</span><span class="p">)</span>
<a name="ln-4507"></a>    <span class="k">END IF</span>
<a name="ln-4508"></a><span class="k">  END IF</span>
<a name="ln-4509"></a>
<a name="ln-4510"></a><span class="n">ENDIF</span> <span class="c">! Cooling Coild</span>
<a name="ln-4511"></a>
<a name="ln-4512"></a><span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4513"></a><span class="c">! size rated heating capacity</span>
<a name="ln-4514"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4515"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4516"></a>      <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4517"></a><span class="k">    </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4518"></a>  <span class="k">END IF</span>
<a name="ln-4519"></a><span class="c">!   simply set heating capacity equal to the cooling capacity</span>
<a name="ln-4520"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4521"></a><span class="k">    </span><span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-4522"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RatedCapHeatDes</span> <span class="o">==</span>  <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4523"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4524"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4525"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Heating coil could not be autosized since cooling coil was not previously sized.&#39;</span><span class="p">)</span>
<a name="ln-4526"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Cooling coil must be upstream of heating coil.&#39;</span><span class="p">)</span>
<a name="ln-4527"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Manually sizing this heating coil will be required.&#39;</span><span class="p">)</span>
<a name="ln-4528"></a>    <span class="k">END IF</span>
<a name="ln-4529"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RatedCapHeatDes</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4530"></a><span class="k">      </span><span class="n">RatedCapHeatDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4531"></a>    <span class="k">END IF</span>
<a name="ln-4532"></a><span class="k">  END IF</span>
<a name="ln-4533"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4534"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">=</span> <span class="n">RatedCapHeatDes</span>
<a name="ln-4535"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4536"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4537"></a>                            <span class="s1">&#39;Design Size Rated Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4538"></a>                             <span class="n">RatedCapHeatDes</span><span class="p">)</span>
<a name="ln-4539"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-4540"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4541"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span> <span class="p">&amp;</span>
<a name="ln-4542"></a>                             <span class="o">/</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span>
<a name="ln-4543"></a>    <span class="k">ELSE</span>
<a name="ln-4544"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4545"></a>    <span class="n">ENDIF</span>
<a name="ln-4546"></a>  <span class="k">ELSE</span>
<a name="ln-4547"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedCapHeatDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4548"></a><span class="k">      </span><span class="n">RatedCapHeatUser</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-4549"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4550"></a>                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4551"></a>                            <span class="s1">&#39;Design Size Rated Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4552"></a>                             <span class="n">RatedCapHeatDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4553"></a>                            <span class="s1">&#39;User-Specified Rated Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4554"></a>                             <span class="n">RatedCapHeatUser</span><span class="p">)</span>
<a name="ln-4555"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4556"></a><span class="k">        IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedCapHeatDes</span> <span class="o">-</span> <span class="n">RatedCapHeatUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedCapHeatUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4557"></a><span class="k">          CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeHVACWaterToAir: Potential issue with equipment sizing for coil &#39;</span> <span class="p">&amp;</span>
<a name="ln-4558"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4559"></a>                                  <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4560"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Heating Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4561"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapHeatUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-4562"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Heating Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4563"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedCapHeatDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-4564"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-4565"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-4566"></a>        <span class="k">END IF</span>
<a name="ln-4567"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-4568"></a>    <span class="k">END IF</span>
<a name="ln-4569"></a><span class="k">  END IF</span>
<a name="ln-4570"></a>
<a name="ln-4571"></a>  <span class="c">! Check that heat pump heating capacity is within 20% of cooling capacity. Check only for heating coil and report both.</span>
<a name="ln-4572"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4573"></a>      <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4574"></a>
<a name="ln-4575"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4576"></a>
<a name="ln-4577"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">-</span><span class="p">&amp;</span>
<a name="ln-4578"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">)</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-4579"></a>           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.2d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4580"></a>
<a name="ln-4581"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4582"></a>                            <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4583"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...used with COIL:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4584"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4585"></a>                            <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4586"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4587"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...heating capacity is disproportionate (&gt; 20% different) to total cooling capacity&#39;</span><span class="p">)</span>
<a name="ln-4588"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...heating capacity = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4589"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...cooling capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4590"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4591"></a>
<a name="ln-4592"></a>      <span class="k">END IF</span>
<a name="ln-4593"></a>
<a name="ln-4594"></a><span class="k">    END IF</span>
<a name="ln-4595"></a>
<a name="ln-4596"></a><span class="k">  END IF</span>
<a name="ln-4597"></a>
<a name="ln-4598"></a><span class="n">ENDIF</span> <span class="c">! Heating</span>
<a name="ln-4599"></a>
<a name="ln-4600"></a><span class="c">! size rated power</span>
<a name="ln-4601"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4602"></a>
<a name="ln-4603"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span><span class="o">/</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCOPCool</span>
<a name="ln-4604"></a>
<a name="ln-4605"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4606"></a>
<a name="ln-4607"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span><span class="o">/</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCOPHeat</span>
<a name="ln-4608"></a>
<a name="ln-4609"></a>  <span class="k">END IF</span>
<a name="ln-4610"></a>
<a name="ln-4611"></a><span class="c">! Size water volumetric flow rate</span>
<a name="ln-4612"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4613"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4614"></a><span class="k">    </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4615"></a>  <span class="k">END IF</span>
<a name="ln-4616"></a>
<a name="ln-4617"></a><span class="c">!   WSHP condenser can be on either a plant loop or condenser loop. Test each to find plant sizing number.</span>
<a name="ln-4618"></a><span class="c">!   first check to see if coil is connected to a plant loop, no warning on this CALL</span>
<a name="ln-4619"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4620"></a><span class="k">    </span><span class="n">PltSizNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4621"></a>        <span class="n">MyPlantSizingIndex</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4622"></a>                           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4623"></a>                           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4624"></a>                           <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-4625"></a>
<a name="ln-4626"></a><span class="c">!!   if not found on a plant loop, check condenser loop and warn user if not found</span>
<a name="ln-4627"></a><span class="c">!    IF(PltSizNum == 0) THEN</span>
<a name="ln-4628"></a><span class="c">!</span>
<a name="ln-4629"></a><span class="c">!      PltSizNum = &amp;</span>
<a name="ln-4630"></a><span class="c">!          MyCondPlantSizingIndex(&#39;COIL:&#39;//TRIM(SimpleWatertoAirHP(HPNum)%WaterToAirHPType)//&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;, &amp;</span>
<a name="ln-4631"></a><span class="c">!                                 SimpleWatertoAirHP(HPNum)%Name, &amp;</span>
<a name="ln-4632"></a><span class="c">!                                 SimpleWatertoAirHP(HPNum)%WaterInletNodeNum, &amp;</span>
<a name="ln-4633"></a><span class="c">!                                 SimpleWatertoAirHP(HPNum)%WaterOutletNodeNum, ErrorsFound)</span>
<a name="ln-4634"></a><span class="c">!    END IF</span>
<a name="ln-4635"></a>
<a name="ln-4636"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4637"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4638"></a>                             <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4639"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4640"></a>                             <span class="s1">&#39;SizeHVACWaterToAir&#39;</span><span class="p">)</span>
<a name="ln-4641"></a>      <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>                                  <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4643"></a>                                  <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4644"></a>                                 <span class="s1">&#39;SizeHVACWaterToAir&#39;</span><span class="p">)</span>
<a name="ln-4645"></a>
<a name="ln-4646"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;HEATING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4647"></a>
<a name="ln-4648"></a><span class="k">        </span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4649"></a>                                   <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-4650"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span> <span class="o">==</span> <span class="s1">&#39;COOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4651"></a>
<a name="ln-4652"></a><span class="c">!       use companion heating coil capacity to calculate volumetric flow rate</span>
<a name="ln-4653"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4654"></a><span class="k">          </span><span class="n">SystemCapacity</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-4655"></a>        <span class="k">ELSE</span>
<a name="ln-4656"></a><span class="k">          </span><span class="n">SystemCapacity</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-4657"></a>        <span class="k">END IF</span>
<a name="ln-4658"></a>
<a name="ln-4659"></a><span class="k">        </span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4660"></a>                                <span class="n">SystemCapacity</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4661"></a>                                <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-4662"></a>      <span class="k">END IF</span>
<a name="ln-4663"></a><span class="k">    ELSE</span>
<a name="ln-4664"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of water flow requires a loop Sizing:Plant object&#39;</span><span class="p">)</span>
<a name="ln-4665"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Autosizing also requires physical connection to a plant or condenser loop.&#39;</span><span class="p">)</span>
<a name="ln-4666"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4667"></a>             <span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span> <span class="o">//</span> <span class="s1">&#39; Object=&#39;</span> <span class="p">&amp;</span>
<a name="ln-4668"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4669"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4670"></a>    <span class="k">END IF</span>
<a name="ln-4671"></a><span class="k">  END IF</span>
<a name="ln-4672"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4673"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">=</span> <span class="n">RatedWaterVolFlowRateDes</span>
<a name="ln-4674"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4675"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4676"></a>                                  <span class="s1">&#39;Design Size Rated Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-4677"></a>  <span class="k">ELSE</span>
<a name="ln-4678"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedWaterVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4679"></a><span class="k">      </span><span class="n">RatedWaterVolFlowRateUser</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span>
<a name="ln-4680"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;COIL:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4681"></a>                                  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4682"></a>                                  <span class="s1">&#39;Design Size Rated Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4683"></a>                                  <span class="s1">&#39;User-Specified Rated Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-4684"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4685"></a><span class="k">        IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">RatedWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedWaterVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4686"></a><span class="k">          CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeHVACWaterToAir: Potential issue with equipment sizing for coil &#39;</span> <span class="p">&amp;</span>
<a name="ln-4687"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterToAirHPType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4688"></a>                                  <span class="s1">&#39;:WATERTOAIRHEATPUMP:EQUATIONFIT &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4689"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4690"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-4691"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4692"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-4693"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-4694"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-4695"></a>        <span class="k">END IF</span>
<a name="ln-4696"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-4697"></a>    <span class="k">END IF</span>
<a name="ln-4698"></a><span class="k">  END IF</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a><span class="c">! Save component design water volumetric flow rate.</span>
<a name="ln-4701"></a><span class="c">! Use 1/2 flow since both cooling and heating coil will save flow yet only 1 will operate at a time</span>
<a name="ln-4702"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4703"></a><span class="k">    CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4704"></a>       <span class="mf">0.5d0</span><span class="o">*</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-4705"></a>  <span class="k">END IF</span>
<a name="ln-4706"></a>
<a name="ln-4707"></a><span class="k">  RETURN</span>
<a name="ln-4708"></a>
<a name="ln-4709"></a><span class="k">END SUBROUTINE </span><span class="n">SizeHVACWaterToAir</span>
<a name="ln-4710"></a>
<a name="ln-4711"></a>
<a name="ln-4712"></a><span class="k">SUBROUTINE </span><span class="n">CalcHPCoolingSimple</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">SensDemand</span><span class="p">,</span><span class="n">LatentDemand</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4713"></a>                               <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">)</span>
<a name="ln-4714"></a>
<a name="ln-4715"></a>
<a name="ln-4716"></a>          <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-4717"></a>          <span class="c">!       DATE WRITTEN   Jan 2004</span>
<a name="ln-4718"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4719"></a>          <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-4720"></a>
<a name="ln-4721"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4722"></a>          <span class="c">! This subroutine is for simulating the cooling mode of the Water to Air HP Simple</span>
<a name="ln-4723"></a>
<a name="ln-4724"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4725"></a>          <span class="c">! Simulate the heat pump performance using the coefficients and rated conditions</span>
<a name="ln-4726"></a>          <span class="c">!</span>
<a name="ln-4727"></a>          <span class="c">! If the LatDegradModelSimFlag is enabled, the coil will be simulated twice:</span>
<a name="ln-4728"></a>          <span class="c">! (1)first simulation at the rated conditions (2) second simulation at the</span>
<a name="ln-4729"></a>          <span class="c">! actual operating conditions. Then call CalcEffectiveSHR and the effective SHR</span>
<a name="ln-4730"></a>          <span class="c">! is adjusted.</span>
<a name="ln-4731"></a>          <span class="c">!</span>
<a name="ln-4732"></a>          <span class="c">! If the LatDegradModelSimFlag is disabled, the cooling coil is only simulated</span>
<a name="ln-4733"></a>          <span class="c">! once at the actual operating conditions.</span>
<a name="ln-4734"></a>          <span class="c">!</span>
<a name="ln-4735"></a>          <span class="c">! Finally, adjust the heat pump outlet conditions based on the PartLoadRatio</span>
<a name="ln-4736"></a>          <span class="c">! and RuntimeFrac.</span>
<a name="ln-4737"></a>
<a name="ln-4738"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4739"></a>          <span class="c">! (1) Lash.T.A.,1992.Simulation and Analysis of a Water Loop Heat Pump System.</span>
<a name="ln-4740"></a>          <span class="c">! M.S. Thesis, University of Illinois at Urbana Champaign.</span>
<a name="ln-4741"></a>          <span class="c">! (2) Shenoy, Arun. 2004. Simulation, Modeling and Analysis of Water to Air Heat Pump.</span>
<a name="ln-4742"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-4743"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-4744"></a>          <span class="c">! (3) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-4745"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-4746"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-4747"></a>          <span class="c">! (4) Henderson, H.I., K. Rengarajan.1996. A Model to Predict the Latent</span>
<a name="ln-4748"></a>          <span class="c">! Capacity of Air Conditioners and Heat Pumps at Part-Load Conditions</span>
<a name="ln-4749"></a>          <span class="c">! with Constant Fan Operation ASHRAE Transactions 102 (1), pp. 266-274.</span>
<a name="ln-4750"></a>
<a name="ln-4751"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4752"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">DXElecCoolingPower</span>
<a name="ln-4753"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">,</span><span class="n">PsyCpAirFnWTdb</span><span class="p">,</span><span class="n">PsyHFnTdbW</span><span class="p">,</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4754"></a>                                  <span class="n">PsyTwbFnTdbWPb</span><span class="p">,</span><span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyWFnTdbH</span>
<a name="ln-4755"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-4756"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-4757"></a>
<a name="ln-4758"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4759"></a>
<a name="ln-4760"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4761"></a>
<a name="ln-4762"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>              <span class="c">! Heat Pump Number</span>
<a name="ln-4763"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>      <span class="c">! Fan/Compressor cycling scheme indicator</span>
<a name="ln-4764"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>        <span class="c">! Runtime Fraction of compressor or percent on time (on-time/cycle time)</span>
<a name="ln-4765"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensDemand</span>         <span class="c">! Cooling Sensible Demand [W] !unused1208</span>
<a name="ln-4766"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentDemand</span>       <span class="c">! Cooling Latent Demand [W]</span>
<a name="ln-4767"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation flag</span>
<a name="ln-4768"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! compressor part load ratio</span>
<a name="ln-4769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor on flow to average flow over time step</span>
<a name="ln-4770"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterPartLoad</span>      <span class="c">! water part load ratio</span>
<a name="ln-4771"></a>
<a name="ln-4772"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4773"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Tref</span><span class="o">=</span><span class="mi">28</span><span class="mf">3.15d0</span>      <span class="c">! Reference Temperature for performance curves,10C [K]</span>
<a name="ln-4774"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcHPCoolingSimple&#39;</span>
<a name="ln-4775"></a>
<a name="ln-4776"></a>
<a name="ln-4777"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4778"></a>          <span class="c">! na</span>
<a name="ln-4779"></a>
<a name="ln-4780"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4781"></a>          <span class="c">! na</span>
<a name="ln-4782"></a>
<a name="ln-4783"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4784"></a>
<a name="ln-4785"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapRated</span>          <span class="c">! Rated Total Cooling Capacity [W]</span>
<a name="ln-4786"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapRated</span>           <span class="c">! Rated Sensible Cooling Capacity [W]</span>
<a name="ln-4787"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerRated</span>         <span class="c">! Rated Cooling Power Input[W]</span>
<a name="ln-4788"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolFlowRateRated</span>    <span class="c">! Rated Air Volumetric Flow Rate [m3/s]</span>
<a name="ln-4789"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterVolFlowRateRated</span>  <span class="c">! Rated Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-4790"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff1</span>         <span class="c">! 1st coefficient of the total cooling capacity performance curve</span>
<a name="ln-4791"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff2</span>         <span class="c">! 2nd coefficient of the total cooling capacity performance curve</span>
<a name="ln-4792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff3</span>         <span class="c">! 3rd coefficient of the total cooling capacity performance curve</span>
<a name="ln-4793"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff4</span>         <span class="c">! 4th coefficient of the total cooling capacity performance curve</span>
<a name="ln-4794"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCapCoeff5</span>         <span class="c">! 5th coefficient of the total cooling capacity performance curve</span>
<a name="ln-4795"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff1</span>          <span class="c">! 1st coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-4796"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff2</span>          <span class="c">! 2nd coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-4797"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff3</span>          <span class="c">! 3rd coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-4798"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff4</span>          <span class="c">! 4th coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-4799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff5</span>          <span class="c">! 5th coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-4800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCapCoeff6</span>          <span class="c">! 6th coefficient of the sensible cooling capacity performance curve</span>
<a name="ln-4801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff1</span>        <span class="c">! 1st coefficient of the cooling power consumption curve</span>
<a name="ln-4802"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff2</span>        <span class="c">! 2nd coefficient of the cooling power consumption curve</span>
<a name="ln-4803"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff3</span>        <span class="c">! 3rd coefficient of the cooling power consumption curve</span>
<a name="ln-4804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff4</span>        <span class="c">! 4th coefficient of the cooling power consumption curve</span>
<a name="ln-4805"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff5</span>        <span class="c">! 5th coefficient of the cooling power consumption curve</span>
<a name="ln-4806"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_rated</span>             <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-4807"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_rated</span>            <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-4808"></a>
<a name="ln-4809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRss</span>                  <span class="c">! Sensible heat ratio at steady state</span>
<a name="ln-4810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHReff</span>                 <span class="c">! Effective sensible heat ratio at part-load condition</span>
<a name="ln-4811"></a><span class="c">!  REAL(r64) :: PartLoadRatio          ! Part load ratio</span>
<a name="ln-4812"></a>
<a name="ln-4813"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTDB</span>               <span class="c">! Ratio of the inlet air dry bulb temperature to the rated conditions</span>
<a name="ln-4814"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTWB</span>               <span class="c">! Ratio of the inlet air wet bulb temperature to the rated conditions</span>
<a name="ln-4815"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTS</span>                <span class="c">! Ratio of the source side(water) inlet temperature to the rated conditions</span>
<a name="ln-4816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioVL</span>                <span class="c">! Ratio of the air flow rate to the rated conditions</span>
<a name="ln-4817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioVS</span>                <span class="c">! Ratio of the water flow rate to the rated conditions</span>
<a name="ln-4818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span>                <span class="c">! Specific heat of water [J/kg_C]</span>
<a name="ln-4819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>                  <span class="c">! Specific heat of air [J/kg_C]</span>
<a name="ln-4820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-4821"></a>
<a name="ln-4822"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LatDegradModelSimFlag</span>  <span class="c">! Latent degradation model simulation flag</span>
<a name="ln-4823"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumIteration</span>           <span class="c">! Iteration Counter</span>
<a name="ln-4824"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>          <span class="c">! No idea what this is for.</span>
<a name="ln-4825"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4826"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletDBTemp_Init</span> <span class="c">! rated conditions</span>
<a name="ln-4827"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletWBTemp_Init</span> <span class="c">! rated conditions</span>
<a name="ln-4828"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletHumRat_Init</span> <span class="c">! rated conditions</span>
<a name="ln-4829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">LoadSideInletEnth_Init</span> <span class="c">! rated conditions</span>
<a name="ln-4830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">CpAir_Init</span>                <span class="c">! rated conditions</span>
<a name="ln-4831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletDBTemp_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-4832"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletWBTemp_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-4833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletHumRat_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-4834"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">LoadSideInletEnth_Unit</span> <span class="c">! calc conditions for unit</span>
<a name="ln-4835"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CpAir_Unit</span>                <span class="c">! calc conditions for unit</span>
<a name="ln-4836"></a>
<a name="ln-4837"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4838"></a>    <span class="c">!Set indoor air conditions to the rated condition</span>
<a name="ln-4839"></a>    <span class="n">LoadSideInletDBTemp_Init</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.7d0</span>
<a name="ln-4840"></a>    <span class="n">LoadSideInletHumRat_Init</span> <span class="o">=</span> <span class="mf">0.0111d0</span>
<a name="ln-4841"></a>    <span class="n">LoadSideInletEnth_Init</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">,</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:Init&#39;</span><span class="p">)</span>
<a name="ln-4842"></a>    <span class="n">CpAir_Init</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">,</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:Init&#39;</span><span class="p">)</span>
<a name="ln-4843"></a>    <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4844"></a>  <span class="n">ENDIF</span>
<a name="ln-4845"></a>  <span class="n">LoadSideInletWBTemp_Init</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Init</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Init</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4846"></a>
<a name="ln-4847"></a>
<a name="ln-4848"></a>
<a name="ln-4849"></a> <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-4850"></a>
<a name="ln-4851"></a>  <span class="n">TotalCapRated</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-4852"></a>  <span class="n">SensCapRated</span>           <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapCoolSens</span>
<a name="ln-4853"></a>  <span class="n">CoolPowerRated</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span>
<a name="ln-4854"></a>  <span class="n">AirVolFlowRateRated</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-4855"></a>  <span class="n">WaterVolFlowRateRated</span>  <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span>
<a name="ln-4856"></a>
<a name="ln-4857"></a>  <span class="n">TotalCapCoeff1</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap1</span>
<a name="ln-4858"></a>  <span class="n">TotalCapCoeff2</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap2</span>
<a name="ln-4859"></a>  <span class="n">TotalCapCoeff3</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap3</span>
<a name="ln-4860"></a>  <span class="n">TotalCapCoeff4</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap4</span>
<a name="ln-4861"></a>  <span class="n">TotalCapCoeff5</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TotalCoolCap5</span>
<a name="ln-4862"></a>  <span class="n">SensCapCoeff1</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap1</span>
<a name="ln-4863"></a>  <span class="n">SensCapCoeff2</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap2</span>
<a name="ln-4864"></a>  <span class="n">SensCapCoeff3</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap3</span>
<a name="ln-4865"></a>  <span class="n">SensCapCoeff4</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap4</span>
<a name="ln-4866"></a>  <span class="n">SensCapCoeff5</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap5</span>
<a name="ln-4867"></a>  <span class="n">SensCapCoeff6</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SensCoolCap6</span>
<a name="ln-4868"></a>  <span class="n">CoolPowerCoeff1</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower1</span>
<a name="ln-4869"></a>  <span class="n">CoolPowerCoeff2</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower2</span>
<a name="ln-4870"></a>  <span class="n">CoolPowerCoeff3</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower3</span>
<a name="ln-4871"></a>  <span class="n">CoolPowerCoeff4</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower4</span>
<a name="ln-4872"></a>  <span class="n">CoolPowerCoeff5</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CoolPower5</span>
<a name="ln-4873"></a>  <span class="n">Twet_rated</span>             <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Twet_rated</span>
<a name="ln-4874"></a>  <span class="n">Gamma_rated</span>            <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Gamma_rated</span>
<a name="ln-4875"></a>
<a name="ln-4876"></a>  <span class="n">LoadSideMassFlowRate</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>
<a name="ln-4877"></a>  <span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-4878"></a>  <span class="n">SourceSideInletTemp</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-4879"></a>  <span class="n">SourceSideInletEnth</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-4880"></a>  <span class="n">CpWater</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4881"></a>                                   <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4882"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4883"></a>                                  <span class="s1">&#39;CalcHPCoolingSimple:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-4884"></a>
<a name="ln-4885"></a>   <span class="c">!Check for flows, do not perform simulation if no flow in load side or source side.</span>
<a name="ln-4886"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LoadSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4887"></a><span class="k">     </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4888"></a>     <span class="k">RETURN</span>
<a name="ln-4889"></a><span class="k">  ELSE</span>
<a name="ln-4890"></a><span class="k">     </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4891"></a>  <span class="n">ENDIF</span>
<a name="ln-4892"></a>
<a name="ln-4893"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4894"></a><span class="k">     </span><span class="n">SimpleWaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4895"></a>     <span class="k">RETURN</span>
<a name="ln-4896"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-4897"></a>
<a name="ln-4898"></a>  <span class="c">!Loop the calculation at least once depending whether the latent degradation model</span>
<a name="ln-4899"></a>  <span class="c">!is enabled. 1st iteration to calculate the QLatent(rated) at (TDB,TWB)indoorair=(26.7C,19.4C)</span>
<a name="ln-4900"></a>  <span class="c">!and 2nd iteration to calculate the  QLatent(actual)</span>
<a name="ln-4901"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">RuntimeFrac</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Twet_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Gamma_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4902"></a><span class="k">    </span><span class="n">LatDegradModelSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4903"></a>    <span class="c">!Set NumIteration=1 so that latent model would quit after 1 simulation with the actual condition</span>
<a name="ln-4904"></a>    <span class="n">NumIteration</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4905"></a>  <span class="k">ELSE</span>
<a name="ln-4906"></a><span class="k">    </span><span class="n">LatDegradModelSimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4907"></a>    <span class="c">!Set NumIteration=0 so that latent model would simulate twice with rated and actual condition</span>
<a name="ln-4908"></a>    <span class="n">NumIteration</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4909"></a>  <span class="k">END IF</span>
<a name="ln-4910"></a>
<a name="ln-4911"></a>
<a name="ln-4912"></a>  <span class="c">!Set indoor air conditions to the actual condition</span>
<a name="ln-4913"></a>  <span class="n">LoadSideInletDBTemp_Unit</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-4914"></a>  <span class="n">LoadSideInletHumRat_Unit</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-4915"></a>  <span class="n">LoadSideInletWBTemp_Unit</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp_Unit</span><span class="p">,</span><span class="n">LoadSideInletHumRat_Unit</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4916"></a>  <span class="n">LoadSideInletEnth_Unit</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-4917"></a>  <span class="n">CpAir_Unit</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat_Unit</span><span class="p">,</span><span class="n">LoadSideInletDBTemp_Unit</span><span class="p">)</span>
<a name="ln-4918"></a>
<a name="ln-4919"></a><span class="n">LOOP</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-4920"></a><span class="k">    </span><span class="n">NumIteration</span><span class="o">=</span><span class="n">NumIteration</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4921"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4922"></a>    <span class="c">!Set indoor air conditions to the rated conditions</span>
<a name="ln-4923"></a>        <span class="n">LoadSideInletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp_Init</span>
<a name="ln-4924"></a>        <span class="n">LoadSideInletHumRat</span> <span class="o">=</span> <span class="n">LoadSideInletHumRat_Init</span>
<a name="ln-4925"></a>        <span class="n">LoadSideInletWBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletWBTemp_Init</span>
<a name="ln-4926"></a>        <span class="n">LoadSideInletEnth</span> <span class="o">=</span> <span class="n">LoadSideInletEnth_Init</span>
<a name="ln-4927"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="n">CpAir_Init</span>
<a name="ln-4928"></a>    <span class="k">ELSE</span>
<a name="ln-4929"></a>    <span class="c">!Set indoor air conditions to the actual condition</span>
<a name="ln-4930"></a>        <span class="n">LoadSideInletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp_Unit</span>
<a name="ln-4931"></a>        <span class="n">LoadSideInletHumRat</span> <span class="o">=</span> <span class="n">LoadSideInletHumRat_Unit</span>
<a name="ln-4932"></a>        <span class="n">LoadSideInletWBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletWBTemp_Unit</span>
<a name="ln-4933"></a>        <span class="n">LoadSideInletEnth</span> <span class="o">=</span> <span class="n">LoadSideInletEnth_Unit</span>
<a name="ln-4934"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="n">CpAir_Unit</span>
<a name="ln-4935"></a>    <span class="k">END IF</span>
<a name="ln-4936"></a>
<a name="ln-4937"></a><span class="k">    </span><span class="n">ratioTDB</span> <span class="o">=</span> <span class="p">((</span><span class="n">LoadSideInletDBTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-4938"></a>    <span class="n">ratioTWB</span> <span class="o">=</span> <span class="p">((</span><span class="n">LoadSideInletWBTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-4939"></a>    <span class="n">ratioTS</span> <span class="o">=</span> <span class="p">((</span><span class="n">SourceSideInletTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-4940"></a>    <span class="n">ratioVL</span> <span class="o">=</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">AirVolFlowRateRated</span><span class="o">*</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">)))</span>
<a name="ln-4941"></a>
<a name="ln-4942"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterPartLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4943"></a><span class="k">      </span><span class="n">ratioVS</span> <span class="o">=</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="o">*</span><span class="n">WaterPartLoad</span><span class="p">)</span>
<a name="ln-4944"></a>    <span class="k">ELSE</span>
<a name="ln-4945"></a><span class="k">      </span><span class="n">ratioVS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4946"></a>    <span class="n">ENDIF</span>
<a name="ln-4947"></a>
<a name="ln-4948"></a>    <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">TotalCapRated</span><span class="o">*</span><span class="p">(</span><span class="n">TotalCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">TotalCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">TotalCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4949"></a>                                <span class="p">(</span><span class="n">ratioVL</span> <span class="o">*</span> <span class="n">TotalCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioVS</span> <span class="o">*</span> <span class="n">TotalCapCoeff5</span><span class="p">))</span>
<a name="ln-4950"></a>    <span class="n">QSensible</span> <span class="o">=</span> <span class="n">SensCapRated</span><span class="o">*</span><span class="p">(</span><span class="n">SensCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTDB</span> <span class="o">*</span> <span class="n">SensCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">SensCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4951"></a>                                <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">SensCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioVL</span> <span class="o">*</span> <span class="n">SensCapCoeff5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioVS</span> <span class="o">*</span> <span class="n">SensCapCoeff6</span><span class="p">))</span>
<a name="ln-4952"></a>    <span class="n">Winput</span> <span class="o">=</span> <span class="n">CoolPowerRated</span><span class="o">*</span><span class="p">(</span><span class="n">CoolPowerCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTWB</span> <span class="o">*</span> <span class="n">CoolPowerCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">CoolPowerCoeff3</span><span class="p">)</span><span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4953"></a>                                <span class="p">(</span><span class="n">ratioVL</span> <span class="o">*</span> <span class="n">CoolPowerCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioVS</span> <span class="o">*</span> <span class="n">CoolPowerCoeff5</span><span class="p">))</span>
<a name="ln-4954"></a>    <span class="n">Qsource</span> <span class="o">=</span>  <span class="n">QLoadTotal</span> <span class="o">+</span> <span class="n">Winput</span>
<a name="ln-4955"></a>
<a name="ln-4956"></a>  <span class="c">!Check if the Sensible Load is greater than the Total Cooling Load</span>
<a name="ln-4957"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">QSensible</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">QLoadTotal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4958"></a><span class="k">     </span><span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-4959"></a>  <span class="k">END IF</span>
<a name="ln-4960"></a>
<a name="ln-4961"></a><span class="k">  IF</span><span class="p">(</span><span class="n">LatDegradModelSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4962"></a>  <span class="c">!Calculate for SHReff using the Latent Degradation Model</span>
<a name="ln-4963"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4964"></a><span class="k">        </span><span class="n">QLatRated</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">QSensible</span>
<a name="ln-4965"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4966"></a><span class="k">        </span><span class="n">QLatActual</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">-</span><span class="n">QSensible</span>
<a name="ln-4967"></a>        <span class="n">SHRss</span><span class="o">=</span><span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-4968"></a>        <span class="n">SHReff</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span> <span class="n">SHRss</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span> <span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4969"></a>                 <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">LoadSideInletDBTemp</span><span class="p">,</span> <span class="n">LoadSideInletWBTemp</span><span class="p">)</span>
<a name="ln-4970"></a><span class="c">!       Update sensible capacity based on effective SHR</span>
<a name="ln-4971"></a>        <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">*</span> <span class="n">SHReff</span>
<a name="ln-4972"></a>        <span class="k">EXIT </span><span class="n">LOOP</span>
<a name="ln-4973"></a>    <span class="k">END IF</span>
<a name="ln-4974"></a><span class="k">  ELSE</span>
<a name="ln-4975"></a>  <span class="c">!Assume SHReff=SHRss</span>
<a name="ln-4976"></a>    <span class="n">SHReff</span> <span class="o">=</span> <span class="n">QSensible</span><span class="o">/</span><span class="n">QLoadTotal</span>
<a name="ln-4977"></a>    <span class="k">EXIT </span><span class="n">LOOP</span>
<a name="ln-4978"></a>  <span class="k">END IF</span>
<a name="ln-4979"></a><span class="k">  END DO </span><span class="n">LOOP</span>
<a name="ln-4980"></a>
<a name="ln-4981"></a>  <span class="c">!calculate coil outlet state variables</span>
<a name="ln-4982"></a>  <span class="n">LoadSideOutletEnth</span>   <span class="o">=</span> <span class="n">LoadSideInletEnth</span> <span class="o">-</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-4983"></a>  <span class="n">LoadSideOutletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">-</span> <span class="n">QSensible</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span><span class="p">)</span>
<a name="ln-4984"></a>  <span class="n">LoadsideOutletHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">LoadSideOutletEnth</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4985"></a>  <span class="nb">Count</span> <span class="o">=</span> <span class="nb">Count</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4986"></a>  <span class="c">!Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-4987"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4988"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-4989"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadSideOutletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4990"></a>                                                  <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletEnth</span>
<a name="ln-4991"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadsideOutletHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4992"></a>                                                  <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletHumRat</span>
<a name="ln-4993"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4994"></a>                                                             <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-4995"></a>                                                             <span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-4996"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span>
<a name="ln-4997"></a>  <span class="k">ELSE</span>
<a name="ln-4998"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-4999"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LoadSideOutletEnth</span>
<a name="ln-5000"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">LoadsideOutletHumRat</span>
<a name="ln-5001"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">LoadSideOutletDBTemp</span>
<a name="ln-5002"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5003"></a>  <span class="k">END IF</span>
<a name="ln-5004"></a>
<a name="ln-5005"></a>   <span class="c">! scale heat transfer rates to PLR and power to RTF</span>
<a name="ln-5006"></a>  <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5007"></a>  <span class="n">QSensible</span>  <span class="o">=</span> <span class="n">QSensible</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5008"></a>  <span class="n">Winput</span>     <span class="o">=</span> <span class="n">Winput</span><span class="o">*</span><span class="n">RuntimeFrac</span>
<a name="ln-5009"></a>  <span class="n">QSource</span>    <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a><span class="c">!  Add power to global variable so power can be summed by parent object</span>
<a name="ln-5012"></a>  <span class="n">DXElecCoolingPower</span> <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-5013"></a>
<a name="ln-5014"></a>  <span class="n">ReportingConstant</span><span class="o">=</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-5015"></a>  <span class="c">!Update heat pump data structure</span>
<a name="ln-5016"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span>               <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-5017"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span>          <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-5018"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span>           <span class="o">=</span> <span class="n">QSensible</span>
<a name="ln-5019"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span>             <span class="o">=</span> <span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">QSensible</span>
<a name="ln-5020"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span>             <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-5021"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="n">Winput</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5022"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5023"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5024"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="p">(</span><span class="n">QLoadTotal</span> <span class="o">-</span> <span class="n">QSensible</span><span class="p">)</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5025"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5026"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RunTimeFrac</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5027"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5028"></a>  <span class="k">ELSE</span>
<a name="ln-5029"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">Winput</span>
<a name="ln-5030"></a>  <span class="k">END IF</span>
<a name="ln-5031"></a><span class="k">  </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span>             <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-5032"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>       <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-5033"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>     <span class="o">=</span> <span class="n">PLRCorrLoadSideMdot</span>
<a name="ln-5034"></a>
<a name="ln-5035"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>   <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span>
<a name="ln-5036"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span><span class="p">)</span>
<a name="ln-5037"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SourceSideInletEnth</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-5038"></a>
<a name="ln-5039"></a><span class="k">END SUBROUTINE </span><span class="n">CalcHPCoolingSimple</span>
<a name="ln-5040"></a>
<a name="ln-5041"></a><span class="k">SUBROUTINE </span><span class="n">CalcHPHeatingSimple</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">CyclingScheme</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">SensDemand</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">WaterPartLoad</span><span class="p">)</span>
<a name="ln-5042"></a>
<a name="ln-5043"></a>
<a name="ln-5044"></a>          <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-5045"></a>          <span class="c">!       DATE WRITTEN   Jan 2004</span>
<a name="ln-5046"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5047"></a>          <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-5048"></a>
<a name="ln-5049"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5050"></a>          <span class="c">! This subroutine is for simulating the heating mode of the Water to Air HP Simple</span>
<a name="ln-5051"></a>
<a name="ln-5052"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5053"></a>          <span class="c">! Simulate the heat pump performance using the coefficients and rated conditions</span>
<a name="ln-5054"></a>          <span class="c">!</span>
<a name="ln-5055"></a>          <span class="c">! Finally, adjust the heat pump outlet conditions based on the PartLoadRatio</span>
<a name="ln-5056"></a>          <span class="c">! and RuntimeFrac.</span>
<a name="ln-5057"></a>
<a name="ln-5058"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5059"></a>          <span class="c">! (1) Lash.T.A.,1992.Simulation and Analysis of a Water Loop Heat Pump System.</span>
<a name="ln-5060"></a>          <span class="c">! M.S. Thesis, University of Illinois at Urbana Champaign.</span>
<a name="ln-5061"></a>          <span class="c">! (2) Shenoy, Arun. 2004. Simulation, Modeling and Analysis of Water to Air Heat Pump.</span>
<a name="ln-5062"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-5063"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-5064"></a>          <span class="c">! (3) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-5065"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-5066"></a>          <span class="c">! Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-5067"></a>
<a name="ln-5068"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5069"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span><span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">DXElecHeatingPower</span>
<a name="ln-5070"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span><span class="n">PsyWFnTdbTwbPb</span><span class="p">,</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span><span class="n">PsyCpAirFnWTdb</span><span class="p">,</span><span class="n">PsyTwbFnTdbWPb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5071"></a>                                 <span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyWFnTdbH</span>
<a name="ln-5072"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span><span class="n">GetSpecificHeatGlycol</span>
<a name="ln-5073"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-5074"></a>
<a name="ln-5075"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5076"></a>
<a name="ln-5077"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5078"></a>
<a name="ln-5079"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>              <span class="c">! Heat Pump Number</span>
<a name="ln-5080"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span>      <span class="c">! Fan/Compressor cycling scheme indicator</span>
<a name="ln-5081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>        <span class="c">! Runtime Fraction of compressor</span>
<a name="ln-5082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensDemand</span>         <span class="c">! Cooling Sensible Demand [W] !unused1208</span>
<a name="ln-5083"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation flag</span>
<a name="ln-5084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! compressor part load ratio</span>
<a name="ln-5085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor on flow to average flow over time step</span>
<a name="ln-5086"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterPartLoad</span>      <span class="c">! water part load ratio</span>
<a name="ln-5087"></a>
<a name="ln-5088"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Tref</span><span class="o">=</span><span class="mi">28</span><span class="mf">3.15d0</span>      <span class="c">! Reference Temperature for performance curves,10C [K]</span>
<a name="ln-5090"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcHPHeatingSimple&#39;</span>
<a name="ln-5091"></a>
<a name="ln-5092"></a>
<a name="ln-5093"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5094"></a>          <span class="c">! na</span>
<a name="ln-5095"></a>
<a name="ln-5096"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5097"></a>          <span class="c">! na</span>
<a name="ln-5098"></a>
<a name="ln-5099"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5100"></a>
<a name="ln-5101"></a>
<a name="ln-5102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapRated</span>           <span class="c">! Rated Heating Capacity [W]</span>
<a name="ln-5103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerRated</span>         <span class="c">! Rated Heating Power Input[W]</span>
<a name="ln-5104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolFlowRateRated</span>    <span class="c">! Rated Air Volumetric Flow Rate [m3/s]</span>
<a name="ln-5105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterVolFlowRateRated</span>  <span class="c">! Rated Water Volumetric Flow Rate [m3/s]</span>
<a name="ln-5106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff1</span>          <span class="c">! 1st coefficient of the heating capacity performance curve</span>
<a name="ln-5107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff2</span>          <span class="c">! 2nd coefficient of the heating capacity performance curve</span>
<a name="ln-5108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff3</span>          <span class="c">! 3rd coefficient of the heating capacity performance curve</span>
<a name="ln-5109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff4</span>          <span class="c">! 4th coefficient of the heating capacity performance curve</span>
<a name="ln-5110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff5</span>          <span class="c">! 5th coefficient of the heating capacity performance curve</span>
<a name="ln-5111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff1</span>        <span class="c">! 1st coefficient of the heating power consumption curve</span>
<a name="ln-5112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff2</span>        <span class="c">! 2nd coefficient of the heating power consumption curve</span>
<a name="ln-5113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff3</span>        <span class="c">! 3rd coefficient of the heating power consumption curve</span>
<a name="ln-5114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff4</span>        <span class="c">! 4th coefficient of the heating power consumption curve</span>
<a name="ln-5115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff5</span>        <span class="c">! 5th coefficient of the heating power consumption curve</span>
<a name="ln-5116"></a>
<a name="ln-5117"></a><span class="c">!  REAL(r64) :: PartLoadRatio          ! Part load ratio</span>
<a name="ln-5118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTDB</span>               <span class="c">! Ratio of the inlet air dry bulb temperature to the rated conditions</span>
<a name="ln-5119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioTS</span>                <span class="c">! Ratio of the source side (water) inlet temperature to the rated conditions</span>
<a name="ln-5120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioVL</span>                <span class="c">! Ratio of the load side flow rate to the rated conditions</span>
<a name="ln-5121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ratioVS</span>                <span class="c">! Ratio of the source side flow rate to the rated conditions</span>
<a name="ln-5122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span>                <span class="c">! Specific heat of water [J/kg_C]</span>
<a name="ln-5123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>                  <span class="c">! Specific heat of air [J/kg_C]</span>
<a name="ln-5124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-5125"></a>
<a name="ln-5126"></a> <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-5127"></a>
<a name="ln-5128"></a>  <span class="n">HeatCapRated</span>           <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-5129"></a>  <span class="n">HeatPowerRated</span>         <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span>
<a name="ln-5130"></a>  <span class="n">AirVolFlowRateRated</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-5131"></a>  <span class="n">WaterVolFlowRateRated</span>  <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RatedWaterVolFlowRate</span>
<a name="ln-5132"></a>  <span class="n">HeatCapCoeff1</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap1</span>
<a name="ln-5133"></a>  <span class="n">HeatCapCoeff2</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap2</span>
<a name="ln-5134"></a>  <span class="n">HeatCapCoeff3</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap3</span>
<a name="ln-5135"></a>  <span class="n">HeatCapCoeff4</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap4</span>
<a name="ln-5136"></a>  <span class="n">HeatCapCoeff5</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatCap5</span>
<a name="ln-5137"></a>  <span class="n">HeatPowerCoeff1</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower1</span>
<a name="ln-5138"></a>  <span class="n">HeatPowerCoeff2</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower2</span>
<a name="ln-5139"></a>  <span class="n">HeatPowerCoeff3</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower3</span>
<a name="ln-5140"></a>  <span class="n">HeatPowerCoeff4</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower4</span>
<a name="ln-5141"></a>  <span class="n">HeatPowerCoeff5</span>        <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPower5</span>
<a name="ln-5142"></a>
<a name="ln-5143"></a>  <span class="n">LoadSideMassFlowRate</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>
<a name="ln-5144"></a>  <span class="n">LoadSideInletDBTemp</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-5145"></a>  <span class="n">LoadSideInletHumRat</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-5146"></a>
<a name="ln-5147"></a>  <span class="n">LoadSideInletWBTemp</span>    <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5148"></a>  <span class="n">LoadSideInletEnth</span>      <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-5149"></a>  <span class="n">CpAir</span>                  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5150"></a>  <span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-5151"></a>  <span class="n">SourceSideInletTemp</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-5152"></a>  <span class="n">SourceSideInletEnth</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-5153"></a>  <span class="n">CpWater</span>                <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5154"></a>                                   <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5155"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5156"></a>                                   <span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:SourceSideInletTemp&#39;</span><span class="p">)</span>
<a name="ln-5157"></a>
<a name="ln-5158"></a> <span class="c">!Check for flows, do not perform simulation if no flow in load side or source side.</span>
<a name="ln-5159"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">LoadSideMassFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5160"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5161"></a>    <span class="k">RETURN</span>
<a name="ln-5162"></a><span class="k">  ELSE</span>
<a name="ln-5163"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5164"></a>  <span class="n">ENDIF</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5167"></a><span class="k">    </span><span class="n">SimpleWaterToAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SimFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5168"></a>    <span class="k">RETURN</span>
<a name="ln-5169"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5170"></a>
<a name="ln-5171"></a>  <span class="n">ratioTDB</span> <span class="o">=</span> <span class="p">((</span><span class="n">LoadSideInletDBTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-5172"></a>  <span class="n">ratioTS</span> <span class="o">=</span> <span class="p">((</span><span class="n">SourceSideInletTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-5173"></a>  <span class="n">ratioVL</span> <span class="o">=</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-5174"></a>     <span class="p">(</span><span class="n">AirVolFlowRateRated</span><span class="o">*</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">LoadSideInletDBTemp</span><span class="p">,</span><span class="n">LoadSideInletHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)))</span>
<a name="ln-5175"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterPartLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5176"></a><span class="k">    </span><span class="n">ratioVS</span> <span class="o">=</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DesignWaterMassFlowRate</span><span class="o">*</span><span class="n">WaterPartLoad</span><span class="p">)</span>
<a name="ln-5177"></a>  <span class="k">ELSE</span>
<a name="ln-5178"></a><span class="k">    </span><span class="n">ratioVS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5179"></a>  <span class="n">ENDIF</span>
<a name="ln-5180"></a>
<a name="ln-5181"></a>  <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">HeatCapRated</span><span class="o">*</span><span class="p">(</span><span class="n">HeatCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTDB</span> <span class="o">*</span> <span class="n">HeatCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">HeatCapCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-5182"></a>                                  <span class="p">(</span><span class="n">ratioVL</span> <span class="o">*</span> <span class="n">HeatCapCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioVS</span> <span class="o">*</span> <span class="n">HeatCapCoeff5</span><span class="p">))</span>
<a name="ln-5183"></a>  <span class="n">QSensible</span> <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-5184"></a>  <span class="n">Winput</span> <span class="o">=</span> <span class="n">HeatPowerRated</span><span class="o">*</span><span class="p">(</span><span class="n">HeatPowerCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTDB</span> <span class="o">*</span> <span class="n">HeatPowerCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioTS</span> <span class="o">*</span> <span class="n">HeatPowerCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-5185"></a>                             <span class="p">(</span><span class="n">ratioVL</span> <span class="o">*</span> <span class="n">HeatPowerCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">ratioVS</span> <span class="o">*</span> <span class="n">HeatPowerCoeff5</span><span class="p">))</span>
<a name="ln-5186"></a>  <span class="n">Qsource</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">-</span><span class="n">Winput</span>
<a name="ln-5187"></a>
<a name="ln-5188"></a>  <span class="c">! calculate coil outlet state variables</span>
<a name="ln-5189"></a>  <span class="n">LoadSideOutletEnth</span>   <span class="o">=</span> <span class="n">LoadSideInletEnth</span> <span class="o">+</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-5190"></a>  <span class="n">LoadSideOutletDBTemp</span> <span class="o">=</span> <span class="n">LoadSideInletDBTemp</span> <span class="o">+</span> <span class="n">QSensible</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span><span class="p">)</span>
<a name="ln-5191"></a>  <span class="n">LoadsideOutletHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LoadSideOutletDBTemp</span><span class="p">,</span><span class="n">LoadSideOutletEnth</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5192"></a>
<a name="ln-5193"></a>  <span class="c">! Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-5194"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5195"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-5196"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadSideOutletEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5197"></a>                                                  <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletEnth</span>
<a name="ln-5198"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">LoadsideOutletHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5199"></a>                                                  <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LoadSideInletHumRat</span>
<a name="ln-5200"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5201"></a>                                                               <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5202"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span>
<a name="ln-5203"></a>  <span class="k">ELSE</span>
<a name="ln-5204"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-5205"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LoadSideOutletEnth</span>
<a name="ln-5206"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">LoadsideOutletHumRat</span>
<a name="ln-5207"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>   <span class="o">=</span> <span class="n">LoadSideOutletDBTemp</span>
<a name="ln-5208"></a>    <span class="n">PLRCorrLoadSideMdot</span> <span class="o">=</span> <span class="n">LoadSideMassFlowRate</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5209"></a>  <span class="k">END IF</span>
<a name="ln-5210"></a>
<a name="ln-5211"></a>
<a name="ln-5212"></a>   <span class="c">! scale heat transfer rates to PLR and power to RTF</span>
<a name="ln-5213"></a>  <span class="n">QLoadTotal</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5214"></a>  <span class="n">QSensible</span>  <span class="o">=</span> <span class="n">QSensible</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5215"></a>  <span class="n">Winput</span>     <span class="o">=</span> <span class="n">Winput</span><span class="o">*</span><span class="n">RuntimeFrac</span>
<a name="ln-5216"></a>  <span class="n">QSource</span>    <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5217"></a>
<a name="ln-5218"></a><span class="c">!  Add power to global variable so power can be summed by parent object</span>
<a name="ln-5219"></a>  <span class="n">DXElecHeatingPower</span> <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-5220"></a>
<a name="ln-5221"></a>  <span class="n">ReportingConstant</span><span class="o">=</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-5222"></a>  <span class="c">!Update heat pump data structure</span>
<a name="ln-5223"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span>               <span class="o">=</span> <span class="n">Winput</span>
<a name="ln-5224"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span>          <span class="o">=</span> <span class="n">QLoadTotal</span>
<a name="ln-5225"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span>           <span class="o">=</span> <span class="n">QSensible</span>
<a name="ln-5226"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span>             <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-5227"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="o">=</span><span class="n">Winput</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5228"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span><span class="o">=</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5229"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span><span class="o">=</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5230"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5231"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span><span class="o">=</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5232"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RunTimeFrac</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5233"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5234"></a>  <span class="k">ELSE</span>
<a name="ln-5235"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span> <span class="o">=</span> <span class="n">QLoadTotal</span><span class="o">/</span><span class="n">Winput</span>
<a name="ln-5236"></a>  <span class="k">END IF</span>
<a name="ln-5237"></a><span class="k">  </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span>             <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-5238"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>       <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-5239"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirMassFlowRate</span>     <span class="o">=</span> <span class="n">PLRCorrLoadSideMdot</span>
<a name="ln-5240"></a>
<a name="ln-5241"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>   <span class="o">=</span> <span class="n">SourceSideMassFlowRate</span>
<a name="ln-5242"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span><span class="p">)</span>
<a name="ln-5243"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SourceSideInletEnth</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-5244"></a>
<a name="ln-5245"></a><span class="k">END SUBROUTINE </span><span class="n">CalcHPHeatingSimple</span>
<a name="ln-5246"></a>
<a name="ln-5247"></a>
<a name="ln-5248"></a><span class="k">SUBROUTINE </span><span class="n">UpdateSimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span>
<a name="ln-5249"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5250"></a>          <span class="c">!       AUTHOR         Arun Shenoy</span>
<a name="ln-5251"></a>          <span class="c">!       DATE WRITTEN   Jan 2004</span>
<a name="ln-5252"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5253"></a>          <span class="c">!       RE-ENGINEERED  Kenneth Tang (Jan 2005)</span>
<a name="ln-5254"></a>
<a name="ln-5255"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5256"></a>          <span class="c">! This subroutine updates the Water to Air Heat Pump outlet nodes.</span>
<a name="ln-5257"></a>
<a name="ln-5258"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5259"></a>          <span class="c">! Data is moved from the HP data structure to the HP outlet nodes.</span>
<a name="ln-5260"></a>
<a name="ln-5261"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5262"></a>          <span class="c">! na</span>
<a name="ln-5263"></a>
<a name="ln-5264"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5265"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-5266"></a>  <span class="k">USe </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-5267"></a>  <span class="k">USE </span><span class="n">DataContaminantBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Contaminant</span>
<a name="ln-5268"></a>
<a name="ln-5269"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5270"></a>
<a name="ln-5271"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5272"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>
<a name="ln-5273"></a>
<a name="ln-5274"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5275"></a>          <span class="c">! na</span>
<a name="ln-5276"></a>
<a name="ln-5277"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5278"></a>          <span class="c">! na</span>
<a name="ln-5279"></a>
<a name="ln-5280"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5281"></a>          <span class="c">! na</span>
<a name="ln-5282"></a>
<a name="ln-5283"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5284"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">AirInletNode</span>
<a name="ln-5285"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">WaterInletNode</span>
<a name="ln-5286"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">AirOutletNode</span>
<a name="ln-5287"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">WaterOutletNode</span>
<a name="ln-5288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-5289"></a>
<a name="ln-5290"></a>
<a name="ln-5291"></a>  <span class="c">!WatertoAirHP(HPNum)%Simflag=.FALSE.</span>
<a name="ln-5292"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Simflag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5293"></a>    <span class="c">! Heatpump is off; just pass through conditions</span>
<a name="ln-5294"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5295"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5296"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5297"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5298"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5299"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5300"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5301"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5302"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5303"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5304"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">COP</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5305"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RunFrac</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5306"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5307"></a>
<a name="ln-5308"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>     <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirDBTemp</span>
<a name="ln-5309"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>     <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-5310"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-5311"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-5312"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-5313"></a>  <span class="k">END IF</span>
<a name="ln-5314"></a>
<a name="ln-5315"></a><span class="k">  </span><span class="n">AirInletNode</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-5316"></a>  <span class="n">WaterInletNode</span>  <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-5317"></a>  <span class="n">AirOutletNode</span>   <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-5318"></a>  <span class="n">WaterOutletNode</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-5319"></a>
<a name="ln-5320"></a>
<a name="ln-5321"></a>  <span class="c">! Set the air outlet  nodes of the WatertoAirHPSimple</span>
<a name="ln-5322"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>     <span class="c">!LoadSideMassFlowRate</span>
<a name="ln-5323"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                  <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirDBTemp</span>
<a name="ln-5324"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>                <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-5325"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>              <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-5326"></a>
<a name="ln-5327"></a>   <span class="c">! Set the air outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-5328"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Quality</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-5329"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Press</span>                 <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-5330"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-5331"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>    <span class="c">!LoadSideMassFlowRate</span>
<a name="ln-5332"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-5333"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>     <span class="c">!LoadSideMassFlowRate</span>
<a name="ln-5334"></a>
<a name="ln-5335"></a>   <span class="c">! Set the water outlet node of the WatertoAirHPSimple</span>
<a name="ln-5336"></a>   <span class="c">! Set the water outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-5337"></a>  <span class="k">CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">WaterInletNode</span> <span class="p">,</span> <span class="n">WaterOutletNode</span><span class="p">)</span>
<a name="ln-5338"></a>
<a name="ln-5339"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>
<a name="ln-5340"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>            <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span>
<a name="ln-5341"></a>
<a name="ln-5342"></a>  <span class="n">ReportingConstant</span>                         <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-5343"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Energy</span>          <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5344"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLoadTotal</span> <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLoadTotal</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5345"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySensible</span>  <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSensible</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5346"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergyLatent</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QLatent</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5347"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">EnergySource</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-5348"></a>
<a name="ln-5349"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">CO2Simulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5350"></a><span class="k">     </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-5351"></a>   <span class="k">End If</span>
<a name="ln-5352"></a><span class="k">   IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">GenericContamSimulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5353"></a><span class="k">     </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">GenContam</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">GenContam</span>
<a name="ln-5354"></a>   <span class="k">End If</span>
<a name="ln-5355"></a>
<a name="ln-5356"></a><span class="k">  RETURN</span>
<a name="ln-5357"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateSimpleWatertoAirHP</span>
<a name="ln-5358"></a>
<a name="ln-5359"></a><span class="c">!        End of Update subroutines for the WatertoAirHP Module</span>
<a name="ln-5360"></a><span class="c">! *****************************************************************************</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a><span class="k">FUNCTION </span><span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">HPNum</span><span class="p">,</span><span class="n">SHRss</span><span class="p">,</span> <span class="n">CyclingScheme</span><span class="p">,</span> <span class="n">RTF</span><span class="p">,</span> <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">EnteringDB</span><span class="p">,</span> <span class="n">EnteringWB</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SHReff</span><span class="p">)</span>
<a name="ln-5363"></a>
<a name="ln-5364"></a>        <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5365"></a>        <span class="c">!    AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5366"></a>        <span class="c">!    DATE WRITTEN   September 2003</span>
<a name="ln-5367"></a>        <span class="c">!    MODIFIED       Kenneth Tang (Aug 2004) Added capability for simulating CycFanCycCoil</span>
<a name="ln-5368"></a>        <span class="c">!    RE-ENGINEERED  na</span>
<a name="ln-5369"></a>
<a name="ln-5370"></a>        <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5371"></a>        <span class="c">!    Adjust sensible heat ratio to account for degradation of DX coil latent</span>
<a name="ln-5372"></a>        <span class="c">!    capacity at part-load (cycling) conditions.</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5375"></a>        <span class="c">!    With model parameters entered by the user, the part-load latent performance</span>
<a name="ln-5376"></a>        <span class="c">!    of a DX cooling coil is determined for a constant air flow system with</span>
<a name="ln-5377"></a>        <span class="c">!    a cooling coil that cycles on/off. The model calculates the time</span>
<a name="ln-5378"></a>        <span class="c">!    required for condensate to begin falling from the cooling coil.</span>
<a name="ln-5379"></a>        <span class="c">!    Runtimes greater than this are integrated to a &quot;part-load&quot; latent</span>
<a name="ln-5380"></a>        <span class="c">!    capacity which is used to determine the &quot;part-load&quot; sensible heat ratio.</span>
<a name="ln-5381"></a>        <span class="c">!    See reference below for additional details (linear decay model, Eq. 8b).</span>
<a name="ln-5382"></a>
<a name="ln-5383"></a>        <span class="c">!    For cycling fan operation, a modified version of Henderson and Rengarajan (1996)</span>
<a name="ln-5384"></a>        <span class="c">!    model is used by ultilizing the fan delay time as the time-off (or time duration</span>
<a name="ln-5385"></a>        <span class="c">!    for the re-evaporation of moisture from time coil). Refer to Tang, C.C. (2005)</span>
<a name="ln-5386"></a>
<a name="ln-5387"></a>        <span class="c">! REFERENCES:</span>
<a name="ln-5388"></a>        <span class="c">!    (1) Henderson, H.I., K. Rengarajan.1996. A Model to Predict the Latent</span>
<a name="ln-5389"></a>        <span class="c">!    Capacity of Air Conditioners and Heat Pumps at Part-Load Conditions</span>
<a name="ln-5390"></a>        <span class="c">!    with Constant Fan Operation ASHRAE Transactions 102 (1), pp. 266-274.</span>
<a name="ln-5391"></a>        <span class="c">!    (2) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-5392"></a>        <span class="c">!    State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-5393"></a>        <span class="c">!    Oklahoma State University. (downloadable from www.hvac.okstate.edu)</span>
<a name="ln-5394"></a>
<a name="ln-5395"></a>
<a name="ln-5396"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5397"></a>
<a name="ln-5398"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5399"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPNum</span>         <span class="c">! Index number for cooling coil</span>
<a name="ln-5400"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CyclingScheme</span> <span class="c">! Fan/compressor cycling scheme indicator</span>
<a name="ln-5401"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRss</span>         <span class="c">! Steady-state sensible heat ratio</span>
<a name="ln-5402"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RTF</span>           <span class="c">! Compressor run-time fraction</span>
<a name="ln-5403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>     <span class="c">! Rated latent capacity</span>
<a name="ln-5404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>    <span class="c">! Actual latent capacity</span>
<a name="ln-5405"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringDB</span>    <span class="c">! Entering air dry-bulb temperature</span>
<a name="ln-5406"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringWB</span>    <span class="c">! Entering air wet-bulb temperature</span>
<a name="ln-5407"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SHReff</span>        <span class="c">! Effective sensible heat ratio, includes degradation due to cycling effects</span>
<a name="ln-5408"></a>
<a name="ln-5409"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5410"></a>          <span class="c">! na</span>
<a name="ln-5411"></a>
<a name="ln-5412"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5413"></a>          <span class="c">! na</span>
<a name="ln-5414"></a>
<a name="ln-5415"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5416"></a>          <span class="c">! na</span>
<a name="ln-5417"></a>
<a name="ln-5418"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5419"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet</span>                 <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s condensate drain line</span>
<a name="ln-5420"></a>                                    <span class="c">! at the current operating conditions (sec)</span>
<a name="ln-5421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">Gamma</span>                <span class="c">! Initial moisture evaporation rate divided by steady-state AC latent capacity</span>
<a name="ln-5422"></a>                                    <span class="c">! at the current operating conditions</span>
<a name="ln-5423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_rated</span>           <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-5424"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_rated</span>          <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-5425"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_max</span>             <span class="c">! Maximum allowed value for Twet</span>
<a name="ln-5426"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>  <span class="c">! Maximum cycling rate of heat pump [cycles/hr]</span>
<a name="ln-5427"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPTimeConstant</span>       <span class="c">! Heat pump time constant [s]</span>
<a name="ln-5428"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanDelayTime</span>         <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-5429"></a>                                    <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-5430"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ton</span>                  <span class="c">! Coil on time (sec)</span>
<a name="ln-5431"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toff</span>                 <span class="c">! Coil off time (sec)</span>
<a name="ln-5432"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toffa</span>                <span class="c">! Actual coil off time (sec). Equations valid for Toff &lt;= (2.0 * Twet/Gamma)</span>
<a name="ln-5433"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aa</span>                   <span class="c">! Intermediate variable</span>
<a name="ln-5434"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To1</span>                  <span class="c">! Intermediate variable (first guess at To). To = time to the start of moisture removal</span>
<a name="ln-5435"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To2</span>                  <span class="c">! Intermediate variable (second guess at To). To = time to the start of moisture removal</span>
<a name="ln-5436"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Error</span>                <span class="c">! Error for iteration (DO) loop</span>
<a name="ln-5437"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LHRmult</span>              <span class="c">! Latent Heat Ratio (LHR) multiplier. The effective latent heat ratio LHR = (1-SHRss)*LHRmult</span>
<a name="ln-5438"></a>
<a name="ln-5439"></a>   <span class="n">Twet_rated</span>               <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Twet_Rated</span>
<a name="ln-5440"></a>   <span class="n">Gamma_rated</span>              <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span>
<a name="ln-5441"></a>   <span class="n">MaxONOFFCyclesperHour</span>    <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-5442"></a>   <span class="n">HPTimeConstant</span>           <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>
<a name="ln-5443"></a>   <span class="n">FanDelayTime</span>             <span class="o">=</span> <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanDelayTime</span>
<a name="ln-5444"></a>
<a name="ln-5445"></a><span class="c">!  No moisture evaporation (latent degradation) occurs for runtime fraction of 1.0</span>
<a name="ln-5446"></a><span class="c">!  All latent degradation model parameters cause divide by 0.0 if not greater than 0.0</span>
<a name="ln-5447"></a><span class="c">!  Latent degradation model parameters initialize to 0.0 meaning no evaporation model used.</span>
<a name="ln-5448"></a>   <span class="k">IF</span><span class="p">((</span><span class="n">RTF</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatRated</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatActual</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Twet_rated</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5449"></a>      <span class="p">(</span><span class="n">Gamma_rated</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">HPTimeConstant</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">RTF</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5450"></a><span class="k">     </span><span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span>
<a name="ln-5451"></a>     <span class="k">RETURN</span>
<a name="ln-5452"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-5453"></a>
<a name="ln-5454"></a>   <span class="n">Twet_max</span>   <span class="o">=</span> <span class="mi">999</span><span class="mf">9.0d0</span> <span class="c">! high limit for Twet</span>
<a name="ln-5455"></a>
<a name="ln-5456"></a><span class="c">!  Calculate the model parameters at the actual operating conditions</span>
<a name="ln-5457"></a>   <span class="n">Twet</span>    <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Twet_rated</span><span class="o">*</span><span class="n">QLatRated</span> <span class="o">/</span><span class="p">(</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">),</span><span class="n">Twet_max</span><span class="p">)</span>
<a name="ln-5458"></a>   <span class="nb">Gamma</span>   <span class="o">=</span> <span class="n">Gamma_rated</span><span class="o">*</span><span class="n">QLatRated</span><span class="o">*</span><span class="p">(</span><span class="n">EnteringDB</span><span class="o">-</span><span class="n">EnteringWB</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="mf">6.7d0</span><span class="o">-</span><span class="mi">1</span><span class="mf">9.4d0</span><span class="p">)</span><span class="o">*</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">)</span>
<a name="ln-5459"></a>
<a name="ln-5460"></a><span class="c">!  Calculate the compressor on and off times using a converntional thermostat curve</span>
<a name="ln-5461"></a>   <span class="n">Ton</span>  <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RTF</span><span class="p">))</span>   <span class="c">! duration of cooling coil on-cycle (sec)</span>
<a name="ln-5462"></a>
<a name="ln-5463"></a>   <span class="k">IF</span> <span class="p">((</span><span class="n">CyclingScheme</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">FanDelayTime</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5464"></a>    <span class="c">! For CycFanCycCoil, moisture is evaporated from the cooling coil back to the air stream</span>
<a name="ln-5465"></a>    <span class="c">! until the fan cycle off. Assume no evaporation from the coil after the fan shuts off.</span>
<a name="ln-5466"></a>        <span class="n">Toff</span> <span class="o">=</span> <span class="n">FanDelayTime</span>
<a name="ln-5467"></a>   <span class="k">ELSE</span>
<a name="ln-5468"></a>    <span class="c">! For ContFanCycCoil, moisture is evaporated from the cooling coil back to the air stream</span>
<a name="ln-5469"></a>    <span class="c">! for the entire heat pump off-cycle.</span>
<a name="ln-5470"></a>        <span class="n">Toff</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxONOFFCyclesperHour</span><span class="o">*</span><span class="n">RTF</span><span class="p">)</span>        <span class="c">! duration of cooling coil off-cycle (sec)</span>
<a name="ln-5471"></a>   <span class="k">END IF</span>
<a name="ln-5472"></a>
<a name="ln-5473"></a><span class="c">!  Cap Toff to meet the equation restriction</span>
<a name="ln-5474"></a>   <span class="k">IF</span><span class="p">(</span><span class="nb">Gamma</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5475"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Toff</span><span class="p">,</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Twet</span><span class="o">/</span><span class="nb">Gamma</span><span class="p">)</span>
<a name="ln-5476"></a>   <span class="k">ELSE</span>
<a name="ln-5477"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="n">Toff</span>
<a name="ln-5478"></a>   <span class="k">END IF</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a><span class="c">!  Use sucessive substitution to solve for To</span>
<a name="ln-5481"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Gamma</span><span class="o">*</span><span class="n">Toffa</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.25d0</span><span class="o">/</span><span class="n">Twet</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">Gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Toffa</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5482"></a>
<a name="ln-5483"></a>   <span class="n">To1</span> <span class="o">=</span> <span class="n">aa</span><span class="o">+</span><span class="n">HPTimeConstant</span>
<a name="ln-5484"></a>   <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5485"></a>   <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Error</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-5486"></a>       <span class="n">To2</span> <span class="o">=</span> <span class="n">aa</span><span class="o">-</span><span class="n">HPTimeConstant</span><span class="o">*</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">To1</span><span class="o">/</span><span class="n">HPTimeConstant</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-5487"></a>       <span class="n">Error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">To2</span><span class="o">-</span><span class="n">To1</span><span class="p">)</span><span class="o">/</span><span class="n">To1</span><span class="p">)</span>
<a name="ln-5488"></a>       <span class="n">To1</span> <span class="o">=</span> <span class="n">To2</span>
<a name="ln-5489"></a>   <span class="k">END DO</span>
<a name="ln-5490"></a>
<a name="ln-5491"></a><span class="c">!  Adjust Sensible Heat Ratio (SHR) using Latent Heat Ratio (LHR) multiplier</span>
<a name="ln-5492"></a><span class="c">!  Floating underflow errors occur when -Ton/HPTimeConstant is a large negative number.</span>
<a name="ln-5493"></a><span class="c">!  Cap lower limit at -700 to avoid the underflow errors.</span>
<a name="ln-5494"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="mf">0.0d0</span><span class="p">,</span><span class="o">-</span><span class="n">Ton</span><span class="o">/</span><span class="n">HPTimeConstant</span><span class="p">))</span>
<a name="ln-5495"></a><span class="c">!  Calculate latent heat ratio multiplier</span>
<a name="ln-5496"></a>   <span class="n">LHRmult</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(((</span><span class="n">Ton</span><span class="o">-</span><span class="n">To2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Ton</span><span class="o">+</span><span class="n">HPTimeConstant</span><span class="o">*</span><span class="p">(</span><span class="n">aa</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-5497"></a>
<a name="ln-5498"></a><span class="c">!  Calculate part-load or &quot;effective&quot; sensible heat ratio</span>
<a name="ln-5499"></a>   <span class="n">SHReff</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHRss</span><span class="p">)</span><span class="o">*</span><span class="n">LHRmult</span>
<a name="ln-5500"></a>
<a name="ln-5501"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SHRss</span><span class="p">)</span> <span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span> <span class="c">! Effective SHR can be less than the steady-state SHR</span>
<a name="ln-5502"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHReff</span><span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Effective sensible heat ratio can&#39;t be greater than 1.0</span>
<a name="ln-5503"></a>
<a name="ln-5504"></a> <span class="k">RETURN</span>
<a name="ln-5505"></a>
<a name="ln-5506"></a><span class="k">END FUNCTION </span><span class="n">CalcEffectiveSHR</span>
<a name="ln-5507"></a>
<a name="ln-5508"></a><span class="k">FUNCTION </span><span class="n">GetCoilIndex</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)</span>
<a name="ln-5509"></a>
<a name="ln-5510"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5511"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-5512"></a>          <span class="c">!       DATE WRITTEN   August 2007</span>
<a name="ln-5513"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5514"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5515"></a>
<a name="ln-5516"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5517"></a>          <span class="c">! This function looks up the coil capacity for the given coil and returns it.  If</span>
<a name="ln-5518"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and index is returned</span>
<a name="ln-5519"></a>          <span class="c">! as zero.</span>
<a name="ln-5520"></a>
<a name="ln-5521"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5522"></a>          <span class="c">! na</span>
<a name="ln-5523"></a>
<a name="ln-5524"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5525"></a>          <span class="c">! na</span>
<a name="ln-5526"></a>
<a name="ln-5527"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5528"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5529"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5530"></a>
<a name="ln-5531"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5532"></a>
<a name="ln-5533"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5534"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5535"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5536"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5537"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IndexNum</span>     <span class="c">! returned index of matched coil</span>
<a name="ln-5538"></a>
<a name="ln-5539"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5540"></a>          <span class="c">! na</span>
<a name="ln-5541"></a>
<a name="ln-5542"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5543"></a>          <span class="c">! na</span>
<a name="ln-5544"></a>
<a name="ln-5545"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5546"></a>          <span class="c">! na</span>
<a name="ln-5547"></a>
<a name="ln-5548"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5549"></a>          <span class="c">! na</span>
<a name="ln-5550"></a>
<a name="ln-5551"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5552"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5553"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-5554"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5555"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5556"></a>  <span class="k">End If</span>
<a name="ln-5557"></a>
<a name="ln-5558"></a><span class="k">  </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">SimpleWaterToAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-5559"></a>
<a name="ln-5560"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IndexNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5561"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5562"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5563"></a>  <span class="n">ENDIF</span>
<a name="ln-5564"></a>
<a name="ln-5565"></a>  <span class="k">RETURN</span>
<a name="ln-5566"></a>
<a name="ln-5567"></a><span class="k">END FUNCTION </span><span class="n">GetCoilIndex</span>
<a name="ln-5568"></a>
<a name="ln-5569"></a><span class="k">FUNCTION </span><span class="n">GetCoilCapacity</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilCapacity</span><span class="p">)</span>
<a name="ln-5570"></a>
<a name="ln-5571"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5572"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5573"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-5574"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5575"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5576"></a>
<a name="ln-5577"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5578"></a>          <span class="c">! This function looks up the coil capacity for the given coil and returns it.  If</span>
<a name="ln-5579"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-5580"></a>          <span class="c">! as negative.</span>
<a name="ln-5581"></a>
<a name="ln-5582"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5583"></a>          <span class="c">! na</span>
<a name="ln-5584"></a>
<a name="ln-5585"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5586"></a>          <span class="c">! na</span>
<a name="ln-5587"></a>
<a name="ln-5588"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5589"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5590"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-5591"></a>
<a name="ln-5592"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5593"></a>
<a name="ln-5594"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5595"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5596"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5597"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CoilCapacity</span> <span class="c">! returned capacity of matched coil</span>
<a name="ln-5599"></a>
<a name="ln-5600"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5601"></a>          <span class="c">! na</span>
<a name="ln-5602"></a>
<a name="ln-5603"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5604"></a>          <span class="c">! na</span>
<a name="ln-5605"></a>
<a name="ln-5606"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5607"></a>          <span class="c">! na</span>
<a name="ln-5608"></a>
<a name="ln-5609"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5610"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5611"></a>
<a name="ln-5612"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5613"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5614"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-5615"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5616"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5617"></a>  <span class="k">End If</span>
<a name="ln-5618"></a>
<a name="ln-5619"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5620"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5621"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">SimpleWaterToAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-5622"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5623"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5624"></a><span class="k">        </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">SimpleWaterToAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-5625"></a>      <span class="k">ELSE</span>
<a name="ln-5626"></a><span class="k">        </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">SimpleWaterToAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedCapCoolTotal</span>
<a name="ln-5627"></a>      <span class="n">ENDIF</span>
<a name="ln-5628"></a>    <span class="n">ENDIF</span>
<a name="ln-5629"></a>  <span class="k">ELSE</span>
<a name="ln-5630"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5631"></a>  <span class="n">ENDIF</span>
<a name="ln-5632"></a>
<a name="ln-5633"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5634"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5635"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5636"></a>    <span class="n">CoilCapacity</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5637"></a>  <span class="n">ENDIF</span>
<a name="ln-5638"></a>
<a name="ln-5639"></a>  <span class="k">RETURN</span>
<a name="ln-5640"></a>
<a name="ln-5641"></a><span class="k">END FUNCTION </span><span class="n">GetCoilCapacity</span>
<a name="ln-5642"></a>
<a name="ln-5643"></a><span class="k">FUNCTION </span><span class="n">GetCoilAirFlowRate</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilAirFlowRate</span><span class="p">)</span>
<a name="ln-5644"></a>
<a name="ln-5645"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5646"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5647"></a>          <span class="c">!       DATE WRITTEN   October 2011</span>
<a name="ln-5648"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5649"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5650"></a>
<a name="ln-5651"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5652"></a>          <span class="c">! This function looks up the coil air flow rate for the given coil and returns it.  If</span>
<a name="ln-5653"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-5654"></a>          <span class="c">! as negative.</span>
<a name="ln-5655"></a>
<a name="ln-5656"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5657"></a>          <span class="c">! na</span>
<a name="ln-5658"></a>
<a name="ln-5659"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5660"></a>          <span class="c">! na</span>
<a name="ln-5661"></a>
<a name="ln-5662"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5663"></a><span class="c">!  USE FluidProperties, ONLY: FindGlycol</span>
<a name="ln-5664"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5665"></a>
<a name="ln-5666"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5667"></a>
<a name="ln-5668"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5669"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5670"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5671"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5672"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CoilAirFlowRate</span> <span class="c">! returned air volume flow rate of matched coil</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5675"></a>          <span class="c">! na</span>
<a name="ln-5676"></a>
<a name="ln-5677"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5678"></a>          <span class="c">! na</span>
<a name="ln-5679"></a>
<a name="ln-5680"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5681"></a>          <span class="c">! na</span>
<a name="ln-5682"></a>
<a name="ln-5683"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5684"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5685"></a>
<a name="ln-5686"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5687"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5688"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-5689"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5690"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5691"></a>  <span class="k">End If</span>
<a name="ln-5692"></a>
<a name="ln-5693"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5694"></a>      <span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5695"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">SimpleWaterToAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterToAirHPs</span><span class="p">)</span>
<a name="ln-5696"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5697"></a><span class="k">      </span><span class="n">CoilAirFlowRate</span><span class="o">=</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span>
<a name="ln-5698"></a>    <span class="n">ENDIF</span>
<a name="ln-5699"></a>  <span class="k">ELSE</span>
<a name="ln-5700"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5701"></a>  <span class="n">ENDIF</span>
<a name="ln-5702"></a>
<a name="ln-5703"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5704"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5705"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5706"></a>    <span class="n">CoilAirFlowRate</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5707"></a>  <span class="n">ENDIF</span>
<a name="ln-5708"></a>
<a name="ln-5709"></a>  <span class="k">RETURN</span>
<a name="ln-5710"></a>
<a name="ln-5711"></a><span class="k">END FUNCTION </span><span class="n">GetCoilAirFlowRate</span>
<a name="ln-5712"></a>
<a name="ln-5713"></a><span class="k">FUNCTION </span><span class="n">GetCoilInletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-5714"></a>
<a name="ln-5715"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5716"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5717"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-5718"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5719"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5720"></a>
<a name="ln-5721"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5722"></a>          <span class="c">! This function looks up the given coil and returns the inlet node.  If</span>
<a name="ln-5723"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-5724"></a>          <span class="c">! as zero.</span>
<a name="ln-5725"></a>
<a name="ln-5726"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5727"></a>          <span class="c">! na</span>
<a name="ln-5728"></a>
<a name="ln-5729"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5730"></a>          <span class="c">! na</span>
<a name="ln-5731"></a>
<a name="ln-5732"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5733"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5734"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5735"></a>
<a name="ln-5736"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5737"></a>
<a name="ln-5738"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5739"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5740"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5741"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5742"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned outlet node of matched coil</span>
<a name="ln-5743"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5744"></a>          <span class="c">! na</span>
<a name="ln-5745"></a>
<a name="ln-5746"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5747"></a>          <span class="c">! na</span>
<a name="ln-5748"></a>
<a name="ln-5749"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5750"></a>          <span class="c">! na</span>
<a name="ln-5751"></a>
<a name="ln-5752"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5753"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5754"></a>
<a name="ln-5755"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5756"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5757"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-5758"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5759"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5760"></a>  <span class="k">End If</span>
<a name="ln-5761"></a>
<a name="ln-5762"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5763"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5764"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-5765"></a>  <span class="n">ENDIF</span>
<a name="ln-5766"></a>
<a name="ln-5767"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5768"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5769"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5770"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5771"></a>  <span class="n">ENDIF</span>
<a name="ln-5772"></a>
<a name="ln-5773"></a>  <span class="k">RETURN</span>
<a name="ln-5774"></a>
<a name="ln-5775"></a><span class="k">END FUNCTION </span><span class="n">GetCoilInletNode</span>
<a name="ln-5776"></a>
<a name="ln-5777"></a><span class="k">FUNCTION </span><span class="n">GetCoilOutletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-5778"></a>
<a name="ln-5779"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5780"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-5781"></a>          <span class="c">!       DATE WRITTEN   July 2007</span>
<a name="ln-5782"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5783"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5784"></a>
<a name="ln-5785"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5786"></a>          <span class="c">! This function looks up the given coil and returns the outlet node.  If</span>
<a name="ln-5787"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-5788"></a>          <span class="c">! as zero.</span>
<a name="ln-5789"></a>
<a name="ln-5790"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5791"></a>          <span class="c">! na</span>
<a name="ln-5792"></a>
<a name="ln-5793"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5794"></a>          <span class="c">! na</span>
<a name="ln-5795"></a>
<a name="ln-5796"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5797"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5798"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5799"></a>
<a name="ln-5800"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5801"></a>
<a name="ln-5802"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5803"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-5804"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-5805"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-5806"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned outlet node of matched coil</span>
<a name="ln-5807"></a>
<a name="ln-5808"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5809"></a>          <span class="c">! na</span>
<a name="ln-5810"></a>
<a name="ln-5811"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5812"></a>          <span class="c">! na</span>
<a name="ln-5813"></a>
<a name="ln-5814"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5815"></a>          <span class="c">! na</span>
<a name="ln-5816"></a>
<a name="ln-5817"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5818"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-5819"></a>
<a name="ln-5820"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5821"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5822"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-5823"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5824"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5825"></a>  <span class="k">End If</span>
<a name="ln-5826"></a>
<a name="ln-5827"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">SimpleWatertoAirHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWatertoAirHPs</span><span class="p">)</span>
<a name="ln-5828"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5829"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-5830"></a>  <span class="n">ENDIF</span>
<a name="ln-5831"></a>
<a name="ln-5832"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5833"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5834"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5835"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5836"></a>  <span class="n">ENDIF</span>
<a name="ln-5837"></a>
<a name="ln-5838"></a>  <span class="k">RETURN</span>
<a name="ln-5839"></a>
<a name="ln-5840"></a><span class="k">END FUNCTION </span><span class="n">GetCoilOutletNode</span>
<a name="ln-5841"></a>
<a name="ln-5842"></a> <span class="k">SUBROUTINE </span><span class="n">SetSimpleWSHPData</span><span class="p">(</span><span class="n">SimpleWSHPNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">WaterCyclingMode</span><span class="p">,</span><span class="n">CompanionCoolingCoilNum</span><span class="p">,</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)</span>
<a name="ln-5843"></a>
<a name="ln-5844"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5845"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5846"></a>          <span class="c">!       DATE WRITTEN   June 2009</span>
<a name="ln-5847"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5848"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5849"></a>
<a name="ln-5850"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5851"></a>          <span class="c">! This routine was designed to &quot;push&quot; information from a parent object to</span>
<a name="ln-5852"></a>          <span class="c">! this WSHP coil object.</span>
<a name="ln-5853"></a>
<a name="ln-5854"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5855"></a>          <span class="c">! na</span>
<a name="ln-5856"></a>
<a name="ln-5857"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5858"></a>          <span class="c">! na</span>
<a name="ln-5859"></a>
<a name="ln-5860"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5861"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-5862"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-5863"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-5864"></a>
<a name="ln-5865"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5866"></a>
<a name="ln-5867"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5868"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SimpleWSHPNum</span>  <span class="c">! Number of OA Controller</span>
<a name="ln-5869"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>    <span class="c">! Set to true if certain errors found</span>
<a name="ln-5870"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WaterCyclingMode</span>  <span class="c">! the coil water flow mode (cycling, constant or constantondemand)</span>
<a name="ln-5871"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span>      <span class="kd">::</span> <span class="n">CompanionCoolingCoilNum</span>  <span class="c">! Index to cooling coil for heating coil = SimpleWSHPNum</span>
<a name="ln-5872"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span>      <span class="kd">::</span> <span class="n">CompanionHeatingCoilNum</span>  <span class="c">! Index to heating coil for cooling coil = SimpleWSHPNum</span>
<a name="ln-5873"></a>
<a name="ln-5874"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5875"></a>          <span class="c">! na</span>
<a name="ln-5876"></a>
<a name="ln-5877"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5878"></a>          <span class="c">! na</span>
<a name="ln-5879"></a>
<a name="ln-5880"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5881"></a>          <span class="c">! na</span>
<a name="ln-5882"></a>
<a name="ln-5883"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5884"></a>          <span class="c">! na</span>
<a name="ln-5885"></a>
<a name="ln-5886"></a>  <span class="c">! Obtains and Allocates WatertoAirHP related parameters from input file</span>
<a name="ln-5887"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5888"></a>    <span class="k">CALL </span><span class="n">GetSimpleWatertoAirHPInput</span>
<a name="ln-5889"></a><span class="c">!    WaterIndex=FindGlycol(&#39;WATER&#39;) !Initialize the WaterIndex once</span>
<a name="ln-5890"></a>    <span class="n">GetCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5891"></a>  <span class="k">End If</span>
<a name="ln-5892"></a>
<a name="ln-5893"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SimpleWSHPNum</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SimpleWSHPNum</span> <span class="o">&gt;</span> <span class="n">NumWatertoAirHPs</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5894"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetSimpleWSHPData: called with WSHP Coil Number out of range=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5895"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleWSHPNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be &gt;0 and &lt;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWatertoAirHPs</span><span class="p">)))</span>
<a name="ln-5896"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5897"></a>    <span class="k">RETURN</span>
<a name="ln-5898"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5899"></a>
<a name="ln-5900"></a>  <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWSHPNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCyclingMode</span>
<a name="ln-5901"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompanionCoolingCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5902"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWSHPNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="o">=</span><span class="n">CompanionCoolingCoilNum</span>
<a name="ln-5903"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">SimpleWSHPNum</span>
<a name="ln-5904"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">CompanionCoolingCoilNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCyclingMode</span>
<a name="ln-5905"></a>  <span class="n">ENDIF</span>
<a name="ln-5906"></a>
<a name="ln-5907"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompanionHeatingCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5908"></a><span class="k">    </span><span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">SimpleWSHPNum</span><span class="p">)%</span><span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">CompanionHeatingCoilNum</span>
<a name="ln-5909"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">CompanionCoolingCoilNum</span><span class="o">=</span><span class="n">SimpleWSHPNum</span>
<a name="ln-5910"></a>    <span class="n">SimpleWatertoAirHP</span><span class="p">(</span><span class="n">CompanionHeatingCoilNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCyclingMode</span>
<a name="ln-5911"></a>  <span class="n">ENDIF</span>
<a name="ln-5912"></a>
<a name="ln-5913"></a>  <span class="k">RETURN</span>
<a name="ln-5914"></a>
<a name="ln-5915"></a><span class="k">END SUBROUTINE </span><span class="n">SetSimpleWSHPData</span>
<a name="ln-5916"></a>
<a name="ln-5917"></a><span class="k">END MODULE </span><span class="n">WatertoAirHeatPumpSimple</span>
<a name="ln-5918"></a>
<a name="ln-5919"></a><span class="c">!     NOTICE</span>
<a name="ln-5920"></a><span class="c">!</span>
<a name="ln-5921"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-5922"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-5923"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-5924"></a><span class="c">!</span>
<a name="ln-5925"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-5926"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-5927"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-5928"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-5929"></a><span class="c">!</span>
<a name="ln-5930"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-5931"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-5932"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-5933"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-5934"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-5935"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-5936"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-5937"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-5938"></a><span class="c">!     permit others to do so.</span>
<a name="ln-5939"></a><span class="c">!</span>
<a name="ln-5940"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-5941"></a><span class="c">!</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
