<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>DemandManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>DemandManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.3% of total for source files.">1038 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/DemandManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">DemandManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/demandmanager.html">DemandManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/demandmanager.f90.html#src">DemandManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~demandmanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiledemandmanagerf90EfferentGraph" width="641pt" height="586pt"
 viewBox="0.00 0.00 641.00 586.27" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~demandmanager.f90~~EfferentGraph" class="graph" transform="scale(.3865 .3865) rotate(0) translate(4 1512.904)">
<title>sourcefile~~demandmanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1512.904 1654.5054,-1512.904 1654.5054,4 -4,4"/>
<!-- sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~demandmanager.f90</title>
<polygon fill="none" stroke="#000000" points="1650.5396,-637.4106 1540.4028,-637.4106 1540.4028,-615.3998 1650.5396,-615.3998 1650.5396,-637.4106"/>
<text text-anchor="middle" x="1595.4712" y="-623.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">DemandManager.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1149.3777,-432.4106 1035.0479,-432.4106 1035.0479,-410.3998 1149.3777,-410.3998 1149.3777,-432.4106"/>
<text text-anchor="middle" x="1092.2128" y="-418.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1117.5295,-432.4215C1127.4468,-436.7556 1138.9149,-441.7905 1149.2952,-446.4052 1200.6438,-469.233 1210.7454,-514.6379 1264.5439,-498.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.5439,-498.4052C1373.6543,-465.4833 1358.1141,-236.3806 1442.1149,-313.4052"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495.8406,-794.4106 1388.3892,-794.4106 1388.3892,-772.3998 1495.8406,-772.3998 1495.8406,-794.4106"/>
<text text-anchor="middle" x="1442.1149" y="-780.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1264.5439,-725.4052C1302.2877,-745.3458 1348.1616,-760.114 1383.8272,-769.7572"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1383.0383,-773.1688 1393.6008,-772.3412 1384.8276,-766.4013 1383.0383,-773.1688"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1128.9542,-432.5305C1136.3683,-436.0611 1143.6183,-440.6075 1149.2952,-446.4052 1196.2266,-494.336 1205.2313,-694.0695 1264.5439,-725.4052"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~exteriorenergyusemanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/exteriorenergyusemanager.f90.html" xlink:title="ExteriorEnergyUseManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1344.0423,-167.4106 1185.0456,-167.4106 1185.0456,-145.3998 1344.0423,-145.3998 1344.0423,-167.4106"/>
<text text-anchor="middle" x="1264.5439" y="-153.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ExteriorEnergyUseManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1128.1199,-410.3177C1135.7509,-406.7596 1143.3027,-402.1922 1149.2952,-396.4052 1215.335,-332.63 1248.275,-223.3432 1259.7232,-177.5582"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1263.1853,-178.1307 1262.1232,-167.5892 1256.3798,-176.4922 1263.1853,-178.1307"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1332.9417,-794.4106 1196.1462,-794.4106 1196.1462,-772.3998 1332.9417,-772.3998 1332.9417,-794.4106"/>
<text text-anchor="middle" x="1264.5439" y="-780.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1106.2994,-432.533C1119.7292,-443.9989 1139.3376,-463.1551 1149.2952,-484.4052 1197.8609,-588.0479 1120.4691,-645.0758 1185.2952,-739.4052 1193.9129,-751.945 1207.3256,-761.2891 1220.682,-768.0626"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1219.3185,-771.2886 1229.8601,-772.3489 1222.2806,-764.9462 1219.3185,-771.2886"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1453.1439,-772.1142C1479.3392,-745.2964 1545.4931,-677.5708 1577.5324,-644.7702"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1580.0583,-647.1932 1584.5421,-637.594 1575.0508,-642.3019 1580.0583,-647.1932"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-1240.4106 528.0262,-1240.4106 528.0262,-1218.3998 643.4123,-1218.3998 643.4123,-1240.4106"/>
<text text-anchor="middle" x="585.7192" y="-1226.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M618.2128,-1240.4977C678.9284,-1261.2104 813.744,-1307.1358 927.4618,-1345.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.4618,-1345.4052C1004.4773,-1369.3029 1014.2694,-1442.0772 1092.2128,-1421.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1092.2128,-1421.4052C1264.7145,-1375.6547 1293.7237,-1323.5517 1442.1149,-1224.4052"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-813.4106 721.7644,-813.4106 721.7644,-791.3998 788.502,-791.3998 788.502,-813.4106"/>
<text text-anchor="middle" x="755.1332" y="-799.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M637.049,-1218.3019C643.7591,-1214.8513 649.8846,-1210.3297 654.4731,-1204.4052 756.7262,-1072.3819 592.2197,-965.4315 690.4731,-830.4052 695.9703,-822.8506 703.9426,-817.3115 712.4239,-813.2577"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="713.8244,-816.4661 721.7337,-809.4167 711.1547,-809.9952 713.8244,-816.4661"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.1149,-1224.4052C1542.2986,-1157.4682 1584.7977,-746.8443 1593.6605,-647.8588"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1597.152,-648.1074 1594.5367,-637.8404 1590.1786,-647.4974 1597.152,-648.1074"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M769.223,-813.4293C788.4682,-828.3648 824.1974,-855.6593 855.7932,-877.4052 998.6484,-975.7259 1027.6374,-1014.1653 1185.2952,-1086.4052 1218.7516,-1101.7352 1231.3279,-1094.5611 1264.5439,-1110.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.5439,-1110.4052C1351.296,-1146.037 1364.1346,-1276.5072 1442.1149,-1224.4052"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M770.9172,-791.2368C785.7796,-779.8779 807.5375,-760.9232 819.7932,-739.4052 853.5105,-680.2061 808.1544,-639.1077 855.7932,-590.4052 878.8359,-566.8481 902.059,-592.3957 927.4618,-571.4052"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M927.4618,-801.4052C1002.4703,-796.8759 1017.1657,-767.244 1092.2128,-763.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M788.5271,-803.2876C823.2699,-803.9533 879.231,-804.3176 927.4618,-801.4052"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M763.9682,-791.3031C776.4653,-775.5759 799.9903,-745.8855 819.7932,-720.4052 835.9398,-699.6294 834.1408,-688.3557 855.7932,-673.4052 910.5243,-635.6147 940.0974,-661.0437 999.1304,-630.4052 1074.4681,-591.3045 1100.7447,-582.0291 1149.2952,-512.4052 1226.457,-401.7512 1254.269,-236.3733 1262.0215,-177.8586"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1265.5329,-177.9881 1263.3132,-167.6284 1258.588,-177.1111 1265.5329,-177.9881"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1148.0296,-1236.4106 1036.396,-1236.4106 1036.396,-1214.3998 1148.0296,-1214.3998 1148.0296,-1236.4106"/>
<text text-anchor="middle" x="1092.2128" y="-1222.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M927.4618,-996.4052C991.8845,-1068.02 1054.5628,-1164.7626 1080.1513,-1205.7517"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1077.1938,-1207.6238 1085.4391,-1214.2771 1083.1425,-1203.9341 1077.1938,-1207.6238"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M769.3532,-813.6283C783.8571,-825.7481 806.1178,-846.3085 819.7932,-868.4052 845.5341,-909.9973 821.0321,-937.9936 855.7932,-972.4052 879.6655,-996.0375 904.9963,-971.4317 927.4618,-996.4052"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="982.5998,-621.4106 872.3237,-621.4106 872.3237,-599.3998 982.5998,-599.3998 982.5998,-621.4106"/>
<text text-anchor="middle" x="927.4618" y="-607.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M770.1937,-791.1854C784.7258,-779.6495 806.4332,-760.4415 819.7932,-739.4052 846.016,-698.1153 821.2477,-670.0333 855.7932,-635.4052 859.4229,-631.7668 863.61,-628.6568 868.1005,-625.9986"/>
<polygon fill="#ff006d" stroke="#ff006d" points="869.7346,-629.0941 877.0429,-621.4234 866.5462,-622.8623 869.7346,-629.0941"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M927.4618,-801.4052C1000.5513,-796.9918 1019.2031,-806.9864 1092.2128,-801.4052"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1104.4106 -.2403,-1104.4106 -.2403,-1082.3998 130.719,-1082.3998 130.719,-1104.4106"/>
<text text-anchor="middle" x="65.2394" y="-1090.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1425.4052C267.9636,-1446.9116 270.5645,-1469.0993 317.2024,-1484.4052 430.8764,-1521.7115 466.0942,-1505.2496 585.7192,-1503.4052"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-155.4052C590.7271,-3.8007 720.297,-177.8144 927.4618,-307.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.4618,-307.4052C981.3413,-338.252 982.2593,-363.8602 1035.1304,-396.4052 1040.8873,-399.9489 1047.2345,-403.2521 1053.541,-406.221"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1052.1216,-409.4203 1062.6781,-410.3208 1054.9873,-403.0337 1052.1216,-409.4203"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M585.7192,-79.4052C704.7878,-49.104 733.6714,-124.923 855.7932,-138.4052 919.1139,-145.3958 935.4746,-140.9196 999.1304,-138.4052 1028.6899,-137.2376 1238.744,-102.9314 1264.5439,-117.4052"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M66.0225,-1104.7376C70.2419,-1155.5737 95.1621,-1362.8293 223.8406,-1425.4052"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M223.8406,-1425.4052C290.4347,-1457.7898 255.8508,-1328.8723 317.2024,-1287.4052 377.0296,-1246.9684 460.0163,-1234.075 517.8398,-1230.2894"/>
<polygon fill="#ffda00" stroke="#ffda00" points="518.192,-1233.7749 527.9726,-1229.702 517.7868,-1226.7867 518.192,-1233.7749"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M223.8406,-534.4052C282.232,-488.8641 264.3105,-620.5786 317.2024,-672.4052 348.1657,-702.7449 362.4391,-702.2452 399.0839,-725.4052"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-725.4052C412.3687,-733.8014 619.7309,-775.5911 711.7365,-793.8474"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="711.0913,-797.2876 721.581,-795.7984 712.4521,-790.4211 711.0913,-797.2876"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1045.4106 180.0456,-1045.4106 180.0456,-1023.3998 267.6355,-1023.3998 267.6355,-1045.4106"/>
<text text-anchor="middle" x="223.8406" y="-1031.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M95.0711,-1082.3078C120.4358,-1072.872 157.043,-1059.254 184.7476,-1048.9479"/>
<polygon fill="#00ff24" stroke="#00ff24" points="185.9905,-1052.2199 194.1427,-1045.4529 183.5498,-1045.6592 185.9905,-1052.2199"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-506.4106 344.7839,-506.4106 344.7839,-484.3998 453.3838,-484.3998 453.3838,-506.4106"/>
<text text-anchor="middle" x="399.0839" y="-492.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M223.8406,-534.4052C255.0456,-510.0676 298.4039,-500.2779 334.1844,-496.5922"/>
<polygon fill="#00ff91" stroke="#00ff91" points="334.8894,-500.0434 344.5399,-495.6711 334.2691,-493.0709 334.8894,-500.0434"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1092.2128,-41.4052C1147.6058,-56.9963 1135.8516,-101.9637 1185.2952,-131.4052 1192.0934,-135.4533 1199.616,-138.9143 1207.2407,-141.854"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1206.3116,-145.2386 1216.9062,-145.3037 1208.6646,-138.6459 1206.3116,-145.2386"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504.2597,-247.4106 1379.9701,-247.4106 1379.9701,-225.3998 1504.2597,-225.3998 1504.2597,-247.4106"/>
<text text-anchor="middle" x="1442.1149" y="-233.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M585.7192,-79.4052C665.3906,-57.8934 672.7111,-7.5151 755.1332,-3.4052"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-155.4052C466.0869,-95.9739 499.2529,-102.7517 585.7192,-79.4052"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1092.2128,-41.4052C1200.3326,-71.837 1249.3536,-4.6003 1343.7927,-65.4052 1398.5639,-100.6698 1426.2258,-177.9421 1436.8249,-215.3231"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1433.4914,-216.4044 1439.4746,-225.1481 1440.25,-214.5816 1433.4914,-216.4044"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M755.1332,-3.4052C905.7082,4.103 947.685,1.501 1092.2128,-41.4052"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M223.8406,-534.4052C352.4399,-432.6256 201.6237,-293.76 317.2024,-177.4052 343.7586,-150.6707 370.8932,-180.4102 399.0839,-155.4052"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M66.6788,-1081.9784C76.1385,-1008.8485 131.8841,-607.1839 223.8406,-534.4052"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.3078,-1475.4106 341.8599,-1475.4106 341.8599,-1453.3998 456.3078,-1453.3998 456.3078,-1475.4106"/>
<text text-anchor="middle" x="399.0839" y="-1461.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M223.8406,-1425.4052C257.3713,-1441.7111 297.8306,-1451.2939 331.4215,-1456.8762"/>
<polygon fill="#0024ff" stroke="#0024ff" points="331.1873,-1460.3825 341.6105,-1458.4833 332.2779,-1453.468 331.1873,-1460.3825"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-622.4106 350.2841,-622.4106 350.2841,-600.3998 447.8836,-600.3998 447.8836,-622.4106"/>
<text text-anchor="middle" x="399.0839" y="-608.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M223.8406,-534.4052C261.2927,-505.1952 273.4973,-567.8107 317.2024,-586.4052 326.7378,-590.4621 337.1525,-594.1635 347.2604,-597.4021"/>
<polygon fill="#4800ff" stroke="#4800ff" points="346.2308,-600.7472 356.8186,-600.3619 348.3015,-594.0605 346.2308,-600.7472"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M223.8406,-1425.4052C310.1849,-1467.0087 560.0598,-1417.9072 654.4731,-1401.4052 811.9607,-1373.8788 857.1549,-1371.9103 999.1304,-1298.4052 1027.4402,-1283.7484 1055.6416,-1260.0264 1073.4575,-1243.6215"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1075.9802,-1246.054 1080.8755,-1236.6579 1071.1892,-1240.9504 1075.9802,-1246.054"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-967.4106 536.1602,-967.4106 536.1602,-945.3998 635.2783,-945.3998 635.2783,-967.4106"/>
<text text-anchor="middle" x="585.7192" y="-953.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M223.8406,-917.4052C291.2198,-878.3379 324.2722,-895.739 399.0839,-917.4052"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M399.0839,-917.4052C422.5099,-924.1896 480.8043,-936.0854 526.0645,-944.9603"/>
<polygon fill="#ff00da" stroke="#ff00da" points="525.6036,-948.4364 536.0892,-946.9186 526.9457,-941.5662 525.6036,-948.4364"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M223.8406,-534.4052C269.0191,-499.1692 428.198,-537.7274 480.9653,-515.4052 500.6811,-507.0649 496.9555,-491.0129 516.9653,-483.4052 574.0905,-461.6863 595.0309,-469.2061 654.4731,-483.4052 752.0329,-506.7096 763.4965,-546.133 855.7932,-585.4052 864.5199,-589.1184 874.0042,-592.7197 883.1303,-595.9785"/>
<polygon fill="#ff006d" stroke="#ff006d" points="882.245,-599.3765 892.8398,-599.3693 884.5529,-592.7679 882.245,-599.3765"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-663.4106 334.3841,-663.4106 334.3841,-641.3998 463.7837,-641.3998 463.7837,-663.4106"/>
<text text-anchor="middle" x="399.0839" y="-649.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-534.4052C271.0229,-497.6064 265.5086,-601.2707 317.2024,-631.4052 321.1605,-633.7126 325.3709,-635.7695 329.7133,-637.6027"/>
<polygon fill="#00ffff" stroke="#00ffff" points="328.7921,-640.9965 339.3835,-641.269 331.2738,-634.4511 328.7921,-640.9965"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-917.4052C264.9296,-893.5813 271.2312,-877.3441 317.2024,-865.4052 387.649,-847.11 410.1048,-848.7851 480.9653,-865.4052 531.57,-877.2744 533.7697,-915.6876 585.7192,-917.4052"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="999.2993,-129.4106 855.6242,-129.4106 855.6242,-107.3998 999.2993,-107.3998 999.2993,-129.4106"/>
<text text-anchor="middle" x="927.4618" y="-115.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M755.1332,-3.4052C823.7247,.015 885.8633,-65.6403 913.0179,-99.2338"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="910.5064,-101.7023 919.4391,-107.3995 916.0089,-97.3753 910.5064,-101.7023"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-1125.4106 539.0902,-1125.4106 539.0902,-1103.3998 632.3482,-1103.3998 632.3482,-1125.4106"/>
<text text-anchor="middle" x="585.7192" y="-1111.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-917.4052C434.9679,-927.7976 453.5722,-911.0027 480.9653,-936.4052 520.2358,-972.8219 488.2353,-1006.2064 516.9653,-1051.4052 528.436,-1069.4513 546.3718,-1085.6459 561.0482,-1097.0959"/>
<polygon fill="#ff0000" stroke="#ff0000" points="559.1463,-1100.0452 569.2393,-1103.2674 563.3586,-1094.4545 559.1463,-1100.0452"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-813.4106 353.1239,-813.4106 353.1239,-791.3998 445.0438,-791.3998 445.0438,-813.4106"/>
<text text-anchor="middle" x="399.0839" y="-799.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-917.4052C273.7005,-888.4958 267.5243,-856.6259 317.2024,-827.4052 325.1995,-822.7013 334.165,-818.8049 343.1511,-815.602"/>
<polygon fill="#00ffff" stroke="#00ffff" points="344.4677,-818.8532 352.8653,-812.3933 342.2721,-812.2064 344.4677,-818.8532"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M71.794,-1082.1467C90.8226,-1050.5456 149.4719,-960.525 223.8406,-917.4052"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-1222.4106 168.8556,-1222.4106 168.8556,-1200.3998 278.8255,-1200.3998 278.8255,-1222.4106"/>
<text text-anchor="middle" x="223.8406" y="-1208.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M80.1602,-1104.5064C107.9086,-1125.1513 167.6245,-1169.5802 200.6666,-1194.1637"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.7316,-1197.0865 208.8439,-1200.2476 202.91,-1191.4703 198.7316,-1197.0865"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-1164.4106 340.6161,-1164.4106 340.6161,-1142.3998 457.5516,-1142.3998 457.5516,-1164.4106"/>
<text text-anchor="middle" x="399.0839" y="-1150.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M126.8607,-1104.4801C184.565,-1114.8509 270.6463,-1130.3218 330.5045,-1141.0798"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.1578,-1144.5735 340.6193,-1142.8977 331.3961,-1137.6839 330.1578,-1144.5735"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-813.4106 517.2105,-813.4106 517.2105,-791.3998 654.2279,-791.3998 654.2279,-813.4106"/>
<text text-anchor="middle" x="585.7192" y="-799.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-725.4052C431.1409,-745.6657 447.2077,-732.1264 480.9653,-749.4052 499.0089,-758.6408 499.2247,-767.6003 516.9653,-777.4052 523.9217,-781.2498 531.5854,-784.7087 539.1951,-787.7407"/>
<polygon fill="#ff0000" stroke="#ff0000" points="538.1561,-791.0895 548.7477,-791.3498 540.6301,-784.5413 538.1561,-791.0895"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-1359.4106 323.0941,-1359.4106 323.0941,-1337.3998 475.0737,-1337.3998 475.0737,-1359.4106"/>
<text text-anchor="middle" x="399.0839" y="-1345.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1425.4052C251.8221,-1439.0125 332.6346,-1391.5125 374.0162,-1365.0224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="375.9583,-1367.9346 382.452,-1359.563 372.1551,-1362.0578 375.9583,-1367.9346"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-1318.4106 317.3208,-1318.4106 317.3208,-1296.3998 480.847,-1296.3998 480.847,-1318.4106"/>
<text text-anchor="middle" x="399.0839" y="-1304.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1425.4052C277.6511,-1451.5731 265.5086,-1358.5397 317.2024,-1328.4052 321.1605,-1326.0979 325.3709,-1324.041 329.7133,-1322.2078"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.2738,-1325.3593 339.3835,-1318.5414 328.7921,-1318.8139 331.2738,-1325.3593"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-967.4106 358.7923,-967.4106 358.7923,-945.3998 439.3754,-945.3998 439.3754,-967.4106"/>
<text text-anchor="middle" x="399.0839" y="-953.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-917.4052C234.9169,-910.9831 303.9689,-928.8716 352.0106,-942.5092"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.3378,-945.9571 361.9149,-945.3445 353.2643,-939.2274 351.3378,-945.9571"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.4362,-1045.4986C242.3832,-1070.4309 276.4351,-1131.9527 317.2024,-1173.4052 379.3855,-1236.6334 412.1468,-1231.4716 480.9653,-1287.4052 498.0437,-1301.286 496.7606,-1312.6808 516.9653,-1321.4052 684.7463,-1393.8532 752.9173,-1291.2445 927.4618,-1345.4052"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.9909,-1023.3615C244.9027,-1005.2179 269.7661,-967.5027 281.2024,-931.4052 304.1493,-858.9754 266.8677,-648.318 317.2024,-591.4052 341.9522,-563.421 374.283,-600.3442 399.0839,-572.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-572.4052C428.5201,-539.2443 446.1378,-542.8494 480.9653,-515.4052 497.7796,-502.1556 499.6161,-495.9461 516.9653,-483.4052 616.1124,-411.7368 634.203,-326.9011 755.1332,-345.4052"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M585.7192,-1190.4052C752.685,-1222.5857 1215.1243,-1197.5699 1343.7927,-1086.4052 1388.0087,-1048.2043 1426.2213,-866.6193 1438.2148,-804.3882"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1441.6603,-805.0039 1440.0872,-794.5266 1434.7832,-803.6982 1441.6603,-805.0039"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M399.0839,-1114.4052C434.6095,-1125.9638 451.5619,-1110.3595 480.9653,-1133.4052 508.8116,-1155.2304 490.4867,-1180.9396 516.9653,-1204.4052 521.124,-1208.0907 525.8693,-1211.2466 530.8793,-1213.9463"/>
<polygon fill="#ffda00" stroke="#ffda00" points="529.5786,-1217.2032 540.1135,-1218.3291 532.5801,-1210.8793 529.5786,-1217.2032"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-879.4052C501.0464,-828.404 547.392,-894.5345 654.4731,-855.4052 672.7695,-848.7194 673.4517,-839.8777 690.4731,-830.4052 698.7941,-825.7746 708.0333,-821.3711 716.8629,-817.4849"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="718.4012,-820.6337 726.2204,-813.4846 715.6495,-814.1972 718.4012,-820.6337"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M232.0295,-1023.3737C244.9956,-1005.2471 269.9336,-967.5553 281.2024,-931.4052 330.7667,-772.4032 236.5372,-704.1152 317.2024,-558.4052 328.3729,-538.2273 348.98,-522.4252 366.7256,-511.6937"/>
<polygon fill="#00ff91" stroke="#00ff91" points="368.7533,-514.5653 375.6794,-506.5478 365.2653,-508.4962 368.7533,-514.5653"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M232.4176,-1023.1311C245.6838,-1004.9656 270.7395,-967.5838 281.2024,-931.4052 301.4518,-861.3869 276.0996,-336.5979 317.2024,-276.4052 388.2868,-172.3063 730.5024,-112.2545 855.7932,-98.4052 919.113,-91.406 935.7932,-91.5655 999.1304,-98.4052 1076.2253,-106.7306 1163.7624,-128.2835 1216.5337,-142.6408"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1215.7216,-146.0473 1226.2915,-145.3216 1217.576,-139.2974 1215.7216,-146.0473"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M228.608,-1045.6389C239.2849,-1071.1456 265.4158,-1135.555 281.2024,-1191.4052 303.038,-1268.6558 282.0373,-1296.2397 317.2024,-1368.4052 332.2316,-1399.2481 359.5204,-1428.2853 378.4418,-1446.1812"/>
<polygon fill="#0024ff" stroke="#0024ff" points="376.2575,-1448.9282 385.9786,-1453.1415 381.0068,-1443.7857 376.2575,-1448.9282"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M585.7192,-1190.4052C661.4907,-1205.0092 683.1321,-1200.6487 755.1332,-1228.4052"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M267.4916,-1024.9966C332.1264,-1011.0651 453.4611,-984.9124 526.1953,-969.2351"/>
<polygon fill="#ff00da" stroke="#ff00da" points="527.0868,-972.6234 536.1249,-967.0949 525.6119,-965.7806 527.0868,-972.6234"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M399.0839,-572.4052C429.459,-538.694 727.0333,-579.5456 861.7694,-600.0301"/>
<polygon fill="#ff006d" stroke="#ff006d" points="861.5467,-603.5366 871.9608,-601.588 862.6045,-596.617 861.5467,-603.5366"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1086.4106 334.8633,-1086.4106 334.8633,-1064.3998 463.3044,-1064.3998 463.3044,-1086.4106"/>
<text text-anchor="middle" x="399.0839" y="-1072.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-1044.6455C290.1527,-1049.9196 317.9132,-1056.4145 342.1073,-1062.0749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="341.347,-1065.4915 351.8814,-1064.3617 342.9417,-1058.6756 341.347,-1065.4915"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1045.4106 354.6193,-1045.4106 354.6193,-1023.3998 443.5485,-1023.3998 443.5485,-1045.4106"/>
<text text-anchor="middle" x="399.0839" y="-1031.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M267.6098,-1034.4052C290.8508,-1034.4052 319.6377,-1034.4052 344.3447,-1034.4052"/>
<polygon fill="#cbff00" stroke="#cbff00" points="344.6556,-1037.9053 354.6555,-1034.4052 344.6555,-1030.9053 344.6556,-1037.9053"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1114.4052C434.6095,-1125.9638 446.7716,-1110.4537 480.9653,-1095.4052 566.5523,-1057.7388 580.8263,-1034.0249 654.4731,-976.4052 671.3334,-963.2141 672.1232,-955.4303 690.4731,-944.4052 716.7487,-928.6182 727.0986,-932.8029 755.1332,-920.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M237.5065,-1045.5759C254.9569,-1059.2904 286.5731,-1082.3333 317.2024,-1095.4052 351.5627,-1110.0694 363.2079,-1103.9848 399.0839,-1114.4052"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-1160.4106 690.3127,-1160.4106 690.3127,-1138.3998 819.9536,-1138.3998 819.9536,-1160.4106"/>
<text text-anchor="middle" x="755.1332" y="-1146.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1114.4052C434.6095,-1125.9638 446.0433,-1120.134 480.9653,-1133.4052 530.5116,-1152.234 533.6737,-1180.3741 585.7192,-1190.4052"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-1190.4052C609.8584,-1195.0577 671.5971,-1177.2898 713.4857,-1163.6864"/>
<polygon fill="#0066ff" stroke="#0066ff" points="714.7419,-1166.9577 723.1479,-1160.5087 712.5549,-1160.3081 714.7419,-1166.9577"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M232.1023,-1023.396C245.1706,-1005.3009 270.2492,-967.6522 281.2024,-931.4052 340.0091,-736.7991 236.5384,-662.0147 317.2024,-475.4052 369.6057,-354.1744 406.3363,-327.5456 516.9653,-255.4052 622.6006,-186.5212 766.189,-149.0704 852.5461,-131.4469"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="853.4115,-134.8432 862.5286,-129.4461 852.0358,-127.9797 853.4115,-134.8432"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1114.4052C440.9077,-1128.013 490.8502,-1127.1903 528.5434,-1123.4143"/>
<polygon fill="#ff0000" stroke="#ff0000" points="529.2766,-1126.8548 538.8331,-1122.2805 528.5099,-1119.8969 529.2766,-1126.8548"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M230.0691,-1023.2964C240.6355,-1004.4342 262.7268,-964.9259 281.2024,-931.4052 297.3311,-902.1425 295.4943,-890.8061 317.2024,-865.4052 332.881,-847.0594 354.697,-830.5954 371.8683,-819.1028"/>
<polygon fill="#00ffff" stroke="#00ffff" points="373.9014,-821.9555 380.3672,-813.5624 370.0786,-816.0914 373.9014,-821.9555"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M231.7946,-1045.4279C246.4772,-1064.991 279.7767,-1105.8404 317.2024,-1128.4052 324.0799,-1132.5518 331.7018,-1136.0617 339.4475,-1139.019"/>
<polygon fill="#00ffff" stroke="#00ffff" points="338.3204,-1142.3327 348.9152,-1142.3577 340.6484,-1135.7312 338.3204,-1142.3327"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M228.5832,-1023.3695C239.9935,-998.1456 271.462,-935.9469 317.2024,-903.4052 348.1029,-881.4213 365.1673,-896.3701 399.0839,-879.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-879.4052C450.2972,-853.7885 463.8322,-848.7567 516.9653,-827.4052 525.7931,-823.8578 535.3413,-820.2459 544.4325,-816.911"/>
<polygon fill="#ff0000" stroke="#ff0000" points="545.8556,-820.118 554.0623,-813.4172 543.4681,-813.5377 545.8556,-820.118"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M228.376,-1045.7082C238.5778,-1071.3565 263.7997,-1136.0373 281.2024,-1191.4052 299.9507,-1251.0544 272.8195,-1283.3633 317.2024,-1327.4052 318.6868,-1328.8783 320.2597,-1330.2524 321.9066,-1331.534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="320.3905,-1334.7211 330.6909,-1337.2015 324.1855,-1328.839 320.3905,-1334.7211"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M229.0639,-1045.6797C242.2678,-1073.7744 278.682,-1148.7827 317.2024,-1206.4052 337.4,-1236.6187 364.5788,-1268.7771 381.9692,-1288.484"/>
<polygon fill="#00ffff" stroke="#00ffff" points="379.5097,-1290.985 388.774,-1296.1255 384.7374,-1286.3297 379.5097,-1290.985"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M240.8033,-1023.2574C259.0764,-1011.6161 289.2956,-993.4126 317.2024,-981.4052 327.342,-977.0425 338.4896,-973.107 349.207,-969.7181"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.345,-973.0303 358.8874,-966.763 348.3012,-966.3353 350.345,-973.0303"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.7019,-484.3664C424.5741,-465.9245 456.8894,-427.4156 480.9653,-392.4052 498.803,-366.4663 493.1541,-351.9974 516.9653,-331.4052 550.1164,-302.7359 1222.8807,-65.8002 1264.5439,-79.4052"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.4618,-421.4052C959.4442,-421.4052 994.9189,-421.4052 1024.7336,-421.4052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1025.0284,-424.9053 1035.0284,-421.4052 1025.0284,-417.9053 1025.0284,-424.9053"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-345.4052C785.434,-350.0417 791.5914,-357.3929 819.7932,-369.4052 868.6843,-390.23 874.3204,-421.4052 927.4618,-421.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-345.4052C655.7595,-317.7698 680.7044,-334.0165 755.1332,-345.4052"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M585.7192,-345.4052C644.8564,-322.9381 794.399,-420.1501 855.7932,-435.4052 984.1411,-467.2969 1043.6198,-404.8881 1149.2952,-484.4052 1244.1655,-555.792 1159.5656,-669.9436 1264.5439,-725.4052"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M423.4742,-484.3939C473.6425,-463.6049 589.1579,-425.6 654.4731,-483.4052 703.7632,-527.0279 650.0207,-725.4817 690.4731,-777.4052 696.0086,-784.5104 703.8333,-789.5978 712.1358,-793.2401"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="711.0232,-796.5605 721.616,-796.7688 713.465,-790.0002 711.0232,-796.5605"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M406.5843,-484.2857C423.4893,-460.0294 467.0127,-401.9374 516.9653,-369.4052 544.0863,-351.7424 555.6125,-357.2843 585.7192,-345.4052"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-345.4052C757.9811,-277.4366 827.2572,-224.4596 999.1304,-293.4052 1052.253,-314.7149 1036.5063,-395.5544 1092.2128,-382.4052"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M422.4883,-506.5478C441.7169,-517.0491 467.8477,-534.7101 480.9653,-558.4052 521.298,-631.2602 465.9659,-865.575 516.9653,-931.4052 519.8434,-935.1202 523.3257,-938.2836 527.1775,-940.9771"/>
<polygon fill="#ff00da" stroke="#ff00da" points="525.7022,-944.1674 536.1089,-946.1552 529.2132,-938.1116 525.7022,-944.1674"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1277.6097,-167.6718C1307.1958,-193.2456 1381.4557,-257.7836 1442.1149,-313.4052"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1456.8894,-247.5725C1471.0924,-259.0684 1492.1603,-278.2468 1504.437,-299.4052 1565.0427,-403.857 1586.953,-550.618 1593.2834,-605.0226"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1589.8288,-605.6266 1594.4061,-615.1816 1596.7864,-604.8577 1589.8288,-605.6266"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1503.4052C813.2519,-1488.2129 865.2939,-1443.983 1092.2128,-1421.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441.0513,-1475.4234C487.0799,-1487.1049 558.0825,-1503.8313 585.7192,-1503.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.5439,-79.4052C1299.6896,-90.3199 1318.6023,-76.5764 1343.7927,-103.4052 1391.6095,-154.3321 1344.4457,-196.1509 1379.7927,-256.4052 1398.7859,-288.782 1414.4485,-288.0365 1442.1149,-313.4052"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.1149,-313.4052C1534.3124,-397.9459 1577.6076,-550.0453 1590.8599,-605.4722"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1587.4512,-606.2664 1593.1154,-615.2199 1594.271,-604.6883 1587.4512,-606.2664"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0364,-605.955C460.4139,-602.2695 472.5623,-596.2339 480.9653,-586.4052 555.3428,-499.4085 456.7187,-428.7232 516.9653,-331.4052 613.1643,-176.0124 682.5672,-156.6623 855.7932,-98.4052 941.9813,-69.4196 1177.7036,-52.4365 1264.5439,-79.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-497.4052C621.7782,-482.8146 888.5627,-421.4052 927.4618,-421.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M927.4618,-687.4052C1004.6442,-710.7583 1011.68,-767.5246 1092.2128,-763.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M755.1332,-649.4052C768.6413,-650.1801 898.5964,-678.6714 927.4618,-687.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1092.2128,-763.4052C1170.5419,-759.3985 1195.1956,-688.7675 1264.5439,-725.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M585.7192,-687.4052C612.3814,-702.6046 664.1397,-761.6431 690.4731,-777.4052 697.226,-781.4472 704.7478,-785.0554 712.2052,-788.1878"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="710.9682,-791.4623 721.5541,-791.8977 713.5502,-784.9559 710.9682,-791.4623"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-497.4052C634.3933,-474.3091 639.8727,-454.9035 690.4731,-436.4052 859.6776,-374.5481 917.0801,-424.6545 1092.2128,-382.4052"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M447.1801,-600.2914C458.6232,-596.6894 470.532,-592.109 480.9653,-586.4052 534.5698,-557.1002 530.5257,-523.5948 585.7192,-497.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M585.7192,-687.4052C630.9982,-713.2176 627.9262,-737.5529 654.4731,-782.4052 673.5102,-814.5693 666.0211,-830.138 690.4731,-858.4052 735.6306,-910.6085 763.7746,-904.0779 819.7932,-944.4052 836.2437,-956.2478 837.9285,-962.8284 855.7932,-972.4052 885.3988,-988.276 904.9963,-971.4317 927.4618,-996.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M448.0183,-614.2254C460.3957,-617.3039 472.5485,-622.8045 480.9653,-632.4052 569.2011,-733.0526 433.7492,-826.5694 516.9653,-931.4052 519.8414,-935.0285 523.2907,-938.1268 527.0921,-940.7762"/>
<polygon fill="#ff00da" stroke="#ff00da" points="525.4854,-943.8905 535.8902,-945.8886 529.0024,-937.8382 525.4854,-943.8905"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M755.1332,-649.4052C779.1992,-652.0358 839.1031,-636.5955 881.5013,-624.3687"/>
<polygon fill="#ff006d" stroke="#ff006d" points="882.7134,-627.6611 891.3334,-621.5011 880.7533,-620.9411 882.7134,-627.6611"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M448.1116,-615.3605C499.5766,-619.6651 582.8128,-627.059 654.4731,-635.4052 699.3383,-640.6306 710.2322,-644.4972 755.1332,-649.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M448.1612,-622.0119C459.1101,-624.9226 470.5557,-628.4004 480.9653,-632.4052 530.0429,-651.2865 540.3429,-660.8327 585.7192,-687.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-763.4052C862.5974,-781.437 890.996,-773.9641 999.1304,-787.4052 1040.6461,-792.5656 1050.4992,-804.594 1092.2128,-801.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1092.2128,-801.4052C1122.7491,-798.4823 1156.3029,-795.0319 1185.6245,-791.9379"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1186.2317,-795.3933 1195.8076,-790.8599 1185.4946,-788.4322 1186.2317,-795.3933"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M585.7192,-687.4052C612.629,-703.1637 625.4726,-689.9407 654.4731,-701.4052 703.3366,-720.722 703.8697,-751.8798 755.1332,-763.4052"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0764,-616.9584C459.7469,-620.0859 471.5364,-624.9277 480.9653,-632.4052 508.0671,-653.898 499.2028,-671.7246 516.9653,-701.4052 534.4405,-730.6058 557.0145,-762.8729 571.4337,-782.8953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="568.7346,-785.1354 577.4373,-791.1782 574.4024,-781.0273 568.7346,-785.1354"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.5439,-1224.4052C1335.6311,-1190.1263 1376.4939,-1268.2494 1442.1149,-1224.4052"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1144.9839,-1236.4467C1180.5234,-1241.2361 1227.4884,-1242.2738 1264.5439,-1224.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1264.5439,-1224.4052C1297.6926,-1208.4206 1318.5961,-1227.2282 1343.7927,-1200.4052 1399.1348,-1141.491 1431.3765,-882.0419 1439.8518,-805.0292"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1443.3772,-804.9805 1440.9691,-794.663 1436.4176,-804.2304 1443.3772,-804.9805"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1096.6458,-1214.0351C1119.6908,-1154.9287 1225.9093,-882.4964 1256.3625,-804.3892"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1259.7685,-805.2884 1260.1402,-794.7001 1253.2466,-802.7456 1259.7685,-805.2884"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-958.4052C884.4669,-980.0235 909.3363,-1014.3864 1035.1304,-1051.4052 1085.6289,-1066.266 1215.8514,-1090.4057 1264.5439,-1110.4052"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M594.8428,-945.2202C609.1583,-927.2294 637.0572,-890.334 654.4731,-855.4052 676.6744,-810.8793 660.1387,-788.8422 690.4731,-749.4052 732.5566,-694.6936 774.2253,-715.2506 819.7932,-663.4052 843.675,-636.2335 827.799,-613.3173 855.7932,-590.4052 881.294,-569.5339 902.059,-592.3957 927.4618,-571.4052"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M927.4618,-958.4052C1006.4176,-954.0657 1192.7405,-1105.5281 1264.5439,-1072.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M755.1332,-958.4052C830.6756,-971.0322 851.4951,-948.6501 927.4618,-958.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M635.3711,-953.008C669.3291,-951.6553 715.2421,-951.7374 755.1332,-958.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1264.5439,-1072.4052C1372.051,-1014.7145 1421.852,-861.1074 1436.935,-804.6272"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1440.3912,-805.2402 1439.4955,-794.6833 1433.6123,-803.4947 1440.3912,-805.2402"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M600.375,-945.2301C615.2041,-933.4373 638.2033,-913.7695 654.4731,-893.4052 674.6027,-868.2099 666.4453,-851.9148 690.4731,-830.4052 696.8276,-824.7167 704.5167,-820.0499 712.3422,-816.2702"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="713.7756,-819.4633 721.5194,-812.2325 710.9566,-813.056 713.7756,-819.4633"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M595.791,-945.2449C611.1295,-927.5759 640.0771,-891.4548 654.4731,-855.4052 691.2176,-763.3925 637.1515,-718.9115 690.4731,-635.4052 804.0327,-457.5614 888.8756,-438.7807 1092.2128,-382.4052"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M606.5187,-967.4518C685.7952,-1009.5558 969.2252,-1160.0862 1062.3362,-1209.5377"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1060.7666,-1212.667 1071.24,-1214.2665 1064.05,-1206.4849 1060.7666,-1212.667"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M635.5809,-951.3124C670.2475,-946.4699 716.9084,-937.3093 755.1332,-920.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-920.4052C828.9123,-887.7781 849.0052,-882.1789 927.4618,-863.4052"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M593.9836,-967.557C611.1449,-990.5064 652.2365,-1044.3887 690.4731,-1086.4052 704.7998,-1102.1481 722.1239,-1118.9185 735.2328,-1131.1954"/>
<polygon fill="#0066ff" stroke="#0066ff" points="733.0763,-1133.9693 742.7857,-1138.2095 737.8397,-1128.8399 733.0763,-1133.9693"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~demandmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1092.2128,-498.4052C1151.3186,-449.694 1191.2175,-520.5301 1264.5439,-498.4052"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M977.8347,-599.3409C985.6755,-595.8827 993.1467,-591.3486 999.1304,-585.4052 1032.9415,-551.8221 1010.6587,-525.2971 1035.1304,-484.4052 1045.0781,-467.7827 1059.83,-451.6448 1071.8451,-439.864"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1074.4431,-442.2228 1079.2675,-432.7901 1069.6138,-437.1555 1074.4431,-442.2228"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M939.1554,-621.4151C964.6895,-644.7697 1028.2827,-699.2714 1092.2128,-725.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1092.2128,-725.4052C1163.1095,-754.3869 1196.8225,-689.6269 1264.5439,-725.4052"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1092.2128,-498.4052C1119.8803,-475.6034 1129.4914,-471.2921 1149.2952,-441.4052 1208.77,-351.6488 1246.079,-226.3645 1259.2223,-177.2898"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1262.6354,-178.0722 1261.7888,-167.5112 1255.8647,-176.2951 1262.6354,-178.0722"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M968.59,-599.3359C978.9451,-595.6795 989.7697,-591.0626 999.1304,-585.4052 1047.5935,-556.1151 1048.5139,-534.419 1092.2128,-498.4052"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M932.8723,-621.7488C945.9083,-649.4619 979.4307,-723.0531 999.1304,-787.4052 1047.2159,-944.484 1079.3398,-1140.6761 1089.0897,-1204.3846"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1085.6467,-1205.0257 1090.6025,-1214.3901 1092.5681,-1203.9792 1085.6467,-1205.0257"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1092.2128,-725.4052C1133.7013,-742.3652 1182.1794,-758.3536 1217.1316,-769.2312"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1216.4796,-772.6929 1227.0671,-772.2991 1218.5449,-766.0045 1216.4796,-772.6929"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-663.4106 166.6166,-663.4106 166.6166,-641.3998 281.0645,-641.3998 281.0645,-663.4106"/>
<text text-anchor="middle" x="223.8406" y="-649.2552" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M230.2069,-641.2618C240.9764,-622.3244 263.3592,-582.5874 281.2024,-548.4052 297.9425,-516.3363 293.8374,-503.0226 317.2024,-475.4052 387.8922,-391.85 413.8388,-368.0581 516.9653,-331.4052 689.1668,-270.2019 767.9935,-218.1357 927.4618,-307.4052"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M399.0839,-763.4052C428.8636,-785.9626 455.1434,-755.4071 480.9653,-782.4052 541.5787,-845.7795 449.5362,-920.3376 516.9653,-976.4052 563.9571,-1015.4791 593.363,-977.1444 654.4731,-976.4052 727.9649,-975.5163 746.5125,-978.0404 819.7932,-972.4052 867.9067,-968.7054 879.5993,-952.2591 927.4618,-958.4052"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-763.4052C428.8636,-785.9626 448.7887,-763.4227 480.9653,-782.4052 501.5653,-794.5581 496.6227,-809.8264 516.9653,-822.4052 543.9294,-839.0784 554.3493,-836.8242 585.7192,-841.4052"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M232.6853,-663.4911C247.9782,-681.9322 281.1997,-718.9045 317.2024,-739.4052 350.1571,-758.1703 368.8544,-740.5072 399.0839,-763.4052"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M585.7192,-841.4052C633.8305,-848.431 688.4786,-831.1702 722.3841,-817.407"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="723.9248,-820.5563 731.7923,-813.4602 721.2168,-814.1013 723.9248,-820.5563"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M399.0839,-763.4052C428.8636,-785.9626 454.4294,-756.1086 480.9653,-782.4052 529.3566,-830.3601 471.5556,-880.618 516.9653,-931.4052 520.0487,-934.8537 523.6464,-937.827 527.5497,-940.3905"/>
<polygon fill="#ff00da" stroke="#ff00da" points="526.0618,-943.568 536.5017,-945.3732 529.4662,-937.4516 526.0618,-943.568"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M281.2218,-652.4052C294.877,-652.4052 309.649,-652.4052 323.9664,-652.4052"/>
<polygon fill="#00ffff" stroke="#00ffff" points="324.2888,-655.9053 334.2888,-652.4052 324.2887,-648.9053 324.2888,-655.9053"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M585.7192,-841.4052C660.2358,-852.287 679.9093,-847.9402 755.1332,-844.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-844.4052C832.1028,-840.7882 852.5228,-881.3372 927.4618,-863.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M927.4618,-863.4052C1003.5497,-845.1983 1014.3328,-808.8597 1092.2128,-801.4052"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.4618,-571.4052C959.8002,-545.3297 968.2519,-539.1942 999.1304,-511.4052 1025.8852,-487.3273 1055.5875,-458.1591 1074.0826,-439.6886"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1076.696,-442.0246 1081.2817,-432.4736 1071.7408,-437.0803 1076.696,-442.0246"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.0133,-642.8797C604.1888,-622.259 922.955,-575.0392 927.4618,-571.4052"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M463.8915,-655.2165C595.1937,-661.128 883.8926,-675.2996 927.4618,-687.4052"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M423.6026,-663.4744C442.4222,-673.3021 467.4083,-689.5053 480.9653,-711.4052 533.1153,-795.6482 453.7364,-855.1255 516.9653,-931.4052 519.9175,-934.9667 523.4213,-938.0208 527.2601,-940.6399"/>
<polygon fill="#ff00da" stroke="#ff00da" points="525.6968,-943.7778 536.1147,-945.7065 529.1734,-937.7021 525.6968,-943.7778"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M423.0901,-663.544C446.6489,-674.1969 483.7729,-690.2468 516.9653,-701.4052 620.6438,-736.2593 647.19,-745.733 755.1332,-763.4052"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M443.5662,-1064.3291C489.6365,-1053.2224 558.6062,-1037.714 585.7192,-1037.4052"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M457.2987,-1064.356C465.5028,-1061.6993 473.6306,-1058.4272 480.9653,-1054.4052 490.9027,-1048.956 539.6721,-1001.7069 567.0254,-974.8574"/>
<polygon fill="#ff00da" stroke="#ff00da" points="569.7669,-977.0702 574.4417,-967.5625 564.8582,-972.0798 569.7669,-977.0702"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M443.6168,-1036.9117C481.4507,-1038.6122 537.1851,-1040.1065 585.7192,-1037.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M585.7192,-1037.4052C661.1277,-1033.2082 1197.9952,-1108.1168 1264.5439,-1072.4052"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M440.3806,-1023.3045C453.5197,-1019.3735 468.0027,-1014.6182 480.9653,-1009.4052 507.5307,-998.7218 536.4858,-983.8031 557.2078,-972.5148"/>
<polygon fill="#ff00da" stroke="#ff00da" points="559.0398,-975.5016 566.1112,-967.6119 555.6632,-969.3698 559.0398,-975.5016"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1332.9435,-783.4052C1347.8672,-783.4052 1363.6032,-783.4052 1378.3385,-783.4052"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1378.3578,-786.9053 1388.3577,-783.4052 1378.3577,-779.9053 1378.3578,-786.9053"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M820.0267,-1141.9327C948.3588,-1126.8165 1225.5828,-1092.3548 1264.5439,-1072.4052"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M999.3364,-110.3168C1084.5148,-102.0805 1220.4592,-93.5841 1264.5439,-117.4052"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1264.5439,-117.4052C1296.1324,-135.1265 1319.286,-109.7351 1343.7927,-136.4052 1354.7435,-148.3227 1424.1321,-651.8787 1439.2213,-762.1936"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1435.7576,-762.698 1440.5792,-772.1321 1442.6931,-761.7503 1435.7576,-762.698"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M933.6676,-129.5968C961.9162,-180.3737 1077.6029,-386.4558 1092.2128,-382.4052"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1092.2128,-382.4052C1189.206,-355.5137 1241.0452,-227.98 1258.1054,-177.2697"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1261.4602,-178.2707 1261.2217,-167.6786 1254.8028,-176.1076 1261.4602,-178.2707"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M592.2984,-1103.3326C605.6923,-1080.3828 636.3856,-1025.6523 654.4731,-976.4052 677.5145,-913.6703 647.3191,-881.4375 690.4731,-830.4052 696.2696,-823.5505 704.056,-818.3249 712.2152,-814.3577"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="713.6771,-817.5393 721.4994,-810.3935 710.9282,-811.1016 713.6771,-817.5393"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M927.4618,-1284.4052C976.2298,-1278.3161 1029.1491,-1256.3641 1061.5006,-1241.0279"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1063.3739,-1244.0098 1070.853,-1236.5057 1060.3266,-1237.7079 1063.3739,-1244.0098"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M597.7814,-1125.4207C624.1113,-1148.7691 689.638,-1203.1568 755.1332,-1228.4052"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M755.1332,-1228.4052C773.9189,-1235.6471 907.4837,-1286.8996 927.4618,-1284.4052"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M618.149,-1103.3434C629.7082,-1099.2089 642.7612,-1094.3192 654.4731,-1089.4052 729.565,-1057.8986 746.783,-1046.474 819.7932,-1010.4052 976.7408,-932.8693 1162.8154,-836.4128 1234.4116,-799.1286"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1236.0987,-802.1962 1243.3499,-794.4715 1232.8642,-795.9883 1236.0987,-802.1962"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M445.0629,-812.8142C457.1513,-816.5121 469.8967,-821.3143 480.9653,-827.4052 534.7417,-856.9972 524.3721,-915.3769 585.7192,-917.4052"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M585.7192,-917.4052C667.6622,-920.1145 673.2358,-848.2538 755.1332,-844.4052"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M226.651,-1222.6727C234.7694,-1252.567 261.3243,-1333.9554 317.2024,-1368.4052 419.0426,-1431.1915 467.7751,-1407.4733 585.7192,-1387.4052"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.6296,-1209.0977C331.6369,-1205.5313 413.6184,-1196.4607 480.9653,-1173.4052 510.5527,-1163.2763 541.3891,-1144.794 561.8778,-1131.2057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="563.9347,-1134.0399 570.2563,-1125.5377 560.0124,-1128.242 563.9347,-1134.0399"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M257.215,-1200.3593C285.2626,-1191.0764 325.5363,-1177.7471 356.0129,-1167.6603"/>
<polygon fill="#00ffff" stroke="#00ffff" points="357.1419,-1170.9735 365.5357,-1164.5086 354.9424,-1164.328 357.1419,-1170.9735"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M585.7192,-1307.4052C659.5778,-1322.0427 681.0854,-1321.0535 755.1332,-1307.4052"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M755.1332,-1307.4052C831.1228,-1293.399 850.7875,-1293.9786 927.4618,-1284.4052"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M456.7295,-1164.5015C465.4705,-1167.9525 473.9107,-1172.4761 480.9653,-1178.4052 508.0499,-1201.1688 495.0045,-1221.6658 516.9653,-1249.4052 541.7802,-1280.7495 546.5039,-1299.6334 585.7192,-1307.4052"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M452.0668,-1142.3337C476.1254,-1137.3063 504.613,-1131.3535 529.0936,-1126.2379"/>
<polygon fill="#ff0000" stroke="#ff0000" points="529.8893,-1129.6473 538.9619,-1124.1758 528.4574,-1122.7953 529.8893,-1129.6473"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M654.6264,-802.4052C673.7438,-802.4052 693.9743,-802.4052 711.2346,-802.4052"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="711.5612,-805.9053 721.5612,-802.4052 711.5612,-798.9053 711.5612,-805.9053"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M435.9199,-1359.4464C481.7471,-1372.5961 557.4102,-1392.222 585.7192,-1387.4052"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M585.7192,-1387.4052C667.8074,-1373.438 673.2446,-1322.4987 755.1332,-1307.4052"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M481.06,-1300.5417C513.883,-1299.57 551.8695,-1300.6968 585.7192,-1307.4052"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~demandmanager.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M439.581,-956.4052C464.7885,-956.4052 497.6632,-956.4052 525.8471,-956.4052"/>
<polygon fill="#ff00da" stroke="#ff00da" points="525.9955,-959.9053 535.9955,-956.4052 525.9954,-952.9053 525.9955,-959.9053"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefiledemandmanagerf90EfferentGraph = svgPanZoom('#sourcefiledemandmanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~demandmanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefiledemandmanagerf90AfferentGraph" width="641pt" height="37pt"
 viewBox="0.00 0.00 641.00 37.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~demandmanager.f90~~AfferentGraph" class="graph" transform="scale(.5235 .5235) rotate(0) translate(4 67.5)">
<title>sourcefile~~demandmanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-67.5 1220.3828,-67.5 1220.3828,4 -4,4"/>
<!-- sourcefile~demandmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~demandmanager.f90</title>
<polygon fill="none" stroke="#000000" points="110.1026,-42.2554 -.0342,-42.2554 -.0342,-20.2446 110.1026,-20.2446 110.1026,-42.2554"/>
<text text-anchor="middle" x="55.0342" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">DemandManager.f90</text>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1083.9654,-42.2554 964.155,-42.2554 964.155,-20.2446 1083.9654,-20.2446 1083.9654,-42.2554"/>
<text text-anchor="middle" x="1024.0602" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~demandmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~demandmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.1243,-35.1314C169.8298,-39.2964 267.916,-46.0182 352.5157,-51.25"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="244.7368,-23.2554 146.1787,-23.2554 146.1787,-1.2446 244.7368,-1.2446 244.7368,-23.2554"/>
<text text-anchor="middle" x="195.4578" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~demandmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~demandmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.1303,-23.7952C118.6351,-22.6445 127.4507,-21.4517 136.045,-20.2888"/>
<polygon fill="#ff0000" stroke="#ff0000" points="136.5602,-23.7511 146.0006,-18.9418 135.6216,-16.8143 136.5602,-23.7511"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1209.7811,-63.2554 1126.3641,-63.2554 1126.3641,-41.2446 1209.7811,-41.2446 1209.7811,-63.2554"/>
<text text-anchor="middle" x="1168.0726" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1083.8833,-39.9735C1094.5479,-41.5286 1105.5797,-43.1372 1116.0061,-44.6576"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1115.7942,-48.1637 1126.1946,-46.1433 1116.8043,-41.2369 1115.7942,-48.1637"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1216.1937,-22.2554 1119.9515,-22.2554 1119.9515,-.2446 1216.1937,-.2446 1216.1937,-22.2554"/>
<text text-anchor="middle" x="1168.0726" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1083.8833,-22.942C1092.3442,-21.7669 1101.0363,-20.5598 1109.4738,-19.388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1110.1832,-22.8232 1119.6067,-17.9808 1109.2203,-15.8897 1110.1832,-22.8232"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M225.9311,-23.3208C257.2018,-33.8437 307.5091,-48.4667 352.5157,-51.25"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M352.5157,-51.25C437.2489,-56.49 458.7443,-46.9335 543.5295,-51.25"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="424.3533,-23.2554 280.6782,-23.2554 280.6782,-1.2446 424.3533,-1.2446 424.3533,-23.2554"/>
<text text-anchor="middle" x="352.5157" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M245.1519,-12.25C253.2907,-12.25 261.9093,-12.25 270.5835,-12.25"/>
<polygon fill="#00ffff" stroke="#00ffff" points="270.7662,-15.7501 280.7662,-12.25 270.7661,-8.7501 270.7662,-15.7501"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M543.5295,-51.25C625.4667,-55.4215 646.1972,-46.9347 728.127,-51.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M389.7794,-23.3297C427.9699,-33.8595 489.2765,-48.4879 543.5295,-51.25"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="626.7203,-23.2554 460.3388,-23.2554 460.3388,-1.2446 626.7203,-1.2446 626.7203,-23.2554"/>
<text text-anchor="middle" x="543.5295" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M424.1857,-12.25C432.6314,-12.25 441.3428,-12.25 450.0321,-12.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="450.2051,-15.7501 460.205,-12.25 450.205,-8.7501 450.2051,-15.7501"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M579.5125,-23.3284C616.3973,-33.8571 675.627,-48.4848 728.127,-51.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M728.127,-51.25C795.0305,-54.7739 811.8728,-51.5261 878.8685,-51.25"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="793.1323,-23.2554 663.1216,-23.2554 663.1216,-1.2446 793.1323,-1.2446 793.1323,-23.2554"/>
<text text-anchor="middle" x="728.127" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M626.9172,-12.25C635.6388,-12.25 644.4675,-12.25 653.0879,-12.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="653.093,-15.7501 663.093,-12.25 653.093,-8.7501 653.093,-15.7501"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M754.0145,-23.2855C783.6332,-34.8824 833.8605,-51.4355 878.8685,-51.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M878.8685,-51.25C905.2575,-51.1413 934.0943,-47.8382 959.0645,-43.9468"/>
<polygon fill="#ff0000" stroke="#ff0000" points="959.838,-47.3671 969.1489,-42.3116 958.7176,-40.4574 959.838,-47.3671"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~demandmanager.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="928.3473,-23.2554 829.3898,-23.2554 829.3898,-1.2446 928.3473,-1.2446 928.3473,-23.2554"/>
<text text-anchor="middle" x="878.8685" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M793.3677,-12.25C801.853,-12.25 810.5129,-12.25 818.9064,-12.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="818.9829,-15.7501 828.9829,-12.25 818.9828,-8.7501 818.9829,-15.7501"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~demandmanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M928.4292,-18.7356C936.6955,-19.8173 945.4064,-20.9573 954.0679,-22.0907"/>
<polygon fill="#ff0000" stroke="#ff0000" points="953.8137,-25.5872 964.1833,-23.4144 954.722,-18.6464 953.8137,-25.5872"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefiledemandmanagerf90AfferentGraph = svgPanZoom('#sourcefiledemandmanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/demandmanager.html">DemandManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/demandmanager.f90.html#src">DemandManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">DemandManager</span>
<a name="ln-2"></a>
<a name="ln-3"></a>        <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>        <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-5"></a>        <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-6"></a>        <span class="c">!       MODIFIED       na</span>
<a name="ln-7"></a>        <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8"></a>
<a name="ln-9"></a>        <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-10"></a>        <span class="c">! This module provides controls for demand limiting various loads.</span>
<a name="ln-11"></a>
<a name="ln-12"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13"></a>        <span class="c">! ManageDemand is called from within the ManageHVAC routine after the first pass through SimHVAC, but</span>
<a name="ln-14"></a>        <span class="c">! _before_ any variables are reported or histories are updated.  If the metered demand is above the</span>
<a name="ln-15"></a>        <span class="c">! limit action is taken using the various demand managers to reduce loads.  Exterior energy use, zone</span>
<a name="ln-16"></a>        <span class="c">! heat balance, and HVAC system are then resimulated as necessary.  It is possible to iterate several</span>
<a name="ln-17"></a>        <span class="c">! times through ManageDemand before the final demand managers are established and the timestep can be</span>
<a name="ln-18"></a>        <span class="c">! completed.</span>
<a name="ln-19"></a>
<a name="ln-20"></a>        <span class="c">! USE STATEMENTS:</span>
<a name="ln-21"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-22"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-25"></a>
<a name="ln-26"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-27"></a>
<a name="ln-28"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-29"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerTypeExtLights</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-30"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerTypeLights</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-31"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerTypeElecEquip</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-32"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerTypeThermostats</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-33"></a>
<a name="ln-34"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerPrioritySequential</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-35"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerPriorityOptimal</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-36"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerPriorityAll</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-37"></a>
<a name="ln-38"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerLimitOff</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-39"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerLimitFixed</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-40"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerLimitVariable</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-41"></a>
<a name="ln-42"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerSelectionAll</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-43"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerSelectionMany</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-44"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ManagerSelectionOne</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-45"></a>
<a name="ln-46"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CheckCanReduce</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-47"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SetLimit</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-48"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ClearLimit</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-49"></a>
<a name="ln-50"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-51"></a><span class="k">TYPE </span><span class="n">DemandManagerListData</span>
<a name="ln-52"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                     <span class="c">! Name of DEMAND MANAGER LIST</span>
<a name="ln-53"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">Meter</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c">! Index to meter to demand limit</span>
<a name="ln-54"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">LimitSchedule</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Schedule index for demand limit</span>
<a name="ln-55"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">SafetyFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>          <span class="c">! Multiplier applied to demand limit schedule</span>
<a name="ln-56"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">BillingSchedule</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Schedule index for billing month periods</span>
<a name="ln-57"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">BillingPeriod</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Current billing period value</span>
<a name="ln-58"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">PeakSchedule</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c">! Schedule index for billing month periods</span>
<a name="ln-59"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">AveragingWindow</span> <span class="o">=</span> <span class="mi">1</span>           <span class="c">! Number of timesteps for averaging demand window</span>
<a name="ln-60"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>    <span class="kd">::</span> <span class="n">History</span>                   <span class="c">! Demand window history</span>
<a name="ln-61"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">ManagerPriority</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Indicator for priority (SEQUENTIAL, OPTIMAL, ALL)</span>
<a name="ln-62"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">NumOfManager</span>                  <span class="c">! Number of DEMAND MANAGERs</span>
<a name="ln-63"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Manager</span>                   <span class="c">! Indexes for DEMAND MANAGERs</span>
<a name="ln-64"></a>
<a name="ln-65"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">MeterDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Meter demand at this timestep</span>
<a name="ln-66"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">AverageDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Current demand over the demand window</span>
<a name="ln-67"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">PeakDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Peak demand in the billing month so far</span>
<a name="ln-68"></a>
<a name="ln-69"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">ScheduledLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Scheduled demand limit</span>
<a name="ln-70"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">DemandLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Scheduled demand limit * Safety Fraction</span>
<a name="ln-71"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">AvoidedDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Demand avoided by active DEMAND MANAGERs</span>
<a name="ln-72"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">OverLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! Amount that demand limit is exceeded</span>
<a name="ln-73"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">OverLimitDuration</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Number of hours that demand limit is exceeded</span>
<a name="ln-74"></a>
<a name="ln-75"></a><span class="k">END TYPE </span><span class="n">DemandManagerListData</span>
<a name="ln-76"></a>
<a name="ln-77"></a><span class="k">TYPE </span><span class="n">DemandManagerData</span>
<a name="ln-78"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                     <span class="c">! Name of DEMAND MANAGER</span>
<a name="ln-79"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="k">Type</span> <span class="o">=</span> <span class="mi">0</span>                      <span class="c">! Type of DEMAND MANAGER (:LIGHTS, :ELECTRICEQUIPMENT, etc.)</span>
<a name="ln-80"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">DemandManagerList</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c">! Reference to parent DEMAND MANAGER LIST for error checking</span>
<a name="ln-81"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>     <span class="c">! Flag to indicate whether manager can reduce demand</span>
<a name="ln-82"></a>
<a name="ln-83"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">AvailSchedule</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Schedule index pointer for Availability Schedule</span>
<a name="ln-84"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">Available</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>           <span class="c">! Availability flag</span>
<a name="ln-85"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">Activate</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>            <span class="c">! Flag to activate the manager</span>
<a name="ln-86"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">Active</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>              <span class="c">! Flag to indicate that the manager is active</span>
<a name="ln-87"></a>
<a name="ln-88"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">LimitControl</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c">!</span>
<a name="ln-89"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">SelectionControl</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">!</span>
<a name="ln-90"></a>
<a name="ln-91"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">LimitDuration</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Minimum duration of demand manager activity (min)</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">ElapsedTime</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c">! Elapsed time for the demand manager activity (min)</span>
<a name="ln-93"></a>
<a name="ln-94"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">RotationDuration</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Rotation duration (min)</span>
<a name="ln-95"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Elapsed time for the current rotation (min)</span>
<a name="ln-96"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="mi">0</span>            <span class="c">! Index for rotated load</span>
<a name="ln-97"></a>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">LowerLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Lowest demand limit as fraction of design level</span>
<a name="ln-99"></a>                                                                  <span class="c">! Lowest heating setpoint for thermostats</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">UpperLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Not used for demand limit</span>
<a name="ln-101"></a>                                                                  <span class="c">! Highest cooling setpoint for thermostats</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">NumOfLoads</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c">! Number of load objects</span>
<a name="ln-103"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Load</span>                      <span class="c">! Pointers to load objects</span>
<a name="ln-104"></a><span class="k">END TYPE </span><span class="n">DemandManagerData</span>
<a name="ln-105"></a>
<a name="ln-106"></a>          <span class="c">! MODULE VARIABLE TYPE DECLARATIONS:</span>
<a name="ln-107"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">DemandManagerListData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DemandManagerList</span>
<a name="ln-108"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">DemandManagerData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DemandMgr</span>
<a name="ln-109"></a>
<a name="ln-110"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-111"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDemandManagerList</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-112"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDemandMgr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-113"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">DemandManagerExtIterations</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-114"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">DemandManagerHBIterations</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-115"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">DemandManagerHVACIterations</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-116"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Flag to prevent input from being read multiple times</span>
<a name="ln-117"></a>
<a name="ln-118"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS:</span>
<a name="ln-119"></a><span class="k">PUBLIC </span><span class="n">ManageDemand</span>
<a name="ln-120"></a><span class="k">PUBLIC </span><span class="n">UpdateDemandManagers</span>
<a name="ln-121"></a><span class="k">PRIVATE </span><span class="n">GetDemandManagerListInput</span>
<a name="ln-122"></a><span class="k">PRIVATE </span><span class="n">SimulateDemandManagerList</span>
<a name="ln-123"></a><span class="k">PRIVATE </span><span class="n">ReportDemandManagerList</span>
<a name="ln-124"></a><span class="k">PRIVATE </span><span class="n">GetDemandManagerInput</span>
<a name="ln-125"></a><span class="k">PRIVATE </span><span class="n">SurveyDemandManagers</span>
<a name="ln-126"></a><span class="k">PRIVATE </span><span class="n">ActivateDemandManagers</span>
<a name="ln-127"></a><span class="k">PUBLIC  </span><span class="n">InitDemandManagers</span>
<a name="ln-128"></a>
<a name="ln-129"></a><span class="k">CONTAINS</span>
<a name="ln-130"></a>
<a name="ln-131"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-132"></a><span class="k">SUBROUTINE </span><span class="n">ManageDemand</span>
<a name="ln-133"></a>
<a name="ln-134"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-135"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-136"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-137"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-138"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-139"></a>
<a name="ln-140"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-141"></a>          <span class="c">!</span>
<a name="ln-142"></a>
<a name="ln-143"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-144"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-145"></a>
<a name="ln-146"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-147"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">DoingSizing</span>
<a name="ln-148"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span>
<a name="ln-149"></a>
<a name="ln-150"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-151"></a>
<a name="ln-152"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-153"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ListNum</span>                  <span class="c">!</span>
<a name="ln-154"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstTime</span>                <span class="c">! Flag to allow Demand Manager List to simulate at least once</span>
<a name="ln-155"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ResimExt</span>                 <span class="c">! Flag to resimulate the exterior energy use simulation</span>
<a name="ln-156"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ResimHB</span>                  <span class="c">! Flag to resimulate the heat balance simulation (including HVAC)</span>
<a name="ln-157"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ResimHVAC</span>                <span class="c">! Flag to resimulate the HVAC simulation</span>
<a name="ln-158"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BeginDemandSim</span>     <span class="c">! TRUE in the first timestep after warmup of a new environment</span>
<a name="ln-159"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ClearHistory</span>       <span class="c">! TRUE in the first timestep during warmup of a new environment</span>
<a name="ln-160"></a>
<a name="ln-161"></a>          <span class="c">! FLOW:</span>
<a name="ln-162"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInput</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DoingSizing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-163"></a><span class="k">    CALL </span><span class="n">GetDemandManagerInput</span>
<a name="ln-164"></a>    <span class="k">CALL </span><span class="n">GetDemandManagerListInput</span>
<a name="ln-165"></a>    <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-166"></a>  <span class="k">END IF</span>
<a name="ln-167"></a>
<a name="ln-168"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">NumDemandManagerList</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-169"></a>
<a name="ln-170"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-171"></a><span class="k">      </span><span class="n">BeginDemandSim</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-172"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ClearHistory</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-173"></a>        <span class="c">! Clear historical variables</span>
<a name="ln-174"></a>        <span class="k">DO </span><span class="n">ListNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandManagerList</span>
<a name="ln-175"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-176"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">MeterDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-177"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-178"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-179"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ScheduledLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-180"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">DemandLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-181"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AvoidedDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-182"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-183"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimitDuration</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-184"></a>        <span class="k">END DO</span>  <span class="c">! ListNum</span>
<a name="ln-185"></a>
<a name="ln-186"></a>        <span class="c">! Clear demand manager variables</span>
<a name="ln-187"></a>        <span class="n">DemandMgr</span><span class="p">%</span><span class="n">Active</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-188"></a>        <span class="n">DemandMgr</span><span class="p">%</span><span class="n">ElapsedTime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-189"></a>        <span class="n">DemandMgr</span><span class="p">%</span><span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-190"></a>        <span class="n">DemandMgr</span><span class="p">%</span><span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-191"></a>      <span class="n">ENDIF</span>
<a name="ln-192"></a>      <span class="n">ClearHistory</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-193"></a>    <span class="n">ENDIF</span>
<a name="ln-194"></a>
<a name="ln-195"></a>
<a name="ln-196"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DoingSizing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-197"></a>
<a name="ln-198"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">BeginDemandSim</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-199"></a><span class="k">        </span><span class="n">BeginDemandSim</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-200"></a>        <span class="n">ClearHistory</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-201"></a>      <span class="k">END IF</span>
<a name="ln-202"></a>
<a name="ln-203"></a><span class="k">      </span><span class="n">DemandManagerExtIterations</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-204"></a>      <span class="n">DemandManagerHBIterations</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-205"></a>      <span class="n">DemandManagerHVACIterations</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-206"></a>
<a name="ln-207"></a>      <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-208"></a>      <span class="n">ResimExt</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-209"></a>      <span class="n">ResimHB</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-210"></a>      <span class="n">ResimHVAC</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-211"></a>
<a name="ln-212"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">FirstTime</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ResimExt</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ResimHB</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ResimHVAC</span><span class="p">)</span>
<a name="ln-213"></a>        <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-214"></a>
<a name="ln-215"></a>        <span class="k">CALL </span><span class="n">Resimulate</span><span class="p">(</span><span class="n">ResimExt</span><span class="p">,</span> <span class="n">ResimHB</span><span class="p">,</span> <span class="n">ResimHVAC</span><span class="p">)</span>
<a name="ln-216"></a>        <span class="n">ResimExt</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-217"></a>        <span class="n">ResimHB</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-218"></a>        <span class="n">ResimHVAC</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-219"></a>
<a name="ln-220"></a>        <span class="k">CALL </span><span class="n">SurveyDemandManagers</span>  <span class="c">! Determines which Demand Managers can reduce demand</span>
<a name="ln-221"></a>
<a name="ln-222"></a>        <span class="k">DO </span><span class="n">ListNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandManagerList</span>
<a name="ln-223"></a>          <span class="k">CALL </span><span class="n">SimulateDemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">,</span> <span class="n">ResimExt</span><span class="p">,</span> <span class="n">ResimHB</span><span class="p">,</span> <span class="n">ResimHVAC</span><span class="p">)</span>
<a name="ln-224"></a>        <span class="k">END DO</span>  <span class="c">! ListNum</span>
<a name="ln-225"></a>
<a name="ln-226"></a>        <span class="k">CALL </span><span class="n">ActivateDemandManagers</span>  <span class="c">! Sets limits on loads</span>
<a name="ln-227"></a>
<a name="ln-228"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerExtIterations</span> <span class="o">+</span> <span class="n">DemandManagerHBIterations</span> <span class="o">+</span> <span class="n">DemandManagerHVACIterations</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-229"></a>          <span class="c">! This error can only happen if there is a bug in the code</span>
<a name="ln-230"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Too many DemandManager iterations. (&gt;500)&#39;</span><span class="p">)</span>
<a name="ln-231"></a>          <span class="k">EXIT</span>
<a name="ln-232"></a><span class="k">        END IF</span>
<a name="ln-233"></a><span class="k">      END DO</span>
<a name="ln-234"></a>
<a name="ln-235"></a><span class="k">      DO </span><span class="n">ListNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandManagerList</span>
<a name="ln-236"></a>        <span class="k">CALL </span><span class="n">ReportDemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)</span>
<a name="ln-237"></a>      <span class="k">END DO</span>  <span class="c">! ListNum</span>
<a name="ln-238"></a>
<a name="ln-239"></a>    <span class="k">END IF</span>
<a name="ln-240"></a>
<a name="ln-241"></a><span class="k">  END IF</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="k">  RETURN</span>
<a name="ln-244"></a>
<a name="ln-245"></a><span class="k">END SUBROUTINE </span><span class="n">ManageDemand</span>
<a name="ln-246"></a>
<a name="ln-247"></a>
<a name="ln-248"></a><span class="k">SUBROUTINE </span><span class="n">SimulateDemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">,</span> <span class="n">ResimExt</span><span class="p">,</span> <span class="n">ResimHB</span><span class="p">,</span> <span class="n">ResimHVAC</span><span class="p">)</span>
<a name="ln-249"></a>
<a name="ln-250"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-251"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-252"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-253"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-254"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-255"></a>
<a name="ln-256"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-257"></a>          <span class="c">!</span>
<a name="ln-258"></a>
<a name="ln-259"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-260"></a>          <span class="c">!</span>
<a name="ln-261"></a>
<a name="ln-262"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-263"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-264"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span>
<a name="ln-265"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-266"></a>
<a name="ln-267"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-268"></a>
<a name="ln-269"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-270"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ListNum</span>
<a name="ln-271"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ResimExt</span>   <span class="c">! Flag to resimulate the exterior energy use simulation</span>
<a name="ln-272"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ResimHB</span>    <span class="c">! Flag to resimulate the heat balance simulation (including HVAC)</span>
<a name="ln-273"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ResimHVAC</span>  <span class="c">! Flag to resimulate the HVAC simulation</span>
<a name="ln-274"></a>
<a name="ln-275"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-276"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">MgrNum</span>
<a name="ln-277"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">MgrPtr</span>
<a name="ln-278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AverageDemand</span>
<a name="ln-279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OverLimit</span>
<a name="ln-280"></a>  <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">OnPeak</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">EXTERNAL</span>         <span class="kd">::</span> <span class="n">GetInstantMeterValue</span>
<a name="ln-282"></a>
<a name="ln-283"></a>          <span class="c">! FLOW:</span>
<a name="ln-284"></a>  <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ScheduledLimit</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">LimitSchedule</span><span class="p">)</span>
<a name="ln-285"></a>  <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">DemandLimit</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ScheduledLimit</span> <span class="p">&amp;</span>
<a name="ln-286"></a>    <span class="o">*</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">SafetyFraction</span>
<a name="ln-287"></a>
<a name="ln-288"></a>  <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">MeterDemand</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-289"></a>    <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Meter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-290"></a>    <span class="o">+</span> <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Meter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span>  <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-291"></a>
<a name="ln-292"></a>  <span class="c">! Calculate average demand over the averaging window including the current timestep meter demand</span>
<a name="ln-293"></a>  <span class="n">AverageDemand</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span> <span class="p">&amp;</span>
<a name="ln-294"></a>    <span class="o">+</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">MeterDemand</span> <span class="o">-</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-295"></a>    <span class="o">/</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AveragingWindow</span>
<a name="ln-296"></a>
<a name="ln-297"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-298"></a><span class="k">    </span><span class="n">OnPeak</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-299"></a>  <span class="k">ELSE</span>
<a name="ln-300"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakSchedule</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-301"></a><span class="k">      </span><span class="n">OnPeak</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-302"></a>    <span class="k">ELSE</span>
<a name="ln-303"></a><span class="k">      </span><span class="n">OnPeak</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-304"></a>    <span class="k">END IF</span>
<a name="ln-305"></a><span class="k">  END IF</span>
<a name="ln-306"></a>
<a name="ln-307"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">OnPeak</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-308"></a><span class="k">    </span><span class="n">OverLimit</span> <span class="o">=</span> <span class="n">AverageDemand</span> <span class="o">-</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">DemandLimit</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OverLimit</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-311"></a>
<a name="ln-312"></a><span class="k">      SELECT CASE</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ManagerPriority</span><span class="p">)</span>
<a name="ln-313"></a>
<a name="ln-314"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerPrioritySequential</span><span class="p">)</span>  <span class="c">! Activate first Demand Manager that can reduce demand</span>
<a name="ln-315"></a>
<a name="ln-316"></a>          <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">NumOfManager</span>
<a name="ln-317"></a>            <span class="n">MgrPtr</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Manager</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)</span>
<a name="ln-318"></a>
<a name="ln-319"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrPtr</span><span class="p">)%</span><span class="n">CanReduceDemand</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-320"></a><span class="k">              </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrPtr</span><span class="p">)%</span><span class="n">Activate</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-321"></a>
<a name="ln-322"></a>              <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrPtr</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span>
<a name="ln-323"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeExtLights</span><span class="p">)</span>
<a name="ln-324"></a>                  <span class="n">ResimExt</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-325"></a>
<a name="ln-326"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeLights</span><span class="p">,</span> <span class="n">ManagerTypeElecEquip</span><span class="p">)</span>
<a name="ln-327"></a>                  <span class="n">ResimHB</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-328"></a>                  <span class="n">ResimHVAC</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-329"></a>
<a name="ln-330"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeThermostats</span><span class="p">)</span>
<a name="ln-331"></a>                  <span class="n">ResimHVAC</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-332"></a>
<a name="ln-333"></a>              <span class="k">END SELECT</span>
<a name="ln-334"></a>
<a name="ln-335"></a><span class="k">              EXIT</span>  <span class="c">! Leave the loop</span>
<a name="ln-336"></a>            <span class="k">END IF</span>
<a name="ln-337"></a><span class="k">          END DO</span>  <span class="c">! MgrNum</span>
<a name="ln-338"></a>
<a name="ln-339"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerPriorityOptimal</span><span class="p">)</span>
<a name="ln-340"></a>          <span class="c">! Not yet implemented</span>
<a name="ln-341"></a>
<a name="ln-342"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerPriorityAll</span><span class="p">)</span>  <span class="c">! Activate ALL Demand Managers that can reduce demand</span>
<a name="ln-343"></a>
<a name="ln-344"></a>          <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">NumOfManager</span>
<a name="ln-345"></a>            <span class="n">MgrPtr</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Manager</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)</span>
<a name="ln-346"></a>
<a name="ln-347"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrPtr</span><span class="p">)%</span><span class="n">CanReduceDemand</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-348"></a><span class="k">              </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrPtr</span><span class="p">)%</span><span class="n">Activate</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-349"></a>
<a name="ln-350"></a>              <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrPtr</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span>
<a name="ln-351"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeExtLights</span><span class="p">)</span>
<a name="ln-352"></a>                  <span class="n">ResimExt</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-353"></a>
<a name="ln-354"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeLights</span><span class="p">,</span> <span class="n">ManagerTypeElecEquip</span><span class="p">)</span>
<a name="ln-355"></a>                  <span class="n">ResimHB</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-356"></a>                  <span class="n">ResimHVAC</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-357"></a>
<a name="ln-358"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeThermostats</span><span class="p">)</span>
<a name="ln-359"></a>                  <span class="n">ResimHVAC</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-360"></a>
<a name="ln-361"></a>              <span class="k">END SELECT</span>
<a name="ln-362"></a>
<a name="ln-363"></a><span class="k">            END IF</span>
<a name="ln-364"></a><span class="k">          END DO</span>  <span class="c">! MgrNum</span>
<a name="ln-365"></a>
<a name="ln-366"></a>      <span class="k">END SELECT</span>
<a name="ln-367"></a>
<a name="ln-368"></a><span class="k">    END IF</span>
<a name="ln-369"></a><span class="k">  END IF</span>
<a name="ln-370"></a>
<a name="ln-371"></a><span class="k">  RETURN</span>
<a name="ln-372"></a>
<a name="ln-373"></a><span class="k">END SUBROUTINE </span><span class="n">SimulateDemandManagerList</span>
<a name="ln-374"></a>
<a name="ln-375"></a>
<a name="ln-376"></a><span class="k">SUBROUTINE </span><span class="n">GetDemandManagerListInput</span>
<a name="ln-377"></a>
<a name="ln-378"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-379"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-380"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-381"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-382"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-383"></a>
<a name="ln-384"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-385"></a>          <span class="c">! Gets the DEMAND MANAGER LIST input from the input file.</span>
<a name="ln-386"></a>
<a name="ln-387"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-388"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-389"></a>
<a name="ln-390"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-391"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-392"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-393"></a>                         <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-394"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-395"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-396"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-397"></a>  <span class="k">USE </span><span class="n">OutputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">EnergyMeters</span>
<a name="ln-398"></a>
<a name="ln-399"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-400"></a>
<a name="ln-401"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-402"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-403"></a>
<a name="ln-404"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-405"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">ListNum</span>
<a name="ln-406"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">MgrNum</span>
<a name="ln-407"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span> <span class="c">! Number of elements in the alpha array</span>
<a name="ln-408"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-409"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-410"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">AlphArray</span>  <span class="c">! Character string data</span>
<a name="ln-411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span>          <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">! Numeric data</span>
<a name="ln-412"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsNotOK</span>   <span class="c">! Flag to verify name</span>
<a name="ln-413"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsBlank</span>   <span class="c">! Flag for blank name</span>
<a name="ln-414"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">Units</span>     <span class="c">! String for meter units</span>
<a name="ln-415"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">EXTERNAL</span>           <span class="kd">::</span> <span class="n">GetMeterIndex</span>
<a name="ln-416"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-417"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>  <span class="c">! for ease in renaming.</span>
<a name="ln-418"></a>
<a name="ln-419"></a>          <span class="c">! FLOW:</span>
<a name="ln-420"></a>  <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;DemandManagerAssignmentList&#39;</span>
<a name="ln-421"></a>  <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">ListNum</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-422"></a>
<a name="ln-423"></a>  <span class="n">NumDemandManagerList</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-424"></a>
<a name="ln-425"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDemandManagerList</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-426"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">))</span>
<a name="ln-427"></a>    <span class="n">AlphArray</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-428"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">NumNums</span><span class="p">))</span>
<a name="ln-429"></a>    <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-430"></a>
<a name="ln-431"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">NumDemandManagerList</span><span class="p">))</span>
<a name="ln-432"></a>
<a name="ln-433"></a>    <span class="k">DO </span><span class="n">ListNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandManagerList</span>
<a name="ln-434"></a>
<a name="ln-435"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">ListNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-436"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-437"></a>
<a name="ln-438"></a>
<a name="ln-439"></a>      <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-440"></a>      <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-441"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DemandManagerList</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">ListNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-442"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-443"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-444"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-445"></a>      <span class="k">END IF</span>
<a name="ln-446"></a><span class="k">      </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-447"></a>
<a name="ln-448"></a>      <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Meter</span> <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-449"></a>
<a name="ln-450"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Meter</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-451"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-452"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-453"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-454"></a>
<a name="ln-455"></a>      <span class="k">ELSE</span>
<a name="ln-456"></a><span class="k">        SELECT CASE</span> <span class="p">(</span><span class="n">EnergyMeters</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Meter</span><span class="p">)%</span><span class="n">ResourceType</span><span class="p">)</span>
<a name="ln-457"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;ElectricityNet&#39;</span><span class="p">)</span>
<a name="ln-458"></a>            <span class="n">Units</span> <span class="o">=</span> <span class="s1">&#39;[W]&#39;</span>  <span class="c">! For setup of report variables</span>
<a name="ln-459"></a>
<a name="ln-460"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-461"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-462"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-463"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Only Electricity and ElectricityNet meters are currently allowed.&#39;</span><span class="p">)</span>
<a name="ln-464"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-465"></a>        <span class="k">END SELECT</span>
<a name="ln-466"></a><span class="k">      END IF</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="c">! Further checking for conflicting DEMAND MANAGER LISTs</span>
<a name="ln-469"></a>
<a name="ln-470"></a>
<a name="ln-471"></a>
<a name="ln-472"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-473"></a><span class="k">        </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">LimitSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-474"></a>
<a name="ln-475"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">LimitSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-476"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-477"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-478"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-479"></a>        <span class="k">END IF</span>
<a name="ln-480"></a><span class="k">      END IF</span>
<a name="ln-481"></a>
<a name="ln-482"></a><span class="k">      </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">SafetyFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-483"></a>
<a name="ln-484"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-485"></a><span class="k">        </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">BillingSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-486"></a>
<a name="ln-487"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">BillingSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-488"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-489"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-490"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-491"></a>        <span class="k">END IF</span>
<a name="ln-492"></a><span class="k">      END IF</span>
<a name="ln-493"></a>
<a name="ln-494"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-495"></a><span class="k">        </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-496"></a>
<a name="ln-497"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-498"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-499"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-500"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-501"></a>        <span class="k">END IF</span>
<a name="ln-502"></a><span class="k">      END IF</span>
<a name="ln-503"></a>
<a name="ln-504"></a><span class="k">      </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AveragingWindow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">MinutesPerTimeStep</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-505"></a><span class="c">! Round to nearest timestep</span>
<a name="ln-506"></a><span class="c">! Can make this fancier to include windows that do not fit the timesteps</span>
<a name="ln-507"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AveragingWindow</span><span class="p">))</span>
<a name="ln-508"></a>      <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-509"></a>
<a name="ln-510"></a>      <span class="c">! Validate Demand Manager Priority</span>
<a name="ln-511"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-512"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SEQUENTIAL&#39;</span><span class="p">)</span>
<a name="ln-513"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ManagerPriority</span> <span class="o">=</span> <span class="n">ManagerPrioritySequential</span>
<a name="ln-514"></a>
<a name="ln-515"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OPTIMAL&#39;</span><span class="p">)</span>
<a name="ln-516"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ManagerPriority</span> <span class="o">=</span> <span class="n">ManagerPriorityOptimal</span>
<a name="ln-517"></a>
<a name="ln-518"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALL&#39;</span><span class="p">)</span>
<a name="ln-519"></a>          <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ManagerPriority</span> <span class="o">=</span> <span class="n">ManagerPriorityAll</span>
<a name="ln-520"></a>
<a name="ln-521"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-522"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-523"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-524"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-525"></a>      <span class="k">END SELECT</span>
<a name="ln-526"></a>
<a name="ln-527"></a>      <span class="c">! Get DEMAND MANAGER Type and Name pairs</span>
<a name="ln-528"></a>      <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">NumOfManager</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">((</span><span class="n">NumAlphas</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-529"></a>
<a name="ln-530"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">NumOfManager</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-531"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Manager</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">NumOfManager</span><span class="p">))</span>
<a name="ln-532"></a>
<a name="ln-533"></a>        <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">NumOfManager</span>
<a name="ln-534"></a>
<a name="ln-535"></a>          <span class="c">! Validate DEMAND MANAGER Type</span>
<a name="ln-536"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MgrNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">))</span>
<a name="ln-537"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DEMANDMANAGER:LIGHTS&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-538"></a>                  <span class="s1">&#39;DEMANDMANAGER:EXTERIORLIGHTS&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-539"></a>                  <span class="s1">&#39;DEMANDMANAGER:ELECTRICEQUIPMENT&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-540"></a>                  <span class="s1">&#39;DEMANDMANAGER:THERMOSTATS&#39;</span><span class="p">)</span>
<a name="ln-541"></a>
<a name="ln-542"></a>              <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Manager</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MgrNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="p">),</span><span class="n">DemandMgr</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDemandMgr</span><span class="p">)</span>
<a name="ln-543"></a>
<a name="ln-544"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Manager</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-545"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-546"></a>                         <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">MgrNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MgrNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-547"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-548"></a>              <span class="k">END IF</span>
<a name="ln-549"></a>
<a name="ln-550"></a><span class="k">            CASE </span><span class="n">DEFAULT</span>
<a name="ln-551"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-552"></a>                         <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">MgrNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MgrNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-553"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-554"></a>          <span class="k">END SELECT</span>
<a name="ln-555"></a>
<a name="ln-556"></a>          <span class="c">! Check that each is not already referenced using %DemandManagerList field</span>
<a name="ln-557"></a>
<a name="ln-558"></a>        <span class="k">END DO</span>  <span class="c">! MgrNum</span>
<a name="ln-559"></a>      <span class="k">END IF</span>
<a name="ln-560"></a>
<a name="ln-561"></a>      <span class="c">! Setup report variables</span>
<a name="ln-562"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Meter Demand Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-563"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">MeterDemand</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-564"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-565"></a>
<a name="ln-566"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Average Demand Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-567"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-568"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-569"></a>
<a name="ln-570"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Peak Demand Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-571"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakDemand</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-572"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-573"></a>
<a name="ln-574"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Scheduled Limit Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-575"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ScheduledLimit</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-576"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-577"></a>
<a name="ln-578"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Demand Limit Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-579"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">DemandLimit</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-580"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-581"></a>
<a name="ln-582"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Over Limit Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-583"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimit</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-584"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-585"></a>
<a name="ln-586"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Over Limit Time [hr]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-587"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimitDuration</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-588"></a>        <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-589"></a>
<a name="ln-590"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-591"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-592"></a>      <span class="k">END IF</span>
<a name="ln-593"></a>
<a name="ln-594"></a><span class="k">    END DO</span> <span class="c">! ListNum</span>
<a name="ln-595"></a>
<a name="ln-596"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">)</span>
<a name="ln-597"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-598"></a>
<a name="ln-599"></a>    <span class="c">! Iteration diagnostic reporting for all DEMAND MANAGER LISTs</span>
<a name="ln-600"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Exterior Energy Iteration Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-601"></a>      <span class="n">DemandManagerExtIterations</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ManageDemand&#39;</span><span class="p">)</span>
<a name="ln-602"></a>
<a name="ln-603"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager Heat Balance Iteration Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-604"></a>      <span class="n">DemandManagerHBIterations</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ManageDemand&#39;</span><span class="p">)</span>
<a name="ln-605"></a>
<a name="ln-606"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Demand Manager HVAC Iteration Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-607"></a>      <span class="n">DemandManagerHVACIterations</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="s1">&#39;ManageDemand&#39;</span><span class="p">)</span>
<a name="ln-608"></a>
<a name="ln-609"></a>  <span class="k">END IF</span>
<a name="ln-610"></a>
<a name="ln-611"></a><span class="k">  RETURN</span>
<a name="ln-612"></a>
<a name="ln-613"></a><span class="k">END SUBROUTINE </span><span class="n">GetDemandManagerListInput</span>
<a name="ln-614"></a>
<a name="ln-615"></a>
<a name="ln-616"></a><span class="k">SUBROUTINE </span><span class="n">GetDemandManagerInput</span>
<a name="ln-617"></a>
<a name="ln-618"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-619"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-620"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-621"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-622"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-623"></a>
<a name="ln-624"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-625"></a>          <span class="c">! Gets the DEMAND MANAGER input from the input file.</span>
<a name="ln-626"></a>
<a name="ln-627"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-628"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-629"></a>
<a name="ln-630"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-631"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-632"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-633"></a>                         <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-634"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-635"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-636"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-637"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Lights</span><span class="p">,</span> <span class="n">TotLights</span><span class="p">,</span> <span class="n">ZoneElectric</span><span class="p">,</span> <span class="n">TotElecEquip</span><span class="p">,</span> <span class="n">LightsObjects</span><span class="p">,</span> <span class="n">NumLightsStatements</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-638"></a>                             <span class="n">ZoneElectricObjects</span><span class="p">,</span> <span class="n">NumZoneElectricStatements</span>
<a name="ln-639"></a>  <span class="k">USE </span><span class="n">ExteriorEnergyUse</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ExteriorLights</span><span class="p">,</span> <span class="n">NumExteriorLights</span>
<a name="ln-640"></a>  <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlledZone</span><span class="p">,</span> <span class="n">NumTempControlledZones</span><span class="p">,</span> <span class="n">TStatObjects</span><span class="p">,</span> <span class="n">NumTStatStatements</span>
<a name="ln-641"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-642"></a>
<a name="ln-643"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-644"></a>
<a name="ln-645"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-646"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-647"></a>
<a name="ln-648"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-649"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumDemandMgrExtLights</span>
<a name="ln-650"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumDemandMgrLights</span>
<a name="ln-651"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumDemandMgrElecEquip</span>
<a name="ln-652"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumDemandMgrThermostats</span>
<a name="ln-653"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">MgrNum</span>
<a name="ln-654"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">StartIndex</span>
<a name="ln-655"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">EndIndex</span>
<a name="ln-656"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">LoadNum</span>
<a name="ln-657"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">LoadPtr</span>
<a name="ln-658"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span> <span class="c">! Number of elements in the alpha array</span>
<a name="ln-659"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-660"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">MaxAlphas</span> <span class="c">! Max number of elements in the alpha array</span>
<a name="ln-661"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">MaxNums</span>   <span class="c">! Max number of elements in the numeric array</span>
<a name="ln-662"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumParams</span> <span class="c">! Number of arguments total in an ObjectDef</span>
<a name="ln-663"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-664"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">AlphArray</span>  <span class="c">! Character string data</span>
<a name="ln-665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span>          <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">! Numeric data</span>
<a name="ln-666"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsNotOK</span>   <span class="c">! Flag to verify name</span>
<a name="ln-667"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsBlank</span>   <span class="c">! Flag for blank name</span>
<a name="ln-668"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-669"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>  <span class="c">! for ease in renaming.</span>
<a name="ln-670"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-671"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item1</span>
<a name="ln-672"></a>
<a name="ln-673"></a>          <span class="c">! FLOW:</span>
<a name="ln-674"></a>  <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-675"></a>  <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-676"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;DemandManager:ExteriorLights&#39;</span>
<a name="ln-677"></a>  <span class="n">NumDemandMgrExtLights</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-678"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDemandMgrExtLights</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-679"></a><span class="k">    CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-680"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-681"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-682"></a>  <span class="n">ENDIF</span>
<a name="ln-683"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;DemandManager:Lights&#39;</span>
<a name="ln-684"></a>  <span class="n">NumDemandMgrLights</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-685"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDemandMgrLights</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-686"></a><span class="k">    CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-687"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-688"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-689"></a>  <span class="n">ENDIF</span>
<a name="ln-690"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;DemandManager:ElectricEquipment&#39;</span>
<a name="ln-691"></a>  <span class="n">NumDemandMgrElecEquip</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-692"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDemandMgrElecEquip</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-693"></a><span class="k">    CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-694"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-695"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-696"></a>  <span class="n">ENDIF</span>
<a name="ln-697"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;DemandManager:Thermostats&#39;</span>
<a name="ln-698"></a>  <span class="n">NumDemandMgrThermostats</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-699"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDemandMgrThermostats</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-700"></a><span class="k">    CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-701"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-702"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-703"></a>  <span class="n">ENDIF</span>
<a name="ln-704"></a>
<a name="ln-705"></a>  <span class="n">NumDemandMgr</span> <span class="o">=</span> <span class="n">NumDemandMgrExtLights</span> <span class="o">+</span> <span class="n">NumDemandMgrLights</span> <span class="o">+</span> <span class="n">NumDemandMgrElecEquip</span> <span class="o">+</span> <span class="n">NumDemandMgrThermostats</span>
<a name="ln-706"></a>
<a name="ln-707"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDemandMgr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-708"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-709"></a>    <span class="n">AlphArray</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-710"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-711"></a>    <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-712"></a>
<a name="ln-713"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">NumDemandMgr</span><span class="p">))</span>
<a name="ln-714"></a>
<a name="ln-715"></a>    <span class="c">! Get input for DemandManager:ExteriorLights</span>
<a name="ln-716"></a>    <span class="n">StartIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-717"></a>    <span class="n">EndIndex</span> <span class="o">=</span> <span class="n">NumDemandMgrExtLights</span>
<a name="ln-718"></a>
<a name="ln-719"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;DemandManager:ExteriorLights&#39;</span>
<a name="ln-720"></a>
<a name="ln-721"></a>    <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="n">StartIndex</span><span class="p">,</span> <span class="n">EndIndex</span>
<a name="ln-722"></a>
<a name="ln-723"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-724"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-725"></a>
<a name="ln-726"></a>      <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-727"></a>      <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-728"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DemandMgr</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-729"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-730"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-731"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-732"></a>      <span class="k">END IF</span>
<a name="ln-733"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-734"></a>
<a name="ln-735"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">ManagerTypeExtLights</span>
<a name="ln-736"></a>
<a name="ln-737"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-738"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-739"></a>
<a name="ln-740"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-741"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-742"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-743"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-744"></a>        <span class="k">END IF</span>
<a name="ln-745"></a><span class="k">      ELSE</span>
<a name="ln-746"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-747"></a>      <span class="k">END IF</span>
<a name="ln-748"></a>
<a name="ln-749"></a>      <span class="c">! Validate Limiting Control</span>
<a name="ln-750"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-751"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OFF&#39;</span><span class="p">)</span>
<a name="ln-752"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitOff</span>
<a name="ln-753"></a>
<a name="ln-754"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FIXED&#39;</span><span class="p">)</span>
<a name="ln-755"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitFixed</span>
<a name="ln-756"></a>
<a name="ln-757"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;VARIABLE&#39;</span><span class="p">)</span>
<a name="ln-758"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitVariable</span>
<a name="ln-759"></a>
<a name="ln-760"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-761"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-762"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-763"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of Off, Fixed, or Variable.&#39;</span><span class="p">)</span>
<a name="ln-764"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-765"></a>      <span class="k">END SELECT</span>
<a name="ln-766"></a>
<a name="ln-767"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-768"></a>
<a name="ln-769"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-770"></a>
<a name="ln-771"></a>      <span class="c">! Validate Selection Control</span>
<a name="ln-772"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-773"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALL&#39;</span><span class="p">)</span>
<a name="ln-774"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionAll</span>
<a name="ln-775"></a>
<a name="ln-776"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEONE&#39;</span><span class="p">)</span>
<a name="ln-777"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionOne</span>
<a name="ln-778"></a>
<a name="ln-779"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEMANY&#39;</span><span class="p">)</span>
<a name="ln-780"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionMany</span>
<a name="ln-781"></a>
<a name="ln-782"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-783"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-784"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-785"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of All, RotateOne, or RotateMany.&#39;</span><span class="p">)</span>
<a name="ln-786"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-787"></a>      <span class="k">END SELECT</span>
<a name="ln-788"></a>
<a name="ln-789"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotationDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-790"></a>
<a name="ln-791"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">=</span> <span class="n">NumAlphas</span> <span class="o">-</span> <span class="mi">4</span>
<a name="ln-792"></a>
<a name="ln-793"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-794"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">))</span>
<a name="ln-795"></a>
<a name="ln-796"></a>        <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-797"></a>          <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span><span class="n">ExteriorLights</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumExteriorLights</span><span class="p">)</span>
<a name="ln-798"></a>
<a name="ln-799"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-800"></a><span class="k">            </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LoadPtr</span>
<a name="ln-801"></a>
<a name="ln-802"></a>          <span class="k">ELSE</span>
<a name="ln-803"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-804"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-805"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-806"></a>
<a name="ln-807"></a>          <span class="k">END IF</span>
<a name="ln-808"></a><span class="k">        END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-809"></a>      <span class="k">END IF</span>
<a name="ln-810"></a>
<a name="ln-811"></a><span class="k">    END DO</span> <span class="c">! MgrNum</span>
<a name="ln-812"></a>
<a name="ln-813"></a>
<a name="ln-814"></a>    <span class="c">! Get input for DemandManager:Lights</span>
<a name="ln-815"></a>    <span class="n">StartIndex</span> <span class="o">=</span> <span class="n">EndIndex</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-816"></a>    <span class="n">EndIndex</span> <span class="o">=</span> <span class="n">EndIndex</span> <span class="o">+</span> <span class="n">NumDemandMgrLights</span>
<a name="ln-817"></a>
<a name="ln-818"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;DemandManager:Lights&#39;</span>
<a name="ln-819"></a>
<a name="ln-820"></a>    <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="n">StartIndex</span><span class="p">,</span> <span class="n">EndIndex</span>
<a name="ln-821"></a>
<a name="ln-822"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-823"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-824"></a>
<a name="ln-825"></a>      <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-826"></a>      <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-827"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DemandMgr</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-828"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-829"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-830"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-831"></a>      <span class="k">END IF</span>
<a name="ln-832"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-833"></a>
<a name="ln-834"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">ManagerTypeLights</span>
<a name="ln-835"></a>
<a name="ln-836"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-837"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-838"></a>
<a name="ln-839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-840"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-841"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-842"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-843"></a>        <span class="k">END IF</span>
<a name="ln-844"></a><span class="k">      ELSE</span>
<a name="ln-845"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-846"></a>      <span class="k">END IF</span>
<a name="ln-847"></a>
<a name="ln-848"></a>      <span class="c">! Validate Limiting Control</span>
<a name="ln-849"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-850"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OFF&#39;</span><span class="p">)</span>
<a name="ln-851"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitOff</span>
<a name="ln-852"></a>
<a name="ln-853"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FIXED&#39;</span><span class="p">)</span>
<a name="ln-854"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitFixed</span>
<a name="ln-855"></a>
<a name="ln-856"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;VARIABLE&#39;</span><span class="p">)</span>
<a name="ln-857"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitVariable</span>
<a name="ln-858"></a>
<a name="ln-859"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-860"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-861"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-862"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of Off, Fixed, or Variable.&#39;</span><span class="p">)</span>
<a name="ln-863"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-864"></a>      <span class="k">END SELECT</span>
<a name="ln-865"></a>
<a name="ln-866"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-867"></a>
<a name="ln-868"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-869"></a>
<a name="ln-870"></a>      <span class="c">! Validate Selection Control</span>
<a name="ln-871"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-872"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALL&#39;</span><span class="p">)</span>
<a name="ln-873"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionAll</span>
<a name="ln-874"></a>
<a name="ln-875"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEONE&#39;</span><span class="p">)</span>
<a name="ln-876"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionOne</span>
<a name="ln-877"></a>
<a name="ln-878"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEMANY&#39;</span><span class="p">)</span>
<a name="ln-879"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionMany</span>
<a name="ln-880"></a>
<a name="ln-881"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-882"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-883"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-884"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of All, RotateOne, or RotateMany.&#39;</span><span class="p">)</span>
<a name="ln-885"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-886"></a>      <span class="k">END SELECT</span>
<a name="ln-887"></a>
<a name="ln-888"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotationDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-889"></a>
<a name="ln-890"></a>      <span class="c">! Count actual pointers to controlled zones</span>
<a name="ln-891"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-892"></a>      <span class="k">DO </span><span class="n">LoadNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumAlphas</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-893"></a>        <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">LightsObjects</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumLightsStatements</span><span class="p">)</span>
<a name="ln-894"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-895"></a><span class="k">          </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="o">=</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">+</span> <span class="n">LightsObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">NumOfZones</span>
<a name="ln-896"></a>        <span class="k">ELSE</span>
<a name="ln-897"></a><span class="k">          </span><span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">Lights</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotLights</span><span class="p">)</span>
<a name="ln-898"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-899"></a><span class="k">            </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="o">=</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-900"></a>          <span class="k">ELSE</span>
<a name="ln-901"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-902"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-903"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-904"></a>          <span class="n">ENDIF</span>
<a name="ln-905"></a>        <span class="n">ENDIF</span>
<a name="ln-906"></a>      <span class="n">ENDDO</span>
<a name="ln-907"></a>
<a name="ln-908"></a><span class="c">!      DemandMgr(MgrNum)%NumOfLoads = NumAlphas - 4</span>
<a name="ln-909"></a>
<a name="ln-910"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-911"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">))</span>
<a name="ln-912"></a>        <span class="n">LoadNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-913"></a>        <span class="k">DO </span><span class="n">Item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAlphas</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-914"></a>          <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">Item</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">LightsObjects</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumLightsStatements</span><span class="p">)</span>
<a name="ln-915"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-916"></a><span class="k">            DO </span><span class="n">Item1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">LightsObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">NumOfZones</span>
<a name="ln-917"></a>              <span class="n">LoadNum</span><span class="o">=</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-918"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LightsObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">StartPtr</span><span class="o">+</span><span class="n">Item1</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-919"></a>            <span class="n">ENDDO</span>
<a name="ln-920"></a>          <span class="k">ELSE</span>
<a name="ln-921"></a><span class="k">            </span><span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">Item</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">Lights</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotLights</span><span class="p">)</span>
<a name="ln-922"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-923"></a><span class="k">              </span><span class="n">LoadNum</span><span class="o">=</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-924"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LoadPtr</span>
<a name="ln-925"></a>            <span class="n">ENDIF</span>
<a name="ln-926"></a>          <span class="k">END IF</span>
<a name="ln-927"></a><span class="k">        END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-928"></a>      <span class="k">END IF</span>
<a name="ln-929"></a>
<a name="ln-930"></a><span class="k">    END DO</span> <span class="c">! MgrNum</span>
<a name="ln-931"></a>
<a name="ln-932"></a>
<a name="ln-933"></a>    <span class="c">! Get input for DemandManager:ElectricEquipment</span>
<a name="ln-934"></a>    <span class="n">StartIndex</span> <span class="o">=</span> <span class="n">EndIndex</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-935"></a>    <span class="n">EndIndex</span> <span class="o">=</span> <span class="n">EndIndex</span> <span class="o">+</span> <span class="n">NumDemandMgrElecEquip</span>
<a name="ln-936"></a>
<a name="ln-937"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;DemandManager:ElectricEquipment&#39;</span>
<a name="ln-938"></a>
<a name="ln-939"></a>    <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="n">StartIndex</span><span class="p">,</span> <span class="n">EndIndex</span>
<a name="ln-940"></a>
<a name="ln-941"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-942"></a>        <span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-943"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-944"></a>
<a name="ln-945"></a>      <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-946"></a>      <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-947"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DemandMgr</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-948"></a>        <span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-949"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-950"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-951"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-952"></a>      <span class="k">END IF</span>
<a name="ln-953"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-954"></a>
<a name="ln-955"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">ManagerTypeElecEquip</span>
<a name="ln-956"></a>
<a name="ln-957"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-958"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-959"></a>
<a name="ln-960"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-961"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-962"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-963"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-964"></a>        <span class="k">END IF</span>
<a name="ln-965"></a><span class="k">      ELSE</span>
<a name="ln-966"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-967"></a>      <span class="k">END IF</span>
<a name="ln-968"></a>
<a name="ln-969"></a>      <span class="c">! Validate Limiting Control</span>
<a name="ln-970"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-971"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OFF&#39;</span><span class="p">)</span>
<a name="ln-972"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitOff</span>
<a name="ln-973"></a>
<a name="ln-974"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FIXED&#39;</span><span class="p">)</span>
<a name="ln-975"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitFixed</span>
<a name="ln-976"></a>
<a name="ln-977"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;VARIABLE&#39;</span><span class="p">)</span>
<a name="ln-978"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitVariable</span>
<a name="ln-979"></a>
<a name="ln-980"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-981"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-982"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-983"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of Off, Fixed, or Variable.&#39;</span><span class="p">)</span>
<a name="ln-984"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-985"></a>      <span class="k">END SELECT</span>
<a name="ln-986"></a>
<a name="ln-987"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-988"></a>
<a name="ln-989"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-990"></a>
<a name="ln-991"></a>      <span class="c">! Validate Selection Control</span>
<a name="ln-992"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-993"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALL&#39;</span><span class="p">)</span>
<a name="ln-994"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionAll</span>
<a name="ln-995"></a>
<a name="ln-996"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEONE&#39;</span><span class="p">)</span>
<a name="ln-997"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionOne</span>
<a name="ln-998"></a>
<a name="ln-999"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEMANY&#39;</span><span class="p">)</span>
<a name="ln-1000"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionMany</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1003"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1004"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1005"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of All, RotateOne, or RotateMany.&#39;</span><span class="p">)</span>
<a name="ln-1006"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1007"></a>      <span class="k">END SELECT</span>
<a name="ln-1008"></a>
<a name="ln-1009"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotationDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1010"></a>
<a name="ln-1011"></a>      <span class="c">! Count actual pointers to controlled zones</span>
<a name="ln-1012"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1013"></a>      <span class="k">DO </span><span class="n">LoadNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumAlphas</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-1014"></a>        <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">ZoneElectricObjects</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumZoneElectricStatements</span><span class="p">)</span>
<a name="ln-1015"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1016"></a><span class="k">          </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="o">=</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">+</span> <span class="n">ZoneElectricObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">NumOfZones</span>
<a name="ln-1017"></a>        <span class="k">ELSE</span>
<a name="ln-1018"></a><span class="k">          </span><span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">ZoneElectric</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotElecEquip</span><span class="p">)</span>
<a name="ln-1019"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1020"></a><span class="k">            </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="o">=</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1021"></a>          <span class="k">ELSE</span>
<a name="ln-1022"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1023"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-1024"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1025"></a>          <span class="k">END IF</span>
<a name="ln-1026"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1027"></a>      <span class="n">ENDDO</span>
<a name="ln-1028"></a>
<a name="ln-1029"></a><span class="c">!      DemandMgr(MgrNum)%NumOfLoads = NumAlphas - 4</span>
<a name="ln-1030"></a>
<a name="ln-1031"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1032"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">))</span>
<a name="ln-1033"></a>        <span class="n">LoadNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1034"></a>        <span class="k">DO </span><span class="n">Item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAlphas</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-1035"></a>          <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">Item</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">ZoneElectricObjects</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumZoneElectricStatements</span><span class="p">)</span>
<a name="ln-1036"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1037"></a><span class="k">            DO </span><span class="n">Item1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneElectricObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">NumOfZones</span>
<a name="ln-1038"></a>              <span class="n">LoadNum</span><span class="o">=</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1039"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneElectricObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">StartPtr</span><span class="o">+</span><span class="n">Item1</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1040"></a>            <span class="n">ENDDO</span>
<a name="ln-1041"></a>          <span class="k">ELSE</span>
<a name="ln-1042"></a><span class="k">            </span><span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">Item</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">ZoneElectric</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotElecEquip</span><span class="p">)</span>
<a name="ln-1043"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1044"></a><span class="k">              </span><span class="n">LoadNum</span><span class="o">=</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1045"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LoadPtr</span>
<a name="ln-1046"></a>            <span class="n">ENDIF</span>
<a name="ln-1047"></a>          <span class="k">END IF</span>
<a name="ln-1048"></a><span class="k">        END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1049"></a>      <span class="k">END IF</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a><span class="k">    END DO</span> <span class="c">! MgrNum</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>
<a name="ln-1054"></a>    <span class="c">! Get input for DemandManager:Thermostats</span>
<a name="ln-1055"></a>    <span class="n">StartIndex</span> <span class="o">=</span> <span class="n">EndIndex</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1056"></a>    <span class="n">EndIndex</span> <span class="o">=</span> <span class="n">EndIndex</span> <span class="o">+</span> <span class="n">NumDemandMgrThermostats</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>    <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;DemandManager:Thermostats&#39;</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>    <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="n">StartIndex</span><span class="p">,</span> <span class="n">EndIndex</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1063"></a>        <span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1064"></a>        <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a>      <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1067"></a>      <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1068"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DemandMgr</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1069"></a>        <span class="n">MgrNum</span> <span class="o">-</span> <span class="n">StartIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1070"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1071"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1072"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1073"></a>      <span class="k">END IF</span>
<a name="ln-1074"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1075"></a>
<a name="ln-1076"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">ManagerTypeThermostats</span>
<a name="ln-1077"></a>
<a name="ln-1078"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1079"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1080"></a>
<a name="ln-1081"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1082"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1083"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-1084"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1085"></a>        <span class="k">END IF</span>
<a name="ln-1086"></a><span class="k">      ELSE</span>
<a name="ln-1087"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1088"></a>      <span class="k">END IF</span>
<a name="ln-1089"></a>
<a name="ln-1090"></a>      <span class="c">! Validate Limiting Control</span>
<a name="ln-1091"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1092"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OFF&#39;</span><span class="p">)</span>
<a name="ln-1093"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitOff</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FIXED&#39;</span><span class="p">)</span>
<a name="ln-1096"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitFixed</span>
<a name="ln-1097"></a>
<a name="ln-1098"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;VARIABLE&#39;</span><span class="p">)</span>
<a name="ln-1099"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">=</span> <span class="n">ManagerLimitVariable</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1102"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1103"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1104"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of Off, Fixed, or Variable.&#39;</span><span class="p">)</span>
<a name="ln-1105"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1106"></a>      <span class="k">END SELECT</span>
<a name="ln-1107"></a>
<a name="ln-1108"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1109"></a>
<a name="ln-1110"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1111"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">UpperLimit</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1112"></a>
<a name="ln-1113"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">UpperLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1114"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1115"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1116"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-1117"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be greater than &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1118"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1119"></a>      <span class="k">END IF</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>      <span class="c">! Validate Selection Control</span>
<a name="ln-1122"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1123"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALL&#39;</span><span class="p">)</span>
<a name="ln-1124"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionAll</span>
<a name="ln-1125"></a>
<a name="ln-1126"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEONE&#39;</span><span class="p">)</span>
<a name="ln-1127"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionOne</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ROTATEMANY&#39;</span><span class="p">)</span>
<a name="ln-1130"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span> <span class="o">=</span> <span class="n">ManagerSelectionMany</span>
<a name="ln-1131"></a>
<a name="ln-1132"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1133"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid value&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1134"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1135"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...value must be one of All, RotateOne, or RotateMany.&#39;</span><span class="p">)</span>
<a name="ln-1136"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1137"></a>      <span class="k">END SELECT</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotationDuration</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a>      <span class="c">! Count actual pointers to controlled zones</span>
<a name="ln-1142"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1143"></a>      <span class="k">DO </span><span class="n">LoadNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumAlphas</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-1144"></a>        <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">TStatObjects</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumTStatStatements</span><span class="p">)</span>
<a name="ln-1145"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1146"></a><span class="k">          </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="o">=</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">+</span> <span class="n">TStatObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">NumOfZones</span>
<a name="ln-1147"></a>        <span class="k">ELSE</span>
<a name="ln-1148"></a><span class="k">          </span><span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">TempControlledZone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumTempControlledZones</span><span class="p">)</span>
<a name="ln-1149"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1150"></a><span class="k">            </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="o">=</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1151"></a>          <span class="k">ELSE</span>
<a name="ln-1152"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1153"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-1154"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1155"></a>          <span class="n">ENDIF</span>
<a name="ln-1156"></a>        <span class="n">ENDIF</span>
<a name="ln-1157"></a>      <span class="n">ENDDO</span>
<a name="ln-1158"></a>
<a name="ln-1159"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1160"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">))</span>
<a name="ln-1161"></a>        <span class="n">LoadNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1162"></a>        <span class="k">DO </span><span class="n">Item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAlphas</span><span class="o">-</span><span class="mi">4</span>
<a name="ln-1163"></a>          <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">Item</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">TStatObjects</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumTStatStatements</span><span class="p">)</span>
<a name="ln-1164"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1165"></a><span class="k">            DO </span><span class="n">Item1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TStatObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">NumOfZones</span>
<a name="ln-1166"></a>              <span class="n">LoadNum</span><span class="o">=</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1167"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">TStatObjects</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">TempControlledZoneStartPtr</span><span class="o">+</span><span class="n">Item1</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1168"></a>            <span class="n">ENDDO</span>
<a name="ln-1169"></a>          <span class="k">ELSE</span>
<a name="ln-1170"></a><span class="k">            </span><span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">Item</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="n">TempControlledZone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumTempControlledZones</span><span class="p">)</span>
<a name="ln-1171"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">LoadPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1172"></a><span class="k">              </span><span class="n">LoadNum</span><span class="o">=</span><span class="n">LoadNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1173"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LoadPtr</span>
<a name="ln-1174"></a>            <span class="n">ENDIF</span>
<a name="ln-1175"></a>          <span class="k">END IF</span>
<a name="ln-1176"></a><span class="k">        END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1177"></a>      <span class="k">END IF</span>
<a name="ln-1178"></a>
<a name="ln-1179"></a><span class="k">    END DO</span> <span class="c">! MgrNum</span>
<a name="ln-1180"></a>
<a name="ln-1181"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">)</span>
<a name="ln-1182"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>  <span class="k">END IF</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1187"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for demand managers. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1188"></a>  <span class="k">END IF</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a><span class="k">  RETURN</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a><span class="k">END SUBROUTINE </span><span class="n">GetDemandManagerInput</span>
<a name="ln-1193"></a>
<a name="ln-1194"></a>
<a name="ln-1195"></a><span class="k">SUBROUTINE </span><span class="n">SurveyDemandManagers</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1198"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-1199"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-1200"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1201"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1202"></a>
<a name="ln-1203"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1204"></a>          <span class="c">! Checks to see if any demand managers can reduce the load</span>
<a name="ln-1205"></a>
<a name="ln-1206"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1207"></a>          <span class="c">!</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1210"></a>
<a name="ln-1211"></a>
<a name="ln-1212"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1215"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadNum</span><span class="p">,</span> <span class="n">LoadPtr</span>
<a name="ln-1216"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CanReduceDemand</span>
<a name="ln-1217"></a>
<a name="ln-1218"></a>          <span class="c">! FLOW:</span>
<a name="ln-1219"></a>  <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandMgr</span>
<a name="ln-1220"></a>
<a name="ln-1221"></a>    <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Available</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1224"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitControl</span> <span class="o">==</span> <span class="n">ManagerLimitOff</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1225"></a>
<a name="ln-1226"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Active</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! This works for FIXED control action, but not VARIABLE</span>
<a name="ln-1227"></a>    <span class="c">! VARIABLE control could actually reduce demand farther, even if active already</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a>    <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-1230"></a>      <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span>
<a name="ln-1231"></a>
<a name="ln-1232"></a>      <span class="c">! Check if this load can reduce demand</span>
<a name="ln-1233"></a>      <span class="c">! Assume FIXED control action for now, needs more sophisticated check for VARIABLE control</span>
<a name="ln-1234"></a>      <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">CheckCanReduce</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1235"></a>
<a name="ln-1236"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CanReduceDemand</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1237"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1238"></a>        <span class="k">EXIT</span>  <span class="c">! If any one load can reduce demand, then the whole demand manager can reduce demand</span>
<a name="ln-1239"></a>      <span class="k">END IF</span>
<a name="ln-1240"></a>
<a name="ln-1241"></a><span class="k">    END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1242"></a>
<a name="ln-1243"></a>  <span class="k">END DO</span>  <span class="c">! MgrNum</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>  <span class="k">RETURN</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a><span class="k">END SUBROUTINE </span><span class="n">SurveyDemandManagers</span>
<a name="ln-1248"></a>
<a name="ln-1249"></a>
<a name="ln-1250"></a><span class="k">SUBROUTINE </span><span class="n">ActivateDemandManagers</span>
<a name="ln-1251"></a>
<a name="ln-1252"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1253"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-1254"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-1255"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1256"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1257"></a>
<a name="ln-1258"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1259"></a>          <span class="c">!</span>
<a name="ln-1260"></a>
<a name="ln-1261"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1262"></a>          <span class="c">!</span>
<a name="ln-1263"></a>
<a name="ln-1264"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1265"></a>
<a name="ln-1266"></a>
<a name="ln-1267"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1268"></a>
<a name="ln-1269"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1270"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MgrNum</span>
<a name="ln-1271"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoadNum</span>
<a name="ln-1272"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoadPtr</span>
<a name="ln-1273"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RotatedLoadNum</span>
<a name="ln-1274"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CanReduceDemand</span>
<a name="ln-1275"></a>
<a name="ln-1276"></a>          <span class="c">! FLOW:</span>
<a name="ln-1277"></a>  <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandMgr</span>
<a name="ln-1278"></a>
<a name="ln-1279"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Activate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1280"></a><span class="k">      </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Activate</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1281"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Active</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1282"></a>
<a name="ln-1283"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span><span class="p">)</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerSelectionAll</span><span class="p">)</span>
<a name="ln-1286"></a>          <span class="c">! Turn ON limiting on all loads</span>
<a name="ln-1287"></a>          <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-1288"></a>            <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span>
<a name="ln-1289"></a>            <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1290"></a>          <span class="k">END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1291"></a>
<a name="ln-1292"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerSelectionMany</span><span class="p">)</span>  <span class="c">! All loads are limited except for one</span>
<a name="ln-1293"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1294"></a>
<a name="ln-1295"></a>            <span class="c">! Turn ON limiting on all loads</span>
<a name="ln-1296"></a>            <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-1297"></a>              <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span>
<a name="ln-1298"></a>              <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1299"></a>            <span class="k">END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>            <span class="c">! Set next rotated load (from last time it was active)</span>
<a name="ln-1302"></a>            <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span>
<a name="ln-1303"></a>            <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1304"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">RotatedLoadNum</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">)</span> <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1305"></a>            <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>            <span class="c">! Turn OFF limiting for the new rotated load</span>
<a name="ln-1308"></a>            <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">RotatedLoadNum</span><span class="p">)</span>
<a name="ln-1309"></a>            <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">ClearLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1310"></a>          <span class="k">ELSE</span>
<a name="ln-1311"></a>            <span class="c">! Turn ON limiting for the one and only load</span>
<a name="ln-1312"></a>            <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1313"></a>            <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1314"></a>          <span class="k">END IF</span>
<a name="ln-1315"></a>
<a name="ln-1316"></a><span class="k">        CASE</span> <span class="p">(</span><span class="n">ManagerSelectionOne</span><span class="p">)</span>  <span class="c">! Only one load is limited</span>
<a name="ln-1317"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1318"></a>            <span class="c">! Turn OFF limiting on all loads</span>
<a name="ln-1319"></a>            <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-1320"></a>              <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span>
<a name="ln-1321"></a>              <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">ClearLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1322"></a>            <span class="k">END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1323"></a>
<a name="ln-1324"></a>            <span class="c">! Set next rotated load (from last time it was active)</span>
<a name="ln-1325"></a>            <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span>
<a name="ln-1326"></a>            <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1327"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">RotatedLoadNum</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">)</span> <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1328"></a>            <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a>            <span class="c">! Turn ON limiting for the new rotated load</span>
<a name="ln-1331"></a>            <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">RotatedLoadNum</span><span class="p">)</span>
<a name="ln-1332"></a>            <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1333"></a>          <span class="k">ELSE</span>
<a name="ln-1334"></a>            <span class="c">! Turn ON limiting for the one and only load</span>
<a name="ln-1335"></a>            <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1336"></a>            <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1337"></a>          <span class="k">END IF</span>
<a name="ln-1338"></a>
<a name="ln-1339"></a><span class="k">      END SELECT</span>
<a name="ln-1340"></a>
<a name="ln-1341"></a><span class="k">    END IF</span>
<a name="ln-1342"></a>
<a name="ln-1343"></a><span class="k">  END DO</span>  <span class="c">! MgrNum</span>
<a name="ln-1344"></a>
<a name="ln-1345"></a>  <span class="k">RETURN</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a><span class="k">END SUBROUTINE </span><span class="n">ActivateDemandManagers</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>
<a name="ln-1350"></a><span class="k">SUBROUTINE </span><span class="n">UpdateDemandManagers</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1353"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-1354"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-1355"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1356"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1357"></a>
<a name="ln-1358"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1359"></a>          <span class="c">! Expires limits and rotates loads after specified time duration.</span>
<a name="ln-1360"></a>  <span class="c">! It updates availability flags, expires managers that ended in the last timestep, etc.</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1363"></a>          <span class="c">!</span>
<a name="ln-1364"></a>
<a name="ln-1365"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1366"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-1367"></a>  <span class="k">USE </span><span class="n">ExteriorEnergyUse</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ExteriorLights</span>
<a name="ln-1368"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Lights</span><span class="p">,</span> <span class="n">ZoneElectric</span>
<a name="ln-1369"></a>  <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlledZone</span>
<a name="ln-1370"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1375"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadNum</span><span class="p">,</span> <span class="n">LoadPtr</span>
<a name="ln-1376"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">Available</span>
<a name="ln-1377"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CanReduceDemand</span>
<a name="ln-1378"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RotatedLoadNum</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>          <span class="c">! FLOW:</span>
<a name="ln-1381"></a>  <span class="k">DO </span><span class="n">MgrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDemandMgr</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a>    <span class="c">! Check availability</span>
<a name="ln-1384"></a><span class="c">!    IF (DemandMgr(MgrNum)%AvailSchedule .EQ. 0) THEN</span>
<a name="ln-1385"></a><span class="c">!      Available = .TRUE.  ! No schedule defaults to available</span>
<a name="ln-1386"></a><span class="c">!    ELSE</span>
<a name="ln-1387"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">AvailSchedule</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1388"></a><span class="k">       </span><span class="n">Available</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1389"></a>     <span class="k">ELSE</span>
<a name="ln-1390"></a><span class="k">       </span><span class="n">Available</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1391"></a>     <span class="k">END IF</span>
<a name="ln-1392"></a><span class="c">!    END IF</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>    <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Available</span> <span class="o">=</span> <span class="n">Available</span>
<a name="ln-1395"></a>
<a name="ln-1396"></a>    <span class="c">! Update demand manager status</span>
<a name="ln-1397"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Available</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1398"></a>
<a name="ln-1399"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Active</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a><span class="k">        </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedTime</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedTime</span> <span class="o">+</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>        <span class="c">! Check for expiring limit duration</span>
<a name="ln-1404"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedTime</span> <span class="o">&gt;=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LimitDuration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1405"></a><span class="k">          </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedTime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1406"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1407"></a>          <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Active</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a>          <span class="c">! Demand Manager is not available, remove demand limits from all loads</span>
<a name="ln-1410"></a>          <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-1411"></a>            <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span>
<a name="ln-1412"></a>            <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">ClearLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1413"></a>          <span class="k">END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>        <span class="k">ELSE</span>
<a name="ln-1416"></a>
<a name="ln-1417"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">SelectionControl</span><span class="p">)</span>
<a name="ln-1418"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerSelectionAll</span><span class="p">)</span>
<a name="ln-1419"></a>              <span class="c">! Do nothing; limits remain on all loads</span>
<a name="ln-1420"></a>
<a name="ln-1421"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerSelectionMany</span><span class="p">)</span>  <span class="c">! All loads are limited except for one</span>
<a name="ln-1422"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">+</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-1423"></a>
<a name="ln-1424"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">&gt;=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotationDuration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1425"></a><span class="k">                </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1428"></a>                  <span class="c">! Turn ON limiting for the old rotated load</span>
<a name="ln-1429"></a>                  <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span>
<a name="ln-1430"></a>                  <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">RotatedLoadNum</span><span class="p">)</span>
<a name="ln-1431"></a>                  <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>                  <span class="c">! Set next rotated load</span>
<a name="ln-1434"></a>                  <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1435"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">RotatedLoadNum</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">)</span> <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1436"></a>                  <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span>
<a name="ln-1437"></a>
<a name="ln-1438"></a>                  <span class="c">! Turn OFF limiting for the new rotated load</span>
<a name="ln-1439"></a>                  <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">RotatedLoadNum</span><span class="p">)</span>
<a name="ln-1440"></a>                  <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">ClearLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1441"></a>                <span class="k">END IF</span>
<a name="ln-1442"></a><span class="k">              END IF</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">ManagerSelectionOne</span><span class="p">)</span>  <span class="c">! Only one load is limited</span>
<a name="ln-1445"></a>              <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">+</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">&gt;=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotationDuration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1448"></a><span class="k">                </span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">ElapsedRotationTime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1449"></a>
<a name="ln-1450"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1451"></a>                  <span class="c">! Turn OFF limiting for the old rotated load</span>
<a name="ln-1452"></a>                  <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span>
<a name="ln-1453"></a>                  <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">RotatedLoadNum</span><span class="p">)</span>
<a name="ln-1454"></a>                  <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">ClearLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1455"></a>
<a name="ln-1456"></a>                  <span class="c">! Set next rotated load</span>
<a name="ln-1457"></a>                  <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1458"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">RotatedLoadNum</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span><span class="p">)</span> <span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1459"></a>                  <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">RotatedLoadNum</span> <span class="o">=</span> <span class="n">RotatedLoadNum</span>
<a name="ln-1460"></a>
<a name="ln-1461"></a>                  <span class="c">! Turn ON limiting for the new rotated load</span>
<a name="ln-1462"></a>                  <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">RotatedLoadNum</span><span class="p">)</span>
<a name="ln-1463"></a>                  <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">SetLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1464"></a>                <span class="k">END IF</span>
<a name="ln-1465"></a><span class="k">              END IF</span>
<a name="ln-1466"></a>
<a name="ln-1467"></a><span class="k">          END SELECT</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a>
<a name="ln-1470"></a><span class="k">        END IF</span>
<a name="ln-1471"></a><span class="k">      END IF</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a>
<a name="ln-1474"></a>
<a name="ln-1475"></a><span class="k">    ELSE</span>  <span class="c">! Demand Manager is not available</span>
<a name="ln-1476"></a>      <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Active</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>      <span class="c">! Demand Manager is not available, remove demand limits from all loads</span>
<a name="ln-1479"></a>      <span class="k">DO </span><span class="n">LoadNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">NumOfLoads</span>
<a name="ln-1480"></a>        <span class="n">LoadPtr</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">Load</span><span class="p">(</span><span class="n">LoadNum</span><span class="p">)</span>
<a name="ln-1481"></a>        <span class="k">CALL </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">ClearLimit</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1482"></a>      <span class="k">END DO</span>  <span class="c">! LoadNum</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a>    <span class="k">END IF</span>
<a name="ln-1485"></a>
<a name="ln-1486"></a><span class="k">  END DO</span>  <span class="c">! MgrNum</span>
<a name="ln-1487"></a>
<a name="ln-1488"></a>  <span class="k">RETURN</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateDemandManagers</span>
<a name="ln-1491"></a>
<a name="ln-1492"></a><span class="k">SUBROUTINE </span><span class="n">ReportDemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)</span>
<a name="ln-1493"></a>
<a name="ln-1494"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1495"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-1496"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-1497"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1498"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1499"></a>
<a name="ln-1500"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1501"></a>          <span class="c">! Calculates report variables.</span>
<a name="ln-1502"></a>
<a name="ln-1503"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1504"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1507"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MinutesPerTimeStep</span>
<a name="ln-1508"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Month</span>
<a name="ln-1509"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1510"></a>
<a name="ln-1511"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1512"></a>
<a name="ln-1513"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1514"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ListNum</span>
<a name="ln-1515"></a>
<a name="ln-1516"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1517"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">BillingPeriod</span>
<a name="ln-1518"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-1519"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">AveragingWindow</span>
<a name="ln-1520"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">OnPeak</span>
<a name="ln-1521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OverLimit</span>
<a name="ln-1522"></a>
<a name="ln-1523"></a>          <span class="c">! FLOW:</span>
<a name="ln-1524"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">BillingSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1525"></a><span class="k">    </span><span class="n">BillingPeriod</span> <span class="o">=</span> <span class="n">Month</span>
<a name="ln-1526"></a>  <span class="k">ELSE</span>
<a name="ln-1527"></a><span class="k">    </span><span class="n">BillingPeriod</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">BillingSchedule</span><span class="p">)</span>
<a name="ln-1528"></a>  <span class="k">END IF</span>
<a name="ln-1529"></a>
<a name="ln-1530"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">BillingPeriod</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">BillingPeriod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1531"></a>    <span class="c">! Reset variables for new billing period</span>
<a name="ln-1532"></a>    <span class="c">!DemandManagerList(ListNum)%History = 0.0        ! Don&#39;t reset--continue from previous billing period</span>
<a name="ln-1533"></a>    <span class="c">!DemandManagerList(ListNum)%AverageDemand = 0.0  ! Don&#39;t reset--continue from previous billing period</span>
<a name="ln-1534"></a>    <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1535"></a>    <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimitDuration</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1536"></a>
<a name="ln-1537"></a>    <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">BillingPeriod</span> <span class="o">=</span> <span class="n">BillingPeriod</span>
<a name="ln-1538"></a>  <span class="k">END IF</span>
<a name="ln-1539"></a>
<a name="ln-1540"></a>  <span class="c">! Add new timestep to demand history and subtract oldest timestep</span>
<a name="ln-1541"></a>  <span class="n">AveragingWindow</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AveragingWindow</span>
<a name="ln-1542"></a>  <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span> <span class="p">&amp;</span>
<a name="ln-1543"></a>    <span class="o">+</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">MeterDemand</span> <span class="o">-</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">AveragingWindow</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a>  <span class="c">! Update demand history</span>
<a name="ln-1546"></a>  <span class="k">DO </span><span class="n">Item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AveragingWindow</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1547"></a>    <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span><span class="p">(</span><span class="n">Item</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1548"></a>  <span class="k">END DO</span>
<a name="ln-1549"></a><span class="k">  </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">History</span><span class="p">(</span><span class="n">AveragingWindow</span><span class="p">)</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">MeterDemand</span>
<a name="ln-1550"></a>
<a name="ln-1551"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1552"></a><span class="k">    </span><span class="n">OnPeak</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1553"></a>  <span class="k">ELSE</span>
<a name="ln-1554"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakSchedule</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1555"></a><span class="k">      </span><span class="n">OnPeak</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1556"></a>    <span class="k">ELSE</span>
<a name="ln-1557"></a><span class="k">      </span><span class="n">OnPeak</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1558"></a>    <span class="k">END IF</span>
<a name="ln-1559"></a><span class="k">  END IF</span>
<a name="ln-1560"></a>
<a name="ln-1561"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">OnPeak</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1562"></a><span class="k">    </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakDemand</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1563"></a>      <span class="nb">MAX</span><span class="p">(</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span><span class="p">,</span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">PeakDemand</span><span class="p">)</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a>    <span class="n">OverLimit</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">AverageDemand</span> <span class="o">-</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">ScheduledLimit</span>
<a name="ln-1566"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OverLimit</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1567"></a><span class="k">      </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimit</span> <span class="o">=</span> <span class="n">OverLimit</span>
<a name="ln-1568"></a>      <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimitDuration</span> <span class="o">=</span> <span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimitDuration</span> <span class="o">+</span> <span class="p">(</span><span class="n">MinutesPerTimeStep</span> <span class="o">/</span> <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1569"></a>    <span class="k">ELSE</span>
<a name="ln-1570"></a><span class="k">      </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1571"></a>    <span class="k">END IF</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a><span class="k">  ELSE</span>
<a name="ln-1574"></a><span class="k">    </span><span class="n">DemandManagerList</span><span class="p">(</span><span class="n">ListNum</span><span class="p">)%</span><span class="n">OverLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1575"></a>  <span class="k">END IF</span>
<a name="ln-1576"></a>
<a name="ln-1577"></a><span class="k">  RETURN</span>
<a name="ln-1578"></a>
<a name="ln-1579"></a><span class="k">END SUBROUTINE </span><span class="n">ReportDemandManagerList</span>
<a name="ln-1580"></a>
<a name="ln-1581"></a><span class="k">SUBROUTINE </span><span class="n">LoadInterface</span><span class="p">(</span><span class="n">Action</span><span class="p">,</span> <span class="n">MgrNum</span><span class="p">,</span> <span class="n">LoadPtr</span><span class="p">,</span> <span class="n">CanReduceDemand</span><span class="p">)</span>
<a name="ln-1582"></a>
<a name="ln-1583"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1584"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-1585"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-1586"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1587"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1588"></a>
<a name="ln-1589"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1590"></a>          <span class="c">! Provides a universal interface to handle all communication with the various load objects.</span>
<a name="ln-1591"></a>          <span class="c">! Demand managers for new types of loads can be easily added with a new CASE statement in this subroutine</span>
<a name="ln-1592"></a>          <span class="c">! and new GetInput code.</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1595"></a>          <span class="c">!</span>
<a name="ln-1596"></a>
<a name="ln-1597"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1598"></a>  <span class="k">USE </span><span class="n">ExteriorEnergyUse</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ExteriorLights</span>
<a name="ln-1599"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Lights</span><span class="p">,</span> <span class="n">ZoneElectric</span>
<a name="ln-1600"></a>  <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlledZone</span><span class="p">,</span><span class="n">ComfortControlledZone</span><span class="p">,</span><span class="n">NumComfortControlledZones</span>
<a name="ln-1601"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneThermostatSetPointHi</span><span class="p">,</span> <span class="n">ZoneThermostatSetPointLo</span><span class="p">,</span><span class="n">ComfortControlType</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1604"></a>
<a name="ln-1605"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1606"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Action</span>
<a name="ln-1607"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MgrNum</span>
<a name="ln-1608"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LoadPtr</span>
<a name="ln-1609"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CanReduceDemand</span>
<a name="ln-1610"></a>
<a name="ln-1611"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1612"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">LowestPower</span>
<a name="ln-1613"></a>
<a name="ln-1614"></a>          <span class="c">! FLOW:</span>
<a name="ln-1615"></a>  <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1616"></a>
<a name="ln-1617"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ManagerTypeExtLights</span><span class="p">)</span>
<a name="ln-1620"></a>      <span class="n">LowestPower</span> <span class="o">=</span> <span class="n">ExteriorLights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">DesignLevel</span> <span class="o">*</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span>
<a name="ln-1621"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">CheckCanReduce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1622"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ExteriorLights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">Power</span> <span class="o">&gt;</span> <span class="n">LowestPower</span><span class="p">)</span> <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1623"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">SetLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1624"></a><span class="k">        </span><span class="n">ExteriorLights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1625"></a>        <span class="n">ExteriorLights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">DemandLimit</span> <span class="o">=</span> <span class="n">LowestPower</span>
<a name="ln-1626"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">ClearLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1627"></a><span class="k">        </span><span class="n">ExteriorLights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1628"></a>      <span class="k">END IF</span>
<a name="ln-1629"></a>
<a name="ln-1630"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">ManagerTypeLights</span><span class="p">)</span>
<a name="ln-1631"></a>      <span class="n">LowestPower</span> <span class="o">=</span> <span class="n">Lights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">DesignLevel</span> <span class="o">*</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span>
<a name="ln-1632"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">CheckCanReduce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1633"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Lights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">Power</span> <span class="o">&gt;</span> <span class="n">LowestPower</span><span class="p">)</span> <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1634"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">SetLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1635"></a><span class="k">        </span><span class="n">Lights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1636"></a>        <span class="n">Lights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">DemandLimit</span> <span class="o">=</span> <span class="n">LowestPower</span>
<a name="ln-1637"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">ClearLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1638"></a><span class="k">        </span><span class="n">Lights</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1639"></a>      <span class="k">END IF</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">ManagerTypeElecEquip</span><span class="p">)</span>
<a name="ln-1642"></a>      <span class="n">LowestPower</span> <span class="o">=</span> <span class="n">ZoneElectric</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">DesignLevel</span> <span class="o">*</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span>
<a name="ln-1643"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">CheckCanReduce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1644"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ZoneElectric</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">Power</span> <span class="o">&gt;</span> <span class="n">LowestPower</span><span class="p">)</span> <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1645"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">SetLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1646"></a><span class="k">        </span><span class="n">ZoneElectric</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1647"></a>        <span class="n">ZoneElectric</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">DemandLimit</span> <span class="o">=</span> <span class="n">LowestPower</span>
<a name="ln-1648"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">ClearLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1649"></a><span class="k">        </span><span class="n">ZoneElectric</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1650"></a>      <span class="k">END IF</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">ManagerTypeThermostats</span><span class="p">)</span>
<a name="ln-1653"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">CheckCanReduce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1654"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ZoneThermostatSetPointLo</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="p">&amp;</span>  <span class="c">! Heating</span>
<a name="ln-1655"></a>          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneThermostatSetPointHi</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">UpperLimit</span><span class="p">)</span> <span class="p">&amp;</span>  <span class="c">! Cooling</span>
<a name="ln-1656"></a>          <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1657"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">SetLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1658"></a><span class="k">        </span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1659"></a>        <span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">HeatingResetLimit</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span>
<a name="ln-1660"></a>        <span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">CoolingResetLimit</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">UpperLimit</span>
<a name="ln-1661"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">ClearLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1662"></a><span class="k">        </span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1663"></a>      <span class="k">END IF</span>
<a name="ln-1664"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">NumComfortControlledZones</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1665"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ComfortControlType</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1666"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">CheckCanReduce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1667"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">ZoneThermostatSetPointLo</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span> <span class="p">&amp;</span>  <span class="c">!Heating</span>
<a name="ln-1668"></a>             <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneThermostatSetPointHi</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">UpperLimit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1669"></a>              <span class="n">CanReduceDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1670"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">SetLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1671"></a><span class="k">            </span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1672"></a>            <span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">HeatingResetLimit</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">LowerLimit</span>
<a name="ln-1673"></a>            <span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">CoolingResetLimit</span> <span class="o">=</span> <span class="n">DemandMgr</span><span class="p">(</span><span class="n">MgrNum</span><span class="p">)%</span><span class="n">UpperLimit</span>
<a name="ln-1674"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Action</span> <span class="o">==</span> <span class="n">ClearLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1675"></a><span class="k">            </span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">LoadPtr</span><span class="p">)%</span><span class="n">ManageDemand</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1676"></a>          <span class="k">END IF</span>
<a name="ln-1677"></a><span class="k">        END IF</span>
<a name="ln-1678"></a><span class="k">      END IF</span>
<a name="ln-1679"></a>
<a name="ln-1680"></a><span class="k">  END SELECT</span>
<a name="ln-1681"></a>
<a name="ln-1682"></a><span class="k">  RETURN</span>
<a name="ln-1683"></a>
<a name="ln-1684"></a><span class="k">END SUBROUTINE </span><span class="n">LoadInterface</span>
<a name="ln-1685"></a>
<a name="ln-1686"></a><span class="k">SUBROUTINE </span><span class="n">InitDemandManagers</span>
<a name="ln-1687"></a>
<a name="ln-1688"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1689"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1690"></a>          <span class="c">!       DATE WRITTEN   September 2010</span>
<a name="ln-1691"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1692"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1695"></a>          <span class="c">! Provide external call to get Demand manager input after</span>
<a name="ln-1696"></a>          <span class="c">! appropriate initializations.</span>
<a name="ln-1697"></a>
<a name="ln-1698"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1699"></a>          <span class="c">! na</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1702"></a>          <span class="c">! na</span>
<a name="ln-1703"></a>
<a name="ln-1704"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1705"></a>          <span class="c">! na</span>
<a name="ln-1706"></a>
<a name="ln-1707"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1710"></a>          <span class="c">! na</span>
<a name="ln-1711"></a>
<a name="ln-1712"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1713"></a>          <span class="c">! na</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1716"></a>          <span class="c">! na</span>
<a name="ln-1717"></a>
<a name="ln-1718"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1719"></a>          <span class="c">! na</span>
<a name="ln-1720"></a>
<a name="ln-1721"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1722"></a>          <span class="c">! na</span>
<a name="ln-1723"></a>
<a name="ln-1724"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1725"></a><span class="k">    CALL </span><span class="n">GetDemandManagerInput</span>
<a name="ln-1726"></a>    <span class="k">CALL </span><span class="n">GetDemandManagerListInput</span>
<a name="ln-1727"></a>    <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1728"></a>  <span class="k">END IF</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a><span class="k">  RETURN</span>
<a name="ln-1731"></a>
<a name="ln-1732"></a><span class="k">END SUBROUTINE </span><span class="n">InitDemandManagers</span>
<a name="ln-1733"></a>
<a name="ln-1734"></a><span class="c">!     NOTICE</span>
<a name="ln-1735"></a><span class="c">!</span>
<a name="ln-1736"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-1737"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-1738"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-1739"></a><span class="c">!</span>
<a name="ln-1740"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-1741"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-1742"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-1743"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-1744"></a><span class="c">!</span>
<a name="ln-1745"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-1746"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-1747"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-1748"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-1749"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-1750"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-1751"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-1752"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-1753"></a><span class="c">!     permit others to do so.</span>
<a name="ln-1754"></a><span class="c">!</span>
<a name="ln-1755"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-1756"></a><span class="c">!</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a><span class="k">END MODULE </span><span class="n">DemandManager</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
