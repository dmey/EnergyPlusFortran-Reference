<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HeatRecovery.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HeatRecovery.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.9% of total for source files.">3255 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HeatRecovery.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HeatRecovery.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatrecovery.html">HeatRecovery</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html#src">HeatRecovery.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatrecovery.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileheatrecoveryf90EfferentGraph" width="641pt" height="1208pt"
 viewBox="0.00 0.00 641.00 1207.79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph" class="graph" transform="scale(.2414 .2414) rotate(0) translate(4 4999.4949)">
<title>sourcefile~~heatrecovery.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-4999.4949 2651.4568,-4999.4949 2651.4568,4 -4,4"/>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~heatrecovery.f90</title>
<polygon fill="none" stroke="#000000" points="2647.5906,-3261.4874 2552.0561,-3261.4874 2552.0561,-3239.4765 2647.5906,-3239.4765 2647.5906,-3261.4874"/>
<text text-anchor="middle" x="2599.8234" y="-3247.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatRecovery.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1116.678,-3679.4874 1002.3481,-3679.4874 1002.3481,-3657.4765 1116.678,-3657.4765 1116.678,-3679.4874"/>
<text text-anchor="middle" x="1059.5131" y="-3665.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3669.4819C1345.136,-3687.7759 1621.7872,-3757.8633 1704.2205,-3830.4819 1731.365,-3854.3946 1709.5004,-3884.3791 1740.2205,-3903.4819 1972.3407,-4047.8229 2096.702,-3944.8676 2352.8577,-3849.4819"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2516.2841,-3261.4874 2453.908,-3261.4874 2453.908,-3239.4765 2516.2841,-3239.4765 2516.2841,-3261.4874"/>
<text text-anchor="middle" x="2485.0961" y="-3247.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1803.7218,-3773.4819C1892.7806,-3781.831 2072.9818,-3609.4487 2158.5791,-3583.4819 2241.601,-3558.2964 2283.8818,-3617.1059 2352.8577,-3564.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2352.8577,-3564.4819C2448.6375,-3487.582 2476.042,-3328.8335 2482.9767,-3271.6188"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2486.4656,-3271.9125 2484.1048,-3261.584 2479.5094,-3271.1303 2486.4656,-3271.9125"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1236.8123,-3669.4819C1443.1751,-3699.772 1506.4607,-3645.1935 1704.2205,-3711.4819 1753.6242,-3728.0419 1752.8376,-3762.2676 1803.7218,-3773.4819"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1682.5461,-2767.4874 1563.875,-2767.4874 1563.875,-2745.4765 1682.5461,-2745.4765 1682.5461,-2767.4874"/>
<text text-anchor="middle" x="1623.2106" y="-2753.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1236.8123,-3593.4819C1264.3907,-3566.8039 1295.8148,-3603.4048 1321.0291,-3574.4819 1382.8769,-3503.5375 1325.779,-3241.2609 1357.0291,-3152.4819 1372.0966,-3109.6762 1556.3959,-2850.0091 1609.1731,-2776.0966"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1612.2328,-2777.8348 1615.1996,-2767.6638 1606.5377,-2773.7647 1612.2328,-2777.8348"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1111.9967,-3657.4282C1150.8002,-3646.853 1202.6255,-3627.3569 1236.8123,-3593.4819"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2251.7802,-3614.4874 2158.512,-3614.4874 2158.512,-3592.4765 2251.7802,-3592.4765 2251.7802,-3614.4874"/>
<text text-anchor="middle" x="2205.1461" y="-3600.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.7218,-3773.4819C1864.4839,-3779.1782 1880.0354,-3771.6343 1941.0359,-3773.4819"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2418.147,-1807.4874 2287.5683,-1807.4874 2287.5683,-1785.4765 2418.147,-1785.4765 2418.147,-1807.4874"/>
<text text-anchor="middle" x="2352.8577" y="-1793.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1116.7442,-3666.1184C1151.5447,-3665.3478 1196.8371,-3665.5305 1236.8123,-3669.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3669.4819C1304.0767,-3676.1308 2217.2352,-3056.6196 2251.7131,-2998.4819 2314.3739,-2892.8218 2347.1392,-1971.0873 2352.1713,-1817.9885"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2355.6816,-1817.7243 2352.5081,-1807.6159 2348.6853,-1817.497 2355.6816,-1817.7243"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1285.8118,-3565.4874 1187.8127,-3565.4874 1187.8127,-3543.4765 1285.8118,-3543.4765 1285.8118,-3565.4874"/>
<text text-anchor="middle" x="1236.8123" y="-3551.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1094.5546,-3657.38C1102.3967,-3653.7935 1110.2585,-3649.2172 1116.5955,-3643.4819 1140.7924,-3621.5823 1127.0857,-3599.8373 1152.5955,-3579.4819 1160.0277,-3573.5514 1168.8347,-3569.0267 1177.906,-3565.5749"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1179.0623,-3568.8786 1187.4083,-3562.3521 1176.814,-3562.2494 1179.0623,-3568.8786"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.5454,-2690.4874 1740.8982,-2690.4874 1740.8982,-2668.4765 1866.5454,-2668.4765 1866.5454,-2690.4874"/>
<text text-anchor="middle" x="1803.7218" y="-2676.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3593.4819C1264.0683,-3566.4745 1292.2724,-3599.8855 1321.0291,-3574.4819 1356.4306,-3543.2083 1337.938,-3517.6889 1357.0291,-3474.4819 1414.3339,-3344.7896 1442.3844,-3319.0972 1506.2007,-3192.4819 1509.5839,-3185.7695 1734.7172,-2709.6021 1740.2205,-2704.4819 1744.0792,-2700.8918 1748.5143,-2697.7945 1753.209,-2695.1271"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1755.084,-2698.1034 1762.4737,-2690.5111 1751.9623,-2691.838 1755.084,-2698.1034"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1305.21,-2729.4874 1168.4145,-2729.4874 1168.4145,-2707.4765 1305.21,-2707.4765 1305.21,-2729.4874"/>
<text text-anchor="middle" x="1236.8123" y="-2715.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1064.3309,-3657.1554C1075.8425,-3629.4801 1104.8592,-3555.9666 1116.5955,-3491.4819 1131.4945,-3409.6194 1101.2411,-2808.9509 1152.5955,-2743.4819 1155.1179,-2740.2662 1158.035,-2737.4498 1161.2365,-2734.9844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1163.1853,-2737.8926 1169.7176,-2729.5512 1159.4092,-2731.9983 1163.1853,-2737.8926"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1485.3406,-3918.4874 1377.8892,-3918.4874 1377.8892,-3896.4765 1485.3406,-3896.4765 1485.3406,-3918.4874"/>
<text text-anchor="middle" x="1431.6149" y="-3904.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3669.4819C1344.9888,-3680.1748 1273.2049,-3813.2719 1357.0291,-3882.4819 1361.6167,-3886.2698 1366.8028,-3889.4924 1372.2508,-3892.2325"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1371.0485,-3895.5285 1381.6072,-3896.4029 1373.8984,-3889.1349 1371.0485,-3895.5285"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1286.9652,-1661.4874 1186.6593,-1661.4874 1186.6593,-1639.4765 1286.9652,-1639.4765 1286.9652,-1661.4874"/>
<text text-anchor="middle" x="1236.8123" y="-1647.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1577.4819C1741.242,-1536.905 1780.6306,-1528.3687 1867.2231,-1438.4819 2061.5983,-1236.7122 1964.4631,-1081.5009 2158.5791,-879.4819 2263.7361,-770.0437 2402.6699,-652.0431 2485.0961,-779.4819"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1287.1626,-1659.8962C1298.3213,-1662.0249 1310.0823,-1664.3011 1321.0291,-1666.4819 1388.3024,-1679.884 1554.6172,-1729.9927 1623.2106,-1729.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1623.2106,-1729.4819C1662.0817,-1728.802 1669.9637,-1714.864 1704.2205,-1696.4819 1781.0688,-1655.2455 2308.5292,-1179.3747 2352.8577,-1254.4819"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1431.6149,-2281.4819C1444.0014,-2301.6864 1529.0939,-2673.7371 1542.2007,-2693.4819 1555.1226,-2712.9482 1576.0641,-2729.003 1593.4178,-2740.0331"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1591.7449,-2743.1125 1602.1041,-2745.3346 1595.3917,-2737.1374 1591.7449,-2743.1125"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1239.635,-1661.5643C1250.9223,-1706.1194 1293.5271,-1876.606 1321.0291,-2018.4819 1340.3849,-2118.334 1296.7677,-2162.545 1357.0291,-2244.4819 1378.953,-2274.2918 1412.2745,-2249.9345 1431.6149,-2281.4819"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1239.7527,-1661.5424C1251.4882,-1706.0139 1295.5676,-1876.2257 1321.0291,-2018.4819 1342.9016,-2140.6864 1326.5118,-2175.1447 1357.0291,-2295.4819 1413.3388,-2517.5252 1424.6573,-2579.8668 1542.2007,-2776.4819 1745.2182,-3116.0699 1897.9121,-3125.8121 2122.5791,-3451.4819 2153.2405,-3495.9276 2181.5616,-3552.921 2195.7048,-3582.9117"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2192.698,-3584.7454 2200.0967,-3592.3288 2199.042,-3581.7866 2192.698,-3584.7454"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504.8695,-2235.4874 1358.3603,-2235.4874 1358.3603,-2213.4765 1504.8695,-2213.4765 1504.8695,-2235.4874"/>
<text text-anchor="middle" x="1431.6149" y="-2221.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1239.381,-1661.841C1256.1964,-1736.1447 1350.0894,-2150.169 1357.0291,-2161.4819 1368.6949,-2180.4995 1388.082,-2196.6156 1404.1666,-2207.7864"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1402.4307,-2210.8356 1412.6926,-2213.4707 1406.3137,-2205.0113 1402.4307,-2210.8356"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1729.4819C1781.6314,-1729.3499 1828.8577,-1702.4927 1978.8486,-1753.4819 1997.055,-1759.6712 1996.7441,-1771.001 2014.8486,-1777.4819 2054.8608,-1791.8051 2169.5118,-1819.6406 2205.1461,-1796.4819"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.461,-3233.4874 1740.9826,-3233.4874 1740.9826,-3211.4765 1866.461,-3211.4765 1866.461,-3233.4874"/>
<text text-anchor="middle" x="1803.7218" y="-3219.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1246.2075,-1661.5143C1282.5679,-1704.52 1416.475,-1865.7919 1506.2007,-2012.4819 1525.0767,-2043.3419 1514.5402,-2062.1681 1542.2007,-2085.4819 1570.9134,-2109.6826 1601.0116,-2079.195 1623.2106,-2109.4819"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1623.2106,-2109.4819C1753.9752,-2322.2279 1676.9587,-2417.2542 1704.2205,-2665.4819 1716.0188,-2772.9103 1698.2911,-3050.8728 1740.2205,-3150.4819 1749.2227,-3171.8681 1767.2138,-3191.2872 1781.7547,-3204.5539"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1779.575,-3207.2977 1789.3991,-3211.2648 1784.1931,-3202.0372 1779.575,-3207.2977"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1481.0048,-1257.4874 1382.2249,-1257.4874 1382.2249,-1235.4765 1481.0048,-1235.4765 1481.0048,-1257.4874"/>
<text text-anchor="middle" x="1431.6149" y="-1243.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M1248.3516,-1639.2235C1266.0728,-1621.3961 1300.1259,-1584.9391 1321.0291,-1548.4819 1377.4344,-1450.1053 1413.9446,-1317.7427 1426.6255,-1267.2384"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1430.0335,-1268.0363 1429.0304,-1257.4891 1423.2372,-1266.3597 1430.0335,-1268.0363"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1285.7189,-1661.5412C1297.6261,-1665.1615 1310.0782,-1669.7639 1321.0291,-1675.4819 1324.0477,-1677.0581 1702.5305,-1978.5254 1704.2205,-1981.4819 1772.9415,-2101.7099 1797.9142,-2554.6907 1802.788,-2658.2885"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1799.2985,-2658.6012 1803.2526,-2668.4305 1806.2912,-2658.2807 1799.2985,-2658.6012"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1978.6623,-1188.4874 1903.4095,-1188.4874 1903.4095,-1166.4765 1978.6623,-1166.4765 1978.6623,-1188.4874"/>
<text text-anchor="middle" x="1941.0359" y="-1174.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-1611.4819C1514.0973,-1585.4794 1541.3941,-1605.5098 1623.2106,-1577.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1577.4819C1657.3263,-1565.7949 1848.8246,-1394.4975 1867.2231,-1363.4819 1904.6317,-1300.4201 1861.6225,-1262.8606 1903.2231,-1202.4819 1905.1431,-1199.6953 1907.4849,-1197.1395 1910.0527,-1194.8155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1912.4312,-1197.4023 1918.238,-1188.5404 1908.1723,-1191.8469 1912.4312,-1197.4023"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1867.2245,-1226.4874 1740.2191,-1226.4874 1740.2191,-1204.4765 1867.2245,-1204.4765 1867.2245,-1226.4874"/>
<text text-anchor="middle" x="1803.7218" y="-1212.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1286.986,-1642.7368C1326.6464,-1636.0651 1383.1987,-1625.3271 1431.6149,-1611.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-1611.4819C1628.7258,-1555.116 1759.3282,-1309.0911 1794.3006,-1236.0183"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1797.6721,-1237.0737 1798.7631,-1226.5352 1791.3383,-1234.0932 1797.6721,-1237.0737"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-1285.4874 528.0262,-1285.4874 528.0262,-1263.4765 643.4123,-1263.4765 643.4123,-1285.4874"/>
<text text-anchor="middle" x="585.7192" y="-1271.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.0745,-1263.3983C643.7813,-1259.945 649.8989,-1255.4175 654.4731,-1249.4819 708.1407,-1179.8417 653.2448,-935.1313 690.4731,-855.4819 734.5627,-761.1531 780.9817,-761.9047 855.7932,-689.4819 985.4336,-563.9809 996.6011,-503.1622 1152.5955,-412.4819 1283.6286,-336.3118 1653.9269,-186.3934 1803.7218,-209.4819"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-3074.4874 721.7644,-3074.4874 721.7644,-3052.4765 788.502,-3052.4765 788.502,-3074.4874"/>
<text text-anchor="middle" x="755.1332" y="-3060.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M588.3931,-1285.5029C599.0144,-1329.8179 638.4239,-1499.4495 654.4731,-1641.4819 699.5717,-2040.5942 657.616,-2144.176 690.4731,-2544.4819 706.3751,-2738.2185 740.8993,-2970.8785 751.7791,-3041.8766"/>
<polygon fill="#ffff00" stroke="#ffff00" points="748.387,-3042.8459 753.369,-3052.1963 755.3054,-3041.78 748.387,-3042.8459"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M632.2516,-1263.3387C640.3212,-1259.8718 648.1406,-1255.3549 654.4731,-1249.4819 813.9317,-1101.5938 721.2482,-974.349 855.7932,-803.4819 894.3231,-754.5504 918.6347,-757.4117 966.4307,-717.4819 1051.7325,-646.2189 1054.6494,-603.0309 1152.5955,-550.4819 1261.4463,-492.0824 1946.8422,-258.0586 2068.7139,-323.4819"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-1235.4819C1009.4994,-1210.2698 1052.4878,-1256.704 1116.5955,-1335.4819 1157.6907,-1385.9814 1101.211,-1437.4989 1152.5955,-1477.4819 1211.6762,-1523.4536 1246.1775,-1478.5672 1321.0291,-1477.4819 1535.6268,-1474.3705 1589.1015,-1463.4819 1803.7218,-1463.4819 1803.7218,-1463.4819 1803.7218,-1463.4819 2068.7139,-1463.4819 2233.5299,-1463.4819 2323.0157,-1702.4567 2346.5226,-1775.5172"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2343.2905,-1776.9078 2349.6224,-1785.4024 2349.9698,-1774.8133 2343.2905,-1776.9078"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M594.1386,-1285.6904C628.2319,-1331.6598 757.1951,-1511.2752 819.7932,-1679.4819 821.7116,-1684.6367 1115.6969,-3230.0556 1116.5955,-3235.4819 1135.3651,-3348.8357 1094.1031,-3392.5879 1152.5955,-3491.4819 1164.5482,-3511.6906 1185.7409,-3527.4926 1203.8757,-3538.2163"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1202.5835,-3541.5051 1213.0151,-3543.3576 1206.0155,-3535.4042 1202.5835,-3541.5051"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2122.4447,-571.4874 2014.9831,-571.4874 2014.9831,-549.4765 2122.4447,-549.4765 2122.4447,-571.4874"/>
<text text-anchor="middle" x="2068.7139" y="-557.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1431.6149,-551.4819C1655.8476,-520.1627 1717.8971,-513.1379 1941.0359,-551.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-1275.4819C826.6018,-1279.2357 841.7849,-1253.2473 911.1119,-1235.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M911.1119,-1235.4819C982.8948,-1217.0873 1004.1998,-1208.793 1059.5131,-1159.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M643.7805,-1273.4899C676.5057,-1273.2655 718.1242,-1273.5381 755.1332,-1275.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.5131,-1159.4819C1152.5333,-1076.5556 1065.7137,-695.819 1152.5955,-606.4819 1240.7163,-515.8708 1307.5132,-575.4495 1431.6149,-551.4819"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1275.4819C1014.7269,-1274.5839 958.8908,-1530.6577 1152.5955,-1703.4819 1221.9587,-1765.3681 1259.8902,-1757.459 1321.0291,-1827.4819 1343.0051,-1852.6513 1334.49,-1868.8154 1357.0291,-1893.4819 1453.0297,-1998.5439 1518.2581,-1975.3616 1623.2106,-2071.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-2071.4819C1650.5528,-2097.2209 1679.2974,-2067.394 1704.2205,-2095.4819 1780.6397,-2181.6054 1799.4976,-2563.8008 1803.0253,-2658.2986"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1799.5298,-2658.4878 1803.3824,-2668.3573 1806.5253,-2658.2394 1799.5298,-2658.4878"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-1159.4819C1074.5876,-1146.0432 1216.6493,-1198.3439 1236.8123,-1199.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-1199.4819C1413.4686,-1209.4525 1621.4594,-1213.3092 1729.7449,-1214.7224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1729.8647,-1218.2241 1739.9085,-1214.8516 1729.9538,-1211.2246 1729.8647,-1218.2241"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1704.2303,-3861.4874 1542.1908,-3861.4874 1542.1908,-3839.4765 1704.2303,-3839.4765 1704.2303,-3861.4874"/>
<text text-anchor="middle" x="1623.2106" y="-3847.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.4541,-1285.4963C599.3077,-1329.7859 639.4815,-1499.334 654.4731,-1641.4819 671.2831,-1800.8701 648.3687,-2928.8392 690.4731,-3083.4819 721.5871,-3197.7584 772.2747,-3207.996 819.7932,-3316.4819 840.2625,-3363.2138 820.6622,-3388.4863 855.7932,-3425.4819 892.1204,-3463.7373 919.3862,-3444.6082 966.4307,-3468.4819 983.362,-3477.0741 984.6038,-3484.9475 1002.4307,-3491.4819 1136.5854,-3540.6561 1210.9767,-3443.3552 1321.0291,-3534.4819 1359.9998,-3566.7509 1327.8528,-3601.145 1357.0291,-3642.4819 1421.4478,-3733.7504 1537.3697,-3804.3551 1592.4872,-3834.5172"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1590.9588,-3837.6695 1601.4208,-3839.342 1594.2852,-3831.5104 1590.9588,-3837.6695"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2352.8577,-4822.4819C2577.0735,-4667.2658 2379.8428,-3854.0501 2485.0961,-3602.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M758.3139,-3074.4992C768.3654,-3109.5886 799.9526,-3221.9777 819.7932,-3316.4819 839.9701,-3412.5879 817.8754,-3443.8966 855.7932,-3534.4819 888.0563,-3611.5582 937.7033,-3608.0192 966.4307,-3686.4819 1004.2732,-3789.841 941.9046,-4088.5485 1002.4307,-4180.4819 1043.7861,-4243.2969 1085.7348,-4224.0487 1152.5955,-4258.4819 1227.3208,-4296.9655 1246.2931,-4306.019 1321.0291,-4344.4819 1580.2126,-4477.8708 1637.7579,-4526.0788 1903.2231,-4646.4819 1952.0828,-4668.6425 2308.7458,-4853.0189 2352.8577,-4822.4819"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M758.1792,-3074.5286C767.8309,-3109.7055 798.3614,-3222.3258 819.7932,-3316.4819 837.9003,-3396.0315 804.5301,-3433.0147 855.7932,-3496.4819 872.633,-3517.3308 897.6338,-3497.3174 911.1119,-3520.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-3520.4819C929.6842,-3552.4015 944.649,-3552.66 966.4307,-3582.4819 984.9983,-3607.9035 978.8722,-3622.601 1002.4307,-3643.4819 1006.3776,-3646.9803 1010.8914,-3650.0529 1015.6129,-3652.735"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1014.3525,-3656.0201 1024.8543,-3657.4208 1017.5181,-3649.7767 1014.3525,-3656.0201"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M911.1119,-3062.4819C939.8084,-3071.5061 949.752,-3076.4471 966.4307,-3101.4819 1007.3244,-3162.8636 949.5049,-3212.1121 1002.4307,-3263.4819 1122.2088,-3379.7388 1574.0434,-3388.7452 1740.2205,-3404.4819 1796.4147,-3409.8035 1811.4415,-3413.1146 1867.2231,-3404.4819 1923.1647,-3395.8245 2296.9338,-3241.7113 2352.8577,-3250.4819"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1497.1099,-715.4874 1366.1198,-715.4874 1366.1198,-693.4765 1497.1099,-693.4765 1497.1099,-715.4874"/>
<text text-anchor="middle" x="1431.6149" y="-701.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M756.5594,-3052.1617C763.5427,-2996.7067 794.8024,-2748.1642 819.7932,-2544.4819 836.0398,-2412.0675 799.8736,-2367.6039 855.7932,-2246.4819 886.2002,-2180.6202 936.1387,-2192.3966 966.4307,-2126.4819 1023.7973,-2001.6534 974.6033,-1954.0134 1002.4307,-1819.4819 1049.5161,-1591.8471 1070.9539,-1536.1269 1152.5955,-1318.4819 1242.5241,-1078.7448 1382.4148,-800.5505 1421.2888,-724.5375"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1424.4522,-726.0389 1425.9004,-715.5435 1418.2233,-722.845 1424.4522,-726.0389"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1481.1637,-3183.4874 1382.066,-3183.4874 1382.066,-3161.4765 1481.1637,-3161.4765 1481.1637,-3183.4874"/>
<text text-anchor="middle" x="1431.6149" y="-3169.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M911.1119,-3062.4819C955.2564,-3075.626 958.6634,-3097.1316 1002.4307,-3111.4819 1129.6061,-3153.1801 1287.1978,-3166.3819 1371.5792,-3170.5563"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1371.5951,-3174.0608 1381.748,-3171.0329 1371.9229,-3167.0685 1371.5951,-3174.0608"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M788.7435,-3057.8645C820.8498,-3053.7481 870.2601,-3050.7034 911.1119,-3062.4819"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M911.1119,-3062.4819C966.3662,-3078.413 1098.0572,-2987.7138 1152.5955,-2969.4819 1189.5075,-2957.1424 1198.354,-2951.4589 1236.8123,-2945.4819"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1236.8123,-2945.4819C1279.7138,-2935.2474 1392.4136,-2927.6944 1431.6149,-2907.4819"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M788.7436,-3067.4268C799.2864,-3069.7731 810.5689,-3073.5149 819.7932,-3079.4819 908.4728,-3136.8475 916.7887,-3173.2588 966.4307,-3266.4819 990.8073,-3312.2592 962.977,-3343.8191 1002.4307,-3377.4819 1045.5324,-3414.2574 1453.856,-3434.7974 1506.2007,-3456.4819 1616.6778,-3502.2486 1821.509,-3769.8616 1941.0359,-3773.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1941.0359,-3773.4819C1998.4064,-3773.6218 2021.935,-3825.6953 2068.7139,-3792.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2068.7139,-3792.4819C2132.3236,-3747.3185 2177.4971,-3663.0024 2195.9307,-3624.1087"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2199.2011,-3625.3755 2200.226,-3614.8304 2192.8487,-3622.4348 2199.2011,-3625.3755"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1236.8123,-2757.4819C1264.8483,-2731.2852 1295.9425,-2767.5156 1321.0291,-2738.4819 1389.6596,-2659.053 1301.0869,-2356.3053 1357.0291,-2267.4819 1364.4556,-2255.6902 1376.3657,-2246.784 1388.5086,-2240.2256"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1390.3483,-2243.2209 1397.7692,-2235.6591 1387.2524,-2236.9427 1390.3483,-2243.2209"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M778.8054,-3052.4291C852.6439,-3017.1725 1082.9851,-2901.2171 1236.8123,-2757.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="966.25,-3416.4874 855.9739,-3416.4874 855.9739,-3394.4765 966.25,-3394.4765 966.25,-3416.4874"/>
<text text-anchor="middle" x="911.1119" y="-3402.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M761.2411,-3074.6253C773.6909,-3097.7055 802.3003,-3152.664 819.7932,-3201.4819 841.6105,-3262.368 825.6246,-3285.2721 855.7932,-3342.4819 864.7044,-3359.3805 879.019,-3375.5114 890.8541,-3387.2199"/>
<polygon fill="#ff0055" stroke="#ff0055" points="888.5461,-3389.8556 898.1916,-3394.239 893.3849,-3384.7973 888.5461,-3389.8556"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-2945.4819C1389.268,-2909.1122 1784.4348,-2978.0303 1941.0359,-2984.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-2984.4819C1997.7416,-2982.3513 2013.0258,-2973.5766 2068.7139,-2984.4819"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M911.1119,-3482.4819C930.5653,-3500.9162 942.7705,-3493.8943 966.4307,-3506.4819 983.1928,-3515.3997 985.6183,-3520.6593 1002.4307,-3529.4819 1026.8001,-3542.2703 1033.3948,-3544.8073 1059.5131,-3553.4819"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M757.9117,-3074.7462C772.1877,-3132.4315 837.3322,-3393.3006 855.7932,-3425.4819 873.3594,-3456.1035 885.4873,-3458.1996 911.1119,-3482.4819"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M757.8628,-3052.4676C769.4268,-3005.8718 815.629,-2820.3663 855.7932,-2668.4819 918.8235,-2430.1274 927.6605,-2368.4183 1002.4307,-2133.4819 1047.4641,-1991.9818 1084.5338,-1964.4728 1116.5955,-1819.4819 1136.5822,-1729.0968 1100.8924,-1481.2656 1152.5955,-1404.4819 1199.5421,-1334.762 1250.4972,-1364.1998 1321.0291,-1318.4819 1338.2697,-1307.3068 1340.0783,-1301.0921 1357.0291,-1289.4819 1371.1563,-1279.8056 1387.5763,-1270.1784 1401.4078,-1262.4942"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1403.4212,-1265.382 1410.5099,-1257.508 1400.0581,-1259.2428 1403.4212,-1265.382"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M756.7069,-3052.1785C764.3818,-2996.8022 798.3828,-2748.5717 819.7932,-2544.4819 839.4328,-2357.2725 809.9874,-2305.0604 855.7932,-2122.4819 886.0544,-2001.8632 924.95,-1982.7166 966.4307,-1865.4819 1048.8092,-1632.6595 1053.4637,-1569.243 1116.5955,-1330.4819 1133.5695,-1266.2871 1115.7958,-1240.7528 1152.5955,-1185.4819 1160.439,-1173.7015 1345.3013,-1041.4041 1357.0291,-1033.4819 1577.2786,-884.7019 1668.6288,-898.133 1867.2231,-721.4819 1906.9124,-686.1781 1897.402,-657.7751 1941.0359,-627.4819"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1115.3299,-4481.4874 1003.6963,-4481.4874 1003.6963,-4459.4765 1115.3299,-4459.4765 1115.3299,-4481.4874"/>
<text text-anchor="middle" x="1059.5131" y="-4467.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M758.7357,-3074.9448C769.7431,-3110.4352 803.1916,-3221.8155 819.7932,-3316.4819 848.3325,-3479.2194 820.0792,-3525.1671 855.7932,-3686.4819 887.7772,-3830.9488 932.6542,-3856.4236 966.4307,-4000.4819 996.4812,-4128.6488 973.9934,-4165.9475 1002.4307,-4294.4819 1015.1413,-4351.9332 1038.8875,-4417.2774 1051.3691,-4449.8051"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1048.1185,-4451.1033 1054.9974,-4459.1613 1054.6449,-4448.5723 1048.1185,-4451.1033"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-2757.4819C1255.1629,-2738.7687 1678.26,-2697.0856 1704.2205,-2693.4819 1712.8201,-2692.2882 1721.8368,-2691.0294 1730.7833,-2689.7761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1731.4116,-2693.2223 1740.8284,-2688.3671 1730.4392,-2686.2902 1731.4116,-2693.2223"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M767.1057,-3052.2777C780.5006,-3039.5162 802.5772,-3017.7958 819.7932,-2997.4819 864.2761,-2944.9946 860.0641,-2918.6097 911.1119,-2872.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2872.4819C938.512,-2847.7227 949.3876,-2843.2435 966.4307,-2810.4819 1008.1497,-2730.286 1106.014,-2095.9548 1152.5955,-2018.4819 1271.1713,-1821.2701 1352.7316,-1808.0737 1542.2007,-1677.4819 1609.3252,-1631.2163 1637.9108,-1638.908 1704.2205,-1591.4819 1724.4246,-1577.0315 1854.3175,-1459.7062 1867.2231,-1438.4819 1915.9303,-1358.3795 1933.5211,-1245.0171 1938.9354,-1198.5699"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1942.4285,-1198.8231 1940.0369,-1188.5018 1935.47,-1198.0618 1942.4285,-1198.8231"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M759.1597,-3052.2421C788.3305,-2970.8123 966.1453,-2474.4391 966.4307,-2473.4819 986.0173,-2407.7795 985.5944,-2389.9423 1002.4307,-2323.4819 1050.7769,-2132.6373 1083.3741,-2089.5319 1116.5955,-1895.4819 1125.2092,-1845.1681 1119.7248,-1476.5357 1152.5955,-1437.4819 1202.3468,-1378.3721 1249.5413,-1423.785 1321.0291,-1394.4819 1338.1683,-1387.4565 1339.3831,-1379.1149 1357.0291,-1373.4819 1413.6076,-1355.4208 1572.3982,-1380.2299 1623.2106,-1349.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1349.4819C1683.0904,-1311.4445 1748.9354,-1259.8718 1782.0905,-1233.1579"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1784.5976,-1235.6314 1790.1681,-1226.6192 1780.1933,-1230.1906 1784.5976,-1235.6314"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="961.2392,-1856.4874 860.9847,-1856.4874 860.9847,-1834.4765 961.2392,-1834.4765 961.2392,-1856.4874"/>
<text text-anchor="middle" x="911.1119" y="-1842.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M756.7948,-3052.1873C764.8821,-2996.8521 800.5171,-2748.7843 819.7932,-2544.4819 843.2205,-2296.182 801.0062,-2227.7926 855.7932,-1984.4819 865.7092,-1940.4446 887.6576,-1892.1359 900.7307,-1865.6522"/>
<polygon fill="#ff0000" stroke="#ff0000" points="903.9039,-1867.1324 905.263,-1856.625 897.6481,-1863.9915 903.9039,-1867.1324"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2872.4819C936.4969,-2849.5436 1026.2006,-2839.2822 1059.5131,-2831.4819"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-3520.4819C953.8515,-3593.9372 942.4195,-3628.3071 1002.4307,-3688.4819 1114.3373,-3800.6938 1295.6574,-3866.7599 1382.3686,-3893.5262"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1381.3772,-3896.883 1391.9631,-3896.4462 1383.4154,-3890.1862 1381.3772,-3896.883"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.4364,-3074.6927C779.4009,-3114.7087 843.3846,-3249.059 855.7932,-3266.4819 869.2682,-3285.4021 981.7365,-3404.9319 1002.4307,-3415.4819 1208.2405,-3520.4052 1346.4558,-3376.6043 1506.2007,-3543.4819 1587.2114,-3628.1098 1613.55,-3774.5575 1620.7979,-3829.1533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1617.3591,-3829.8629 1622.0675,-3839.354 1624.3055,-3828.9983 1617.3591,-3829.8629"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2516.4458,-3250.4819C2524.3616,-3250.4819 2533.1158,-3250.4819 2541.8879,-3250.4819"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2542.1447,-3253.982 2552.1446,-3250.4819 2542.1446,-3246.982 2542.1447,-3253.982"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1470.8442,-693.4738C1509.2918,-683.5039 1569.743,-670 1623.2106,-667.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-667.4819C1781.5183,-660.0263 1824.802,-678.7184 1978.8486,-641.4819 2046.3012,-625.1772 2059.0629,-608.4351 2122.5791,-580.4819 2225.5331,-535.1723 2287.1323,-384.1985 2352.8577,-475.4819"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2205.1461,-893.4819C2334.67,-1008.7029 2264.7446,-1105.189 2352.8577,-1254.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1623.2106,-667.4819C1761.9387,-667.904 2101.4941,-801.2759 2205.1461,-893.4819"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2068.7139,-1292.4819C2162.6911,-1343.9823 2193.6435,-1359.4158 2251.7131,-1449.4819 2322.163,-1558.7499 2344.8296,-1718.4391 2350.9121,-1775.3636"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2347.4317,-1775.7342 2351.9168,-1785.3329 2354.3964,-1775.0323 2347.4317,-1775.7342"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1496.9407,-714.2578C1590.7123,-731.5378 1763.5632,-775.9623 1867.2231,-879.4819 1951.8915,-964.0357 1939.368,-1011.5246 1978.8486,-1124.4819 2000.615,-1186.7573 1972.4351,-1217.9538 2014.8486,-1268.4819 2031.699,-1288.5561 2051.0566,-1273.1137 2068.7139,-1292.4819"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1506.2866,-2043.4874 1356.9431,-2043.4874 1356.9431,-2021.4765 1506.2866,-2021.4765 1506.2866,-2043.4874"/>
<text text-anchor="middle" x="1431.6149" y="-2029.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.1846,-2021.4243C1446.0956,-1970.972 1497.2608,-1763.0338 1542.2007,-1715.4819 1595.7232,-1658.8487 1634.394,-1683.0687 1704.2205,-1648.4819 1779.3596,-1611.2637 1803.7643,-1608.2913 1867.2231,-1553.4819 1950.5026,-1481.5535 2427.7867,-685.5415 2485.0961,-779.4819"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2205.1461,-1757.4819C2384.8309,-1609.1569 2230.8096,-1056.0097 2352.8577,-1254.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1443.7915,-2021.1967C1463.3938,-2003.4378 1503.662,-1968.6136 1542.2007,-1945.4819 1738.9827,-1827.3699 1790.2543,-1784.7153 2014.8486,-1737.4819 2061.7039,-1727.628 2075.0365,-1731.8059 2122.5791,-1737.4819 2160.0705,-1741.9579 2176.0276,-1781.5185 2205.1461,-1757.4819"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1438.0734,-2043.6907C1453.1333,-2070.4583 1490.4879,-2140.6405 1506.2007,-2204.4819 1532.2412,-2310.2852 1490.7624,-2597.427 1542.2007,-2693.4819 1553.0159,-2713.678 1573.4047,-2729.4801 1591.0211,-2740.2069"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1589.5063,-2743.374 1599.9152,-2745.3502 1593.0105,-2737.3142 1589.5063,-2743.374"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.2287,-2021.3168C1513.7965,-1987.3065 1710.0145,-1893.3528 1803.7218,-1995.4819"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1452.3761,-2043.6599C1474.2789,-2055.1585 1510.0135,-2073.0912 1542.2007,-2085.4819 1577.2449,-2098.9725 1601.0116,-2079.195 1623.2106,-2109.4819"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1440.8019,-3183.6309C1458.4174,-3204.3375 1499.0432,-3248.943 1542.2007,-3274.4819 1828.4441,-3443.8698 1938.8008,-3399.7283 2251.7131,-3512.4819 2264.7867,-3517.1928 2479.6679,-3615.2743 2485.0961,-3602.4819"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1481.432,-3165.3706C1552.6874,-3155.722 1687.9046,-3139.3518 1803.7218,-3136.4819"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1449.7613,-3161.3932C1466.6157,-3150.2253 1491.2904,-3131.5241 1506.2007,-3109.4819 1581.3198,-2998.432 1611.5618,-2835.2744 1620.3049,-2777.6124"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1623.795,-2777.9335 1621.7738,-2767.5333 1616.8682,-2776.924 1623.795,-2777.9335"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.556,-3161.407C1483.013,-3157.6175 1495.3377,-3152.9346 1506.2007,-3147.4819 1523.6103,-3138.7433 1524.8337,-3131.3049 1542.2007,-3122.4819 1584.0077,-3101.2427 1894.1431,-2984.4819 1941.0359,-2984.4819"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1623.2106,-3260.4819C1671.217,-3260.0404 1724.8972,-3247.086 1761.1453,-3236.4245"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1762.3218,-3239.7255 1770.8877,-3233.4905 1760.3032,-3233.0229 1762.3218,-3239.7255"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1468.8831,-3183.5913C1480.9542,-3187.5543 1494.2949,-3192.3263 1506.2007,-3197.4819 1560.4002,-3220.9525 1564.1499,-3261.0251 1623.2106,-3260.4819"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.7805,-3183.6842C1456.8665,-3261.84 1587.9048,-3725.5453 1617.3421,-3829.7152"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1613.9888,-3830.7194 1620.0763,-3839.3908 1620.725,-3828.8158 1613.9888,-3830.7194"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-3854.4874 -.2403,-3854.4874 -.2403,-3832.4765 130.719,-3832.4765 130.719,-3854.4874"/>
<text text-anchor="middle" x="65.2394" y="-3840.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-4928.4819C1136.48,-4911.5857 1158.0146,-4927.9185 1236.8123,-4928.4819"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4358.4819C264.2518,-4383.4383 271.2312,-4398.543 317.2024,-4410.4819 390.204,-4429.4407 587.0108,-4406.2089 654.4731,-4372.4819 818.2252,-4290.6161 873.0903,-4260.9758 966.4307,-4103.4819 1009.3085,-4031.1338 1046.5996,-3767.0505 1056.7766,-3689.8274"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1060.2572,-3690.2032 1058.0788,-3679.8347 1053.3158,-3689.2986 1060.2572,-3690.2032"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M223.8406,-1370.4819C366.9454,-1224.5659 947.7754,-1476.2853 1116.5955,-1591.4819 1134.7743,-1603.8865 1133.5262,-1614.4951 1152.5955,-1625.4819 1160.1807,-1629.8522 1168.5982,-1633.5195 1177.0935,-1636.5794"/>
<polygon fill="#ff5400" stroke="#ff5400" points="1176.084,-1639.9322 1186.6777,-1639.7811 1178.302,-1633.2929 1176.084,-1639.9322"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M399.0839,-1218.4819C404.9212,-1213.8622 490.9877,-1242.0779 544.1809,-1260.1538"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="543.1095,-1263.4863 553.704,-1263.4008 545.3685,-1256.8608 543.1095,-1263.4863"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-3328.4819C284.8791,-3280.1031 321.3034,-3332.5342 399.0839,-3328.4819"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-3328.4819C566.6353,-3319.7527 545.6246,-3173.1494 690.4731,-3088.4819 697.2677,-3084.5104 704.8099,-3080.9366 712.2745,-3077.8165"/>
<polygon fill="#ffff00" stroke="#ffff00" points="713.6185,-3081.0488 721.6261,-3074.1113 711.04,-3074.541 713.6185,-3081.0488"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M399.0839,-475.4819C464.3491,-387.4979 488.2799,-364.5451 585.7192,-314.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M223.8406,-1370.4819C361.0866,-1232.4322 192.3586,-648.8413 317.2024,-499.4819 341.5234,-470.385 376.4906,-505.9398 399.0839,-475.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M585.7192,-314.4819C660.3313,-276.1471 626.6763,-211.9473 690.4731,-157.4819 819.7133,-47.1456 890.3206,-73.3259 1059.5131,-57.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1059.5131,-57.4819C1174.81,-42.3653 1205.4677,-36.5407 1321.0291,-49.4819 1693.2198,-91.1621 1807.5881,-106.889 2122.5791,-309.4819 2186.9685,-350.8953 2203.9649,-363.6391 2251.7131,-423.4819 2272.5527,-449.6001 2262.7899,-467.2271 2287.7131,-489.4819 2334.3429,-531.1192 2382.4666,-491.0502 2418.0022,-542.4819 2458.523,-601.1289 2482.4841,-2979.0309 2484.8947,-3229.2432"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2481.3949,-3229.2901 2484.9906,-3239.2561 2488.3946,-3229.223 2481.3949,-3229.2901"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M65.4659,-3832.4744C69.0206,-3661.0877 113.9414,-1544.2428 166.4788,-1426.4819 180.9949,-1393.9444 198.7209,-1395.7487 223.8406,-1370.4819"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M585.7192,-314.4819C633.5941,-289.7719 641.7115,-352.5713 690.4731,-375.4819 960.6029,-502.4023 1068.3529,-447.6309 1321.0291,-606.4819 1339.9212,-618.3589 1340.4951,-626.4952 1357.0291,-641.4819 1374.5131,-657.3298 1395.039,-674.5727 1410.1274,-687.0063"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1407.9454,-689.7433 1417.8967,-693.3798 1412.3851,-684.3314 1407.9454,-689.7433"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-1370.4819C263.9002,-1329.0453 273.4035,-1423.0197 317.2024,-1460.4819 351.8915,-1490.1524 361.7603,-1496.2022 399.0839,-1522.4819"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-1522.4819C437.5045,-1549.5341 773.5179,-1557.3235 819.7932,-1565.4819 885.9872,-1577.1521 913.1705,-1561.4796 966.4307,-1602.4819 992.5982,-1622.627 981.514,-1641.9269 1002.4307,-1667.4819 1131.6519,-1825.359 1335.2125,-1968.2722 1406.1928,-2015.8008"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1404.2929,-2018.7406 1414.5565,-2021.3694 1408.1724,-2012.914 1404.2929,-2018.7406"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M223.8406,-4358.4819C283.0543,-4394.3743 434.5347,-4233.8505 480.9653,-4182.4819 503.3706,-4157.6939 492.8803,-4139.6413 516.9653,-4116.4819 579.0047,-4056.827 609.7726,-4060.3987 690.4731,-4030.4819 746.0918,-4009.8634 782.0423,-4043.2358 819.7932,-3997.4819 906.4963,-3892.3983 800.6889,-3510.0753 855.7932,-3385.4819 893.5029,-3300.2186 919.3621,-3277.8077 1002.4307,-3235.4819 1065.8443,-3203.1709 1269.572,-3184.2294 1371.8542,-3176.5287"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1372.3097,-3180.0046 1382.0236,-3175.7749 1371.7922,-3173.0237 1372.3097,-3180.0046"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1457.4874 180.0456,-1457.4874 180.0456,-1435.4765 267.6355,-1435.4765 267.6355,-1457.4874"/>
<text text-anchor="middle" x="223.8406" y="-1443.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M65.9818,-3832.2616C77.0081,-3665.6162 207.3709,-1695.3949 222.4259,-1467.8629"/>
<polygon fill="#00ffff" stroke="#00ffff" points="225.9374,-1467.803 223.1053,-1457.5937 218.9527,-1467.3408 225.9374,-1467.803"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M223.8406,-1370.4819C248.6047,-1344.8666 266.6179,-1393.975 281.2024,-1426.4819 316.7622,-1505.7403 256.5356,-2145.3054 317.2024,-2207.4819 400.7541,-2293.1129 466.08,-2226.4819 585.7192,-2226.4819 585.7192,-2226.4819 585.7192,-2226.4819 755.1332,-2226.4819 899.1278,-2226.4819 946.3115,-2248.4885 1059.5131,-2337.4819"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1059.5131,-2337.4819C1270.8126,-2492.1048 1524.2287,-2682.122 1600.4533,-2739.3762"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1598.3668,-2742.1864 1608.4642,-2745.3947 1602.5714,-2736.5898 1598.3668,-2742.1864"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-3949.4874 344.7839,-3949.4874 344.7839,-3927.4765 453.3838,-3927.4765 453.3838,-3949.4874"/>
<text text-anchor="middle" x="399.0839" y="-3935.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M223.8406,-3328.4819C430.1789,-3164.9391 144.314,-3714.9086 317.2024,-3913.4819 322.1678,-3919.185 328.3934,-3923.6086 335.1823,-3927.0362"/>
<polygon fill="#0054ff" stroke="#0054ff" points="334.153,-3930.4027 344.7236,-3931.1193 336.907,-3923.9672 334.153,-3930.4027"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1059.5131,-4928.4819C1469.0478,-4806.2588 1708.4013,-4977.413 1978.8486,-4646.4819 2104.7609,-4492.4102 2077.2715,-4416.2323 2122.5791,-4222.4819 2176.462,-3992.061 2198.484,-3704.5861 2203.8053,-3624.8449"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2207.3139,-3624.8249 2204.4711,-3614.6186 2200.3287,-3624.3701 2207.3139,-3624.8249"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-4783.4819C277.9081,-4832.4561 255.8652,-4878.9912 317.2024,-4918.4819 393.0546,-4967.3179 428.0391,-4939.2951 516.9653,-4954.4819 713.9864,-4988.1292 772.8531,-5019.2532 966.4307,-4969.4819 1010.212,-4958.2252 1016.1598,-4941.2888 1059.5131,-4928.4819"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-1152.4874 358.7923,-1152.4874 358.7923,-1130.4765 439.3754,-1130.4765 439.3754,-1152.4874"/>
<text text-anchor="middle" x="399.0839" y="-1138.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M223.8406,-1370.4819C291.7338,-1297.4565 242.1712,-1232.1517 317.2024,-1166.4819 326.1124,-1158.6836 337.4063,-1153.3178 348.7376,-1149.6257"/>
<polygon fill="#5400ff" stroke="#5400ff" points="349.9932,-1152.907 358.6459,-1146.793 348.0691,-1146.1767 349.9932,-1152.907"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-2198.4874 350.2841,-2198.4874 350.2841,-2176.4765 447.8836,-2176.4765 447.8836,-2198.4874"/>
<text text-anchor="middle" x="399.0839" y="-2184.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M223.8406,-1370.4819C248.1003,-1344.3884 266.0209,-1394.2495 281.2024,-1426.4819 322.3444,-1513.8321 301.458,-1764.22 317.2024,-1859.4819 336.6806,-1977.3351 376.9408,-2115.1098 392.628,-2166.6416"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="389.3087,-2167.7558 395.5861,-2176.2906 396.0012,-2165.7039 389.3087,-2167.7558"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-3339.4874 536.1602,-3339.4874 536.1602,-3317.4765 635.2783,-3317.4765 635.2783,-3339.4874"/>
<text text-anchor="middle" x="585.7192" y="-3325.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M399.0839,-3328.4819C441.3794,-3326.2784 489.1398,-3326.325 525.7579,-3326.8985"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="525.7174,-3330.3983 535.7768,-3327.0728 525.8393,-3323.3993 525.7174,-3330.3983"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M223.8406,-4358.4819C290.1083,-4399.4063 321.5904,-4366.2909 399.0839,-4358.4819"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M399.0839,-4358.4819C446.1952,-4353.7346 712.1895,-4234.8679 819.7932,-4030.4819 878.0926,-3919.7461 807.9521,-3584.1213 855.7932,-3468.4819 863.0508,-3450.9392 877.2728,-3434.9185 889.4786,-3423.4228"/>
<polygon fill="#ff0055" stroke="#ff0055" points="892.0225,-3425.8421 897.1149,-3416.5514 887.3402,-3420.6386 892.0225,-3425.8421"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-4065.4874 334.3841,-4065.4874 334.3841,-4043.4765 463.7837,-4043.4765 463.7837,-4065.4874"/>
<text text-anchor="middle" x="399.0839" y="-4051.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4358.4819C320.5978,-4421.1556 247.8532,-4208.5724 317.2024,-4116.4819 331.3604,-4097.6812 352.686,-4081.7856 370.0243,-4070.7974"/>
<polygon fill="#00ffff" stroke="#00ffff" points="371.9647,-4073.7134 378.6686,-4065.5092 368.3117,-4067.7421 371.9647,-4073.7134"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M66.7583,-3854.6567C76.505,-3924.4558 132.757,-4299.4833 223.8406,-4358.4819"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-4449.4874 539.0902,-4449.4874 539.0902,-4427.4765 632.3482,-4427.4765 632.3482,-4449.4874"/>
<text text-anchor="middle" x="585.7192" y="-4435.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4358.4819C272.2139,-4389.8153 263.7549,-4426.9151 317.2024,-4448.4819 389.2871,-4477.5692 481.2935,-4464.5544 536.7481,-4451.9223"/>
<polygon fill="#ff0000" stroke="#ff0000" points="537.7377,-4455.2849 546.6643,-4449.5783 536.1273,-4448.4726 537.7377,-4455.2849"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-4527.4874 517.2105,-4527.4874 517.2105,-4505.4765 654.2279,-4505.4765 654.2279,-4527.4874"/>
<text text-anchor="middle" x="585.7192" y="-4513.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4783.4819C309.2358,-4859.891 387.8668,-4831.2903 480.9653,-4764.4819 557.5886,-4709.4963 578.5024,-4587.1144 583.9241,-4537.7427"/>
<polygon fill="#00ffff" stroke="#00ffff" points="587.4259,-4537.8968 584.9281,-4527.6006 580.46,-4537.2072 587.4259,-4537.8968"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-4579.4874 168.8556,-4579.4874 168.8556,-4557.4765 278.8255,-4557.4765 278.8255,-4579.4874"/>
<text text-anchor="middle" x="223.8406" y="-4565.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.9825,-3854.7352C75.7718,-3910.9269 116.7725,-4166.604 166.4788,-4372.4819 182.0131,-4436.8235 205.3958,-4511.5565 216.9189,-4547.308"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.6791,-4548.6639 220.0925,-4557.0972 220.3379,-4546.5052 213.6791,-4548.6639"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-4560.4874 340.6161,-4560.4874 340.6161,-4538.4765 457.5516,-4538.4765 457.5516,-4560.4874"/>
<text text-anchor="middle" x="399.0839" y="-4546.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4358.4819C294.8846,-4404.5001 251.2458,-4471.4286 317.2024,-4524.4819 322.0667,-4528.3946 327.5388,-4531.6963 333.2885,-4534.4823"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.9355,-4537.7103 342.5045,-4538.4493 334.7031,-4531.2807 331.9355,-4537.7103"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-314.4819C653.6659,-279.5717 680.0165,-299.3731 755.1332,-285.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-285.4819C1059.0947,-229.271 1931.9717,-297.1281 2122.5791,-540.4819 2202.9296,-643.0676 2329.9287,-1616.6556 2350.1144,-1774.8182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2346.6927,-1775.6556 2351.4268,-1785.1339 2353.6367,-1774.7721 2346.6927,-1775.6556"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="801.757,-675.4874 708.5093,-675.4874 708.5093,-653.4765 801.757,-653.4765 801.757,-675.4874"/>
<text text-anchor="middle" x="755.1332" y="-661.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M223.8406,-1370.4819C383.1253,-1199.1565 198.4666,-1054.0405 317.2024,-852.4819 375.3641,-753.7503 411.1775,-733.5232 516.9653,-689.4819 575.374,-665.1654 648.5,-660.9243 698.2072,-661.4838"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="698.3828,-664.9875 708.445,-661.6706 698.5106,-657.9887 698.3828,-664.9875"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2120.9966,-1846.4874 2016.4312,-1846.4874 2016.4312,-1824.4765 2120.9966,-1824.4765 2120.9966,-1846.4874"/>
<text text-anchor="middle" x="2068.7139" y="-1832.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-1370.4819C284.4397,-1310.3993 887.3019,-1534.5318 966.4307,-1566.4819 1054.3126,-1601.9664 1063.4798,-1638.2207 1152.5955,-1670.4819 1318.2461,-1730.45 1368.8476,-1712.0973 1542.2007,-1743.4819 1709.7583,-1773.8174 1907.6373,-1807.9351 2006.2715,-1824.8255"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2005.9175,-1828.3157 2016.3646,-1826.553 2007.0985,-1821.416 2005.9175,-1828.3157"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-4358.4819C673.3932,-4324.1228 778.4905,-4306.2248 966.4307,-4103.4819 999.7673,-4067.5196 1100.5621,-3734.8236 1116.5955,-3688.4819 1133.2767,-3640.2678 1115.9754,-3615.0043 1152.5955,-3579.4819 1159.7386,-3572.5529 1168.7116,-3567.5319 1178.1175,-3563.8965"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1179.2525,-3567.2075 1187.6161,-3560.7036 1177.0221,-3560.5723 1179.2525,-3567.2075"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-4358.4819C300.027,-4403.6052 247.01,-4236.4588 317.2024,-4182.4819 376.4322,-4136.9351 430.545,-4199.6223 480.9653,-4144.4819 559.0938,-4059.0396 476.1489,-3994.8261 516.9653,-3886.4819 556.1646,-3782.4302 608.8158,-3778.8661 654.4731,-3677.4819 679.619,-3621.6446 665.5495,-3600.4188 690.4731,-3544.4819 733.5545,-3447.7934 771.867,-3438.8628 819.7932,-3344.4819 840.0485,-3304.5933 824.0904,-3282.0464 855.7932,-3250.4819 924.3863,-3182.1883 962.9695,-3166.5261 1059.5131,-3173.4819"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1059.5131,-3173.4819C1312.3253,-3192.1231 1369.712,-3260.482 1623.2106,-3260.4819"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M399.0839,-1218.4819C428.821,-1194.9481 456.3192,-1223.3039 480.9653,-1194.4819 561.6486,-1100.1285 427.9252,-1003.9932 516.9653,-917.4819 593.2691,-843.3453 648.7447,-893.4819 755.1332,-893.4819 755.1332,-893.4819 755.1332,-893.4819 911.1119,-893.4819 1150.8571,-893.4819 1362.2559,-1153.1733 1417.5611,-1227.0753"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1414.763,-1229.178 1423.5233,-1235.1368 1420.391,-1225.0155 1414.763,-1229.178"/>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M223.8406,-1370.4819C272.7824,-1319.8578 259.6038,-1282.9851 317.2024,-1242.4819 348.2233,-1220.6681 369.2635,-1241.9102 399.0839,-1218.4819"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.5131,-57.4819C1362.4922,-25.3782 1431.6893,-154.2697 1704.2205,-290.4819 1834.7616,-355.727 1865.6623,-378.3583 1978.8486,-470.4819 2006.4202,-492.9227 2034.8557,-522.7343 2052.1632,-541.7697"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2049.5731,-544.1238 2058.8645,-549.2151 2054.776,-539.4409 2049.5731,-544.1238"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="950.3499,-4558.4874 871.874,-4558.4874 871.874,-4536.4765 950.3499,-4536.4765 950.3499,-4558.4874"/>
<text text-anchor="middle" x="911.1119" y="-4544.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M223.8406,-4783.4819C268.9385,-4824.2649 265.6659,-4715.7475 317.2024,-4683.4819 403.5184,-4629.4419 653.7096,-4539.315 755.1332,-4548.4819"/>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M65.3276,-3854.4881C66.342,-3950.8131 78.689,-4650.0639 223.8406,-4783.4819"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1308.6498,-637.4874 1164.9747,-637.4874 1164.9747,-615.4765 1308.6498,-615.4765 1308.6498,-637.4874"/>
<text text-anchor="middle" x="1236.8123" y="-623.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-475.4819C500.1204,-350.1472 961.4333,-532.5646 1116.5955,-575.4819 1148.0916,-584.1937 1182.2316,-599.2634 1206.0533,-610.7695"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1204.7588,-614.033 1215.278,-615.2965 1207.8427,-607.7489 1204.7588,-614.033"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M755.1332,-4852.4819C831.4924,-4841.711 849.5043,-4822.8633 911.1119,-4776.4819"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-4783.4819C311.4945,-4864.0502 637.2437,-4869.111 755.1332,-4852.4819"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2112.598,-1768.4874 2024.8298,-1768.4874 2024.8298,-1746.4765 2112.598,-1746.4765 2112.598,-1768.4874"/>
<text text-anchor="middle" x="2068.7139" y="-1754.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1941.0359,-1691.4819C1975.5691,-1707.3447 2014.2015,-1727.6922 2039.8339,-1741.5743"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2038.2009,-1744.6703 2048.6575,-1746.376 2041.5468,-1738.5217 2038.2009,-1744.6703"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-1370.4819C305.4276,-1287.6686 364.8863,-1316.1452 480.9653,-1322.4819 829.3422,-1341.4996 909.4829,-1413.7195 1236.8123,-1534.4819"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1236.8123,-1534.4819C1290.4785,-1541.8086 1303.0489,-1518.9415 1357.0291,-1514.4819 1423.1025,-1509.0233 1440.3892,-1506.4604 1506.2007,-1514.4819 1675.1909,-1535.0796 1719.3725,-1558.0891 1867.2231,-1642.4819 1901.4205,-1662.0017 1905.2542,-1675.0456 1941.0359,-1691.4819"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-2147.4819C1557.486,-2141.3581 1617.9582,-2133.6132 1704.2205,-2225.4819 1764.7537,-2289.9494 1794.5727,-2576.8486 1801.8964,-2658.0207"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1798.4171,-2658.4103 1802.7814,-2668.0645 1805.3901,-2657.7959 1798.4171,-2658.4103"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1370.4819C248.6192,-1344.8806 263.7219,-1395.4362 281.2024,-1426.4819 315.9009,-1488.1073 271.915,-1527.1613 317.2024,-1581.4819 368.0014,-1642.4135 408.6974,-1619.7628 480.9653,-1652.4819 497.0845,-1659.7798 500.5838,-1662.7937 516.9653,-1669.4819 541.4359,-1679.4728 949.1996,-1805.439 966.4307,-1825.4819 1023.5996,-1891.98 943.8481,-1954.2258 1002.4307,-2019.4819 1023.5779,-2043.0383 1307.7481,-2141.3724 1431.6149,-2147.4819"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459.7908,-2693.4874 338.377,-2693.4874 338.377,-2671.4765 459.7908,-2671.4765 459.7908,-2693.4874"/>
<text text-anchor="middle" x="399.0839" y="-2679.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M66.9874,-3832.0822C77.9004,-3762.4993 138.976,-3395.7452 223.8406,-3328.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-3328.4819C326.7617,-3246.9071 384.5508,-2805.7951 396.6721,-2703.6202"/>
<polygon fill="#00ffff" stroke="#00ffff" points="400.1592,-2703.9337 397.8428,-2693.5952 393.2065,-2703.1217 400.1592,-2703.9337"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-285.4819C784.3335,-277.7157 791.4838,-295.9204 819.7932,-306.4819 1046.4136,-391.0286 1129.7471,-370.4408 1321.0291,-518.4819 1341.8375,-534.5864 1338.4373,-546.8623 1357.0291,-565.4819 1559.0784,-767.8339 1701.1461,-724.6973 1867.2231,-957.4819 1890.8295,-990.5701 1923.0805,-1108.1784 1935.6824,-1156.5104"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1932.3656,-1157.6648 1938.2562,-1166.4711 1939.143,-1155.9134 1932.3656,-1157.6648"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1370.4819C431.4702,-1154.2535 113.6487,-922.5516 317.2024,-702.4819 378.9335,-635.7421 427.0563,-671.9468 516.9653,-658.4819 693.8068,-631.9979 1158.9959,-613.8541 1321.0291,-689.4819 1324.4339,-691.0711 1701.8119,-1068.5979 1704.2205,-1071.4819 1739.0459,-1113.1822 1773.7598,-1166.8728 1791.5317,-1195.4661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1788.657,-1197.4726 1796.8849,-1204.1473 1794.6153,-1193.7984 1788.657,-1197.4726"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1489.018,-1545.4874 1374.2118,-1545.4874 1374.2118,-1523.4765 1489.018,-1523.4765 1489.018,-1545.4874"/>
<text text-anchor="middle" x="1431.6149" y="-1531.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-1534.4819C1277.1526,-1549.3648 1325.4715,-1549.4649 1363.8942,-1545.7948"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1364.3701,-1549.2641 1373.945,-1544.7284 1363.6315,-1542.3031 1364.3701,-1549.2641"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1309.3977,-867.4874 1164.2268,-867.4874 1164.2268,-845.4765 1309.3977,-845.4765 1309.3977,-867.4874"/>
<text text-anchor="middle" x="1236.8123" y="-853.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1370.4819C282.6745,-1309.6256 250.9495,-1257.1648 317.2024,-1204.4819 346.8848,-1180.8791 378.0389,-1212.0295 399.0839,-1180.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1180.4819C419.8157,-1149.4037 455.9164,-1189.1987 480.9653,-1161.4819 565.6832,-1067.7412 426.4443,-967.6317 516.9653,-879.4819 593.185,-805.2589 648.7447,-855.4819 755.1332,-855.4819 755.1332,-855.4819 755.1332,-855.4819 911.1119,-855.4819 993.6357,-855.4819 1087.9205,-855.8069 1153.7364,-856.0864"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1154.0339,-859.5876 1164.0489,-856.1308 1154.0641,-852.5877 1154.0339,-859.5876"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1845.4819C786.2668,-1851.6198 821.5805,-1852.1385 850.7239,-1850.8962"/>
<polygon fill="#ff0000" stroke="#ff0000" points="850.9471,-1854.3895 860.7579,-1850.3897 850.5942,-1847.3984 850.9471,-1854.3895"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1522.4819C430.6968,-1542.389 453.9462,-1515.682 480.9653,-1541.4819 523.7058,-1582.2937 483.3888,-1620.851 516.9653,-1669.4819 591.7468,-1777.7925 626.0002,-1820.0238 755.1332,-1845.4819"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-4714.4874 323.0941,-4714.4874 323.0941,-4692.4765 475.0737,-4692.4765 475.0737,-4714.4874"/>
<text text-anchor="middle" x="399.0839" y="-4700.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4783.4819C260.4204,-4816.2124 272.1329,-4743.927 317.2024,-4724.4819 323.2682,-4721.8648 329.7326,-4719.5188 336.2678,-4717.4294"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.2845,-4720.7786 345.8552,-4714.5502 335.271,-4714.0744 337.2845,-4720.7786"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-4755.4874 317.3208,-4755.4874 317.3208,-4733.4765 480.847,-4733.4765 480.847,-4755.4874"/>
<text text-anchor="middle" x="399.0839" y="-4741.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4783.4819C233.5378,-4792.1587 305.1544,-4772.9198 353.7809,-4758.4931"/>
<polygon fill="#00ffff" stroke="#00ffff" points="354.8998,-4761.8117 363.4759,-4755.5906 352.8921,-4755.1058 354.8998,-4761.8117"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1370.4819C248.6529,-1344.9133 264.8229,-1394.8414 281.2024,-1426.4819 327.9616,-1516.8073 273.0103,-1560.8733 317.2024,-1652.4819 364.0516,-1749.5988 408.3222,-1751.7981 480.9653,-1831.4819 558.2295,-1916.2347 582.5859,-1933.123 654.4731,-2022.4819 821.8976,-2230.5977 823.5895,-2314.0911 1002.4307,-2512.4819 1072.4829,-2590.1918 1170.2302,-2667.8907 1214.0191,-2701.3697"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1211.9544,-2704.1966 1222.0333,-2707.4628 1216.1911,-2698.6243 1211.9544,-2704.1966"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-1572.4874 353.1239,-1572.4874 353.1239,-1550.4765 445.0438,-1550.4765 445.0438,-1572.4874"/>
<text text-anchor="middle" x="399.0839" y="-1558.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1370.4819C248.1003,-1344.3884 262.3721,-1396.2358 281.2024,-1426.4819 308.3894,-1470.151 280.4673,-1500.4728 317.2024,-1536.4819 324.4467,-1543.5831 333.6481,-1548.6748 343.2483,-1552.3237"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.3305,-1555.7064 352.9236,-1555.5128 344.5219,-1549.0582 342.3305,-1555.7064"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-4700.4819C1107.3536,-4655.6405 1105.2368,-4465.832 1152.5955,-4420.4819 1208.8158,-4366.646 1267.216,-4428.7242 1321.0291,-4372.4819 1384.0376,-4306.629 1420.3378,-4011.4115 1429.3722,-3928.9421"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1432.8775,-3929.0801 1430.466,-3918.7633 1425.9175,-3928.3321 1432.8775,-3929.0801"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-4852.4819C848.759,-4839.5567 888.0151,-4881.2442 966.4307,-4828.4819 994.1527,-4809.829 982.9692,-4789.6425 1002.4307,-4762.4819 1024.2467,-4732.0352 1032.185,-4726.0968 1059.5131,-4700.4819"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-4700.4819C1088.7602,-4674.0821 1200.0324,-4714.6096 1236.8123,-4700.4819"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.3078,-4909.4874 341.8599,-4909.4874 341.8599,-4887.4765 456.3078,-4887.4765 456.3078,-4909.4874"/>
<text text-anchor="middle" x="399.0839" y="-4895.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4783.4819C266.7917,-4821.9132 267.5243,-4844.2613 317.2024,-4873.4819 324.2157,-4877.6071 331.9736,-4881.1112 339.8372,-4884.0713"/>
<polygon fill="#00ffff" stroke="#00ffff" points="338.8435,-4887.4314 349.4384,-4887.4172 341.1471,-4880.8213 338.8435,-4887.4314"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1461,-209.4819C2301.78,-304.0772 2269.1751,-369.2577 2352.8577,-475.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2352.8577,-475.4819C2371.1838,-498.7446 2396.8984,-468.7063 2418.0022,-489.4819 2512.2779,-582.2917 2417.0485,-666.0312 2485.0961,-779.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.9508,-1435.3641C252.7488,-1424.2251 272.3083,-1405.7172 281.2024,-1384.4819 347.3784,-1226.4827 237.6786,-766.202 317.2024,-614.4819 359.71,-533.3834 421.3442,-558.9743 480.9653,-489.4819 502.7222,-464.1229 494.6138,-448.3185 516.9653,-423.4819 566.6553,-368.2676 603.0429,-382.0789 654.4731,-328.4819 675.2186,-306.8624 669.8064,-293.1767 690.4731,-271.4819 752.3836,-206.4917 775.4332,-195.4683 855.7932,-155.4819 910.3055,-128.3571 1062.0174,-98.4743 1116.5955,-71.4819 1134.0564,-62.8464 1134.3084,-53.1931 1152.5955,-46.4819 1269.5559,-3.5589 1307.0765,-15.9685 1431.6149,-19.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-19.4819C1784.3802,10.1863 1952.1686,38.1588 2205.1461,-209.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2485.0961,-779.4819C2551.8267,-890.7371 2594.8095,-2994.0466 2599.4124,-3229.1673"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2595.9187,-3229.5293 2599.6127,-3239.4593 2602.9174,-3229.393 2595.9187,-3229.5293"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1501,-1457.5711C229.17,-1637.0148 293.8801,-3934.3652 317.2024,-3958.4819 400.3716,-4044.4844 466.826,-3990.8214 585.7192,-3977.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3977.4819C675.1859,-3966.4722 898.063,-3896.2302 966.4307,-3837.4819 1014.0892,-3796.529 1041.8838,-3724.8463 1053.3349,-3689.4616"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1056.737,-3690.308 1056.3679,-3679.7196 1050.0534,-3688.2272 1056.737,-3690.308"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M226.0477,-1457.8149C232.904,-1489.522 257.0942,-1579.1193 317.2024,-1614.4819 461.4173,-1699.3259 524.2545,-1584.6609 690.4731,-1565.4819 747.5699,-1558.8939 762.6079,-1559.7133 819.7932,-1565.4819 953.8211,-1579.0022 1108.4526,-1616.3754 1186.3651,-1636.7699"/>
<polygon fill="#ff5400" stroke="#ff5400" points="1185.8249,-1640.247 1196.3866,-1639.4105 1187.6085,-1633.478 1185.8249,-1640.247"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M267.6291,-1452.9375C321.6193,-1458.6487 414.3908,-1460.9512 480.9653,-1422.4819 487.6522,-1418.618 545.6573,-1333.6886 572.3627,-1294.2645"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="575.4351,-1295.9692 578.1395,-1285.7254 569.6372,-1292.0469 575.4351,-1295.9692"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-2910.4819C606.7931,-2933.4679 628.2604,-2907.5895 654.4731,-2924.4819 700.151,-2953.9184 731.8351,-3011.9628 746.2804,-3042.9118"/>
<polygon fill="#ffff00" stroke="#ffff00" points="743.2088,-3044.6144 750.5137,-3052.2884 749.5888,-3041.734 743.2088,-3044.6144"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1236.8123,-703.4819C1373.243,-726.2834 1406.4677,-736.8399 1542.2007,-763.4819 1615.8587,-777.9397 2149.7406,-842.8386 2205.1461,-893.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M911.1119,-703.4819C1055.7829,-698.5307 1093.5938,-682.4415 1236.8123,-703.4819"/>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M1236.8123,-703.4819C1275.8407,-710.0047 1319.8846,-710.7741 1356.2074,-709.6867"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1356.3662,-713.1834 1366.2369,-709.334 1356.1201,-706.1877 1356.3662,-713.1834"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-2032.4819C1272.6145,-2034.5099 1312.1775,-2034.858 1346.244,-2034.5698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1346.6669,-2038.0657 1356.6297,-2034.4611 1346.5936,-2031.0661 1346.6669,-2038.0657"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M585.7192,-2910.4819C606.7931,-2933.4679 624.2963,-2916.6191 654.4731,-2924.4819 655.6444,-2924.7871 1222.4776,-3105.7225 1387.2151,-3158.3088"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1386.434,-3161.7334 1397.0248,-3161.4402 1388.5628,-3155.0649 1386.434,-3161.7334"/>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M399.0839,-2378.4819C529.4055,-2592.4978 426.4955,-2717.0025 585.7192,-2910.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M399.0839,-2378.4819C426.5241,-2423.5446 464.3913,-2368.9068 516.9653,-2364.4819 757.5455,-2344.2335 865.6549,-2193.5798 1059.5131,-2337.4819"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M224.5163,-1457.6912C229.7305,-1542.6095 264.7631,-2085.5067 317.2024,-2240.4819 340.061,-2308.0365 364.1822,-2316.2886 399.0839,-2378.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M224.1729,-1457.6313C229.4904,-1635.7024 297.1115,-3887.3881 317.2024,-3913.4819 322.0479,-3919.7752 328.4383,-3924.5305 335.5175,-3928.1157"/>
<polygon fill="#0054ff" stroke="#0054ff" points="334.2162,-3931.3656 344.7884,-3932.0588 336.956,-3924.924 334.2162,-3931.3656"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.1912,-1457.6185C227.7716,-1571.3866 258.0398,-2534.5033 281.2024,-3314.4819 283.2728,-3384.2021 284.0271,-4508.1257 317.2024,-4569.4819 359.382,-4647.4911 423.6636,-4615.7984 480.9653,-4683.4819 505.1155,-4712.0075 492.0327,-4731.6377 516.9653,-4759.4819 577.4024,-4826.9768 603.3104,-4841.7667 690.4731,-4866.4819 808.5628,-4899.9665 845.6379,-4877.2874 966.4307,-4855.4819 1051.2108,-4840.1774 1069.0541,-4822.5232 1152.5955,-4801.4819 1163.4556,-4798.7466 1932.802,-4640.0732 1941.0359,-4632.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1941.0359,-4632.4819C2010.7298,-4550.6088 2172.5907,-3764.1266 2200.8875,-3624.5929"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2204.3351,-3625.2025 2202.8881,-3614.7069 2197.4741,-3623.814 2204.3351,-3625.2025"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M238.1456,-1435.3301C251.5547,-1424.0324 271.0181,-1405.2929 281.2024,-1384.4819 324.3678,-1296.2765 252.5193,-1240.3707 317.2024,-1166.4819 325.3864,-1157.1332 336.9564,-1151.2242 348.8285,-1147.5054"/>
<polygon fill="#5400ff" stroke="#5400ff" points="350.0304,-1150.808 358.8043,-1144.8693 348.242,-1144.0403 350.0304,-1150.808"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-1845.4819C572.9982,-1945.626 645.682,-1909.6806 819.7932,-2009.4819 891.8879,-2050.8069 914.363,-2060.7181 966.4307,-2125.4819 989.3472,-2153.9865 972.001,-2179.1912 1002.4307,-2199.4819 1057.0988,-2235.9351 1239.5869,-2234.071 1348.2125,-2229.3533"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1348.6555,-2232.837 1358.4873,-2228.889 1348.3394,-2225.8441 1348.6555,-2232.837"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M224.2214,-1457.5859C228.024,-1566.5597 260.2256,-2446.3542 317.2024,-2702.4819 371.4138,-2946.1786 401.5408,-3006.1131 516.9653,-3227.4819 532.6138,-3257.4935 555.4655,-3289.3309 570.4617,-3309.0588"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="567.8715,-3311.4318 576.745,-3317.2207 573.4183,-3307.1617 567.8715,-3311.4318"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M223.9197,-1457.8791C225.0783,-1616.9795 239.7139,-3389.4972 317.2024,-3463.4819 346.2104,-3491.1783 640.903,-3508.0517 819.7932,-3458.4819 845.3661,-3451.3958 871.2184,-3435.3756 888.8564,-3422.7916"/>
<polygon fill="#ff0055" stroke="#ff0055" points="891.3054,-3425.3351 897.2862,-3416.5898 887.1571,-3419.6966 891.3054,-3425.3351"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1652,-1457.4965C229.6407,-1643.0594 302.7293,-4111.4266 317.2024,-4144.4819 358.265,-4238.2652 412.6298,-4230.2475 480.9653,-4306.4819 515.203,-4344.6772 551.6789,-4392.4696 571.2678,-4418.7979"/>
<polygon fill="#ff0000" stroke="#ff0000" points="568.6982,-4421.2093 577.4611,-4427.1644 574.3245,-4417.0445 568.6982,-4421.2093"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.1857,-1457.6511C230.2488,-1653.8311 314.2036,-4368.6083 317.2024,-4372.4819 340.4171,-4402.4688 383.106,-4362.0894 399.0839,-4396.4819"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-4396.4819C418.3163,-4437.8798 445.9063,-4429.2495 480.9653,-4458.4819 497.6358,-4472.3819 498.4087,-4480.2231 516.9653,-4491.4819 523.3109,-4495.3319 530.342,-4498.727 537.4151,-4501.6741"/>
<polygon fill="#00ffff" stroke="#00ffff" points="536.4373,-4505.0492 547.0258,-4505.4159 538.9771,-4498.5262 536.4373,-4505.0492"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.1866,-1457.7742C230.266,-1656.1186 314.4414,-4400.949 317.2024,-4410.4819 330.724,-4457.1675 363.5404,-4504.4328 383.2787,-4530.0383"/>
<polygon fill="#00ffff" stroke="#00ffff" points="380.7291,-4532.4584 389.6618,-4538.1556 386.2316,-4528.1314 380.7291,-4532.4584"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2378.4819C921.5168,-2468.609 1006.689,-2496.9114 1321.0291,-2645.4819 1424.3201,-2694.3017 1432.0128,-2746.2984 1542.2007,-2776.4819 1653.4092,-2806.9451 2024.9044,-2794.5056 2068.7139,-2756.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M238.2724,-1435.391C251.7755,-1424.1385 271.3065,-1405.4316 281.2024,-1384.4819 331.5928,-1277.8057 276.9182,-1232.3702 317.2024,-1121.4819 374.1928,-964.6071 425.2735,-942.946 516.9653,-803.4819 546.5955,-758.4141 531.8721,-706.5707 585.7192,-703.4819"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M585.7192,-703.4819C604.397,-691.9376 656.5713,-680.9174 698.1316,-673.5549"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="698.9176,-676.9709 708.1706,-671.8101 697.7189,-670.0742 698.9176,-676.9709"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M224.2388,-1457.5804C226.9336,-1513.5035 247.4187,-1764.9011 399.0839,-1845.4819"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-1845.4819C503.6156,-1901.0204 477.1112,-1702.5533 585.7192,-1655.4819"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-1655.4819C744.4452,-1586.6892 823.7193,-1638.7076 966.4307,-1736.4819 1113.4204,-1837.1875 1058.9189,-2022.4054 1236.8123,-2032.4819"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1236.8123,-2032.4819C1271.1676,-2040.5157 1507.9445,-1953.9284 1542.2007,-1945.4819 1708.7477,-1904.4169 1907.3709,-1865.6481 2006.2879,-1847.0234"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2006.9392,-1850.4624 2016.1212,-1845.1765 2005.647,-1843.5827 2006.9392,-1850.4624"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M224.1573,-1457.4973C229.2277,-1633.4255 293.7906,-3857.951 317.2024,-3880.4819 369.6452,-3930.9517 412.933,-3906.3478 480.9653,-3880.4819 500.9752,-3872.8742 498.8133,-3859.8299 516.9653,-3848.4819 714.8358,-3724.7811 783.7115,-3729.8242 1002.4307,-3648.4819 1027.4921,-3639.1615 1033.8301,-3636.9201 1059.5131,-3629.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.9586,-1457.6527C225.6206,-1610.0662 245.3741,-3272.0179 317.2024,-3342.4819 457.0908,-3479.7133 1301.4502,-3263.4414 1623.2106,-3260.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M234.2263,-1435.2455C258.0492,-1409.4862 314.7743,-1348.2415 317.2024,-1346.4819 382.1745,-1299.3968 426.3145,-1329.2328 480.9653,-1270.4819 511.7183,-1237.4218 481.9782,-1204.0234 516.9653,-1175.4819 790.3042,-952.5003 1275.2923,-1168.4897 1401.1174,-1230.7938"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1399.7005,-1233.9984 1410.2101,-1235.3399 1402.8309,-1227.7373 1399.7005,-1233.9984"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.8518,-1435.322C252.5779,-1424.1526 272.0874,-1405.6233 281.2024,-1384.4819 375.0281,-1166.8614 236.7921,-1075.4083 317.2024,-852.4819 368.704,-709.7008 421.5135,-693.498 516.9653,-575.4819 574.2529,-504.652 603.875,-499.2353 654.4731,-423.4819 675.2326,-392.4017 658.8903,-367.4685 690.4731,-347.4819 881.5835,-226.5413 1479.9924,-407.9596 1704.2205,-437.4819 1776.8206,-447.0406 1797.2983,-439.7412 1867.2231,-461.4819 1933.2706,-482.0171 2004.5724,-521.655 2042.1058,-544.0436"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2040.5254,-547.1776 2050.8968,-549.3418 2044.1387,-541.1822 2040.5254,-547.1776"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M755.1332,-4548.4819C790.6317,-4551.6904 830.8597,-4551.3353 861.57,-4550.2328"/>
<polygon fill="#007fff" stroke="#007fff" points="861.7462,-4553.7287 871.5993,-4549.8344 861.4682,-4546.7342 861.7462,-4553.7287"/>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M224.1786,-1457.6681C229.9557,-1648.723 307.9656,-4223.238 317.2024,-4239.4819 359.9396,-4314.6401 428.4168,-4275.8243 480.9653,-4344.4819 513.2586,-4386.675 478.7197,-4421.5985 516.9653,-4458.4819 562.6051,-4502.4961 595.4329,-4473.3631 654.4731,-4496.4819 701.3612,-4514.8423 704.9829,-4543.9492 755.1332,-4548.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-703.4819C616.4737,-684.4733 875.2408,-708.0016 911.1119,-703.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M911.1119,-703.4819C1013.3856,-691.9254 1130.0658,-659.4949 1192.2477,-640.611"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1193.5775,-643.8643 1202.1141,-637.5891 1191.5275,-637.1712 1193.5775,-643.8643"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-4130.4819C420.6749,-4160.4303 451.5491,-4122.1714 480.9653,-4144.4819 510.7447,-4167.0679 491.3984,-4193.2189 516.9653,-4220.4819 653.0292,-4365.5722 721.0348,-4373.8712 911.1119,-4432.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M227.4591,-1457.5882C237.0007,-1484.7899 265.7167,-1554.4895 317.2024,-1581.4819 381.6641,-1615.2774 409.4297,-1594.9021 480.9653,-1581.4819 497.8383,-1578.3165 500.2526,-1571.4064 516.9653,-1567.4819 727.8754,-1517.9564 786.0051,-1533.2697 1002.4307,-1523.4819 1053.1188,-1521.1896 1068.1745,-1508.318 1116.5955,-1523.4819 1135.1849,-1529.3035 1135.3496,-1539.4245 1152.5955,-1548.4819 1238.5523,-1593.6263 1262.6382,-1602.7452 1357.0291,-1625.4819 1610.9764,-1686.6525 1697.8376,-1596.1629 1941.0359,-1691.4819"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1321.2464,-1468.4874 1152.3781,-1468.4874 1152.3781,-1446.4765 1321.2464,-1446.4765 1321.2464,-1468.4874"/>
<text text-anchor="middle" x="1236.8123" y="-1454.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M264.5236,-1435.444C329.1307,-1417.1561 450.9653,-1379.3277 480.9653,-1346.4819 519.9546,-1303.7941 473.609,-1259.7266 516.9653,-1221.4819 567.3297,-1177.0555 1063.3395,-1104.5665 1116.5955,-1145.4819 1165.8374,-1183.3135 1131.1655,-1222.2002 1152.5955,-1280.4819 1174.2008,-1339.2406 1208.2455,-1404.9555 1225.6934,-1437.2842"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1222.6905,-1439.0884 1230.5433,-1446.2007 1228.8398,-1435.7437 1222.6905,-1439.0884"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1655.4819C614.4762,-1643.4196 627.2063,-1654.3497 654.4731,-1669.4819 674.815,-1680.771 670.7081,-1695.2109 690.4731,-1707.4819 799.5032,-1775.173 880.3491,-1697.2999 966.4307,-1792.4819 1020.862,-1852.6676 953.1252,-1907.0299 1002.4307,-1971.4819 1047.7579,-2030.7337 1080.4661,-2027.4375 1152.5955,-2046.4819 1177.9101,-2053.1658 1604.1465,-2053.5357 1623.2106,-2071.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.2017,-1457.8332C226.8722,-1536.869 245.4906,-2013.0191 317.2024,-2392.4819 336.6248,-2495.2557 375.6507,-2614.3766 391.815,-2661.6294"/>
<polygon fill="#00ffff" stroke="#00ffff" points="388.5882,-2663.0084 395.1562,-2671.3217 395.206,-2660.727 388.5882,-2663.0084"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1256.4819C422.741,-1226.8428 454.404,-1259.5492 480.9653,-1232.4819 523.5565,-1189.0795 470.7235,-1139.9721 516.9653,-1100.4819 684.5157,-957.3952 1286.8563,-1012.6261 1506.2007,-1033.4819 1595.4129,-1041.9645 1618.748,-1044.5518 1704.2205,-1071.4819 1781.8701,-1095.9473 1867.9174,-1138.7027 1911.8003,-1161.7275"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1910.2824,-1164.884 1920.7591,-1166.4622 1913.5533,-1158.6952 1910.2824,-1164.884"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1256.4819C422.359,-1226.5419 456.0284,-1261.0527 480.9653,-1232.4819 551.6019,-1151.5521 445.1048,-1073.3269 516.9653,-993.4819 590.1369,-912.1803 645.753,-931.4819 755.1332,-931.4819 755.1332,-931.4819 755.1332,-931.4819 911.1119,-931.4819 1148.1218,-931.4819 1216.1803,-948.681 1431.6149,-1047.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M237.0186,-1435.4239C249.9571,-1423.917 269.4179,-1404.7703 281.2024,-1384.4819 307.8894,-1338.5372 277.1563,-1305.4022 317.2024,-1270.4819 345.0287,-1246.2173 376.0523,-1285.3372 399.0839,-1256.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M237.7402,-1435.4679C251.0414,-1424.1362 270.6018,-1405.2487 281.2024,-1384.4819 318.2946,-1311.8172 262.0986,-1264.6448 317.2024,-1204.4819 342.8162,-1176.5164 378.0389,-1212.0295 399.0839,-1180.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1845.4819C537.1116,-1922.8741 600.3935,-1812.3633 755.1332,-1845.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2011,-1457.6182C227.8798,-1571.3834 258.9331,-2534.4773 281.2024,-3314.4819 283.3657,-3390.2552 271.301,-4618.155 317.2024,-4678.4819 319.6634,-4681.7163 322.5328,-4684.545 325.6953,-4687.0177"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.7989,-4689.9594 334.0945,-4692.4594 327.6051,-4684.0846 323.7989,-4689.9594"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.2047,-1457.6181C227.9196,-1571.3823 259.2617,-2534.4679 281.2024,-3314.4819 282.3032,-3353.6181 292.8088,-4692.8583 317.2024,-4723.4819 318.1739,-4724.7016 319.2058,-4725.8561 320.2915,-4726.9489"/>
<polygon fill="#00ffff" stroke="#00ffff" points="318.1844,-4729.746 328.1654,-4733.2998 322.579,-4724.2974 318.1844,-4729.746"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2378.4819C442.2253,-2449.3294 505.4636,-2357.5157 585.7192,-2378.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2378.4819C670.126,-2400.5326 621.4527,-2491.1254 690.4731,-2544.4819 768.5902,-2604.8706 1053.7105,-2676.1526 1178.1067,-2705.1824"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1177.3195,-2708.5926 1187.8522,-2707.4469 1178.9038,-2701.7743 1177.3195,-2708.5926"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M232.3807,-1457.6165C247.4705,-1476.5443 280.72,-1515.023 317.2024,-1536.4819 325.1995,-1541.1858 334.165,-1545.0822 343.1511,-1548.2851"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.2721,-1551.6807 352.8653,-1551.4939 344.4677,-1545.0339 342.2721,-1551.6807"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1628,-1457.4937C229.5261,-1640.5053 300.2597,-4043.7052 317.2024,-4074.4819 338.4645,-4113.105 374.6305,-4093.7961 399.0839,-4130.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4130.4819C409.3225,-4145.8423 463.2312,-4139.3566 480.9653,-4144.4819 561.1733,-4167.6626 579.163,-4180.4398 654.4731,-4216.4819 771.6723,-4272.5714 782.5701,-4337.5436 911.1119,-4356.4819"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-3454.4874 334.8633,-3454.4874 334.8633,-3432.4765 463.3044,-3432.4765 463.3044,-3454.4874"/>
<text text-anchor="middle" x="399.0839" y="-3440.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1121,-1457.7559C227.8502,-1611.5932 269.6621,-3289.5242 317.2024,-3380.4819 327.8149,-3400.7866 348.2224,-3416.5134 366.0081,-3427.1756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="364.5806,-3430.39 375.0042,-3432.2871 368.0387,-3424.3038 364.5806,-3430.39"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-3871.4874 354.6193,-3871.4874 354.6193,-3849.4765 443.5485,-3849.4765 443.5485,-3871.4874"/>
<text text-anchor="middle" x="399.0839" y="-3857.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.0288,-1457.8038C226.4852,-1602.7221 253.201,-3097.3577 317.2024,-3534.4819 334.4081,-3651.9955 376.0092,-3788.7064 392.3415,-3839.8164"/>
<polygon fill="#00ff00" stroke="#00ff00" points="389.0267,-3840.9413 395.4252,-3849.3857 395.6893,-3838.7942 389.0267,-3840.9413"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-3988.4874 690.3127,-3988.4874 690.3127,-3966.4765 819.9536,-3966.4765 819.9536,-3988.4874"/>
<text text-anchor="middle" x="755.1332" y="-3974.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-3977.4819C616.4408,-3974.0351 650.4939,-3973.4186 679.9639,-3973.8894"/>
<polygon fill="#0000ff" stroke="#0000ff" points="680.1142,-3977.3931 690.1837,-3974.0984 680.2574,-3970.3946 680.1142,-3977.3931"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-4700.4819C1326.1697,-4682.7597 1465.3494,-4472.9067 1506.2007,-4391.4819 1599.4488,-4205.6197 1618.6587,-3947.4253 1622.3709,-3871.9787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1625.874,-3871.9864 1622.8279,-3861.8389 1618.8811,-3871.6711 1625.874,-3871.9864"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4396.4819C442.1573,-4489.1977 603.6071,-4698.5762 690.4731,-4752.4819 795.669,-4817.7625 865.5804,-4862.2937 966.4307,-4790.4819 1006.2748,-4762.1104 962.5866,-4714.8534 1002.4307,-4686.4819 1087.4373,-4625.9519 1138.6822,-4735.9855 1236.8123,-4700.4819"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.2078,-1457.618C227.9537,-1571.3813 259.5432,-2534.4601 281.2024,-3314.4819 285.6757,-3475.5806 271.6333,-4609.8978 317.2024,-4764.4819 330.5113,-4809.6298 363.1095,-4854.8268 382.9269,-4879.4732"/>
<polygon fill="#00ffff" stroke="#00ffff" points="380.3012,-4881.7909 389.351,-4887.3001 385.712,-4877.3498 380.3012,-4881.7909"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1682.6376,-2760.2989C1690.5874,-2762.9624 1698.0953,-2766.8588 1704.2205,-2772.4819 1746.809,-2811.5797 1712.158,-2846.9357 1740.2205,-2897.4819 1781.1586,-2971.2199 1813.7368,-2973.2713 1867.2231,-3038.4819 1875.9246,-3049.0908 2004.6851,-3227.2642 2014.8486,-3236.4819 2105.9366,-3319.0938 2150.8424,-3309.1482 2251.7131,-3379.4819 2329.3428,-3433.6104 2352.2313,-3444.4346 2418.0022,-3512.4819 2452.6759,-3548.3558 2464.7719,-3648.0465 2485.0961,-3602.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2485.0961,-3602.4819C2536.8794,-3480.4466 2579.6917,-3326.569 2594.3759,-3271.3699"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2597.7643,-3272.2465 2596.932,-3261.6844 2590.9961,-3270.4602 2597.7643,-3272.2465"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1639.114,-2767.6617C1741.9558,-2839.9056 2310.081,-3238.1934 2352.8577,-3250.4819"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1655.3908,-2745.463C1691.1662,-2734.2159 1750.8796,-2718.4087 1803.7218,-2718.4819"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1624.6996,-2767.4957C1631.5593,-2815.6243 1663.1352,-3011.2773 1740.2205,-3150.4819 1751.5975,-3171.0271 1769.6885,-3190.7684 1783.6558,-3204.3665"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1781.257,-3206.9153 1790.9223,-3211.255 1786.0729,-3201.8351 1781.257,-3206.9153"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.861,-2745.3945C1680.6968,-2741.7187 1693.2053,-2737.0969 1704.2205,-2731.4819 1722.039,-2722.399 1722.7585,-2714.2329 1740.2205,-2704.4819 1746.7634,-2700.8283 1753.9496,-2697.4539 1761.0617,-2694.4439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1762.6849,-2697.5631 1770.6468,-2690.5732 1760.0638,-2691.0724 1762.6849,-2697.5631"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1646.6438,-2745.423C1665.8416,-2734.9739 1691.7932,-2717.3428 1704.2205,-2693.4819 1740.8106,-2623.2272 1734.9477,-2060.5184 1740.2205,-1981.4819 1759.9404,-1685.8906 1793.2138,-1326.9086 1801.7031,-1236.7801"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1805.1976,-1237.002 1802.6533,-1226.7172 1798.2286,-1236.3439 1805.1976,-1237.002"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-4928.4819C1549.8879,-4939.5754 1629.4993,-4865.5516 1941.0359,-4898.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M413.1385,-3949.7389C432.3697,-3966.0832 466.1809,-3998.4014 480.9653,-4034.4819 565.7782,-4241.4634 448.2871,-4323.602 516.9653,-4536.4819 552.7158,-4647.2967 605.0297,-4654.0621 654.4731,-4759.4819 675.779,-4804.9087 651.4334,-4834.9632 690.4731,-4866.4819 838.7621,-4986.2033 927.2482,-4892.7923 1116.5955,-4914.4819 1170.0368,-4920.6036 1183.0603,-4926.4393 1236.8123,-4928.4819"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.2278,-3927.4467C457.191,-3923.7704 469.8334,-3919.1354 480.9653,-3913.4819 498.7975,-3904.4257 498.6733,-3894.5691 516.9653,-3886.4819 702.9825,-3804.241 795.5111,-3910.72 966.4307,-3800.4819 1009.0119,-3773.0183 1037.8567,-3718.5607 1051.1421,-3688.8987"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1054.4382,-3690.094 1055.1894,-3679.5258 1048.0118,-3687.3189 1054.4382,-3690.094"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M424.3773,-3927.3139C443.1049,-3917.6759 467.5985,-3901.9152 480.9653,-3880.4819 533.8594,-3795.6684 488.4662,-3754.2886 516.9653,-3658.4819 559.9395,-3514.0142 598.7756,-3488.5373 654.4731,-3348.4819 693.2412,-3250.9969 732.8494,-3131.9536 748.3406,-3084.4811"/>
<polygon fill="#ffff00" stroke="#ffff00" points="751.7461,-3085.3265 751.5099,-3074.7343 745.0891,-3083.1619 751.7461,-3085.3265"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M425.2663,-3927.412C444.2052,-3917.9129 468.5626,-3902.287 480.9653,-3880.4819 530.5648,-3793.2816 483.8445,-3525.1762 516.9653,-3430.4819 528.2048,-3398.3477 552.106,-3366.6827 568.5421,-3347.3626"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="571.347,-3349.4715 575.2832,-3339.6349 566.072,-3344.8699 571.347,-3349.4715"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M426.0475,-3927.425C445.1256,-3918.0155 469.3088,-3902.4979 480.9653,-3880.4819 529.274,-3789.2399 478.8234,-2118.4195 516.9653,-2022.4819 559.3351,-1915.91 610.4784,-1913.6624 690.4731,-1831.4819 746.015,-1774.4225 763.494,-1763.7942 819.7932,-1707.4819 886.3866,-1640.8731 904.298,-1625.2699 966.4307,-1554.4819 1036.7452,-1474.3724 1062.3004,-1459.2083 1116.5955,-1367.4819 1137.911,-1331.4714 1119.8369,-1306.5201 1152.5955,-1280.4819 1182.2987,-1256.8723 1203.9243,-1285.405 1236.8123,-1266.4819"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-4356.4819C937.4538,-4361.4177 944.4774,-4347.8543 966.4307,-4332.4819 985.4876,-4319.1377 982.3165,-4306.1719 1002.4307,-4294.4819 1025.0153,-4281.3562 1033.6486,-4284.1401 1059.5131,-4280.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M423.0114,-3949.5721C507.6812,-3988.9762 789.6461,-4121.6237 819.7932,-4154.4819 886.4019,-4227.0806 814.2717,-4338.3368 911.1119,-4356.4819"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2352.8577,-3849.4819C2381.7734,-3838.7144 2396.8565,-3847.9524 2418.0022,-3825.4819 2488.932,-3750.1084 2442.9339,-3697.0048 2485.0961,-3602.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2206.4537,-3614.7947C2213.1617,-3667.9481 2247.5844,-3888.6829 2352.8577,-3849.4819"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2251.8165,-3600.4133C2283.1079,-3596.2817 2323.7577,-3586.6832 2352.8577,-3564.4819"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2206.4612,-3592.1989C2212.3022,-3541.8514 2236.2861,-3332.6324 2251.7131,-3160.4819 2300.5773,-2615.2069 2343.4633,-1945.7736 2351.5066,-1818.0724"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2355.0232,-1817.9164 2352.1571,-1807.7166 2348.037,-1817.4775 2355.0232,-1817.9164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-361.4819C779.7877,-330.2198 798.3142,-333.0054 819.7932,-299.4819 846.1809,-258.2972 820.5791,-229.4298 855.7932,-195.4819 867.8344,-183.8737 1414.9669,-17.8733 1431.6149,-19.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.4721,-1130.011C417.5026,-1053.0872 509.0461,-614.9715 516.9653,-603.4819 558.4169,-543.3425 611.8425,-572.7915 654.4731,-513.4819 691.4685,-462.0123 644.7222,-419.3525 690.4731,-375.4819 711.6963,-355.1311 736.215,-383.9915 755.1332,-361.4819"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1803.7218,-247.4819C1925.4446,-261.4561 1961.3902,-264.3774 2068.7139,-323.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2068.7139,-323.4819C2089.8546,-333.9973 2198.6303,-430.4451 2205.1461,-437.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2205.1461,-437.4819C2455.9976,-708.3932 2371.2156,-874.2438 2418.0022,-1240.4819 2470.7372,-1653.2827 2483.4373,-3040.1423 2484.9358,-3229.094"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2481.4362,-3229.1832 2485.0138,-3239.1557 2488.436,-3229.1288 2481.4362,-3229.1832"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M755.1332,-361.4819C779.6447,-330.1075 795.6073,-331.108 819.7932,-299.4819 840.0907,-272.9404 829.4485,-254.0343 855.7932,-233.4819 908.8758,-192.0706 935.6461,-203.9947 1002.4307,-195.4819 1356.4448,-150.3571 1453.7657,-177.5321 1803.7218,-247.4819"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M423.3316,-1152.5904C442.8037,-1162.9677 468.8297,-1180.47 480.9653,-1204.4819 524.0766,-1289.783 507.9232,-2829.3341 516.9653,-2924.4819 531.0033,-3072.2003 567.8007,-3247.3692 580.9571,-3307.2201"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="577.6137,-3308.3106 583.1938,-3317.3168 584.4481,-3306.7965 577.6137,-3308.3106"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-817.4819C616.4744,-798.4743 875.324,-822.619 911.1119,-817.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-817.4819C952.0483,-812.1405 961.322,-804.2758 1002.4307,-800.4819 1143.4308,-787.4693 1189.0621,-749.1489 1321.0291,-800.4819 1341.2577,-808.3505 1337.8053,-823.4044 1357.0291,-833.4819 1392.0691,-851.8508 1665.8539,-902.8264 1704.2205,-912.4819 1777.1035,-930.8241 1808.1073,-911.0741 1867.2231,-957.4819 1947.2941,-1020.3402 1938.1464,-1064.1768 1978.8486,-1157.4819 1999.5855,-1205.0189 1980.1611,-1229.9261 2014.8486,-1268.4819 2032.3779,-1287.9661 2049.5901,-1274.5602 2068.7139,-1292.4819"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M423.2872,-1130.372C446.6846,-1120.2856 483.4218,-1106.1488 516.9653,-1100.4819 720.9494,-1066.0208 808.5481,-1087.8026 966.4307,-1221.4819 1066.2235,-1305.9766 1070.6975,-1352.0428 1116.5955,-1474.4819 1147.684,-1557.4147 1090.3395,-1607.4855 1152.5955,-1670.4819 1206.2156,-1724.7398 1260.8107,-1656.6547 1321.0291,-1703.4819 1350.5338,-1726.4255 1333.5184,-1750.4271 1357.0291,-1779.4819 1409.5174,-1844.3478 1444.5227,-1837.2821 1506.2007,-1893.4819 1523.637,-1909.3696 1524.8008,-1916.5543 1542.2007,-1932.4819 1609.2867,-1993.8916 1657.7612,-1979.2948 1704.2205,-2057.4819 1766.8936,-2162.9559 1796.1419,-2561.3694 1802.4112,-2658.1842"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1798.9366,-2658.6973 1803.0625,-2668.4558 1805.9225,-2658.2543 1798.9366,-2658.6973"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-971.4819C1838.4981,-990.0951 1846.7556,-999.7638 1867.2231,-1033.4819 1895.8956,-1080.7167 1870.2158,-1108.1677 1903.2231,-1152.4819 1905.2446,-1155.1958 1907.6538,-1157.7034 1910.2634,-1159.9973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1908.4193,-1162.9908 1918.5065,-1166.231 1912.6416,-1157.4076 1908.4193,-1162.9908"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-817.4819C633.521,-782.3045 788.4663,-801.5107 1002.4307,-800.4819 1144.0283,-799.8011 1200.3689,-726.3774 1321.0291,-800.4819 1351.1773,-818.9977 1329.0982,-849.7651 1357.0291,-871.4819 1377.1052,-887.0916 1781.3007,-959.4816 1803.7218,-971.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M407.4409,-1130.3258C424.0151,-1107.6573 461.1539,-1054.0642 480.9653,-1003.4819 508.8138,-932.3794 464.1969,-890.678 516.9653,-835.4819 538.7931,-812.65 558.8496,-834.0882 585.7192,-817.4819"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1085.4819C1683.0331,-1121.5225 1748.4144,-1171.5157 1781.649,-1197.7645"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1779.7536,-1200.7287 1789.7617,-1204.2057 1784.1063,-1195.2465 1779.7536,-1200.7287"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-817.4819C1001.5871,-806.0822 1244.7257,-786.547 1321.0291,-836.4819 1351.2985,-856.2911 1333.1113,-882.3418 1357.0291,-909.4819 1450.7986,-1015.8848 1501.7287,-1012.2942 1623.2106,-1085.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.7998,-2176.3238C416.3743,-2134.9592 463.4026,-1986.2194 480.9653,-1859.4819 498.8181,-1730.6515 452.1906,-802.2659 516.9653,-689.4819 552.8649,-626.9747 612.3725,-661.9923 654.4731,-603.4819 694.5161,-547.8312 644.5252,-504.3664 690.4731,-453.4819 788.6108,-344.8005 863.2594,-393.0235 1002.4307,-347.4819 1345.8817,-235.093 1445.1583,-164.5138 1803.7218,-209.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-209.4819C1982.1119,-206.7649 2069.0033,-94.1756 2205.1461,-209.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.1075,-2198.5039C422.8706,-2225.5029 465.0072,-2297.6285 480.9653,-2364.4819 533.5225,-2584.6597 431.3854,-3172.9191 516.9653,-3382.4819 560.1996,-3488.3513 592.5423,-3513.4306 690.4731,-3572.4819 785.5578,-3629.8171 914.4544,-3653.2313 992.0458,-3662.5617"/>
<polygon fill="#ff0000" stroke="#ff0000" points="991.8427,-3666.0615 1002.1789,-3663.735 992.6479,-3659.1079 991.8427,-3666.0615"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M405.6619,-2198.6226C421.4359,-2225.8852 461.5421,-2298.5518 480.9653,-2364.4819 513.4348,-2474.6959 481.2044,-2511.2916 516.9653,-2620.4819 546.6167,-2711.0177 698.7525,-2969.0603 743.03,-3043.2836"/>
<polygon fill="#ffff00" stroke="#ffff00" points="740.1868,-3045.3488 748.3208,-3052.1376 746.1957,-3041.7581 740.1868,-3045.3488"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M402.7566,-2176.3177C416.1804,-2134.9318 462.7493,-1986.1271 480.9653,-1859.4819 494.8344,-1763.0588 480.0889,-1073.6479 516.9653,-983.4819 551.4501,-899.1638 616.9609,-914.4974 654.4731,-831.4819 712.6797,-702.6695 605.5264,-628.4628 690.4731,-515.4819 701.7564,-500.4749 984.4003,-390.7193 1002.4307,-385.4819 1349.4591,-284.6793 1444.2924,-210.0597 1803.7218,-247.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M585.7192,-1235.4819C617.7713,-1183.1346 638.8081,-1178.6227 690.4731,-1145.4819 758.5408,-1101.8196 781.6946,-1101.87 855.7932,-1069.4819 907.0731,-1047.0678 1282.9521,-917.4961 1321.0291,-876.4819 1355.7407,-839.0926 1328.4666,-809.7554 1357.0291,-767.4819 1369.5996,-748.8771 1389.1319,-732.6577 1405.0552,-721.3366"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1407.198,-724.1111 1413.4631,-715.5671 1403.2374,-718.3393 1407.198,-724.1111"/>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M402.6798,-2176.3063C415.8354,-2134.8805 461.5874,-1985.9546 480.9653,-1859.4819 491.1642,-1792.9176 474.6057,-1306.8316 516.9653,-1254.4819 536.9073,-1229.8369 567.2995,-1261.2845 585.7192,-1235.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M426.7492,-2198.4883C568.5611,-2255.5027 1211.5642,-2521.4231 1321.0291,-2698.4819 1373.8222,-2783.8745 1334.6844,-2823.6059 1357.0291,-2921.4819 1376.8033,-3008.0985 1409.8554,-3108.7524 1424.3871,-3151.5286"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1421.1169,-3152.7827 1427.6632,-3161.1131 1427.7406,-3150.5186 1421.1169,-3152.7827"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M585.7192,-2036.4819C749.0954,-1946.7194 804.6604,-2119.8566 966.4307,-2212.4819 983.3354,-2222.1611 984.7034,-2229.4071 1002.4307,-2237.4819 1065.081,-2266.0193 1084.3752,-2266.2383 1152.5955,-2275.4819 1160.2776,-2276.5228 1427.5704,-2274.8683 1431.6149,-2281.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M406.1207,-2198.5008C422.9132,-2225.4928 465.1099,-2297.604 480.9653,-2364.4819 509.5596,-2485.0921 460.5275,-3369.1224 516.9653,-3479.4819 651.4245,-3742.4058 1509.8188,-3840.278 1803.7218,-3811.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1236.8123,-2185.4819C1289.4824,-2185.5495 1348.6317,-2199.4137 1387.789,-2210.5908"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1386.9627,-2213.9956 1397.5428,-2213.4377 1388.924,-2207.2759 1386.9627,-2213.9956"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M406.0802,-2198.5105C422.7829,-2225.524 464.7953,-2297.6794 480.9653,-2364.4819 526.1229,-2551.0389 456.6436,-3045.2623 516.9653,-3227.4819 527.5338,-3259.4073 551.3811,-3290.5262 568.007,-3309.5935"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="565.568,-3312.1164 574.8471,-3317.2301 570.7823,-3307.4461 565.568,-3312.1164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M405.9837,-2198.5344C422.4721,-2225.6011 464.0446,-2297.8656 480.9653,-2364.4819 511.665,-2485.3453 471.5597,-2808.3408 516.9653,-2924.4819 560.3936,-3035.5653 822.462,-3313.2031 893.4112,-3387.1474"/>
<polygon fill="#ff0055" stroke="#ff0055" points="890.9318,-3389.6185 900.3858,-3394.4011 895.9777,-3384.7668 890.9318,-3389.6185"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M406.4378,-2198.8873C423.5402,-2226.1537 465.6904,-2297.8164 480.9653,-2364.4819 506.951,-2477.8935 467.027,-4353.3934 516.9653,-4458.4819 525.1803,-4475.7692 541.2884,-4489.7978 555.8489,-4499.7255"/>
<polygon fill="#00ffff" stroke="#00ffff" points="554.3257,-4502.9071 564.6304,-4505.3695 558.1104,-4497.0184 554.3257,-4502.9071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2068.7139,-2756.4819C2394.1772,-2474.0021 1843.5134,-2030.8811 2205.1461,-1796.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1693.4819C857.6138,-1628.6882 1721.7508,-1906.1439 1803.7218,-1995.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-1995.4819C2037.8499,-2223.8755 1687.1696,-2512.2502 1941.0359,-2718.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-2718.4819C1986.9893,-2755.8128 2024.0007,-2795.2898 2068.7139,-2756.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M402.6926,-2176.3082C415.893,-2134.8893 461.7814,-1985.9841 480.9653,-1859.4819 502.2566,-1719.0839 464.2821,-1353.3509 516.9653,-1221.4819 552.0027,-1133.7815 616.5839,-1145.9886 654.4731,-1059.4819 707.2878,-938.8984 645.8718,-889.3387 690.4731,-765.4819 701.6676,-734.3953 723.8307,-703.0378 739.0616,-683.6912"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="741.9585,-685.6743 745.5075,-675.6915 736.5078,-681.2823 741.9585,-685.6743"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M406.1022,-2198.5052C422.8538,-2225.507 464.9664,-2297.6382 480.9653,-2364.4819 506.4323,-2470.8831 447.9602,-3263.5816 516.9653,-3348.4819 556.6725,-3397.3356 597.6371,-3355.408 654.4731,-3382.4819 844.829,-3473.1582 853.6054,-3674.8643 1059.5131,-3629.4819"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1059.5131,-3629.4819C1104.6201,-3616.4183 1109.1745,-3597.3683 1152.5955,-3579.4819 1162.4272,-3575.4319 1173.15,-3571.7337 1183.5494,-3568.4959"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1184.8145,-3571.7703 1193.3812,-3565.5364 1182.7967,-3565.0674 1184.8145,-3571.7703"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-2606.4819C604.094,-2631.6778 628.0836,-2603.8669 654.4731,-2620.4819 685.8401,-2640.2307 825.8818,-2864.5912 855.7932,-2886.4819 1008.1779,-2998.005 1579.781,-3160.9409 1753.3982,-3208.7933"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1752.4832,-3212.1716 1763.0534,-3211.4488 1754.3396,-3205.4222 1752.4832,-3212.1716"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M1236.8123,-1266.4819C1277.5047,-1242.6271 1331.3075,-1238.7546 1372.0578,-1240.2119"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1371.9666,-1243.7114 1382.1209,-1240.6883 1372.2977,-1236.7192 1371.9666,-1243.7114"/>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M400.853,-2176.2317C408.1548,-2132.7234 439.2981,-1972.7821 516.9653,-1869.4819 596.0617,-1764.2811 631.0319,-1737.3261 755.1332,-1693.4819"/>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M755.1332,-1693.4819C976.5615,-1567.5164 927.1824,-1399.1697 1152.5955,-1280.4819 1186.1692,-1262.8042 1204.0788,-1285.671 1236.8123,-1266.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1941.0359,-551.4819C1961.5294,-555.6378 1984.2083,-557.9545 2004.697,-559.2225"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2004.6967,-562.7277 2014.873,-559.7793 2005.0791,-555.7381 2004.6967,-562.7277"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M402.7403,-2176.3153C416.1071,-2134.9212 462.5025,-1986.0914 480.9653,-1859.4819 493.8049,-1771.4343 470.0462,-1135.085 516.9653,-1059.4819 553.786,-1000.1509 615.8652,-1041.6658 654.4731,-983.4819 738.2453,-857.2335 608.3245,-771.7927 690.4731,-644.4819 777.6257,-509.4162 847.3098,-503.6225 1002.4307,-461.4819 1303.428,-379.7122 1394.3568,-425.8413 1704.2205,-461.4819 1778.1214,-469.982 1799.3421,-469.0555 1867.2231,-499.4819 1903.8418,-515.8956 1901.7074,-543.5065 1941.0359,-551.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M406.1644,-2198.4905C423.0538,-2225.4598 465.4496,-2297.5244 480.9653,-2364.4819 521.7847,-2540.6364 441.9861,-3826.9379 516.9653,-3991.4819 551.2126,-4066.6387 598.0781,-4056.1412 654.4731,-4116.4819 778.0133,-4248.6657 731.4626,-4411.0154 911.1119,-4432.4819"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M911.1119,-4432.4819C940.6504,-4441.5902 973.9565,-4450.2607 1001.5206,-4457.0135"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1000.8549,-4460.4535 1011.3984,-4459.4119 1002.5066,-4453.6512 1000.8549,-4460.4535"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-2185.4819C1325.023,-2185.5951 1343.5083,-2151.7685 1431.6149,-2147.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1922.4819C783.302,-1909.9986 792.8731,-1932.4944 819.7932,-1947.4819 1006.2465,-2051.288 1023.4102,-2185.2081 1236.8123,-2185.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1235.4819C645.7507,-1151.3893 1683.9179,-907.1462 1803.7218,-971.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.2461,-2176.2282C413.8875,-2134.5299 455.0258,-1984.7735 480.9653,-1859.4819 500.8741,-1763.3201 464.8862,-1724.7359 516.9653,-1641.4819 616.5163,-1482.3394 1049.729,-1184.1008 1236.8123,-1199.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2036.4819C665.2595,-1992.7807 672.1608,-1959.252 755.1332,-1922.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.8333,-2176.3901C436.9309,-2149.0011 511.2009,-2077.424 585.7192,-2036.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1922.4819C801.1698,-1902.0803 810.4656,-1892.4136 855.7932,-1870.4819 862.5112,-1867.2314 869.7453,-1863.8664 876.6959,-1860.6988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="878.2505,-1863.8371 885.9233,-1856.5311 875.3691,-1857.4577 878.2505,-1863.8371"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.3534,-2198.6208C417.505,-2226.4744 452.7443,-2301.44 480.9653,-2364.4819 528.8513,-2471.4526 513.6642,-2514.049 585.7192,-2606.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2606.4819C604.8916,-2631.0764 623.9344,-2614.1693 654.4731,-2620.4819 809.2163,-2652.4686 846.348,-2668.8489 1002.4307,-2693.4819 1054.1026,-2701.6368 1112.6122,-2707.8811 1158.2465,-2712.0896"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1158.0954,-2715.5901 1168.3711,-2713.0094 1158.7288,-2708.6189 1158.0954,-2715.5901"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.1457,-2198.4949C422.9937,-2225.4738 465.3043,-2297.5582 480.9653,-2364.4819 515.4091,-2511.6695 442.3672,-3593.0069 516.9653,-3724.4819 595.6092,-3863.0873 727.1153,-3786.8398 819.7932,-3916.4819 859.6645,-3972.2558 809.6782,-4015.7488 855.7932,-4066.4819 890.7641,-4104.955 919.8253,-4081.4368 966.4307,-4104.4819 1010.988,-4126.5144 1017.9009,-4139.2935 1059.5131,-4166.4819"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.1389,-2198.4965C422.972,-2225.4789 465.2519,-2297.5705 480.9653,-2364.4819 513.5945,-2503.4248 442.7365,-3526.5809 516.9653,-3648.4819 553.2822,-3708.1227 594.2622,-3689.1185 654.4731,-3724.4819 729.12,-3768.3239 767.6087,-3758.4092 819.7932,-3827.4819 854.6436,-3873.6108 809.601,-3917.7156 855.7932,-3952.4819 895.081,-3982.0517 917.4545,-3956.8684 966.4307,-3952.4819 1175.6853,-3933.7405 1223.1814,-3894.8299 1431.6149,-3868.4819"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-2679.4819C1651.1972,-2713.4649 1674.6699,-2703.8498 1704.2205,-2736.4819 1715.9981,-2749.4877 2005.7334,-3271.4894 2014.8486,-3286.4819 2060.3468,-3361.3165 2076.1008,-3377.2522 2122.5791,-3451.4819 2139.0829,-3477.8398 2135.9202,-3490.1821 2158.5791,-3511.4819 2213.4621,-3563.0731 2456.0009,-3671.9605 2485.0961,-3602.4819"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2352.8577,-3250.4819C2382.6174,-3258.044 2417.3759,-3257.7045 2443.787,-3255.6557"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2444.181,-3259.1346 2453.8322,-3254.7639 2443.5619,-3252.162 2444.181,-3259.1346"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1623.2106,-2679.4819C1680.8385,-2747.6856 1906.3663,-2814.3377 1978.8486,-2866.4819 2115.0777,-2964.486 2137.5783,-3004.4518 2251.7131,-3127.4819 2299.8483,-3179.3686 2284.2617,-3233.0514 2352.8577,-3250.4819"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1465.0231,-2235.5192C1480.1559,-2242.297 1496.7416,-2252.5959 1506.2007,-2267.4819 1608.1049,-2427.8523 1451.5966,-2526.4669 1542.2007,-2693.4819 1553.125,-2713.6192 1573.5133,-2729.4216 1591.1021,-2740.1632"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1589.574,-2743.3231 1599.9798,-2745.3153 1593.0876,-2737.2687 1589.574,-2743.3231"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-2718.4819C1864.7502,-2718.5665 1893.6677,-2680.0017 1941.0359,-2718.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-2679.4819C1676.184,-2742.1769 1721.6436,-2718.3683 1803.7218,-2718.4819"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.9379,-2235.5015C1477.2362,-2242.4911 1494.8959,-2252.984 1506.2007,-2267.4819 1623.2502,-2417.5937 1500.3567,-2534.0823 1623.2106,-2679.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-2679.4819C1636.9086,-2695.6938 1686.6447,-2694.7503 1730.4487,-2690.2668"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1730.9972,-2693.7278 1740.5572,-2689.161 1730.2359,-2686.7693 1730.9972,-2693.7278"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1439.8636,-2213.2782C1477.028,-2162.2235 1630.3052,-1945.3857 1704.2205,-1743.4819 1773.3176,-1554.7391 1796.5889,-1309.6647 1802.2254,-1236.7996"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1805.7312,-1236.851 1802.9829,-1226.6188 1798.7504,-1236.3315 1805.7312,-1236.851"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-4898.4819C2127.1498,-4896.6864 2206.8685,-4937.9323 2352.8577,-4822.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.9297,-3339.5416C597.2882,-3385.475 635.7003,-3565.3379 690.4731,-3705.4819 736.2982,-3822.7317 786.0735,-3836.1954 819.7932,-3957.4819 851.2354,-4070.5766 785.9483,-4390.1384 855.7932,-4484.4819 856.9931,-4486.1027 1939.041,-4898.1871 1941.0359,-4898.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3330.4819C793.891,-3339.5923 799.7572,-3358.0766 819.7932,-3392.4819 852.558,-3448.7446 819.5734,-3480.3789 855.7932,-3534.4819 867.0869,-3551.3518 984.8737,-3633.2889 1002.4307,-3643.4819 1008.4027,-3646.9491 1014.9452,-3650.2414 1021.4025,-3653.2306"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1020.1666,-3656.5115 1030.7259,-3657.3782 1023.0118,-3650.1158 1020.1666,-3656.5115"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M635.3044,-3317.767C642.5925,-3314.2705 649.3553,-3309.6329 654.4731,-3303.4819 716.441,-3229.0047 629.26,-3163.5806 690.4731,-3088.4819 696.1085,-3081.5682 703.8999,-3076.5623 712.1268,-3072.939"/>
<polygon fill="#ffff00" stroke="#ffff00" points="713.3825,-3076.2061 721.5085,-3069.4077 710.9165,-3069.6549 713.3825,-3076.2061"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1803.7218,-3136.4819C1927.4487,-3131.6471 1954.4866,-3174.6924 2068.7139,-3222.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2068.7139,-3222.4819C2098.6787,-3230.2294 2174.1964,-3250.3118 2205.1461,-3250.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M596.1833,-3317.393C629.7908,-3282.6925 739.591,-3176.3055 855.7932,-3139.4819 1257.4138,-3012.2116 1398.25,-3022.0729 1803.7218,-3136.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2205.1461,-3250.4819C2270.7947,-3250.8428 2288.3268,-3238.4139 2352.8577,-3250.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M603.5052,-3317.3271C619.5709,-3306.24 642.4779,-3287.7076 654.4731,-3265.4819 701.9466,-3177.5195 622.5672,-3116.8297 690.4731,-3043.4819 834.0451,-2888.4044 944.0217,-2965.5246 1152.5955,-2931.4819 1214.016,-2921.4571 1376.3014,-2936.002 1431.6149,-2907.4819"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1431.6149,-2907.4819C1501.77,-2869.772 1572.2481,-2805.9775 1604.7143,-2774.7736"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1607.389,-2777.0551 1612.1261,-2767.5783 1602.5131,-2772.0325 1607.389,-2777.0551"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M602.3867,-3339.5008C616.666,-3349.1958 637.5447,-3363.987 654.4731,-3378.4819 733.565,-3446.2041 750.8465,-3466.4552 819.7932,-3544.4819 836.9835,-3563.9362 835.8504,-3573.8609 855.7932,-3590.4819 898.4422,-3626.0271 922.5849,-3614.4239 966.4307,-3648.4819 985.3193,-3663.154 981.3856,-3677.1172 1002.4307,-3688.4819 1012.3378,-3693.832 1792.4642,-3811.6853 1803.7218,-3811.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.7218,-3811.4819C1866.7423,-3805.3073 1877.7138,-3773.3275 1941.0359,-3773.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M911.1119,-2796.4819C1098.6323,-2674.0668 1203.8259,-2694.3032 1321.0291,-2503.4819 1376.5595,-2413.0715 1297.1544,-2355.0759 1357.0291,-2267.4819 1365.1059,-2255.6659 1377.5761,-2246.6732 1390.023,-2240.0448"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1391.5839,-2243.1776 1399.0189,-2235.6297 1388.4997,-2236.8936 1391.5839,-2243.1776"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M603.7021,-3317.4309C619.907,-3306.4172 642.9081,-3287.9344 654.4731,-3265.4819 714.5522,-3148.8443 630.4927,-3089.1703 690.4731,-2972.4819 736.1034,-2883.7109 772.1076,-2874.8798 855.7932,-2820.4819 878.2634,-2805.8757 887.1347,-2808.4547 911.1119,-2796.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.6594,-3317.2403C595.8622,-3269.6779 628.4702,-3080.2739 654.4731,-2924.4819 670.7844,-2826.7556 648.4291,-2794.197 690.4731,-2704.4819 698.7886,-2686.7382 1136.1041,-2182.0659 1152.5955,-2171.4819 1304.4333,-2074.0343 1367.7869,-2103.6403 1542.2007,-2057.4819 1599.9396,-2042.2014 1763.1161,-1951.6818 1803.7218,-1995.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M588.2417,-3317.3166C598.7851,-3270.0607 639.4741,-3081.7152 654.4731,-2924.4819 724.6776,-2188.5386 642.6261,-1999.2162 690.4731,-1261.4819 705.1358,-1035.4043 741.4984,-762.9574 752.154,-685.7746"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="755.6258,-686.2188 753.5339,-675.8325 748.6922,-685.2564 755.6258,-686.2188"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M755.1332,-3330.4819C785.0923,-3336.9694 798.3595,-3332.5677 819.7932,-3354.4819 853.9946,-3389.4499 822.5471,-3422.6045 855.7932,-3458.4819 874.0093,-3478.1397 891.6586,-3464.0477 911.1119,-3482.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M635.6043,-3323.8686C669.6649,-3321.9806 715.6048,-3321.9223 755.1332,-3330.4819"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.1332,-3330.4819C840.205,-3348.9038 780.0611,-3205.3914 855.7932,-3162.4819 934.6841,-3117.7828 969.2518,-3164.8393 1059.5131,-3173.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M587.9661,-3317.2856C597.4017,-3269.9056 634.266,-3081.1311 654.4731,-2924.4819 666.1177,-2834.211 643.9919,-2594.7375 690.4731,-2516.4819 725.7224,-2457.1366 783.6618,-2489.2943 819.7932,-2430.4819 891.0124,-2314.5559 817.563,-2257.0555 855.7932,-2126.4819 887.4422,-2018.3862 919.4245,-2000.838 966.4307,-1898.4819 983.2115,-1861.9416 986.3995,-1852.3573 1002.4307,-1815.4819 1053.0722,-1698.9947 1082.5902,-1675.8645 1116.5955,-1553.4819 1132.9776,-1494.5237 1110.0597,-1324.4723 1152.5955,-1280.4819 1178.9707,-1253.2047 1204.4361,-1286.2678 1236.8123,-1266.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M590.159,-3339.8353C603.9718,-3374.9219 647.8199,-3484.5487 690.4731,-3572.4819 743.0126,-3680.7962 771.2017,-3700.34 819.7932,-3810.4819 839.5363,-3855.2335 839.3786,-3868.4053 855.7932,-3914.4819 930.4359,-4124.0079 1024.4235,-4376.513 1051.741,-4449.688"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1048.4998,-4451.0133 1055.2775,-4459.1566 1055.0573,-4448.5641 1048.4998,-4451.0133"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.2356,-3317.0943C596.0328,-3252.0547 641.8131,-2927.4436 690.4731,-2840.4819 715.4664,-2795.8158 1309.5154,-2223.5131 1357.0291,-2204.4819 1418.5742,-2179.8306 1448.1975,-2172.3708 1506.2007,-2204.4819 1692.0133,-2307.3495 1777.2543,-2580.0975 1798.3463,-2658.2687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1795.0684,-2659.5661 1800.997,-2668.3469 1801.8381,-2657.7855 1795.0684,-2659.5661"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2530.4819C766.1844,-2497.7869 797.3752,-2513.7217 819.7932,-2487.4819 1025.296,-2246.9459 1023.1213,-2142.7262 1116.5955,-1840.4819 1144.574,-1750.0147 1087.0545,-1698.8303 1152.5955,-1630.4819 1263.8528,-1514.4589 1362.7165,-1626.9514 1506.2007,-1554.4819 1601.7627,-1506.2165 1787.6467,-1307.1006 1867.2231,-1235.4819 1883.3564,-1220.962 1886.1171,-1215.8421 1903.2231,-1202.4819 1906.8088,-1199.6814 1910.7034,-1196.8708 1914.5845,-1194.1975"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1916.5617,-1197.0859 1922.9342,-1188.6217 1912.6743,-1191.2645 1916.5617,-1197.0859"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2530.4819C766.6955,-2497.9641 801.2466,-2516.5872 819.7932,-2487.4819 877.0478,-2397.6319 823.8241,-2352.114 855.7932,-2250.4819 889.1112,-2144.5616 918.7288,-2126.7503 966.4307,-2026.4819 1035.3085,-1881.702 1073.2739,-1852.8472 1116.5955,-1698.4819 1134.9768,-1632.9848 1107.9537,-1445.8129 1152.5955,-1394.4819 1318.9466,-1203.2045 1461.5402,-1322.7354 1704.2205,-1249.4819 1723.8322,-1243.5621 1745.3698,-1236.299 1763.3764,-1230.0077"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1764.711,-1233.2485 1772.9821,-1226.6273 1762.3873,-1226.6455 1764.711,-1233.2485"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.7522,-3317.2552C596.328,-3269.7529 630.2237,-3080.5564 654.4731,-2924.4819 672.1132,-2810.9469 657.7346,-2778.6163 690.4731,-2668.4819 709.7726,-2603.5576 733.4446,-2594.6477 755.1332,-2530.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.0231,-3317.2928C597.6882,-3269.9415 635.3445,-3081.2664 654.4731,-2924.4819 680.5967,-2710.3643 645.2911,-2651.4022 690.4731,-2440.4819 735.6278,-2229.6894 779.1898,-2185.9872 855.7932,-1984.4819 871.8443,-1942.2596 891.6173,-1893.2538 902.6474,-1866.1676"/>
<polygon fill="#ff0000" stroke="#ff0000" points="906.0111,-1867.1882 906.5486,-1856.607 899.5299,-1864.5435 906.0111,-1867.1882"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2796.4819C967.8566,-2759.4385 993.5322,-2846.9317 1059.5131,-2831.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-4244.4819C1354.7953,-4165.697 1410.2759,-3989.4996 1426.4226,-3928.6383"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1429.8862,-3929.2224 1428.986,-3918.6659 1423.1065,-3927.4797 1429.8862,-3929.2224"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-4166.4819C1096.5481,-4188.4182 1201.0156,-4268.3857 1236.8123,-4244.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3558.4819C770.6138,-3583.4805 799.8357,-3550.8885 819.7932,-3572.4819 900.7669,-3660.0933 793.2629,-3736.8825 855.7932,-3838.4819 887.0615,-3889.2868 929.7903,-3867.404 966.4307,-3914.4819 1039.7631,-4008.7042 956.7847,-4105.6349 1059.5131,-4166.4819"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M587.0139,-3339.4935C593.6731,-3394.4444 626.2663,-3644.0768 690.4731,-3838.4819 704.9797,-3882.4047 729.591,-3930.7543 743.901,-3957.2762"/>
<polygon fill="#0000ff" stroke="#0000ff" points="740.9737,-3959.2185 748.8385,-3966.3175 747.1173,-3955.8634 740.9737,-3959.2185"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-3868.4819C1464.1389,-3863.7937 1499.9529,-3860.0509 1531.728,-3857.2191"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1532.2357,-3860.6882 1541.8934,-3856.3317 1531.6268,-3853.7147 1532.2357,-3860.6882"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3558.4819C770.8201,-3583.3515 796.761,-3554.2037 819.7932,-3572.4819 849.0699,-3595.7158 832.2158,-3619.4811 855.7932,-3648.4819 907.3557,-3711.9051 928.7701,-3724.0515 1002.4307,-3759.4819 1179.7852,-3844.7887 1236.8241,-3896.5606 1431.6149,-3868.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.2751,-3339.5039C620.0957,-3348.562 640.2662,-3362.4772 654.4731,-3378.4819 715.3218,-3447.0306 701.9916,-3483.7996 755.1332,-3558.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M917.2635,-3416.6645C937.2098,-3452.8889 999.0085,-3564.8319 1002.4307,-3567.4819 1256.8508,-3764.4963 1459.582,-3536.4453 1704.2205,-3745.4819 1733.8627,-3770.8104 1708.795,-3802.4029 1740.2205,-3825.4819 1812.6683,-3878.688 1851.1494,-3849.4819 1941.0359,-3849.4819 1941.0359,-3849.4819 1941.0359,-3849.4819 2068.7139,-3849.4819 2131.8569,-3849.4819 2293.3285,-3870.5372 2352.8577,-3849.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.3589,-3416.5501C929.9503,-3434.6768 952.7452,-3472.1208 966.4307,-3506.4819 989.7253,-3564.9697 961.5142,-3595.6353 1002.4307,-3643.4819 1005.2388,-3646.7657 1008.5601,-3649.6334 1012.166,-3652.1349"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1010.5959,-3655.272 1020.9889,-3657.3305 1014.148,-3649.2402 1010.5959,-3655.272"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1236.8123,-3477.4819C1449.5471,-3537.4257 1984.2751,-3258.5656 2205.1461,-3250.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M937.6589,-3416.5494C946.9052,-3420.6471 957.2567,-3425.5119 966.4307,-3430.4819 1007.1796,-3452.5578 1013.1812,-3476.3987 1059.5131,-3477.4819"/>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M1059.5131,-3477.4819C1065.216,-3477.6153 1332.3463,-3255.2564 1410.4076,-3190.1738"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1412.7272,-3192.7967 1418.1657,-3183.7043 1408.2441,-3187.4207 1412.7272,-3192.7967"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1059.5131,-3249.4819C1099.7374,-3191.7773 1106.3828,-3174.5122 1152.5955,-3121.4819 1220.8329,-3043.1776 1247.8633,-3033.2024 1321.0291,-2959.4819 1337.4173,-2942.9695 1336.6012,-2932.6147 1357.0291,-2921.4819 1386.6448,-2905.3419 1401.8696,-2923.3819 1431.6149,-2907.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M930.1573,-3394.4018C970.8777,-3370.7376 1069.4729,-3313.5783 1152.5955,-3266.4819 1476.3915,-3083.0227 1569.2516,-2967.8189 1941.0359,-2984.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1059.5131,-3553.4819C1097.4009,-3566.0655 1142.4066,-3566.1553 1177.5931,-3563.1809"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1178.0858,-3566.65 1187.7098,-3562.2196 1177.4235,-3559.6814 1178.0858,-3566.65"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M921.1348,-3416.5565C951.4496,-3449.8954 1041.2111,-3547.4034 1059.5131,-3553.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-3477.4819C1264.1541,-3484.824 1678.6751,-3286.685 1704.2205,-3274.4819 1728.1011,-3263.0741 1754.641,-3249.139 1774.3012,-3238.5668"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1776.2243,-3241.506 1783.3581,-3233.6727 1772.8965,-3235.3476 1776.2243,-3241.506"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1059.5131,-3477.4819C1138.2729,-3479.9853 1160.9661,-3456.1102 1236.8123,-3477.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M919.4212,-3416.5503C932.2665,-3434.3812 956.4992,-3471.0616 966.4307,-3506.4819 1013.7558,-3675.2665 971.1099,-4122.009 1002.4307,-4294.4819 1012.9441,-4352.3756 1037.6374,-4417.5291 1050.8356,-4449.9125"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1047.63,-4451.3195 1054.6843,-4459.2244 1054.0992,-4448.6457 1047.63,-4451.3195"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-3249.4819C1134.6324,-3141.718 1093.1101,-3088.7275 1116.5955,-2959.4819 1133.9954,-2863.7258 1088.1519,-2816.4136 1152.5955,-2743.4819 1155.4926,-2740.2032 1158.798,-2737.3454 1162.3837,-2734.8553"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1164.3423,-2737.7643 1171.1991,-2729.6875 1160.8021,-2731.7254 1164.3423,-2737.7643"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M945.2,-3394.3564C952.7952,-3390.7708 960.3796,-3386.2008 966.4307,-3380.4819 991.5695,-3356.7231 982.5444,-3339.7835 1002.4307,-3311.4819 1023.9648,-3280.8352 1038.0939,-3280.2092 1059.5131,-3249.4819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3477.4819C1280.177,-3490.2199 1297.8135,-3495.7031 1321.0291,-3534.4819 1400.8981,-3667.8937 1259.8344,-3761.1107 1357.0291,-3882.4819 1360.3063,-3886.5744 1364.278,-3890.0017 1368.6622,-3892.8712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1367.0759,-3895.993 1377.5274,-3897.7303 1370.4405,-3889.8546 1367.0759,-3895.993"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3477.4819C1274.1545,-3488.4509 1288.2078,-3480.5649 1321.0291,-3501.4819 1330.2841,-3507.3802 1545.0315,-3758.8088 1606.7572,-3831.1807"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1604.3503,-3833.7522 1613.5021,-3839.0904 1609.6767,-3829.2102 1604.3503,-3833.7522"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-4045.4874 166.6166,-4045.4874 166.6166,-4023.4765 281.0645,-4023.4765 281.0645,-4045.4874"/>
<text text-anchor="middle" x="223.8406" y="-4031.3319" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.1151,-4045.6543C240.9586,-4069.2392 272.1944,-4123.6485 317.2024,-4144.4819 519.9324,-4238.3223 605.3355,-4200.0389 819.7932,-4137.4819 892.1092,-4116.3875 921.345,-4112.8297 966.4307,-4052.4819 1010.6631,-3993.2761 1046.379,-3761.6944 1056.5788,-3689.8548"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1060.0735,-3690.1362 1057.9942,-3679.7475 1053.1411,-3689.1654 1060.0735,-3690.1362"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M281.0778,-4033.3739C339.5322,-4029.0673 428.8791,-4013.1732 480.9653,-3958.4819 527.6517,-3909.4606 494.4725,-3874.3317 516.9653,-3810.4819 564.7614,-3674.8045 610.8631,-3654.5621 654.4731,-3517.4819 681.9867,-3430.9981 671.2242,-3405.172 690.4731,-3316.4819 709.3142,-3229.6713 737.1938,-3127.5328 749.2378,-3084.3878"/>
<polygon fill="#ffff00" stroke="#ffff00" points="752.6774,-3085.0843 752.0067,-3074.5107 745.9373,-3083.1948 752.6774,-3085.0843"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M228.4838,-4023.4586C254.2771,-3962.564 383.5902,-3661.6862 516.9653,-3430.4819 534.0851,-3400.8051 556.7491,-3368.2659 571.2851,-3348.1067"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="574.2957,-3349.9176 577.3427,-3339.7703 568.6328,-3345.8027 574.2957,-3349.9176"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M281.2218,-4041.0307C294.877,-4042.5891 309.649,-4044.275 323.9664,-4045.909"/>
<polygon fill="#00ffff" stroke="#00ffff" points="323.9563,-4049.4305 334.2888,-4047.0871 324.7501,-4042.4756 323.9563,-4049.4305"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-2831.4819C1114.8121,-2817.948 1103.2733,-2771.9156 1152.5955,-2743.4819 1159.8132,-2739.321 1167.7851,-2735.7975 1175.8607,-2732.8289"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1177.0139,-2736.1336 1185.3495,-2729.5939 1174.755,-2729.5081 1177.0139,-2736.1336"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1787,-4023.0157C226.6007,-3947.7553 243.3953,-3524.3821 317.2024,-3423.4819 365.1424,-3357.9441 425.4136,-3401.7056 480.9653,-3342.4819 483.5497,-3339.7268 687.7258,-2843.0745 690.4731,-2840.4819 781.6233,-2754.4667 850.3083,-2735.3377 966.4307,-2782.4819 987.107,-2790.8763 982.9107,-2806.6678 1002.4307,-2817.4819 1025.2803,-2830.1407 1034.1401,-2837.6918 1059.5131,-2831.4819"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.4969,-4045.8504C233.8359,-4101.9161 272.5895,-4348.7417 317.2024,-4410.4819 378.6815,-4495.5633 418.5681,-4499.9236 516.9653,-4536.4819 610.8156,-4571.3509 885.8964,-4626.9625 966.4307,-4567.4819 1010.1942,-4535.1593 972.8827,-4496.1647 1002.4307,-4450.4819 1077.7512,-4334.0322 1121.4773,-4321.4986 1236.8123,-4244.4819"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M417.2848,-4065.5117C449.7076,-4084.313 520.2209,-4121.418 585.7192,-4130.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4130.4819C764.3004,-4155.1948 843.5549,-4122.4042 966.4307,-3990.4819 1008.4294,-3945.3911 1044.6437,-3754.5306 1055.9006,-3689.9456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1059.4106,-3690.1851 1057.6541,-3679.7369 1052.5116,-3689 1059.4106,-3690.1851"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M412.3877,-4043.3124C431.0404,-4026.8303 464.5206,-3994.0781 480.9653,-3958.4819 523.2537,-3866.945 500.5473,-3833.9694 516.9653,-3734.4819 541.2421,-3587.3738 571.5956,-3410.4934 582.012,-3349.9873"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="585.5222,-3350.2269 583.7706,-3339.7779 578.6238,-3349.0386 585.5222,-3350.2269"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M413.3287,-4043.3008C432.7858,-4027.0466 466.8637,-3994.8348 480.9653,-3958.4819 566.3643,-3738.3297 458.9901,-3125.3899 516.9653,-2896.4819 550.6129,-2763.6288 610.7467,-2750.3669 654.4731,-2620.4819 681.8953,-2539.0271 669.6868,-2513.8773 690.4731,-2430.4819 750.3548,-2190.2345 679.7182,-2072.5573 855.7932,-1898.4819 892.2835,-1862.406 933.4564,-1904.7975 966.4307,-1865.4819 1056.1306,-1758.5317 937.2742,-1676.9286 1002.4307,-1553.4819 1033.78,-1494.087 1082.6309,-1512.4211 1116.5955,-1454.4819 1156.5329,-1386.3538 1095.6684,-1335.2154 1152.5955,-1280.4819 1179.9473,-1254.1841 1203.817,-1285.2173 1236.8123,-1266.4819"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M411.7049,-4043.4065C429.8314,-4026.7905 463.0235,-3993.5937 480.9653,-3958.4819 511.7687,-3898.2003 499.3039,-3875.8332 516.9653,-3810.4819 572.858,-3603.6661 611.2001,-3558.3014 654.4731,-3348.4819 682.0439,-3214.7989 628.8924,-3165.2978 690.4731,-3043.4819 725.984,-2973.2361 771.1922,-2984.3967 819.7932,-2922.4819 839.9444,-2896.8106 828.7676,-2876.7769 855.7932,-2858.4819 931.4268,-2807.2819 970.5846,-2852.305 1059.5131,-2831.4819"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4130.4819C703.054,-4159.068 726.2915,-4192.0487 819.7932,-4268.4819 863.4322,-4304.1547 855.5854,-4346.8014 911.1119,-4356.4819"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M413.9198,-4065.6249C430.3567,-4077.9916 457.6252,-4098.57 480.9653,-4116.4819 497.0456,-4128.8225 500.0436,-4133.3232 516.9653,-4144.4819 575.2596,-4182.923 595.7842,-4182.6462 654.4731,-4220.4819 748.2547,-4280.9413 749.8826,-4335.3639 855.7932,-4370.4819 902.4665,-4385.9579 917.8326,-4377.9744 966.4307,-4370.4819 1048.1025,-4357.8905 1256.852,-4310.541 1321.0291,-4258.4819 1325.5141,-4254.8438 1506.1498,-3926.4981 1544.0214,-3869.6941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1546.9865,-3871.5794 1550.2988,-3861.5156 1541.4336,-3867.3173 1546.9865,-3871.5794"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M589.1012,-4427.4073C600.7084,-4388.8378 639.0559,-4256.652 654.4731,-4144.4819 704.6293,-3779.565 636.5813,-3680.8659 690.4731,-3316.4819 703.4363,-3228.833 734.2919,-3127.5574 748.1655,-3084.5448"/>
<polygon fill="#ffff00" stroke="#ffff00" points="751.5351,-3085.5008 751.3056,-3074.9084 744.8795,-3083.3319 751.5351,-3085.5008"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M589.1454,-4427.4133C600.8971,-4388.8632 639.6599,-4256.7333 654.4731,-4144.4819 686.5002,-3901.7886 618.4452,-3277.4429 690.4731,-3043.4819 749.5532,-2851.5783 1209.2187,-2367.7687 1321.0291,-2199.4819 1339.5198,-2171.6514 1339.0625,-2161.6537 1357.0291,-2133.4819 1375.9174,-2103.8648 1400.5815,-2071.5122 1416.2648,-2051.6046"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1419.1156,-2053.6426 1422.5895,-2043.6335 1413.6321,-2049.2917 1419.1156,-2053.6426"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M602.232,-4449.6867C617.1892,-4460.4247 639.1648,-4477.7321 654.4731,-4496.4819 675.6048,-4522.3643 662.0023,-4544.9933 690.4731,-4562.4819 745.7544,-4596.4392 1370.5938,-4583.8788 1431.6149,-4556.4819"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M620.6104,-4449.4952C631.6546,-4453.4215 643.768,-4458.1962 654.4731,-4463.4819 671.4977,-4471.8879 672.2484,-4481.1571 690.4731,-4486.4819 784.8467,-4514.0555 827.4746,-4522.1681 911.1119,-4470.4819"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M911.1119,-4470.4819C1039.4017,-4398.6204 935.7361,-4283.5322 1002.4307,-4152.4819 1036.408,-4085.7188 1086.593,-4097.1232 1116.5955,-4028.4819 1156.6851,-3936.7626 1089.5676,-3657.245 1152.5955,-3579.4819 1159.0777,-3571.4842 1167.9966,-3565.966 1177.6165,-3562.1757"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1179.0132,-3565.4001 1187.4058,-3558.9335 1176.8124,-3558.7551 1179.0132,-3565.4001"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M911.1119,-4470.4819C939.7621,-4452.7767 977.8481,-4453.1533 1008.2628,-4457.7619"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1007.8124,-4461.2356 1018.2586,-4459.4671 1008.9896,-4454.3352 1007.8124,-4461.2356"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M594.0204,-4427.3429C629.3457,-4379.2168 767.7266,-4183.1816 819.7932,-3997.4819 893.3519,-3735.1289 787.2373,-3649.1865 855.7932,-3385.4819 922.8533,-3127.5312 1014.1302,-3091.5236 1116.5955,-2845.4819 1135.0775,-2801.1026 1117.7509,-2776.6024 1152.5955,-2743.4819 1156.3678,-2739.8962 1160.6309,-2736.8223 1165.1869,-2734.1873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1166.885,-2737.2513 1174.2573,-2729.6421 1163.7489,-2730.9931 1166.885,-2737.2513"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M606.7284,-4505.3313C622.9978,-4495.4202 644.404,-4479.2855 654.4731,-4458.4819 709.7814,-4344.2113 672.6491,-3442.1764 690.4731,-3316.4819 702.9129,-3228.7571 734.0442,-3127.5215 748.0776,-3084.532"/>
<polygon fill="#ffff00" stroke="#ffff00" points="751.4457,-3085.4943 751.2553,-3074.9011 744.7982,-3083.3009 751.4457,-3085.4943"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M755.1332,-4662.4819C901.4518,-4729.661 966.1219,-4629.2117 1116.5955,-4686.4819 1135.5395,-4693.6921 1133.4228,-4707.9036 1152.5955,-4714.4819 1223.4029,-4738.7765 1252.4692,-4744.5399 1321.0291,-4714.4819 1441.8256,-4661.5224 1961.1687,-3868.8399 2068.7139,-3792.4819"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.1312,-4527.6214C618.9399,-4555.0504 684.6993,-4626.2478 755.1332,-4662.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-4662.4819C836.3883,-4704.283 1458.9288,-4405.681 1506.2007,-4327.4819 1593.0475,-4183.8165 1479.04,-4107.0224 1542.2007,-3951.4819 1555.6544,-3918.3506 1583.6699,-3887.3941 1602.9541,-3868.7034"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1605.4997,-3871.1135 1610.3668,-3861.7027 1600.6934,-3866.0243 1605.4997,-3871.1135"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M259.013,-4579.5571C311.6733,-4593.8814 412.1614,-4612.2667 480.9653,-4569.4819 511.6854,-4550.3791 494.6689,-4524.969 516.9653,-4496.4819 529.3201,-4480.6969 546.5705,-4466.1597 560.7012,-4455.5874"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.9908,-4458.2502 569.0247,-4449.5413 558.8769,-4452.5866 562.9908,-4458.2502"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-4562.5223C295.254,-4560.7392 313.4912,-4558.7619 330.689,-4556.8973"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.1089,-4560.3724 340.6733,-4555.8148 330.3543,-4553.4132 331.1089,-4560.3724"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M225.149,-4579.5285C229.9116,-4614.1689 249.7534,-4720.9412 317.2024,-4764.4819 428.1084,-4836.0757 805.2398,-4855.3292 911.1119,-4776.4819"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M446.6834,-4538.3775C458.2592,-4534.7583 470.3532,-4530.1677 480.9653,-4524.4819 485.6139,-4521.9913 535.138,-4480.8021 564.3962,-4456.3446"/>
<polygon fill="#ff0000" stroke="#ff0000" points="566.9813,-4458.7452 572.4055,-4449.6442 562.4897,-4453.3762 566.9813,-4458.7452"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M414.961,-4560.6731C470.2499,-4598.2645 659.6832,-4715.5081 819.7932,-4676.4819 891.1106,-4659.0986 910.9443,-4648.5404 966.4307,-4600.4819 1003.6185,-4568.2724 1033.9297,-4518.3514 1049.0615,-4490.6813"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1052.3056,-4492.0367 1053.9342,-4481.5678 1046.1326,-4488.7361 1052.3056,-4492.0367"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2353.8837,-1807.764C2365.2577,-1932.824 2467.6561,-3058.7241 2483.1387,-3228.9602"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2479.6747,-3229.5155 2484.0661,-3239.1574 2486.6459,-3228.8815 2479.6747,-3229.5155"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M785.5274,-653.3119C851.3696,-629.6633 1012.542,-574.7268 1152.5955,-550.4819 1242.3041,-534.9523 1266.032,-540.3723 1357.0291,-537.4819 1423.2941,-535.3771 1439.967,-534.5501 1506.2007,-537.4819 1511.0688,-537.6974 2201.5657,-596.1766 2205.1461,-599.4819"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2087.1757,-1824.3003C2105.2548,-1813.4203 2133.6416,-1796.5222 2158.5791,-1782.4819 2179.0483,-1770.9574 2187.0304,-1772.4359 2205.1461,-1757.4819"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2069.1002,-1846.6397C2072.5725,-1945.0542 2099.6552,-2675.1778 2158.5791,-3264.4819 2170.6637,-3385.3407 2193.1485,-3529.3832 2201.7127,-3582.4868"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2198.2642,-3583.0866 2203.3202,-3592.3972 2205.1739,-3581.9658 2198.2642,-3583.0866"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1285.8461,-3556.7376C1422.3397,-3561.5005 1816.7505,-3564.9026 2122.5791,-3464.4819 2263.6678,-3418.1546 2409.1648,-3310.5547 2463.1911,-3268.1316"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2465.6793,-3270.6257 2471.347,-3261.6743 2461.3342,-3265.1376 2465.6793,-3270.6257"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1857.325,-3211.4669C1912.3737,-3202.6413 1999.5412,-3195.6788 2068.7139,-3222.4819"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1811.2475,-3233.7344C1826.9501,-3256.8327 1864.9358,-3310.7637 1903.2231,-3350.4819 1997.8916,-3448.6886 2128.3264,-3547.4486 2181.3233,-3586.2818"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2179.58,-3589.3424 2189.7217,-3592.408 2183.7053,-3583.6871 2179.58,-3589.3424"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1623.2106,-1235.4819C1821.3025,-1229.5255 1872.6018,-1283.0466 2068.7139,-1254.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2068.7139,-1254.4819C2193.409,-1234.4992 2286.7063,-1146.9078 2352.8577,-1254.4819"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.006,-1250.0147C1630.4899,-1260.711 2067.9061,-1292.0428 2068.7139,-1292.4819"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1455.1001,-1235.4392C1525.6192,-1201.3017 1738.572,-1090.9432 1867.2231,-945.4819 1972.3643,-826.6027 2040.7677,-643.1196 2061.8125,-581.4865"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2065.219,-582.337 2065.0887,-571.743 2058.584,-580.106 2065.219,-582.337"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.2046,-1242.8901C1519.8678,-1240.2701 1574.9214,-1236.9339 1623.2106,-1235.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1235.4819C1658.4842,-1234.4213 1697.4177,-1230.4653 1730.0688,-1226.3483"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1730.5192,-1229.8193 1739.9892,-1225.0685 1729.6235,-1222.8768 1730.5192,-1229.8193"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1435.7652,-1257.4988C1449.1489,-1293.6534 1491.1703,-1412.2271 1506.2007,-1514.4819 1563.0905,-1901.5161 1510.904,-2884.5429 1542.2007,-3274.4819 1559.6831,-3492.3027 1605.4918,-3753.4352 1619.2484,-3829.026"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1615.8618,-3829.9632 1621.1054,-3839.1694 1622.7473,-3828.7026 1615.8618,-3829.9632"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2122.5604,-564.4243C2150.2537,-569.0425 2182.7916,-578.8445 2205.1461,-599.4819"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2352.8577,-1254.4819C2461.8251,-1431.6827 2482.657,-3025.6234 2484.8791,-3229.1352"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2481.3819,-3229.4326 2484.9879,-3239.3949 2488.3815,-3229.3582 2481.3819,-3229.4326"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2205.1461,-599.4819C2314.7807,-700.6953 2274.6978,-1127.3799 2352.8577,-1254.4819"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M913.4708,-4558.9283C920.569,-4590.1372 944.8919,-4676.8856 1002.4307,-4714.4819 1301.6952,-4910.0242 1446.2361,-4784.4819 1803.7218,-4784.4819 1803.7218,-4784.4819 1803.7218,-4784.4819 2205.1461,-4784.4819 2285.7732,-4784.4819 2458.8176,-3455.7019 2482.4113,-3271.5566"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2485.8982,-3271.8813 2483.6945,-3261.5182 2478.9547,-3270.9937 2485.8982,-3271.8813"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M924.0396,-4536.2429C936.6875,-4524.5483 955.5849,-4505.0912 966.4307,-4484.4819 996.7515,-4426.8655 978.07,-4402.8605 1002.4307,-4342.4819 1040.7263,-4247.565 1087.203,-4240.522 1116.5955,-4142.4819 1134.5964,-4082.4389 1113.5207,-3628.4958 1152.5955,-3579.4819 1159.1518,-3571.2579 1168.2871,-3565.6505 1178.1361,-3561.8468"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1179.3085,-3565.146 1187.7367,-3558.726 1177.1445,-3558.4889 1179.3085,-3565.146"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1247.5173,-615.4102C1267.1576,-595.8801 1311.1605,-555.6603 1357.0291,-537.4819 1445.242,-502.5219 2138.8943,-369.5523 2205.1461,-437.4819"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M1285.227,-637.5062C1297.2682,-641.1448 1309.9062,-645.7645 1321.0291,-651.4819 1339.0566,-660.7486 1339.1657,-669.9026 1357.0291,-679.4819 1364.4686,-683.4714 1372.6639,-686.9918 1380.8162,-690.0372"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1379.724,-693.3632 1390.3188,-693.3935 1382.0553,-686.7628 1379.724,-693.3632"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1308.7195,-616.9479C1403.1819,-607.4292 1572.5064,-600.8565 1704.2205,-653.4819 1792.367,-688.7003 1799.4842,-724.9869 1867.2231,-791.4819 2080.585,-1000.9256 2136.6034,-1067.5477 2251.7131,-1343.4819 2317.5546,-1501.3131 2343.7414,-1708.7781 2350.7722,-1775.1179"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2347.3018,-1775.5869 2351.804,-1785.1775 2354.2653,-1774.8725 2347.3018,-1775.5869"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1284.2085,-615.4466C1296.5134,-611.7703 1309.5326,-607.1353 1321.0291,-601.4819 1338.74,-592.7726 1339.4183,-584.3922 1357.0291,-575.4819 1388.1015,-559.7607 1397.1265,-556.299 1431.6149,-551.4819"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1262.1947,-637.5863C1282.2018,-647.8623 1308.71,-665.2244 1321.0291,-689.4819 1361.1924,-768.568 1304.8201,-3810.7747 1357.0291,-3882.4819 1360.2131,-3886.855 1364.1973,-3890.4734 1368.658,-3893.4659"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1367.2927,-3896.7102 1377.7382,-3898.483 1370.6781,-3890.5832 1367.2927,-3896.7102"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1115.543,-4475.3502C1170.8006,-4482.1165 1256.1635,-4497.9682 1321.0291,-4534.4819 1340.7471,-4545.5815 1338.0082,-4558.2261 1357.0291,-4570.4819 1463.2622,-4638.9319 1496.8346,-4670.4819 1623.2106,-4670.4819 1623.2106,-4670.4819 1623.2106,-4670.4819 1803.7218,-4670.4819 1882.2834,-4670.4819 1917.3462,-4695.3632 1978.8486,-4646.4819 2280.7958,-4406.4986 2131.6586,-4188.2015 2287.7131,-3835.4819 2339.5271,-3718.3702 2375.8406,-3699.4044 2418.0022,-3578.4819 2457.0451,-3466.5041 2476.4719,-3324.6735 2482.7506,-3271.7023"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2486.2556,-3271.8589 2483.9228,-3261.5241 2479.3016,-3271.0579 2486.2556,-3271.8589"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1431.6149,-4556.4819C1707.8447,-4400.988 1506.6346,-4127.7689 1740.2205,-3913.4819 1762.4534,-3893.0858 1776.0785,-3901.5714 1803.7218,-3889.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1236.8123,-4434.4819C1338.906,-4430.8989 1338.4204,-4598.3239 1431.6149,-4556.4819"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1065.6227,-4459.4662C1077.9367,-4436.6214 1105.5061,-4382.0743 1116.5955,-4332.4819 1134.8741,-4250.7384 1100.9092,-3645.3958 1152.5955,-3579.4819 1159.0855,-3571.2054 1168.1901,-3565.5738 1178.0298,-3561.7628"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1179.2013,-3565.0623 1187.6276,-3558.6398 1177.0353,-3558.4058 1179.2013,-3565.0623"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-4434.4819C1310.9173,-4436.6365 1499.1421,-4337.3184 1506.2007,-4327.4819 1604.0743,-4191.0896 1447.2276,-4089.9096 1542.2007,-3951.4819 1587.746,-3885.0975 1660.8424,-3938.3023 1704.2205,-3870.4819 1774.0604,-3761.2893 1665.6165,-2810.4767 1740.2205,-2704.4819 1742.4304,-2701.3421 1745.0984,-2698.5967 1748.0731,-2696.196"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1750.1292,-2699.0328 1756.5595,-2690.6125 1746.2817,-2693.185 1750.1292,-2699.0328"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.7632,-4459.4594C1131.3034,-4449.5277 1187.2162,-4436.2225 1236.8123,-4434.4819"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1060.4624,-4459.4657C1066.4313,-4389.8533 1099.086,-4003.8064 1116.5955,-3688.4819 1119.5083,-3636.0247 1120.3771,-2784.9817 1152.5955,-2743.4819 1155.1017,-2740.2537 1158.0061,-2737.4273 1161.1977,-2734.9541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1163.1463,-2737.8622 1169.6597,-2729.506 1159.357,-2731.9766 1163.1463,-2737.8622"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-4358.4819C1280.8452,-4320.5689 1293.0406,-4309.4028 1321.0291,-4258.4819 1384.6463,-4142.7399 1417.6296,-3985.0511 1427.971,-3928.6286"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1431.4248,-3929.1967 1429.7397,-3918.7368 1424.5341,-3927.9645 1431.4248,-3929.1967"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1068.2776,-4459.2329C1083.4456,-4440.5272 1116.454,-4403.0543 1152.5955,-4382.4819 1186.4195,-4363.2286 1207.3186,-4383.8764 1236.8123,-4358.4819"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-4358.4819C1283.3635,-4318.4006 1465.7344,-4342.699 1506.2007,-4296.4819 1562.5145,-4232.1651 1501.084,-3988.4307 1542.2007,-3913.4819 1553.2196,-3893.3963 1573.6075,-3877.5937 1591.1725,-3866.839"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1593.1546,-3869.7351 1600.0359,-3861.6792 1589.6328,-3863.6855 1593.1546,-3869.7351"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2103.0338,-1768.5411C2133.3578,-1775.9862 2177.0155,-1780.703 2205.1461,-1757.4819"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2084.0061,-1768.6368C2096.959,-1779.0948 2114.6507,-1796.0086 2122.5791,-1815.4819 2183.3084,-1964.6427 2145.6004,-3103.9561 2158.5791,-3264.4819 2168.3674,-3385.5483 2192.2238,-3529.4668 2201.4335,-3582.5121"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2197.9944,-3583.1643 2203.1661,-3592.4111 2204.8895,-3581.9574 2197.9944,-3583.1643"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2091.8896,-1768.5635C2125.6569,-1783.9688 2186.4008,-1808.6644 2205.1461,-1796.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1461,-1796.4819C2233.7376,-1777.9005 2272.4782,-1778.6218 2303.1113,-1783.6068"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2302.6971,-1787.0889 2313.1627,-1785.4391 2303.9525,-1780.2024 2302.6971,-1787.0889"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1301.4965,-1446.4198C1392.0921,-1430.4855 1561.6706,-1399.0501 1704.2205,-1363.4819 1868.2763,-1322.5477 1906.7524,-1303.0453 2068.7139,-1254.4819"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1261.5128,-1468.5265C1281.3947,-1478.8648 1308.0831,-1496.3457 1321.0291,-1520.4819 1388.4643,-1646.2074 1293.3394,-2033.8181 1357.0291,-2161.4819 1366.7973,-2181.062 1385.6803,-2196.915 1402.0014,-2207.8208"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1400.4127,-2210.958 1410.731,-2213.3629 1404.1646,-2205.0483 1400.4127,-2210.958"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1866.8141,-2686.4439C1892.0639,-2691.8512 1920.0697,-2701.4498 1941.0359,-2718.4819"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.9879,-2674.7117C643.165,-2652.6724 1184.8063,-2597.6362 1321.0291,-2698.4819 1362.7128,-2729.3404 1319.0512,-2774.1626 1357.0291,-2809.4819 1476.2893,-2920.3938 1908.8863,-2953.1832 2068.7139,-2984.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2068.7139,-2984.4819C2318.6111,-2993.766 2349.226,-1977.6881 2352.4981,-1817.597"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2355.9978,-1817.6405 2352.689,-1807.5756 2348.999,-1817.507 2355.9978,-1817.6405"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1941.4867,-1188.9252C1944.5173,-1262.2727 1963.3862,-1666.8599 2014.8486,-1777.4819 2022.1014,-1793.0723 2035.1325,-1807.2784 2046.5607,-1817.729"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2044.2912,-1820.3938 2054.1257,-1824.3348 2048.8954,-1815.121 2044.2912,-1820.3938"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1942.7078,-1166.274C1949.9749,-1118.0311 1980.0203,-923.3694 2014.8486,-765.4819 2029.7906,-697.7454 2051.9328,-618.6148 2062.5705,-581.595"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2066.0689,-582.0958 2065.4818,-571.5173 2059.3439,-580.153 2066.0689,-582.0958"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1843.8079,-1204.3886C1859.2788,-1200.1072 1877.1054,-1195.1739 1893.2352,-1190.7102"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1894.3185,-1194.042 1903.0227,-1188.0016 1892.4514,-1187.2956 1894.3185,-1194.042"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1452.6302,-1545.5363C1470.4611,-1556.1981 1494.8943,-1574.1428 1506.2007,-1597.4819 1559.3214,-1707.136 1486.8757,-2584.9233 1542.2007,-2693.4819 1552.5343,-2713.7585 1572.7242,-2729.4853 1590.3619,-2740.1545"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1588.8706,-2743.3338 1599.287,-2745.2701 1592.3516,-2737.2607 1588.8706,-2743.3338"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1440.4535,-1523.3316C1458.4366,-1500.9575 1501.0718,-1449.4814 1542.2007,-1411.4819 1575.5021,-1380.7144 1584.4207,-1372.9547 1623.2106,-1349.4819"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M1242.4322,-867.7333C1269.4264,-921.7763 1385.9224,-1155.0044 1421.3531,-1225.9376"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1418.3724,-1227.8028 1425.9721,-1235.1849 1424.6347,-1224.6748 1418.3724,-1227.8028"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1941.0359,-627.4819C1971.2718,-607.3215 2008.2738,-588.4805 2034.6449,-575.9456"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2036.2849,-579.0422 2043.8474,-571.622 2033.3082,-572.7066 2036.2849,-579.0422"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1243.0868,-845.3317C1262.8463,-810.6091 1324.4052,-705.4848 1357.0291,-684.4819 1502.6644,-590.7234 1567.7406,-629.3261 1740.2205,-613.4819 1796.4294,-608.3185 1811.0252,-608.1995 1867.2231,-613.4819 1900.4671,-616.6068 1913.2546,-646.0057 1941.0359,-627.4819"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.7855,-867.5685C1271.4138,-879.4422 1299.3909,-899.3134 1321.0291,-919.4819 1376.0238,-970.7417 1363.2788,-1016.1422 1431.6149,-1047.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-1047.4819C1510.5246,-1083.6709 1548.8504,-1040.683 1623.2106,-1085.4819"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M918.373,-1856.5445C929.9841,-1874.6634 952.8061,-1912.0966 966.4307,-1946.4819 989.9385,-2005.8105 967.0618,-2032.3638 1002.4307,-2085.4819 1048.8716,-2155.2284 1077.7967,-2161.7132 1152.5955,-2199.4819 1181.4401,-2214.0467 1414.7261,-2253.9335 1431.6149,-2281.4819"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M912.9075,-1834.2765C920.662,-1786.9126 953.1291,-1598.7553 1002.4307,-1450.4819 1015.4932,-1411.1967 1126.7851,-1141.8514 1152.5955,-1109.4819 1274.9113,-956.0828 1792.6478,-729.9073 1941.0359,-627.4819"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M911.1119,-4776.4819C961.2475,-4739.1439 1029.9762,-4554.2167 1052.238,-4491.4023"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1055.6065,-4492.3737 1055.6225,-4481.7789 1049.003,-4490.0513 1055.6065,-4492.3737"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M475.1411,-4710.9207C547.2327,-4717.9805 658.5567,-4728.9055 755.1332,-4738.4819"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M755.1332,-4738.4819C790.6956,-4741.3232 882.4993,-4797.791 911.1119,-4776.4819"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M481.1951,-4741.2634C569.4598,-4738.1314 703.9832,-4734.3954 755.1332,-4738.4819"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M1239.1973,-2707.2305C1250.7659,-2652.098 1301.2825,-2404.8336 1321.0291,-2199.4819 1370.6561,-1683.3933 1291.4114,-1547.782 1357.0291,-1033.4819 1372.1149,-915.2419 1410.3555,-777.0634 1425.3993,-725.3824"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1428.7815,-726.2864 1428.2407,-715.7054 1422.0651,-724.3142 1428.7815,-726.2864"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1304.4032,-2729.6937C1310.8036,-2733.1826 1316.5584,-2737.6848 1321.0291,-2743.4819 1398.352,-2843.749 1281.4649,-3780.8829 1357.0291,-3882.4819 1360.2573,-3886.8225 1364.2722,-3890.4183 1368.7529,-3893.396"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1367.409,-3896.6509 1377.8595,-3898.3937 1370.7768,-3890.5142 1367.409,-3896.6509"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.3276,-1566.69C526.1185,-1577.4133 696.1339,-1607.3039 819.7932,-1679.4819 899.2205,-1725.8424 921.1604,-1745.4283 966.4307,-1825.4819 999.3284,-1883.6567 984.418,-1907.1227 1002.4307,-1971.4819 1083.6658,-2261.7353 1200.0299,-2609.6402 1229.7115,-2697.5342"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1226.4449,-2698.8005 1232.9642,-2707.1521 1233.076,-2696.5578 1226.4449,-2698.8005"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1433.4497,-3896.4592C1451.3837,-3788.7219 1595.2615,-2924.3846 1619.6913,-2777.6238"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1623.1635,-2778.0796 1621.3531,-2767.6406 1616.2585,-2776.9302 1623.1635,-2778.0796"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1485.4224,-3915.6375C1559.9637,-3924.5889 1697.4659,-3932.519 1803.7218,-3889.4819"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.0113,-3896.3564C1499.6059,-3887.2545 1543.0517,-3874.3293 1576.0343,-3864.517"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1577.3217,-3867.7856 1585.9085,-3861.5794 1575.3256,-3861.0762 1577.3217,-3867.7856"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M447.2025,-3432.4089C458.6449,-3428.8056 470.5478,-3424.2145 480.9653,-3418.4819 515.8294,-3399.297 549.517,-3367.1597 568.8998,-3346.9281"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="571.5295,-3349.2408 575.8318,-3339.5588 566.4307,-3344.4447 571.5295,-3349.2408"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.7111,-3454.7382C409.8066,-3516.238 456.1342,-3811.2334 516.9653,-3876.4819 539.0358,-3900.1551 558.5344,-3882.9175 585.7192,-3900.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3900.4819C675.6533,-3958.5895 744.0317,-3881.8194 819.7932,-3957.4819 867.3871,-4005.0137 809.5626,-4055.6232 855.7932,-4104.4819 920.8411,-4173.2276 978.8905,-4116.9118 1059.5131,-4166.4819"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M400.7584,-3849.3921C408.6286,-3799.0965 444.6303,-3588.0652 516.9653,-3430.4819 531.2449,-3399.3736 554.5951,-3367.2351 570.0602,-3347.5509"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="572.8457,-3349.6715 576.3529,-3339.674 567.3767,-3345.3024 572.8457,-3349.6715"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.501,-3866.3028C491.001,-3873.168 562.6174,-3885.5556 585.7192,-3900.4819"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-4280.4819C1137.8849,-4262.5033 1169.943,-4289.1349 1236.8123,-4244.4819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M763.3942,-3988.4929C776.6485,-4006.5391 802.8879,-4043.8726 819.7932,-4078.4819 840.8929,-4121.6782 823.8458,-4144.5587 855.7932,-4180.4819 922.8208,-4255.851 961.2044,-4303.0341 1059.5131,-4280.4819"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1662.9284,-3861.5343C1712.0489,-3874.8191 1790.795,-3894.7177 1803.7218,-3889.4819"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.7218,-3889.4819C1840.7453,-3874.4862 1901.1091,-3772.2726 1941.0359,-3773.4819"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M437.5289,-4909.5401C460.4182,-4915.7213 490.1412,-4923.0504 516.9653,-4927.4819 714.1659,-4960.0609 777.3756,-5007.3482 966.4307,-4942.4819 985.6033,-4935.9036 984.3044,-4923.5541 1002.4307,-4914.4819 1291.6028,-4769.7514 1396.7742,-4822.7032 1704.2205,-4722.4819 1811.2721,-4687.5852 1859.7773,-4710.4234 1941.0359,-4632.4819"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatrecoveryf90EfferentGraph = svgPanZoom('#sourcefileheatrecoveryf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatrecovery.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileheatrecoveryf90AfferentGraph" width="641pt" height="337pt"
 viewBox="0.00 0.00 641.00 337.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph" class="graph" transform="scale(.2239 .2239) rotate(0) translate(4 1501.031)">
<title>sourcefile~~heatrecovery.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1501.031 2858.5586,-1501.031 2858.5586,4 -4,4"/>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~heatrecovery.f90</title>
<polygon fill="none" stroke="#000000" points="95.4006,-912.8978 -.1338,-912.8978 -.1338,-890.887 95.4006,-890.887 95.4006,-912.8978"/>
<text text-anchor="middle" x="47.6334" y="-898.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatRecovery.f90</text>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1644.3744,-777.8978 1500.6788,-777.8978 1500.6788,-755.887 1644.3744,-755.887 1644.3744,-777.8978"/>
<text text-anchor="middle" x="1572.5266" y="-763.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge155" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M54.1748,-890.7557C73.6956,-858.7011 135.1196,-766.075 214.2045,-727.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M214.2045,-727.8924C267.343,-702.2368 276.7742,-686.3444 333.1421,-668.8924 636.2297,-575.054 730.4486,-606.8886 1046.3086,-636.8924 1131.4529,-644.9803 1153.5899,-643.4922 1237.1147,-661.8924 1346.6213,-686.0162 1471.7498,-729.6129 1533.6423,-752.294"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1532.784,-755.7077 1543.3774,-755.8806 1535.2039,-749.1393 1532.784,-755.7077"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~desiccantdehumidifiers.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/desiccantdehumidifiers.f90.html" xlink:title="DesiccantDehumidifiers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="616.3541,-854.8978 476.7445,-854.8978 476.7445,-832.887 616.3541,-832.887 616.3541,-854.8978"/>
<text text-anchor="middle" x="546.5493" y="-840.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DesiccantDehumidifiers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge156" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M214.2045,-727.8924C215.9363,-727.0929 417.329,-798.1731 505.73,-829.4418"/>
<polygon fill="#ff0000" stroke="#ff0000" points="504.5842,-832.7489 515.179,-832.7846 506.9189,-826.1497 504.5842,-832.7489"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1020.6621,-1365.8978 888.3662,-1365.8978 888.3662,-1343.887 1020.6621,-1343.887 1020.6621,-1365.8978"/>
<text text-anchor="middle" x="954.5142" y="-1351.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge157" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-1354.8924C785.5072,-1355.1854 836.9488,-1355.1967 877.9899,-1355.1294"/>
<polygon fill="#ff0000" stroke="#ff0000" points="878.1967,-1358.6291 888.1903,-1355.1107 878.1839,-1351.6291 878.1967,-1358.6291"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="789.044,-815.8978 690.1274,-815.8978 690.1274,-793.887 789.044,-793.887 789.044,-815.8978"/>
<text text-anchor="middle" x="739.5857" y="-801.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge158" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M214.2045,-727.8924C298.5322,-687.4768 579.1615,-759.4778 691.9981,-791.1003"/>
<polygon fill="#ff0000" stroke="#ff0000" points="691.1716,-794.5037 701.7462,-793.849 693.0714,-787.7664 691.1716,-794.5037"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="297.0798,-912.8978 131.3292,-912.8978 131.3292,-890.887 297.0798,-890.887 297.0798,-912.8978"/>
<text text-anchor="middle" x="214.2045" y="-898.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge159" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M95.366,-901.8924C103.5383,-901.8924 112.2728,-901.8924 121.1575,-901.8924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="121.2307,-905.3925 131.2306,-901.8924 121.2306,-898.3925 121.2307,-905.3925"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1417.9892,-1005.8978 1292.5621,-1005.8978 1292.5621,-983.887 1417.9892,-983.887 1417.9892,-1005.8978"/>
<text text-anchor="middle" x="1355.2756" y="-991.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge160" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-1354.8924C751.7209,-1354.9698 943.3013,-1320.5338 954.5142,-1315.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M214.2045,-1255.8924C398.4534,-1405.9319 501.9784,-1353.3766 739.5857,-1354.8924"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="774.3668,-1091.8978 704.8046,-1091.8978 704.8046,-1069.887 774.3668,-1069.887 774.3668,-1091.8978"/>
<text text-anchor="middle" x="739.5857" y="-1077.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge161" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M214.2045,-1255.8924C391.2369,-1368.2431 647.9459,-1162.1503 720.0851,-1098.6558"/>
<polygon fill="#ff0000" stroke="#ff0000" points="722.4462,-1101.2399 727.5882,-1091.9765 717.7918,-1096.0115 722.4462,-1101.2399"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M49.3141,-912.9253C57.3541,-961.731 96.4913,-1160.035 214.2045,-1255.8924"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2566.5231,-411.8978 2467.5655,-411.8978 2467.5655,-389.887 2566.5231,-389.887 2566.5231,-411.8978"/>
<text text-anchor="middle" x="2517.0443" y="-397.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1582.2755,-755.7026C1623.7925,-709.3597 1791.8453,-534.8924 1968.8379,-534.8924 1968.8379,-534.8924 1968.8379,-534.8924 2171.8206,-534.8924 2300.0171,-534.8924 2437.9523,-453.5958 2492.6795,-417.647"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2494.6462,-420.5425 2501.0298,-412.0867 2490.7664,-414.716 2494.6462,-420.5425"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1827.6876,-1119.8978 1729.1295,-1119.8978 1729.1295,-1097.887 1827.6876,-1097.887 1827.6876,-1119.8978"/>
<text text-anchor="middle" x="1778.4086" y="-1105.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1579.3767,-778.2714C1609.2413,-827.8809 1728.2724,-1025.6089 1766.5134,-1089.1328"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1763.5848,-1091.0544 1771.741,-1097.8166 1769.582,-1087.4441 1763.5848,-1091.0544"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M601.0918,-832.873C625.7964,-827.8818 655.0578,-821.97 680.3045,-816.8693"/>
<polygon fill="#ffda00" stroke="#ffda00" points="681.0174,-820.296 690.1262,-814.8849 679.6311,-813.4347 681.0174,-820.296"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M616.7325,-847.592C714.0328,-853.6624 895.0263,-868.3629 1046.3086,-899.8924 1149.584,-921.4165 1172.2503,-938.9819 1273.1147,-969.8924 1284.8086,-973.4761 1297.4444,-977.33 1309.2177,-980.9131"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1308.2791,-984.2859 1318.8649,-983.8473 1310.3161,-977.5888 1308.2791,-984.2859"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M565.8376,-854.9536C581.8202,-865.1237 603.8817,-881.6689 616.4517,-901.8924 652.8719,-960.4882 605.5778,-1002.2689 652.4517,-1052.8924 663.4326,-1064.7517 679.4437,-1071.6073 694.7541,-1075.5631"/>
<polygon fill="#ffda00" stroke="#ffda00" points="694.1324,-1079.0104 704.6541,-1077.7674 695.6538,-1072.1777 694.1324,-1079.0104"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1021.052,-1346.1647C1030.5025,-1342.4186 1039.3544,-1337.183 1046.3086,-1329.8924 1097.2162,-1276.5219 1031.5356,-1221.391 1082.3086,-1167.8924 1131.4648,-1116.0974 1181.3369,-1169.4781 1237.1147,-1124.8924 1263.5197,-1103.7857 1246.5523,-1078.8006 1273.1147,-1057.8924 1332.4339,-1011.2005 1377.9839,-1061.4142 1437.4365,-1014.8924 1514.9914,-954.2055 1554.0076,-836.0837 1567.2179,-788.0099"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1570.6627,-788.6741 1569.8413,-778.1112 1563.8962,-786.8808 1570.6627,-788.6741"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1020.73,-1348.5924C1150.8063,-1334.2853 1446.5991,-1292.1261 1671.6167,-1187.8924 1705.2737,-1172.3016 1738.7933,-1145.1174 1759.0625,-1127.0619"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1761.5996,-1129.4859 1766.6515,-1120.173 1756.8947,-1124.3028 1761.5996,-1129.4859"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1210.498,-1239.8978 1108.9254,-1239.8978 1108.9254,-1217.887 1210.498,-1217.887 1210.498,-1239.8978"/>
<text text-anchor="middle" x="1159.7117" y="-1225.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1011.4396,-1343.7839C1023.3601,-1340.2637 1035.5633,-1335.7174 1046.3086,-1329.8924 1085.9428,-1308.4068 1123.2266,-1270.5602 1143.6159,-1247.7964"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1146.3634,-1249.9721 1150.3365,-1240.1504 1141.1057,-1245.3508 1146.3634,-1249.9721"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M789.1296,-803.4107C849.8848,-801.2283 955.9322,-796.2342 1046.3086,-785.8924 1097.0811,-780.0825 1108.6594,-769.1891 1159.7117,-766.8924"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1214.0219,-738.8978 1105.4014,-738.8978 1105.4014,-716.887 1214.0219,-716.887 1214.0219,-738.8978"/>
<text text-anchor="middle" x="1159.7117" y="-724.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M750.9907,-793.7244C781.2476,-765.2971 867.2292,-692.2003 954.5142,-688.8924"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge128" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M297.1617,-892.2831C325.5957,-889.1177 357.6205,-885.6941 386.8945,-882.8924"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M546.5493,-804.8924C589.936,-792.692 641.0097,-793.3099 679.7209,-796.6455"/>
<polygon fill="#0091ff" stroke="#0091ff" points="679.5032,-800.1404 689.7883,-797.5976 680.1623,-793.1715 679.5032,-800.1404"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M386.8945,-882.8924C434.4143,-878.3445 433.1266,-843.5086 476.647,-823.8924 505.9981,-810.6628 515.5565,-813.6076 546.5493,-804.8924"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge134" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M954.5142,-1315.8924C993.0089,-1299.9582 1016.8162,-1326.3194 1046.3086,-1296.8924 1101.5956,-1241.7281 1026.3319,-1179.3567 1082.3086,-1124.8924 1107.3649,-1100.5131 1131.5708,-1131.6352 1159.7117,-1110.8924"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M739.5857,-1276.8924C835.8303,-1289.6286 864.8116,-1353.0231 954.5142,-1315.8924"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge135" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M546.5493,-1119.8924C598.1134,-1117.2946 656.0112,-1104.1917 694.8293,-1093.8809"/>
<polygon fill="#0091ff" stroke="#0091ff" points="696.0223,-1097.184 704.7606,-1091.1931 694.1935,-1090.4271 696.0223,-1097.184"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M386.8945,-1119.8924C450.8714,-1150.5837 475.6815,-1123.4628 546.5493,-1119.8924"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="609.7267,-932.8978 483.3719,-932.8978 483.3719,-910.887 609.7267,-910.887 609.7267,-932.8978"/>
<text text-anchor="middle" x="546.5493" y="-918.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge126" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M386.8945,-882.8924C409.151,-880.7624 463.9908,-895.8562 503.1791,-907.8839"/>
<polygon fill="#0091ff" stroke="#0091ff" points="502.1876,-911.2408 512.7757,-910.8634 504.2632,-904.5556 502.1876,-911.2408"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1208.1433,-1082.8978 1111.28,-1082.8978 1111.28,-1060.887 1208.1433,-1060.887 1208.1433,-1082.8978"/>
<text text-anchor="middle" x="1159.7117" y="-1068.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge127" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M739.5857,-1276.8924C748.2568,-1276.8924 1039.8783,-1224.7095 1046.3086,-1218.8924 1088.2328,-1180.966 1042.8456,-1137.3735 1082.3086,-1096.8924 1087.8534,-1091.2045 1094.6986,-1086.8092 1102.0049,-1083.413"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1103.4673,-1086.5975 1111.4431,-1079.6235 1100.859,-1080.1016 1103.4673,-1086.5975"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M216.872,-913.0931C226.2165,-949.9869 260.8942,-1069.0368 333.1421,-1133.8924 378.1317,-1174.2787 683.2908,-1276.8924 739.5857,-1276.8924"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1037.0159,-1008.8978 872.0124,-1008.8978 872.0124,-986.887 1037.0159,-986.887 1037.0159,-1008.8978"/>
<text text-anchor="middle" x="954.5142" y="-994.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge129" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M739.5857,-1038.8924C769.1646,-1037.3314 842.4651,-1022.4573 895.2422,-1011.0694"/>
<polygon fill="#0091ff" stroke="#0091ff" points="896.1426,-1014.4556 905.1736,-1008.9156 894.6589,-1007.6147 896.1426,-1014.4556"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M386.8945,-1119.8924C405.0207,-1128.588 719.5096,-1039.9519 739.5857,-1038.8924"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M219.0456,-913.0805C235.8328,-950.3277 295.5557,-1070.5619 386.8945,-1119.8924"/>
</g>
<!-- sourcefile~unitventilator.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~unitventilator.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/unitventilator.f90.html" xlink:title="UnitVentilator.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1000.411,-776.8978 908.6173,-776.8978 908.6173,-754.887 1000.411,-754.887 1000.411,-776.8978"/>
<text text-anchor="middle" x="954.5142" y="-762.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UnitVentilator.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~unitventilator.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge130" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~unitventilator.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M233.8147,-890.764C276.3986,-867.2476 381.1903,-812.8607 476.647,-790.8924 626.1272,-756.4912 808.5607,-758.7079 898.6589,-762.6174"/>
<polygon fill="#0091ff" stroke="#0091ff" points="898.5077,-766.114 908.6573,-763.0749 898.8278,-759.1213 898.5077,-766.114"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1043.8533,-1168.8978 865.175,-1168.8978 865.175,-1146.887 1043.8533,-1146.887 1043.8533,-1168.8978"/>
<text text-anchor="middle" x="954.5142" y="-1154.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge131" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M546.5493,-1119.8924C665.2655,-1113.9114 802.8233,-1131.9295 884.0428,-1145.1645"/>
<polygon fill="#0091ff" stroke="#0091ff" points="883.7122,-1148.6572 894.149,-1146.8341 884.8533,-1141.7508 883.7122,-1148.6572"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1039.2118,-1209.8978 869.8165,-1209.8978 869.8165,-1187.887 1039.2118,-1187.887 1039.2118,-1209.8978"/>
<text text-anchor="middle" x="954.5142" y="-1195.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge132" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M386.8945,-1119.8924C537.2449,-1201.094 741.3338,-1208.899 859.3884,-1205.2408"/>
<polygon fill="#0091ff" stroke="#0091ff" points="859.6143,-1208.7352 869.488,-1204.8932 859.3735,-1201.7393 859.6143,-1208.7352"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1026.6153,-1287.8978 882.4131,-1287.8978 882.4131,-1265.887 1026.6153,-1265.887 1026.6153,-1287.8978"/>
<text text-anchor="middle" x="954.5142" y="-1273.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge133" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M739.5857,-1276.8924C783.3513,-1276.8924 832.1298,-1276.8924 872.1407,-1276.8924"/>
<polygon fill="#0091ff" stroke="#0091ff" points="872.3811,-1280.3925 882.381,-1276.8924 872.381,-1273.3925 872.3811,-1280.3925"/>
</g>
<!-- sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~ventilatedslab.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/ventilatedslab.f90.html" xlink:title="VentilatedSlab.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="435.0514,-699.8978 338.7377,-699.8978 338.7377,-677.887 435.0514,-677.887 435.0514,-699.8978"/>
<text text-anchor="middle" x="386.8945" y="-685.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VentilatedSlab.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge136" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M222.7266,-890.8685C242.0739,-865.9032 290.9148,-803.2251 333.1421,-751.8924 345.4615,-736.9166 359.7202,-720.2337 370.4552,-707.7993"/>
<polygon fill="#0091ff" stroke="#0091ff" points="373.3577,-709.7941 377.257,-699.9429 368.0655,-705.2123 373.3577,-709.7941"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="999.1319,-930.8978 909.8964,-930.8978 909.8964,-908.887 999.1319,-908.887 999.1319,-930.8978"/>
<text text-anchor="middle" x="954.5142" y="-916.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge137" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M386.8945,-882.8924C574.6005,-864.928 798.0767,-894.3456 899.5387,-910.4577"/>
<polygon fill="#0091ff" stroke="#0091ff" points="899.1254,-913.9361 909.5542,-912.0682 900.2367,-907.0249 899.1254,-913.9361"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="995.46,-1049.8978 913.5684,-1049.8978 913.5684,-1027.887 995.46,-1027.887 995.46,-1049.8978"/>
<text text-anchor="middle" x="954.5142" y="-1035.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge138" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M739.5857,-1038.8924C795.0873,-1029.3992 859.837,-1031.0978 903.6471,-1034.0924"/>
<polygon fill="#0091ff" stroke="#0091ff" points="903.5356,-1037.5935 913.7644,-1034.8326 904.0464,-1030.6122 903.5356,-1037.5935"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440.4005,-932.8978 333.3885,-932.8978 333.3885,-910.887 440.4005,-910.887 440.4005,-932.8978"/>
<text text-anchor="middle" x="386.8945" y="-918.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge139" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M297.2617,-911.5116C305.9847,-912.5219 314.7525,-913.5373 323.2083,-914.5166"/>
<polygon fill="#0091ff" stroke="#0091ff" points="323.0076,-918.0167 333.3439,-915.6905 323.813,-911.0632 323.0076,-918.0167"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge140" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1394.6683,-983.833C1484.5216,-958.9849 1702.6868,-900.8924 1778.4086,-900.8924 1778.4086,-900.8924 1778.4086,-900.8924 2171.8206,-900.8924 2337.6918,-900.8924 2343.2507,-773.3048 2431.5549,-632.8924 2454.7609,-595.9927 2494.9533,-471.6199 2510.5739,-421.7925"/>
<polygon fill="#4800ff" stroke="#4800ff" points="2513.963,-422.6808 2513.5991,-412.0922 2507.2805,-420.5967 2513.963,-422.6808"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge141" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1380.4705,-1005.9206C1420.393,-1022.9115 1501.0046,-1055.2639 1572.5266,-1071.8924"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge145" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M744.9378,-1092.0255C767.9472,-1139.8488 857.5303,-1325.6205 862.7197,-1329.8924 867.5735,-1333.888 873.0131,-1337.2481 878.7572,-1340.0733"/>
<polygon fill="#ff00da" stroke="#ff00da" points="877.4272,-1343.3115 887.9936,-1344.0872 880.2172,-1336.8915 877.4272,-1343.3115"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge151" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.3999,-1086.4548C833.6451,-1094.226 956.3825,-1102.8644 1046.3086,-1058.8924 1067.795,-1048.386 1062.1637,-1031.7855 1082.3086,-1018.8924 1112.6446,-999.477 1124.0173,-999.7031 1159.7117,-994.8924"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2722.1412,-584.8978 2602.3307,-584.8978 2602.3307,-562.887 2722.1412,-562.887 2722.1412,-584.8978"/>
<text text-anchor="middle" x="2662.236" y="-570.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge147" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M745.6397,-1092.1507C760.6536,-1120.3457 800.2947,-1196.4926 826.7197,-1262.8924 846.0532,-1311.4727 820.4681,-1344.0927 862.7197,-1374.8924 928.6556,-1422.9571 964.7775,-1378.1226 1046.3086,-1374.8924 1147.349,-1370.8893 1172.2519,-1364.0946 1273.1147,-1356.8924 1406.1157,-1347.3954 1439.187,-1337.8924 1572.5266,-1337.8924 1572.5266,-1337.8924 1572.5266,-1337.8924 1968.8379,-1337.8924 2146.5323,-1337.8924 2226.9219,-1378.0888 2361.3604,-1261.8924"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge148" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.6008,-1073.4592C791.1407,-1069.0142 810.7163,-1062.3527 826.7197,-1052.8924 845.665,-1041.6932 843.3105,-1029.2667 862.7197,-1018.8924 867.2884,-1016.4504 872.1325,-1014.2912 877.1138,-1012.3823"/>
<polygon fill="#ff00da" stroke="#ff00da" points="878.5267,-1015.5967 886.8259,-1009.0109 876.2311,-1008.9838 878.5267,-1015.5967"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge149" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.4255,-1087.2614C790.9254,-1091.1691 810.5181,-1097.143 826.7197,-1105.8924 845.2983,-1115.9255 843.8746,-1127.3693 862.7197,-1136.8924 867.8608,-1139.4904 873.3256,-1141.771 878.9275,-1143.7724"/>
<polygon fill="#ff00da" stroke="#ff00da" points="877.8594,-1147.1054 888.4519,-1146.8839 880.0331,-1140.4515 877.8594,-1147.1054"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge150" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M750.3001,-1092.1401C770.364,-1112.5093 815.8274,-1155.4679 862.7197,-1177.8924 868.1053,-1180.4679 873.8221,-1182.7358 879.6661,-1184.7317"/>
<polygon fill="#ff00da" stroke="#ff00da" points="878.9961,-1188.1895 889.5851,-1187.8398 881.0892,-1181.5097 878.9961,-1188.1895"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge152" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M747.9299,-1092.2271C766.6044,-1117.1106 813.9675,-1177.5878 862.7197,-1218.8924 881.7913,-1235.0505 905.7331,-1250.0305 924.3834,-1260.7179"/>
<polygon fill="#ff00da" stroke="#ff00da" points="922.9023,-1263.9005 933.3341,-1265.7521 926.3339,-1257.7993 922.9023,-1263.9005"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge153" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.4535,-1077.202C792.1679,-1073.6377 812.8255,-1066.637 826.7197,-1052.8924 862.69,-1017.3096 825.9576,-979.6566 862.7197,-944.8924 872.8595,-935.3037 886.3054,-929.3212 899.7704,-925.6089"/>
<polygon fill="#ff00da" stroke="#ff00da" points="900.6124,-929.0064 909.5315,-923.288 898.993,-922.1963 900.6124,-929.0064"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge154" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.596,-1074.0509C809.612,-1067.2083 863.8383,-1056.6117 903.6098,-1048.8398"/>
<polygon fill="#ff00da" stroke="#ff00da" points="904.5021,-1052.2317 913.6452,-1046.8788 903.1596,-1045.3617 904.5021,-1052.2317"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node54" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node54"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1008.6936,-1127.8978 900.3347,-1127.8978 900.3347,-1105.887 1008.6936,-1105.887 1008.6936,-1127.8978"/>
<text text-anchor="middle" x="954.5142" y="-1113.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge146" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.596,-1086.7566C805.8251,-1091.9874 852.3341,-1099.7775 890.2417,-1106.1269"/>
<polygon fill="#ff00da" stroke="#ff00da" points="889.7402,-1109.5916 900.181,-1107.7917 890.8966,-1102.6878 889.7402,-1109.5916"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2526.3476,-411.9775C2550.5679,-440.8367 2615.8029,-518.5661 2646.2178,-554.8063"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2643.7127,-557.2659 2652.8223,-562.6757 2649.0746,-552.7659 2643.7127,-557.2659"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1803.814,-1119.9582C1825.1495,-1128.8136 1856.6407,-1140.8737 1885.2004,-1147.8924 2009.9888,-1178.5598 2047.692,-1152.6553 2171.8206,-1185.8924"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2040.6754,-1138.8978 1897.0003,-1138.8978 1897.0003,-1116.887 2040.6754,-1116.887 2040.6754,-1138.8978"/>
<text text-anchor="middle" x="1968.8379" y="-1124.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1827.9445,-1113.8348C1845.9509,-1115.6314 1866.8137,-1117.713 1886.8758,-1119.7147"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1886.6601,-1123.2105 1896.9582,-1120.7206 1887.3551,-1116.245 1886.6601,-1123.2105"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2847.9569,-584.8978 2764.5399,-584.8978 2764.5399,-562.887 2847.9569,-562.887 2847.9569,-584.8978"/>
<text text-anchor="middle" x="2806.2484" y="-570.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2722.0591,-573.8924C2732.7237,-573.8924 2743.7555,-573.8924 2754.1819,-573.8924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2754.3704,-577.3925 2764.3703,-573.8924 2754.3703,-570.3925 2754.3704,-577.3925"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2854.3695,-967.8978 2758.1273,-967.8978 2758.1273,-945.887 2854.3695,-945.887 2854.3695,-967.8978"/>
<text text-anchor="middle" x="2806.2484" y="-953.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2666.3907,-584.9418C2686.3058,-637.9061 2772.1165,-866.1189 2798.5004,-936.2866"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2795.2812,-937.6699 2802.0769,-945.7982 2801.8333,-935.2061 2795.2812,-937.6699"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.1456,-1138.957C2046.7848,-1150.915 2113.7592,-1170.3457 2171.8206,-1185.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2171.8206,-1185.8924C2209.0563,-1195.8628 2219.1971,-1196.03 2255.1658,-1209.8924 2304.2022,-1228.7912 2320.3039,-1294.6964 2361.3604,-1261.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2361.3604,-1261.8924C2422.5926,-1212.968 2440.8924,-592.436 2517.0443,-573.8924"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2255.0113,-412.8978 2088.6298,-412.8978 2088.6298,-390.887 2255.0113,-390.887 2255.0113,-412.8978"/>
<text text-anchor="middle" x="2171.8206" y="-398.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1969.9348,-1116.6088C1976.0007,-1056.8269 2008.1248,-771.6309 2088.4753,-553.8924 2107.0101,-503.6659 2140.0303,-449.8472 2158.4547,-421.6812"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2161.4979,-423.4249 2164.1015,-413.155 2155.6617,-419.5598 2161.4979,-423.4249"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2181.8428,-413.0045C2221.6093,-455.7056 2373.1206,-605.3218 2517.0443,-573.8924"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2426.3657,-277.8978 2296.355,-277.8978 2296.355,-255.887 2426.3657,-255.887 2426.3657,-277.8978"/>
<text text-anchor="middle" x="2361.3604" y="-263.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2187.3314,-390.8448C2220.4567,-367.2512 2298.2913,-311.8134 2337.6638,-283.7704"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2339.7863,-286.5556 2345.901,-277.9033 2335.7253,-280.854 2339.7863,-286.5556"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2374.3661,-278.0867C2401.4492,-301.3976 2464.0764,-355.302 2496.6038,-383.2989"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2494.3226,-385.9534 2504.1851,-389.8242 2498.8891,-380.648 2494.3226,-385.9534"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2364.2461,-277.9808C2379.284,-334.5614 2450.5256,-587.898 2517.0443,-573.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2517.0443,-573.8924C2541.2171,-568.8028 2568.1597,-567.6099 2592.2092,-568.0762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.2246,-571.5781 2602.3224,-568.3711 2592.4287,-564.581 2592.2246,-571.5781"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1210.6251,-1221.7188C1220.1546,-1218.6189 1229.4996,-1214.1964 1237.1147,-1207.8924 1265.2882,-1184.57 1244.2461,-1156.3486 1273.1147,-1133.8924 1299.9308,-1113.033 1539.4355,-1064.1989 1572.5266,-1071.8924"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1210.6099,-1234.2282C1302.669,-1243.9529 1502.9501,-1265.4482 1671.6167,-1285.8924 1719.138,-1291.6525 1730.5807,-1297.9047 1778.4086,-1299.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1778.4086,-1299.8924C1908.2039,-1297.3737 2259.9386,-1342.9282 2361.3604,-1261.8924"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1163.24,-1240.2521C1173.7977,-1272.0294 1208.4838,-1361.7937 1273.1147,-1396.8924 1656.685,-1605.1952 1819.2257,-1426.6278 2255.1658,-1404.8924 2333.7463,-1400.9745 2353.4768,-1399.5906 2431.5549,-1389.8924 2469.7627,-1385.1466 2478.8738,-1380.9294 2517.0443,-1375.8924"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M610.0549,-922.9612C647.7261,-923.2466 696.4049,-923.0093 739.5857,-920.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-920.8924C880.4515,-913.9868 1214.5485,-757.5786 1355.2756,-766.8924"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M564.7097,-910.8853C598.8421,-890.1976 672.7149,-845.423 712.6526,-821.2166"/>
<polygon fill="#ff0000" stroke="#ff0000" points="714.5953,-824.1319 721.3329,-815.9555 710.9669,-818.1457 714.5953,-824.1319"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-958.8924C977.464,-961.9144 1136.7665,-997.9495 1159.7117,-994.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-920.8924C788.0302,-918.5175 906.4266,-952.5604 954.5142,-958.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.7117,-994.8924C1200.0105,-989.5232 1245.3965,-989.1769 1282.294,-990.3292"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1282.3465,-993.8332 1292.4646,-990.691 1282.5954,-986.8376 1282.3465,-993.8332"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M552.6094,-933.208C566.7075,-958.4677 604.2082,-1019.8211 652.4517,-1052.8924 665.0167,-1061.5058 680.3915,-1067.5949 694.7092,-1071.8422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="693.8358,-1075.2318 704.4051,-1074.4968 695.6843,-1068.4803 693.8358,-1075.2318"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M1202.512,-1060.8509C1214.0575,-1057.1327 1226.3311,-1052.4785 1237.1147,-1046.8924 1254.8735,-1037.6931 1255.2783,-1028.9402 1273.1147,-1019.8924 1281.3172,-1015.7316 1290.3373,-1012.1244 1299.3048,-1009.0456"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1300.5403,-1012.3244 1308.9735,-1005.911 1298.3815,-1005.6656 1300.5403,-1012.3244"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M971.528,-986.882C1016.8392,-957.7479 1138.4385,-880.861 1159.7117,-880.8924"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1033.6025,-1009.0937C1038.2602,-1011.7766 1042.5644,-1015.0083 1046.3086,-1018.8924 1105.6544,-1080.456 1024.2067,-1145.1535 1082.3086,-1207.8924 1087.076,-1213.0403 1092.9656,-1216.9752 1099.3509,-1219.9752"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1098.3995,-1223.3609 1108.9878,-1223.7341 1100.9432,-1216.8394 1098.3995,-1223.3609"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1000.5859,-767.4269C1042.1908,-768.5009 1105.0826,-769.35 1159.7117,-766.8924"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1159.7117,-766.8924C1246.5412,-762.9862 1268.5481,-761.1525 1355.2756,-766.8924"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M964.9865,-776.9846C984.7367,-798.6462 1027.2137,-848.9281 1046.3086,-899.8924 1070.4861,-964.4222 1037.3324,-1155.6833 1082.3086,-1207.8924 1086.949,-1213.2791 1092.8178,-1217.3524 1099.2402,-1220.4219"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1098.3799,-1223.844 1108.9675,-1224.237 1100.9359,-1217.3273 1098.3799,-1223.844"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1000.3091,-757.4118C1028.2191,-752.2432 1064.3182,-745.5581 1095.1036,-739.857"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1096.1251,-743.2274 1105.3206,-737.965 1094.8504,-736.3445 1096.1251,-743.2274"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M1029.2554,-1168.9478C1035.3522,-1171.6109 1041.144,-1174.8813 1046.3086,-1178.8924 1073.9385,-1200.3514 1052.4452,-1230.6695 1082.3086,-1248.8924 1141.0403,-1284.731 1168.8622,-1257.576 1237.1147,-1248.8924 1428.3064,-1224.5678 1648.5452,-1153.7558 1737.7566,-1123.2018"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1738.9132,-1126.5053 1747.2287,-1119.9399 1736.634,-1119.8867 1738.9132,-1126.5053"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1237.0179,-1198.8978 1082.4054,-1198.8978 1082.4054,-1176.887 1237.0179,-1176.887 1237.0179,-1198.8978"/>
<text text-anchor="middle" x="1159.7117" y="-1184.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M1030.0479,-1168.9355C1044.4394,-1171.0395 1059.596,-1173.2554 1074.2706,-1175.4009"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1073.9364,-1178.8892 1084.3376,-1176.8727 1074.9491,-1171.9628 1073.9364,-1178.8892"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M1032.3462,-1187.7638C1037.4231,-1185.0816 1042.156,-1181.8289 1046.3086,-1177.8924 1088.5758,-1137.824 1043.3496,-1095.1844 1082.3086,-1051.8924 1112.8945,-1017.9047 1229.5069,-988.6409 1273.1147,-974.8924 1308.86,-963.6228 1320.3659,-969.5318 1355.2756,-955.8924"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1223.2144,-1431.8978 1096.209,-1431.8978 1096.209,-1409.887 1223.2144,-1409.887 1223.2144,-1431.8978"/>
<text text-anchor="middle" x="1159.7117" y="-1417.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M978.6415,-1209.9798C998.6067,-1220.0584 1026.7623,-1236.4592 1046.3086,-1256.8924 1068.6007,-1280.1961 1064.4599,-1293.0331 1082.3086,-1319.8924 1102.0128,-1349.5438 1127.582,-1381.8875 1143.824,-1401.7839"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="1141.3185,-1404.2476 1150.3725,-1409.75 1146.7259,-1399.8024 1141.3185,-1404.2476"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M1025.1868,-1265.7441C1032.9716,-1262.2675 1040.2559,-1257.751 1046.3086,-1251.8924 1085.4013,-1214.0538 1043.8795,-1173.4048 1082.3086,-1134.8924 1107.7489,-1109.3969 1130.7196,-1132.2627 1159.7117,-1110.8924"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M1159.7117,-1110.8924C1188.2253,-1089.8749 1209.4364,-1113.9983 1237.1147,-1091.8924 1265.0701,-1069.5653 1245.7801,-1042.9752 1273.1147,-1019.8924 1277.6393,-1016.0717 1282.7376,-1012.8347 1288.1228,-1010.0923"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1289.7141,-1013.2146 1297.4058,-1005.9284 1286.8492,-1006.8277 1289.7141,-1013.2146"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1355.2756,-766.8924C1399.7395,-771.2828 1449.5724,-771.6099 1490.2844,-770.6942"/>
<polygon fill="#002eff" stroke="#002eff" points="1490.5218,-774.1894 1500.4296,-770.4364 1490.3438,-767.1917 1490.5218,-774.1894"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M435.2987,-692.0318C467.0562,-693.3204 509.4246,-693.5766 546.5493,-688.8924"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M546.5493,-688.8924C598.5725,-682.3285 601.3757,-648.7556 652.4517,-636.8924 727.8959,-619.3694 749.5512,-630.2664 826.7197,-636.8924 1011.1484,-652.7282 1061.2423,-650.1551 1237.1147,-707.8924 1292.885,-726.2013 1296.8611,-761.1246 1355.2756,-766.8924"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M954.5142,-688.8924C1011.4235,-686.7357 1075.735,-701.9031 1116.9482,-713.9504"/>
<polygon fill="#002eff" stroke="#002eff" points="1116.0707,-717.3411 1126.6544,-716.8552 1118.0778,-710.635 1116.0707,-717.3411"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M546.5493,-688.8924C726.5492,-667.0718 773.3265,-695.7589 954.5142,-688.8924"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="609.9631,-376.8978 483.1356,-376.8978 483.1356,-354.887 609.9631,-354.887 609.9631,-376.8978"/>
<text text-anchor="middle" x="546.5493" y="-362.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M392.3902,-677.774C415.6593,-630.698 506.2629,-447.3965 536.5936,-386.0339"/>
<polygon fill="#002eff" stroke="#002eff" points="539.7832,-387.4796 541.0768,-376.964 533.5079,-384.3778 539.7832,-387.4796"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M1355.2756,-955.8924C1448.1021,-920.8949 1527.5572,-826.591 1558.5946,-785.9527"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1561.4223,-788.0159 1564.6309,-777.9186 1555.8258,-783.8111 1561.4223,-788.0159"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M1159.7117,-880.8924C1195.7287,-880.9456 1203.3317,-892.4049 1237.1147,-904.8924 1290.7656,-924.7239 1301.7544,-976.0711 1355.2756,-955.8924"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M990.4469,-908.7879C1031.1072,-897.2283 1099.5163,-880.8035 1159.7117,-880.8924"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M984.6076,-931.041C1005.3492,-940.339 1031.7137,-955.6777 1046.3086,-977.8924 1103.1212,-1064.3662 1013.2662,-1130.8305 1082.3086,-1207.8924 1086.9905,-1213.1181 1092.8283,-1217.1003 1099.1854,-1220.1259"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1098.2099,-1223.5032 1108.797,-1223.9079 1100.773,-1216.9893 1098.2099,-1223.5032"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge119" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M961.7408,-908.767C983.8032,-875.0947 1050.7009,-775.2202 1082.3086,-752.8924 1087.8882,-748.951 1094.123,-745.6064 1100.5661,-742.7739"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1102.1047,-745.9287 1110.103,-738.9805 1099.5175,-739.4243 1102.1047,-745.9287"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge121" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M995.6476,-1034.6248C1012.1741,-1031.6316 1030.9166,-1026.5425 1046.3086,-1017.8924 1066.3103,-1006.6518 1061.6014,-990.7732 1082.3086,-980.8924 1192.2592,-928.4278 1241.2819,-998.8704 1355.2756,-955.8924"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge120" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M981.8637,-1049.9742C1002.3177,-1059.5658 1029.5397,-1075.3062 1046.3086,-1096.8924 1078.1253,-1137.8494 1044.754,-1172.1233 1082.3086,-1207.8924 1087.2537,-1212.6024 1093.1451,-1216.2785 1099.4388,-1219.1439"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1098.2945,-1222.4538 1108.8841,-1222.788 1100.8142,-1215.923 1098.2945,-1222.4538"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge124" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M419.8309,-910.8515C427.3016,-907.2472 434.7589,-902.6476 440.647,-896.8924 466.5168,-871.6062 448.7245,-846.8919 476.647,-823.8924 501.4972,-803.4235 515.5565,-813.6076 546.5493,-804.8924"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge123" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M429.0723,-932.9668C443.9962,-936.4383 460.9705,-939.8843 476.647,-941.8924 687.4442,-968.8956 743.8132,-931.1482 954.5142,-958.8924"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge125" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M404.433,-933.0702C422.2812,-944.2485 450.9054,-961.638 476.647,-974.8924 552.6447,-1014.0238 572.5794,-1022.44 652.4517,-1052.8924 666.0713,-1058.0851 681.1186,-1063.1517 694.8215,-1067.5157"/>
<polygon fill="#ff008b" stroke="#ff008b" points="693.9329,-1070.9051 704.5222,-1070.5611 696.0296,-1064.2265 693.9329,-1070.9051"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge122" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M440.5014,-921.8924C451.0437,-921.8924 462.2723,-921.8924 473.3306,-921.8924"/>
<polygon fill="#ff008b" stroke="#ff008b" points="473.4137,-925.3925 483.4137,-921.8924 473.4137,-918.3925 473.4137,-925.3925"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212.5044,-1176.8847C1221.3448,-1173.4145 1229.9568,-1168.8615 1237.1147,-1162.8924 1263.0764,-1141.2428 1246.8503,-1117.1738 1273.1147,-1095.8924 1302.6718,-1071.9431 1323.3243,-1092.5396 1355.2756,-1071.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1355.2756,-1071.8924C1387.227,-1051.2453 1408.4248,-1072.4996 1437.4365,-1047.8924 1521.6607,-976.4552 1557.4415,-840.3984 1568.4981,-788.1006"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1571.989,-788.4956 1570.542,-778 1565.1281,-787.1072 1571.989,-788.4956"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1177.0725,-1176.7609C1193.9614,-1165.2921 1219.5715,-1146.1337 1237.1147,-1124.8924 1258.6411,-1098.8284 1251.2126,-1083.6414 1273.1147,-1057.8924 1288.7842,-1039.4708 1310.6779,-1023.0107 1327.9249,-1011.5388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1329.9711,-1014.3835 1336.4628,-1006.0104 1326.1664,-1008.5077 1329.9711,-1014.3835"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1355.2756,-1071.8924C1395.8242,-1045.6897 1525.5028,-1060.9596 1572.5266,-1071.8924"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1355.2756,-1147.8924C1544.173,-1174.8293 1768.944,-1154.3083 1887.0264,-1139.5338"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1887.5963,-1142.9896 1897.0758,-1138.2579 1886.7146,-1136.0454 1887.5963,-1142.9896"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1197.8796,-1176.8014C1245.8389,-1163.4406 1325.4749,-1143.3175 1355.2756,-1147.8924"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1619.8404,-1387.8978 1525.2129,-1387.8978 1525.2129,-1365.887 1619.8404,-1365.887 1619.8404,-1387.8978"/>
<text text-anchor="middle" x="1572.5266" y="-1373.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1355.2756,-1147.8924C1467.426,-1163.8851 1540.1128,-1303.3688 1563.9418,-1356.4788"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1560.8417,-1358.1253 1568.0534,-1365.8869 1567.2559,-1355.3221 1560.8417,-1358.1253"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1584.9514,-1365.8098C1604.5908,-1347.9594 1643.4642,-1311.2528 1671.6167,-1275.8924 1711.2452,-1226.1179 1749.3317,-1161.1396 1767.436,-1128.8756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1770.5895,-1130.4062 1772.3926,-1119.9659 1764.4724,-1127.0031 1770.5895,-1130.4062"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2361.3604,-1375.8924C2532.8263,-1365.4681 2639.8514,-720.6962 2659.1002,-595.0011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.5673,-595.4815 2660.6025,-585.0705 2655.646,-594.4344 2662.5673,-595.4815"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1619.7825,-1380.5102C1768.0072,-1391.2839 2222.176,-1419.7734 2361.3604,-1375.8924"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2361.3604,-1375.8924C2426.167,-1351.6488 2448.4174,-1384.7243 2517.0443,-1375.8924"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1223.2471,-1416.5057C1279.6105,-1412.3512 1364.134,-1405.4778 1437.4365,-1396.8924 1462.9859,-1393.9 1491.1445,-1389.8515 1515.1111,-1386.1797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1515.7588,-1389.6212 1525.106,-1384.6333 1514.6884,-1382.7035 1515.7588,-1389.6212"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1408.2681,-1387.8978 1302.2832,-1387.8978 1302.2832,-1365.887 1408.2681,-1365.887 1408.2681,-1387.8978"/>
<text text-anchor="middle" x="1355.2756" y="-1373.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1208.8083,-1409.8462C1235.3105,-1403.8834 1268.2189,-1396.4793 1296.125,-1390.2007"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1297.171,-1393.553 1306.1588,-1387.9432 1295.6344,-1386.7237 1297.171,-1393.553"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1408.4212,-1376.8924C1440.613,-1376.8924 1481.6911,-1376.8924 1514.6954,-1376.8924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1515.1059,-1380.3925 1525.1058,-1376.8924 1515.1058,-1373.3925 1515.1059,-1380.3925"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2171.8206,-149.8924C2289.4299,-186.6679 2338.1639,-166.5028 2431.5549,-246.8924 2474.2402,-283.6353 2499.7557,-347.2208 2510.7127,-380.0065"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2507.4867,-381.4083 2513.8742,-389.861 2514.1521,-379.2699 2507.4867,-381.4083"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-650.8924C789.4316,-683.2107 806.2335,-684.4971 862.7197,-702.8924 942.404,-728.8424 972.7922,-705.664 1046.3086,-745.8924 1065.8847,-756.6045 1064.3517,-767.6438 1082.3086,-780.8924 1227.0315,-887.6694 1285.1875,-879.1518 1437.4365,-974.8924 1500.0077,-1014.2398 1500.5144,-1055.2306 1572.5266,-1071.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1572.5266,-1071.8924C1621.792,-1081.307 1677.8242,-1091.3325 1718.9826,-1098.5695"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1718.3935,-1102.0195 1728.848,-1100.3008 1719.6035,-1095.1249 1718.3935,-1102.0195"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2171.8206,-73.8924C2286.9786,-85.544 2322.3791,-54.4508 2431.5549,-92.8924 2475.0999,-108.2249 2480.9766,-123.0764 2517.0443,-151.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M553.0704,-354.7644C574.7798,-318.6729 648.4202,-203.6922 739.5857,-142.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-142.8924C798.0062,-103.9308 798.3322,-71.9141 862.7197,-43.8924 985.0131,9.3301 1026.3389,-.8924 1159.7117,-.8924 1159.7117,-.8924 1159.7117,-.8924 1778.4086,-.8924 1901.7061,-.8924 1931.6588,-19.2824 2052.4753,-43.8924 2106.0673,-54.809 2117.5699,-66.9548 2171.8206,-73.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2517.0443,-151.8924C2583.5221,-204.1442 2642.1857,-474.0594 2658.0353,-552.4951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2654.6685,-553.5085 2660.059,-562.6295 2661.533,-552.1377 2654.6685,-553.5085"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-142.8924C1088.8238,-152.0137 1140.0836,-158.5797 1237.1147,-251.8924 1263.1892,-276.9676 1243.7755,-303.7299 1273.1147,-324.8924 1399.6926,-416.1936 1813.7926,-403.0368 1968.8379,-420.8924"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2171.8206,-149.8924C2240.019,-169.6289 2307.8833,-221.2326 2340.8167,-248.8446"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2338.9022,-251.8115 2348.7841,-255.6324 2343.4418,-246.483 2338.9022,-251.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-142.8924C1495.0862,-165.2465 1652.1121,.5101 2171.8206,-149.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-142.8924C819.0571,-89.8916 859.2587,-135.7377 954.5142,-142.8924"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node35" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node35"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="826.854,-376.8978 652.3174,-376.8978 652.3174,-354.887 826.854,-354.887 826.854,-376.8978"/>
<text text-anchor="middle" x="739.5857" y="-362.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M609.7566,-365.8924C620.1956,-365.8924 631.2271,-365.8924 642.2725,-365.8924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="642.4036,-369.3925 652.4035,-365.8924 642.4035,-362.3925 642.4036,-369.3925"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node36" class="node">
<title>sourcefile~economiclifecyclecost.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node36"><a xlink:href="../sourcefile/economiclifecyclecost.f90.html" xlink:title="EconomicLifeCycleCost.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2431.7501,-623.8978 2290.9707,-623.8978 2290.9707,-601.887 2431.7501,-601.887 2431.7501,-623.8978"/>
<text text-anchor="middle" x="2361.3604" y="-609.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicLifeCycleCost.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M550.3736,-376.9868C565.9519,-420.3665 629.1092,-579.6172 739.5857,-650.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.5857,-650.8924C817.4352,-701.1179 1479.8814,-612.8924 1572.5266,-612.8924 1572.5266,-612.8924 1572.5266,-612.8924 1968.8379,-612.8924 2076.7738,-612.8924 2201.405,-612.8924 2280.7549,-612.8924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2281.1634,-616.3925 2291.1634,-612.8924 2281.1634,-609.3925 2281.1634,-616.3925"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node37" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node37"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1044.6656,-268.8978 864.3627,-268.8978 864.3627,-246.887 1044.6656,-246.887 1044.6656,-268.8978"/>
<text text-anchor="middle" x="954.5142" y="-254.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M584.8555,-354.7706C644.1836,-337.6771 761.9669,-304.2663 862.7197,-278.8924 872.9314,-276.3207 883.8159,-273.7136 894.388,-271.2518"/>
<polygon fill="#ff0000" stroke="#ff0000" points="895.4396,-274.6011 904.3963,-268.9418 893.8653,-267.7804 895.4396,-274.6011"/>
</g>
<!-- sourcefile~economictariff.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node38" class="node">
<title>sourcefile~economictariff.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node38"><a xlink:href="../sourcefile/economictariff.f90.html" xlink:title="EconomicTariff.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2221.0048,-584.8978 2122.6363,-584.8978 2122.6363,-562.887 2221.0048,-562.887 2221.0048,-584.8978"/>
<text text-anchor="middle" x="2171.8206" y="-570.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicTariff.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M565.7694,-377.0032C622.9381,-408.9684 797.7,-498.8924 954.5142,-498.8924 954.5142,-498.8924 954.5142,-498.8924 1159.7117,-498.8924 1522.4872,-498.8924 1956.4103,-547.4067 2112.3729,-566.3977"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2112.3279,-569.9182 2122.6791,-567.659 2113.1784,-562.97 2112.3279,-569.9182"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node39" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node39"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="792.4481,-252.8978 686.7233,-252.8978 686.7233,-230.887 792.4481,-230.887 792.4481,-252.8978"/>
<text text-anchor="middle" x="739.5857" y="-238.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M558.9074,-354.6872C578.0004,-337.738 616.2574,-305.1968 652.4517,-282.8924 668.2458,-273.1594 686.7196,-264.1606 702.5823,-257.0882"/>
<polygon fill="#ff0000" stroke="#ff0000" points="704.3099,-260.153 712.0743,-252.9443 701.5092,-253.7377 704.3099,-260.153"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-460.8924C1062.7869,-497.2714 1351.3414,-561.8321 1437.4365,-636.8924 1462.6221,-658.8499 1450.7015,-678.4065 1473.4365,-702.8924 1492.1666,-723.0649 1518.5454,-739.6978 1539.3775,-750.9468"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1538.0287,-754.1913 1548.5112,-755.7298 1541.276,-747.9901 1538.0287,-754.1913"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.2425,-377.2289C768.5754,-399.2294 814.3462,-447.9165 862.7197,-474.8924 1006.6065,-555.1322 1457.7498,-570.7057 1572.5266,-688.8924"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-218.8924C995.4474,-211.1324 1010.4283,-216.7181 1046.3086,-237.8924 1067.482,-250.3876 1063.0301,-264.6352 1082.3086,-279.8924 1085.6546,-282.5405 1351.1275,-419.8917 1355.2756,-420.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1355.2756,-420.8924C1429.6732,-442.5374 1975.6969,-445.3119 2052.4753,-434.8924 2079.1959,-431.2662 2108.3845,-423.2706 2131.2071,-416.0582"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2132.4554,-419.333 2140.8923,-412.9244 2130.3004,-412.673 2132.4554,-419.333"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-218.8924C1462.5182,-113.5546 2095.4393,-215.9306 2296.7573,-253.9602"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2296.1034,-257.3985 2306.5815,-255.8299 2297.4122,-250.5219 2296.1034,-257.3985"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M746.6808,-354.8545C763.4966,-329.6721 808.4603,-267.8478 862.7197,-237.8924 899.1928,-217.7564 913.7263,-227.3834 954.5142,-218.8924"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M759.2244,-354.7473C777.2915,-344.206 804.5598,-327.559 826.7197,-310.8924 843.8282,-298.025 843.69,-288.6975 862.7197,-278.8924 867.6245,-276.3652 872.8314,-274.1394 878.1757,-272.1794"/>
<polygon fill="#ff0000" stroke="#ff0000" points="879.5306,-275.4171 887.9079,-268.9308 877.3142,-268.7772 879.5306,-275.4171"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node40" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node40"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1633.854,-316.8978 1511.1993,-316.8978 1511.1993,-294.887 1633.854,-294.887 1633.854,-316.8978"/>
<text text-anchor="middle" x="1572.5266" y="-302.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.7117,-265.8924C1281.8081,-285.8812 1314.4797,-271.1553 1437.4365,-284.8924 1458.2143,-287.2138 1480.6874,-290.4239 1501.2291,-293.6364"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1500.7172,-297.0989 1511.1422,-295.2098 1501.8145,-290.1854 1500.7172,-297.0989"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-218.8924C969.7606,-216.002 1154.5017,-264.9313 1159.7117,-265.8924"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node41" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node41"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1028.4124,-350.8978 880.6159,-350.8978 880.6159,-328.887 1028.4124,-328.887 1028.4124,-350.8978"/>
<text text-anchor="middle" x="954.5142" y="-336.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.0053,-355.3172C841.3139,-353.5863 856.114,-351.7959 870.3418,-350.0748"/>
<polygon fill="#ff0000" stroke="#ff0000" points="871.0783,-353.5113 880.5856,-348.8356 870.2376,-346.562 871.0783,-353.5113"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node42" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node42"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1671.7069,-470.8978 1473.3464,-470.8978 1473.3464,-448.887 1671.7069,-448.887 1671.7069,-470.8978"/>
<text text-anchor="middle" x="1572.5266" y="-456.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1355.2756,-420.8924C1398.889,-431.4137 1448.0498,-440.4685 1488.5621,-447.1977"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1488.2316,-450.6902 1498.6668,-448.8578 1489.3665,-443.7828 1488.2316,-450.6902"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node43" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node43"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1410.3286,-315.8978 1300.2226,-315.8978 1300.2226,-293.887 1410.3286,-293.887 1410.3286,-315.8978"/>
<text text-anchor="middle" x="1355.2756" y="-301.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.7117,-265.8924C1205.1882,-273.3375 1256.2433,-283.5839 1294.7816,-291.7057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1294.2921,-295.1797 1304.8004,-293.8287 1295.7432,-288.3317 1294.2921,-295.1797"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node44" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node44"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1017.9758,-309.8978 891.0525,-309.8978 891.0525,-287.887 1017.9758,-287.887 1017.9758,-309.8978"/>
<text text-anchor="middle" x="954.5142" y="-295.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M766.1395,-354.8042C790.8444,-344.7691 828.8373,-330.0481 862.7197,-319.8924 871.7854,-317.1751 881.445,-314.6129 890.9664,-312.2746"/>
<polygon fill="#ff0000" stroke="#ff0000" points="891.8958,-315.6511 900.8079,-309.9218 890.2681,-308.843 891.8958,-315.6511"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node45" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node45"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1046.1035,-432.8978 862.9248,-432.8978 862.9248,-410.887 1046.1035,-410.887 1046.1035,-432.8978"/>
<text text-anchor="middle" x="954.5142" y="-418.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M776.6288,-376.9655C801.0034,-384.1171 833.6565,-393.4429 862.7197,-400.8924 872.8005,-403.4763 883.5437,-406.0737 893.9965,-408.518"/>
<polygon fill="#ff0000" stroke="#ff0000" points="893.3666,-411.9647 903.8982,-410.8092 894.9447,-405.1449 893.3666,-411.9647"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node46" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node46"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1437.5977,-470.8978 1272.9535,-470.8978 1272.9535,-448.887 1437.5977,-448.887 1437.5977,-470.8978"/>
<text text-anchor="middle" x="1355.2756" y="-456.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M753.8541,-377.0366C775.9226,-393.711 820.2355,-424.9955 862.7197,-441.8924 901.4325,-457.2894 914.7083,-448.5943 954.5142,-460.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.5142,-460.8924C1066.0765,-495.36 1203.5968,-484.207 1285.0969,-472.4345"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1285.8649,-475.8588 1295.2403,-470.9241 1284.8339,-468.9351 1285.8649,-475.8588"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node47" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node47"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1018.65,-391.8978 890.3783,-391.8978 890.3783,-369.887 1018.65,-369.887 1018.65,-391.8978"/>
<text text-anchor="middle" x="954.5142" y="-377.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.0053,-371.9935C844.5217,-373.216 862.7747,-374.4899 879.8128,-375.679"/>
<polygon fill="#ff0000" stroke="#ff0000" points="880.0275,-379.2024 890.2469,-376.4072 880.5149,-372.2194 880.0275,-379.2024"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2401.8121,-601.863C2433.1219,-593.5443 2477.6452,-582.1879 2517.0443,-573.8924"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node52" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node52"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1215.4338,-391.8978 1103.9895,-391.8978 1103.9895,-369.887 1215.4338,-369.887 1215.4338,-391.8978"/>
<text text-anchor="middle" x="1159.7117" y="-377.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1029.8728,-268.9457C1035.7678,-271.6153 1041.3476,-274.8874 1046.3086,-278.8924 1075.703,-302.6227 1053.9802,-330.8991 1082.3086,-355.8924 1086.4781,-359.5711 1091.1962,-362.7096 1096.1954,-365.387"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1094.9002,-368.6454 1105.4398,-369.7255 1097.8742,-362.3085 1094.9002,-368.6454"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2221.0731,-580.1982C2288.6511,-587.4293 2413.5292,-595.6876 2517.0443,-573.8924"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2178.7912,-562.602C2207.0078,-516.8991 2312.9666,-345.2763 2349.1563,-286.6594"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2352.251,-288.3094 2354.5262,-277.9617 2346.2947,-284.632 2352.251,-288.3094"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2221.1251,-584.0374C2244.455,-588.8378 2272.6025,-594.6295 2297.5387,-599.7604"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2297.1416,-603.2519 2307.6418,-601.8392 2298.5524,-596.3956 2297.1416,-603.2519"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1778.4086,-344.8924C1809.2511,-357.239 1820.6105,-351.9715 1849.2004,-368.8924 1867.8792,-379.9474 1865.9749,-391.8182 1885.2004,-401.8924 1918.9651,-419.5851 1930.9689,-416.5313 1968.8379,-420.8924"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M762.8247,-230.8043C801.6013,-213.3384 882.3704,-181.3394 954.5142,-180.8924"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M954.5142,-180.8924C1080.1317,-180.1141 1112.459,-160.3583 1237.1147,-175.8924 1434.7901,-200.5259 1501.0621,-182.9677 1671.6167,-285.8924 1692.0944,-298.2501 1687.2276,-313.389 1707.6167,-325.8924 1735.3874,-342.9225 1748.1652,-332.7857 1778.4086,-344.8924"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M753.3182,-252.9248C773.6839,-270.2332 811.1599,-305.9455 826.7197,-345.8924 858.6521,-427.8728 806.3323,-1069.3579 862.7197,-1136.8924 863.7348,-1138.1081 864.8044,-1139.2619 865.9231,-1140.3566"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="863.9564,-1143.2647 873.9592,-1146.757 868.3175,-1137.7891 863.9564,-1143.2647"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M954.5142,-180.8924C996.6691,-179.8092 1013.7727,-178.0665 1046.3086,-204.8924 1074.8367,-228.4139 1056.6191,-253.2999 1082.3086,-279.8924 1136.2603,-335.7407 1183.0164,-305.1862 1237.1147,-360.8924 1262.5952,-387.1302 1245.2996,-411.1437 1273.1147,-434.8924 1277.5458,-438.6757 1282.5386,-441.8865 1287.8183,-444.6114"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1286.3743,-447.7996 1296.9261,-448.7539 1289.2725,-441.4277 1286.3743,-447.7996"/>
</g>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node53" class="node">
<title>sourcefile~weathermanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node53"><a xlink:href="../sourcefile/weathermanager.f90.html" xlink:title="WeatherManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2416.2391,-123.8978 2306.4816,-123.8978 2306.4816,-101.887 2416.2391,-101.887 2416.2391,-123.8978"/>
<text text-anchor="middle" x="2361.3604" y="-109.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WeatherManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M750.3129,-230.868C775.3152,-205.3739 837.2646,-143.4122 862.7197,-128.8924 982.5241,-60.5553 1021.7876,-38.8924 1159.7117,-38.8924 1159.7117,-38.8924 1159.7117,-38.8924 1778.4086,-38.8924 1917.9262,-38.8924 1950.0298,-70.6301 2088.4753,-87.8924 2159.3613,-96.7309 2240.9728,-103.8019 2296.341,-108.1381"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2296.1248,-111.6317 2306.3656,-108.9157 2296.6663,-104.6527 2296.1248,-111.6317"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1582.4653,-317.0406C1601.0941,-338.2044 1642.0479,-386.0163 1671.6167,-429.8924 1864.7694,-716.5042 1925.8161,-786.3155 2052.4753,-1107.8924 2077.2837,-1170.8786 2042.2432,-1206.4424 2088.4753,-1255.8924 2105.3611,-1273.9535 2492.5214,-1379.0484 2517.0443,-1375.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2517.0443,-1375.8924C2583.1741,-1367.1659 2609.3851,-1378.5876 2662.236,-1337.8924"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.0897,-315.0283C1684.8794,-323.0301 1752.6267,-334.9068 1778.4086,-344.8924"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node48" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node48"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2014.8987,-273.8978 1922.777,-273.8978 1922.777,-251.887 2014.8987,-251.887 2014.8987,-273.8978"/>
<text text-anchor="middle" x="1968.8379" y="-259.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1633.958,-296.0139C1657.0178,-292.5122 1683.4825,-288.7389 1707.6167,-285.8924 1777.9794,-277.5936 1859.3292,-270.8849 1912.3049,-266.8999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1912.7978,-270.3729 1922.5101,-266.1395 1912.2777,-263.3923 1912.7978,-270.3729"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node49" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node49"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1848.9929,-316.8978 1707.8242,-316.8978 1707.8242,-294.887 1848.9929,-294.887 1848.9929,-316.8978"/>
<text text-anchor="middle" x="1778.4086" y="-302.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1633.7406,-305.8924C1653.7058,-305.8924 1676.1918,-305.8924 1697.3792,-305.8924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1697.6593,-309.3925 1707.6592,-305.8924 1697.6592,-302.3925 1697.6593,-309.3925"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1009.7733,-350.9336C1035.8863,-356.1512 1067.2394,-362.4158 1094.5092,-367.8645"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1093.8619,-371.3042 1104.3539,-369.8315 1095.2335,-364.4399 1093.8619,-371.3042"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1578.6935,-471.2233C1595.6146,-502.6995 1643.3842,-594.2009 1671.6167,-674.8924 1725.6462,-829.3147 1763.1169,-1023.7609 1774.6554,-1087.5574"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1771.2453,-1088.3712 1776.4513,-1097.5988 1778.136,-1087.1388 1771.2453,-1088.3712"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1580.4837,-448.7917C1606.8038,-412.197 1690.3561,-297.0559 1707.6167,-285.8924 1766.7562,-247.6432 2106.8726,-188.9886 2291.1658,-165.8924 2341.067,-159.6387 2477.8277,-120.4075 2517.0443,-151.8924"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1409.7925,-315.9166C1429.7418,-319.597 1452.5416,-323.393 1473.4365,-325.8924 1540.8588,-333.9574 1715.089,-320.368 1778.4086,-344.8924"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1410.3781,-305.146C1437.9284,-305.2729 1471.6026,-305.4279 1501.1102,-305.5637"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1501.3407,-309.0647 1511.3568,-305.6109 1501.373,-302.0648 1501.3407,-309.0647"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1018.4499,-308.6248C1028.1222,-311.4701 1037.7248,-315.1455 1046.3086,-319.8924 1066.1099,-330.8427 1063.0052,-344.0865 1082.3086,-355.8924 1088.9157,-359.9333 1096.2443,-363.3902 1103.6821,-366.3278"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1102.5218,-369.6301 1113.1156,-369.7761 1104.925,-363.0556 1102.5218,-369.6301"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1009.7733,-410.8512C1035.8863,-405.6337 1067.2394,-399.3691 1094.5092,-393.9204"/>
<polygon fill="#003fff" stroke="#003fff" points="1095.2335,-397.3449 1104.3539,-391.9533 1093.8619,-390.4806 1095.2335,-397.3449"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1377.4132,-470.9444C1396.3901,-481.6045 1422.8978,-499.5483 1437.4365,-522.8924 1480.5666,-592.1441 1427.5485,-635.4366 1473.4365,-702.8924 1488.2869,-724.7225 1513.3105,-740.7966 1534.4947,-751.3757"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1533.0683,-754.573 1543.6017,-755.7121 1536.0777,-748.2529 1533.0683,-754.573"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1371.9251,-470.9298C1389.1969,-482.7633 1416.5505,-502.6022 1437.4365,-522.8924 1505.6632,-589.1728 1506.2576,-620.6547 1572.5266,-688.8924"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1572.5266,-688.8924C1608.078,-725.5 1640.1665,-706.7066 1671.6167,-746.8924 1756.0304,-854.753 1773.7918,-1027.8189 1777.4678,-1087.6971"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1773.9801,-1088.0206 1778.017,-1097.8161 1780.9698,-1087.6411 1773.9801,-1088.0206"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1417.6922,-448.6996C1425.0621,-445.2473 1431.9118,-440.7491 1437.4365,-434.8924 1484.1852,-385.335 1426.6714,-335.4344 1473.4365,-285.8924 1696.1009,-50.0066 1848.6232,-46.2323 2171.8206,-73.8924"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1437.7187,-459.8924C1446.0875,-459.8924 1454.6767,-459.8924 1463.2713,-459.8924"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1463.3501,-463.3925 1473.35,-459.8924 1463.35,-456.3925 1463.3501,-463.3925"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1018.5959,-380.8924C1042.57,-380.8924 1069.8265,-380.8924 1093.95,-380.8924"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1094.0782,-384.3925 1104.0782,-380.8924 1094.0781,-377.3925 1094.0782,-384.3925"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2015.2148,-264.3296C2056.3709,-265.3167 2118.1239,-266.0927 2171.8206,-263.8924"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2171.8206,-263.8924C2210.3358,-262.3142 2218.3659,-251.3678 2255.1658,-239.8924 2284.4705,-230.7542 2492.6554,-133.2522 2517.0443,-151.8924"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2662.236,-1337.8924C2725.3158,-1294.3 2784.8704,-1051.1436 2801.6038,-977.8232"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2805.0504,-978.4493 2803.8369,-967.9242 2798.222,-976.9088 2805.0504,-978.4493"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1996.6312,-274.073C2015.9752,-283.4645 2040.3864,-298.905 2052.4753,-320.8924 2099.5699,-406.548 2031.1642,-1120.7077 2088.4753,-1199.8924 2167.5213,-1309.1073 2647.4832,-1348.0876 2662.236,-1337.8924"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.1057,-274.0324C2020.5886,-298.3307 2105.1188,-356.2159 2147.1779,-385.0174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2145.2469,-387.9371 2155.4753,-390.6994 2149.202,-382.1614 2145.2469,-387.9371"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2171.8206,-263.8924C2209.3807,-262.3533 2251.1576,-262.7849 2285.9105,-263.7351"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2285.8878,-267.2358 2295.9861,-264.0302 2286.0928,-260.2388 2285.8878,-267.2358"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1968.8379,-420.8924C2015.515,-426.2679 2068.3647,-420.9594 2108.4339,-414.6018"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2109.0371,-418.0497 2118.3341,-412.9687 2107.8977,-411.143 2109.0371,-418.0497"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1825.7257,-316.9247C1834.184,-320.4076 1842.442,-324.9588 1849.2004,-330.8924 1875.7877,-354.2349 1857.3038,-380.1317 1885.2004,-401.8924 1915.2569,-425.3379 1930.9689,-416.5313 1968.8379,-420.8924"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2171.8206,-301.8924C2214.228,-295.9514 2261.6002,-287.2042 2298.3769,-279.9409"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2299.3313,-283.3197 2308.4559,-277.9352 2297.9651,-276.4543 2299.3313,-283.3197"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1849.1723,-310.6262C1928.2448,-314.6529 2059.8703,-317.5759 2171.8206,-301.8924"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1827.4489,-294.8188C1853.4416,-288.9495 1885.492,-281.7124 1912.5024,-275.6133"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1913.6011,-278.9534 1922.5846,-273.3367 1912.0592,-272.1253 1913.6011,-278.9534"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node50" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node50"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2022.5636,-351.8978 1915.1122,-351.8978 1915.1122,-329.887 2022.5636,-329.887 2022.5636,-351.8978"/>
<text text-anchor="middle" x="1968.8379" y="-337.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1838.4002,-316.9186C1859.5762,-320.8106 1883.458,-325.2 1904.9449,-329.1492"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1904.4852,-332.6232 1914.9532,-330.9887 1905.7506,-325.7386 1904.4852,-332.6232"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_node51" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~heatrecovery.f90~~AfferentGraph_node51"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2052.613,-392.8978 1885.0628,-392.8978 1885.0628,-370.887 2052.613,-370.887 2052.613,-392.8978"/>
<text text-anchor="middle" x="1968.8379" y="-378.7424" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1817.7103,-316.9929C1828.2704,-320.7112 1839.4567,-325.3509 1849.2004,-330.8924 1867.3047,-341.1888 1866.6349,-351.4532 1885.2004,-360.8924 1890.1215,-363.3944 1895.3602,-365.6114 1900.723,-367.5734"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1899.8742,-370.9802 1910.4681,-370.8364 1902.0968,-364.3424 1899.8742,-370.9802"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2015.462,-351.9199C2027.5651,-354.9679 2040.5495,-358.4024 2052.4753,-361.8924 2079.0846,-369.6795 2108.6326,-379.573 2131.6706,-387.5722"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2130.523,-390.8787 2141.1178,-390.8728 2132.8318,-384.2704 2130.523,-390.8787"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2018.6531,-329.8597C2059.6004,-321.1443 2119.225,-309.2607 2171.8206,-301.8924"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2052.5706,-390.1426C2061.1263,-390.9856 2069.8557,-391.8458 2078.5055,-392.698"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2078.3126,-396.1959 2088.6077,-393.6934 2078.9991,-389.2296 2078.3126,-396.1959"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1180.6155,-392.0067C1203.0616,-403.6641 1239.9747,-422.0426 1273.1147,-434.8924 1283.3322,-438.8542 1294.4553,-442.6018 1305.1217,-445.9317"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1304.164,-449.2987 1314.75,-448.8665 1306.205,-442.6028 1304.164,-449.2987"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2377.6134,-123.9252C2393.316,-135.3191 2416.8272,-154.4219 2431.5549,-175.8924 2477.5553,-242.9533 2503.0211,-338.0818 2512.5895,-379.8502"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2509.1943,-380.7067 2514.7771,-389.7113 2516.0282,-379.1906 2509.1943,-380.7067"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2416.4626,-115.9499C2448.5677,-120.1831 2488.2648,-129.8964 2517.0443,-151.8924"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge142" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1009.1235,-1110.0171C1022.3606,-1106.3042 1035.7291,-1100.6111 1046.3086,-1091.8924 1074.2253,-1068.8859 1054.796,-1042.3807 1082.3086,-1018.8924 1109.701,-995.5068 1124.0173,-999.7031 1159.7117,-994.8924"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge144" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1008.9464,-1119.9281C1022.4927,-1123.0454 1036.0566,-1128.5118 1046.3086,-1137.8924 1084.5715,-1172.9028 1041.8429,-1216.4531 1082.3086,-1248.8924 1203.3266,-1345.9066 1623.4889,-1292.3432 1778.4086,-1299.8924"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~heatrecovery.f90~~AfferentGraph_edge143" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1004.7111,-1105.8842C1033.9192,-1099.4788 1070.8725,-1091.3749 1101.371,-1084.6866"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1102.4279,-1088.0381 1111.446,-1082.4771 1100.9283,-1081.2005 1102.4279,-1088.0381"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatrecoveryf90AfferentGraph = svgPanZoom('#sourcefileheatrecoveryf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatrecovery.html">HeatRecovery</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html#src">HeatRecovery.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">HeatRecovery</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="c">! Module containing the routines dealing with heat recovery from exhaust or relief air</span>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>  <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-7"></a>  <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-8"></a>  <span class="c">!       MODIFIED       F Buhl Nov 2000, D Shirey Feb 2003, R. Raustad April 2003</span>
<a name="ln-9"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>  <span class="c">! To encapsulate the data and routines required to model heat</span>
<a name="ln-13"></a>  <span class="c">! recovery components in the EnergyPlus HVAC simulation</span>
<a name="ln-14"></a>
<a name="ln-15"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-16"></a>  <span class="c">! Heat exchanger effectiveness - NTU models are used.</span>
<a name="ln-17"></a>
<a name="ln-18"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-19"></a>  <span class="c">! M. Wetter, Simulation Model Air-to-Air Plate Heat Exchanger,LBNL Report 42354, 1999.</span>
<a name="ln-20"></a>  <span class="c">!</span>
<a name="ln-21"></a>  <span class="c">! ARI Standard 1060-2001,Rating Air-to-Air Heat Exchangers for Energy Recovery Ventilation Equipment, www.ari.org</span>
<a name="ln-22"></a>  <span class="c">! ASHRAE Standard 84, Method of Testing Air-To-Air Heat Exchangers, www.ashrae.org</span>
<a name="ln-23"></a>  <span class="c">! U.S. Environmental Protection Agency software &quot;SAVES&quot; -</span>
<a name="ln-24"></a>  <span class="c">!  School Advanced Ventilation Engineering Software http://www.epa.gov/iaq/schooldesign/saves.html</span>
<a name="ln-25"></a>
<a name="ln-26"></a>
<a name="ln-27"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-28"></a>
<a name="ln-29"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-30"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-31"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-32"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-33"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">SysSizingCalc</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-34"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-35"></a>                         <span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowContinueErrorTimeStamp</span>
<a name="ln-36"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-37"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">CurMnDy</span><span class="p">,</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">StdRhoAir</span>
<a name="ln-38"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-39"></a>
<a name="ln-40"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-41"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-42"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-43"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-44"></a>
<a name="ln-45"></a>  <span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-46"></a>
<a name="ln-47"></a>  <span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-48"></a>
<a name="ln-49"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-50"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">KELVZERO</span> <span class="o">=</span> <span class="mi">27</span><span class="mf">3.16d0</span>
<a name="ln-51"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SMALL</span> <span class="o">=</span> <span class="mf">1.d-10</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="c">! Heat exchanger performance data type</span>
<a name="ln-54"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">BALANCEDHX_PERFDATATYPE1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-55"></a>
<a name="ln-56"></a><span class="c">! Heat exchanger configurations</span>
<a name="ln-57"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Counter_Flow</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-58"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Parallel_Flow</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-59"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Cross_Flow_Both_Unmixed</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-60"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Cross_Flow_Other</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-61"></a>
<a name="ln-62"></a><span class="c">! Heat exchanger configuration types</span>
<a name="ln-63"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Plate</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-64"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Rotary</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-65"></a>
<a name="ln-66"></a><span class="c">! Economizer lockout operation</span>
<a name="ln-67"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EconoLockOut_No</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-68"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EconoLockOut_Yes</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-69"></a>
<a name="ln-70"></a>  <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-71"></a>
<a name="ln-72"></a>  <span class="k">TYPE </span><span class="n">HeatExchCond</span>
<a name="ln-73"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>            <span class="c">! name of component</span>
<a name="ln-74"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ExchTypeNum</span> <span class="o">=</span> <span class="mi">0</span>            <span class="c">! Integer equivalent to ExchType</span>
<a name="ln-75"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatExchPerfTypeNum</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Desiccant balanced heat exchanger performance data type num</span>
<a name="ln-76"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatExchPerfName</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Desiccant balanced heat exchanger performance data name</span>
<a name="ln-77"></a>
<a name="ln-78"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SchedPtr</span><span class="o">=</span><span class="mi">0</span>                  <span class="c">! index of schedule</span>
<a name="ln-79"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FlowArr</span><span class="o">=</span><span class="mi">0</span>                   <span class="c">! flow Arrangement:</span>
<a name="ln-80"></a>                                           <span class="c">! 1: COUNTER_FLOW</span>
<a name="ln-81"></a>                                           <span class="c">! 2: PARALLEL_FLOW</span>
<a name="ln-82"></a>                                           <span class="c">! 3: CROSS_FLOW_BOTH_UNMIXED</span>
<a name="ln-83"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EconoLockOut</span>       <span class="o">=</span><span class="mi">0</span>       <span class="c">! 1: Yes;  0: No</span>
<a name="ln-84"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">hARatio</span>            <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! ratio of supply side h*A to secondary side h*A</span>
<a name="ln-85"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSupAirVolFlow</span>   <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal supply air volume flow rate (m3/s)</span>
<a name="ln-86"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSupAirInTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal supply air inlet temperature (C)</span>
<a name="ln-87"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSupAirOutTemp</span>   <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal supply air outlet temperature (C)</span>
<a name="ln-88"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSecAirVolFlow</span>   <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal secondary air volume flow rate (m3/s)</span>
<a name="ln-89"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSecAirInTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal secondary air inlet temperature (C)</span>
<a name="ln-90"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomElecPower</span>       <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal electric power consumption [W]</span>
<a name="ln-91"></a>
<a name="ln-92"></a>    <span class="c">! values describing nominal condition (derived from input parameters)</span>
<a name="ln-93"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UA0</span>                <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! (Uavg*A) at nominal condition</span>
<a name="ln-94"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">mTSup0</span>             <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! product mDot*Tabs, supply  air, nominal cond.</span>
<a name="ln-95"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">mTSec0</span>             <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! product mDot*Tabs, exhaust air, nominal cond</span>
<a name="ln-96"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSupAirMassFlow</span>  <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal supply air mass flow rate (kg/s)</span>
<a name="ln-97"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NomSecAirMassFlow</span>  <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! nominal secondary air mass flow rate (kg/s)</span>
<a name="ln-98"></a>
<a name="ln-99"></a>    <span class="c">! Nodes</span>
<a name="ln-100"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SupInletNode</span>       <span class="o">=</span><span class="mi">0</span>       <span class="c">! supply air inlet node number</span>
<a name="ln-101"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SupOutletNode</span>      <span class="o">=</span><span class="mi">0</span>       <span class="c">! supply air outlet node number</span>
<a name="ln-102"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SecInletNode</span>       <span class="o">=</span><span class="mi">0</span>       <span class="c">! secondary air inlet node number</span>
<a name="ln-103"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SecOutletNode</span>      <span class="o">=</span><span class="mi">0</span>       <span class="c">! secondary air outlet node number</span>
<a name="ln-104"></a>
<a name="ln-105"></a>    <span class="c">! inlet conditions</span>
<a name="ln-106"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupInTemp</span>          <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! supply air inlet temperature (C)</span>
<a name="ln-107"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupInHumRat</span>        <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! supply air inlet humidity ratio (kg water/kg dry air)</span>
<a name="ln-108"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupInEnth</span>          <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! supply air inlet enthalpy (J/kg)</span>
<a name="ln-109"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupInMassFlow</span>      <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! supply air inlet mass flow rate (kg/s)</span>
<a name="ln-110"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecInTemp</span>          <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! secondary air inlet temperature (C)</span>
<a name="ln-111"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecInHumRat</span>        <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! secondary air inlet humidity ratio (kg water/kg dry air)</span>
<a name="ln-112"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecInEnth</span>          <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! secondary air inlet enthalpy (J/kg)</span>
<a name="ln-113"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecInMassFlow</span>      <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! secondary air inlet mass flow rate (kg/s)</span>
<a name="ln-114"></a>
<a name="ln-115"></a>    <span class="c">! balanced desiccant inputs</span>
<a name="ln-116"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PerfDataIndex</span>    <span class="o">=</span><span class="mi">0</span>            <span class="c">! Performance data index allocating performance data number to heat exchanger</span>
<a name="ln-117"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FaceArea</span>         <span class="o">=</span><span class="mf">0.0d0</span>          <span class="c">! face area of balanced desiccant heat exchangers to determine face velocity [m2]</span>
<a name="ln-118"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UnbalancedWarningFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Used to print one-time warning when unbalanced flow exists (then set to FALSE)</span>
<a name="ln-119"></a>
<a name="ln-120"></a>    <span class="c">! generic hx performance inputs</span>
<a name="ln-121"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatEffectSensible100</span><span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! heating sensible effectiveness at 100% rated air flow</span>
<a name="ln-122"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatEffectSensible75</span> <span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! heating sensible effectiveness at 75% rated air flow</span>
<a name="ln-123"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatEffectLatent100</span>  <span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! heating latent effectiveness at 100% rated air flow</span>
<a name="ln-124"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatEffectLatent75</span>   <span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! heating latent effectiveness at 75% rated air flow</span>
<a name="ln-125"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolEffectSensible100</span><span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! cooling sensible effectiveness at 100% rated air flow</span>
<a name="ln-126"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolEffectSensible75</span> <span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! cooling sensible effectiveness at 75% rated air flow</span>
<a name="ln-127"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolEffectLatent100</span>  <span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! cooling latent effectiveness at 100% rated air flow</span>
<a name="ln-128"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolEffectLatent75</span>   <span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! cooling latent effectiveness at 75% rated air flow</span>
<a name="ln-129"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatExchEconoMode</span>    <span class="o">=</span><span class="mi">0</span>             <span class="c">! generic heat exchanger economize mode option</span>
<a name="ln-130"></a>                                                   <span class="c">! 1 = None, 2 = Bypass, 3 = Stop Rotary HX Rotation</span>
<a name="ln-131"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ExchConfigNum</span>        <span class="o">=</span> <span class="mi">0</span>            <span class="c">! parameter equivalent of HX configuration, plate or rotary</span>
<a name="ln-132"></a>
<a name="ln-133"></a>    <span class="c">! frost control parameters</span>
<a name="ln-134"></a>    <span class="kt">Character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FrostControlType</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! type of frost control used if any</span>
<a name="ln-135"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ThresholdTemperature</span>      <span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! threshold temperature for frost control</span>
<a name="ln-136"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InitialDefrostTime</span>        <span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! initial defrost time</span>
<a name="ln-137"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RateofDefrostTimeIncrease</span> <span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! rate of change of defrost time</span>
<a name="ln-138"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DefrostFraction</span>           <span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! fraction of time HX is in frost control mode</span>
<a name="ln-139"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ControlToTemperatureSetpoint</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>      <span class="c">! temperature control flag for generic HX</span>
<a name="ln-140"></a>
<a name="ln-141"></a>    <span class="c">! outlet conditions</span>
<a name="ln-142"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupOutTemp</span>       <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! supply air outlet temperature (C)</span>
<a name="ln-143"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupOutHumRat</span>     <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! supply air outlet humidity ratio (kg water/kg dry air)</span>
<a name="ln-144"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupOutEnth</span>       <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! supply air outlet enthalpy (J/kg)</span>
<a name="ln-145"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupOutMassFlow</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! supply air outlet mass flow rate (kg/s)</span>
<a name="ln-146"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecOutTemp</span>       <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! secondary air outlet temperature (C)</span>
<a name="ln-147"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecOutHumRat</span>     <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! secondary air outlet humidity ratio (kg water/kg dry air)</span>
<a name="ln-148"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecOutEnth</span>       <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! secondary air outlet enthalpy (J/kg)</span>
<a name="ln-149"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecOutMassFlow</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! secondary air outlet mass flow rate (kg/s)</span>
<a name="ln-150"></a>
<a name="ln-151"></a>    <span class="c">! report values</span>
<a name="ln-152"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensHeatingRate</span>  <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! rate of sensible heat being added to the supply (primary) air [W]</span>
<a name="ln-153"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensHeatingEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! sensible heat added to the supply (primary) air [J]</span>
<a name="ln-154"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatHeatingRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! rate of latent heat being added to the supply (primary) air [W]</span>
<a name="ln-155"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatHeatingEnergy</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! latent heat added to the supply (primary) air [J]</span>
<a name="ln-156"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotHeatingRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! rate of total heat being added to the supply (primary) air [W]</span>
<a name="ln-157"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotHeatingEnergy</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! total heat added to the supply (primary) air [J]</span>
<a name="ln-158"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensCoolingRate</span>  <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! rate of sensible heat being removed from the supply (primary) air [W]</span>
<a name="ln-159"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensCoolingEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! sensible heat removed from the supply (primary) air [J]</span>
<a name="ln-160"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatCoolingRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! rate of latent heat being removed from the supply (primary) air [W]</span>
<a name="ln-161"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatCoolingEnergy</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! latent heat removed from the supply (primary) air [J]</span>
<a name="ln-162"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotCoolingRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! rate of total heat being removed from the supply (primary) air [W]</span>
<a name="ln-163"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotCoolingEnergy</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! total heat removed from the supply (primary) air [J]</span>
<a name="ln-164"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecUseEnergy</span>    <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! electricity consumption [J]</span>
<a name="ln-165"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecUseRate</span>      <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! electricity consumption rate [W]</span>
<a name="ln-166"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensEffectiveness</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! heat exchanger sensible effectiveness [-]</span>
<a name="ln-167"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatEffectiveness</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! heat exchanger latent effectiveness [-]</span>
<a name="ln-168"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupBypassMassFlow</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! supply air mass flow rate bypassing the heat exchanger [kg/s]</span>
<a name="ln-169"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecBypassMassFlow</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! secondary air mass flow rate bypassing the heat exchanger [kg/s]</span>
<a name="ln-170"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LowFlowErrCount</span>       <span class="o">=</span><span class="mi">0</span>         <span class="c">! Counter for recurring warning message</span>
<a name="ln-171"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LowFlowErrIndex</span>       <span class="o">=</span><span class="mi">0</span>         <span class="c">! Index to recurring warning message</span>
<a name="ln-172"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UnBalancedErrCount</span>    <span class="o">=</span><span class="mi">0</span>         <span class="c">! Counter for recurring warning message</span>
<a name="ln-173"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UnBalancedErrIndex</span>    <span class="o">=</span><span class="mi">0</span>         <span class="c">! Index to recurring warning message</span>
<a name="ln-174"></a>
<a name="ln-175"></a>  <span class="k">END TYPE </span><span class="n">HeatExchCond</span>
<a name="ln-176"></a>
<a name="ln-177"></a>  <span class="k">TYPE </span><span class="n">BalancedDesDehumPerfData</span>
<a name="ln-178"></a>  <span class="c">! User Input data</span>
<a name="ln-179"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>                   <span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! unique name of balanced desiccant performance data type object</span>
<a name="ln-180"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PerfType</span>               <span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! Type of performance data set</span>
<a name="ln-181"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NomSupAirVolFlow</span>       <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! nominal supply air volumetric flow rate m^3/s</span>
<a name="ln-182"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NomProcAirFaceVel</span>      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! nominal process air face velocity m/s</span>
<a name="ln-183"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NomElecPower</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! nominal electric power consumption [W]</span>
<a name="ln-184"></a>
<a name="ln-185"></a> <span class="c">! regeneration outlet temperature equation coefficients and limits</span>
<a name="ln-186"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B1</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! constant coefficient for outlet regeneration temprature equation</span>
<a name="ln-187"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B2</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! regen inlet humrat coeff for outlet regen temperature equation</span>
<a name="ln-188"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B3</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! regen inlet temp coeff for outlet regen temprature equation</span>
<a name="ln-189"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B4</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! (regen in humrat/regen in temp) coeff for outlet regen temp eq</span>
<a name="ln-190"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B5</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! process inlet humrat coeff for outlet regen temp equation</span>
<a name="ln-191"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B6</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! process inlet temp coeff for outlet regen temp equation</span>
<a name="ln-192"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B7</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! (process in humrat/proc in temp) coeff for outlet regen temp eq</span>
<a name="ln-193"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">B8</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! process, regen face velocity coeff for outlet regen temp eq</span>
<a name="ln-194"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinRegenAirInTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen inlet air temperature [C]</span>
<a name="ln-195"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxRegenAirInTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen inlet air temperature [C]</span>
<a name="ln-196"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinRegenAirInHumRat</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen inlet air humidity ratio [kg water / kg air]</span>
<a name="ln-197"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxRegenAirInHumRat</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen inlet air humidity ratio [kg water / kg air]</span>
<a name="ln-198"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinProcAirInTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process inlet air temperature [C]</span>
<a name="ln-199"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxProcAirInTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process inlet air temperature [C]</span>
<a name="ln-200"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinProcAirInHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process inlet air humidity ratio [kg water/kg air]</span>
<a name="ln-201"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxProcAirInHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process inlet air humidity ratio [kg water/kg air]</span>
<a name="ln-202"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinFaceVel</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process, regen face velocity [m/s]</span>
<a name="ln-203"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxFaceVel</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process, regen face velocity [m/s]</span>
<a name="ln-204"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinRegenAirOutTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen outlet air temperature [C]</span>
<a name="ln-205"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxRegenAirOutTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen outlet air temperature [C]</span>
<a name="ln-206"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinRegenAirInRelHum</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen inlet air relative humidity [%]</span>
<a name="ln-207"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxRegenAirInRelHum</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen inlet air relative humidity [%]</span>
<a name="ln-208"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MinProcAirInRelHum</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process inlet air relative humidity [%]</span>
<a name="ln-209"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_MaxProcAirInRelHum</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process inlet air relative humidity [%]</span>
<a name="ln-210"></a>
<a name="ln-211"></a> <span class="c">! regeneration outlet humidity ratio equation coefficients and limits</span>
<a name="ln-212"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C1</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! constant coeff for outlet regen humidity ratio equation</span>
<a name="ln-213"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C2</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! regen inlet humrat coeff for outlet regen humidity ratio eq</span>
<a name="ln-214"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C3</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! regen inlet temp coeff for outlet regen humidity ratio equation</span>
<a name="ln-215"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C4</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! (regen in humrat/regen in temp) coeff for outlet regen humrat eq</span>
<a name="ln-216"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C5</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! process inlet humrat coeff for outlet regen humidity ratio eq</span>
<a name="ln-217"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C6</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! process inlet temp coeff for outlet regen humidity ratio eq</span>
<a name="ln-218"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C7</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! (proc in humrat/proc in temp) coeff for outlet regen humrat eq</span>
<a name="ln-219"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">C8</span>                     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! process, regen face velocity coeff for outlet regen humrat eq</span>
<a name="ln-220"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinRegenAirInTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen inlet air temperature [C]</span>
<a name="ln-221"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxRegenAirInTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen inlet air temperature [C]</span>
<a name="ln-222"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinRegenAirInHumRat</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen inlet air humidity ratio [kg water / kg air]</span>
<a name="ln-223"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxRegenAirInHumRat</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen inlet air humidity ratio [kg water / kg air]</span>
<a name="ln-224"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinProcAirInTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process inlet air temperature [C]</span>
<a name="ln-225"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxProcAirInTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process inlet air temperature [C]</span>
<a name="ln-226"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinProcAirInHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process inlet air humidity ratio [kg water/kg air]</span>
<a name="ln-227"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxProcAirInHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process inlet air humidity ratio [kg water/kg air]</span>
<a name="ln-228"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinFaceVel</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process, regen face velocity [m/s]</span>
<a name="ln-229"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxFaceVel</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process, regen face velocity [m/s]</span>
<a name="ln-230"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinRegenAirOutHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen outlet air temperature [C]</span>
<a name="ln-231"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxRegenAirOutHumRat</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen outlet air temperature [C]</span>
<a name="ln-232"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinRegenAirInRelHum</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable regen inlet air relative humidity [%]</span>
<a name="ln-233"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxRegenAirInRelHum</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable regen inlet air relative humidity [%]</span>
<a name="ln-234"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MinProcAirInRelHum</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! min allowable process inlet air relative humidity [%]</span>
<a name="ln-235"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_MaxProcAirInRelHum</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! max allowable process inlet air relative humidity [%]</span>
<a name="ln-236"></a>
<a name="ln-237"></a>   <span class="c">! for model bound checking</span>
<a name="ln-238"></a>    <span class="c">! regen inlet relative humidity for temperature equation</span>
<a name="ln-239"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenInRelHumTempMess</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in RH error message for temp eq</span>
<a name="ln-240"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenInRelHumTempErrIndex</span>    <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-241"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenInRelHumTempErrorCount</span>  <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-242"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenInRelHumTempBuffer1</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-243"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenInRelHumTempBuffer2</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-244"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenInRelHumTempBuffer3</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-245"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RegenInRelHumTempLast</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet humidity ratio</span>
<a name="ln-246"></a>
<a name="ln-247"></a>    <span class="c">! process inlet relative humidity for temperature equation</span>
<a name="ln-248"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintProcInRelHumTempMess</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in RH error message for temp eq</span>
<a name="ln-249"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ProcInRelHumTempErrIndex</span>    <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-250"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ProcInRelHumTempErrorCount</span>  <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-251"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ProcInRelHumTempBuffer1</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-252"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ProcInRelHumTempBuffer2</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-253"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ProcInRelHumTempBuffer3</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-254"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ProcInRelHumTempLast</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet humidity ratio</span>
<a name="ln-255"></a>
<a name="ln-256"></a>    <span class="c">! regen inlet relative humidity for humidity ratio equation</span>
<a name="ln-257"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in RH error message for temp eq</span>
<a name="ln-258"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenInRelHumHumRatErrIndex</span>  <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-259"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenInRelHumHumRatErrorCount</span><span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-260"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenInRelHumHumRatBuffer1</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-261"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenInRelHumHumRatBuffer2</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-262"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenInRelHumHumRatBuffer3</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-263"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RegenInRelHumHumRatLast</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet humidity ratio</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="c">! process inlet relative humidity for humidity ratio equation</span>
<a name="ln-266"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintProcInRelHumHumRatMess</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in RH error message for temp eq</span>
<a name="ln-267"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ProcInRelHumHumRatErrIndex</span>   <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-268"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ProcInRelHumHumRatErrorCount</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-269"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ProcInRelHumHumRatBuffer1</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-270"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ProcInRelHumHumRatBuffer2</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-271"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ProcInRelHumHumRatBuffer3</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-272"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ProcInRelHumHumRatLast</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet humidity ratio</span>
<a name="ln-273"></a>
<a name="ln-274"></a>    <span class="c">! regen outlet temp variables</span>
<a name="ln-275"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintT_RegenInTempMessage</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in temp error message for temp eq</span>
<a name="ln-276"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintT_RegenInHumRatMessage</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in humrat err message for temp eq</span>
<a name="ln-277"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintT_ProcInTempMessage</span>     <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print proc inlet temp err message for temp eq</span>
<a name="ln-278"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintT_ProcInHumRatMessage</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print process hum rat err message for temp eq</span>
<a name="ln-279"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintT_FaceVelMessage</span>        <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print face velocity error message</span>
<a name="ln-280"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenOutTempMessage</span>     <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen outlet temp error message</span>
<a name="ln-281"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenOutTempFailedMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen outlet temp error message</span>
<a name="ln-282"></a>
<a name="ln-283"></a>    <span class="c">! regen outlet hum rat variables</span>
<a name="ln-284"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintH_RegenInTempMessage</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print regen in temp err message for humrat eq</span>
<a name="ln-285"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintH_RegenInHumRatMessage</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for regen in humrat err message for humrat eq</span>
<a name="ln-286"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintH_ProcInTempMessage</span>     <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for process inlet temp err message for humrat eq</span>
<a name="ln-287"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintH_ProcInHumRatMessage</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for process hum rat error message for hum rat eq</span>
<a name="ln-288"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintH_FaceVelMessage</span>        <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for face velocity error message</span>
<a name="ln-289"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenOutHumRatMessage</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for regen outlet hum rat error message</span>
<a name="ln-290"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenInHumRatMessage</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for regen outlet hum rat error message</span>
<a name="ln-291"></a>
<a name="ln-292"></a>    <span class="c">! used when regen outlet humrat is below regen inlet humrat, verify coefficients warning issued</span>
<a name="ln-293"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintRegenOutHumRatFailedMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for regen outlet hum rat error message</span>
<a name="ln-294"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutHumRatFailedErrIndex</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-295"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutHumRatFailedErrorCount</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-296"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutHumRatFailedBuffer1</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-297"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutHumRatFailedBuffer2</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-298"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutHumRatFailedBuffer3</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn mess on following timstep</span>
<a name="ln-299"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RegenOutHumRatFailedLast</span>     <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet humidity ratio</span>
<a name="ln-300"></a>
<a name="ln-301"></a>    <span class="c">! used when regen and process mass flow rates are not equal to within 2%</span>
<a name="ln-302"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PrintImbalancedMassFlowMess</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag for imbalanced regen and process mass flow rate</span>
<a name="ln-303"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ImbalancedFlowErrIndex</span>   <span class="o">=</span> <span class="mi">0</span>        <span class="c">!- index to recurring error struc for imbalanced flow</span>
<a name="ln-304"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ImbalancedMassFlowErrorCount</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter for imbalanced regen and process mass flow rate</span>
<a name="ln-305"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ImbalancedMassFlowBuffer1</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for imbalanced regen and process mass flow rate</span>
<a name="ln-306"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ImbalancedMassFlowBuffer2</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for imbalanced regen and process mass flow rate</span>
<a name="ln-307"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ImbalancedMassFlowBuffer3</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for imbalanced regen and process mass flow rate</span>
<a name="ln-308"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ABSImbalancedFlow</span>            <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of heat exchanger mass flow rate imbalance</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="c">! regen outlet temp eqn</span>
<a name="ln-311"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_RegenInTempErrorCount</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen inlet temp limits are exceeded</span>
<a name="ln-312"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_RegenInHumRatErrorCount</span>    <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen inlet hum rat limits are exceeded</span>
<a name="ln-313"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_ProcInTempErrorCount</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if process inlet temperature limits are exceeded</span>
<a name="ln-314"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_ProcInHumRatErrorCount</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if process inlet hum rat limits are exceeded</span>
<a name="ln-315"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_FaceVelErrorCount</span>          <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen and proc face vel limits are exceeded</span>
<a name="ln-316"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_RegenInTempErrIndex</span>        <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for regen inlet temp</span>
<a name="ln-317"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_RegenInHumRatErrIndex</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for regen in humrat</span>
<a name="ln-318"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_ProcInTempErrIndex</span>         <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for process in temp</span>
<a name="ln-319"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_ProcInHumRatErrIndex</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for process in humrat</span>
<a name="ln-320"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">T_FaceVelocityErrIndex</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring err struc for proc and regen face vel</span>
<a name="ln-321"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutTempErrorCount</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-322"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutTempErrIndex</span>         <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for regen outlet temp</span>
<a name="ln-323"></a>
<a name="ln-324"></a>    <span class="c">! used when regen outlet temperature is above regen inlet temperature, verify coefficients warning issued</span>
<a name="ln-325"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutTempFailedErrorCount</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-326"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutTempFailedErrIndex</span>   <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for regen outlet temp</span>
<a name="ln-327"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutTempFailedBuffer1</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutTemp warn messages on following timestep</span>
<a name="ln-328"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutTempFailedBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutTemp warn messages on following timestep</span>
<a name="ln-329"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutTempFailedBuffer3</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutTemp warn messages on following timestep</span>
<a name="ln-330"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RegenOutTempFailedLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet temp</span>
<a name="ln-331"></a>
<a name="ln-332"></a>
<a name="ln-333"></a>    <span class="c">! regen outlet hum rat eqn</span>
<a name="ln-334"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_RegenInTempErrorCount</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen inlet temp limits are exceeded</span>
<a name="ln-335"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_RegenInHumRatErrorCount</span>    <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen inlet hum rat limits are exceeded</span>
<a name="ln-336"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_ProcInTempErrorCount</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if process inlet temperature limits are exceeded</span>
<a name="ln-337"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_ProcInHumRatErrorCount</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if process inlet hum rat limits are exceeded</span>
<a name="ln-338"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_FaceVelErrorCount</span>          <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen and proc face vel limits are exceeded</span>
<a name="ln-339"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_RegenInTempErrIndex</span>        <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error structure for regen inlet temp</span>
<a name="ln-340"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_RegenInHumRatErrIndex</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen inlet humrat</span>
<a name="ln-341"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_ProcInTempErrIndex</span>         <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for process inlet temp</span>
<a name="ln-342"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_ProcInHumRatErrIndex</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for process inlet hum rat</span>
<a name="ln-343"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">H_FaceVelocityErrIndex</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring err struc for proc and regen face vel</span>
<a name="ln-344"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutHumRatErrorCount</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-345"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenOutHumRatErrIndex</span>       <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-346"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenInHumRatErrorCount</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- counter if regen outlet temp limits are exceeded</span>
<a name="ln-347"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegenInHumRatErrIndex</span>        <span class="o">=</span> <span class="mi">0</span>    <span class="c">!- index to recurring error struc for regen outlet hum rat</span>
<a name="ln-348"></a>
<a name="ln-349"></a>    <span class="c">! regen outlet temp variables                                   !- T_RegenInTemp = Regen inlet temperature</span>
<a name="ln-350"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_RegenInTempBuffer1</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_RegenInTemp warn message on following timestep</span>
<a name="ln-351"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_RegenInTempBuffer2</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_RegenInTemp warn message on following timestep</span>
<a name="ln-352"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_RegenInTempBuffer3</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_RegenInTemp warn message on following timestep</span>
<a name="ln-353"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_RegenInTempLast</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen inlet temp</span>
<a name="ln-354"></a>                                                                    <span class="c">!- T_RegenInHumRat = Regen inlet humidity ratio</span>
<a name="ln-355"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_RegenInHumRatBuffer1</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_RegenInHumRat warn messag on following timestep</span>
<a name="ln-356"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_RegenInHumRatBuffer2</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_RegenInHumRat warn messag on following timestep</span>
<a name="ln-357"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_RegenInHumRatBuffer3</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_RegenInHumRat warn messag on following timestep</span>
<a name="ln-358"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_RegenInHumRatLast</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen inlet humidity ratio</span>
<a name="ln-359"></a>                                                                    <span class="c">!- T_ProcInTemp = Process inlet temperature</span>
<a name="ln-360"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_ProcInTempBuffer1</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_ProcInTemp warning messag on following timestep</span>
<a name="ln-361"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_ProcInTempBuffer2</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_ProcInTemp warning messag on following timestep</span>
<a name="ln-362"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_ProcInTempBuffer3</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_ProcInTemp warning messag on following timestep</span>
<a name="ln-363"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_ProcInTempLast</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of process inlet temp</span>
<a name="ln-364"></a>                                                                    <span class="c">!- T_ProcInHumRat = Process inlet humidity ratio</span>
<a name="ln-365"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_ProcInHumRatBuffer1</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_ProcInHumRat warn message on following timestep</span>
<a name="ln-366"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_ProcInHumRatBuffer2</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_ProcInHumRat warn message on following timestep</span>
<a name="ln-367"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_ProcInHumRatBuffer3</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_ProcInHumRat warn message on following timestep</span>
<a name="ln-368"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_ProcInHumRatLast</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of process inlet humidity ratio</span>
<a name="ln-369"></a>                                                                    <span class="c">!- T_FaceVel = Process and regen face velocity</span>
<a name="ln-370"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_FaceVelBuffer1</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_FaceVel warning messages on following time step</span>
<a name="ln-371"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_FaceVelBuffer2</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_FaceVel warning messages on following time step</span>
<a name="ln-372"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T_FaceVelBuffer3</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for T_FaceVel warning messages on following time step</span>
<a name="ln-373"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">T_FaceVelLast</span>            <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of process and regen face velocity</span>
<a name="ln-374"></a>                                                                    <span class="c">!- T_RegenOutTemp = Regen outlet temperature</span>
<a name="ln-375"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutTempBuffer1</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutTemp warn messages on following timestep</span>
<a name="ln-376"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutTempBuffer2</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutTemp warn messages on following timestep</span>
<a name="ln-377"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutTempBuffer3</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutTemp warn messages on following timestep</span>
<a name="ln-378"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RegenOutTempLast</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet temp</span>
<a name="ln-379"></a>
<a name="ln-380"></a>    <span class="c">! regen outlet humidity ratio variables                         !- H_RegenInTemp = Regen inlet temperature</span>
<a name="ln-381"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_RegenInTempBuffer1</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_RegenInTemp warn message on following time step</span>
<a name="ln-382"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_RegenInTempBuffer2</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_RegenInTemp warn message on following time step</span>
<a name="ln-383"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_RegenInTempBuffer3</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_RegenInTemp warn message on following time step</span>
<a name="ln-384"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_RegenInTempLast</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen inlet temp</span>
<a name="ln-385"></a>                                                                    <span class="c">!- H_RegenInHumRat = Regen inlet humidity ratio</span>
<a name="ln-386"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_RegenInHumRatBuffer1</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_RegenInHumRat warn messag on following timestep</span>
<a name="ln-387"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_RegenInHumRatBuffer2</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_RegenInHumRat warn messag on following timestep</span>
<a name="ln-388"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_RegenInHumRatBuffer3</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_RegenInHumRat warn messag on following timestep</span>
<a name="ln-389"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_RegenInHumRatLast</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen inlet humidity ratio</span>
<a name="ln-390"></a>                                                                    <span class="c">!- H_ProcInTemp = Process inlet temperature</span>
<a name="ln-391"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_ProcInTempBuffer1</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_ProcInTemp warn messages on following time step</span>
<a name="ln-392"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_ProcInTempBuffer2</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_ProcInTemp warn messages on following time step</span>
<a name="ln-393"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_ProcInTempBuffer3</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_ProcInTemp warn messages on following time step</span>
<a name="ln-394"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_ProcInTempLast</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of process inlet temp</span>
<a name="ln-395"></a>                                                                    <span class="c">!- H_ProcInHumRat = Process inlet humidity ratio</span>
<a name="ln-396"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_ProcInHumRatBuffer1</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_ProcInHumRat warn message on following timestep</span>
<a name="ln-397"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_ProcInHumRatBuffer2</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_ProcInHumRat warn message on following timestep</span>
<a name="ln-398"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_ProcInHumRatBuffer3</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_ProcInHumRat warn message on following timestep</span>
<a name="ln-399"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_ProcInHumRatLast</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of process inlet humidity ratio</span>
<a name="ln-400"></a>                                                                    <span class="c">!- H_FaceVel = Process and regen face velocity</span>
<a name="ln-401"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_FaceVelBuffer1</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_FaceVel warning messages on following time step</span>
<a name="ln-402"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_FaceVelBuffer2</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_FaceVel warning messages on following time step</span>
<a name="ln-403"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H_FaceVelBuffer3</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for H_FaceVel warning messages on following time step</span>
<a name="ln-404"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">H_FaceVelLast</span>            <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of process and regen face velocity</span>
<a name="ln-405"></a>                                                                    <span class="c">!- H_RegenOutTemp = Regen outlet temperature</span>
<a name="ln-406"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutHumRatBuffer1</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn message on following timestep</span>
<a name="ln-407"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutHumRatBuffer2</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn message on following timestep</span>
<a name="ln-408"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RegenOutHumRatBuffer3</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">!- buffer for RegenOutHumRat warn message on following timestep</span>
<a name="ln-409"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RegenOutHumRatLast</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!- last value of regen outlet humidity ratio</span>
<a name="ln-410"></a>  <span class="k">END TYPE </span><span class="n">BalancedDesDehumPerfData</span>
<a name="ln-411"></a>
<a name="ln-412"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-413"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHeatExchangers</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! number of heat exchangers</span>
<a name="ln-414"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAirToAirPlateExchs</span>       <span class="o">=</span><span class="mi">0</span> <span class="c">! number of air to air plate heat exchangers</span>
<a name="ln-415"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAirToAirGenericExchs</span>     <span class="o">=</span><span class="mi">0</span> <span class="c">! number of air to air generic heat exchangers</span>
<a name="ln-416"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDesiccantBalancedExchs</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! number of desiccant balanced heat exchangers</span>
<a name="ln-417"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDesBalExchsPerfDataType1</span> <span class="o">=</span><span class="mi">0</span> <span class="c">! number of desiccant balanced heat exchanger performance data maps</span>
<a name="ln-418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Used with desiccant HX empirical model, water coils use inlet node condition</span>
<a name="ln-419"></a>                                              <span class="c">! DX coils use DXCoilFullLoadOutAirTemp when coil is ON otherwise inlet node</span>
<a name="ln-420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Used with desiccant HX empirical model, water coils use inlet node condition</span>
<a name="ln-421"></a>                                              <span class="c">! DX coils use DXCoilFullLoadOutAirHumRat when coil is ON otherwise inlet node</span>
<a name="ln-422"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GetInputFlag</span>            <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! First time, input is &quot;gotten&quot;</span>
<a name="ln-423"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CalledFromParentObject</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Indicates that HX is called from parent object (this object is not on a branch)</span>
<a name="ln-424"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-425"></a>
<a name="ln-426"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">HeatExchCond</span><span class="p">),</span>             <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ExchCond</span>
<a name="ln-427"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">BalancedDesDehumPerfData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">BalDesDehumPerfData</span>
<a name="ln-428"></a>
<a name="ln-429"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE:</span>
<a name="ln-430"></a>
<a name="ln-431"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-432"></a>  <span class="k">PUBLIC  </span><span class="n">SimHeatRecovery</span>
<a name="ln-433"></a>
<a name="ln-434"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-435"></a>  <span class="k">PRIVATE </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-436"></a>
<a name="ln-437"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-438"></a>  <span class="k">PRIVATE </span><span class="n">InitHeatRecovery</span>
<a name="ln-439"></a>
<a name="ln-440"></a>     <span class="c">! Sizing routine for the module</span>
<a name="ln-441"></a>  <span class="k">PRIVATE </span><span class="n">SizeHeatRecovery</span>
<a name="ln-442"></a>
<a name="ln-443"></a>          <span class="c">! Update routines to check convergence and update nodes</span>
<a name="ln-444"></a>  <span class="k">PRIVATE </span><span class="n">CalcAirToAirPlateHeatExch</span>
<a name="ln-445"></a>  <span class="k">PRIVATE </span><span class="n">CalcAirToAirGenericHeatExch</span>
<a name="ln-446"></a>  <span class="k">PRIVATE </span><span class="n">CalcDesiccantBalancedHeatExch</span>
<a name="ln-447"></a>  <span class="k">PRIVATE </span><span class="n">UpdateHeatRecovery</span>
<a name="ln-448"></a>  <span class="k">PRIVATE </span><span class="n">ReportHeatRecovery</span>
<a name="ln-449"></a>
<a name="ln-450"></a>          <span class="c">! Common routines</span>
<a name="ln-451"></a>  <span class="k">PRIVATE </span><span class="n">SafeDiv</span>
<a name="ln-452"></a>  <span class="k">PRIVATE </span><span class="n">CalculateEpsFromNTUandZ</span>
<a name="ln-453"></a>  <span class="k">PRIVATE </span><span class="n">CalculateNTUfromEpsAndZ</span>
<a name="ln-454"></a>  <span class="k">PRIVATE </span><span class="n">GetNTUforCrossFlowBothUnmixed</span>
<a name="ln-455"></a>  <span class="k">PRIVATE </span><span class="n">GetResidCrossFlowBothUnmixed</span>
<a name="ln-456"></a>  <span class="k">PRIVATE </span><span class="n">CheckModelBoundsTempEq</span>
<a name="ln-457"></a>  <span class="k">PRIVATE </span><span class="n">CheckModelBoundsHumRatEq</span>
<a name="ln-458"></a>  <span class="k">PRIVATE </span><span class="n">CheckModelBoundOutput_Temp</span>
<a name="ln-459"></a>  <span class="k">PRIVATE </span><span class="n">CheckModelBoundOutput_HumRat</span>
<a name="ln-460"></a>  <span class="k">PRIVATE </span><span class="n">CheckModelBoundsRH_TempEq</span>
<a name="ln-461"></a>  <span class="k">PRIVATE </span><span class="n">CheckModelBoundsRH_HumRatEq</span>
<a name="ln-462"></a>  <span class="k">PRIVATE </span><span class="n">CheckForBalancedFlow</span>
<a name="ln-463"></a>
<a name="ln-464"></a>          <span class="c">! External function calls</span>
<a name="ln-465"></a>  <span class="k">PUBLIC  </span><span class="n">GetSupplyInletNode</span>
<a name="ln-466"></a>  <span class="k">PUBLIC  </span><span class="n">GetSupplyOutletNode</span>
<a name="ln-467"></a>  <span class="k">PUBLIC  </span><span class="n">GetSecondaryInletNode</span>
<a name="ln-468"></a>  <span class="k">PUBLIC  </span><span class="n">GetSecondaryOutletNode</span>
<a name="ln-469"></a>  <span class="k">PUBLIC  </span><span class="n">GetSupplyAirFlowRate</span>
<a name="ln-470"></a>  <span class="k">PUBLIC  </span><span class="n">GetHeatExchangerObjectTypeNum</span>
<a name="ln-471"></a>  <span class="k">PUBLIC  </span><span class="n">SetHeatExchangerData</span>
<a name="ln-472"></a>
<a name="ln-473"></a><span class="k">CONTAINS</span>
<a name="ln-474"></a>
<a name="ln-475"></a><span class="k">SUBROUTINE </span><span class="n">SimHeatRecovery</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">HXPartLoadRatio</span><span class="p">,</span><span class="n">HXUnitEnable</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-476"></a>                           <span class="n">CompanionCoilIndex</span><span class="p">,</span><span class="n">RegenInletIsOANode</span><span class="p">,</span><span class="n">EconomizerFlag</span><span class="p">,</span><span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-477"></a>
<a name="ln-478"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-479"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-480"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-481"></a>          <span class="c">!       MODIFIED       Fred Buhl November 2000, R. Raustad FSEC - Feb 2009</span>
<a name="ln-482"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-483"></a>
<a name="ln-484"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-485"></a>          <span class="c">! Manage the simulation of a heat recovery unit</span>
<a name="ln-486"></a>
<a name="ln-487"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-488"></a>          <span class="c">! NA</span>
<a name="ln-489"></a>
<a name="ln-490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-491"></a>          <span class="c">! NA</span>
<a name="ln-492"></a>
<a name="ln-493"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-494"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-495"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-496"></a>
<a name="ln-497"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-498"></a>
<a name="ln-499"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-500"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! name of the heat exchanger unit</span>
<a name="ln-501"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>             <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! TRUE if 1st HVAC simulation of system timestep</span>
<a name="ln-502"></a>  <span class="kt">INTEGER</span><span class="p">,</span>             <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompIndex</span>           <span class="c">! Pointer to Component</span>
<a name="ln-503"></a>  <span class="kt">INTEGER</span><span class="p">,</span>             <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Supply air fan operating mode</span>
<a name="ln-504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HXPartLoadRatio</span>     <span class="c">! Part load ratio requested of DX compressor</span>
<a name="ln-505"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HXUnitEnable</span>        <span class="c">! Flag to operate heat exchanger</span>
<a name="ln-506"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CompanionCoilIndex</span>  <span class="c">! index of companion cooling coil</span>
<a name="ln-507"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RegenInletIsOANode</span>  <span class="c">! flag to determine if supply inlet is OA node, if so air flow cycles</span>
<a name="ln-508"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">EconomizerFlag</span>      <span class="c">! economizer operation flag passed by airloop or OA sys</span>
<a name="ln-509"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HighHumCtrlFlag</span>     <span class="c">! high humidity control flag passed by airloop or OA sys</span>
<a name="ln-510"></a>
<a name="ln-511"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-512"></a>          <span class="c">! na</span>
<a name="ln-513"></a>
<a name="ln-514"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-515"></a>          <span class="c">! na</span>
<a name="ln-516"></a>
<a name="ln-517"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-518"></a>          <span class="c">! na</span>
<a name="ln-519"></a>
<a name="ln-520"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-521"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatExchNum</span>               <span class="c">! index of unit being simulated</span>
<a name="ln-522"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">HXUnitOn</span>                  <span class="c">! flag to enable heat exchanger</span>
<a name="ln-523"></a><span class="c">!unused0509  INTEGER      :: FanModeOperation          ! supply air fan operating mode</span>
<a name="ln-524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>             <span class="c">! Part load ratio requested of DX compressor</span>
<a name="ln-525"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">RegInIsOANode</span>             <span class="c">! local variable to set RegenInletIsOANode optional argument</span>
<a name="ln-526"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompanionCoilNum</span>          <span class="c">! Index to companion cooling coil</span>
<a name="ln-527"></a>
<a name="ln-528"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-529"></a><span class="k">    CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-530"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-531"></a>  <span class="n">ENDIF</span>
<a name="ln-532"></a>
<a name="ln-533"></a>  <span class="c">! Find the correct unit index</span>
<a name="ln-534"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-535"></a><span class="k">    </span><span class="n">HeatExchNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-536"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatExchNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-537"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHeatRecovery: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-538"></a>    <span class="n">ENDIF</span>
<a name="ln-539"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">HeatExchNum</span>
<a name="ln-540"></a>  <span class="k">ELSE</span>
<a name="ln-541"></a><span class="k">    </span><span class="n">HeatExchNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-542"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatExchNum</span> <span class="o">&gt;</span> <span class="n">NumHeatExchangers</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">HeatExchNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-543"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHeatRecovery:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-544"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-545"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumHeatExchangers</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-546"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-547"></a>    <span class="n">ENDIF</span>
<a name="ln-548"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-549"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-550"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHeatRecovery: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-551"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-552"></a>                            <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-553"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-554"></a>      <span class="n">ENDIF</span>
<a name="ln-555"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-556"></a>    <span class="n">ENDIF</span>
<a name="ln-557"></a>  <span class="n">ENDIF</span>
<a name="ln-558"></a>
<a name="ln-559"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompanionCoilIndex</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-560"></a><span class="k">    </span><span class="n">CompanionCoilNum</span> <span class="o">=</span> <span class="n">CompanionCoilIndex</span>
<a name="ln-561"></a>  <span class="k">ELSE</span>
<a name="ln-562"></a><span class="k">    </span><span class="n">CompanionCoilNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-563"></a>  <span class="k">END IF</span>
<a name="ln-564"></a>
<a name="ln-565"></a><span class="k">  IF</span><span class="p">(</span> <span class="nb">PRESENT</span><span class="p">(</span><span class="n">HXUnitEnable</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-566"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="n">HXUnitEnable</span>
<a name="ln-567"></a><span class="c">!   When CalledFromParentObject is TRUE, this SIM routine was called by a parent object that passed in HXUnitEnable.</span>
<a name="ln-568"></a><span class="c">!   HX will use the DX coil part-load ratio (optional CompanionCoilIndex must be present) or PLR passed in if</span>
<a name="ln-569"></a><span class="c">!   not used with DX coil (optional CompanionCoilIndex must not be present).</span>
<a name="ln-570"></a>    <span class="n">CalledFromParentObject</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-571"></a>  <span class="k">ELSE</span>
<a name="ln-572"></a><span class="c">!   HX is placed on a BRANCH, optional arguments are not passed in from SimAirServingZones.</span>
<a name="ln-573"></a><span class="c">!   HX will calculate its own part-load ratio if optional HXUnitEnable flag is not present</span>
<a name="ln-574"></a>    <span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-575"></a>    <span class="n">CalledFromParentObject</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-576"></a>  <span class="k">END IF</span>
<a name="ln-577"></a>
<a name="ln-578"></a><span class="k">  CALL </span><span class="n">InitHeatRecovery</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">,</span> <span class="n">CompanionCoilNum</span><span class="p">)</span>
<a name="ln-579"></a>
<a name="ln-580"></a>  <span class="c">! call the correct heat exchanger calculation routine</span>
<a name="ln-581"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">)</span>
<a name="ln-582"></a>
<a name="ln-583"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">HX_AIRTOAIR_FLATPLATE</span><span class="p">)</span>
<a name="ln-584"></a>
<a name="ln-585"></a>      <span class="k">CALL </span><span class="n">CalcAirToAirPlateHeatExch</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="p">,</span> <span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-586"></a>
<a name="ln-587"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">HX_AIRTOAIR_GENERIC</span><span class="p">)</span>
<a name="ln-588"></a>
<a name="ln-589"></a>      <span class="k">CALL </span><span class="n">CalcAirToAirGenericHeatExch</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="p">,</span> <span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-590"></a>
<a name="ln-591"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">HX_DESICCANT_BALANCED</span><span class="p">)</span>
<a name="ln-592"></a>
<a name="ln-593"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HXPartLoadRatio</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-594"></a><span class="k">        </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">HXPartLoadRatio</span>
<a name="ln-595"></a>      <span class="k">ELSE</span>
<a name="ln-596"></a><span class="k">        </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-597"></a>      <span class="k">END IF</span>
<a name="ln-598"></a>
<a name="ln-599"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">RegenInletIsOANode</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-600"></a><span class="k">        </span><span class="n">RegInIsOANode</span> <span class="o">=</span> <span class="n">RegenInletIsOANode</span>
<a name="ln-601"></a>      <span class="k">ELSE</span>
<a name="ln-602"></a><span class="k">        </span><span class="n">RegInIsOANode</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-603"></a>      <span class="k">END IF</span>
<a name="ln-604"></a>
<a name="ln-605"></a><span class="k">      CALL </span><span class="n">CalcDesiccantBalancedHeatExch</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-606"></a>                                         <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CompanionCoilNum</span><span class="p">,</span> <span class="n">RegInIsOANode</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="p">,</span> <span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-607"></a>
<a name="ln-608"></a>  <span class="k">END SELECT</span>
<a name="ln-609"></a>
<a name="ln-610"></a><span class="k">  CALL </span><span class="n">UpdateHeatRecovery</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">)</span>
<a name="ln-611"></a>
<a name="ln-612"></a>  <span class="k">CALL </span><span class="n">ReportHeatRecovery</span><span class="p">(</span><span class="n">HeatExchNum</span><span class="p">)</span>
<a name="ln-613"></a>
<a name="ln-614"></a><span class="k">RETURN</span>
<a name="ln-615"></a><span class="k">END SUBROUTINE </span><span class="n">SimHeatRecovery</span>
<a name="ln-616"></a>
<a name="ln-617"></a><span class="k">SUBROUTINE </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-618"></a>
<a name="ln-619"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-620"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-621"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-622"></a>          <span class="c">!       MODIFIED       F Buhl Nov 2000, D Shirey Feb 2003, R. Raustad FSEC - Feb 2009 (EconoLockout inputs)</span>
<a name="ln-623"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-624"></a>
<a name="ln-625"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-626"></a>          <span class="c">! Obtains input data for heat recovery units and stores it in</span>
<a name="ln-627"></a>          <span class="c">! appropriate data structures.</span>
<a name="ln-628"></a>
<a name="ln-629"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-630"></a>          <span class="c">! Uses InputProcessor &quot;Get&quot; routines to obtain data.</span>
<a name="ln-631"></a>
<a name="ln-632"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-633"></a>          <span class="c">! na</span>
<a name="ln-634"></a>
<a name="ln-635"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-636"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-637"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-638"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-639"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-640"></a>
<a name="ln-641"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-642"></a>
<a name="ln-643"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-644"></a>          <span class="c">! na</span>
<a name="ln-645"></a>
<a name="ln-646"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-647"></a>          <span class="c">! na</span>
<a name="ln-648"></a>
<a name="ln-649"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-650"></a>          <span class="c">! na</span>
<a name="ln-651"></a>
<a name="ln-652"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-653"></a>          <span class="c">! na</span>
<a name="ln-654"></a>
<a name="ln-655"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-656"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">ExchIndex</span>      <span class="c">! loop index</span>
<a name="ln-657"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">ExchNum</span>        <span class="c">! current heat exchanger number</span>
<a name="ln-658"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">PerfDataIndex</span>  <span class="c">! desiccant balance heat exchanger performance data loop index</span>
<a name="ln-659"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">PerfDataNum</span>    <span class="c">! current desiccant balanced heat exchanger performance data set number</span>
<a name="ln-660"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">NumAlphas</span>     <span class="c">! Number of Alphas for each GetObjectItem call</span>
<a name="ln-661"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">NumNumbers</span>    <span class="c">! Number of Numbers for each GetObjectItem call</span>
<a name="ln-662"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">IOStatus</span>      <span class="c">! Used in GetObjectItem</span>
<a name="ln-663"></a>  <span class="kt">LOGICAL</span>                 <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! Set to true if errors in input, fatal at end of routine</span>
<a name="ln-664"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">IsNotOK</span>       <span class="c">! Flag to verify name</span>
<a name="ln-665"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">IsBlank</span>       <span class="c">! Flag for blank name</span>
<a name="ln-666"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HeatExchPerfType</span> <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Desiccant balanced heat exchanger performance data type</span>
<a name="ln-667"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span>    <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetHeatRecoveryInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-668"></a>
<a name="ln-669"></a>
<a name="ln-670"></a>  <span class="n">NumAirToAirPlateExchs</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;HeatExchanger:AirToAir:FlatPlate&#39;</span><span class="p">)</span>
<a name="ln-671"></a>  <span class="n">NumAirToAirGenericExchs</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;HeatExchanger:AirToAir:SensibleAndLatent&#39;</span><span class="p">)</span>
<a name="ln-672"></a>  <span class="n">NumDesiccantBalancedExchs</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;HeatExchanger:Desiccant:BalancedFlow&#39;</span><span class="p">)</span>
<a name="ln-673"></a>  <span class="n">NumDesBalExchsPerfDataType1</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;HeatExchanger:Desiccant:BalancedFlow:PerformanceDataType1&#39;</span><span class="p">)</span>
<a name="ln-674"></a>  <span class="n">NumHeatExchangers</span> <span class="o">=</span> <span class="n">NumAirToAirPlateExchs</span> <span class="o">+</span> <span class="n">NumAirToAirGenericExchs</span> <span class="o">+</span> <span class="n">NumDesiccantBalancedExchs</span>
<a name="ln-675"></a>
<a name="ln-676"></a>  <span class="c">! allocate the data array</span>
<a name="ln-677"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">NumHeatExchangers</span><span class="p">))</span>
<a name="ln-678"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumHeatExchangers</span><span class="p">))</span>
<a name="ln-679"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-680"></a>
<a name="ln-681"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumDesBalExchsPerfDataType1</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-682"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">NumDesBalExchsPerfDataType1</span><span class="p">))</span>
<a name="ln-683"></a>  <span class="k">END IF</span>
<a name="ln-684"></a>
<a name="ln-685"></a>  <span class="c">! loop over the air to air plate heat exchangers and load their input data</span>
<a name="ln-686"></a>  <span class="k">DO </span><span class="n">ExchIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumAirToAirPlateExchs</span>
<a name="ln-687"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;HeatExchanger:AirToAir:FlatPlate&#39;</span>
<a name="ln-688"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">ExchIndex</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,&amp;</span>
<a name="ln-689"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-690"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-691"></a>    <span class="n">ExchNum</span> <span class="o">=</span> <span class="n">ExchIndex</span>
<a name="ln-692"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-693"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-694"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">ExchNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-695"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-696"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-697"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-698"></a>    <span class="n">ENDIF</span>
<a name="ln-699"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-700"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span> <span class="o">=</span> <span class="n">HX_AIRTOAIR_FLATPLATE</span>
<a name="ln-701"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-702"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-703"></a>    <span class="k">ELSE</span>
<a name="ln-704"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-705"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-706"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-707"></a>           <span class="s1">&#39; entered =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-708"></a>           <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-709"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-710"></a>      <span class="k">END IF</span>
<a name="ln-711"></a><span class="k">    END IF</span>
<a name="ln-712"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-713"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;COUNTERFLOW&#39;</span><span class="p">)</span>
<a name="ln-714"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FlowArr</span> <span class="o">=</span> <span class="n">Counter_Flow</span>
<a name="ln-715"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;PARALLELFLOW&#39;</span><span class="p">)</span>
<a name="ln-716"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FlowArr</span> <span class="o">=</span> <span class="n">Parallel_Flow</span>
<a name="ln-717"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CROSSFLOWBOTHUNMIXED&#39;</span><span class="p">)</span>
<a name="ln-718"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FlowArr</span> <span class="o">=</span> <span class="n">Cross_Flow_Both_Unmixed</span>
<a name="ln-719"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-720"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: incorrect flow arrangement: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-721"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-722"></a>    <span class="k">END SELECT</span>
<a name="ln-723"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-724"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-725"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_Yes</span>
<a name="ln-726"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-727"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_No</span>
<a name="ln-728"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-729"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-730"></a><span class="k">          </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_Yes</span>
<a name="ln-731"></a>        <span class="k">ELSE</span>
<a name="ln-732"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: incorrect econo lockout: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-733"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-734"></a>        <span class="k">END IF</span>
<a name="ln-735"></a><span class="k">    END SELECT</span>
<a name="ln-736"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">hARatio</span>           <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-737"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-738"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirInTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-739"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirOutTemp</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-740"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSecAirVolFlow</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-741"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSecAirInTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-742"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomElecPower</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-743"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-744"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-745"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-746"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-747"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-748"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-749"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-750"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-751"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-752"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-753"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-754"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-755"></a>
<a name="ln-756"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">),</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-757"></a>                     <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Process Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-758"></a>
<a name="ln-759"></a>  <span class="k">END DO</span> <span class="c">! end of input loop over air to air plate heat exchangers</span>
<a name="ln-760"></a>
<a name="ln-761"></a>  <span class="c">! loop over the air to air generic heat exchangers and load their input data</span>
<a name="ln-762"></a>  <span class="k">DO </span><span class="n">ExchIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumAirToAirGenericExchs</span>
<a name="ln-763"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;HeatExchanger:AirToAir:SensibleAndLatent&#39;</span>
<a name="ln-764"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">ExchIndex</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,&amp;</span>
<a name="ln-765"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-766"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-767"></a>    <span class="n">ExchNum</span> <span class="o">=</span> <span class="n">ExchIndex</span><span class="o">+</span><span class="n">NumAirToAirPlateExchs</span>
<a name="ln-768"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-769"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-770"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">ExchNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-771"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-772"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-773"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-774"></a>    <span class="n">ENDIF</span>
<a name="ln-775"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-776"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span> <span class="o">=</span> <span class="n">HX_AIRTOAIR_GENERIC</span>
<a name="ln-777"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-778"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-779"></a>    <span class="k">ELSE</span>
<a name="ln-780"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-781"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-782"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-783"></a>           <span class="s1">&#39; entered =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-784"></a>           <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-785"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-786"></a>      <span class="k">END IF</span>
<a name="ln-787"></a><span class="k">    END IF</span>
<a name="ln-788"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-789"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectSensible100</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-790"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectLatent100</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-791"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-792"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-793"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectSensible100</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-794"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-795"></a>                             <span class="s1">&#39;&quot; sensible heating effectiveness at 75% rated flow is less than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-796"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sensible heating effectiveness at 75% rated flow is usually greater than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-797"></a>    <span class="k">END IF</span>
<a name="ln-798"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatEffectLatent100</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-799"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-800"></a>                             <span class="s1">&#39;&quot; latent heating effectiveness at 75% rated flow is less than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-801"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Latent heating effectiveness at 75% rated flow is usually greater than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-802"></a>    <span class="k">END IF</span>
<a name="ln-803"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectSensible100</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-804"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectLatent100</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-805"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-806"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-807"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectSensible100</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-808"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-809"></a>                             <span class="s1">&#39;&quot; sensible cooling effectiveness at 75% rated flow is less than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-810"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sensible cooling effectiveness at 75% rated flow is usually greater than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-811"></a>    <span class="k">END IF</span>
<a name="ln-812"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">CoolEffectLatent100</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-813"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-814"></a>                             <span class="s1">&#39;&quot; latent cooling effectiveness at 75% rated flow is less than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-815"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Latent cooling effectiveness at 75% rated flow is usually greater than at 100% rated flow.&#39;</span><span class="p">)</span>
<a name="ln-816"></a>    <span class="k">END IF</span>
<a name="ln-817"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-818"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-819"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-820"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-821"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-822"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-823"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-824"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-825"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-826"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-827"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-828"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-829"></a>
<a name="ln-830"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomElecPower</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-831"></a>
<a name="ln-832"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-833"></a><span class="k">     </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ControlToTemperatureSetpoint</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-834"></a>    <span class="k">ELSE</span>
<a name="ln-835"></a><span class="k">     IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-836"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Rotary HX Speed Modulation or Plate Bypass for Temperature Control for &#39;</span><span class="p">)</span>
<a name="ln-837"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; must be set to Yes or No&#39;</span><span class="p">)</span>
<a name="ln-838"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-839"></a>     <span class="k">END IF</span>
<a name="ln-840"></a><span class="k">    END IF</span>
<a name="ln-841"></a>
<a name="ln-842"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Plate&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-843"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchConfigNum</span> <span class="o">=</span> <span class="n">Plate</span>
<a name="ln-844"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Rotary&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-845"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchConfigNum</span> <span class="o">=</span> <span class="n">Rotary</span>
<a name="ln-846"></a>    <span class="k">ELSE</span>
<a name="ln-847"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; configuration not found= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-848"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;HX configuration must be either Plate or Rotary&#39;</span><span class="p">)</span>
<a name="ln-849"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-850"></a>    <span class="k">END IF</span>
<a name="ln-851"></a>
<a name="ln-852"></a><span class="c">! Added additional inputs for frost control</span>
<a name="ln-853"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-854"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FrostControlType</span><span class="p">,</span><span class="s1">&#39;None&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-855"></a><span class="k">     IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FrostControlType</span><span class="p">,</span><span class="s1">&#39;ExhaustOnly&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-856"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FrostControlType</span><span class="p">,</span><span class="s1">&#39;ExhaustAirRecirculation&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-857"></a><span class="k">       IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FrostControlType</span><span class="p">,</span><span class="s1">&#39;MinimumExhaustTemperature&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-858"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid Frost Control method for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =  &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-859"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-860"></a>       <span class="k">END IF</span>
<a name="ln-861"></a><span class="k">      END IF</span>
<a name="ln-862"></a><span class="k">     END IF</span>
<a name="ln-863"></a><span class="k">    END IF</span>
<a name="ln-864"></a>
<a name="ln-865"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-866"></a><span class="k">     </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ThresholdTemperature</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-867"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">InitialDefrostTime</span>        <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-868"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">RateofDefrostTimeIncrease</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-869"></a>    <span class="k">END IF</span>
<a name="ln-870"></a>
<a name="ln-871"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-872"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-873"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_Yes</span>
<a name="ln-874"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-875"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_No</span>
<a name="ln-876"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-877"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-878"></a><span class="k">          </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_Yes</span>
<a name="ln-879"></a>        <span class="k">ELSE</span>
<a name="ln-880"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: incorrect econo lockout: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-881"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-882"></a>        <span class="k">END IF</span>
<a name="ln-883"></a><span class="k">    END SELECT</span>
<a name="ln-884"></a>
<a name="ln-885"></a><span class="k">    CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">),</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-886"></a>                     <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Process Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-887"></a>  <span class="k">END DO</span> <span class="c">! end of input loop over air to air generic heat exchangers</span>
<a name="ln-888"></a>
<a name="ln-889"></a><span class="c">! loop over the desiccant balanced heat exchangers and load their input data</span>
<a name="ln-890"></a>  <span class="k">DO </span><span class="n">ExchIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumDesiccantBalancedExchs</span>
<a name="ln-891"></a>    <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;HeatExchanger:Desiccant:BalancedFlow&#39;</span>
<a name="ln-892"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">ExchIndex</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,&amp;</span>
<a name="ln-893"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-894"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-895"></a>    <span class="n">ExchNum</span> <span class="o">=</span> <span class="n">ExchIndex</span><span class="o">+</span><span class="n">NumAirToAirPlateExchs</span><span class="o">+</span><span class="n">NumAirToAirGenericExchs</span>
<a name="ln-896"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-897"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-898"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">ExchNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-899"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-900"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-901"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-902"></a>    <span class="n">ENDIF</span>
<a name="ln-903"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-904"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span> <span class="o">=</span> <span class="n">HX_DESICCANT_BALANCED</span>
<a name="ln-905"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-906"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-907"></a>    <span class="k">ELSE</span>
<a name="ln-908"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-909"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-910"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-911"></a>           <span class="s1">&#39; entered =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-912"></a>           <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-913"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-914"></a>      <span class="k">END IF</span>
<a name="ln-915"></a><span class="k">    END IF</span>
<a name="ln-916"></a>    <span class="c">! desiccant HX&#39;s usually refer to process and regeneration air streams</span>
<a name="ln-917"></a>    <span class="c">! In this module, Sup = Regeneration nodes and Sec = Process nodes</span>
<a name="ln-918"></a>    <span class="c">! regeneration air inlet and outlet nodes</span>
<a name="ln-919"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-920"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-921"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-922"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-923"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-924"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-925"></a>    <span class="c">! process air inlet and outlet nodes</span>
<a name="ln-926"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-927"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-928"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-929"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-930"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-931"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-932"></a>
<a name="ln-933"></a>    <span class="c">! Set up the component set for the process side of the HX (Sec = Process)</span>
<a name="ln-934"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">),</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInletNode</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-935"></a>                     <span class="n">NodeID</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecOutletNode</span><span class="p">),</span><span class="s1">&#39;Process Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-936"></a>
<a name="ln-937"></a>    <span class="n">HeatExchPerfType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-938"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatExchPerfType</span><span class="p">,</span><span class="s1">&#39;HeatExchanger:Desiccant:BalancedFlow:PerformanceDataType1&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-939"></a><span class="k">       </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatExchPerfTypeNum</span> <span class="o">=</span> <span class="n">BALANCEDHX_PERFDATATYPE1</span>
<a name="ln-940"></a>    <span class="k">ELSE</span>
<a name="ln-941"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-942"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid performance data type selected.&#39;</span><span class="p">)</span>
<a name="ln-943"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...performance data type selected = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatExchPerfType</span><span class="p">))</span>
<a name="ln-944"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-945"></a>    <span class="k">END IF</span>
<a name="ln-946"></a>
<a name="ln-947"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatExchPerfName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-948"></a>
<a name="ln-949"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-950"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-951"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_Yes</span>
<a name="ln-952"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-953"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_No</span>
<a name="ln-954"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-955"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-956"></a><span class="k">          </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="o">=</span> <span class="n">EconoLockOut_No</span>
<a name="ln-957"></a>        <span class="k">ELSE</span>
<a name="ln-958"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: incorrect econo lockout: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-959"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-960"></a>        <span class="k">END IF</span>
<a name="ln-961"></a><span class="k">    END SELECT</span>
<a name="ln-962"></a>
<a name="ln-963"></a><span class="k">  END DO</span> <span class="c">! end of input loop over desiccant balanced heat exchangers</span>
<a name="ln-964"></a>
<a name="ln-965"></a>  <span class="c">! get performance data set for balanced desiccant heat exchanger</span>
<a name="ln-966"></a>
<a name="ln-967"></a>    <span class="k">DO </span><span class="n">PerfDataIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumDesBalExchsPerfDataType1</span>
<a name="ln-968"></a>      <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;HeatExchanger:Desiccant:BalancedFlow:PerformanceDataType1&#39;</span>
<a name="ln-969"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">PerfDataIndex</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,&amp;</span>
<a name="ln-970"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-971"></a>                         <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-972"></a>      <span class="n">PerfDataNum</span> <span class="o">=</span> <span class="n">PerfDataIndex</span>
<a name="ln-973"></a>      <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-974"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-975"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">BalDesDehumPerfData</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">PerfDataNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-976"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-977"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-978"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-979"></a>      <span class="n">ENDIF</span>
<a name="ln-980"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-981"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">PerfType</span> <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-982"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-983"></a>       <span class="c">! check validity</span>
<a name="ln-984"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-985"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-986"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Nominal air flow rate must be greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-987"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-988"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-989"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-990"></a>      <span class="k">END IF</span>
<a name="ln-991"></a>
<a name="ln-992"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomProcAirFaceVel</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-993"></a>      <span class="c">! check validity</span>
<a name="ln-994"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomProcAirFaceVel</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-995"></a>                                            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomProcAirFaceVel</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">6.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-996"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-997"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Nominal air face velocity cannot be less than or equal to zero or greater than 6 m/s.&#39;</span><span class="p">)</span>
<a name="ln-998"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-999"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomProcAirFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1000"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1001"></a>      <span class="k">END IF</span>
<a name="ln-1002"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomElecPower</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1003"></a>      <span class="c">! check validity</span>
<a name="ln-1004"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomElecPower</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1005"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1006"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Nominal electric power cannot be less than zero.&#39;</span><span class="p">)</span>
<a name="ln-1007"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1008"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">NomElecPower</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1009"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1010"></a>      <span class="k">END IF</span>
<a name="ln-1011"></a>
<a name="ln-1012"></a>      <span class="c">! regen outlet temp variables</span>
<a name="ln-1013"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B1</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1014"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B2</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1015"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B3</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1016"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B4</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1017"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B5</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1018"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B6</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1019"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B7</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1020"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">B8</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a><span class="c">!     Check that the minimum is not greater than or equal to the maximum for each of the following model boundaries</span>
<a name="ln-1023"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1024"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1025"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1026"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1027"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1028"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regeneration inlet air humidity ratio must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1029"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1030"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1031"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1032"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1033"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1034"></a>      <span class="k">END IF</span>
<a name="ln-1035"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1036"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1037"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1038"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regeneration inlet air humidity ratio must be greater than&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1039"></a>                               <span class="s1">&#39; or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1040"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1041"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1042"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1043"></a>      <span class="k">END IF</span>
<a name="ln-1044"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1045"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1046"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1047"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of regeneration inlet air humidity ratio must be less than or equal to 1.&#39;</span><span class="p">)</span>
<a name="ln-1048"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1049"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1050"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1051"></a>      <span class="k">END IF</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1054"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1055"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1056"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1057"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1058"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regeneration inlet air temperature must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1059"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1060"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1061"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1062"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1063"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1064"></a>      <span class="k">END IF</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1067"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-1068"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1069"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1070"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1071"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air humidity ratio must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1072"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1073"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1074"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1075"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1076"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1077"></a>      <span class="k">END IF</span>
<a name="ln-1078"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1079"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1080"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1081"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air humidity ratio must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1082"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1083"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1084"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1085"></a>      <span class="k">END IF</span>
<a name="ln-1086"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1087"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1088"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1089"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of process inlet air humidity ratio must be less than or equal to 1.&#39;</span><span class="p">)</span>
<a name="ln-1090"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1091"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1092"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1093"></a>      <span class="k">END IF</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-1096"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-1097"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1098"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1099"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1100"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air temperature must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1101"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1102"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1103"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1104"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1105"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1106"></a>      <span class="k">END IF</span>
<a name="ln-1107"></a>
<a name="ln-1108"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinFaceVel</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-1109"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-1110"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinFaceVel</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1111"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1112"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1113"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen air velocity must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1114"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1115"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1116"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1117"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1118"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1119"></a>      <span class="k">END IF</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-1122"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-1123"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1124"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1125"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1126"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen outlet air temperature must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1127"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1128"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1129"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1130"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1131"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1132"></a>      <span class="k">END IF</span>
<a name="ln-1133"></a>
<a name="ln-1134"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1135"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1136"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1137"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1138"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1139"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen inlet air relative humidity must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1140"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1141"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1142"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1143"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1144"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1145"></a>      <span class="k">END IF</span>
<a name="ln-1146"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1147"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1148"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1149"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen inlet air relative humidity must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1150"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1151"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1152"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1153"></a>      <span class="k">END IF</span>
<a name="ln-1154"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1155"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1156"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1157"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of regen inlet air relative humidity must be less than or equal to 100.&#39;</span><span class="p">)</span>
<a name="ln-1158"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1159"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1160"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1161"></a>      <span class="k">END IF</span>
<a name="ln-1162"></a>
<a name="ln-1163"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1164"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1165"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1166"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1167"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1168"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air relative humidity must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1169"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1170"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1171"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1172"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1173"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1174"></a>      <span class="k">END IF</span>
<a name="ln-1175"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1176"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1177"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1178"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air relative humidity must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1179"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1180"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1181"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1182"></a>      <span class="k">END IF</span>
<a name="ln-1183"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1184"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1185"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air temperature equation.&#39;</span><span class="p">)</span>
<a name="ln-1186"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of process inlet air relative humidity must be less than or equal to 100.&#39;</span><span class="p">)</span>
<a name="ln-1187"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1188"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1189"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1190"></a>      <span class="k">END IF</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a>      <span class="c">! regen outlet humidity ratio variables</span>
<a name="ln-1193"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C1</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<a name="ln-1194"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C2</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<a name="ln-1195"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C3</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<a name="ln-1196"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C4</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<a name="ln-1197"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C5</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a name="ln-1198"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C6</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<a name="ln-1199"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C7</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>
<a name="ln-1200"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">C8</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<a name="ln-1201"></a>
<a name="ln-1202"></a><span class="c">!     Check that the minimum is not greater than or equal to the maximum for each of the following model boundaries</span>
<a name="ln-1203"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
<a name="ln-1204"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<a name="ln-1205"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1206"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1207"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1208"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regeneration inlet air humidity ratio must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1209"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1210"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1211"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1212"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1213"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1214"></a>      <span class="k">END IF</span>
<a name="ln-1215"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1216"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1217"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1218"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regeneration inlet air humidity ratio must be greater than&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1219"></a>                               <span class="s1">&#39; or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1220"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1221"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1222"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1223"></a>      <span class="k">END IF</span>
<a name="ln-1224"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1225"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1226"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1227"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of regeneration inlet air humidity ratio must be less than or equal to 1.&#39;</span><span class="p">)</span>
<a name="ln-1228"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1229"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1230"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1231"></a>      <span class="k">END IF</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<a name="ln-1234"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>
<a name="ln-1235"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1236"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1237"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1238"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regeneration inlet air temperature must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1239"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1240"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1241"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1242"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1243"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1244"></a>      <span class="k">END IF</span>
<a name="ln-1245"></a>
<a name="ln-1246"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<a name="ln-1247"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<a name="ln-1248"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1249"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1250"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1251"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air humidity ratio must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1252"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1253"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1254"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1255"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1256"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1257"></a>      <span class="k">END IF</span>
<a name="ln-1258"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1259"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1260"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1261"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air humidity ratio must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1262"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1263"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1264"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1265"></a>      <span class="k">END IF</span>
<a name="ln-1266"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1267"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1268"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1269"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of process inlet air humidity ratio must be less than or equal to 1.&#39;</span><span class="p">)</span>
<a name="ln-1270"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered by user = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1271"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1272"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1273"></a>      <span class="k">END IF</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a name="ln-1276"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<a name="ln-1277"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1278"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1279"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1280"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air temperature must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1281"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1282"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1283"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1284"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1285"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1286"></a>      <span class="k">END IF</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinFaceVel</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<a name="ln-1289"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<a name="ln-1290"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinFaceVel</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1291"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1292"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1293"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen air velocity must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1294"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1295"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1296"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1297"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1298"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1299"></a>      <span class="k">END IF</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span>
<a name="ln-1302"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>
<a name="ln-1303"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1304"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1305"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1306"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen outlet air humidity ratio must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1307"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1308"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1309"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1310"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1311"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1312"></a>      <span class="k">END IF</span>
<a name="ln-1313"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1314"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1315"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1316"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen outlet air humidity ratio must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1317"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1318"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1319"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1320"></a>      <span class="k">END IF</span>
<a name="ln-1321"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1322"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1323"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1324"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of regen outlet air humidity ratio must be less or equal to 1.&#39;</span><span class="p">)</span>
<a name="ln-1325"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1326"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1327"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1328"></a>      <span class="k">END IF</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1331"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1332"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1333"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1334"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1335"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen inlet air relative humidity must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1336"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1337"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1338"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1339"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1340"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1341"></a>      <span class="k">END IF</span>
<a name="ln-1342"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1343"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1344"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1345"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of regen inlet air relative humidity must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1346"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1347"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1348"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1349"></a>      <span class="k">END IF</span>
<a name="ln-1350"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1351"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1352"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1353"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of regen inlet air relative humidity must be less or equal to 100.&#39;</span><span class="p">)</span>
<a name="ln-1354"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1355"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1356"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1357"></a>      <span class="k">END IF</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1360"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1361"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1362"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1363"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min/max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1364"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air relative humidity must be less than the maximum.&#39;</span><span class="p">)</span>
<a name="ln-1365"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1366"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1367"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1368"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1369"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1370"></a>      <span class="k">END IF</span>
<a name="ln-1371"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1372"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1373"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in min boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1374"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the minimum value of process inlet air relative humidity must be greater than or equal to 0.&#39;</span><span class="p">)</span>
<a name="ln-1375"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... minimum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1376"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1377"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1378"></a>      <span class="k">END IF</span>
<a name="ln-1379"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1380"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1381"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in max boundary for the regen outlet air humidity ratio equation.&#39;</span><span class="p">)</span>
<a name="ln-1382"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... the maximum value of process inlet air relative humidity must be less than or equal to 100.&#39;</span><span class="p">)</span>
<a name="ln-1383"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... maximum value entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1384"></a>                             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1385"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1386"></a>      <span class="k">END IF</span>
<a name="ln-1387"></a>
<a name="ln-1388"></a><span class="k">    END DO</span>
<a name="ln-1389"></a>  <span class="c">! getting performance data set for balanced desiccant heat exchanger ends</span>
<a name="ln-1390"></a>
<a name="ln-1391"></a>  <span class="c">! match desiccant heat exchanger index to performance data index</span>
<a name="ln-1392"></a>    <span class="k">DO </span><span class="n">ExchIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDesiccantBalancedExchs</span>
<a name="ln-1393"></a>      <span class="n">ExchNum</span> <span class="o">=</span> <span class="n">ExchIndex</span> <span class="o">+</span> <span class="n">NumAirToAirPlateExchs</span> <span class="o">+</span> <span class="n">NumAirToAirGenericExchs</span>
<a name="ln-1394"></a>      <span class="k">DO </span><span class="n">PerfDataNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDesBalExchsPerfDataType1</span>
<a name="ln-1395"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatExchPerfName</span><span class="p">,</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">PerfDataNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1396"></a><span class="k">          </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span> <span class="o">=</span> <span class="n">PerfDataNum</span>
<a name="ln-1397"></a>          <span class="k">EXIT</span>
<a name="ln-1398"></a><span class="k">        END IF</span>
<a name="ln-1399"></a><span class="k">      END DO</span>
<a name="ln-1400"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1401"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1402"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Performance data set not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">HeatExchPerfName</span><span class="p">))</span>
<a name="ln-1403"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1404"></a>      <span class="k">ELSE</span>
<a name="ln-1405"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1406"></a><span class="k">          </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">FaceArea</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1407"></a>                                      <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">NomProcAirFaceVel</span><span class="p">)</span>
<a name="ln-1408"></a>        <span class="k">END IF</span>
<a name="ln-1409"></a><span class="k">      END IF</span>
<a name="ln-1410"></a><span class="k">    END DO</span>
<a name="ln-1411"></a>  <span class="c">! matching done</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>  <span class="c">! setup common report variables for heat exchangers</span>
<a name="ln-1414"></a>  <span class="k">DO </span><span class="n">ExchIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumHeatExchangers</span>
<a name="ln-1415"></a>    <span class="n">ExchNum</span> <span class="o">=</span> <span class="n">ExchIndex</span>
<a name="ln-1416"></a>    <span class="c">! CurrentModuleObject=&#39;HeatExchanger:AirToAir:FlatPlate/AirToAir:SensibleAndLatent/Desiccant:BalancedFlow&#39;)</span>
<a name="ln-1417"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Sensible Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1418"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1419"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Sensible Heating Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-1420"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1421"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Latent Gain Rate [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1422"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1423"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Latent Gain Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-1424"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1425"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Total Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1426"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1427"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Total Heating Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-1428"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1429"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span> <span class="o">=</span> <span class="s1">&#39;HEAT RECOVERY FOR HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span> <span class="o">=</span> <span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1430"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1431"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1432"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-1433"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1434"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1435"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1436"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Latent Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-1437"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1438"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1439"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1440"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Total Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-1441"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1442"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span> <span class="o">=</span> <span class="s1">&#39;HEAT RECOVERY FOR COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span> <span class="o">=</span> <span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Electric Power [W]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ElecUseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-1445"></a>                             <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1446"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ElecUseEnergy</span><span class="p">,&amp;</span>
<a name="ln-1447"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1448"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="n">EndUseKey</span> <span class="o">=</span> <span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span> <span class="o">=</span> <span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1449"></a>  <span class="k">END DO</span>
<a name="ln-1450"></a>
<a name="ln-1451"></a>  <span class="c">! setup additional report variables for generic heat exchangers</span>
<a name="ln-1452"></a>  <span class="k">DO </span><span class="n">ExchIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumAirToAirGenericExchs</span>
<a name="ln-1453"></a>    <span class="c">! generic heat exchangers are read in after flat plate heat exchanger objects (index needs to be set correctly)</span>
<a name="ln-1454"></a>    <span class="c">! CurrentModuleObject=HeatExchanger:AirToAir:SensibleAndLatent</span>
<a name="ln-1455"></a>    <span class="n">ExchNum</span> <span class="o">=</span> <span class="n">ExchIndex</span> <span class="o">+</span> <span class="n">NumAirToAirPlateExchs</span>
<a name="ln-1456"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Sensible Effectiveness []&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-1457"></a>                             <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1458"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Latent Effectiveness []&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-1459"></a>                             <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1460"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Supply Air Bypass Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-1461"></a>                             <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1462"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Exhaust Air Bypass Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1463"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1464"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heat Exchanger Defrost Time Fraction []&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">DefrostFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1465"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1466"></a>
<a name="ln-1467"></a>  <span class="k">END DO</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1470"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in input.  Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-1471"></a>  <span class="k">END IF</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a><span class="k">  RETURN</span>
<a name="ln-1474"></a><span class="k">END SUBROUTINE </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a><span class="k">SUBROUTINE </span><span class="n">InitHeatRecovery</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">CompanionCoilIndex</span><span class="p">)</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1479"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-1480"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-1481"></a>          <span class="c">!       MODIFIED       F Buhl Nov 2000, D Shirey Feb 2003</span>
<a name="ln-1482"></a>          <span class="c">!                      B Griffith May 2009, EMS setpoint check</span>
<a name="ln-1483"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1486"></a>          <span class="c">! This subroutine is for initializations of the Heat Recovery Components.</span>
<a name="ln-1487"></a>
<a name="ln-1488"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1489"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-1490"></a>
<a name="ln-1491"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1492"></a>          <span class="c">! na</span>
<a name="ln-1493"></a>
<a name="ln-1494"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1495"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-1496"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">,</span> <span class="n">DXCoilFullLoadOutAirHumRat</span>
<a name="ln-1497"></a><span class="c">!  USE DataZoneEquipment,  ONLY: ZoneEquipInputsFilled,CheckZoneEquipmentList</span>
<a name="ln-1498"></a>  <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">,</span> <span class="n">iHumidityRatioMaxSetpoint</span>
<a name="ln-1499"></a>  <span class="k">USE </span><span class="n">DataGLobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">AnyEnergyManagementSystemInModel</span>
<a name="ln-1500"></a>
<a name="ln-1501"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1502"></a>
<a name="ln-1503"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1504"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExchNum</span> <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-1505"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompanionCoilIndex</span>
<a name="ln-1506"></a>
<a name="ln-1507"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1508"></a>          <span class="c">! na</span>
<a name="ln-1509"></a>
<a name="ln-1510"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1511"></a>          <span class="c">! na</span>
<a name="ln-1512"></a>
<a name="ln-1513"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1514"></a>          <span class="c">! na</span>
<a name="ln-1515"></a>
<a name="ln-1516"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1517"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ExIndex</span>       <span class="c">! do loop index</span>
<a name="ln-1518"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SupInNode</span>     <span class="c">! supply air inlet node number</span>
<a name="ln-1519"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SecInNode</span>     <span class="c">! secondary air inlet node number</span>
<a name="ln-1520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CMIN0</span>         <span class="c">! minimum capacity flow</span>
<a name="ln-1521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CMAX0</span>         <span class="c">! maximum capacity flow</span>
<a name="ln-1522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eps0</span>          <span class="c">! effectiveness at rated conditions</span>
<a name="ln-1523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NTU0</span>          <span class="c">! NTU at rated conditions</span>
<a name="ln-1524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RhoAir</span>        <span class="c">! air density at outside pressure &amp; standard temperature and humidity</span>
<a name="ln-1525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpAir</span>         <span class="c">! heat capacity of air</span>
<a name="ln-1526"></a>                                       <span class="c">! of humidity ratio and temperature</span>
<a name="ln-1527"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1528"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeAllocate</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1529"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">MySetPointTest</span>
<a name="ln-1530"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">MySizeFlag</span>
<a name="ln-1531"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ErrStat</span>       <span class="c">! error status returned by CalculateNTUfromEpsAndZ</span>
<a name="ln-1532"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">FatalError</span>    <span class="c">! fatal error flag</span>
<a name="ln-1533"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">LocalWarningError</span> <span class="c">! warning error flag</span>
<a name="ln-1534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Z</span>             <span class="c">! Min/max flow ratio</span>
<a name="ln-1535"></a><span class="c">!  LOGICAL,SAVE        :: ZoneEquipmentListChecked = .false.  ! True after the Zone Equipment List has been checked for items</span>
<a name="ln-1536"></a>
<a name="ln-1537"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyOneTimeAllocate</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1538"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MySetPointTest</span><span class="p">(</span><span class="n">NumHeatExchangers</span><span class="p">))</span>
<a name="ln-1539"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumHeatExchangers</span><span class="p">))</span>
<a name="ln-1540"></a>    <span class="n">MySetPointTest</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1541"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1542"></a>    <span class="n">MyOneTimeAllocate</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1543"></a>  <span class="k">END IF</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a><span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1546"></a>
<a name="ln-1547"></a><span class="k">  CALL </span><span class="n">SizeHeatRecovery</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)</span>
<a name="ln-1548"></a>  <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1549"></a>
<a name="ln-1550"></a><span class="k">END IF</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>
<a name="ln-1553"></a><span class="k">  </span><span class="n">FatalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1554"></a>  <span class="n">LocalWarningError</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1555"></a>
<a name="ln-1556"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-1557"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1558"></a>    <span class="c">!I believe that all of these initializations should be taking place at the SCFM conditions</span>
<a name="ln-1559"></a>    <span class="n">RhoAir</span> <span class="o">=</span> <span class="n">StdRhoAir</span>
<a name="ln-1560"></a><span class="c">!    RhoAir = PsyRhoAirFnPbTdbW(101325.0,20.0,0.0)  do we want standard air density at sea level for generic ERVs per ARI 1060?</span>
<a name="ln-1561"></a>    <span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1562"></a>    <span class="k">DO </span><span class="n">ExIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumHeatExchangers</span>
<a name="ln-1563"></a>
<a name="ln-1564"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">)</span>
<a name="ln-1565"></a>
<a name="ln-1566"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">HX_AIRTOAIR_FLATPLATE</span><span class="p">)</span>
<a name="ln-1567"></a>
<a name="ln-1568"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span> <span class="o">=</span> <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-1569"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span> <span class="o">=</span> <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirVolFlow</span>
<a name="ln-1570"></a>        <span class="c">! Note: the capacity stream is here simply the mass flow</span>
<a name="ln-1571"></a>        <span class="c">!       since the thermal capacity can be assumed to be</span>
<a name="ln-1572"></a>        <span class="c">!       equal for both streams</span>
<a name="ln-1573"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span> <span class="o">&gt;</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1574"></a><span class="k">          </span><span class="n">CMIN0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span>
<a name="ln-1575"></a>          <span class="n">CMAX0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span>
<a name="ln-1576"></a>        <span class="k">ELSE</span>
<a name="ln-1577"></a><span class="k">          </span><span class="n">CMIN0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span>
<a name="ln-1578"></a>          <span class="n">CMAX0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span>
<a name="ln-1579"></a>        <span class="k">END IF</span>
<a name="ln-1580"></a>
<a name="ln-1581"></a><span class="k">        </span><span class="n">Eps0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1582"></a>                 <span class="n">SafeDiv</span><span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirInTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1583"></a>                 <span class="n">CMin0</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirInTemp</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1584"></a>        <span class="n">Z</span> <span class="o">=</span> <span class="n">CMIN0</span><span class="o">/</span><span class="n">CMAX0</span>
<a name="ln-1585"></a>
<a name="ln-1586"></a>        <span class="n">ErrStat</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1587"></a>        <span class="k">CALL </span><span class="n">CalculateNTUfromEpsAndZ</span><span class="p">(</span><span class="n">NTU0</span><span class="p">,</span> <span class="n">ErrStat</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">FlowArr</span><span class="p">,</span> <span class="n">Eps0</span><span class="p">)</span>
<a name="ln-1588"></a>
<a name="ln-1589"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrStat</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a><span class="k">          </span><span class="n">FatalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1592"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;In the HeatExchanger:AirToAir:FlatPlate component &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1593"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the mass flow ratio is out of bounds&#39;</span><span class="p">)</span>
<a name="ln-1594"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The mass flow ratio is (Min_Mass_Flow_Rate / Max_Mass_Flow_Rate) = &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1595"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1596"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The mass flow ratio should be &gt;= 0.0 and &lt;= 1.0&#39;</span><span class="p">)</span>
<a name="ln-1597"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min_Mass_Flow_Rate = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RhoAir</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [air density] * &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1598"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1599"></a>                                                         <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirVolFlow</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [Min_Vol_Flow_Rate]&#39;</span> <span class="p">)</span>
<a name="ln-1600"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Max_Mass_Flow_Rate = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RhoAir</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [air density] * &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1601"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1602"></a>                                                         <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirVolFlow</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [Max_Vol_Flow_Rate]&#39;</span> <span class="p">)</span>
<a name="ln-1603"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ErrStat</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1604"></a><span class="k">          </span><span class="n">FatalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1605"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;In the HeatExchanger:AirToAir:FlatPlate component &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1606"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the calculated nominal effectiveness is out of bounds&#39;</span><span class="p">)</span>
<a name="ln-1607"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The effectiveness is &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Eps0</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1608"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The effectiveness should be &gt;= 0.0 and &lt;= &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1609"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">Z</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1610"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Eff = (Nom_Sup_Mass_Flow_Rate/Min_Mass_Flow_Rate)*(T_nom_sup_out-T_nom_sup_in)&#39;</span> <span class="p">&amp;</span>
<a name="ln-1611"></a>                                  <span class="o">//</span> <span class="s1">&#39;/(T_nom_sec_in-T_nom_sup_in)&#39;</span><span class="p">)</span>
<a name="ln-1612"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperatures are user inputs. The mass flow rates are user input volume flow rates&#39;</span><span class="p">)</span>
<a name="ln-1613"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  times the density of air [&#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RhoAir</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; kg/m3]&#39;</span> <span class="p">)</span>
<a name="ln-1614"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Change these inputs to obtain a physically realizable heat exchanger effectiveness&#39;</span><span class="p">)</span>
<a name="ln-1615"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ErrStat</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1616"></a><span class="k">          </span><span class="n">FatalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1617"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;In the HeatExchanger:AirToAir:FlatPlate component &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1618"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the calculated nominal effectiveness is out of bounds&#39;</span><span class="p">)</span>
<a name="ln-1619"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The effectiveness is &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Eps0</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1620"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The effectiveness should be &gt;= 0.0 and &lt;= &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1621"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="p">))</span><span class="o">/</span><span class="n">Z</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1622"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Eff = (Nom_Sup_Mass_Flow_Rate/Min_Mass_Flow_Rate)*(T_nom_sup_out-T_nom_sup_in)&#39;</span> <span class="p">&amp;</span>
<a name="ln-1623"></a>                                  <span class="o">//</span> <span class="s1">&#39;/(T_nom_sec_in-T_nom_sup_in)&#39;</span><span class="p">)</span>
<a name="ln-1624"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperatures are user inputs. The mass flow rates are user input volume flow rates&#39;</span><span class="p">)</span>
<a name="ln-1625"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  times the density of air [&#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RhoAir</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; kg/m3]&#39;</span> <span class="p">)</span>
<a name="ln-1626"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Change these inputs to obtain a physically realizable heat exchanger effectiveness&#39;</span><span class="p">)</span>
<a name="ln-1627"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ErrStat</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1628"></a><span class="k">          </span><span class="n">FatalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1629"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;In the HeatExchanger:AirToAir:FlatPlate component &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1630"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the quantity Eff_nom*(Min_Mass_Flow_Rate / Max_Mass_Flow_Rate) is out of bounds&#39;</span><span class="p">)</span>
<a name="ln-1631"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The value is &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Eps0</span><span class="o">*</span><span class="n">Z</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1632"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The value should be &gt;= 0.0 and &lt;= &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1633"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="p">(</span><span class="n">SMALL</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1634"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Eff_nom = (Nom_Sup_Mass_Flow_Rate/Min_Mass_Flow_Rate) * (T_nom_sup_out - T_nom_sup_in)&#39;</span> <span class="p">&amp;</span>
<a name="ln-1635"></a>                                  <span class="o">//</span> <span class="s1">&#39;/(T_nom_sec_in - T_nom_sup_in)&#39;</span><span class="p">)</span>
<a name="ln-1636"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperatures are user inputs. The mass flow rates are user input volume flow rates&#39;</span><span class="p">)</span>
<a name="ln-1637"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  times the density of air [&#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RhoAir</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; kg/m3]&#39;</span> <span class="p">)</span>
<a name="ln-1638"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Change these inputs to obtain a physically realizable product of effectiveness&#39;</span> <span class="p">&amp;</span>
<a name="ln-1639"></a>                                  <span class="o">//</span> <span class="s1">&#39;times min/max mass ratio for this heat exchanger&#39;</span><span class="p">)</span>
<a name="ln-1640"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ErrStat</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1641"></a><span class="k">          </span><span class="n">FatalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1642"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;In the HeatExchanger:AirToAir:FlatPlate component &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1643"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the calculated nominal effectiveness is out of bounds&#39;</span><span class="p">)</span>
<a name="ln-1644"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The effectiveness is &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Eps0</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1645"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The effectiveness should be &gt;= 0.0 and &lt;= 1.0&#39;</span><span class="p">)</span>
<a name="ln-1646"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Eff = (Nom_Sup_Mass_Flow_Rate/Min_Mass_Flow_Rate)*(T_nom_sup_out-T_nom_sup_in)&#39;</span> <span class="p">&amp;</span>
<a name="ln-1647"></a>                                  <span class="o">//</span> <span class="s1">&#39;/(T_nom_sec_in-T_nom_sup_in)&#39;</span><span class="p">)</span>
<a name="ln-1648"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperatures are user inputs. The mass flow rates are user input volume flow rates&#39;</span><span class="p">)</span>
<a name="ln-1649"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  times the density of air [&#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RhoAir</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; kg/m3]&#39;</span> <span class="p">)</span>
<a name="ln-1650"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Change these inputs to obtain a physically realizable heat exchanger effectiveness&#39;</span><span class="p">)</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a>        <span class="k">END IF</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">FatalError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1655"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Heat exchanger design calculation caused fatal error: program terminated.&#39;</span><span class="p">)</span>
<a name="ln-1656"></a>        <span class="k">END IF</span>
<a name="ln-1657"></a>
<a name="ln-1658"></a><span class="k">        </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">UA0</span>    <span class="o">=</span> <span class="n">NTU0</span> <span class="o">*</span> <span class="n">CMin0</span> <span class="o">*</span><span class="n">CpAir</span>
<a name="ln-1659"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">mTSup0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirInTemp</span> <span class="o">+</span> <span class="n">KELVZERO</span><span class="p">)</span>
<a name="ln-1660"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">mTSec0</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirInTemp</span> <span class="o">+</span> <span class="n">KELVZERO</span><span class="p">)</span>
<a name="ln-1661"></a>
<a name="ln-1662"></a>        <span class="c">! check validity</span>
<a name="ln-1663"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span> <span class="o">&lt;</span> <span class="n">SmallMassFlow</span><span class="o">*</span><span class="n">SmallMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1664"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s2">&quot;Mass flow in HeatExchanger:AirToAir:FlatPlate too small in initialization.&quot;</span><span class="p">)</span>
<a name="ln-1665"></a>        <span class="k">END IF</span>
<a name="ln-1666"></a>
<a name="ln-1667"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">mTSup0</span> <span class="o">&lt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1668"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s2">&quot;(m*T)Sup,in in HeatExchanger:AirToAir:FlatPlate too small in initialization.&quot;</span><span class="p">)</span>
<a name="ln-1669"></a>        <span class="k">END IF</span>
<a name="ln-1670"></a>
<a name="ln-1671"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">mTSec0</span> <span class="o">&lt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1672"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s2">&quot;(m*T)Sec,in in HeatExchanger:AirToAir:FlatPlate too small in initialization.&quot;</span><span class="p">)</span>
<a name="ln-1673"></a>        <span class="k">END IF</span>
<a name="ln-1674"></a>
<a name="ln-1675"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CMin0</span> <span class="o">&lt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1676"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s2">&quot;CMin0 in HeatExchanger:AirToAir:FlatPlate too small in initialization.&quot;</span><span class="p">)</span>
<a name="ln-1677"></a>        <span class="k">END IF</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a><span class="k">      CASE</span><span class="p">(</span><span class="n">HX_AIRTOAIR_GENERIC</span><span class="p">)</span>
<a name="ln-1680"></a>
<a name="ln-1681"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">SupOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">ControlToTemperatureSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1682"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">SupOutletNode</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1683"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1684"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Missing temperature setpoint for &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1685"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;&quot; :&#39;</span><span class="p">)</span>
<a name="ln-1686"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  use a Setpoint Manager to establish a setpoint at the supply air outlet node &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1687"></a>                               <span class="s1">&#39;of the Heat Exchanger.&#39;</span><span class="p">)</span>
<a name="ln-1688"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39; Previous condition causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1689"></a>            <span class="k">ELSE</span>
<a name="ln-1690"></a>             <span class="c">! need call to EMS to check node</span>
<a name="ln-1691"></a>              <span class="k">CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">SupOutletNode</span><span class="p">,</span><span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">FatalError</span><span class="p">)</span>
<a name="ln-1692"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FatalError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1693"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Missing temperature setpoint for &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1694"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;&quot; :&#39;</span><span class="p">)</span>
<a name="ln-1695"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  use a Setpoint Manager to establish a setpoint at the supply air outlet node &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1696"></a>                                 <span class="s1">&#39;of the Heat Exchanger.&#39;</span><span class="p">)</span>
<a name="ln-1697"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  or use an EMS actuator to establish a setpoint at the supply air outlet node &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1698"></a>                                 <span class="s1">&#39;of the Heat Exchanger.&#39;</span><span class="p">)</span>
<a name="ln-1699"></a>                <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39; Previous condition causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1700"></a>              <span class="n">ENDIF</span>
<a name="ln-1701"></a>            <span class="n">ENDIF</span>
<a name="ln-1702"></a>          <span class="k">END IF</span>
<a name="ln-1703"></a><span class="k">        END IF</span>
<a name="ln-1704"></a>
<a name="ln-1705"></a><span class="k">      CASE</span><span class="p">(</span><span class="n">HX_DESICCANT_BALANCED</span><span class="p">)</span>
<a name="ln-1706"></a>
<a name="ln-1707"></a>
<a name="ln-1708"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1709"></a><span class="c">!       Will never get here</span>
<a name="ln-1710"></a>
<a name="ln-1711"></a>      <span class="k">END SELECT</span>
<a name="ln-1712"></a>
<a name="ln-1713"></a><span class="k">    END DO</span>
<a name="ln-1714"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a>  <span class="k">END IF</span>
<a name="ln-1717"></a>
<a name="ln-1718"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1719"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1720"></a>  <span class="n">ENDIF</span>
<a name="ln-1721"></a>
<a name="ln-1722"></a>  <span class="c">! Do these initializations every time step</span>
<a name="ln-1723"></a>  <span class="n">SupInNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInletNode</span>
<a name="ln-1724"></a>  <span class="n">SecInNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInletNode</span>
<a name="ln-1725"></a>
<a name="ln-1726"></a>  <span class="c">! Get information from inlet nodes</span>
<a name="ln-1727"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1728"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-1729"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInEnth</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-1730"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-1731"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1732"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-1733"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInEnth</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-1734"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-1735"></a>
<a name="ln-1736"></a>  <span class="c">! initialize the output variables</span>
<a name="ln-1737"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1738"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensHeatingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1739"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1740"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatHeatingEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1741"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1742"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotHeatingEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1743"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1744"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1745"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1746"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1747"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1748"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">TotCoolingEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1749"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ElecUseRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1750"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ElecUseEnergy</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1751"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1752"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1753"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1754"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a>
<a name="ln-1757"></a><span class="c">!  Initialize inlet conditions</span>
<a name="ln-1758"></a>
<a name="ln-1759"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">)</span>
<a name="ln-1760"></a>
<a name="ln-1761"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HX_AIRTOAIR_FLATPLATE</span><span class="p">)</span>
<a name="ln-1762"></a>
<a name="ln-1763"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HX_AIRTOAIR_GENERIC</span><span class="p">)</span>
<a name="ln-1764"></a>
<a name="ln-1765"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HX_DESICCANT_BALANCED</span><span class="p">)</span>
<a name="ln-1766"></a>
<a name="ln-1767"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MySetPointTest</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1768"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DoSetPointTest</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1769"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CalledFromParentObject</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1770"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecOutletNode</span><span class="p">)%</span><span class="n">HumRatMax</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1771"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1772"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Missing optional HumRatMax setpoint for &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1773"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1774"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...the simulation will continue without control of the desiccant heat exchanger to&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1775"></a>                                 <span class="s1">&#39; a maximum humidity ratio setpoint.&#39;</span><span class="p">)</span>
<a name="ln-1776"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use a Setpoint Manager to establish a setpoint at the process air outlet node &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1777"></a>                               <span class="s1">&#39;of the desiccant Heat Exchanger if control is desired.&#39;</span><span class="p">)</span>
<a name="ln-1778"></a>            <span class="k">ELSE</span>
<a name="ln-1779"></a>             <span class="c">! need call to EMS to check node</span>
<a name="ln-1780"></a>              <span class="k">CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecOutletNode</span><span class="p">,</span><span class="n">iHumidityRatioMaxSetpoint</span><span class="p">,</span> <span class="n">LocalWarningError</span><span class="p">)</span>
<a name="ln-1781"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">LocalWarningError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1782"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Missing optional HumRatMax setpoint for &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1783"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1784"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...the simulation will continue without control of the desiccant heat exchanger to&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1785"></a>                                 <span class="s1">&#39; a maximum humidity ratio setpoint.&#39;</span><span class="p">)</span>
<a name="ln-1786"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use a Setpoint Manager to establish a setpoint at the process air outlet node &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1787"></a>                               <span class="s1">&#39;of the desiccant Heat Exchanger if control is desired.&#39;</span><span class="p">)</span>
<a name="ln-1788"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...or use an EMS Actuator to establish a maximum humidity ratio setpoint at the &#39;</span> <span class="p">&amp;</span>
<a name="ln-1789"></a>                               <span class="o">//</span><span class="s1">&#39;process air outlet node of the desiccant Heat Exchanger if control is desired.&#39;</span><span class="p">)</span>
<a name="ln-1790"></a>              <span class="n">ENDIF</span>
<a name="ln-1791"></a>            <span class="n">ENDIF</span>
<a name="ln-1792"></a>          <span class="k">END IF</span>
<a name="ln-1793"></a><span class="k">        END IF</span>
<a name="ln-1794"></a><span class="k">        </span><span class="n">MySetPointTest</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1795"></a>      <span class="k">END IF</span>
<a name="ln-1796"></a><span class="k">    END IF</span>
<a name="ln-1797"></a>
<a name="ln-1798"></a><span class="k">    IF</span><span class="p">(</span><span class="n">CompanionCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1799"></a>
<a name="ln-1800"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">CompanionCoilIndex</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">CompanionCoilIndex</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1801"></a><span class="c">!       DX Coil is OFF, read actual inlet conditions</span>
<a name="ln-1802"></a>        <span class="n">FullLoadOutAirTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInTemp</span>
<a name="ln-1803"></a>        <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInHumRat</span>
<a name="ln-1804"></a>      <span class="k">ELSE</span>
<a name="ln-1805"></a><span class="c">!       DX Coil is ON, read full load DX coil outlet conditions (conditions HX sees when ON)</span>
<a name="ln-1806"></a>        <span class="n">FullLoadOutAirTemp</span>   <span class="o">=</span> <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">CompanionCoilIndex</span><span class="p">)</span>
<a name="ln-1807"></a>        <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">CompanionCoilIndex</span><span class="p">)</span>
<a name="ln-1808"></a>      <span class="k">END IF</span>
<a name="ln-1809"></a>
<a name="ln-1810"></a><span class="k">    ELSE</span>
<a name="ln-1811"></a>
<a name="ln-1812"></a><span class="c">!     HX only (not used in conjunction with DX coil), read inlet conditions</span>
<a name="ln-1813"></a>      <span class="n">FullLoadOutAirTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInTemp</span>
<a name="ln-1814"></a>      <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">SecInHumRat</span>
<a name="ln-1815"></a>
<a name="ln-1816"></a>    <span class="k">END IF</span>
<a name="ln-1817"></a>
<a name="ln-1818"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-1819"></a><span class="c">!   Will never get here</span>
<a name="ln-1820"></a>
<a name="ln-1821"></a>  <span class="k">END SELECT</span>
<a name="ln-1822"></a>
<a name="ln-1823"></a><span class="k">  RETURN</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a><span class="k">END SUBROUTINE </span><span class="n">InitHeatRecovery</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a><span class="k">SUBROUTINE </span><span class="n">SizeHeatRecovery</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)</span>
<a name="ln-1828"></a>
<a name="ln-1829"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1830"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-1831"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-1832"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1833"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1834"></a>
<a name="ln-1835"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1836"></a>          <span class="c">! This subroutine is for sizing Heat Exchanger components for which flow rates have not been</span>
<a name="ln-1837"></a>          <span class="c">! specified in the input. Currently, only nominal supply air flow rate for the generic HX can be autosized.</span>
<a name="ln-1838"></a>
<a name="ln-1839"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1840"></a>          <span class="c">! Obtains flow rates from the system or OA system sizing arrays</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1843"></a>          <span class="c">! na</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1846"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-1847"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallAirVolFlow</span><span class="p">,</span> <span class="n">Main</span><span class="p">,</span> <span class="n">Cooling</span><span class="p">,</span> <span class="n">Heating</span><span class="p">,</span> <span class="n">Other</span>
<a name="ln-1848"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-1849"></a>
<a name="ln-1850"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1851"></a>
<a name="ln-1852"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1853"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExchNum</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1856"></a>          <span class="c">! na</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1859"></a>          <span class="c">! na</span>
<a name="ln-1860"></a>
<a name="ln-1861"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1862"></a>          <span class="c">! na</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1865"></a>          <span class="c">! na</span>
<a name="ln-1866"></a>
<a name="ln-1867"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1868"></a>
<a name="ln-1869"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">),</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1872"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1873"></a>                                              <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-1874"></a>
<a name="ln-1875"></a>    <span class="k">END IF</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">),</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1880"></a>
<a name="ln-1881"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1882"></a>          <span class="c">! size to outdoor air volume flow rate if available</span>
<a name="ln-1883"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1884"></a><span class="k">            </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-1885"></a>          <span class="k">ELSE</span>
<a name="ln-1886"></a>            <span class="c">! ELSE size to supply air duct flow rate</span>
<a name="ln-1887"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-1888"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-1889"></a>                <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-1890"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-1891"></a>                <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-1892"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-1893"></a>                <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-1894"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-1895"></a>                <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-1896"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1897"></a>                <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-1898"></a>            <span class="k">END SELECT</span>
<a name="ln-1899"></a><span class="k">          END IF</span>
<a name="ln-1900"></a><span class="k">        ELSE</span>
<a name="ln-1901"></a><span class="k">          SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-1902"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-1903"></a>              <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-1904"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-1905"></a>              <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-1906"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-1907"></a>              <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-1908"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-1909"></a>              <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-1910"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1911"></a>              <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-1912"></a>          <span class="k">END SELECT</span>
<a name="ln-1913"></a><span class="k">        END IF</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a><span class="k">    END IF</span>
<a name="ln-1916"></a>
<a name="ln-1917"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1918"></a><span class="k">        </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1919"></a>        <span class="c">! Generic HX will be turned off if nominal air flow rate is 0, even if simulated air flow through</span>
<a name="ln-1920"></a>        <span class="c">! HX is greater than 0. Avoids a divide by 0 in Sub CalcAirToAirGenericHeatExch.</span>
<a name="ln-1921"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span> <span class="o">==</span> <span class="n">HX_AIRTOAIR_GENERIC</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1922"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;: &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1923"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... nominal supply air volume flow rate through the heat exchanger is sized to 0&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1924"></a>                                 <span class="s1">&#39;, see eio file for sizing results.&#39;</span><span class="p">)</span>
<a name="ln-1925"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... HX will not be enabled and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-1926"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... To eliminate this warning, check sizing and HX inputs to correct HX sizing issue.&#39;</span><span class="p">)</span>
<a name="ln-1927"></a>        <span class="k">END IF</span>
<a name="ln-1928"></a><span class="k">    END IF</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">),</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1931"></a>                           <span class="s1">&#39;Nominal Supply Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span><span class="p">)</span>
<a name="ln-1932"></a>
<a name="ln-1933"></a>  <span class="k">END IF</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a><span class="k">  RETURN</span>
<a name="ln-1936"></a>
<a name="ln-1937"></a><span class="k">END SUBROUTINE </span><span class="n">SizeHeatRecovery</span>
<a name="ln-1938"></a>
<a name="ln-1939"></a><span class="k">SUBROUTINE </span><span class="n">CalcAirToAirPlateHeatExch</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="p">,</span> <span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-1940"></a>
<a name="ln-1941"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1942"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-1943"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-1944"></a>          <span class="c">!       MODIFIED       F. Buhl Nov 2000, R. Raustad - FSEC, Feb 2009 - added economizer flags</span>
<a name="ln-1945"></a>          <span class="c">!                      Both the economizer and high humidity control flags can disable the HX</span>
<a name="ln-1946"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1947"></a>
<a name="ln-1948"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1949"></a>          <span class="c">! Calculate the outlet conditions for an air to air plate heat</span>
<a name="ln-1950"></a>          <span class="c">! exchanger given the inlet conditions.</span>
<a name="ln-1951"></a>
<a name="ln-1952"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1953"></a>          <span class="c">! This is a static heat exchanger model. No geometrical input data</span>
<a name="ln-1954"></a>          <span class="c">! is needed. No knowledge of h*A values is needed except the ratio</span>
<a name="ln-1955"></a>          <span class="c">! of the primary side to the secondary side convective heat transfer</span>
<a name="ln-1956"></a>          <span class="c">! coefficient times the exchanger surface area. Effectiveness - NTU</span>
<a name="ln-1957"></a>          <span class="c">! heat exchanger formulas are used.</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a>          <span class="c">! The time varying load is calculated based on the variation of the</span>
<a name="ln-1960"></a>          <span class="c">! convective heat transfer coefficient.The variation is a function of</span>
<a name="ln-1961"></a>          <span class="c">! mass flow rate and inlet temperature. An iterative solution is only</span>
<a name="ln-1962"></a>          <span class="c">! required during initialization in one specific flow arrangement. During</span>
<a name="ln-1963"></a>          <span class="c">! the time steps the solution is explicit. The iteration is done with</span>
<a name="ln-1964"></a>          <span class="c">! the Regula Falsi algorithm. Convergence is always achieved.</span>
<a name="ln-1965"></a>
<a name="ln-1966"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1967"></a>          <span class="c">! M. Wetter, Simulation Model Air-to-Air Plate Heat Exchanger</span>
<a name="ln-1968"></a>          <span class="c">! LBNL Report 42354, 1999.</span>
<a name="ln-1969"></a>
<a name="ln-1970"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1971"></a>          <span class="c">! na</span>
<a name="ln-1972"></a>
<a name="ln-1973"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1974"></a>
<a name="ln-1975"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1976"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExNum</span> <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-1977"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXUnitOn</span> <span class="c">! flag to simulate heat exchager heat recovery</span>
<a name="ln-1978"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EconomizerFlag</span> <span class="c">! economizer flag pass by air loop or OA sys</span>
<a name="ln-1979"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighHumCtrlFlag</span>     <span class="c">! high humidity control flag passed by airloop or OA sys</span>
<a name="ln-1980"></a>
<a name="ln-1981"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1982"></a>          <span class="c">! na</span>
<a name="ln-1983"></a>
<a name="ln-1984"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1985"></a>          <span class="c">! na</span>
<a name="ln-1986"></a>
<a name="ln-1987"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1988"></a>          <span class="c">! na</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1991"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">UnitOn</span>              <span class="c">! unit on flag</span>
<a name="ln-1992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupByPassMassFlow</span>   <span class="c">! supply air mass flow rate bypassing unit [kg/s]</span>
<a name="ln-1993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitSupMassFlow</span>     <span class="c">! supply air mass flow rate passing through the unit [kg/s]</span>
<a name="ln-1994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecByPassMassFlow</span>   <span class="c">! secondary air mass flow rate bypassing unit [kg/s]</span>
<a name="ln-1995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitSecMassFlow</span>     <span class="c">! secondary air mass flow rate passing through the unit [kg/s]</span>
<a name="ln-1996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QuotSup</span>             <span class="c">! ratio of supply nominal m*T to actual m*T</span>
<a name="ln-1997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QuotExh</span>             <span class="c">! ratio of secondary nominal m*T to actual m*T</span>
<a name="ln-1998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Deno</span>                <span class="c">! denominator of UA calculation</span>
<a name="ln-1999"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSup</span>                <span class="c">! supply air capacitance rate [J/C/s]</span>
<a name="ln-2000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSec</span>                <span class="c">! secondary air capacitance rate [J/C/s]</span>
<a name="ln-2001"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CMin</span>                <span class="c">! minimum air capacitance rate [J/C/s]</span>
<a name="ln-2002"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Z</span>                   <span class="c">! Ratio of minimum air capacitance rate to maximum air capacitance rate</span>
<a name="ln-2003"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NTU</span>                 <span class="c">! Number of heat transfer units</span>
<a name="ln-2004"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Eps</span>                 <span class="c">! epsilon, the unit effectiveness</span>
<a name="ln-2005"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UA</span>                  <span class="c">! present UA</span>
<a name="ln-2006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSupOut</span>          <span class="c">! unit supply outlet temperature [C]</span>
<a name="ln-2007"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HumRatSupOut</span>        <span class="c">! unit supply outlet humidity ratio [kg water / kg dry air]</span>
<a name="ln-2008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnthSupOut</span>          <span class="c">! unit supply outlet enthalpy [J/kg]</span>
<a name="ln-2009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSupOutSat</span>       <span class="c">! unit supply outlet temperature at saturation (at EnthSupOut) [C]</span>
<a name="ln-2010"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTrans</span>              <span class="c">! heat transferred in the heat exchanger [W]</span>
<a name="ln-2011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecCons</span>            <span class="c">! electricity consumption rate [W]</span>
<a name="ln-2012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecOut</span>          <span class="c">! unit secondary outlet temperature [C]</span>
<a name="ln-2013"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HumRatSecOut</span>        <span class="c">! unit secondary outlet humidity ratio [kg water / kg dry air]</span>
<a name="ln-2014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnthSecOut</span>          <span class="c">! unit secondary outlet enthalpy [J/kgC]</span>
<a name="ln-2015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecOutSat</span>       <span class="c">! unit secondary outlet temperature at saturation (at EnthsSecOut) [C]</span>
<a name="ln-2016"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensHeatRecRate</span>     <span class="c">! sensible heat recovery rate to supply air (heating +, cooling -)</span>
<a name="ln-2017"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatHeatRecRate</span>      <span class="c">! latent heat recovery rate to supply air (heating [humidify] +, cooling [dehumidify] -)</span>
<a name="ln-2018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotHeatRecRate</span>      <span class="c">! total heat recovery rate to supply air (heating +, cooling -)</span>
<a name="ln-2019"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EconomizerActiveFlag</span>  <span class="c">! local representing the economizer status when PRESENT</span>
<a name="ln-2020"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">HighHumCtrlActiveFlag</span> <span class="c">! local representing high humidity control when PRESENT</span>
<a name="ln-2021"></a>
<a name="ln-2022"></a>  <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2023"></a>  <span class="n">QTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2024"></a>  <span class="n">ElecCons</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2025"></a>
<a name="ln-2026"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">EconomizerFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2027"></a><span class="k">    </span><span class="n">EconomizerActiveFlag</span> <span class="o">=</span> <span class="n">EconomizerFlag</span>
<a name="ln-2028"></a>  <span class="k">ELSE</span>
<a name="ln-2029"></a><span class="k">    </span><span class="n">EconomizerActiveFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2030"></a>  <span class="k">END IF</span>
<a name="ln-2031"></a>
<a name="ln-2032"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HighHumCtrlFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2033"></a><span class="k">    </span><span class="n">HighHumCtrlActiveFlag</span> <span class="o">=</span> <span class="n">HighHumCtrlFlag</span>
<a name="ln-2034"></a>  <span class="k">ELSE</span>
<a name="ln-2035"></a><span class="k">    </span><span class="n">HighHumCtrlActiveFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2036"></a>  <span class="k">END IF</span>
<a name="ln-2037"></a>
<a name="ln-2038"></a><span class="k">  IF</span><span class="p">((</span><span class="n">EconomizerActiveFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HighHumCtrlActiveFlag</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2039"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EconoLockOut_Yes</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2040"></a><span class="k">    </span><span class="n">UnitSupMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! set HX supply flow to 0, all supply air will go through supply bypass</span>
<a name="ln-2041"></a>    <span class="n">UnitSecMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! set HX secondary flow to 0, all secondary air will got through secondary bypass</span>
<a name="ln-2042"></a>    <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>        <span class="c">! turn off HX calculations when in economizer mode</span>
<a name="ln-2043"></a>  <span class="k">ELSE</span>
<a name="ln-2044"></a>    <span class="c">! if economizer operation is not allowed, air always passes through HX</span>
<a name="ln-2045"></a>    <span class="c">! if CompanionCoilNum &gt; 0, air always passes through HX (no economizer operation allowed)</span>
<a name="ln-2046"></a>    <span class="n">UnitSupMassFlow</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirMassFlow</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span><span class="p">)</span>
<a name="ln-2047"></a>    <span class="n">UnitSecMassFlow</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSecAirMassFlow</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span><span class="p">)</span>
<a name="ln-2048"></a>  <span class="k">END IF</span>
<a name="ln-2049"></a>
<a name="ln-2050"></a><span class="k">  </span><span class="n">SupByPassMassFlow</span> <span class="o">=</span>  <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">-</span> <span class="n">UnitSupMassFlow</span><span class="p">)</span>
<a name="ln-2051"></a>  <span class="n">SecByPassMassFlow</span> <span class="o">=</span>  <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="o">-</span> <span class="n">UnitSecMassFlow</span><span class="p">)</span>
<a name="ln-2052"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2053"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2054"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2055"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HXUnitOn</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2056"></a>
<a name="ln-2057"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2058"></a>    <span class="c">! unit is on</span>
<a name="ln-2059"></a>    <span class="c">! calculate the UA for this time step</span>
<a name="ln-2060"></a>    <span class="n">QuotSup</span> <span class="o">=</span> <span class="n">SafeDiv</span><span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">mTSup0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2061"></a>                       <span class="n">UnitSupMassFlow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="n">KELVZERO</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2062"></a>    <span class="n">QuotExh</span> <span class="o">=</span> <span class="n">SafeDiv</span><span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">mTSec0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2063"></a>                       <span class="n">UnitSecMassFlow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">+</span> <span class="n">KELVZERO</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2064"></a>    <span class="n">Deno</span> <span class="o">=</span> <span class="n">QuotSup</span><span class="o">**</span><span class="mf">0.78d0</span> <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">hARatio</span> <span class="o">*</span> <span class="n">QuotExh</span><span class="o">**</span><span class="mf">0.78d0</span>
<a name="ln-2065"></a>    <span class="n">UA</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">UA0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">hARatio</span> <span class="o">+</span> <span class="mf">1.d0</span> <span class="p">)</span> <span class="o">/</span> <span class="n">Deno</span>
<a name="ln-2066"></a>    <span class="c">! calculate the NTU</span>
<a name="ln-2067"></a>    <span class="n">CSup</span> <span class="o">=</span> <span class="n">UnitSupMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2068"></a>    <span class="n">CSec</span> <span class="o">=</span> <span class="n">UnitSecMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">)</span>
<a name="ln-2069"></a>    <span class="c">! note: no C can be zero since otherwise we wouldn&#39;t be here</span>
<a name="ln-2070"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CSup</span> <span class="o">&lt;</span> <span class="n">CSec</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2071"></a><span class="k">      </span><span class="n">CMin</span> <span class="o">=</span> <span class="n">CSup</span>
<a name="ln-2072"></a>      <span class="n">Z</span> <span class="o">=</span> <span class="n">CMin</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-2073"></a>    <span class="k">ELSE</span>
<a name="ln-2074"></a><span class="k">      </span><span class="n">CMin</span> <span class="o">=</span> <span class="n">CSec</span>
<a name="ln-2075"></a>      <span class="n">Z</span> <span class="o">=</span> <span class="n">CMin</span> <span class="o">/</span> <span class="n">CSup</span>
<a name="ln-2076"></a>    <span class="k">END IF</span>
<a name="ln-2077"></a><span class="k">    </span><span class="n">NTU</span> <span class="o">=</span> <span class="n">UA</span> <span class="o">/</span> <span class="n">CMin</span>
<a name="ln-2078"></a>    <span class="c">! Get the effectiveness</span>
<a name="ln-2079"></a>    <span class="k">CALL </span><span class="n">CalculateEpsFromNTUandZ</span><span class="p">(</span><span class="n">NTU</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FlowArr</span><span class="p">,</span> <span class="n">Eps</span><span class="p">)</span>
<a name="ln-2080"></a>    <span class="c">! use the effectiveness to calculate the unit outlet conditions</span>
<a name="ln-2081"></a>    <span class="n">TempSupOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="n">Eps</span> <span class="o">*</span> <span class="n">CMin</span> <span class="o">/</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2082"></a>    <span class="n">QTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSupOut</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2083"></a>    <span class="n">TempSecOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">-</span> <span class="n">QTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-2084"></a>    <span class="n">HumRatSupOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2085"></a>    <span class="n">EnthSupOut</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">TempSupOut</span><span class="p">,</span><span class="n">HumRatSupOut</span><span class="p">)</span>
<a name="ln-2086"></a>    <span class="c">! check for saturation in supply outlet</span>
<a name="ln-2087"></a>    <span class="n">TempSupOutSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EnthSupOut</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2088"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TempSupOutSat</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">TempSupOut</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2089"></a><span class="k">      </span><span class="n">TempSupOut</span> <span class="o">=</span> <span class="n">TempSupOutSat</span>
<a name="ln-2090"></a>      <span class="n">HumRatSupOut</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">TempSupOut</span><span class="p">,</span><span class="n">EnthSupOut</span><span class="p">)</span>
<a name="ln-2091"></a>    <span class="k">END IF</span>
<a name="ln-2092"></a><span class="k">    </span><span class="n">HumRatSecOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span>
<a name="ln-2093"></a>    <span class="n">EnthSecOut</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">TempSecOut</span><span class="p">,</span><span class="n">HumRatSecOut</span><span class="p">)</span>
<a name="ln-2094"></a>    <span class="c">! check for saturation in secondary outlet</span>
<a name="ln-2095"></a>    <span class="n">TempSecOutSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EnthSecOut</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2096"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TempSecOutSat</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">TempSecOut</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2097"></a><span class="k">      </span><span class="n">TempSecOut</span> <span class="o">=</span> <span class="n">TempSecOutSat</span>
<a name="ln-2098"></a>      <span class="n">HumRatSecOut</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">TempSecOut</span><span class="p">,</span><span class="n">EnthSecOut</span><span class="p">)</span>
<a name="ln-2099"></a>    <span class="k">END IF</span>
<a name="ln-2100"></a>    <span class="c">! calculate outlet conditions by mixing bypass air stream with air that went through the</span>
<a name="ln-2101"></a>    <span class="c">! heat exchanger core.</span>
<a name="ln-2102"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="p">(</span><span class="n">UnitSupMassFlow</span><span class="o">*</span><span class="n">EnthSupOut</span> <span class="o">+</span> <span class="n">SupByPassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2103"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2104"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="n">UnitSupMassFlow</span><span class="o">*</span><span class="n">HumRatSupOut</span> <span class="o">+</span> <span class="n">SupByPassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2105"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2106"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-2107"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2108"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="p">(</span><span class="n">UnitSecMassFlow</span><span class="o">*</span><span class="n">EnthSecOut</span> <span class="o">+</span> <span class="n">SecByPassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2109"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2110"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="n">UnitSecMassFlow</span><span class="o">*</span><span class="n">HumRatSecOut</span> <span class="o">+</span> <span class="n">SecByPassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2111"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2112"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span><span class="p">)</span>
<a name="ln-2113"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2114"></a>    <span class="n">ElecCons</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomElecPower</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a>  <span class="k">ELSE</span>
<a name="ln-2117"></a>    <span class="c">! the unit is off. Pass through the air streams with no change</span>
<a name="ln-2118"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span>
<a name="ln-2119"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2120"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2121"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2122"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span>
<a name="ln-2123"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span>
<a name="ln-2124"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecinTemp</span>
<a name="ln-2125"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2126"></a>
<a name="ln-2127"></a>  <span class="k">END IF</span>
<a name="ln-2128"></a><span class="k">  </span><span class="n">CSup</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span><span class="o">*</span><span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2129"></a>  <span class="n">SensHeatRecRate</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2130"></a>  <span class="n">TotHeatRecRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-2131"></a>                                     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="p">)</span>
<a name="ln-2132"></a>  <span class="n">LatHeatRecRate</span> <span class="o">=</span> <span class="n">TotHeatRecRate</span> <span class="o">-</span> <span class="n">SensHeatRecRate</span>
<a name="ln-2133"></a>
<a name="ln-2134"></a>
<a name="ln-2135"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SensHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2136"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span> <span class="o">=</span> <span class="n">SensHeatRecRate</span>
<a name="ln-2137"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2138"></a>  <span class="k">ELSE</span>
<a name="ln-2139"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2140"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SensHeatRecRate</span><span class="p">)</span>
<a name="ln-2141"></a>  <span class="k">END IF</span>
<a name="ln-2142"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">LatHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2143"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span> <span class="o">=</span> <span class="n">LatHeatRecRate</span>
<a name="ln-2144"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2145"></a>  <span class="k">ELSE</span>
<a name="ln-2146"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2147"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">LatHeatRecRate</span><span class="p">)</span>
<a name="ln-2148"></a>  <span class="k">END IF</span>
<a name="ln-2149"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">TotHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2150"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span> <span class="o">=</span> <span class="n">TotHeatRecRate</span>
<a name="ln-2151"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2152"></a>  <span class="k">ELSE</span>
<a name="ln-2153"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2154"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TotHeatRecRate</span><span class="p">)</span>
<a name="ln-2155"></a>  <span class="k">END IF</span>
<a name="ln-2156"></a>
<a name="ln-2157"></a>
<a name="ln-2158"></a><span class="k">  </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span> <span class="o">=</span> <span class="n">ElecCons</span>
<a name="ln-2159"></a>
<a name="ln-2160"></a><span class="k">RETURN</span>
<a name="ln-2161"></a><span class="k">END SUBROUTINE </span><span class="n">CalcAirToAirPlateHeatExch</span>
<a name="ln-2162"></a>
<a name="ln-2163"></a><span class="k">SUBROUTINE </span><span class="n">CalcAirToAirGenericHeatExch</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="p">,</span> <span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-2164"></a>
<a name="ln-2165"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2166"></a>          <span class="c">!       AUTHOR         Don Shirey</span>
<a name="ln-2167"></a>          <span class="c">!       DATE WRITTEN   February 2003</span>
<a name="ln-2168"></a>          <span class="c">!       MODIFIED       R. Raustad - FSEC, Feb 2009 - added economizer flags</span>
<a name="ln-2169"></a>          <span class="c">!                      Both the economizer and high humidity control flags can disable the HX</span>
<a name="ln-2170"></a>          <span class="c">!       RE-ENGINEERED  Richard Raustad, June 2003</span>
<a name="ln-2171"></a>
<a name="ln-2172"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2173"></a>          <span class="c">!  Calculate the outlet conditions for an air to air generic heat</span>
<a name="ln-2174"></a>          <span class="c">!  exchanger given the inlet conditions.</span>
<a name="ln-2175"></a>
<a name="ln-2176"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2177"></a>          <span class="c">!  This is a standard heat exchanger effectiveness model. No geometrical input data</span>
<a name="ln-2178"></a>          <span class="c">!  is needed. The model uses heat exchanger effectiveness performance data</span>
<a name="ln-2179"></a>          <span class="c">!  to calculate the air temperature and humidity ratio of the leaving</span>
<a name="ln-2180"></a>          <span class="c">!  supply and secondary air streams. Linear interpolation (or extrapolation)</span>
<a name="ln-2181"></a>          <span class="c">!  is assumed to obtain heat exchanger effectiveness at off-rated conditions.</span>
<a name="ln-2182"></a>          <span class="c">!</span>
<a name="ln-2183"></a>          <span class="c">!  Economizer operation is allowed through the use of a Controller: Outside Air</span>
<a name="ln-2184"></a>          <span class="c">!  object.</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2187"></a>          <span class="c">!  ARI Standard 1060-2001,Rating Air-to-Air Heat Exchangers for Energy Recovery Ventilation Equipment, www.ari.org</span>
<a name="ln-2188"></a>          <span class="c">!  ASHRAE Standard 84, Method of Testing Air-To-Air Heat Exchangers, www.ashrae.org</span>
<a name="ln-2189"></a>          <span class="c">!  U.S. Environmental Protection Agency software &quot;SAVES&quot; -</span>
<a name="ln-2190"></a>          <span class="c">!   School Advanced Ventilation Engineering Software http://www.epa.gov/iaq/schooldesign/saves.html</span>
<a name="ln-2191"></a>
<a name="ln-2192"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2193"></a>          <span class="c">! na</span>
<a name="ln-2194"></a>
<a name="ln-2195"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2198"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExNum</span>    <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-2199"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXUnitOn</span> <span class="c">! flag to simulate heat exchanger heat recovery</span>
<a name="ln-2200"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! first HVAC iteration flag</span>
<a name="ln-2201"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EconomizerFlag</span> <span class="c">! economizer flag pass by air loop or OA sys</span>
<a name="ln-2202"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighHumCtrlFlag</span> <span class="c">! high humidity control flag passed by airloop or OA sys</span>
<a name="ln-2203"></a>
<a name="ln-2204"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">ErrorTol</span> <span class="o">=</span> <span class="mf">0.001d0</span>         <span class="c">!error tolerence</span>
<a name="ln-2206"></a>
<a name="ln-2207"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2208"></a>          <span class="c">! na</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2211"></a>          <span class="c">! na</span>
<a name="ln-2212"></a>
<a name="ln-2213"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2214"></a>          <span class="c">!</span>
<a name="ln-2215"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UnitOn</span>               <span class="c">! unit on flag</span>
<a name="ln-2216"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FrostControlFlag</span>     <span class="c">! unit is in frost control mode when TRUE</span>
<a name="ln-2217"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SupOutNode</span>
<a name="ln-2218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Error</span>               <span class="c">! iteration loop error variable</span>
<a name="ln-2219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Iter</span>                <span class="c">! iteration counter</span>
<a name="ln-2220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ControlFraction</span>     <span class="c">! fraction of effectiveness when rotary HX speed or plate bypass modulation is used for</span>
<a name="ln-2221"></a>                                 <span class="c">! temperature control</span>
<a name="ln-2222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RhoSup</span>              <span class="c">! supply air density at actual pressure, temperature and humidity conditions [kg/m3]</span>
<a name="ln-2223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RhoSec</span>              <span class="c">! secondary air density at actual pressure, temperature and humidity conditions [kg/m3]</span>
<a name="ln-2224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RhoStd</span>              <span class="c">! standard air density at actual pressure, 20C dry-bulb temp and 0.0 absolute humidity [kg/m3]</span>
<a name="ln-2225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSup</span>                <span class="c">! supply air heat capacity rate [W/K]</span>
<a name="ln-2226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSec</span>                <span class="c">! secondary air heat capacity rate [W/K]</span>
<a name="ln-2227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CMin</span>                <span class="c">! minimum air heat capacity rate [W/K]</span>
<a name="ln-2228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSensTrans</span>          <span class="c">! sensible heat transferred by the heat exchanger [W]</span>
<a name="ln-2229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotTrans</span>           <span class="c">! total heat (sensible + latent) transferred by the heat exchanger [W]</span>
<a name="ln-2230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecOutSat</span>       <span class="c">! secondary air outlet temperature at saturation (at EnthsSecOut) [C]</span>
<a name="ln-2231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXSecAirVolFlowRate</span> <span class="c">! air volume flow rate of the secondary air stream through the heat exchanger [m3/sec]</span>
<a name="ln-2232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXSupAirVolFlowRate</span> <span class="c">! air volume flow rate of the supply air stream through the heat exchanger [m3/sec]</span>
<a name="ln-2233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXAvgAirVolFlowRate</span> <span class="c">! average air volume flow rate through the heat exchanger [m3/sec]</span>
<a name="ln-2234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXAirVolFlowRatio</span>   <span class="c">! ratio of avg actual air volume flow through HX to nominal HX air volume flow [-]</span>
<a name="ln-2235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXTempSetPoint</span>      <span class="c">! setpoint temperature at supply outlet node of HX when ControlToTemperatureSetpoint = Yes</span>
<a name="ln-2236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSecIn</span>       <span class="c">! secondary air mass flow rate at HX inlet</span>
<a name="ln-2237"></a><span class="c">!  REAL(r64)    :: MassFlowSecOut      ! secondary air mass flow rate at HX outlet</span>
<a name="ln-2238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSupIn</span>       <span class="c">! supply air mass flow rate at HX inlet</span>
<a name="ln-2239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSupOut</span>      <span class="c">! supply air mass flow rate through HX core outlet</span>
<a name="ln-2240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSupBypass</span>   <span class="c">! supply air bypass mass flow rate around HX core</span>
<a name="ln-2241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSupIn</span>           <span class="c">! supply side temperature of air entering HX</span>
<a name="ln-2242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSupOut</span>          <span class="c">! supply side temperature of air leaving HX core</span>
<a name="ln-2243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HumRatSupIn</span>         <span class="c">! supply side humidity ratio of air entering HX</span>
<a name="ln-2244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecIn</span>           <span class="c">! secondary side temperature of air entering HX</span>
<a name="ln-2245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensHeatRecRate</span>     <span class="c">! sensible heat recovery rate to supply air (heating +, cooling -)</span>
<a name="ln-2246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatHeatRecRate</span>      <span class="c">! latent heat recovery rate to supply air (heating [humidify] +, cooling [dehumidify] -)</span>
<a name="ln-2247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotHeatRecRate</span>      <span class="c">! total heat recovery rate to supply air (heating +, cooling -)</span>
<a name="ln-2248"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EconomizerActiveFlag</span>  <span class="c">! local representing the economizer status when PRESENT</span>
<a name="ln-2249"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">HighHumCtrlActiveFlag</span> <span class="c">! local representing high humidity control when PRESENT</span>
<a name="ln-2250"></a>
<a name="ln-2251"></a><span class="c">! Initialize local variables</span>
<a name="ln-2252"></a>  <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2253"></a>  <span class="n">FrostControlFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2254"></a>  <span class="n">QSensTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2255"></a>  <span class="n">QTotTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2256"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">DefrostFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2257"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2258"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2259"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2260"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2261"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span>
<a name="ln-2262"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2263"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span>
<a name="ln-2264"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span>
<a name="ln-2265"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span>
<a name="ln-2266"></a>  <span class="n">SupOutNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutletNode</span>
<a name="ln-2267"></a>  <span class="n">HXTempSetPoint</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-2268"></a>
<a name="ln-2269"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">EconomizerFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2270"></a><span class="k">    </span><span class="n">EconomizerActiveFlag</span> <span class="o">=</span> <span class="n">EconomizerFlag</span>
<a name="ln-2271"></a>  <span class="k">ELSE</span>
<a name="ln-2272"></a><span class="k">    </span><span class="n">EconomizerActiveFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2273"></a>  <span class="k">END IF</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HighHumCtrlFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2276"></a><span class="k">    </span><span class="n">HighHumCtrlActiveFlag</span> <span class="o">=</span> <span class="n">HighHumCtrlFlag</span>
<a name="ln-2277"></a>  <span class="k">ELSE</span>
<a name="ln-2278"></a><span class="k">    </span><span class="n">HighHumCtrlActiveFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2279"></a>  <span class="k">END IF</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a><span class="c">! Determine mass flow through heat exchanger and mass flow being bypassed (only flat plate bypasses flow)</span>
<a name="ln-2282"></a>  <span class="k">IF</span> <span class="p">(((</span><span class="n">EconomizerActiveFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HighHumCtrlActiveFlag</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2283"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EconoLockOut_Yes</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2284"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchConfigNum</span> <span class="o">==</span> <span class="n">PLATE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2285"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2286"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2287"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2288"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2289"></a>  <span class="k">ELSE</span> <span class="c">! No bypass mass flow</span>
<a name="ln-2290"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2291"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2292"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-2293"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-2294"></a>  <span class="k">END IF</span>
<a name="ln-2295"></a><span class="c">! Unit is scheduled OFF, so bypass heat exchange calcs</span>
<a name="ln-2296"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2297"></a><span class="c">!! Economizer is active, so bypass heat exchange calcs. This applies to both flat plate and rotary HX&#39;s</span>
<a name="ln-2298"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">EconomizerActiveFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HighHumCtrlActiveFlag</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2299"></a>       <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EconoLockOut_Yes</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2300"></a><span class="k">    </span><span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2301"></a>  <span class="k">END IF</span>
<a name="ln-2302"></a><span class="c">! Determine if unit is ON or OFF based on air mass flow through the supply and secondary airstreams and operation flag</span>
<a name="ln-2303"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2304"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2305"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HXUnitOn</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2306"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span><span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2307"></a>
<a name="ln-2308"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2309"></a>    <span class="c">! Unit is on.</span>
<a name="ln-2310"></a>    <span class="c">! In the future, use actual node pressures in the following air density calls</span>
<a name="ln-2311"></a>    <span class="n">RhoStd</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2312"></a>    <span class="n">HXSupAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">/</span><span class="n">RhoStd</span> <span class="c">! volume flow using standard density</span>
<a name="ln-2313"></a>    <span class="n">HXSecAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">/</span><span class="n">RhoStd</span>
<a name="ln-2314"></a>    <span class="c">! Limit unbalanced volumetric flow ratio to 2:1</span>
<a name="ln-2315"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2316"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">HXSupAirVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HXSecAirVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2317"></a><span class="k">        IF</span> <span class="p">(((</span><span class="n">HXSupAirVolFlowRate</span><span class="o">/</span><span class="n">HXSecAirVolFlowRate</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">2.0d0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.((</span><span class="n">HXSecAirVolFlowRate</span><span class="o">/</span><span class="n">HXSupAirVolFlowRate</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">2.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2318"></a><span class="k">          </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">UnBalancedErrCount</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">UnBalancedErrCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2319"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">UnBalancedErrCount</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2320"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;: &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2321"></a>              <span class="s1">&#39;&quot; unbalanced air volume flow ratio through the heat exchanger is greater than 2:1.&#39;</span><span class="p">)</span>
<a name="ln-2322"></a>             <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...HX Supply air to Exhaust air flow ratio = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2323"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HXSupAirVolFlowRate</span><span class="o">/</span><span class="n">HXSecAirVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2324"></a>          <span class="k">ELSE</span>
<a name="ln-2325"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2326"></a>            <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:  Unbalanced air volume flow ratio exceeds &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2327"></a>            <span class="s1">&#39; 2:1 warning continues. HX flow ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-2328"></a>            <span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">UnBalancedErrIndex</span><span class="p">,</span> <span class="n">HXSupAirVolFlowRate</span><span class="o">/</span><span class="n">HXSecAirVolFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2329"></a>              <span class="n">HXSupAirVolFlowRate</span><span class="o">/</span><span class="n">HXSecAirVolFlowRate</span><span class="p">)</span>
<a name="ln-2330"></a>          <span class="k">END IF</span>
<a name="ln-2331"></a><span class="k">        END IF</span>
<a name="ln-2332"></a><span class="k">      END IF</span>
<a name="ln-2333"></a><span class="k">    END IF</span>
<a name="ln-2334"></a>    <span class="c">! Calculate average volumetric flow rate of the two air streams</span>
<a name="ln-2335"></a>    <span class="n">HXAvgAirVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">HXSecAirVolFlowRate</span> <span class="o">+</span> <span class="n">HXSupAirVolFlowRate</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-2336"></a>    <span class="n">HXAirVolFlowRatio</span> <span class="o">=</span> <span class="n">HXAvgAirVolFlowRate</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-2337"></a>    <span class="c">! Average air volume flow rate must be between 50% and 130% of nominal supply air volume flow</span>
<a name="ln-2338"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.3d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HXAirVolFlowRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2339"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2340"></a><span class="k">         </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LowFlowErrCount</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LowFlowErrCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2341"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LowFlowErrCount</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2342"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2343"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Average air volume flow rate is &lt;50% or &gt;130% of the nominal HX supply air volume flow rate.&#39;</span><span class="p">)</span>
<a name="ln-2344"></a>           <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Air volume flow rate ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HXAirVolFlowRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2345"></a>         <span class="k">ELSE</span>
<a name="ln-2346"></a><span class="k">           CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2347"></a>           <span class="s1">&#39;&quot;:  Average air volume flow rate is &lt;50% or &gt;130% warning continues. Air flow rate ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-2348"></a>           <span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LowFlowErrIndex</span><span class="p">,</span> <span class="n">HXAirVolFlowRatio</span><span class="p">,</span> <span class="n">HXAirVolFlowRatio</span><span class="p">)</span>
<a name="ln-2349"></a>         <span class="k">END IF</span>
<a name="ln-2350"></a><span class="k">       END IF</span>
<a name="ln-2351"></a><span class="k">    END IF</span>
<a name="ln-2352"></a>
<a name="ln-2353"></a>    <span class="c">! Determine heat exchanger effectiveness using avg air volume flow rate based on actual inlet air density</span>
<a name="ln-2354"></a>    <span class="c">! Linearly interpolate and extrapolate (within limits) from effectiveness input values</span>
<a name="ln-2355"></a>    <span class="n">RhoSup</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span>
<a name="ln-2356"></a>    <span class="n">RhoSec</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">)</span>
<a name="ln-2357"></a>    <span class="n">HXSupAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">/</span><span class="n">RhoSup</span>
<a name="ln-2358"></a>    <span class="n">HXSecAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">/</span><span class="n">RhoSec</span>
<a name="ln-2359"></a>    <span class="n">HXAvgAirVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">HXSecAirVolFlowRate</span> <span class="o">+</span> <span class="n">HXSupAirVolFlowRate</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-2360"></a>    <span class="n">HXAirVolFlowRatio</span> <span class="o">=</span> <span class="n">HXAvgAirVolFlowRate</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-2361"></a>
<a name="ln-2362"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2363"></a>     <span class="c">! Use heating effectiveness values</span>
<a name="ln-2364"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2365"></a>                     <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2366"></a>                     <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2367"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2368"></a>                    <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2369"></a>                    <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2370"></a>    <span class="k">ELSE</span>
<a name="ln-2371"></a>      <span class="c">! Use cooling effectiveness values</span>
<a name="ln-2372"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2373"></a>                     <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2374"></a>                     <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2375"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2376"></a>                     <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2377"></a>                     <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2378"></a>    <span class="k">END IF</span>
<a name="ln-2379"></a>
<a name="ln-2380"></a><span class="c">!     Keep effectiveness between 0 and 1.0 ??</span>
<a name="ln-2381"></a><span class="c">!     HXOpSensEffect = MAX(MIN(HXOpSensEffect,1.0),0.0)</span>
<a name="ln-2382"></a><span class="c">!     HXOpLatEffect =  MAX(MIN(HXOpLatEffect,1.0),0.0)</span>
<a name="ln-2383"></a>
<a name="ln-2384"></a><span class="c">!   The model should at least guard against negative numbers</span>
<a name="ln-2385"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span><span class="p">)</span>
<a name="ln-2386"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span><span class="p">)</span>
<a name="ln-2387"></a>
<a name="ln-2388"></a>    <span class="c">! Use the effectiveness to calculate the air conditions exiting the heat exchanger (all air flow through the HX)</span>
<a name="ln-2389"></a>    <span class="c">!</span>
<a name="ln-2390"></a>    <span class="c">! Include EATR and OACF in the following calculations at some point</span>
<a name="ln-2391"></a>
<a name="ln-2392"></a>    <span class="n">CSup</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2393"></a>    <span class="n">CSec</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">)</span>
<a name="ln-2394"></a>    <span class="n">CMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">CSup</span><span class="p">,</span> <span class="n">CSec</span><span class="p">)</span>
<a name="ln-2395"></a>
<a name="ln-2396"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2397"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">*</span> <span class="n">CMin</span> <span class="o">/</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2398"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2399"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">*</span> <span class="n">CMin</span> <span class="o">/</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span>
<a name="ln-2400"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-2401"></a>
<a name="ln-2402"></a><span class="c">!   Check for saturation in supply outlet and reset temp, then humidity ratio at constant enthalpy</span>
<a name="ln-2403"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2404"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2405"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-2406"></a>    <span class="k">END IF</span>
<a name="ln-2407"></a><span class="k">    </span><span class="n">QSensTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-2408"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">+</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-2409"></a>    <span class="n">QTotTrans</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-2410"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span> <span class="o">+</span> <span class="n">QTotTrans</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span>
<a name="ln-2411"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">)</span>
<a name="ln-2412"></a><span class="c">!</span>
<a name="ln-2413"></a><span class="c">!   Control the supply air outlet temperature to a setpoint for Heating Mode only</span>
<a name="ln-2414"></a><span class="c">!   (ControlFraction = 0 HX fully bypassed, ControlFraction = 1 air passed entirely through HX)</span>
<a name="ln-2415"></a><span class="c">!   (supply air stream bypass mass flow rate proportional to ControlFraction except when frost control is active)</span>
<a name="ln-2416"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ControlToTemperatureSetPoint</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2417"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">HXTempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2418"></a><span class="c">!     IF secondary inlet temperature is above the supply inlet temperature, control to SP</span>
<a name="ln-2419"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2420"></a>        <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">).</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2421"></a><span class="k">          </span><span class="n">ControlFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">HXTempSetPoint</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2422"></a>                                <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)))</span>
<a name="ln-2423"></a>      <span class="k">ELSE</span>
<a name="ln-2424"></a><span class="c">!     ELSE fully bypass HX to maintain supply outlet temp as high as possible</span>
<a name="ln-2425"></a>        <span class="n">ControlFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2426"></a>      <span class="n">ENDIF</span>
<a name="ln-2427"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchConfigNum</span> <span class="o">==</span> <span class="n">ROTARY</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2428"></a><span class="c">!       Rotory HX&#39;s never get bypassed, rotational speed is modulated</span>
<a name="ln-2429"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ControlFraction</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span>
<a name="ln-2430"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ControlFraction</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span>
<a name="ln-2431"></a>      <span class="k">ELSE</span> <span class="c">! HX is a plate heat exchanger, bypass air to control SA temperature</span>
<a name="ln-2432"></a>        <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2433"></a>        <span class="n">Iter</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2434"></a>        <span class="n">MassFlowSupIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2435"></a>        <span class="n">MassFlowSupOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span>
<a name="ln-2436"></a>        <span class="n">MassFlowSupBypass</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span>
<a name="ln-2437"></a>        <span class="n">MassFlowSecIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2438"></a>        <span class="n">TempSupIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2439"></a>        <span class="n">TempSupOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span>
<a name="ln-2440"></a>        <span class="n">HumRatSupIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2441"></a>        <span class="n">TempSecIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span>
<a name="ln-2442"></a>        <span class="k">DO WHILE</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Error</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">ErrorTol</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Iter</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">10</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ControlFraction</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2443"></a>                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Iter</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2444"></a>          <span class="n">MassFlowSupOut</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span><span class="o">*</span><span class="n">ControlFraction</span>
<a name="ln-2445"></a>          <span class="n">MassFlowSupBypass</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ControlFraction</span><span class="p">)</span>
<a name="ln-2446"></a>          <span class="n">HXSupAirVolFlowRate</span> <span class="o">=</span> <span class="n">MassFlowSupOut</span><span class="o">/</span><span class="n">RhoSup</span>
<a name="ln-2447"></a>          <span class="n">HXAvgAirVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">HXSecAirVolFlowRate</span> <span class="o">+</span> <span class="n">HXSupAirVolFlowRate</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-2448"></a>          <span class="n">HXAirVolFlowRatio</span> <span class="o">=</span> <span class="n">HXAvgAirVolFlowRate</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-2449"></a>          <span class="n">CSup</span> <span class="o">=</span> <span class="n">MassFlowSupOut</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">HumRatSupIn</span><span class="p">,</span><span class="n">TempSupIn</span><span class="p">)</span>
<a name="ln-2450"></a>          <span class="n">CMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">CSup</span><span class="p">,</span><span class="n">CSec</span><span class="p">)</span>
<a name="ln-2451"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TempSupIn</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TempSecIn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2452"></a><span class="c">!          Use heating effectiveness values</span>
<a name="ln-2453"></a>            <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2454"></a>             <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2455"></a>             <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2456"></a>            <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2457"></a>             <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2458"></a>             <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2459"></a>          <span class="k">ELSE</span>
<a name="ln-2460"></a><span class="c">!          Use cooling effectiveness values</span>
<a name="ln-2461"></a>            <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2462"></a>             <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2463"></a>             <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2464"></a>            <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2465"></a>             <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2466"></a>             <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-2467"></a>          <span class="k">END IF</span>
<a name="ln-2468"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CSup</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2469"></a><span class="c">!          IF CSup = 0, then supply air mass flow rate = 0 and HX is fully bypassed. Fix divide by 0 error below DO loop.</span>
<a name="ln-2470"></a>            <span class="n">CSup</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2471"></a>            <span class="n">CMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2472"></a>            <span class="k">EXIT</span>
<a name="ln-2473"></a><span class="k">          END IF</span>
<a name="ln-2474"></a><span class="k">          </span><span class="n">TempSupOut</span> <span class="o">=</span> <span class="p">(</span><span class="n">MassFlowSupOut</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSupIn</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2475"></a>            <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">*</span> <span class="n">CMin</span> <span class="o">/</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSecIn</span> <span class="o">-</span> <span class="n">TempSupIn</span><span class="p">))</span> <span class="o">+</span><span class="p">&amp;</span>
<a name="ln-2476"></a>            <span class="n">MassFlowSupBypass</span> <span class="o">*</span> <span class="n">TempSupIn</span><span class="p">)</span><span class="o">/</span><span class="n">MassFlowSupIn</span>
<a name="ln-2477"></a>          <span class="n">Error</span> <span class="o">=</span>  <span class="p">(</span><span class="n">TempSupOut</span> <span class="o">-</span> <span class="n">HXTempSetPoint</span><span class="p">)</span>
<a name="ln-2478"></a><span class="c">!         IF supply inlet temp = supply outlet temp, fully bypass HX - ELSE control to SP</span>
<a name="ln-2479"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TempSupIn</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">TempSupOut</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2480"></a><span class="k">            </span><span class="n">ControlFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">ControlFraction</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSupIn</span> <span class="o">-</span> <span class="n">HXTempSetPoint</span><span class="p">)</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-2481"></a>                            <span class="p">(</span><span class="n">TempSupIn</span> <span class="o">-</span> <span class="n">TempSupOut</span><span class="p">)))</span>
<a name="ln-2482"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TempSupOut</span> <span class="o">-</span> <span class="n">HXTempSetPoint</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ErrorTol</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2483"></a><span class="c">!           IF TempSupIn = TempSupOut then TempSecIn = TempSupIn (ControlFraction = ?)</span>
<a name="ln-2484"></a><span class="c">!           Do nothing, variables in ELSE below have already been calculated</span>
<a name="ln-2485"></a>            <span class="k">EXIT</span>
<a name="ln-2486"></a><span class="k">          ELSE</span>
<a name="ln-2487"></a><span class="c">!           or HX is fully bypassed (ControlFraction = 0) which actually should be caught in IF(CSup .EQ. 0.0)THEN above.</span>
<a name="ln-2488"></a>            <span class="n">ControlFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2489"></a>            <span class="n">MassFlowSupOut</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span><span class="o">*</span><span class="n">ControlFraction</span>
<a name="ln-2490"></a>            <span class="n">MassFlowSupBypass</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ControlFraction</span><span class="p">)</span>
<a name="ln-2491"></a>            <span class="n">CSup</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2492"></a>            <span class="n">CMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2493"></a>            <span class="k">EXIT</span>
<a name="ln-2494"></a><span class="k">          END IF</span>
<a name="ln-2495"></a><span class="k">          </span><span class="n">Iter</span> <span class="o">=</span> <span class="n">Iter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2496"></a>        <span class="k">END DO</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a><span class="k">        </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span>
<a name="ln-2499"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSupOut</span>
<a name="ln-2500"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSupBypass</span>
<a name="ln-2501"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSecIn</span>
<a name="ln-2502"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">=</span> <span class="n">TempSupIn</span>
<a name="ln-2503"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">TempSupOut</span>
<a name="ln-2504"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">=</span> <span class="n">HumRatSupIn</span>
<a name="ln-2505"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">=</span> <span class="n">TempSecIn</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>      <span class="k">END IF</span> <span class="c">! ENDIF for &quot;IF (ExchCond(ExNum)%ExchConfig == &#39;ROTARY&#39;) THEN&quot;</span>
<a name="ln-2508"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2509"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span><span class="o">*</span><span class="n">CMin</span><span class="o">/</span><span class="n">CSup</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2510"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2511"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span><span class="o">*</span><span class="n">CMin</span><span class="o">/</span><span class="n">CSup</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span>
<a name="ln-2512"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a><span class="c">!     Check for saturation in supply outlet and reset temp, then humidity ratio at constant enthalpy</span>
<a name="ln-2515"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2516"></a><span class="k">        </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2517"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-2518"></a>      <span class="k">END IF</span>
<a name="ln-2519"></a>
<a name="ln-2520"></a><span class="k">      </span><span class="n">QSensTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-2521"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">+</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-2522"></a>      <span class="n">QTotTrans</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-2523"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span> <span class="o">+</span> <span class="n">QTotTrans</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span>
<a name="ln-2524"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">)</span>
<a name="ln-2525"></a>
<a name="ln-2526"></a>    <span class="k">END IF</span> <span class="c">!ENDIF for &quot;IF(ExchCond(ExNum)%ControlToTemperatureSetPoint .AND... THEN, ELSE&quot;</span>
<a name="ln-2527"></a>
<a name="ln-2528"></a>    <span class="k">IF</span><span class="p">(</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">==</span> <span class="s1">&#39;MINIMUMEXHAUSTTEMPERATURE&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2529"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ThresholdTemperature</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2530"></a>        <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">==</span> <span class="s1">&#39;EXHAUSTAIRRECIRCULATION&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2531"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ThresholdTemperature</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2532"></a>        <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">==</span> <span class="s1">&#39;EXHAUSTONLY&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2533"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ThresholdTemperature</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2534"></a><span class="k">      CALL </span><span class="n">FrostControl</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)</span>
<a name="ln-2535"></a>      <span class="n">FrostControlFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2536"></a>    <span class="k">END IF</span>
<a name="ln-2537"></a>
<a name="ln-2538"></a>     <span class="c">! check for saturation in secondary outlet</span>
<a name="ln-2539"></a>    <span class="n">TempSecOutSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2540"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TempSecOutSat</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2541"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">TempSecOutSat</span>
<a name="ln-2542"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">)</span>
<a name="ln-2543"></a>    <span class="k">END IF</span>
<a name="ln-2544"></a>
<a name="ln-2545"></a>    <span class="c">! calculate outlet conditions by mixing bypass air stream with air that went through the</span>
<a name="ln-2546"></a>    <span class="c">! heat exchanger core.  Perform this mixing only when no frost control is used or</span>
<a name="ln-2547"></a>    <span class="c">! heat exchanger is not in frost control mode.  Mixing similar to this is performed</span>
<a name="ln-2548"></a>    <span class="c">! in the frost control subroutine when in frost control mode.</span>
<a name="ln-2549"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FrostControlFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2550"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="p">&amp;</span>
<a name="ln-2551"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2552"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2553"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="p">&amp;</span>
<a name="ln-2554"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2555"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2556"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-2557"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2558"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="p">&amp;</span>
<a name="ln-2559"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2560"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2561"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="p">&amp;</span>
<a name="ln-2562"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2563"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2564"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span><span class="p">)</span>
<a name="ln-2565"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2566"></a>    <span class="k">END IF</span>
<a name="ln-2567"></a>
<a name="ln-2568"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomElecPower</span>
<a name="ln-2569"></a>
<a name="ln-2570"></a>  <span class="k">END IF</span> <span class="c">!ENDIF for &quot;IF (UnitOn) THEN&quot;</span>
<a name="ln-2571"></a>
<a name="ln-2572"></a><span class="c">! Calculate heat transfer from the unit using the final supply inlet and supply outlet air conditions</span>
<a name="ln-2573"></a>  <span class="n">CSup</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">*</span><span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2574"></a>  <span class="n">SensHeatRecRate</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2575"></a>  <span class="n">TotHeatRecRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-2576"></a>                                   <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="p">)</span>
<a name="ln-2577"></a>  <span class="n">LatHeatRecRate</span> <span class="o">=</span> <span class="n">TotHeatRecRate</span> <span class="o">-</span> <span class="n">SensHeatRecRate</span>
<a name="ln-2578"></a>
<a name="ln-2579"></a><span class="c">! Set report variables based on sign of recovery rate</span>
<a name="ln-2580"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SensHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2581"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span> <span class="o">=</span> <span class="n">SensHeatRecRate</span>
<a name="ln-2582"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2583"></a>  <span class="k">ELSE</span>
<a name="ln-2584"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2585"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SensHeatRecRate</span><span class="p">)</span>
<a name="ln-2586"></a>  <span class="k">END IF</span>
<a name="ln-2587"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">LatHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2588"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span> <span class="o">=</span> <span class="n">LatHeatRecRate</span>
<a name="ln-2589"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2590"></a>  <span class="k">ELSE</span>
<a name="ln-2591"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2592"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">LatHeatRecRate</span><span class="p">)</span>
<a name="ln-2593"></a>  <span class="k">END IF</span>
<a name="ln-2594"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">TotHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2595"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span> <span class="o">=</span> <span class="n">TotHeatRecRate</span>
<a name="ln-2596"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2597"></a>  <span class="k">ELSE</span>
<a name="ln-2598"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2599"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TotHeatRecRate</span><span class="p">)</span>
<a name="ln-2600"></a>  <span class="k">END IF</span>
<a name="ln-2601"></a>
<a name="ln-2602"></a>
<a name="ln-2603"></a><span class="k">RETURN</span>
<a name="ln-2604"></a><span class="k">END SUBROUTINE </span><span class="n">CalcAirToAirGenericHeatExch</span>
<a name="ln-2605"></a>
<a name="ln-2606"></a><span class="k">SUBROUTINE </span><span class="n">CalcDesiccantBalancedHeatExch</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2607"></a>                                         <span class="n">CompanionCoilIndex</span><span class="p">,</span> <span class="n">RegenInletIsOANode</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="p">,</span> <span class="n">HighHumCtrlFlag</span><span class="p">)</span>
<a name="ln-2608"></a>
<a name="ln-2609"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2610"></a>          <span class="c">!       AUTHOR         Mangesh Basarkar, FSEC</span>
<a name="ln-2611"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-2612"></a>          <span class="c">!       MODIFIED       R. Raustad - FSEC, Feb 2009 - added economizer flags</span>
<a name="ln-2613"></a>          <span class="c">!                      Both the economizer and high humidity control flags can disable the HX</span>
<a name="ln-2614"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2615"></a>
<a name="ln-2616"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2617"></a>          <span class="c">!  Calculate the outlet conditions for a balanced air-to-air desiccant heat exchanger</span>
<a name="ln-2618"></a>          <span class="c">!  given the inlet conditions and face velocity. Performance map is provided by user.</span>
<a name="ln-2619"></a>
<a name="ln-2620"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2621"></a>          <span class="c">!  This is an empirical heat exchanger model. The model uses heat exchanger performance data to</span>
<a name="ln-2622"></a>          <span class="c">!  calculate the air temperature and humidity ratio of the leaving upply and secondary air streams.</span>
<a name="ln-2623"></a>          <span class="c">!</span>
<a name="ln-2624"></a>          <span class="c">!  Humidity control can enable/disable heat recovery through the use of the HXUnitOn Subroutine argument.</span>
<a name="ln-2625"></a>
<a name="ln-2626"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2627"></a>          <span class="c">! na</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2630"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilPartLoadRatio</span>
<a name="ln-2631"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SensedNodeFlagValue</span>
<a name="ln-2632"></a>
<a name="ln-2633"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2634"></a>
<a name="ln-2635"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2636"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ExNum</span>                  <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-2637"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HXUnitOn</span>               <span class="c">! flag to simulate heat exchager heat recovery</span>
<a name="ln-2638"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>     <span class="c">! First HVAC iteration flag</span>
<a name="ln-2639"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>              <span class="c">! Supply air fan operating mode (1=cycling, 2=constant)</span>
<a name="ln-2640"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>          <span class="c">! Part load ratio requested of DX compressor</span>
<a name="ln-2641"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CompanionCoilIndex</span>     <span class="c">! index of companion cooling coil</span>
<a name="ln-2642"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RegenInletIsOANode</span>     <span class="c">! Flag to determine if regen side inlet is OANode, if so this air stream cycles</span>
<a name="ln-2643"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EconomizerFlag</span> <span class="c">! economizer flag pass by air loop or OA sys</span>
<a name="ln-2644"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighHumCtrlFlag</span> <span class="c">! high humidity control flag passed by airloop or OA sys</span>
<a name="ln-2645"></a>
<a name="ln-2646"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2647"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">ErrorTol</span> <span class="o">=</span> <span class="mf">0.001d0</span>         <span class="c">!error tolerence</span>
<a name="ln-2648"></a>
<a name="ln-2649"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2650"></a>          <span class="c">! na</span>
<a name="ln-2651"></a>
<a name="ln-2652"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2653"></a>          <span class="c">! na</span>
<a name="ln-2654"></a>
<a name="ln-2655"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2656"></a>          <span class="c">!</span>
<a name="ln-2657"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UnitOn</span>              <span class="c">! unit on flag</span>
<a name="ln-2658"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RhoStd</span>              <span class="c">! standard air density at actual pressure, 20C dry-bulb temp and 0.0 absolute humidity [kg/m3]</span>
<a name="ln-2659"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSup</span>                <span class="c">! supply air heat capacity rate [W/K]</span>
<a name="ln-2660"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSec</span>                <span class="c">! secondary air heat capacity rate [W/K]</span>
<a name="ln-2661"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecOutSat</span>       <span class="c">! secondary air outlet temperature at saturation (at EnthsSecOut) [C]</span>
<a name="ln-2662"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensHeatRecRate</span>     <span class="c">! sensible heat recovery rate to supply air (heating +, cooling -)</span>
<a name="ln-2663"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotHeatRecRate</span>      <span class="c">! total heat recovery rate to supply air (heating +, cooling -)</span>
<a name="ln-2664"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ProcessSensHeatRecRate</span> <span class="c">! process sensible heat recovery rate (heating +, cooling -)</span>
<a name="ln-2665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ProcessTotHeatRecRate</span>  <span class="c">! process total heat recovery rate (heating +, cooling -)</span>
<a name="ln-2666"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ProcessLatHeatRecRate</span>  <span class="c">! process latent heat recovery rate (heating [humidify] +, cooling [dehumidify] -)</span>
<a name="ln-2667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupInMassFlow</span>       <span class="c">! Supply side HX mass flow rate</span>
<a name="ln-2668"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecInMassFlow</span>       <span class="c">! Secondary side HX mass flow rate</span>
<a name="ln-2669"></a>
<a name="ln-2670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff1</span>                 <span class="c">! coefficient1 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2671"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff2</span>                 <span class="c">! coefficient2 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2672"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff3</span>                 <span class="c">! coefficient3 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff4</span>                 <span class="c">! coefficient4 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff5</span>                 <span class="c">! coefficient5 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2675"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff6</span>                 <span class="c">! coefficient6 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2676"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff7</span>                 <span class="c">! coefficient7 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2677"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Coeff8</span>                 <span class="c">! coefficient8 to empirical model (used for both temperature and humidity ratio equations)</span>
<a name="ln-2678"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BalFaceVelActual</span>       <span class="c">! operating face velocity [m/s]</span>
<a name="ln-2679"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadSupOutTemp</span>     <span class="c">! empirical model supply outlet temperature [C]</span>
<a name="ln-2680"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadSupOutHumRat</span>   <span class="c">! empirical model supply outlet humidity ratio [kg/kg]</span>
<a name="ln-2681"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadDeltaT</span>         <span class="c">! empirical model heat exchanger delta temperature [C]</span>
<a name="ln-2682"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadDeltaW</span>         <span class="c">! empirical model heat exchanger delta humidity ratio [kg/kg]</span>
<a name="ln-2683"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_RegenInTemp</span>          <span class="c">! empirical model supply (regen) inlet temperature for temperature equation [C]</span>
<a name="ln-2684"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_RegenInHumRat</span>        <span class="c">! empirical model supply (regen) inlet humidity ratio for temperature equation [kg/kg]</span>
<a name="ln-2685"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_ProcInTemp</span>           <span class="c">! empirical model secondary (process) inlet temperature for temperature equation [C]</span>
<a name="ln-2686"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_ProcInHumRat</span>         <span class="c">! empirical model secondary (process) inlet humidity ratio for temperature equation [kg/kg]</span>
<a name="ln-2687"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_FaceVel</span>              <span class="c">! empirical model face velocity for temperature equation [m/s]</span>
<a name="ln-2688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_RegenInTemp</span>          <span class="c">! empirical model supply (regen) inlet temperature for humidity ratio equation [C]</span>
<a name="ln-2689"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_RegenInHumRat</span>        <span class="c">! empirical model supply (regen) inlet humidity ratio for humidity ratio equation [kg/kg]</span>
<a name="ln-2690"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_ProcInTemp</span>           <span class="c">! empirical model secondary (process) inlet temperature for humidity ratio equation [C]</span>
<a name="ln-2691"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_ProcInHumRat</span>         <span class="c">! empirical model secondary (process) inlet humidity ratio for humidity ratio equation [kg/kg]</span>
<a name="ln-2692"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_FaceVel</span>              <span class="c">! empirical model face velocity for humidity ratio equation [m/s]</span>
<a name="ln-2693"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxHumRatNeeded</span>        <span class="c">! maximum humidity ratio setpoint for balanced desiccant HX [kg/kg]</span>
<a name="ln-2694"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinHumRatNeeded</span>        <span class="c">! minimum humidity ratio setpoint for balanced desiccant HX [kg/kg]</span>
<a name="ln-2695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXPartLoadRatio</span>        <span class="c">! local heat exchanger part-load ratio</span>
<a name="ln-2696"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TestSaturationEnthalpy</span> <span class="c">! enthalpy used to test for regeneration outlet condition over saturation curve (J/kg)</span>
<a name="ln-2697"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ThisSub</span> <span class="o">=</span> <span class="s1">&#39;CalcDesiccantBalancedHeatExch:&#39;</span><span class="c">! Used to pass to Psyc routines</span>
<a name="ln-2698"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AverageMassFlowRate</span>    <span class="c">! average of supply (regen) and secondary (process) mass flow rates [kg/s]</span>
<a name="ln-2699"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">EconomizerActiveFlag</span>   <span class="c">! local representing the economizer status when PRESENT</span>
<a name="ln-2700"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HighHumCtrlActiveFlag</span>  <span class="c">! local representing high humidity control when PRESENT</span>
<a name="ln-2701"></a>
<a name="ln-2702"></a><span class="c">! Initialize local variables</span>
<a name="ln-2703"></a>  <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2704"></a>  <span class="n">SensHeatRecRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2705"></a>  <span class="n">TotHeatRecRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2706"></a>  <span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-2707"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">DefrostFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2708"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2709"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2710"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span>
<a name="ln-2711"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2712"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span>
<a name="ln-2713"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span>
<a name="ln-2714"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span>
<a name="ln-2715"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2716"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2717"></a>  <span class="n">AverageMassFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-2718"></a>
<a name="ln-2719"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">EconomizerFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2720"></a><span class="k">    </span><span class="n">EconomizerActiveFlag</span> <span class="o">=</span> <span class="n">EconomizerFlag</span>
<a name="ln-2721"></a>  <span class="k">ELSE</span>
<a name="ln-2722"></a><span class="k">    </span><span class="n">EconomizerActiveFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2723"></a>  <span class="k">END IF</span>
<a name="ln-2724"></a>
<a name="ln-2725"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HighHumCtrlFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2726"></a><span class="k">    </span><span class="n">HighHumCtrlActiveFlag</span> <span class="o">=</span> <span class="n">HighHumCtrlFlag</span>
<a name="ln-2727"></a>  <span class="k">ELSE</span>
<a name="ln-2728"></a><span class="k">    </span><span class="n">HighHumCtrlActiveFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2729"></a>  <span class="k">END IF</span>
<a name="ln-2730"></a>
<a name="ln-2731"></a><span class="c">! Unit is scheduled OFF, so bypass heat exchange calcs</span>
<a name="ln-2732"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2733"></a><span class="c">! Determine if unit is ON or OFF based on air mass flow through the supply and secondary airstreams and operation flag</span>
<a name="ln-2734"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2735"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2736"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HXPartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2737"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HXUnitOn</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2738"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">EconomizerActiveFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HighHumCtrlActiveFlag</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2739"></a>       <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">EconoLockOut</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EconoLockOut_Yes</span><span class="p">)</span> <span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2740"></a>
<a name="ln-2741"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2742"></a>
<a name="ln-2743"></a><span class="c">!   Use local variables to perform checks</span>
<a name="ln-2744"></a>    <span class="n">SecInMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-2745"></a>    <span class="n">SupInMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-2746"></a>
<a name="ln-2747"></a>    <span class="c">! In constant fan mode, process air mass flow rate is full flow and supply (regen) air cycles based on PLR.</span>
<a name="ln-2748"></a>    <span class="c">! If supply (regen) inlet is OA node, regen mass flow rate is proportional to PLR.</span>
<a name="ln-2749"></a>    <span class="c">! If both of the above is true then boost local variable up to full flow</span>
<a name="ln-2750"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RegenInletIsOANode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2751"></a><span class="k">      </span><span class="n">SupInMassFlow</span> <span class="o">=</span> <span class="n">SupInMassFlow</span> <span class="o">/</span> <span class="n">HXPartLoadRatio</span>
<a name="ln-2752"></a>    <span class="k">END IF</span>
<a name="ln-2753"></a>    <span class="c">! for cycling fan case, boost both local variables up to full flow</span>
<a name="ln-2754"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2755"></a><span class="k">      </span><span class="n">SupInMassFlow</span> <span class="o">=</span> <span class="n">SupInMassFlow</span> <span class="o">/</span> <span class="n">HXPartLoadRatio</span> <span class="c">! supply = regen</span>
<a name="ln-2756"></a>      <span class="n">SecInMassFlow</span> <span class="o">=</span> <span class="n">SecInMassFlow</span> <span class="o">/</span> <span class="n">HXPartLoadRatio</span> <span class="c">! secondary = process</span>
<a name="ln-2757"></a>    <span class="k">END IF</span>
<a name="ln-2758"></a>
<a name="ln-2759"></a>    <span class="c">! Check for balanced flow condition</span>
<a name="ln-2760"></a>    <span class="k">CALL </span><span class="n">CheckForBalancedFlow</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">SecInMassFlow</span><span class="p">,</span> <span class="n">SupInMassFlow</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatExchPerfTypeNum</span><span class="p">)</span>
<a name="ln-2763"></a>
<a name="ln-2764"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">BALANCEDHX_PERFDATATYPE1</span><span class="p">)</span>
<a name="ln-2765"></a>
<a name="ln-2766"></a>      <span class="n">Coeff1</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B1</span>
<a name="ln-2767"></a>      <span class="n">Coeff2</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B2</span>
<a name="ln-2768"></a>      <span class="n">Coeff3</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B3</span>
<a name="ln-2769"></a>      <span class="n">Coeff4</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B4</span>
<a name="ln-2770"></a>      <span class="n">Coeff5</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B5</span>
<a name="ln-2771"></a>      <span class="n">Coeff6</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B6</span>
<a name="ln-2772"></a>      <span class="n">Coeff7</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B7</span>
<a name="ln-2773"></a>      <span class="n">Coeff8</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">B8</span>
<a name="ln-2774"></a>
<a name="ln-2775"></a>      <span class="n">T_ProcInTemp</span>    <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-2776"></a>      <span class="n">T_ProcInHumRat</span>  <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-2777"></a>      <span class="n">T_RegenInTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2778"></a>      <span class="n">T_RegenInHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2779"></a>
<a name="ln-2780"></a>      <span class="c">! Must use the same density used to convert volumetric flow rate to mass flow rate to get back to velocity</span>
<a name="ln-2781"></a>      <span class="n">RhoStd</span>           <span class="o">=</span> <span class="n">StdRhoAir</span>  <span class="c">!PsyRhoAirFnPbTdbW(StdBaroPress,20.0d0, 0.0d0)</span>
<a name="ln-2782"></a>      <span class="n">BalFaceVelActual</span> <span class="o">=</span> <span class="n">SupInMassFlow</span> <span class="o">/</span> <span class="p">(</span><span class="n">RhoStd</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FaceArea</span><span class="p">)</span>
<a name="ln-2783"></a>
<a name="ln-2784"></a>      <span class="n">T_FaceVel</span> <span class="o">=</span> <span class="n">BalFaceVelActual</span>
<a name="ln-2785"></a>
<a name="ln-2786"></a><span class="c">!     Call model check routines only when HX is active, if coil is off these checks do not apply (no potential for heat transfer)</span>
<a name="ln-2787"></a><span class="c">!     Check RH limits and warn user if out of bounds (T_* not modified in subroutine)</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a>      <span class="k">CALL </span><span class="n">CheckModelBoundsRH_TempEq</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">T_RegenInTemp</span><span class="p">,</span> <span class="n">T_RegenInHumRat</span><span class="p">,</span> <span class="n">T_ProcInTemp</span><span class="p">,</span> <span class="n">T_ProcInHumRat</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2790"></a><span class="c">!     Check model boundaries and cap empirical model independent variables as needed (T_* may be modified on return from sub)</span>
<a name="ln-2791"></a>      <span class="k">CALL </span><span class="n">CheckModelBoundsTempEq</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">T_RegenInTemp</span><span class="p">,</span> <span class="n">T_RegenInHumRat</span><span class="p">,</span> <span class="n">T_ProcInTemp</span><span class="p">,</span> <span class="n">T_ProcInHumRat</span><span class="p">,</span> <span class="n">T_FaceVel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2792"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2793"></a>
<a name="ln-2794"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_ProcInTemp</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">T_RegenInTemp</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2795"></a><span class="k">        </span><span class="n">FullLoadSupOutTemp</span> <span class="o">=</span> <span class="n">Coeff1</span> <span class="o">+</span> <span class="n">Coeff2</span> <span class="o">*</span>  <span class="n">T_RegenInHumRat</span>                <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2796"></a>                                      <span class="n">Coeff3</span> <span class="o">*</span>  <span class="n">T_RegenInTemp</span>                  <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2797"></a>                                      <span class="n">Coeff4</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_RegenInHumRat</span><span class="o">/</span><span class="n">T_RegenInTemp</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2798"></a>                                      <span class="n">Coeff5</span> <span class="o">*</span>  <span class="n">T_ProcInHumRat</span>                 <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2799"></a>                                      <span class="n">Coeff6</span> <span class="o">*</span>  <span class="n">T_ProcInTemp</span>                   <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2800"></a>                                      <span class="n">Coeff7</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_ProcInHumRat</span><span class="o">/</span><span class="n">T_ProcInTemp</span><span class="p">)</span>   <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2801"></a>                                      <span class="n">Coeff8</span> <span class="o">*</span>  <span class="n">T_FaceVel</span>
<a name="ln-2802"></a>
<a name="ln-2803"></a>        <span class="c">! Check model boundary for supply (regen) temp and do not cap value if out of bounds, check that supply in temp &gt; out temp</span>
<a name="ln-2804"></a>        <span class="k">Call </span><span class="n">CheckModelBoundOutput_Temp</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">,</span> <span class="n">FullLoadSupOutTemp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2805"></a>        <span class="n">FullLoadDeltaT</span> <span class="o">=</span> <span class="n">FullLoadSupOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2806"></a>      <span class="k">ELSE</span>
<a name="ln-2807"></a><span class="k">        </span><span class="n">FullLoadDeltaT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2808"></a>      <span class="k">END IF</span>
<a name="ln-2809"></a>
<a name="ln-2810"></a><span class="k">      </span><span class="n">Coeff1</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C1</span>
<a name="ln-2811"></a>      <span class="n">Coeff2</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C2</span>
<a name="ln-2812"></a>      <span class="n">Coeff3</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C3</span>
<a name="ln-2813"></a>      <span class="n">Coeff4</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C4</span>
<a name="ln-2814"></a>      <span class="n">Coeff5</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C5</span>
<a name="ln-2815"></a>      <span class="n">Coeff6</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C6</span>
<a name="ln-2816"></a>      <span class="n">Coeff7</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C7</span>
<a name="ln-2817"></a>      <span class="n">Coeff8</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">C8</span>
<a name="ln-2818"></a>
<a name="ln-2819"></a>      <span class="n">H_ProcInTemp</span>    <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-2820"></a>      <span class="n">H_ProcInHumRat</span>  <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-2821"></a>      <span class="n">H_RegenInTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2822"></a>      <span class="n">H_RegenInHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2823"></a>      <span class="n">H_FaceVel</span>       <span class="o">=</span> <span class="n">BalFaceVelActual</span>
<a name="ln-2824"></a>
<a name="ln-2825"></a><span class="c">!     Call model check routines only when HX is active, if coil is off these checks do not apply (no potential for heat transfer)</span>
<a name="ln-2826"></a><span class="c">!     Check RH limits and warn user if out of bounds (H_* not modified in subroutine)</span>
<a name="ln-2827"></a>
<a name="ln-2828"></a>      <span class="k">CALL </span><span class="n">CheckModelBoundsRH_HumRatEq</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">H_RegenInTemp</span><span class="p">,</span> <span class="n">H_RegenInHumRat</span><span class="p">,</span> <span class="n">H_ProcInTemp</span><span class="p">,</span> <span class="n">H_ProcInHumRat</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2829"></a><span class="c">!     Check model boundaries and cap empirical model independent variables as needed (H_* may be modified on return from sub)</span>
<a name="ln-2830"></a>      <span class="k">CALL </span><span class="n">CheckModelBoundsHumRatEq</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">H_RegenInTemp</span><span class="p">,</span> <span class="n">H_RegenInHumRat</span><span class="p">,</span> <span class="n">H_ProcInTemp</span><span class="p">,</span> <span class="n">H_ProcInHumRat</span><span class="p">,</span> <span class="n">H_FaceVel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2831"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2832"></a>
<a name="ln-2833"></a><span class="c">!     Calc curve</span>
<a name="ln-2834"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_ProcInTemp</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">H_RegenInTemp</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2835"></a><span class="k">        </span><span class="n">FullLoadSupOutHumRat</span> <span class="o">=</span> <span class="n">Coeff1</span> <span class="o">+</span> <span class="n">Coeff2</span> <span class="o">*</span>  <span class="n">H_RegenInHumRat</span>                <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2836"></a>                                        <span class="n">Coeff3</span> <span class="o">*</span>  <span class="n">H_RegenInTemp</span>                  <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2837"></a>                                        <span class="n">Coeff4</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_RegenInHumRat</span><span class="o">/</span><span class="n">H_RegenInTemp</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2838"></a>                                        <span class="n">Coeff5</span> <span class="o">*</span>  <span class="n">H_ProcInHumRat</span>                 <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2839"></a>                                        <span class="n">Coeff6</span> <span class="o">*</span>  <span class="n">H_ProcInTemp</span>                   <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2840"></a>                                        <span class="n">Coeff7</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_ProcInHumRat</span><span class="o">/</span><span class="n">H_ProcInTemp</span><span class="p">)</span>   <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2841"></a>                                        <span class="n">Coeff8</span> <span class="o">*</span>  <span class="n">H_FaceVel</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a>        <span class="c">! Check model boundary for supply (regen) hum rat and do not cap value if out of bounds, check that supply in HR &lt; out HR</span>
<a name="ln-2844"></a>        <span class="k">Call </span><span class="n">CheckModelBoundOutput_HumRat</span><span class="p">(</span><span class="n">ExNum</span><span class="p">,</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span> <span class="n">FullLoadSupOutHumRat</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2845"></a>        <span class="n">FullLoadDeltaW</span> <span class="o">=</span>  <span class="n">FullLoadSupOutHumRat</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2846"></a>      <span class="k">ELSE</span>
<a name="ln-2847"></a><span class="k">        </span><span class="n">FullLoadDeltaW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2848"></a>      <span class="k">END IF</span>
<a name="ln-2849"></a>
<a name="ln-2850"></a><span class="c">!     Check for saturation in the model&#39;s calculated supply outlet and reset temp, then humidity ratio at constant enthalpy</span>
<a name="ln-2851"></a><span class="c">!     Reset delta T and delta W such that the model does not allow an outlet condition over saturation</span>
<a name="ln-2852"></a>      <span class="n">TestSaturationEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">FullLoadSupOutTemp</span><span class="p">,</span><span class="n">FullLoadSupOutHumRat</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; TestSatSup&#39;</span><span class="p">)</span>
<a name="ln-2853"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">TestSaturationEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; TSat&#39;</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">FullLoadSupOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2854"></a><span class="k">        </span><span class="n">FullLoadSupOutTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">TestSaturationEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; TSat-FullLoadOutTemp&#39;</span><span class="p">)</span>
<a name="ln-2855"></a>        <span class="n">FullLoadSupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadSupOutTemp</span><span class="p">,</span><span class="n">TestSaturationEnthalpy</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; TSat-FullLoadOutHumRat&#39;</span><span class="p">)</span>
<a name="ln-2856"></a>        <span class="n">FullLoadDeltaT</span> <span class="o">=</span> <span class="n">FullLoadSupOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-2857"></a>        <span class="n">FullLoadDeltaW</span> <span class="o">=</span> <span class="n">FullLoadSupOutHumRat</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-2858"></a>      <span class="k">END IF</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CalledFromParentObject</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2861"></a><span class="c">!       calculate part-load ratio for HX</span>
<a name="ln-2862"></a>        <span class="n">MaxHumRatNeeded</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutletNode</span><span class="p">)%</span><span class="n">HumRatMax</span>
<a name="ln-2863"></a>        <span class="n">MinHumRatNeeded</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutletNode</span><span class="p">)%</span><span class="n">HumRatMin</span>
<a name="ln-2864"></a>        <span class="c">! Calculate partload fraction of dehumidification capacity required to meet setpoint</span>
<a name="ln-2865"></a>
<a name="ln-2866"></a><span class="c">!       check the model output, if the regen delta W is positive, the process air stream is dehumidified</span>
<a name="ln-2867"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadDeltaW</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2868"></a><span class="c">!         check for a setpoint, if no setpoint then PLR remains at 1</span>
<a name="ln-2869"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">MaxHumRatNeeded</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2870"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxHumRatNeeded</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxHumRatNeeded</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2871"></a><span class="k">              </span><span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span> <span class="o">-</span> <span class="n">MaxHumRatNeeded</span><span class="p">)</span> <span class="o">/</span> <span class="n">FullLoadDeltaW</span>
<a name="ln-2872"></a>            <span class="k">ELSE</span>
<a name="ln-2873"></a><span class="k">              </span><span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2874"></a>            <span class="k">END IF</span>
<a name="ln-2875"></a><span class="k">          END IF</span>
<a name="ln-2876"></a><span class="c">!       check the model output, if the regen delta W is negative, the process air stream is humidified</span>
<a name="ln-2877"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">FullLoadDeltaW</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2878"></a><span class="c">!         check for a setpoint, if no setpoint then PLR remains at 1</span>
<a name="ln-2879"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">MinHumRatNeeded</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2880"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinHumRatNeeded</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MinHumRatNeeded</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2881"></a><span class="k">              </span><span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span> <span class="o">-</span> <span class="n">MinHumRatNeeded</span><span class="p">)</span> <span class="o">/</span> <span class="n">FullLoadDeltaW</span>
<a name="ln-2882"></a>            <span class="k">ELSE</span>
<a name="ln-2883"></a><span class="k">              </span><span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2884"></a>            <span class="k">END IF</span>
<a name="ln-2885"></a><span class="k">          END IF</span>
<a name="ln-2886"></a><span class="k">        END IF</span>
<a name="ln-2887"></a>
<a name="ln-2888"></a><span class="k">        </span><span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">HXPartLoadRatio</span><span class="p">)</span>
<a name="ln-2889"></a>        <span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">HXPartLoadRatio</span><span class="p">)</span>
<a name="ln-2890"></a>
<a name="ln-2891"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CompanionCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2892"></a><span class="k">        </span><span class="n">HXPartLoadRatio</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">CompanionCoilIndex</span><span class="p">)</span>
<a name="ln-2893"></a>      <span class="n">ENDIF</span>
<a name="ln-2894"></a>
<a name="ln-2895"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">RegenInletIsOANode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2896"></a><span class="c">!       Supply (regen) air stream mass flow rate is cycling and proportional to PLR, outlet conditions are full load conditions</span>
<a name="ln-2897"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="n">FullLoadDeltaT</span>
<a name="ln-2898"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">1.d-5</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">+</span> <span class="n">FullLoadDeltaW</span><span class="p">))</span>
<a name="ln-2899"></a>      <span class="k">ELSE</span>
<a name="ln-2900"></a><span class="c">!       Supply (regen) air stream mass flow rate is constant and outlet conditions are averaged</span>
<a name="ln-2901"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span>   <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="p">(</span><span class="n">FullLoadDeltaT</span> <span class="o">*</span> <span class="n">HXPartLoadRatio</span><span class="p">)</span>
<a name="ln-2902"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">1.d-5</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">+</span> <span class="p">(</span><span class="n">FullLoadDeltaW</span> <span class="o">*</span> <span class="n">HXPartLoadRatio</span><span class="p">)))</span>
<a name="ln-2903"></a>      <span class="k">END IF</span>
<a name="ln-2904"></a>
<a name="ln-2905"></a><span class="c">!     for a balanced flow HX, use average mass flow rate and actual node conditions to calculate CSup and CSec</span>
<a name="ln-2906"></a><span class="c">!     the mass flow rate on the process and secondary side of HX may be imbalanced when the HX is used in the OA branch</span>
<a name="ln-2907"></a><span class="c">!     use the average mass flow rate to avoid psych warnings, mass flow rates will converge at the end of the iteration</span>
<a name="ln-2908"></a><span class="c">!     if the air mass flow rates do not converge, this model should not be used</span>
<a name="ln-2909"></a>      <span class="n">CSup</span> <span class="o">=</span> <span class="n">AverageMassFlowRate</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; CSup&#39;</span><span class="p">)</span>
<a name="ln-2910"></a>      <span class="n">CSec</span> <span class="o">=</span> <span class="n">AverageMassFlowRate</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; CSec&#39;</span><span class="p">)</span>
<a name="ln-2911"></a>
<a name="ln-2912"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span>   <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; SupOutEnth&#39;</span><span class="p">)</span>
<a name="ln-2913"></a>
<a name="ln-2914"></a>      <span class="n">SensHeatRecRate</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-2915"></a>
<a name="ln-2916"></a>      <span class="n">TotHeatRecRate</span> <span class="o">=</span> <span class="n">AverageMassFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span><span class="p">)</span>
<a name="ln-2917"></a>
<a name="ln-2918"></a><span class="c">!     now calculate process side heat transfer</span>
<a name="ln-2919"></a>
<a name="ln-2920"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span> <span class="o">-</span> <span class="n">TotHeatRecRate</span><span class="o">/</span><span class="n">AverageMassFlowRate</span>
<a name="ln-2921"></a>
<a name="ln-2922"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">-</span> <span class="n">SensHeatRecRate</span><span class="o">/</span><span class="n">CSec</span>
<a name="ln-2923"></a>
<a name="ln-2924"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; SecOutHumRat&#39;</span><span class="p">)</span>
<a name="ln-2925"></a>
<a name="ln-2926"></a>      <span class="c">! check for saturation in process (secondary) outlet</span>
<a name="ln-2927"></a>      <span class="c">! The process outlet conditions should never be over the saturation curve for the balanced desiccant model</span>
<a name="ln-2928"></a>      <span class="c">! although this may occur during warmup. This check is included here for consistency.</span>
<a name="ln-2929"></a>      <span class="n">TempSecOutSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; TestSatSec&#39;</span><span class="p">)</span>
<a name="ln-2930"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TempSecOutSat</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2931"></a><span class="k">        </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">TempSecOutSat</span>
<a name="ln-2932"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2933"></a>                  <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">ThisSub</span><span class="o">//</span><span class="s1">&#39; TSat-SecOutHumRat&#39;</span><span class="p">)</span>
<a name="ln-2934"></a>      <span class="k">END IF</span>
<a name="ln-2935"></a>
<a name="ln-2936"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">NomElecPower</span> <span class="o">*</span> <span class="n">HXPartLoadRatio</span>
<a name="ln-2937"></a>
<a name="ln-2938"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2939"></a>
<a name="ln-2940"></a>    <span class="k">END SELECT</span>
<a name="ln-2941"></a>
<a name="ln-2942"></a><span class="k">  END IF</span> <span class="c">!ENDIF for &quot;IF (UnitOn) THEN&quot;</span>
<a name="ln-2943"></a>
<a name="ln-2944"></a><span class="c">! Report the process side heat transfer</span>
<a name="ln-2945"></a>  <span class="n">CSec</span> <span class="o">=</span> <span class="n">AverageMassFlowRate</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">,</span><span class="n">ThisSub</span><span class="p">)</span>
<a name="ln-2946"></a>  <span class="n">ProcessSensHeatRecRate</span> <span class="o">=</span> <span class="n">CSec</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">)</span>
<a name="ln-2947"></a>
<a name="ln-2948"></a>  <span class="n">ProcessTotHeatRecRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span><span class="p">)</span>
<a name="ln-2949"></a>
<a name="ln-2950"></a>  <span class="n">ProcessLatHeatRecRate</span> <span class="o">=</span> <span class="n">ProcessTotHeatRecRate</span> <span class="o">-</span> <span class="n">ProcessSensHeatRecRate</span>
<a name="ln-2951"></a>
<a name="ln-2952"></a><span class="c">! Set report variables based on sign of recovery rate</span>
<a name="ln-2953"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ProcessSensHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2954"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span> <span class="o">=</span> <span class="n">ProcessSensHeatRecRate</span>
<a name="ln-2955"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2956"></a>  <span class="k">ELSE</span>
<a name="ln-2957"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2958"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ProcessSensHeatRecRate</span><span class="p">)</span>
<a name="ln-2959"></a>  <span class="k">END IF</span>
<a name="ln-2960"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ProcessLatHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2961"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span> <span class="o">=</span> <span class="n">ProcessLatHeatRecRate</span>
<a name="ln-2962"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2963"></a>  <span class="k">ELSE</span>
<a name="ln-2964"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2965"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ProcessLatHeatRecRate</span><span class="p">)</span>
<a name="ln-2966"></a>  <span class="k">END IF</span>
<a name="ln-2967"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ProcessTotHeatRecRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2968"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span> <span class="o">=</span> <span class="n">ProcessTotHeatRecRate</span>
<a name="ln-2969"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2970"></a>  <span class="k">ELSE</span>
<a name="ln-2971"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2972"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ProcessTotHeatRecRate</span><span class="p">)</span>
<a name="ln-2973"></a>  <span class="k">END IF</span>
<a name="ln-2974"></a>
<a name="ln-2975"></a><span class="k">RETURN</span>
<a name="ln-2976"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDesiccantBalancedHeatExch</span>
<a name="ln-2977"></a>
<a name="ln-2978"></a><span class="k">SUBROUTINE </span><span class="n">FrostControl</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)</span>
<a name="ln-2979"></a>
<a name="ln-2980"></a>
<a name="ln-2981"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2982"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-2983"></a>          <span class="c">!       DATE WRITTEN   June 2003</span>
<a name="ln-2984"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2985"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2986"></a>
<a name="ln-2987"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2988"></a>          <span class="c">! Calculates fraction of timestep necessary to eliminate frost on ERV surface</span>
<a name="ln-2989"></a>          <span class="c">! by comparing secondary outlet or outdoor temperature to a frost control threshold</span>
<a name="ln-2990"></a>          <span class="c">! temperature.  Supply air and secondary air outlet conditions are calculated</span>
<a name="ln-2991"></a>          <span class="c">! based on frost control method selected.</span>
<a name="ln-2992"></a>
<a name="ln-2993"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2994"></a>          <span class="c">! NA</span>
<a name="ln-2995"></a>
<a name="ln-2996"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2997"></a>          <span class="c">! na</span>
<a name="ln-2998"></a>
<a name="ln-2999"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3000"></a>          <span class="c">! na</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3003"></a>
<a name="ln-3004"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3005"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExNum</span> <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">ErrorTol</span> <span class="o">=</span> <span class="mf">0.001d0</span>         <span class="c">! error tolerence for iteration loop</span>
<a name="ln-3009"></a>          <span class="c">! na</span>
<a name="ln-3010"></a>
<a name="ln-3011"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3012"></a>          <span class="c">! na</span>
<a name="ln-3013"></a>
<a name="ln-3014"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3015"></a>          <span class="c">! na</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DFFraction</span>          <span class="c">! fraction of timestep ERV is in frost control mode</span>
<a name="ln-3019"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RhoSup</span>              <span class="c">! density of supply air [kg/m3]</span>
<a name="ln-3020"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RhoSec</span>              <span class="c">! density of secondary air [kg/m3]</span>
<a name="ln-3021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Error</span>               <span class="c">! iteration loop error variable</span>
<a name="ln-3022"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Iter</span>                <span class="c">! iteration counter</span>
<a name="ln-3023"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSup</span>                <span class="c">! mdot Cp of supply air [W/K]</span>
<a name="ln-3024"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CSec</span>                <span class="c">! mdot Cp of secondary air [W/K]</span>
<a name="ln-3025"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CMin</span>                <span class="c">! minimum mdot Cp of supply or secondary air [W/K]</span>
<a name="ln-3026"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotTrans</span>           <span class="c">! total heat transfer by ERV [W]</span>
<a name="ln-3027"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSensTrans</span>          <span class="c">! sensible heat transfer by ERV [W]</span>
<a name="ln-3028"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXSecAirVolFlowRate</span> <span class="c">! air volume flow rate of the secondary air stream through the heat exchanger [m3/sec]</span>
<a name="ln-3029"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXSupAirVolFlowRate</span> <span class="c">! air volume flow rate of the supply air stream through the heat exchanger [m3/sec]</span>
<a name="ln-3030"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXAvgAirVolFlowRate</span> <span class="c">! average air volume flow rate through the heat exchanger [m3/sec]</span>
<a name="ln-3031"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXAirVolFlowRatio</span>   <span class="c">! nominal to actual air volume flow ratio</span>
<a name="ln-3032"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSupIn</span>       <span class="c">! supply air mass flow rate at HX inlet</span>
<a name="ln-3033"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSupOut</span>      <span class="c">! supply air mass flow rate through HX core outlet</span>
<a name="ln-3034"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MassFlowSupBypass</span>   <span class="c">! supply air bypass mass flow rate around HX core</span>
<a name="ln-3035"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSupIn</span>           <span class="c">! supply side temperature of air entering HX</span>
<a name="ln-3036"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSupOut</span>          <span class="c">! supply side temperature of air leaving HX core</span>
<a name="ln-3037"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HumRatSupIn</span>         <span class="c">! supply side humidity ratio of air entering HX</span>
<a name="ln-3038"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecIn</span>           <span class="c">! secondary side temperature of air entering HX</span>
<a name="ln-3039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSecOut</span>          <span class="c">! secondary side temperature of air leaving HX core</span>
<a name="ln-3040"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempThreshold</span>       <span class="c">! threshold temperature below which frost control is active</span>
<a name="ln-3041"></a>
<a name="ln-3042"></a>
<a name="ln-3043"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-3044"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-3045"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-3046"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-3047"></a>  <span class="n">RhoSup</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span>
<a name="ln-3048"></a>  <span class="n">RhoSec</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">)</span>
<a name="ln-3049"></a>  <span class="n">CSup</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-3050"></a>  <span class="n">CSec</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">)</span>
<a name="ln-3051"></a>  <span class="n">CMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">CSup</span><span class="p">,</span> <span class="n">CSec</span><span class="p">)</span>
<a name="ln-3052"></a>  <span class="n">TempThreshold</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ThresholdTemperature</span>
<a name="ln-3053"></a>
<a name="ln-3054"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ControlToTemperatureSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3055"></a>  <span class="c">! Recalculate HX outlet conditions as if control to temperature setpoint was not activated,</span>
<a name="ln-3056"></a>  <span class="c">! because defrost will override those results</span>
<a name="ln-3057"></a>
<a name="ln-3058"></a>    <span class="n">HXSupAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">/</span><span class="n">RhoSup</span>
<a name="ln-3059"></a>    <span class="n">HXSecAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">/</span><span class="n">RhoSec</span>
<a name="ln-3060"></a>    <span class="n">HXAvgAirVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">HXSecAirVolFlowRate</span> <span class="o">+</span> <span class="n">HXSupAirVolFlowRate</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-3061"></a>    <span class="n">HXAirVolFlowRatio</span> <span class="o">=</span> <span class="n">HXAvgAirVolFlowRate</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-3062"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3063"></a>      <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3064"></a>      <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-3065"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3066"></a>      <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3067"></a>      <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-3068"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3069"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span><span class="o">*</span><span class="n">CMin</span><span class="o">/</span><span class="n">CSup</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-3070"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3071"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span><span class="o">*</span><span class="n">CMin</span><span class="o">/</span><span class="n">CSup</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span>
<a name="ln-3072"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-3073"></a>
<a name="ln-3074"></a><span class="c">!   Check for saturation in supply outlet and reset temp, then humidity ratio at constant enthalpy</span>
<a name="ln-3075"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3076"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-3077"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3078"></a>    <span class="k">END IF</span>
<a name="ln-3079"></a>
<a name="ln-3080"></a><span class="k">    </span><span class="n">QSensTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-3081"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">+</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-3082"></a>    <span class="n">QTotTrans</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3083"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span> <span class="o">+</span> <span class="n">QTotTrans</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span>
<a name="ln-3084"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">)</span>
<a name="ln-3085"></a>  <span class="k">END IF</span>
<a name="ln-3086"></a>
<a name="ln-3087"></a><span class="c">! Check frost control by type</span>
<a name="ln-3088"></a>
<a name="ln-3089"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">==</span> <span class="s1">&#39;MINIMUMEXHAUSTTEMPERATURE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3090"></a><span class="c">!   A plate HX will bypass air on the supply side to keep exhaust temp above a</span>
<a name="ln-3091"></a><span class="c">!   threshold temperature and requires recalculating effectiveness based on</span>
<a name="ln-3092"></a><span class="c">!   the reduced air flow rate. A rotary HX modulates rotational speed to try to keep the</span>
<a name="ln-3093"></a><span class="c">!   exhaust air temperature above the threshold temperature. Assume that</span>
<a name="ln-3094"></a><span class="c">!   sensible and latent effectiveness decrease proportionally with rotary HX speed.</span>
<a name="ln-3095"></a>
<a name="ln-3096"></a>    <span class="n">DFFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SafeDiv</span><span class="p">((</span><span class="n">TempThreshold</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3097"></a>                                 <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">))))</span>
<a name="ln-3098"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ExchConfigNum</span> <span class="o">==</span> <span class="n">ROTARY</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3099"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span>
<a name="ln-3100"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span>
<a name="ln-3101"></a>    <span class="k">ELSE</span> <span class="c">! HX is a plate heat exchanger, bypass air to eliminate frost</span>
<a name="ln-3102"></a>      <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3103"></a>      <span class="n">Iter</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3104"></a>      <span class="n">MassFlowSupIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-3105"></a>      <span class="n">MassFlowSupOut</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span>
<a name="ln-3106"></a>      <span class="n">MassFlowSupBypass</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span>
<a name="ln-3107"></a>      <span class="n">TempSupIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span>
<a name="ln-3108"></a>      <span class="n">HumRatSupIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span>
<a name="ln-3109"></a>      <span class="n">TempSecIn</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span>
<a name="ln-3110"></a>
<a name="ln-3111"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Error</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ErrorTol</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Iter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-3112"></a>        <span class="n">MassFlowSupOut</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span>
<a name="ln-3113"></a>        <span class="n">MassFlowSupBypass</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span><span class="o">*</span><span class="n">DFFraction</span>
<a name="ln-3114"></a>        <span class="n">HXSupAirVolFlowRate</span> <span class="o">=</span> <span class="n">MassFlowSupOut</span><span class="o">/</span><span class="n">RhoSup</span>
<a name="ln-3115"></a>        <span class="n">HXSecAirVolFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">/</span><span class="n">RhoSec</span>
<a name="ln-3116"></a>        <span class="n">HXAvgAirVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">HXSecAirVolFlowRate</span> <span class="o">+</span> <span class="n">HXSupAirVolFlowRate</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-3117"></a>        <span class="n">HXAirVolFlowRatio</span> <span class="o">=</span> <span class="n">HXAvgAirVolFlowRate</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-3118"></a>        <span class="n">CSup</span> <span class="o">=</span> <span class="n">MassFlowSupOut</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">HumRatSupIn</span><span class="p">,</span><span class="n">TempSupIn</span><span class="p">)</span>
<a name="ln-3119"></a>        <span class="n">CMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">CSup</span><span class="p">,</span><span class="n">CSec</span><span class="p">)</span>
<a name="ln-3120"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TempSupIn</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TempSecIn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3121"></a><span class="c">!         Use heating effectiveness values</span>
<a name="ln-3122"></a>          <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3123"></a>              <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3124"></a>              <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-3125"></a>          <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3126"></a>              <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">HeatEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3127"></a>              <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-3128"></a>        <span class="k">ELSE</span>
<a name="ln-3129"></a><span class="c">!         Use cooling effectiveness values</span>
<a name="ln-3130"></a>          <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3131"></a>              <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectSensible75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3132"></a>              <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-3133"></a>          <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3134"></a>              <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent100</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">CoolEffectLatent75</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3135"></a>              <span class="p">(</span><span class="n">HXAirVolFlowRatio</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.75d0</span><span class="p">)</span>
<a name="ln-3136"></a>        <span class="k">END IF</span>
<a name="ln-3137"></a><span class="c">!         calculation of local variable Csup can be 0, gaurd against divide by 0.</span>
<a name="ln-3138"></a>          <span class="n">TempSupOut</span> <span class="o">=</span> <span class="n">TempSupIn</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3139"></a>              <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">*</span> <span class="n">SafeDiv</span><span class="p">(</span><span class="n">CMin</span><span class="p">,</span><span class="n">CSup</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSecIn</span> <span class="o">-</span> <span class="n">TempSupIn</span><span class="p">)</span>
<a name="ln-3140"></a>          <span class="n">QSensTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSupIn</span> <span class="o">-</span> <span class="n">TempSupOut</span><span class="p">)</span>
<a name="ln-3141"></a><span class="c">!         Csec cannot be 0 in this subroutine</span>
<a name="ln-3142"></a>          <span class="n">TempSecOut</span> <span class="o">=</span> <span class="n">TempSecIn</span> <span class="o">+</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-3143"></a>          <span class="n">Error</span> <span class="o">=</span>  <span class="p">(</span><span class="n">TempSecOut</span> <span class="o">-</span> <span class="n">TempThreshold</span><span class="p">)</span>
<a name="ln-3144"></a><span class="c">!         recalculate DFFraction until convergence, gaurd against divide by 0 (unlikely).</span>
<a name="ln-3145"></a>          <span class="n">DFFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">DFFraction</span> <span class="o">*</span> <span class="n">SafeDiv</span><span class="p">((</span><span class="n">TempSecIn</span> <span class="o">-</span> <span class="n">TempSecOut</span><span class="p">),(</span><span class="n">TempSecIn</span> <span class="o">-</span> <span class="n">TempThreshold</span><span class="p">))))</span>
<a name="ln-3146"></a>          <span class="n">Iter</span> <span class="o">=</span> <span class="n">Iter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3147"></a>      <span class="k">END DO</span>
<a name="ln-3148"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSupIn</span>
<a name="ln-3149"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSupOut</span>
<a name="ln-3150"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span> <span class="n">MassFlowSupBypass</span>
<a name="ln-3151"></a>    <span class="k">END IF</span>
<a name="ln-3152"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3153"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span><span class="o">*</span><span class="n">SafeDiv</span><span class="p">(</span><span class="n">CMin</span><span class="p">,</span><span class="n">CSup</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)</span>
<a name="ln-3154"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3155"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span><span class="o">*</span><span class="n">SafeDiv</span><span class="p">(</span><span class="n">CMin</span><span class="p">,</span><span class="n">CSup</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span>
<a name="ln-3156"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-3157"></a>
<a name="ln-3158"></a><span class="c">!   Check for saturation in supply outlet and reset temp, then humidity ratio at constant enthalpy</span>
<a name="ln-3159"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3160"></a><span class="k">        </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-3161"></a>        <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3162"></a>    <span class="k">END IF</span>
<a name="ln-3163"></a>
<a name="ln-3164"></a><span class="k">    </span><span class="n">QSensTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-3165"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">+</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-3166"></a>    <span class="n">QTotTrans</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3167"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span> <span class="o">+</span> <span class="n">QTotTrans</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span>
<a name="ln-3168"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">)</span>
<a name="ln-3169"></a>
<a name="ln-3170"></a><span class="c">!   Perform mixing of core air stream and bypass air stream and set mass flow rates at outlet nodes</span>
<a name="ln-3171"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="p">&amp;</span>
<a name="ln-3172"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3173"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-3174"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="p">&amp;</span>
<a name="ln-3175"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInHumRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3176"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-3177"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-3178"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span>
<a name="ln-3179"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="p">&amp;</span>
<a name="ln-3180"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3181"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-3182"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="p">&amp;</span>
<a name="ln-3183"></a>                                 <span class="o">+</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecBypassMassFlow</span><span class="o">*</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3184"></a>                                   <span class="o">/</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-3185"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span><span class="p">)</span>
<a name="ln-3186"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-3187"></a>
<a name="ln-3188"></a>  <span class="k">END IF</span>  <span class="c">! End of IF (Minimum Exhaust Temperature)</span>
<a name="ln-3189"></a>
<a name="ln-3190"></a>
<a name="ln-3191"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">==</span> <span class="s1">&#39;EXHAUSTAIRRECIRCULATION&#39;</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3192"></a><span class="c">!</span>
<a name="ln-3193"></a><span class="c">! Directing exhaust outlet air back across the HX core on the supply side</span>
<a name="ln-3194"></a><span class="c">! Assume no heat exchange when in frost control mode, full heat exchange otherwise</span>
<a name="ln-3195"></a><span class="c">!</span>
<a name="ln-3196"></a>     <span class="n">DFFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">((</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">InitialDefrostTime</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3197"></a>                  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">RateofDefrostTimeIncrease</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3198"></a>                  <span class="p">(</span><span class="n">TempThreshold</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)),</span><span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-3199"></a>
<a name="ln-3200"></a><span class="c">!    Calculate derated heat transfer using outlet air conditions assuming no defrost (calculated earlier)</span>
<a name="ln-3201"></a><span class="c">!    and (1-DefrostFraction)</span>
<a name="ln-3202"></a>     <span class="n">QSensTrans</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-3203"></a>     <span class="n">QTotTrans</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3204"></a>
<a name="ln-3205"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3206"></a>                                       <span class="n">DFFraction</span>    <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span>
<a name="ln-3207"></a>
<a name="ln-3208"></a><span class="c">!    Blend supply outlet condition of HX core with exhaust air inlet to get final supply air outlet conditions</span>
<a name="ln-3209"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3210"></a>                                  <span class="n">DFFraction</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3211"></a>                                  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span>
<a name="ln-3212"></a>
<a name="ln-3213"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3214"></a>                                  <span class="n">DFFraction</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInMassFlow</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInHumRat</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3215"></a>                                  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span>
<a name="ln-3216"></a>
<a name="ln-3217"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span><span class="p">)</span>
<a name="ln-3218"></a><span class="c">!    No need to check for saturation after SA out and EA inlet are blended</span>
<a name="ln-3219"></a>
<a name="ln-3220"></a>
<a name="ln-3221"></a><span class="c">!    Derate effectiveness based on frost control time fraction for reporting purposes</span>
<a name="ln-3222"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensEffectiveness</span>
<a name="ln-3223"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatEffectiveness</span>
<a name="ln-3224"></a>
<a name="ln-3225"></a><span class="c">!    Secondary air outlet conditions are previously calculated as the conditions when not</span>
<a name="ln-3226"></a><span class="c">!    in defrost, and this is what we want to report so no changes here.</span>
<a name="ln-3227"></a><span class="c">!</span>
<a name="ln-3228"></a><span class="c">!    Average SupInMassFlow and SecOutMassFlow rates have been reduced due to frost control</span>
<a name="ln-3229"></a><span class="c">!      Equipment attached to the supply inlet node may have problems with our setting the</span>
<a name="ln-3230"></a><span class="c">!      mass flow rate in the next statement. This is done only to simulate exhaust air recirc.</span>
<a name="ln-3231"></a>     <span class="n">Node</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span>
<a name="ln-3232"></a>     <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span>
<a name="ln-3233"></a>
<a name="ln-3234"></a>  <span class="k">END IF</span>  <span class="c">! End of IF (Exhaust Air Recirculation)</span>
<a name="ln-3235"></a>
<a name="ln-3236"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">FrostControlType</span> <span class="o">==</span> <span class="s1">&#39;EXHAUSTONLY&#39;</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3237"></a>
<a name="ln-3238"></a><span class="c">!   Perform frost control by bypassing the supply air around the HX core during the defrost</span>
<a name="ln-3239"></a><span class="c">!   time period. HX heat transfer is reduced proportionally to (1 - defrosttimefraction)</span>
<a name="ln-3240"></a>
<a name="ln-3241"></a>    <span class="n">DFFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">((</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">InitialDefrostTime</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3242"></a>                 <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">RateofDefrostTimeIncrease</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3243"></a>                 <span class="p">(</span><span class="n">TempThreshold</span><span class="o">-</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span><span class="p">)),</span><span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-3244"></a>
<a name="ln-3245"></a><span class="c">!   Calculate derated heat transfer based on defrost time</span>
<a name="ln-3246"></a>    <span class="n">QSensTrans</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-3247"></a>    <span class="n">QTotTrans</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DFFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3248"></a>
<a name="ln-3249"></a><span class="c">!   Calculate the air conditions leaving heat exchanger unit</span>
<a name="ln-3250"></a><span class="c">!   Heat exchanger effectiveness is not derated, HX is fully bypassed during frost control</span>
<a name="ln-3251"></a>
<a name="ln-3252"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupBypassMassFlow</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInMassFlow</span> <span class="o">*</span> <span class="n">DFFraction</span>
<a name="ln-3253"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSup</span>
<a name="ln-3254"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInEnth</span> <span class="o">-</span> <span class="n">QTotTrans</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span>
<a name="ln-3255"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3256"></a>
<a name="ln-3257"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3258"></a><span class="k">      </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-3259"></a>      <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span><span class="p">)</span>
<a name="ln-3260"></a>      <span class="n">QSensTrans</span> <span class="o">=</span> <span class="n">CSup</span> <span class="o">*</span> <span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInTemp</span> <span class="o">-</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span><span class="p">)</span>
<a name="ln-3261"></a>      <span class="c">! Should we be updating the sensible and latent effectiveness values also?</span>
<a name="ln-3262"></a>    <span class="k">END IF</span>
<a name="ln-3263"></a>
<a name="ln-3264"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInEnth</span> <span class="o">+</span> <span class="n">QTotTrans</span><span class="o">/</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span>
<a name="ln-3265"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInTemp</span> <span class="o">+</span> <span class="n">QSensTrans</span> <span class="o">/</span> <span class="n">CSec</span>
<a name="ln-3266"></a>    <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span><span class="p">)</span>
<a name="ln-3267"></a>  <span class="k">END IF</span>  <span class="c">! End of IF (Exhaust Only)</span>
<a name="ln-3268"></a>
<a name="ln-3269"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">DefrostFraction</span> <span class="o">=</span> <span class="n">DFFraction</span>
<a name="ln-3270"></a>
<a name="ln-3271"></a><span class="k">RETURN</span>
<a name="ln-3272"></a><span class="k">END SUBROUTINE </span><span class="n">FrostControl</span>
<a name="ln-3273"></a>
<a name="ln-3274"></a><span class="k">SUBROUTINE </span><span class="n">UpdateHeatRecovery</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)</span>
<a name="ln-3275"></a>
<a name="ln-3276"></a>
<a name="ln-3277"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3278"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3279"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3280"></a>          <span class="c">!       MODIFIED       Fred Buhl November 2000</span>
<a name="ln-3281"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3282"></a>
<a name="ln-3283"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3284"></a>          <span class="c">! Moves heat exchanger output to the outlet nodes.</span>
<a name="ln-3285"></a>
<a name="ln-3286"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3287"></a>          <span class="c">! NA</span>
<a name="ln-3288"></a>
<a name="ln-3289"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3290"></a>          <span class="c">! na</span>
<a name="ln-3291"></a>
<a name="ln-3292"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3293"></a>  <span class="k">USE </span><span class="n">DataContaminantBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Contaminant</span>
<a name="ln-3294"></a>
<a name="ln-3295"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3296"></a>
<a name="ln-3297"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3298"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExNum</span> <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-3299"></a>
<a name="ln-3300"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3301"></a>          <span class="c">! na</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3304"></a>          <span class="c">! na</span>
<a name="ln-3305"></a>
<a name="ln-3306"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3307"></a>          <span class="c">! na</span>
<a name="ln-3308"></a>
<a name="ln-3309"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3310"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SupInNode</span>  <span class="c">! supply inlet node number</span>
<a name="ln-3311"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SupOutNode</span> <span class="c">! supply outlet node number</span>
<a name="ln-3312"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SecInNode</span>  <span class="c">! secondary inlet node number</span>
<a name="ln-3313"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SecOutNode</span> <span class="c">! secondary outlet node number</span>
<a name="ln-3314"></a>
<a name="ln-3315"></a>  <span class="n">SupInNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupInletNode</span>
<a name="ln-3316"></a>  <span class="n">SupOutNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutletNode</span>
<a name="ln-3317"></a>  <span class="n">SecInNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecInletNode</span>
<a name="ln-3318"></a>  <span class="n">SecOutNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutletNode</span>
<a name="ln-3319"></a>
<a name="ln-3320"></a>  <span class="c">! Set the outlet air nodes of the heat exchanger</span>
<a name="ln-3321"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutTemp</span>
<a name="ln-3322"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">HumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutHumRat</span>
<a name="ln-3323"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutEnth</span>
<a name="ln-3324"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SupOutMassFlow</span>
<a name="ln-3325"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutTemp</span>
<a name="ln-3326"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">HumRat</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutHumRat</span>
<a name="ln-3327"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutEnth</span>
<a name="ln-3328"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SecOutMassFlow</span>
<a name="ln-3329"></a>
<a name="ln-3330"></a>  <span class="c">! Set the outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-3331"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">Quality</span>             <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-3332"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">Press</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-3333"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-3334"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-3335"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-3336"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-3337"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">Quality</span>             <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-3338"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">Press</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-3339"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-3340"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-3341"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-3342"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">CO2Simulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3345"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-3346"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-3347"></a>  <span class="k">End If</span>
<a name="ln-3348"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">GenericContamSimulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3349"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">SupOutNode</span><span class="p">)%</span><span class="n">GenContam</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SupInNode</span><span class="p">)%</span><span class="n">GenContam</span>
<a name="ln-3350"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SecOutNode</span><span class="p">)%</span><span class="n">GenContam</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SecInNode</span><span class="p">)%</span><span class="n">GenContam</span>
<a name="ln-3351"></a>  <span class="k">End If</span>
<a name="ln-3352"></a>
<a name="ln-3353"></a><span class="k">RETURN</span>
<a name="ln-3354"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateHeatRecovery</span>
<a name="ln-3355"></a>
<a name="ln-3356"></a><span class="k">SUBROUTINE </span><span class="n">ReportHeatRecovery</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)</span>
<a name="ln-3357"></a>
<a name="ln-3358"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3359"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3360"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3361"></a>          <span class="c">!       MODIFIED       F Buhl Nov 2000, D Shirey Feb/June 2003</span>
<a name="ln-3362"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3363"></a>
<a name="ln-3364"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3365"></a>          <span class="c">! Fill remaining report variables</span>
<a name="ln-3366"></a>
<a name="ln-3367"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3368"></a>          <span class="c">! na</span>
<a name="ln-3369"></a>
<a name="ln-3370"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3371"></a>          <span class="c">! na</span>
<a name="ln-3372"></a>
<a name="ln-3373"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3374"></a>  <span class="k">Use </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">AirToAirHXElecPower</span>
<a name="ln-3375"></a>
<a name="ln-3376"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3377"></a>
<a name="ln-3378"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3379"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExNum</span> <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-3380"></a>
<a name="ln-3381"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3382"></a>          <span class="c">! na</span>
<a name="ln-3383"></a>
<a name="ln-3384"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3385"></a>          <span class="c">! na</span>
<a name="ln-3386"></a>
<a name="ln-3387"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3388"></a>          <span class="c">! na</span>
<a name="ln-3389"></a>
<a name="ln-3390"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3391"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-3392"></a>
<a name="ln-3393"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3394"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3395"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensHeatingRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3396"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatHeatingRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3397"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotHeatingRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3398"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">SensCoolingRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3399"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">LatCoolingRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3400"></a>  <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingEnergy</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">TotCoolingRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3401"></a>
<a name="ln-3402"></a>  <span class="n">AirToAirHXElecPower</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">ExNum</span><span class="p">)%</span><span class="n">ElecUseRate</span>
<a name="ln-3403"></a>
<a name="ln-3404"></a><span class="k">RETURN</span>
<a name="ln-3405"></a>
<a name="ln-3406"></a><span class="k">END SUBROUTINE </span><span class="n">ReportHeatRecovery</span>
<a name="ln-3407"></a>
<a name="ln-3408"></a><span class="k">FUNCTION </span><span class="n">SafeDiv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-3409"></a>
<a name="ln-3410"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3411"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3412"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3413"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3414"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3415"></a>
<a name="ln-3416"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3417"></a>          <span class="c">! Returns a / b while preventing division by zero</span>
<a name="ln-3418"></a>
<a name="ln-3419"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3420"></a>          <span class="c">! Check for small or zero values before performing division</span>
<a name="ln-3421"></a>
<a name="ln-3422"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3423"></a>          <span class="c">! na</span>
<a name="ln-3424"></a>
<a name="ln-3425"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3426"></a>          <span class="c">! na</span>
<a name="ln-3427"></a>
<a name="ln-3428"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3429"></a>
<a name="ln-3430"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3431"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<a name="ln-3432"></a>
<a name="ln-3433"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3434"></a>          <span class="c">! na</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3437"></a>          <span class="c">! na</span>
<a name="ln-3438"></a>
<a name="ln-3439"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3440"></a>          <span class="c">! na</span>
<a name="ln-3441"></a>
<a name="ln-3442"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3443"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-3444"></a>
<a name="ln-3445"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3446"></a><span class="k">    </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="nb">SIGN</span><span class="p">(</span><span class="n">SMALL</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<a name="ln-3447"></a>  <span class="k">ELSE</span>
<a name="ln-3448"></a><span class="k">    </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-3449"></a>  <span class="k">END IF</span>
<a name="ln-3450"></a>
<a name="ln-3451"></a><span class="k">  RETURN</span>
<a name="ln-3452"></a>
<a name="ln-3453"></a><span class="k">END FUNCTION </span><span class="n">SafeDiv</span>
<a name="ln-3454"></a>
<a name="ln-3455"></a><span class="k">SUBROUTINE </span><span class="n">CalculateEpsFromNTUandZ</span><span class="p">(</span><span class="n">NTU</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">FlowArr</span><span class="p">,</span> <span class="n">Eps</span><span class="p">)</span>
<a name="ln-3456"></a>
<a name="ln-3457"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3458"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3459"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3460"></a>          <span class="c">!       MODIFIED       Fred Buhl November 2000</span>
<a name="ln-3461"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3462"></a>
<a name="ln-3463"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3464"></a>          <span class="c">! Calculates eps, the exchanger effectiveness,</span>
<a name="ln-3465"></a>          <span class="c">! from NTU, the number of transfer units,</span>
<a name="ln-3466"></a>          <span class="c">! from Z, the capacity rate ratio, and</span>
<a name="ln-3467"></a>          <span class="c">! from the flow arrangement</span>
<a name="ln-3468"></a>
<a name="ln-3469"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3470"></a>          <span class="c">! Uses the effectiveness - NTU heat exchanger formulas</span>
<a name="ln-3471"></a>
<a name="ln-3472"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3473"></a>          <span class="c">! M. Wetter, Simulation Model Air-to-Air Plate Heat Exchanger</span>
<a name="ln-3474"></a>          <span class="c">! LBNL Report 42354, 1999.</span>
<a name="ln-3475"></a>          <span class="c">! Also see:</span>
<a name="ln-3476"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit, pages 4-3 through 4-5</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3479"></a>          <span class="c">! na</span>
<a name="ln-3480"></a>
<a name="ln-3481"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3482"></a>
<a name="ln-3483"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3484"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NTU</span>     <span class="c">! number of transfer units</span>
<a name="ln-3485"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Z</span>       <span class="c">! capacity rate ratio</span>
<a name="ln-3486"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FlowArr</span> <span class="c">! flow arrangement</span>
<a name="ln-3487"></a>                                  <span class="c">! 1: COUNTER FLOW</span>
<a name="ln-3488"></a>                                  <span class="c">! 2: PARALLEL FLOW</span>
<a name="ln-3489"></a>                                  <span class="c">! 3: CROSS FLOW BOTH UNMIXED</span>
<a name="ln-3490"></a>                                  <span class="c">! 4: CROSS FLOW, Cmax MIXED, Cmin UNMIXED</span>
<a name="ln-3491"></a>                                  <span class="c">!    (coil with one row)</span>
<a name="ln-3492"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Eps</span>     <span class="c">! heat exchanger effectiveness</span>
<a name="ln-3493"></a>
<a name="ln-3494"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3495"></a>          <span class="c">! na</span>
<a name="ln-3496"></a>
<a name="ln-3497"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3498"></a>          <span class="c">! na</span>
<a name="ln-3499"></a>
<a name="ln-3500"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3501"></a>          <span class="c">! na</span>
<a name="ln-3502"></a>
<a name="ln-3503"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temp</span>   <span class="c">! temporary variable</span>
<a name="ln-3505"></a>
<a name="ln-3506"></a>  <span class="c">! check input validity</span>
<a name="ln-3507"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Z</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Z</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3508"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Variable Z (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;) out of range [0.0,1.0] in CalculateEpsFromNTUandZ&#39;</span><span class="p">)</span>
<a name="ln-3509"></a>  <span class="k">END IF</span>
<a name="ln-3510"></a>
<a name="ln-3511"></a>  <span class="c">! effectiveness</span>
<a name="ln-3512"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NTU</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3513"></a><span class="k">    </span><span class="n">Eps</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3514"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Eps independent of flow arrangement</span>
<a name="ln-3515"></a>    <span class="n">Eps</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">-</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="p">)</span>
<a name="ln-3516"></a>  <span class="k">ELSE</span>
<a name="ln-3517"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">FlowArr</span><span class="p">)</span>
<a name="ln-3518"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Counter_Flow</span><span class="p">)</span>   <span class="c">! COUNTER FLOW</span>
<a name="ln-3519"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Z</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3520"></a><span class="k">          </span><span class="n">Eps</span> <span class="o">=</span> <span class="n">NTU</span><span class="o">/</span><span class="p">(</span><span class="n">NTU</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3521"></a>        <span class="k">ELSE</span>
<a name="ln-3522"></a><span class="k">          </span><span class="n">Temp</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-3523"></a>          <span class="n">Eps</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-3524"></a>        <span class="k">END IF</span>
<a name="ln-3525"></a><span class="k">      CASE</span> <span class="p">(</span><span class="n">Parallel_Flow</span><span class="p">)</span>   <span class="c">! PARALLEL FLOW</span>
<a name="ln-3526"></a>        <span class="n">Temp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-3527"></a>        <span class="n">Eps</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">*</span><span class="n">Temp</span><span class="p">))</span> <span class="o">/</span> <span class="n">Temp</span>
<a name="ln-3528"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Cross_Flow_Both_Unmixed</span><span class="p">)</span>   <span class="c">! CROSS FLOW BOTH UNMIXED</span>
<a name="ln-3529"></a>        <span class="n">Temp</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">NTU</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.22d0</span><span class="p">)</span>
<a name="ln-3530"></a>        <span class="n">Eps</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="p">(</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">*</span><span class="n">Temp</span><span class="p">)</span> <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">/</span><span class="n">Temp</span> <span class="p">)</span>
<a name="ln-3531"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Cross_Flow_Other</span><span class="p">)</span>   <span class="c">! CROSS FLOW, Cmax MIXED, Cmin UNMIXED</span>
<a name="ln-3532"></a>        <span class="n">Eps</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">Z</span>
<a name="ln-3533"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3534"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;HeatRecovery: Illegal flow arrangement in CalculateEpsFromNTUandZ, Value=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3535"></a>                                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FlowArr</span><span class="p">)))</span>
<a name="ln-3536"></a>    <span class="k">END SELECT</span>
<a name="ln-3537"></a><span class="k">  END IF</span>
<a name="ln-3538"></a>
<a name="ln-3539"></a><span class="k">RETURN</span>
<a name="ln-3540"></a>
<a name="ln-3541"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateEpsFromNTUandZ</span>
<a name="ln-3542"></a>
<a name="ln-3543"></a><span class="k">SUBROUTINE </span><span class="n">CalculateNTUfromEpsAndZ</span><span class="p">(</span><span class="n">NTU</span><span class="p">,</span> <span class="n">Err</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">FlowArr</span><span class="p">,</span> <span class="n">Eps</span><span class="p">)</span>
<a name="ln-3544"></a>
<a name="ln-3545"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3546"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3547"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3548"></a>          <span class="c">!       MODIFIED       Fred Buhl November 2000</span>
<a name="ln-3549"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3550"></a>
<a name="ln-3551"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3552"></a>          <span class="c">! Calculates NTU, the number of transfer units,</span>
<a name="ln-3553"></a>          <span class="c">! based on eps, the exchanger effectiveness,</span>
<a name="ln-3554"></a>          <span class="c">! Z, the capacity rate ratio, and</span>
<a name="ln-3555"></a>          <span class="c">! from the flow arrangement</span>
<a name="ln-3556"></a>
<a name="ln-3557"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3558"></a>          <span class="c">! Uses the effectiveness - NTU heat exchanger formulas</span>
<a name="ln-3559"></a>
<a name="ln-3560"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3561"></a>          <span class="c">! M. Wetter, Simulation Model Air-to-Air Plate Heat Exchanger</span>
<a name="ln-3562"></a>          <span class="c">! LBNL Report 42354, 1999.</span>
<a name="ln-3563"></a>          <span class="c">! Also see:</span>
<a name="ln-3564"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit, pages 4-3 through 4-5</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3567"></a>          <span class="c">! na</span>
<a name="ln-3568"></a>
<a name="ln-3569"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3570"></a>
<a name="ln-3571"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Eps</span>     <span class="c">! heat exchanger effectiveness</span>
<a name="ln-3573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Z</span>       <span class="c">! capacity rate ratio</span>
<a name="ln-3574"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FlowArr</span> <span class="c">! flow arrangement</span>
<a name="ln-3575"></a>                                  <span class="c">! 1: COUNTER FLOW</span>
<a name="ln-3576"></a>                                  <span class="c">! 2: PARALLEL FLOW</span>
<a name="ln-3577"></a>                                  <span class="c">! 3: CROSS FLOW BOTH UNMIXED</span>
<a name="ln-3578"></a>                                  <span class="c">! 4: CROSS FLOW, Cmax MIXED, Cmin UNMIXED</span>
<a name="ln-3579"></a>                                  <span class="c">!    (coil with one row)</span>
<a name="ln-3580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NTU</span>    <span class="c">! number of transfer units</span>
<a name="ln-3581"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Err</span>    <span class="c">! error indicator</span>
<a name="ln-3582"></a>
<a name="ln-3583"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3584"></a>          <span class="c">! na</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3587"></a>          <span class="c">! na</span>
<a name="ln-3588"></a>
<a name="ln-3589"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3590"></a>          <span class="c">! na</span>
<a name="ln-3591"></a>
<a name="ln-3592"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3593"></a>
<a name="ln-3594"></a>  <span class="n">NTU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3595"></a>  <span class="c">! check input validity</span>
<a name="ln-3596"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Z</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Z</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3597"></a><span class="k">    </span><span class="n">Err</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3598"></a>    <span class="k">RETURN</span>
<a name="ln-3599"></a><span class="k">  END IF</span>
<a name="ln-3600"></a>
<a name="ln-3601"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">FlowArr</span> <span class="o">==</span> <span class="n">Parallel_Flow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3602"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">Eps</span><span class="o">&lt;</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Eps</span><span class="o">&gt;</span><span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3603"></a><span class="k">      </span><span class="n">Err</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3604"></a>      <span class="k">RETURN</span>
<a name="ln-3605"></a><span class="k">    END IF</span>
<a name="ln-3606"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">FlowArr</span> <span class="o">==</span> <span class="n">Cross_Flow_Other</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3607"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">Eps</span><span class="o">&lt;</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Eps</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="p">))</span><span class="o">/</span><span class="n">Z</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3608"></a><span class="k">      </span><span class="n">Err</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-3609"></a>      <span class="k">RETURN</span>
<a name="ln-3610"></a><span class="k">    END IF</span>
<a name="ln-3611"></a>    <span class="c">! check product (Eps*Z)</span>
<a name="ln-3612"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Eps</span><span class="o">*</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Eps</span><span class="o">*</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mf">1.d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="p">(</span><span class="n">SMALL</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3613"></a><span class="k">      </span><span class="n">Err</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-3614"></a>      <span class="k">RETURN</span>
<a name="ln-3615"></a><span class="k">    END IF</span>
<a name="ln-3616"></a>          <span class="c">! check product (Eps*Z)</span>
<a name="ln-3617"></a>  <span class="k">ELSE</span>
<a name="ln-3618"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">Eps</span><span class="o">&lt;</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Eps</span><span class="o">&gt;</span><span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3619"></a><span class="k">      </span><span class="n">Err</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-3620"></a>      <span class="k">RETURN</span>
<a name="ln-3621"></a><span class="k">    END IF</span>
<a name="ln-3622"></a><span class="k">  END IF</span>
<a name="ln-3623"></a>
<a name="ln-3624"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Eps</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! no effectiveness. Set NTU = 0</span>
<a name="ln-3625"></a>  <span class="n">NTU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3626"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Eps independent of flow arrangement</span>
<a name="ln-3627"></a>    <span class="n">NTU</span> <span class="o">=</span> <span class="o">-</span> <span class="nb">LOG</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Eps</span><span class="p">)</span>
<a name="ln-3628"></a>  <span class="k">ELSE</span>
<a name="ln-3629"></a>    <span class="c">! calculate based on configuration</span>
<a name="ln-3630"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FlowArr</span><span class="p">)</span>
<a name="ln-3631"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Counter_Flow</span><span class="p">)</span>   <span class="c">! COUNTER FLOW</span>
<a name="ln-3632"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Z</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3633"></a><span class="k">          </span><span class="n">NTU</span> <span class="o">=</span> <span class="n">Eps</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">Eps</span><span class="p">)</span>
<a name="ln-3634"></a>        <span class="k">ELSE</span>
<a name="ln-3635"></a><span class="k">          </span><span class="n">NTU</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">Z</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Eps</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3636"></a>        <span class="k">END IF</span>
<a name="ln-3637"></a><span class="k">      CASE</span> <span class="p">(</span><span class="n">Parallel_Flow</span><span class="p">)</span>   <span class="c">! PARALLEL FLOW</span>
<a name="ln-3638"></a>        <span class="n">NTU</span> <span class="o">=</span> <span class="o">-</span> <span class="nb">LOG</span><span class="p">(</span> <span class="o">-</span><span class="n">Eps</span> <span class="o">-</span> <span class="n">Eps</span> <span class="o">*</span> <span class="n">Z</span> <span class="o">+</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Z</span><span class="o">+</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-3639"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Cross_Flow_Both_Unmixed</span><span class="p">)</span>   <span class="c">! CROSS FLOW BOTH UNMIXED</span>
<a name="ln-3640"></a>        <span class="n">NTU</span> <span class="o">=</span> <span class="n">GetNTUforCrossFlowBothUnmixed</span><span class="p">(</span><span class="n">Eps</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<a name="ln-3641"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Cross_Flow_Other</span><span class="p">)</span>   <span class="c">! CROSS FLOW, Cmax MIXED, Cmin UNMIXED</span>
<a name="ln-3642"></a>        <span class="n">NTU</span> <span class="o">=</span> <span class="o">-</span><span class="nb">LOG</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="nb">LOG</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">eps</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span><span class="o">/</span><span class="n">Z</span> <span class="p">)</span>
<a name="ln-3643"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3644"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;HeatRecovery: Illegal flow arrangement in CalculateNTUfromEpsAndZ, Value=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3645"></a>                                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FlowArr</span><span class="p">)))</span>
<a name="ln-3646"></a>    <span class="k">END SELECT</span>
<a name="ln-3647"></a><span class="k">  END IF</span>
<a name="ln-3648"></a>
<a name="ln-3649"></a><span class="k">RETURN</span>
<a name="ln-3650"></a>
<a name="ln-3651"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateNTUfromEpsAndZ</span>
<a name="ln-3652"></a>
<a name="ln-3653"></a><span class="k">FUNCTION </span><span class="n">GetNTUforCrossFlowBothUnmixed</span><span class="p">(</span><span class="n">Eps</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">NTU</span><span class="p">)</span>
<a name="ln-3654"></a>
<a name="ln-3655"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3656"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3657"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3658"></a>          <span class="c">!       MODIFIED       Fred Buhl November 2000</span>
<a name="ln-3659"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3660"></a>
<a name="ln-3661"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3662"></a>          <span class="c">! Calculates the NTU value based on the exchanger effectiveness</span>
<a name="ln-3663"></a>          <span class="c">! and the capacity ratio for cross flow exchanger, both</span>
<a name="ln-3664"></a>          <span class="c">! streams unmixed</span>
<a name="ln-3665"></a>
<a name="ln-3666"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3667"></a>          <span class="c">! Uses a Regula Falsi solver function to numerically invert the formula</span>
<a name="ln-3668"></a>          <span class="c">! giving effectiveness as a function of NTU and Z..</span>
<a name="ln-3669"></a>
<a name="ln-3670"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3671"></a>          <span class="c">! M. Wetter, Simulation Model Air-to-Air Plate Heat Exchanger</span>
<a name="ln-3672"></a>          <span class="c">! LBNL Report 42354, 1999.</span>
<a name="ln-3673"></a>          <span class="c">! Also see:</span>
<a name="ln-3674"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit, pages 4-3 through 4-5</span>
<a name="ln-3675"></a>
<a name="ln-3676"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3677"></a>          <span class="c">! na</span>
<a name="ln-3678"></a>
<a name="ln-3679"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3680"></a>
<a name="ln-3681"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3682"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Eps</span>     <span class="c">! heat exchanger effectiveness</span>
<a name="ln-3683"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Z</span>       <span class="c">! capacity rate ratio</span>
<a name="ln-3684"></a>
<a name="ln-3685"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">NTU</span>     <span class="c">! result variable; number of transfer units</span>
<a name="ln-3686"></a>
<a name="ln-3687"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>       <span class="c">! Accuracy of result</span>
<a name="ln-3689"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>    <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>        <span class="c">! Maximum number of iterations</span>
<a name="ln-3690"></a>
<a name="ln-3691"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3692"></a>          <span class="c">! na</span>
<a name="ln-3693"></a>
<a name="ln-3694"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3695"></a>          <span class="c">! na</span>
<a name="ln-3696"></a>
<a name="ln-3697"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3698"></a>
<a name="ln-3699"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver</span>
<a name="ln-3700"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NTU0</span> <span class="o">=</span> <span class="mf">0.d0</span>           <span class="c">! lower bound for NTU</span>
<a name="ln-3701"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NTU1</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.d0</span>          <span class="c">! upper bound for NTU</span>
<a name="ln-3702"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>
<a name="ln-3703"></a>
<a name="ln-3704"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Eps</span>
<a name="ln-3705"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-3706"></a>
<a name="ln-3707"></a>  <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">NTU</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3708"></a>    <span class="n">GetResidCrossFlowBothUnmixed</span><span class="p">,</span> <span class="n">NTU0</span><span class="p">,</span> <span class="n">NTU1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3709"></a>
<a name="ln-3710"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3711"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;HeatRecovery: Bad initial bounds for NTU in GetNTUforCrossFlowBothUnmixed&#39;</span><span class="p">)</span>
<a name="ln-3712"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3713"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;HeatRecovery: No convergence in solving for NTU in GetNTUforCrossFlowBothUnmixed&#39;</span><span class="p">)</span>
<a name="ln-3714"></a>  <span class="k">END IF</span>
<a name="ln-3715"></a>
<a name="ln-3716"></a><span class="k">RETURN</span>
<a name="ln-3717"></a><span class="k">END FUNCTION </span><span class="n">GetNTUforCrossFlowBothUnmixed</span>
<a name="ln-3718"></a>
<a name="ln-3719"></a><span class="k">FUNCTION </span><span class="n">GetResidCrossFlowBothUnmixed</span><span class="p">(</span><span class="n">NTU</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-3720"></a>
<a name="ln-3721"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3722"></a>          <span class="c">!       AUTHOR         Michael Wetter</span>
<a name="ln-3723"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-3724"></a>          <span class="c">!       MODIFIED       Fred Buhl November 2000</span>
<a name="ln-3725"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3726"></a>
<a name="ln-3727"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3728"></a>          <span class="c">! From the formula Eps = f(NTU,Z) this function finds the</span>
<a name="ln-3729"></a>          <span class="c">! residual of f(NTU,Z) - Eps for a cross flow heat exchanger,</span>
<a name="ln-3730"></a>          <span class="c">! both streams unmixed.</span>
<a name="ln-3731"></a>
<a name="ln-3732"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3733"></a>          <span class="c">! Uses the effectiveness - NTU heat exchanger formula for cross</span>
<a name="ln-3734"></a>          <span class="c">! flow, both streams unmixed.</span>
<a name="ln-3735"></a>
<a name="ln-3736"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3737"></a>          <span class="c">! M. Wetter, Simulation Model Air-to-Air Plate Heat Exchanger</span>
<a name="ln-3738"></a>          <span class="c">! LBNL Report 42354, 1999.</span>
<a name="ln-3739"></a>          <span class="c">! Also see:</span>
<a name="ln-3740"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit, pages 4-3 through 4-5</span>
<a name="ln-3741"></a>
<a name="ln-3742"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3743"></a>          <span class="c">! na</span>
<a name="ln-3744"></a>
<a name="ln-3745"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3746"></a>
<a name="ln-3747"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3748"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NTU</span> <span class="c">! number of transfer units</span>
<a name="ln-3749"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = Eps, par(2) = Z</span>
<a name="ln-3750"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-3751"></a>
<a name="ln-3752"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3753"></a>          <span class="c">! na</span>
<a name="ln-3754"></a>
<a name="ln-3755"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3756"></a>          <span class="c">! na</span>
<a name="ln-3757"></a>
<a name="ln-3758"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3759"></a>          <span class="c">! na</span>
<a name="ln-3760"></a>
<a name="ln-3761"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a>    <span class="n">Residuum</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="p">(</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">**</span><span class="mf">0.78d0</span> <span class="o">*</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-3764"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">NTU</span><span class="o">**</span><span class="mf">0.22d0</span><span class="p">)</span> <span class="o">-</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3765"></a>
<a name="ln-3766"></a><span class="k">RETURN</span>
<a name="ln-3767"></a>
<a name="ln-3768"></a><span class="k">END FUNCTION </span><span class="n">GetResidCrossFlowBothUnmixed</span>
<a name="ln-3769"></a>
<a name="ln-3770"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBoundsTempEq</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">T_RegenInTemp</span><span class="p">,</span> <span class="n">T_RegenInHumRat</span><span class="p">,</span> <span class="n">T_ProcInTemp</span><span class="p">,</span> <span class="n">T_ProcInHumRat</span><span class="p">,</span> <span class="n">T_FaceVel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3771"></a>                                  <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3772"></a>
<a name="ln-3773"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3774"></a>          <span class="c">!       AUTHOR         Mangesh Basarkar, FSEC</span>
<a name="ln-3775"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-3776"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3777"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3780"></a>          <span class="c">!</span>
<a name="ln-3781"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables are within the limits used during the</span>
<a name="ln-3782"></a>          <span class="c">! developement of the empirical model.</span>
<a name="ln-3783"></a>
<a name="ln-3784"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3785"></a>          <span class="c">! The empirical models used for simulating a desiccant enhanced cooling coil are based on a limited data set.</span>
<a name="ln-3786"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-3787"></a>          <span class="c">! The range of each independent variable is provided by the user and are based on the limits of the</span>
<a name="ln-3788"></a>          <span class="c">! empirical model. These limits are tested in this subroutine each time step and returned for use by the calling</span>
<a name="ln-3789"></a>          <span class="c">! routine.</span>
<a name="ln-3790"></a>          <span class="c">!</span>
<a name="ln-3791"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3792"></a>          <span class="c">! na</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3795"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-3796"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-3797"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-3798"></a>
<a name="ln-3799"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3800"></a>
<a name="ln-3801"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS</span>
<a name="ln-3802"></a>   <span class="c">! regen outlet temp equation</span>
<a name="ln-3803"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExchNum</span> <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-3804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_RegenInTemp</span>             <span class="c">! current regen inlet temperature (C) for regen outlet temp eqn</span>
<a name="ln-3805"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_RegenInHumRat</span>           <span class="c">! current regen inlet hum rat for regen outlet temp eqn</span>
<a name="ln-3806"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_ProcInTemp</span>              <span class="c">! current process inlet temperature (C) for regen outlet temp eqn</span>
<a name="ln-3807"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_ProcInHumRat</span>            <span class="c">! current process inlet hum rat for regen outlet temp eqn</span>
<a name="ln-3808"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_FaceVel</span>                 <span class="c">! current process and regen face velocity (m/s)</span>
<a name="ln-3809"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>        <span class="c">! First HVAC iteration flag</span>
<a name="ln-3810"></a>
<a name="ln-3811"></a>  <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3812"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-3813"></a>
<a name="ln-3814"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3815"></a>          <span class="c">! na</span>
<a name="ln-3816"></a>
<a name="ln-3817"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3818"></a>          <span class="c">! na</span>
<a name="ln-3819"></a>
<a name="ln-3820"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3821"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-3822"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-3823"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-3824"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CharValue</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-3825"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-3826"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-3827"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-3828"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-3829"></a>
<a name="ln-3830"></a>
<a name="ln-3831"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-3832"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-3833"></a>
<a name="ln-3834"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-3835"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-3836"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-3837"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-3838"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3839"></a>
<a name="ln-3840"></a>      <span class="c">! print error for variables of regeneration outlet temperature equation</span>
<a name="ln-3841"></a>      <span class="c">! Regen inlet temp for temp eqn</span>
<a name="ln-3842"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3843"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3844"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3845"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3846"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempBuffer1</span><span class="p">))</span>
<a name="ln-3847"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempBuffer2</span><span class="p">))</span>
<a name="ln-3848"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempBuffer3</span><span class="p">))</span>
<a name="ln-3849"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using regeneration inlet air temperatures that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-3850"></a>                             <span class="o">//</span><span class="s1">&#39;air temperature equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-3851"></a>        <span class="k">ELSE</span>
<a name="ln-3852"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3853"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3854"></a>             <span class="s1">&#39;&quot; - Regeneration inlet air temp used in regen outlet air temperature equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3855"></a>                  <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3856"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3857"></a>                                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempLast</span><span class="p">)</span>
<a name="ln-3858"></a>        <span class="k">END IF</span>
<a name="ln-3859"></a><span class="k">      END IF</span>
<a name="ln-3860"></a>      <span class="c">! Regen inlet humidity ratio for temp eqn</span>
<a name="ln-3861"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInHumRatMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3862"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3863"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3864"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3865"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatBuffer1</span><span class="p">))</span>
<a name="ln-3866"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatBuffer2</span><span class="p">))</span>
<a name="ln-3867"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatBuffer3</span><span class="p">))</span>
<a name="ln-3868"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using regeneration inlet air humidity ratios that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-3869"></a>                             <span class="o">//</span><span class="s1">&#39;air temperature equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-3870"></a>        <span class="k">ELSE</span>
<a name="ln-3871"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3872"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Regeneration inlet air &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3873"></a>           <span class="s1">&#39;humidity ratio used in regen outlet temperature equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3874"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3875"></a>                               <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3876"></a>                                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatLast</span><span class="p">)</span>
<a name="ln-3877"></a>        <span class="k">END IF</span>
<a name="ln-3878"></a><span class="k">      END IF</span>
<a name="ln-3879"></a>      <span class="c">! Process inlet temp for temp eqn</span>
<a name="ln-3880"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3881"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3882"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3883"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3884"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempBuffer1</span><span class="p">))</span>
<a name="ln-3885"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempBuffer2</span><span class="p">))</span>
<a name="ln-3886"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempBuffer3</span><span class="p">))</span>
<a name="ln-3887"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process inlet air temperatures that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-3888"></a>                           <span class="o">//</span><span class="s1">&#39;air temperature equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-3889"></a>        <span class="k">ELSE</span>
<a name="ln-3890"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3891"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3892"></a>              <span class="s1">&#39;&quot; - Process inlet air temperature used in regen outlet temperature equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3893"></a>               <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3894"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3895"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempLast</span><span class="p">)</span>
<a name="ln-3896"></a>        <span class="k">END IF</span>
<a name="ln-3897"></a><span class="k">      END IF</span>
<a name="ln-3898"></a>      <span class="c">! Process inlet humidity ratio for temp eqn</span>
<a name="ln-3899"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInHumRatMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3900"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3901"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3902"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3903"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatBuffer1</span><span class="p">))</span>
<a name="ln-3904"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatBuffer2</span><span class="p">))</span>
<a name="ln-3905"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatBuffer3</span><span class="p">))</span>
<a name="ln-3906"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process inlet air humidity ratios that are outside the regeneratoin outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-3907"></a>                           <span class="o">//</span><span class="s1">&#39;air temperature equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-3908"></a>        <span class="k">ELSE</span>
<a name="ln-3909"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3910"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3911"></a>             <span class="s1">&#39;&quot; - Process inlet air humidity ratio used in regen outlet temperature equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3912"></a>              <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3913"></a>                               <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3914"></a>                                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatLast</span><span class="p">)</span>
<a name="ln-3915"></a>        <span class="k">END IF</span>
<a name="ln-3916"></a><span class="k">      END IF</span>
<a name="ln-3917"></a>      <span class="c">! Process and regeneration face velocity for temp eqn</span>
<a name="ln-3918"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_FaceVelMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3919"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3920"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3921"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3922"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelBuffer1</span><span class="p">))</span>
<a name="ln-3923"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelBuffer2</span><span class="p">))</span>
<a name="ln-3924"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelBuffer3</span><span class="p">))</span>
<a name="ln-3925"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process and regeneration face velocities that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-3926"></a>                       <span class="o">//</span><span class="s1">&#39;air temperature equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-3927"></a>        <span class="k">ELSE</span>
<a name="ln-3928"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3929"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Process &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3930"></a>               <span class="s1">&#39;and regen inlet air face velocity used in regen outlet temperature equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3931"></a>               <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelocityErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3932"></a>                                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3933"></a>                                  <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelLast</span><span class="p">)</span>
<a name="ln-3934"></a>        <span class="k">END IF</span>
<a name="ln-3935"></a><span class="k">      END IF</span>
<a name="ln-3936"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-3937"></a>
<a name="ln-3938"></a><span class="c">!   save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-3939"></a>    <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-3940"></a>    <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-3941"></a>
<a name="ln-3942"></a><span class="c">!   If regen and procees inlet temperatures are the same the coil is off, do not print out of bounds warning for this case</span>
<a name="ln-3943"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">T_RegenInTemp</span><span class="o">-</span><span class="n">T_ProcInTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Small</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3944"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3945"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3946"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3947"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3948"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3949"></a>      <span class="k">RETURN</span>
<a name="ln-3950"></a><span class="k">    END IF</span>
<a name="ln-3951"></a>
<a name="ln-3952"></a><span class="c">!   check boundaries of independent variables and post warnings to individual buffers to print at end of time step</span>
<a name="ln-3953"></a>    <span class="c">! checking model bounds for variables of regeneration outlet temperature equation</span>
<a name="ln-3954"></a>    <span class="c">! Regen inlet temp</span>
<a name="ln-3955"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">T_RegenInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3956"></a>      <span class="n">T_RegenInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3957"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempLast</span> <span class="o">=</span> <span class="n">T_RegenInTemp</span>
<a name="ln-3958"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_RegenInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3959"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3960"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3961"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_RegenInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3962"></a><span class="k">        </span><span class="n">T_RegenInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInTemp</span>
<a name="ln-3963"></a>      <span class="k">END IF</span>
<a name="ln-3964"></a><span class="k">      IF</span><span class="p">(</span><span class="n">T_RegenInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3965"></a><span class="k">        </span><span class="n">T_RegenInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInTemp</span>
<a name="ln-3966"></a>      <span class="k">END IF</span>
<a name="ln-3967"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3968"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3969"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3970"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3971"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration inlet air temperature &#39;</span> <span class="p">&amp;</span>
<a name="ln-3972"></a>          <span class="o">//</span><span class="s1">&#39;used in regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-3973"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3974"></a>           <span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-3975"></a>           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-3976"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_RegenInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3977"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInTempBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air temperature &#39;</span> <span class="p">&amp;</span>
<a name="ln-3978"></a>            <span class="o">//</span><span class="s1">&#39;equation: regeneration inlet air temperature passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-3979"></a>      <span class="k">ELSE</span>
<a name="ln-3980"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3981"></a>      <span class="k">END IF</span>
<a name="ln-3982"></a><span class="k">    ELSE</span>
<a name="ln-3983"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3984"></a>    <span class="k">END IF</span>
<a name="ln-3985"></a>    <span class="c">! regen inlet humidity ratio</span>
<a name="ln-3986"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">T_RegenInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3987"></a>      <span class="n">T_RegenInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3988"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatLast</span> <span class="o">=</span> <span class="n">T_RegenInHumRat</span>
<a name="ln-3989"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_RegenInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3990"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3991"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3992"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_RegenInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3993"></a><span class="k">        </span><span class="n">T_RegenInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInHumRat</span>
<a name="ln-3994"></a>      <span class="k">END IF</span>
<a name="ln-3995"></a><span class="k">      IF</span><span class="p">(</span><span class="n">T_RegenInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3996"></a><span class="k">        </span><span class="n">T_RegenInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInHumRat</span>
<a name="ln-3997"></a>      <span class="k">END IF</span>
<a name="ln-3998"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3999"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4000"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4001"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4002"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Regeneration inlet air&#39;</span> <span class="p">&amp;</span>
<a name="ln-4003"></a>          <span class="o">//</span><span class="s1">&#39; humidity ratio used in regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4004"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4005"></a>                     <span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-4006"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4007"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_RegenInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4008"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_RegenInHumRatBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air temperature &#39;</span> <span class="p">&amp;</span>
<a name="ln-4009"></a>                       <span class="o">//</span><span class="s1">&#39;equation: regeneration inlet air humidity ratio passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4010"></a>      <span class="k">ELSE</span>
<a name="ln-4011"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4012"></a>      <span class="k">END IF</span>
<a name="ln-4013"></a><span class="k">    ELSE</span>
<a name="ln-4014"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4015"></a>    <span class="k">END IF</span>
<a name="ln-4016"></a>    <span class="c">! process inlet temp</span>
<a name="ln-4017"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">T_ProcInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4018"></a>      <span class="n">T_ProcInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4019"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempLast</span> <span class="o">=</span> <span class="n">T_ProcInTemp</span>
<a name="ln-4020"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_ProcInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4021"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4022"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4023"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_ProcInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4024"></a><span class="k">        </span><span class="n">T_ProcInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInTemp</span>
<a name="ln-4025"></a>      <span class="k">END IF</span>
<a name="ln-4026"></a><span class="k">      IF</span><span class="p">(</span><span class="n">T_ProcInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4027"></a><span class="k">        </span><span class="n">T_ProcInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInTemp</span>
<a name="ln-4028"></a>      <span class="k">END IF</span>
<a name="ln-4029"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4030"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4031"></a><span class="c">!       Suppress warning message when process inlet temperature = 0 (DX coil is off)</span>
<a name="ln-4032"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempLast</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4033"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4034"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4035"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4036"></a>                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Process inlet air &#39;</span> <span class="p">&amp;</span>
<a name="ln-4037"></a>          <span class="o">//</span><span class="s1">&#39;temperature used in regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4038"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4039"></a>           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span> <span class="p">&amp;</span>
<a name="ln-4040"></a>           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4041"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_ProcInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4042"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInTempBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4043"></a>         <span class="s1">&#39;...Regeneration outlet air temperature equation: process inlet air temperature passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4044"></a>      <span class="k">ELSE</span>
<a name="ln-4045"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4046"></a>      <span class="k">END IF</span>
<a name="ln-4047"></a><span class="k">    ELSE</span>
<a name="ln-4048"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4049"></a>    <span class="k">END IF</span>
<a name="ln-4050"></a>    <span class="c">! process inlet humidity ratio</span>
<a name="ln-4051"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">T_ProcInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4052"></a>      <span class="n">T_ProcInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4053"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatLast</span> <span class="o">=</span> <span class="n">T_ProcInHumRat</span>
<a name="ln-4054"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_ProcInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4055"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4056"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4057"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_ProcInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4058"></a><span class="k">        </span><span class="n">T_ProcInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInHumRat</span>
<a name="ln-4059"></a>      <span class="k">END IF</span>
<a name="ln-4060"></a><span class="k">      IF</span><span class="p">(</span><span class="n">T_ProcInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4061"></a><span class="k">        </span><span class="n">T_ProcInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInHumRat</span>
<a name="ln-4062"></a>      <span class="k">END IF</span>
<a name="ln-4063"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4064"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4065"></a><span class="c">!       Suppress warning message when process inlet humrat = 0 (DX coil is off)</span>
<a name="ln-4066"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatLast</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4067"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4068"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4069"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4070"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Process inlet air&#39;</span> <span class="p">&amp;</span>
<a name="ln-4071"></a>          <span class="o">//</span><span class="s1">&#39; humidity ratio used in regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4072"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatBuffer2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4073"></a>          <span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4074"></a>          <span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4075"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_ProcInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4076"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4077"></a>          <span class="s1">&#39;temperature equation: process inlet air humidity ratio passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4078"></a>      <span class="k">ELSE</span>
<a name="ln-4079"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4080"></a>      <span class="k">END IF</span>
<a name="ln-4081"></a><span class="k">    ELSE</span>
<a name="ln-4082"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4083"></a>    <span class="k">END IF</span>
<a name="ln-4084"></a>    <span class="c">! regeneration and process face velocity</span>
<a name="ln-4085"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">T_FaceVel</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinFaceVel</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4086"></a>      <span class="n">T_FaceVel</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4087"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelLast</span> <span class="o">=</span> <span class="n">T_FaceVel</span>
<a name="ln-4088"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_FaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4089"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4090"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4091"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_FaceVel</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4092"></a><span class="k">        </span><span class="n">T_FaceVel</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinFaceVel</span>
<a name="ln-4093"></a>      <span class="k">END IF</span>
<a name="ln-4094"></a><span class="k">      IF</span><span class="p">(</span><span class="n">T_FaceVel</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4095"></a><span class="k">        </span><span class="n">T_FaceVel</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxFaceVel</span>
<a name="ln-4096"></a>      <span class="k">END IF</span>
<a name="ln-4097"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4098"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4099"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4100"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4101"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Process and regen inlet air face &#39;</span> <span class="p">&amp;</span>
<a name="ln-4102"></a>           <span class="o">//</span><span class="s1">&#39;velocity used in regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4103"></a>           <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4104"></a>           <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4105"></a>           <span class="o">//</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4106"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">T_FaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4107"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_FaceVelBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4108"></a>         <span class="s1">&#39;...Regeneration outlet air temperature equation: process and regen face velocity passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4109"></a>      <span class="k">ELSE</span>
<a name="ln-4110"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4111"></a>      <span class="k">END IF</span>
<a name="ln-4112"></a><span class="k">    ELSE</span>
<a name="ln-4113"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintT_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4114"></a>    <span class="k">END IF</span>
<a name="ln-4115"></a>
<a name="ln-4116"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBoundsTempEq</span>
<a name="ln-4117"></a>
<a name="ln-4118"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBoundsHumRatEq</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">H_RegenInTemp</span><span class="p">,</span> <span class="n">H_RegenInHumRat</span><span class="p">,</span> <span class="n">H_ProcInTemp</span><span class="p">,</span> <span class="n">H_ProcInHumRat</span><span class="p">,</span> <span class="n">H_FaceVel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4119"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4120"></a>
<a name="ln-4121"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4122"></a>          <span class="c">!       AUTHOR         Mangesh Basarkar, FSEC</span>
<a name="ln-4123"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-4124"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4125"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4126"></a>
<a name="ln-4127"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4128"></a>          <span class="c">!</span>
<a name="ln-4129"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables are within the limits used during the</span>
<a name="ln-4130"></a>          <span class="c">! developement of the empirical model.</span>
<a name="ln-4131"></a>
<a name="ln-4132"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4133"></a>          <span class="c">! The empirical models used for simulating a desiccant enhanced cooling coil are based on a limited data set.</span>
<a name="ln-4134"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-4135"></a>          <span class="c">! The range of each independent variable is provided by the user and are based on the limits of the</span>
<a name="ln-4136"></a>          <span class="c">! empirical model. These limits are tested in this subroutine each time step and returned for use by the calling</span>
<a name="ln-4137"></a>          <span class="c">! routine.</span>
<a name="ln-4138"></a>          <span class="c">!</span>
<a name="ln-4139"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4140"></a>          <span class="c">! na</span>
<a name="ln-4141"></a>
<a name="ln-4142"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4143"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4144"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-4145"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-4146"></a>
<a name="ln-4147"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4148"></a>
<a name="ln-4149"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4150"></a>   <span class="c">! regen outlet humidity ratio equation</span>
<a name="ln-4151"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExchNum</span>                   <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-4152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_RegenInTemp</span>             <span class="c">! current regen inlet temperature (C) for regen outlet hum rat eqn</span>
<a name="ln-4153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_RegenInHumRat</span>           <span class="c">! current regen inlet hum rat for regen outlet hum rat eqn</span>
<a name="ln-4154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_ProcInTemp</span>              <span class="c">! current process inlet temperature (C) for regen outlet hum rat eqn</span>
<a name="ln-4155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_ProcInHumRat</span>            <span class="c">! current process inlet hum rat for regen outlet hum rat eqn</span>
<a name="ln-4156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_FaceVel</span>                 <span class="c">! current process and regen face velocity (m/s)</span>
<a name="ln-4157"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>        <span class="c">! First HVAC iteration flag</span>
<a name="ln-4158"></a>
<a name="ln-4159"></a>      <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4160"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-4161"></a>
<a name="ln-4162"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4163"></a>          <span class="c">! na</span>
<a name="ln-4164"></a>
<a name="ln-4165"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4166"></a>          <span class="c">! na</span>
<a name="ln-4167"></a>
<a name="ln-4168"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4169"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4170"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4171"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4172"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CharValue</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4173"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-4174"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-4175"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-4176"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-4177"></a>
<a name="ln-4178"></a>
<a name="ln-4179"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-4180"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4181"></a>
<a name="ln-4182"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-4183"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-4184"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-4185"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-4186"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4187"></a>
<a name="ln-4188"></a>    <span class="c">! print error for variables of regeneration outlet humidity ratio equation</span>
<a name="ln-4189"></a>      <span class="c">! Regen inlet temp for humidity ratio eqn</span>
<a name="ln-4190"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4191"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4192"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4193"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4194"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempBuffer1</span><span class="p">))</span>
<a name="ln-4195"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempBuffer2</span><span class="p">))</span>
<a name="ln-4196"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempBuffer3</span><span class="p">))</span>
<a name="ln-4197"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using regeneration inlet air temperatures that are outside the regeneration inlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-4198"></a>                       <span class="o">//</span><span class="s1">&#39;air temperature equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-4199"></a>        <span class="k">ELSE</span>
<a name="ln-4200"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4201"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Regeneration inlet air &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4202"></a>           <span class="s1">&#39;temperature used in regen outlet air humidity ratio equation is out of range error continues...&#39;</span><span class="p">,&amp;</span>
<a name="ln-4203"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4204"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4205"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempLast</span><span class="p">)</span>
<a name="ln-4206"></a>        <span class="k">END IF</span>
<a name="ln-4207"></a><span class="k">      END IF</span>
<a name="ln-4208"></a>      <span class="c">! Regen inlet humidity ratio for humidity ratio eqn</span>
<a name="ln-4209"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInHumRatMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4210"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4211"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4212"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4213"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatBuffer1</span><span class="p">))</span>
<a name="ln-4214"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatBuffer2</span><span class="p">))</span>
<a name="ln-4215"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatBuffer3</span><span class="p">))</span>
<a name="ln-4216"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using regeneration inlet air humidity ratios that are outside the regeneration &#39;</span> <span class="p">&amp;</span>
<a name="ln-4217"></a>                     <span class="o">//</span><span class="s1">&#39;outlet air humidity ratio equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-4218"></a>        <span class="k">ELSE</span>
<a name="ln-4219"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4220"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4221"></a>              <span class="s1">&#39;&quot; - Regeneration inlet air humidity ratio used in regen outlet air humidity ratio equation is out of range &#39;</span> <span class="p">&amp;</span>
<a name="ln-4222"></a>              <span class="o">//</span><span class="s1">&#39;error continues...&#39;</span><span class="p">,</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4223"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4224"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatLast</span><span class="p">)</span>
<a name="ln-4225"></a>        <span class="k">END IF</span>
<a name="ln-4226"></a><span class="k">      END IF</span>
<a name="ln-4227"></a>      <span class="c">! Process inlet temp for humidity ratio eqn</span>
<a name="ln-4228"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4229"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4230"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4231"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4232"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempBuffer1</span><span class="p">))</span>
<a name="ln-4233"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempBuffer2</span><span class="p">))</span>
<a name="ln-4234"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempBuffer3</span><span class="p">))</span>
<a name="ln-4235"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process inlet air temperatures that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-4236"></a>                       <span class="o">//</span><span class="s1">&#39;air humidity ratio equation model may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-4237"></a>        <span class="k">ELSE</span>
<a name="ln-4238"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4239"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Process inlet air &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4240"></a>              <span class="s1">&#39;temperature used in regen outlet air humidity ratio equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4241"></a>                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4242"></a>                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4243"></a>                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempLast</span><span class="p">)</span>
<a name="ln-4244"></a>        <span class="k">END IF</span>
<a name="ln-4245"></a><span class="k">      END IF</span>
<a name="ln-4246"></a>      <span class="c">! Process inlet humidity ratio for humidity ratio eqn</span>
<a name="ln-4247"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInHumRatMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4248"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4249"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4250"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4251"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatBuffer1</span><span class="p">))</span>
<a name="ln-4252"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatBuffer2</span><span class="p">))</span>
<a name="ln-4253"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatBuffer3</span><span class="p">))</span>
<a name="ln-4254"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process inlet air humidity ratios that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-4255"></a>                      <span class="o">//</span><span class="s1">&#39;humidity ratio equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-4256"></a>        <span class="k">ELSE</span>
<a name="ln-4257"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4258"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Process inlet air &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4259"></a>              <span class="s1">&#39;humidity ratio used in regen outlet air humidity ratio equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4260"></a>                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_ProcInHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4261"></a>                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4262"></a>                <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatLast</span><span class="p">)</span>
<a name="ln-4263"></a>        <span class="k">END IF</span>
<a name="ln-4264"></a><span class="k">      END IF</span>
<a name="ln-4265"></a>      <span class="c">! Process and regeneration face velocity for humidity ratio eqn</span>
<a name="ln-4266"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_FaceVelMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4267"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4268"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4269"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4270"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelBuffer1</span><span class="p">))</span>
<a name="ln-4271"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelBuffer2</span><span class="p">))</span>
<a name="ln-4272"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelBuffer3</span><span class="p">))</span>
<a name="ln-4273"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process and regeneration face velocities that are outside the regeneration outlet &#39;</span> <span class="p">&amp;</span>
<a name="ln-4274"></a>                       <span class="o">//</span><span class="s1">&#39;air humidity ratio equation model boundaries may adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-4275"></a>        <span class="k">ELSE</span>
<a name="ln-4276"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4277"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Process and regen face &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4278"></a>            <span class="s1">&#39;velocity used in regen outlet air humidity ratio equation is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4279"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelocityErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4280"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4281"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelLast</span><span class="p">)</span>
<a name="ln-4282"></a>        <span class="k">END IF</span>
<a name="ln-4283"></a><span class="k">      END IF</span>
<a name="ln-4284"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-4285"></a>
<a name="ln-4286"></a><span class="c">!   save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-4287"></a>    <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-4288"></a>    <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-4289"></a>
<a name="ln-4290"></a><span class="c">!   If regen and procees inlet temperatures are the same the coil is off, do not print out of bounds warning for this case</span>
<a name="ln-4291"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">H_RegenInTemp</span><span class="o">-</span><span class="n">H_ProcInTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Small</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4292"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4293"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4294"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4295"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4296"></a>      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4297"></a>      <span class="k">RETURN</span>
<a name="ln-4298"></a><span class="k">    END IF</span>
<a name="ln-4299"></a>
<a name="ln-4300"></a><span class="c">!   check boundaries of independent variables and post warnings to individual buffers to print at end of time step</span>
<a name="ln-4301"></a>    <span class="c">! checking model bounds for variables of regeneration outlet humidity ratio equation</span>
<a name="ln-4302"></a>    <span class="c">! Regen inlet temp</span>
<a name="ln-4303"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">H_RegenInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4304"></a>      <span class="n">H_RegenInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4305"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempLast</span> <span class="o">=</span> <span class="n">H_RegenInTemp</span>
<a name="ln-4306"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_RegenInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4307"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4308"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4309"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_RegenInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4310"></a><span class="k">        </span><span class="n">H_RegenInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInTemp</span>
<a name="ln-4311"></a>      <span class="k">END IF</span>
<a name="ln-4312"></a><span class="k">      IF</span><span class="p">(</span><span class="n">H_RegenInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4313"></a><span class="k">        </span><span class="n">H_RegenInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInTemp</span>
<a name="ln-4314"></a>      <span class="k">END IF</span>
<a name="ln-4315"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4316"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4317"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4318"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4319"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration inlet air &#39;</span> <span class="p">&amp;</span>
<a name="ln-4320"></a>          <span class="o">//</span><span class="s1">&#39;temperature used in regen outlet air humidity ratio equation is outside model boundaries at &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4321"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4322"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4323"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; , &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4324"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_RegenInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4325"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInTempBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air humidity ratio &#39;</span> <span class="p">&amp;</span>
<a name="ln-4326"></a>                         <span class="o">//</span><span class="s1">&#39;equation: regeneration inlet air temperature passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4327"></a>      <span class="k">ELSE</span>
<a name="ln-4328"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4329"></a>      <span class="k">END IF</span>
<a name="ln-4330"></a><span class="k">    ELSE</span>
<a name="ln-4331"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4332"></a>    <span class="k">END IF</span>
<a name="ln-4333"></a>    <span class="c">! regen inlet humidity ratio</span>
<a name="ln-4334"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">H_RegenInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4335"></a>      <span class="n">H_RegenInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4336"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatLast</span> <span class="o">=</span> <span class="n">H_RegenInHumRat</span>
<a name="ln-4337"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_RegenInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4338"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4339"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4340"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_RegenInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4341"></a><span class="k">        </span><span class="n">H_RegenInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInHumRat</span>
<a name="ln-4342"></a>      <span class="k">END IF</span>
<a name="ln-4343"></a><span class="k">      IF</span><span class="p">(</span><span class="n">H_RegenInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4344"></a><span class="k">        </span><span class="n">H_RegenInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInHumRat</span>
<a name="ln-4345"></a>      <span class="k">END IF</span>
<a name="ln-4346"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4347"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4348"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4349"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4350"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration inlet air humidity &#39;</span> <span class="p">&amp;</span>
<a name="ln-4351"></a>          <span class="o">//</span> <span class="s1">&#39;ratio used in regen outlet air humidity ratio equation is outside model boundaries at &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4352"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4353"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4354"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4355"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_RegenInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4356"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_RegenInHumRatBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air humidity &#39;</span> <span class="p">&amp;</span>
<a name="ln-4357"></a>          <span class="o">//</span><span class="s1">&#39;ratio equation: regeneration inlet air humidity ratio passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4358"></a>      <span class="k">ELSE</span>
<a name="ln-4359"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4360"></a>      <span class="k">END IF</span>
<a name="ln-4361"></a><span class="k">    ELSE</span>
<a name="ln-4362"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_RegenInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4363"></a>    <span class="k">END IF</span>
<a name="ln-4364"></a>    <span class="c">! process inlet temp</span>
<a name="ln-4365"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">H_ProcInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4366"></a>      <span class="n">H_ProcInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4367"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempLast</span> <span class="o">=</span> <span class="n">H_ProcInTemp</span>
<a name="ln-4368"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_ProcInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4369"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4370"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4371"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_ProcInTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4372"></a><span class="k">        </span><span class="n">H_ProcInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInTemp</span>
<a name="ln-4373"></a>      <span class="k">END IF</span>
<a name="ln-4374"></a><span class="k">      IF</span><span class="p">(</span><span class="n">H_ProcInTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4375"></a><span class="k">        </span><span class="n">H_ProcInTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInTemp</span>
<a name="ln-4376"></a>      <span class="k">END IF</span>
<a name="ln-4377"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4378"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4379"></a><span class="c">!       Suppress warning message when process inlet temperature = 0 (DX coil is off)</span>
<a name="ln-4380"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempLast</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4381"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4382"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4383"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4384"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Process inlet air temperature &#39;</span> <span class="p">&amp;</span>
<a name="ln-4385"></a>          <span class="o">//</span> <span class="s1">&#39;used in regen outlet air humidity ratio equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4386"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4387"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4388"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4389"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_ProcInTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4390"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInTempBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air humidity ratio &#39;</span> <span class="p">&amp;</span>
<a name="ln-4391"></a>             <span class="o">//</span><span class="s1">&#39;equation: process inlet air temperature passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4392"></a>      <span class="k">ELSE</span>
<a name="ln-4393"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4394"></a>      <span class="k">END IF</span>
<a name="ln-4395"></a><span class="k">    ELSE</span>
<a name="ln-4396"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4397"></a>    <span class="k">END IF</span>
<a name="ln-4398"></a>    <span class="c">! process inlet humidity ratio</span>
<a name="ln-4399"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">H_ProcInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4400"></a>      <span class="n">H_ProcInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4401"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatLast</span> <span class="o">=</span> <span class="n">H_ProcInHumRat</span>
<a name="ln-4402"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_ProcInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4403"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4404"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4405"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_ProcInHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4406"></a><span class="k">        </span><span class="n">H_ProcInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInHumRat</span>
<a name="ln-4407"></a>      <span class="k">END IF</span>
<a name="ln-4408"></a><span class="k">      IF</span><span class="p">(</span><span class="n">H_ProcInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4409"></a><span class="k">        </span><span class="n">H_ProcInHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInHumRat</span>
<a name="ln-4410"></a>      <span class="k">END IF</span>
<a name="ln-4411"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4412"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4413"></a><span class="c">!       Suppress warning message when process inlet humrat = 0 (DX coil is off)</span>
<a name="ln-4414"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatLast</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4415"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4416"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4417"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4418"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Process inlet air humidity ratio &#39;</span> <span class="p">&amp;</span>
<a name="ln-4419"></a>          <span class="o">//</span> <span class="s1">&#39;used in regen outlet air humidity ratio equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4420"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4421"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4422"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4423"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_ProcInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4424"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_ProcInHumRatBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air humidity &#39;</span> <span class="p">&amp;</span>
<a name="ln-4425"></a>            <span class="o">//</span><span class="s1">&#39;ratio equation: process inlet air humidity ratio passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4426"></a>      <span class="k">ELSE</span>
<a name="ln-4427"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4428"></a>      <span class="k">END IF</span>
<a name="ln-4429"></a><span class="k">    ELSE</span>
<a name="ln-4430"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_ProcInHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4431"></a>    <span class="k">END IF</span>
<a name="ln-4432"></a>    <span class="c">! regeneration and process face velocity</span>
<a name="ln-4433"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">H_FaceVel</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinFaceVel</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4434"></a>      <span class="n">H_FaceVel</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4435"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelLast</span> <span class="o">=</span> <span class="n">H_FaceVel</span>
<a name="ln-4436"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_FaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4437"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4438"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4439"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_FaceVel</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4440"></a><span class="k">        </span><span class="n">H_FaceVel</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinFaceVel</span>
<a name="ln-4441"></a>      <span class="k">END IF</span>
<a name="ln-4442"></a><span class="k">      IF</span><span class="p">(</span><span class="n">H_FaceVel</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4443"></a><span class="k">        </span><span class="n">H_FaceVel</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxFaceVel</span>
<a name="ln-4444"></a>      <span class="k">END IF</span>
<a name="ln-4445"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4446"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4447"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4448"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4449"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Process and regen inlet air face &#39;</span> <span class="p">&amp;</span>
<a name="ln-4450"></a>          <span class="o">//</span> <span class="s1">&#39;velocity used in regen outlet air humidity ratio equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4451"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4452"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4453"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4454"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H_FaceVel</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4455"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_FaceVelBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration outlet air humidity ratio &#39;</span> <span class="p">&amp;</span>
<a name="ln-4456"></a>             <span class="o">//</span><span class="s1">&#39;equation: process and regeneration face velocity passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4457"></a>      <span class="k">ELSE</span>
<a name="ln-4458"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4459"></a>      <span class="k">END IF</span>
<a name="ln-4460"></a><span class="k">    ELSE</span>
<a name="ln-4461"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintH_FaceVelMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4462"></a>    <span class="k">END IF</span>
<a name="ln-4463"></a>
<a name="ln-4464"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBoundsHumRatEq</span>
<a name="ln-4465"></a>
<a name="ln-4466"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBoundOutput_Temp</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">RegenInTemp</span><span class="p">,</span> <span class="n">RegenOutTemp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4467"></a>
<a name="ln-4468"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4469"></a>          <span class="c">!       AUTHOR         Mangesh Basarkar, FSEC</span>
<a name="ln-4470"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-4471"></a>          <span class="c">!       MODIFIED       June 2007, R. Raustad, changed requirement that regen outlet temp be less than inlet temp</span>
<a name="ln-4472"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4473"></a>
<a name="ln-4474"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4475"></a>          <span class="c">!</span>
<a name="ln-4476"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables are within the limits used during the</span>
<a name="ln-4477"></a>          <span class="c">! developement of the empirical model.</span>
<a name="ln-4478"></a>
<a name="ln-4479"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4480"></a>          <span class="c">! The empirical models used for simulating a desiccant enhanced cooling coil are based on a limited data set.</span>
<a name="ln-4481"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-4482"></a>          <span class="c">! The range of each independent variable is provided by the user and are based on the limits of the</span>
<a name="ln-4483"></a>          <span class="c">! empirical model. These limits are tested in this subroutine each time step and returned for use by the calling</span>
<a name="ln-4484"></a>          <span class="c">! routine.</span>
<a name="ln-4485"></a>          <span class="c">!</span>
<a name="ln-4486"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4487"></a>          <span class="c">! na</span>
<a name="ln-4488"></a>
<a name="ln-4489"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4490"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4491"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-4492"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-4493"></a>
<a name="ln-4494"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4495"></a>
<a name="ln-4496"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4497"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ExchNum</span>            <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-4498"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RegenInTemp</span>        <span class="c">! current regen inlet temp passed to eqn</span>
<a name="ln-4499"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RegenOutTemp</span>       <span class="c">! current regen outlet temp from eqn</span>
<a name="ln-4500"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! First HVAC iteration flag</span>
<a name="ln-4501"></a>
<a name="ln-4502"></a>        <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4503"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-4504"></a>
<a name="ln-4505"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4506"></a>          <span class="c">! na</span>
<a name="ln-4507"></a>
<a name="ln-4508"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4509"></a>          <span class="c">! na</span>
<a name="ln-4510"></a>
<a name="ln-4511"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4512"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4513"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4514"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4515"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CharValue</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4516"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-4517"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-4518"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-4519"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-4520"></a>
<a name="ln-4521"></a>
<a name="ln-4522"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-4523"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4524"></a>
<a name="ln-4525"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-4526"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-4527"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-4528"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-4529"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4530"></a>
<a name="ln-4531"></a>      <span class="c">! print error when regeneration outlet temperature is greater than regen inlet temperature</span>
<a name="ln-4532"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempFailedMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4533"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4534"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4535"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4536"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedBuffer1</span><span class="p">))</span>
<a name="ln-4537"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedBuffer2</span><span class="p">))</span>
<a name="ln-4538"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Regeneration outlet air temperature should always be less than or equal &#39;</span> <span class="p">&amp;</span>
<a name="ln-4539"></a>                                  <span class="o">//</span><span class="s1">&#39;to regen inlet air temperature. Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-4540"></a>        <span class="k">ELSE</span>
<a name="ln-4541"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4542"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4543"></a>              <span class="s1">&#39;&quot; - Regeneration outlet air temperature above regen inlet air temperature error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4544"></a>              <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4545"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4546"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedLast</span><span class="p">)</span>
<a name="ln-4547"></a>        <span class="k">END IF</span>
<a name="ln-4548"></a><span class="k">      END IF</span>
<a name="ln-4549"></a>
<a name="ln-4550"></a>      <span class="c">! print error for variables of regeneration outlet temperature</span>
<a name="ln-4551"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4552"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4553"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4554"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4555"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempBuffer1</span><span class="p">))</span>
<a name="ln-4556"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempBuffer2</span><span class="p">))</span>
<a name="ln-4557"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempBuffer3</span><span class="p">))</span>
<a name="ln-4558"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Regeneration outlet air temperature should always be less than or equal &#39;</span> <span class="p">&amp;</span>
<a name="ln-4559"></a>                                  <span class="o">//</span><span class="s1">&#39;to regen inlet air temperature. Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-4560"></a>        <span class="k">ELSE</span>
<a name="ln-4561"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4562"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4563"></a>              <span class="s1">&#39;&quot; - Regeneration outlet air temperature should be less than regen inlet air temperature error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4564"></a>              <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4565"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4566"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempLast</span><span class="p">)</span>
<a name="ln-4567"></a>        <span class="k">END IF</span>
<a name="ln-4568"></a><span class="k">      END IF</span>
<a name="ln-4569"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-4570"></a>
<a name="ln-4571"></a><span class="c">!   save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-4572"></a>    <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-4573"></a>    <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-4574"></a>
<a name="ln-4575"></a>    <span class="c">! checking model regeneration outlet temperature to always be less than or equal to regeneration inlet temperature</span>
<a name="ln-4576"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RegenOutTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">RegenInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4577"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedLast</span> <span class="o">=</span> <span class="n">RegenOutTemp</span>
<a name="ln-4578"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4579"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4580"></a><span class="c">!      IF(RegenOutTemp .GT. RegenInTemp)THEN</span>
<a name="ln-4581"></a><span class="c">!        RegenOutTemp = RegenInTemp</span>
<a name="ln-4582"></a><span class="c">!      END IF</span>
<a name="ln-4583"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4584"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempFailedMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4585"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4586"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4587"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration outlet air &#39;</span> <span class="p">&amp;</span>
<a name="ln-4588"></a>          <span class="o">//</span> <span class="s1">&#39;temperature is greater than inlet temperature at &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4589"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedBuffer2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4590"></a>           <span class="s1">&#39;...Regen inlet air temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4591"></a>          <span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4592"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4593"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4594"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempFailedBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regen outlet air temperature &#39;</span> <span class="p">&amp;</span>
<a name="ln-4595"></a>             <span class="o">//</span><span class="s1">&#39;equation: regeneration outlet air temperature allowed from the model = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4596"></a>      <span class="k">ELSE</span>
<a name="ln-4597"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4598"></a>      <span class="k">END IF</span>
<a name="ln-4599"></a><span class="k">    ELSE</span>
<a name="ln-4600"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4601"></a>    <span class="k">END IF</span>
<a name="ln-4602"></a>
<a name="ln-4603"></a><span class="c">!   check boundaries of regen outlet temperature and post warnings to individual buffers to print at end of time step</span>
<a name="ln-4604"></a>    <span class="c">! checking model bounds for regeneration outlet temperature</span>
<a name="ln-4605"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RegenOutTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4606"></a>      <span class="n">RegenOutTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4607"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempLast</span> <span class="o">=</span> <span class="n">RegenOutTemp</span>
<a name="ln-4608"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4609"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4610"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4611"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">RegenOutTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4612"></a><span class="k">        </span><span class="n">RegenOutTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutTemp</span>
<a name="ln-4613"></a>      <span class="k">END IF</span>
<a name="ln-4614"></a><span class="k">      IF</span><span class="p">(</span><span class="n">RegenOutTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4615"></a><span class="k">        </span><span class="n">RegenOutTemp</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutTemp</span>
<a name="ln-4616"></a>      <span class="k">END IF</span>
<a name="ln-4617"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4618"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4619"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4620"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4621"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration outlet air &#39;</span> <span class="p">&amp;</span>
<a name="ln-4622"></a>          <span class="o">//</span> <span class="s1">&#39;temperature equation is outside model boundaries at &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4623"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4624"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4625"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4626"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutTemp</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4627"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutTempBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regen outlet air temperature equation: &#39;</span> <span class="p">&amp;</span>
<a name="ln-4628"></a>              <span class="o">//</span><span class="s1">&#39;regeneration outlet air temperature allowed from the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4629"></a>      <span class="k">ELSE</span>
<a name="ln-4630"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4631"></a>      <span class="k">END IF</span>
<a name="ln-4632"></a><span class="k">    ELSE</span>
<a name="ln-4633"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4634"></a>    <span class="k">END IF</span>
<a name="ln-4635"></a>
<a name="ln-4636"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBoundOutput_Temp</span>
<a name="ln-4637"></a>
<a name="ln-4638"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBoundOutput_HumRat</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">RegenInHumRat</span><span class="p">,</span> <span class="n">RegenOutHumRat</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4639"></a>
<a name="ln-4640"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4641"></a>          <span class="c">!       AUTHOR         Mangesh Basarkar, FSEC</span>
<a name="ln-4642"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-4643"></a>          <span class="c">!       MODIFIED       June 2007, R. Raustad, changed requirement that regen outlet temp be less than inlet temp</span>
<a name="ln-4644"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4645"></a>
<a name="ln-4646"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4647"></a>          <span class="c">!</span>
<a name="ln-4648"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables are within the limits used during the</span>
<a name="ln-4649"></a>          <span class="c">! developement of the empirical model.</span>
<a name="ln-4650"></a>
<a name="ln-4651"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4652"></a>          <span class="c">! The empirical models used for simulating a desiccant enhanced cooling coil are based on a limited data set.</span>
<a name="ln-4653"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-4654"></a>          <span class="c">! The range of each independent variable is provided by the user and are based on the limits of the</span>
<a name="ln-4655"></a>          <span class="c">! empirical model. These limits are tested in this subroutine each time step and returned for use by the calling</span>
<a name="ln-4656"></a>          <span class="c">! routine.</span>
<a name="ln-4657"></a>          <span class="c">!</span>
<a name="ln-4658"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4659"></a>          <span class="c">! na</span>
<a name="ln-4660"></a>
<a name="ln-4661"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4662"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4663"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-4664"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-4665"></a>
<a name="ln-4666"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4667"></a>
<a name="ln-4668"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS</span>
<a name="ln-4669"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExchNum</span>            <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-4670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RegenInHumRat</span>      <span class="c">! current regen inlet hum rat passed to eqn</span>
<a name="ln-4671"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RegenOutHumRat</span>     <span class="c">! current regen outlet hum rat from eqn</span>
<a name="ln-4672"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! First HVAC iteration flag</span>
<a name="ln-4673"></a>
<a name="ln-4674"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4675"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-4676"></a>
<a name="ln-4677"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4678"></a>          <span class="c">! na</span>
<a name="ln-4679"></a>
<a name="ln-4680"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4681"></a>          <span class="c">! na</span>
<a name="ln-4682"></a>
<a name="ln-4683"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4684"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4685"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4686"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4687"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CharValue</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4688"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-4689"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-4690"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-4691"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-4692"></a>
<a name="ln-4693"></a>
<a name="ln-4694"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-4695"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4696"></a>
<a name="ln-4697"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-4698"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-4699"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-4700"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-4701"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4702"></a>
<a name="ln-4703"></a>     <span class="c">! print error when regeneration outlet humidity ratio is less than regeneration inlet humidity ratio</span>
<a name="ln-4704"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatFailedMess</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4705"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4706"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4707"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4708"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedBuffer1</span><span class="p">))</span>
<a name="ln-4709"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedBuffer2</span><span class="p">))</span>
<a name="ln-4710"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Regeneration outlet air humidity ratio should always be greater than or equal &#39;</span> <span class="p">&amp;</span>
<a name="ln-4711"></a>                                  <span class="o">//</span><span class="s1">&#39;to regen inlet air humidity ratio. Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-4712"></a>        <span class="k">ELSE</span>
<a name="ln-4713"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4714"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4715"></a>            <span class="s1">&#39;&quot; - Regeneration outlet air humidity ratio should be greater than regen inlet air humidity ratio error continues...&#39;</span><span class="p">,&amp;</span>
<a name="ln-4716"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4717"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4718"></a>            <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedLast</span><span class="p">)</span>
<a name="ln-4719"></a>        <span class="k">END IF</span>
<a name="ln-4720"></a><span class="k">      END IF</span>
<a name="ln-4721"></a>
<a name="ln-4722"></a>     <span class="c">! print error for regeneration outlet humidity ratio</span>
<a name="ln-4723"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4724"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4725"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4726"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4727"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatBuffer1</span><span class="p">))</span>
<a name="ln-4728"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatBuffer2</span><span class="p">))</span>
<a name="ln-4729"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatBuffer3</span><span class="p">))</span>
<a name="ln-4730"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Regeneration outlet air humidity ratio outside model boundaries may &#39;</span> <span class="p">&amp;</span>
<a name="ln-4731"></a>                                  <span class="o">//</span><span class="s1">&#39;adversely affect desiccant model performance.&#39;</span><span class="p">)</span>
<a name="ln-4732"></a>        <span class="k">ELSE</span>
<a name="ln-4733"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4734"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4735"></a>              <span class="s1">&#39;&quot; - Regeneration outlet air humidity ratio is out of range error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4736"></a>              <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4737"></a>                                      <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4738"></a>                                       <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatLast</span><span class="p">)</span>
<a name="ln-4739"></a>        <span class="k">END IF</span>
<a name="ln-4740"></a><span class="k">      END IF</span>
<a name="ln-4741"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-4742"></a>
<a name="ln-4743"></a><span class="c">!   save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-4744"></a>    <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-4745"></a>    <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-4746"></a>
<a name="ln-4747"></a>    <span class="c">! checking for regeneration outlet humidity ratio less than or equal to regeneration inlet humidity ratio</span>
<a name="ln-4748"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RegenOutHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">RegenInHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4749"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedLast</span> <span class="o">=</span> <span class="n">RegenOutHumRat</span>
<a name="ln-4750"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4751"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4752"></a><span class="c">!      IF(RegenOutHumRat .LT. RegenInHumRat)THEN</span>
<a name="ln-4753"></a><span class="c">!        RegenOutHumRat = RegenInHumRat</span>
<a name="ln-4754"></a><span class="c">!      END IF</span>
<a name="ln-4755"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4756"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatFailedMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4757"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4758"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4759"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration outlet air &#39;</span> <span class="p">&amp;</span>
<a name="ln-4760"></a>         <span class="o">//</span> <span class="s1">&#39;humidity ratio is less than the inlet air humidity ratio at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4761"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Regen inlet air humidity &#39;</span> <span class="p">&amp;</span>
<a name="ln-4762"></a>         <span class="o">//</span><span class="s1">&#39;ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4763"></a>         <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4764"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4765"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatFailedBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regen outlet air humidity &#39;</span> <span class="p">&amp;</span>
<a name="ln-4766"></a>             <span class="o">//</span><span class="s1">&#39;ratio equation: regeneration outlet air humidity ratio allowed from the model = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4767"></a>      <span class="k">ELSE</span>
<a name="ln-4768"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatFailedMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4769"></a>      <span class="k">END IF</span>
<a name="ln-4770"></a><span class="k">    ELSE</span>
<a name="ln-4771"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatFailedMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4772"></a>    <span class="k">END IF</span>
<a name="ln-4773"></a>
<a name="ln-4774"></a><span class="c">!   check boundaries of regen outlet humrat and post warnings to individual buffers to print at end of time step</span>
<a name="ln-4775"></a>    <span class="c">! checking model bounds for regeneration outlet humidity ratio</span>
<a name="ln-4776"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">RegenOutHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4777"></a>      <span class="n">RegenOutHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4778"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatLast</span> <span class="o">=</span> <span class="n">RegenOutHumRat</span>
<a name="ln-4779"></a>      <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4780"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4781"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4782"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">RegenOutHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4783"></a><span class="k">        </span><span class="n">RegenOutHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MinRegenAirOutHumRat</span>
<a name="ln-4784"></a>      <span class="k">END IF</span>
<a name="ln-4785"></a><span class="k">      IF</span><span class="p">(</span><span class="n">RegenOutHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4786"></a><span class="k">        </span><span class="n">RegenOutHumRat</span> <span class="o">=</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">MaxRegenAirOutHumRat</span>
<a name="ln-4787"></a>      <span class="k">END IF</span>
<a name="ln-4788"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4789"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4790"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4791"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4792"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration outlet air &#39;</span> <span class="p">&amp;</span>
<a name="ln-4793"></a>         <span class="o">//</span> <span class="s1">&#39;humidity ratio is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4794"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Valid range = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4795"></a>         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-4796"></a>         <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4797"></a>        <span class="n">CharValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4798"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenOutHumRatBuffer3</span> <span class="o">=</span> <span class="s1">&#39;...Regen outlet air humidity &#39;</span> <span class="p">&amp;</span>
<a name="ln-4799"></a>             <span class="o">//</span><span class="s1">&#39;ratio equation: regeneration outlet air humidity ratio allowed from the model = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharValue</span><span class="p">)</span>
<a name="ln-4800"></a>      <span class="k">ELSE</span>
<a name="ln-4801"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4802"></a>      <span class="k">END IF</span>
<a name="ln-4803"></a><span class="k">    ELSE</span>
<a name="ln-4804"></a><span class="k">      </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenOutHumRatMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4805"></a>    <span class="k">END IF</span>
<a name="ln-4806"></a>
<a name="ln-4807"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBoundOutput_HumRat</span>
<a name="ln-4808"></a>
<a name="ln-4809"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBoundsRH_TempEq</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">T_RegenInTemp</span><span class="p">,</span> <span class="n">T_RegenInHumRat</span><span class="p">,</span> <span class="n">T_ProcInTemp</span><span class="p">,</span> <span class="n">T_ProcInHumRat</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4810"></a>
<a name="ln-4811"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4812"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-4813"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-4814"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4815"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4816"></a>
<a name="ln-4817"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4818"></a>          <span class="c">!</span>
<a name="ln-4819"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables result in a relative humidity that is within the range</span>
<a name="ln-4820"></a>          <span class="c">! of relative humidities used when creating the empirical model. Both the regeneration and process inlet are tested.</span>
<a name="ln-4821"></a>
<a name="ln-4822"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4823"></a>          <span class="c">! The empirical models used for simulating a desiccant enhanced cooling coil are based on a limited data set.</span>
<a name="ln-4824"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-4825"></a>          <span class="c">! In addition, the range of relative humidities in the original data set may influence the output of the</span>
<a name="ln-4826"></a>          <span class="c">! empirical model. This subroutine tests the relative humidities passed to the empirical model and warns the</span>
<a name="ln-4827"></a>          <span class="c">! user if these relative humidities are out of bounds based on the limits set by the user.</span>
<a name="ln-4828"></a>          <span class="c">!</span>
<a name="ln-4829"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4830"></a>          <span class="c">! na</span>
<a name="ln-4831"></a>
<a name="ln-4832"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4833"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4834"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-4835"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-4836"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhFnTdbWPb</span>
<a name="ln-4837"></a>
<a name="ln-4838"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4839"></a>
<a name="ln-4840"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS</span>
<a name="ln-4841"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExchNum</span>            <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-4842"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_RegenInTemp</span>      <span class="c">! current regen inlet temperature passed to eqn</span>
<a name="ln-4843"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_RegenInHumRat</span>    <span class="c">! current regen inlet hum rat passed to eqn</span>
<a name="ln-4844"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_ProcInTemp</span>       <span class="c">! current process inlet temperature passed to eqn</span>
<a name="ln-4845"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T_ProcInHumRat</span>     <span class="c">! current regen outlet hum rat from eqn</span>
<a name="ln-4846"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! first HVAC iteration flag</span>
<a name="ln-4847"></a>
<a name="ln-4848"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4849"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-4850"></a>
<a name="ln-4851"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4852"></a>          <span class="c">! na</span>
<a name="ln-4853"></a>
<a name="ln-4854"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4855"></a>          <span class="c">! na</span>
<a name="ln-4856"></a>
<a name="ln-4857"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4858"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">RegenInletRH</span>       <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Regeneration inlet air relative humidity</span>
<a name="ln-4859"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ProcInletRH</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Process inlet air relative humidity</span>
<a name="ln-4860"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4861"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4862"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-4863"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-4864"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-4865"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-4866"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-4867"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-4868"></a>
<a name="ln-4869"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-4870"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4871"></a>
<a name="ln-4872"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-4873"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-4874"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-4875"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-4876"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4877"></a>
<a name="ln-4878"></a>      <span class="c">! print error when regeneration inlet relative humidity is outside model boundaries</span>
<a name="ln-4879"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumTempMess</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4880"></a><span class="k">         </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4881"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4882"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4883"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempBuffer1</span><span class="p">))</span>
<a name="ln-4884"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempBuffer2</span><span class="p">))</span>
<a name="ln-4885"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempBuffer3</span><span class="p">))</span>
<a name="ln-4886"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using regeneration inlet air relative humidities that are outside the regeneration &#39;</span><span class="p">&amp;</span>
<a name="ln-4887"></a>                 <span class="o">//</span><span class="s1">&#39;outlet temperature equation model boundaries may adversely affect desiccant model performance. &#39;</span><span class="p">&amp;</span>
<a name="ln-4888"></a>                 <span class="o">//</span><span class="s1">&#39;Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-4889"></a>        <span class="k">ELSE</span>
<a name="ln-4890"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4891"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4892"></a>                 <span class="s1">&#39;&quot; - Regeneration inlet air relative humidity related to regen outlet air temperature equation is outside &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4893"></a>                 <span class="s1">&#39;model boundaries error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4894"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4895"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4896"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempLast</span><span class="p">)</span>
<a name="ln-4897"></a>        <span class="k">END IF</span>
<a name="ln-4898"></a><span class="k">      END IF</span>
<a name="ln-4899"></a>
<a name="ln-4900"></a>      <span class="c">! print error when process inlet relative humidity is outside model boundaries</span>
<a name="ln-4901"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumTempMess</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4902"></a><span class="k">         </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4903"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4904"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4905"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempBuffer1</span><span class="p">))</span>
<a name="ln-4906"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempBuffer2</span><span class="p">))</span>
<a name="ln-4907"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempBuffer3</span><span class="p">))</span>
<a name="ln-4908"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process inlet air relative humidities that are outside the regeneration &#39;</span><span class="p">&amp;</span>
<a name="ln-4909"></a>                 <span class="o">//</span><span class="s1">&#39;outlet temperature equation model boundaries may adversely affect desiccant model performance. &#39;</span><span class="p">&amp;</span>
<a name="ln-4910"></a>                 <span class="o">//</span><span class="s1">&#39;Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-4911"></a>        <span class="k">ELSE</span>
<a name="ln-4912"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4913"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4914"></a>                 <span class="s1">&#39;&quot; - Process inlet air relative humidity related to regen outlet air temperature equation is outside &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4915"></a>                 <span class="s1">&#39;model boundaries error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4916"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4917"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4918"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempLast</span><span class="p">)</span>
<a name="ln-4919"></a>        <span class="k">END IF</span>
<a name="ln-4920"></a><span class="k">      END IF</span>
<a name="ln-4921"></a>
<a name="ln-4922"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-4923"></a>
<a name="ln-4924"></a><span class="c">!     save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-4925"></a>      <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-4926"></a>      <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-4927"></a>
<a name="ln-4928"></a><span class="c">!     Check that condition is not above saturation curve prior to next calc (PsyRhFnTdbWPb) to avoid psyc routine errors</span>
<a name="ln-4929"></a><span class="c">!</span>
<a name="ln-4930"></a><span class="c">!                           *</span>
<a name="ln-4931"></a><span class="c">!                          *</span>
<a name="ln-4932"></a><span class="c">!                  x------*---------- T_HumRat</span>
<a name="ln-4933"></a><span class="c">!                  |    *</span>
<a name="ln-4934"></a><span class="c">!                  |  *</span>
<a name="ln-4935"></a><span class="c">!                  *----------------- PsyWFnTdpPb(Tdp,Pb)</span>
<a name="ln-4936"></a><span class="c">!               *  |</span>
<a name="ln-4937"></a><span class="c">!                  |</span>
<a name="ln-4938"></a><span class="c">!</span>
<a name="ln-4939"></a><span class="c">!                T_Temp</span>
<a name="ln-4940"></a><span class="c">!</span>
<a name="ln-4941"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">T_RegenInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">T_RegenInTemp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4942"></a>         <span class="n">T_ProcInHumRat</span>  <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">T_ProcInTemp</span> <span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4943"></a><span class="c">!       reset RH print flags just in case</span>
<a name="ln-4944"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4945"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumTempMess</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4946"></a>        <span class="k">RETURN</span>
<a name="ln-4947"></a><span class="k">      END IF</span>
<a name="ln-4948"></a>
<a name="ln-4949"></a><span class="c">!     If regen and procees inlet temperatures are the same the coil is off, do not print out of bounds warning for this case</span>
<a name="ln-4950"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">T_RegenInTemp</span><span class="o">-</span><span class="n">T_ProcInTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Small</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4951"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4952"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4953"></a>        <span class="k">RETURN</span>
<a name="ln-4954"></a><span class="k">      END IF</span>
<a name="ln-4955"></a>
<a name="ln-4956"></a><span class="k">      </span><span class="n">RegenInletRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">T_RegenInTemp</span><span class="p">,</span> <span class="n">T_RegenInHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-4957"></a>      <span class="n">ProcInletRH</span>  <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">T_ProcInTemp</span><span class="p">,</span>  <span class="n">T_ProcInHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-4958"></a>
<a name="ln-4959"></a>      <span class="c">! checking if regeneration inlet relative humidity is within model boundaries</span>
<a name="ln-4960"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">RegenInletRH</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4961"></a>        <span class="n">RegenInletRH</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4962"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempLast</span> <span class="o">=</span> <span class="n">RegenInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-4963"></a>        <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4964"></a>        <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4965"></a>        <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4966"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4967"></a>
<a name="ln-4968"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4969"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4970"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration inlet air relative &#39;</span> <span class="p">&amp;</span>
<a name="ln-4971"></a>           <span class="o">//</span><span class="s1">&#39;humidity related to regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4972"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempBuffer2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4973"></a>           <span class="s1">&#39;...Model limit on regeneration inlet air relative humidity is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4974"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumTempBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4975"></a>           <span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4976"></a>      <span class="k">ELSE</span>
<a name="ln-4977"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4978"></a>      <span class="k">END IF</span>
<a name="ln-4979"></a>
<a name="ln-4980"></a>      <span class="c">! checking if process inlet relative humidity is within model boundaries</span>
<a name="ln-4981"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ProcInletRH</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4982"></a>        <span class="n">ProcInletRH</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4983"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempLast</span> <span class="o">=</span> <span class="n">ProcInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-4984"></a>        <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ProcInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4985"></a>        <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MinProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4986"></a>        <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">T_MaxProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4987"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4988"></a>
<a name="ln-4989"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4990"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4991"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Process inlet air relative &#39;</span> <span class="p">&amp;</span>
<a name="ln-4992"></a>           <span class="o">//</span><span class="s1">&#39;humidity related to regen outlet air temperature equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4993"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempBuffer2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4994"></a>           <span class="s1">&#39;...Model limit on process inlet air relative humidity is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-4995"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumTempBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4996"></a>           <span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-4997"></a>      <span class="k">ELSE</span>
<a name="ln-4998"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumTempMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4999"></a>      <span class="k">END IF</span>
<a name="ln-5000"></a>
<a name="ln-5001"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBoundsRH_TempEq</span>
<a name="ln-5002"></a>
<a name="ln-5003"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBoundsRH_HumRatEq</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">H_RegenInTemp</span><span class="p">,</span> <span class="n">H_RegenInHumRat</span><span class="p">,</span> <span class="n">H_ProcInTemp</span><span class="p">,</span> <span class="n">H_ProcInHumRat</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-5004"></a>
<a name="ln-5005"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5006"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5007"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-5008"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5009"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5012"></a>          <span class="c">!</span>
<a name="ln-5013"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables result in a relative humidity that is within the range</span>
<a name="ln-5014"></a>          <span class="c">! of relative humidities used when creating the empirical model. Both the regeneration and process inlet are tested.</span>
<a name="ln-5015"></a>
<a name="ln-5016"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5017"></a>          <span class="c">! The empirical models used for simulating a desiccant enhanced cooling coil are based on a limited data set.</span>
<a name="ln-5018"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-5019"></a>          <span class="c">! In addition, the range of relative humidities in the original data set may influence the output of the</span>
<a name="ln-5020"></a>          <span class="c">! empirical model. This subroutine tests the relative humidities passed to the empirical model and warns the</span>
<a name="ln-5021"></a>          <span class="c">! user if these relative humidities are out of bounds based on the limits set by the user.</span>
<a name="ln-5022"></a>          <span class="c">!</span>
<a name="ln-5023"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5024"></a>          <span class="c">! na</span>
<a name="ln-5025"></a>
<a name="ln-5026"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5027"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-5028"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-5029"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-5030"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhFnTdbWPb</span>
<a name="ln-5031"></a>
<a name="ln-5032"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5033"></a>
<a name="ln-5034"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS</span>
<a name="ln-5035"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExchNum</span>            <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-5036"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_RegenInTemp</span>      <span class="c">! current regen inlet temperature passed to eqn</span>
<a name="ln-5037"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_RegenInHumRat</span>    <span class="c">! current regen inlet hum rat passed to eqn</span>
<a name="ln-5038"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_ProcInTemp</span>       <span class="c">! current process inlet temperature passed to eqn</span>
<a name="ln-5039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H_ProcInHumRat</span>     <span class="c">! current process inlet hum rat passed to eqn</span>
<a name="ln-5040"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! first HVAC iteration flag</span>
<a name="ln-5041"></a>
<a name="ln-5042"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5043"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5046"></a>          <span class="c">! na</span>
<a name="ln-5047"></a>
<a name="ln-5048"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5049"></a>          <span class="c">! na</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5052"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">RegenInletRH</span>       <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Regeneration inlet air relative humidity</span>
<a name="ln-5053"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ProcInletRH</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Process inlet air relative humidity</span>
<a name="ln-5054"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5055"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5056"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5057"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-5058"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-5059"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-5060"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-5061"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-5062"></a>
<a name="ln-5063"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-5064"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-5065"></a>
<a name="ln-5066"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-5067"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-5068"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-5069"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-5070"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5071"></a>
<a name="ln-5072"></a>      <span class="c">! print error when regeneration inlet relative humidity is outside model boundaries</span>
<a name="ln-5073"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumHumRatMess</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5074"></a><span class="k">         </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5075"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5076"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5077"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatBuffer1</span><span class="p">))</span>
<a name="ln-5078"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatBuffer2</span><span class="p">))</span>
<a name="ln-5079"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatBuffer3</span><span class="p">))</span>
<a name="ln-5080"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using regeneration inlet air relative humidities that are outside the regeneration &#39;</span><span class="p">&amp;</span>
<a name="ln-5081"></a>                 <span class="o">//</span><span class="s1">&#39;outlet humidity ratio equation model boundaries may adversely affect desiccant model performance. &#39;</span><span class="p">&amp;</span>
<a name="ln-5082"></a>                 <span class="o">//</span><span class="s1">&#39;Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-5083"></a>        <span class="k">ELSE</span>
<a name="ln-5084"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5085"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5086"></a>                 <span class="s1">&#39;&quot; - Regeneration inlet air relative humidity related to regen outlet air humidity ratio equation is &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5087"></a>                 <span class="s1">&#39;outside model boundaries error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5088"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5089"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5090"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatLast</span><span class="p">)</span>
<a name="ln-5091"></a>        <span class="k">END IF</span>
<a name="ln-5092"></a><span class="k">      END IF</span>
<a name="ln-5093"></a>
<a name="ln-5094"></a>      <span class="c">! print error when process inlet relative humidity is outside model boundaries</span>
<a name="ln-5095"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumHumRatMess</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5096"></a><span class="k">         </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5097"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5098"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5099"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatBuffer1</span><span class="p">))</span>
<a name="ln-5100"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatBuffer2</span><span class="p">))</span>
<a name="ln-5101"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatBuffer3</span><span class="p">))</span>
<a name="ln-5102"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Using process inlet air relative humidities that are outside the regeneration &#39;</span><span class="p">&amp;</span>
<a name="ln-5103"></a>                 <span class="o">//</span><span class="s1">&#39;outlet humidity ratio equation model boundaries may adversely affect desiccant model performance. &#39;</span><span class="p">&amp;</span>
<a name="ln-5104"></a>                 <span class="o">//</span><span class="s1">&#39;Verify correct model coefficients.&#39;</span><span class="p">)</span>
<a name="ln-5105"></a>        <span class="k">ELSE</span>
<a name="ln-5106"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5107"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5108"></a>                 <span class="s1">&#39;&quot; - Process inlet air relative humidity related to regen outlet air humidity ratio equation is outside &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5109"></a>                 <span class="s1">&#39;model boundaries error continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5110"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5111"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5112"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatLast</span><span class="p">)</span>
<a name="ln-5113"></a>        <span class="k">END IF</span>
<a name="ln-5114"></a><span class="k">      END IF</span>
<a name="ln-5115"></a>
<a name="ln-5116"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a><span class="c">!     save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-5119"></a>      <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-5120"></a>      <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-5121"></a>
<a name="ln-5122"></a><span class="c">!     Check that condition is not above saturation curve prior to next calc (PsyRhFnTdbWPb) to avoid psyc routine errors</span>
<a name="ln-5123"></a><span class="c">!</span>
<a name="ln-5124"></a><span class="c">!                           *</span>
<a name="ln-5125"></a><span class="c">!                          *</span>
<a name="ln-5126"></a><span class="c">!                  x------*---------- H_HumRat</span>
<a name="ln-5127"></a><span class="c">!                  |    *</span>
<a name="ln-5128"></a><span class="c">!                  |  *</span>
<a name="ln-5129"></a><span class="c">!                  *----------------- PsyWFnTdpPb(Tdp,Pb)</span>
<a name="ln-5130"></a><span class="c">!               *  |</span>
<a name="ln-5131"></a><span class="c">!                  |</span>
<a name="ln-5132"></a><span class="c">!</span>
<a name="ln-5133"></a><span class="c">!                H_Temp</span>
<a name="ln-5134"></a><span class="c">!</span>
<a name="ln-5135"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">H_RegenInHumRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">H_RegenInTemp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5136"></a>         <span class="n">H_ProcInHumRat</span>  <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">H_ProcInTemp</span> <span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5137"></a><span class="c">!       reset RH print flags just in case</span>
<a name="ln-5138"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5139"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumHumRatMess</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5140"></a>        <span class="k">RETURN</span>
<a name="ln-5141"></a><span class="k">      END IF</span>
<a name="ln-5142"></a>
<a name="ln-5143"></a><span class="c">!     If regen and procees inlet temperatures are the same the coil is off, do not print out of bounds warning for this case</span>
<a name="ln-5144"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">H_RegenInTemp</span><span class="o">-</span><span class="n">H_ProcInTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Small</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5145"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5146"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5147"></a>        <span class="k">RETURN</span>
<a name="ln-5148"></a><span class="k">      END IF</span>
<a name="ln-5149"></a>
<a name="ln-5150"></a><span class="k">      </span><span class="n">RegenInletRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">H_RegenInTemp</span><span class="p">,</span> <span class="n">H_RegenInHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-5151"></a>      <span class="n">ProcInletRH</span>  <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">H_ProcInTemp</span><span class="p">,</span>  <span class="n">H_ProcInHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-5152"></a>
<a name="ln-5153"></a>      <span class="c">! checking if regeneration inlet relative humidity is within model boundaries</span>
<a name="ln-5154"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">RegenInletRH</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5155"></a>        <span class="n">RegenInletRH</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5156"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatLast</span> <span class="o">=</span> <span class="n">RegenInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-5157"></a>        <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5158"></a>        <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5159"></a>        <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxRegenAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5160"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5161"></a>
<a name="ln-5162"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5163"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5164"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Regeneration inlet air relative &#39;</span> <span class="p">&amp;</span>
<a name="ln-5165"></a>           <span class="o">//</span><span class="s1">&#39;humidity related to regen outlet air humidity ratio equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5166"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatBuffer2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5167"></a>           <span class="s1">&#39;...Model limit on regeneration inlet air relative humidity is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5168"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">RegenInRelHumHumRatBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5169"></a>           <span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5170"></a>      <span class="k">ELSE</span>
<a name="ln-5171"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintRegenInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5172"></a>      <span class="k">END IF</span>
<a name="ln-5173"></a>
<a name="ln-5174"></a>      <span class="c">! checking if process inlet relative humidity is within model boundaries</span>
<a name="ln-5175"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ProcInletRH</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5176"></a>        <span class="n">ProcInletRH</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5177"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatLast</span> <span class="o">=</span> <span class="n">ProcInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-5178"></a>        <span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ProcInletRH</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5179"></a>        <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MinProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5180"></a>        <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">H_MaxProcAirInRelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5181"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5182"></a>
<a name="ln-5183"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5184"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PerfType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5185"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - Process inlet air relative &#39;</span> <span class="p">&amp;</span>
<a name="ln-5186"></a>           <span class="o">//</span><span class="s1">&#39;humidity related to regen outlet air humidity ratio equation is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5187"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatBuffer2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5188"></a>           <span class="s1">&#39;...Model limit on process inlet air relative humidity is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5189"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ProcInRelHumHumRatBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5190"></a>           <span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5191"></a>      <span class="k">ELSE</span>
<a name="ln-5192"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintProcInRelHumHumRatMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5193"></a>      <span class="k">END IF</span>
<a name="ln-5194"></a>
<a name="ln-5195"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBoundsRH_HumRatEq</span>
<a name="ln-5196"></a>
<a name="ln-5197"></a><span class="k">SUBROUTINE </span><span class="n">CheckForBalancedFlow</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">,</span> <span class="n">ProcessInMassFlow</span><span class="p">,</span> <span class="n">RegenInMassFlow</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-5198"></a>
<a name="ln-5199"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5200"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5201"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-5202"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5203"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5204"></a>
<a name="ln-5205"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5206"></a>          <span class="c">!</span>
<a name="ln-5207"></a>          <span class="c">! To verify that the balanced flow desiccant heat exchanger has the same regeneration and process air flow rates.</span>
<a name="ln-5208"></a>
<a name="ln-5209"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5210"></a>          <span class="c">! Check that the regeneration and process air mass flow rates are within 2%.</span>
<a name="ln-5211"></a>          <span class="c">!</span>
<a name="ln-5212"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5213"></a>          <span class="c">! na</span>
<a name="ln-5214"></a>
<a name="ln-5215"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5216"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-5217"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-5218"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-5219"></a>
<a name="ln-5220"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5221"></a>
<a name="ln-5222"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS</span>
<a name="ln-5223"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExchNum</span>            <span class="c">! number of the current heat exchanger being simulated</span>
<a name="ln-5224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ProcessInMassFlow</span>  <span class="c">! current process inlet air mass flow rate (m3/s)</span>
<a name="ln-5225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RegenInMassFlow</span>    <span class="c">! current regeneration inlet air mass flow rate (m3/s)</span>
<a name="ln-5226"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! first HVAC iteration flag</span>
<a name="ln-5227"></a>
<a name="ln-5228"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5229"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F10.6)&#39;</span>
<a name="ln-5230"></a>
<a name="ln-5231"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5232"></a>          <span class="c">! na</span>
<a name="ln-5233"></a>
<a name="ln-5234"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5235"></a>          <span class="c">! na</span>
<a name="ln-5236"></a>
<a name="ln-5237"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5238"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharProc</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5239"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutputCharRegen</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5240"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-5241"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-5242"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-5243"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-5244"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ABSImbalancedFlow</span>            <span class="c">! absolute value of process and regeneration air flow imbalance fraction</span>
<a name="ln-5245"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-5246"></a>
<a name="ln-5247"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-5248"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-5249"></a>
<a name="ln-5250"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-5251"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-5252"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-5253"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-5254"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5255"></a>
<a name="ln-5256"></a>      <span class="c">! print error when regeneration inlet relative humidity is outside model boundaries</span>
<a name="ln-5257"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintImbalancedMassFlowMess</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5258"></a><span class="k">         </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowErrorCount</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5259"></a>                        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5260"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5261"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowBuffer1</span><span class="p">))</span>
<a name="ln-5262"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowBuffer2</span><span class="p">))</span>
<a name="ln-5263"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowBuffer3</span><span class="p">))</span>
<a name="ln-5264"></a><span class="c">!           CALL ShowContinueError(&#39;...Using regeneration inlet air relative humidities that are outside the regeneration &#39;&amp;</span>
<a name="ln-5265"></a><span class="c">!                 //&#39;outlet humidity ratio equation model boundaries may adversely affect desiccant model performance. &#39;&amp;</span>
<a name="ln-5266"></a><span class="c">!                 //&#39;Verify correct model coefficients.&#39;)</span>
<a name="ln-5267"></a>        <span class="k">ELSE</span>
<a name="ln-5268"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5269"></a>          <span class="s1">&#39;&quot; - unbalanced air flow rate is limited to 2% error continues with the imbalanced fraction statistics reported...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5270"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedFlowErrIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5271"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ABSImbalancedFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5272"></a>                 <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ABSImbalancedFlow</span><span class="p">)</span>
<a name="ln-5273"></a>        <span class="k">END IF</span>
<a name="ln-5274"></a><span class="k">      END IF</span>
<a name="ln-5275"></a>
<a name="ln-5276"></a><span class="k">    END IF</span> <span class="c">! IF(CurrentEndTime .GT. CurrentEndTimeLast .AND. TimeStepSys .GE. TimeStepSysLast)THEN</span>
<a name="ln-5277"></a>
<a name="ln-5278"></a><span class="c">!     save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-5279"></a>      <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-5280"></a>      <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-5281"></a>
<a name="ln-5282"></a>      <span class="c">! checking if regeneration inlet relative humidity is within model boundaries</span>
<a name="ln-5283"></a>      <span class="n">ABSImbalancedFlow</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">RegenInMassFlow</span> <span class="o">-</span> <span class="n">ProcessInMassFlow</span><span class="p">)</span><span class="o">/</span><span class="n">RegenInMassFlow</span>
<a name="ln-5284"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ABSImbalancedFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.02d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5285"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ABSImbalancedFlow</span>   <span class="o">=</span> <span class="n">ABSImbalancedFlow</span>
<a name="ln-5286"></a>        <span class="n">OutputCharRegen</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RegenInMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-5287"></a>        <span class="n">OutputCharProc</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ProcessInMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-5288"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintImbalancedMassFlowMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5289"></a>
<a name="ln-5290"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowBuffer1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5291"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cHXTypes</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">ExchTypeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5292"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot; - unbalanced air flow rate is limited to 2%.&#39;</span>
<a name="ln-5293"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowBuffer2</span> <span class="o">=</span> <span class="s1">&#39;...Regeneration air &#39;</span> <span class="p">&amp;</span>
<a name="ln-5294"></a>           <span class="o">//</span><span class="s1">&#39;mass flow rate is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharRegen</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and process air mass flow rate is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharProc</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5295"></a>        <span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">ImbalancedMassFlowBuffer3</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5296"></a>           <span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5297"></a>      <span class="k">ELSE</span>
<a name="ln-5298"></a><span class="k">        </span><span class="n">BalDesDehumPerfData</span><span class="p">(</span><span class="n">ExchCond</span><span class="p">(</span><span class="n">ExchNum</span><span class="p">)%</span><span class="n">PerfDataIndex</span><span class="p">)%</span><span class="n">PrintImbalancedMassFlowMess</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5299"></a>      <span class="k">END IF</span>
<a name="ln-5300"></a>
<a name="ln-5301"></a><span class="k">END SUBROUTINE </span><span class="n">CheckForBalancedFlow</span>
<a name="ln-5302"></a>
<a name="ln-5303"></a><span class="k">FUNCTION </span><span class="n">GetSupplyInletNode</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5304"></a>
<a name="ln-5305"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5306"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5307"></a>          <span class="c">!       DATE WRITTEN   February 2007</span>
<a name="ln-5308"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5309"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5310"></a>
<a name="ln-5311"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5312"></a>          <span class="c">! This function looks up the given HX and returns the supply air inlet node number.</span>
<a name="ln-5313"></a>          <span class="c">! If incorrect HX name is given, errorsfound is returned as true and node number as zero.</span>
<a name="ln-5314"></a>
<a name="ln-5315"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5316"></a>          <span class="c">! na</span>
<a name="ln-5317"></a>
<a name="ln-5318"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5319"></a>          <span class="c">! na</span>
<a name="ln-5320"></a>
<a name="ln-5321"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5322"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5323"></a>
<a name="ln-5324"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5325"></a>
<a name="ln-5326"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5327"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>             <span class="c">! must match HX names for the ExchCond type</span>
<a name="ln-5328"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">ErrorsFound</span>        <span class="c">! set to true if problem</span>
<a name="ln-5329"></a>  <span class="kt">INTEGER</span>                                  <span class="kd">::</span> <span class="n">GetSupplyInletNode</span> <span class="c">! node number returned</span>
<a name="ln-5330"></a>
<a name="ln-5331"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5332"></a>          <span class="c">! na</span>
<a name="ln-5333"></a>
<a name="ln-5334"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5335"></a>          <span class="c">! na</span>
<a name="ln-5336"></a>
<a name="ln-5337"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5338"></a>          <span class="c">! na</span>
<a name="ln-5339"></a>
<a name="ln-5340"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5341"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>
<a name="ln-5342"></a>
<a name="ln-5343"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5344"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5345"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5346"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5347"></a>  <span class="k">End If</span>
<a name="ln-5348"></a>
<a name="ln-5349"></a><span class="k">  </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5350"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5351"></a><span class="k">    </span><span class="n">GetSupplyInletNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">SupInletNode</span>
<a name="ln-5352"></a>  <span class="k">ELSE</span>
<a name="ln-5353"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetSupplyInletNode: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5354"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5355"></a>    <span class="n">GetSupplyInletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5356"></a>  <span class="n">ENDIF</span>
<a name="ln-5357"></a>
<a name="ln-5358"></a>  <span class="k">RETURN</span>
<a name="ln-5359"></a>
<a name="ln-5360"></a><span class="k">END FUNCTION </span><span class="n">GetSupplyInletNode</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a><span class="k">FUNCTION </span><span class="n">GetSupplyOutletNode</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5363"></a>
<a name="ln-5364"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5365"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5366"></a>          <span class="c">!       DATE WRITTEN   February 2007</span>
<a name="ln-5367"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5368"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5369"></a>
<a name="ln-5370"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5371"></a>          <span class="c">! This function looks up the given HX and returns the supply air outlet node number.</span>
<a name="ln-5372"></a>          <span class="c">! If incorrect HX name is given, errorsfound is returned as true and node number as zero.</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5375"></a>          <span class="c">! na</span>
<a name="ln-5376"></a>
<a name="ln-5377"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5378"></a>          <span class="c">! na</span>
<a name="ln-5379"></a>
<a name="ln-5380"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5381"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5382"></a>
<a name="ln-5383"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5384"></a>
<a name="ln-5385"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5386"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>              <span class="c">! must match HX names for the ExchCond type</span>
<a name="ln-5387"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">ErrorsFound</span>         <span class="c">! set to true if problem</span>
<a name="ln-5388"></a>  <span class="kt">INTEGER</span>                                  <span class="kd">::</span> <span class="n">GetSupplyOutletNode</span> <span class="c">! node number returned</span>
<a name="ln-5389"></a>
<a name="ln-5390"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5391"></a>          <span class="c">! na</span>
<a name="ln-5392"></a>
<a name="ln-5393"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5394"></a>          <span class="c">! na</span>
<a name="ln-5395"></a>
<a name="ln-5396"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5397"></a>          <span class="c">! na</span>
<a name="ln-5398"></a>
<a name="ln-5399"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5400"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>
<a name="ln-5401"></a>
<a name="ln-5402"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5403"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5404"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5405"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5406"></a>  <span class="k">End If</span>
<a name="ln-5407"></a>
<a name="ln-5408"></a><span class="k">  </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5409"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5410"></a><span class="k">    </span><span class="n">GetSupplyOutletNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">SupOutletNode</span>
<a name="ln-5411"></a>  <span class="k">ELSE</span>
<a name="ln-5412"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetSupplyOutletNode: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5413"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5414"></a>    <span class="n">GetSupplyOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5415"></a>  <span class="n">ENDIF</span>
<a name="ln-5416"></a>
<a name="ln-5417"></a>  <span class="k">RETURN</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a><span class="k">END FUNCTION </span><span class="n">GetSupplyOutletNode</span>
<a name="ln-5420"></a>
<a name="ln-5421"></a><span class="k">FUNCTION </span><span class="n">GetSecondaryInletNode</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5422"></a>
<a name="ln-5423"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5424"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5425"></a>          <span class="c">!       DATE WRITTEN   February 2007</span>
<a name="ln-5426"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5427"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5428"></a>
<a name="ln-5429"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5430"></a>          <span class="c">! This function looks up the given HX and returns the secondary air inlet node number.</span>
<a name="ln-5431"></a>          <span class="c">! If incorrect HX name is given, errorsfound is returned as true and node number as zero.</span>
<a name="ln-5432"></a>
<a name="ln-5433"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5434"></a>          <span class="c">! na</span>
<a name="ln-5435"></a>
<a name="ln-5436"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5437"></a>          <span class="c">! na</span>
<a name="ln-5438"></a>
<a name="ln-5439"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5440"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5441"></a>
<a name="ln-5442"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5443"></a>
<a name="ln-5444"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5445"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>                <span class="c">! must match HX names for the ExchCond type</span>
<a name="ln-5446"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">ErrorsFound</span>           <span class="c">! set to true if problem</span>
<a name="ln-5447"></a>  <span class="kt">INTEGER</span>                                  <span class="kd">::</span> <span class="n">GetSecondaryInletNode</span> <span class="c">! node number returned</span>
<a name="ln-5448"></a>
<a name="ln-5449"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5450"></a>          <span class="c">! na</span>
<a name="ln-5451"></a>
<a name="ln-5452"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5453"></a>          <span class="c">! na</span>
<a name="ln-5454"></a>
<a name="ln-5455"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5456"></a>          <span class="c">! na</span>
<a name="ln-5457"></a>
<a name="ln-5458"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5459"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>
<a name="ln-5460"></a>
<a name="ln-5461"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5462"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5463"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5464"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5465"></a>  <span class="k">End If</span>
<a name="ln-5466"></a>
<a name="ln-5467"></a><span class="k">  </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5468"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5469"></a><span class="k">    </span><span class="n">GetSecondaryInletNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">SecInletNode</span>
<a name="ln-5470"></a>  <span class="k">ELSE</span>
<a name="ln-5471"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetSecondaryInletNode: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5472"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5473"></a>    <span class="n">GetSecondaryInletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5474"></a>  <span class="n">ENDIF</span>
<a name="ln-5475"></a>
<a name="ln-5476"></a>  <span class="k">RETURN</span>
<a name="ln-5477"></a>
<a name="ln-5478"></a><span class="k">END FUNCTION </span><span class="n">GetSecondaryInletNode</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a><span class="k">FUNCTION </span><span class="n">GetSecondaryOutletNode</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5481"></a>
<a name="ln-5482"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5483"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5484"></a>          <span class="c">!       DATE WRITTEN   February 2007</span>
<a name="ln-5485"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5486"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5487"></a>
<a name="ln-5488"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5489"></a>          <span class="c">! This function looks up the given HX assisted cooling coil and returns the secondary air outlet node number.</span>
<a name="ln-5490"></a>          <span class="c">! If incorrect HX name is given, errorsfound is returned as true and node number as zero.</span>
<a name="ln-5491"></a>
<a name="ln-5492"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5493"></a>          <span class="c">! na</span>
<a name="ln-5494"></a>
<a name="ln-5495"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5496"></a>          <span class="c">! na</span>
<a name="ln-5497"></a>
<a name="ln-5498"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5499"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5500"></a>
<a name="ln-5501"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5502"></a>
<a name="ln-5503"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5504"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>                 <span class="c">! must match HX names for the ExchCond type</span>
<a name="ln-5505"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">ErrorsFound</span>            <span class="c">! set to true if problem</span>
<a name="ln-5506"></a>  <span class="kt">INTEGER</span>                                  <span class="kd">::</span> <span class="n">GetSecondaryOutletNode</span> <span class="c">! node number returned</span>
<a name="ln-5507"></a>
<a name="ln-5508"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5509"></a>          <span class="c">! na</span>
<a name="ln-5510"></a>
<a name="ln-5511"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5512"></a>          <span class="c">! na</span>
<a name="ln-5513"></a>
<a name="ln-5514"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5515"></a>          <span class="c">! na</span>
<a name="ln-5516"></a>
<a name="ln-5517"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5518"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>
<a name="ln-5519"></a>
<a name="ln-5520"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5521"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5522"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5523"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5524"></a>  <span class="k">End If</span>
<a name="ln-5525"></a>
<a name="ln-5526"></a><span class="k">  </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5527"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5528"></a><span class="k">    </span><span class="n">GetSecondaryOutletNode</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">SecOutletNode</span>
<a name="ln-5529"></a>  <span class="k">ELSE</span>
<a name="ln-5530"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetSecondaryOutletNode: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5531"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5532"></a>    <span class="n">GetSecondaryOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5533"></a>  <span class="n">ENDIF</span>
<a name="ln-5534"></a>
<a name="ln-5535"></a>  <span class="k">RETURN</span>
<a name="ln-5536"></a>
<a name="ln-5537"></a><span class="k">END FUNCTION </span><span class="n">GetSecondaryOutletNode</span>
<a name="ln-5538"></a>
<a name="ln-5539"></a><span class="k">FUNCTION </span><span class="n">GetSupplyAirFlowRate</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5540"></a>
<a name="ln-5541"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5542"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5543"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-5544"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5545"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5546"></a>
<a name="ln-5547"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5548"></a>          <span class="c">! This function looks up the given Generic HX and the voluetric air flow rate.</span>
<a name="ln-5549"></a>          <span class="c">! If incorrect HX name is given, errorsfound is returned as true and air flow rate as zero.</span>
<a name="ln-5550"></a>
<a name="ln-5551"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5552"></a>          <span class="c">! na</span>
<a name="ln-5553"></a>
<a name="ln-5554"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5555"></a>          <span class="c">! na</span>
<a name="ln-5556"></a>
<a name="ln-5557"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5558"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5559"></a>
<a name="ln-5560"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5563"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>                 <span class="c">! must match HX names for the ExchCond type</span>
<a name="ln-5564"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">ErrorsFound</span>            <span class="c">! set to true if problem</span>
<a name="ln-5565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">GetSupplyAirFlowRate</span>  <span class="c">! air flow rate returned</span>
<a name="ln-5566"></a>
<a name="ln-5567"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5568"></a>          <span class="c">! na</span>
<a name="ln-5569"></a>
<a name="ln-5570"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5571"></a>          <span class="c">! na</span>
<a name="ln-5572"></a>
<a name="ln-5573"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5574"></a>          <span class="c">! na</span>
<a name="ln-5575"></a>
<a name="ln-5576"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5577"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>
<a name="ln-5578"></a>
<a name="ln-5579"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5580"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5581"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5582"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5583"></a>  <span class="k">End If</span>
<a name="ln-5584"></a>
<a name="ln-5585"></a><span class="k">  </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5586"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5587"></a><span class="k">    </span><span class="n">GetSupplyAirFlowRate</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span>
<a name="ln-5588"></a>  <span class="k">ELSE</span>
<a name="ln-5589"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetSupplyAirFlowRate: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5590"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Supply Air Flow Rate returned as 0.&#39;</span><span class="p">)</span>
<a name="ln-5591"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5592"></a>    <span class="n">GetSupplyAirFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5593"></a>  <span class="n">ENDIF</span>
<a name="ln-5594"></a>
<a name="ln-5595"></a>  <span class="k">RETURN</span>
<a name="ln-5596"></a>
<a name="ln-5597"></a><span class="k">END FUNCTION </span><span class="n">GetSupplyAirFlowRate</span>
<a name="ln-5598"></a>
<a name="ln-5599"></a><span class="k">FUNCTION </span><span class="n">GetHeatExchangerObjectTypeNum</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5600"></a>
<a name="ln-5601"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5602"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5603"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-5604"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5605"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5606"></a>
<a name="ln-5607"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5608"></a>          <span class="c">! This function looks up the given Generic HX and the voluetric air flow rate.</span>
<a name="ln-5609"></a>          <span class="c">! If incorrect HX name is given, errorsfound is returned as true and air flow rate as zero.</span>
<a name="ln-5610"></a>
<a name="ln-5611"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5612"></a>          <span class="c">! na</span>
<a name="ln-5613"></a>
<a name="ln-5614"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5615"></a>          <span class="c">! na</span>
<a name="ln-5616"></a>
<a name="ln-5617"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5618"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5619"></a>
<a name="ln-5620"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5621"></a>
<a name="ln-5622"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5623"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>                 <span class="c">! must match HX names for the ExchCond type</span>
<a name="ln-5624"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">ErrorsFound</span>            <span class="c">! set to true if problem</span>
<a name="ln-5625"></a>  <span class="kt">INTEGER</span>                                  <span class="kd">::</span> <span class="n">GetHeatExchangerObjectTypeNum</span>  <span class="c">! object type parameter returned</span>
<a name="ln-5626"></a>
<a name="ln-5627"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5628"></a>          <span class="c">! na</span>
<a name="ln-5629"></a>
<a name="ln-5630"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5631"></a>          <span class="c">! na</span>
<a name="ln-5632"></a>
<a name="ln-5633"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5634"></a>          <span class="c">! na</span>
<a name="ln-5635"></a>
<a name="ln-5636"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5637"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>
<a name="ln-5638"></a>
<a name="ln-5639"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5640"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5641"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5642"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5643"></a>  <span class="k">End If</span>
<a name="ln-5644"></a>
<a name="ln-5645"></a><span class="k">  </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5646"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5647"></a><span class="k">    </span><span class="n">GetHeatExchangerObjectTypeNum</span> <span class="o">=</span> <span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">ExchTypeNum</span>
<a name="ln-5648"></a>  <span class="k">ELSE</span>
<a name="ln-5649"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetHeatExchangerObjectTypeNum: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5650"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5651"></a>    <span class="n">GetHeatExchangerObjectTypeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5652"></a>  <span class="n">ENDIF</span>
<a name="ln-5653"></a>
<a name="ln-5654"></a>  <span class="k">RETURN</span>
<a name="ln-5655"></a>
<a name="ln-5656"></a><span class="k">END FUNCTION </span><span class="n">GetHeatExchangerObjectTypeNum</span>
<a name="ln-5657"></a>
<a name="ln-5658"></a><span class="k">SUBROUTINE </span><span class="n">SetHeatExchangerData</span><span class="p">(</span><span class="n">HXNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">HXName</span><span class="p">,</span> <span class="n">SupplyAirVolFlow</span><span class="p">,</span> <span class="n">SecondaryAirVolFlow</span><span class="p">)</span>
<a name="ln-5659"></a>
<a name="ln-5660"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5661"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5662"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-5663"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5664"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5665"></a>
<a name="ln-5666"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5667"></a>          <span class="c">! This routine was designed for to autosize the HeatExchanger:AirToAir:SensibleAndLatent using</span>
<a name="ln-5668"></a>          <span class="c">! information from the ZoneHVAC:EnergyRecoveryVentilator object.</span>
<a name="ln-5669"></a>          <span class="c">! This is an illustration of setting data from an outside source.</span>
<a name="ln-5670"></a>
<a name="ln-5671"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5672"></a>          <span class="c">! na</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5675"></a>          <span class="c">! na</span>
<a name="ln-5676"></a>
<a name="ln-5677"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5678"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-5679"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-5680"></a>
<a name="ln-5681"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5682"></a>
<a name="ln-5683"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5684"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HXNum</span>               <span class="c">! Index of HX</span>
<a name="ln-5685"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrorsFound</span>         <span class="c">! Set to true if certain errors found</span>
<a name="ln-5686"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXName</span>              <span class="c">! Name of HX</span>
<a name="ln-5687"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span>              <span class="kd">::</span> <span class="n">SupplyAirVolFlow</span>    <span class="c">! HX supply air flow rate    [m3/s]</span>
<a name="ln-5688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span>              <span class="kd">::</span> <span class="n">SecondaryAirVolFlow</span> <span class="c">! HX secondary air flow rate [m3/s]</span>
<a name="ln-5689"></a>
<a name="ln-5690"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5691"></a>          <span class="c">! na</span>
<a name="ln-5692"></a>
<a name="ln-5693"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5694"></a>          <span class="c">! na</span>
<a name="ln-5695"></a>
<a name="ln-5696"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5697"></a>          <span class="c">! na</span>
<a name="ln-5698"></a>
<a name="ln-5699"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5700"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichHX</span>   <span class="c">! index to generic HX</span>
<a name="ln-5701"></a>
<a name="ln-5702"></a>  <span class="c">! Obtains and Allocates heat exchanger related parameters from input file</span>
<a name="ln-5703"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-5704"></a>    <span class="k">CALL </span><span class="n">GetHeatRecoveryInput</span>
<a name="ln-5705"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5706"></a>  <span class="k">End If</span>
<a name="ln-5707"></a>
<a name="ln-5708"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">HXNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5709"></a><span class="k">    </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">HXName</span><span class="p">,</span><span class="n">ExchCond</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatExchangers</span><span class="p">)</span>
<a name="ln-5710"></a>  <span class="k">ELSE</span>
<a name="ln-5711"></a><span class="k">    </span><span class="n">WhichHX</span><span class="o">=</span><span class="n">HXNum</span>
<a name="ln-5712"></a>  <span class="k">END IF</span>
<a name="ln-5713"></a>
<a name="ln-5714"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">WhichHX</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">WhichHX</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">NumHeatExchangers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5715"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetHeatExchangerData: Could not find heat exchanger = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HXName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5716"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5717"></a>    <span class="k">RETURN</span>
<a name="ln-5718"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5719"></a>
<a name="ln-5720"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SupplyAirVolFlow</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5721"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">NomSupAirVolFlow</span> <span class="o">=</span> <span class="n">SupplyAirVolFlow</span>
<a name="ln-5722"></a>  <span class="k">END IF</span>
<a name="ln-5723"></a>
<a name="ln-5724"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SecondaryAirVolFlow</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5725"></a><span class="k">    </span><span class="n">ExchCond</span><span class="p">(</span><span class="n">WhichHX</span><span class="p">)%</span><span class="n">NomSecAirVolFlow</span> <span class="o">=</span> <span class="n">SecondaryAirVolFlow</span>
<a name="ln-5726"></a>  <span class="k">END IF</span>
<a name="ln-5727"></a>
<a name="ln-5728"></a><span class="k">  RETURN</span>
<a name="ln-5729"></a>
<a name="ln-5730"></a><span class="k">END SUBROUTINE </span><span class="n">SetHeatExchangerData</span>
<a name="ln-5731"></a>
<a name="ln-5732"></a>
<a name="ln-5733"></a><span class="c">!     NOTICE</span>
<a name="ln-5734"></a><span class="c">!</span>
<a name="ln-5735"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-5736"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-5737"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-5738"></a><span class="c">!</span>
<a name="ln-5739"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-5740"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-5741"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-5742"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-5743"></a><span class="c">!</span>
<a name="ln-5744"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-5745"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-5746"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-5747"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-5748"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-5749"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-5750"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-5751"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-5752"></a><span class="c">!     permit others to do so.</span>
<a name="ln-5753"></a><span class="c">!</span>
<a name="ln-5754"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-5755"></a><span class="c">!</span>
<a name="ln-5756"></a>
<a name="ln-5757"></a><span class="k">END MODULE </span><span class="n">HeatRecovery</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
