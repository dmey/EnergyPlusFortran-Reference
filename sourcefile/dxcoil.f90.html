<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>DXCoil.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>DXCoil.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 2.6% of total for source files.">9847 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/DXCoil.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">DXCoil.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/dxcoils.html">DXCoils</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/dxcoil.f90.html#src">DXCoil.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~dxcoil.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiledxcoilf90EfferentGraph" width="641pt" height="1072pt"
 viewBox="0.00 0.00 641.00 1071.87" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~dxcoil.f90~~EfferentGraph" class="graph" transform="scale(.2539 .2539) rotate(0) translate(4 4216.9145)">
<title>sourcefile~~dxcoil.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-4216.9145 2520.1899,-4216.9145 2520.1899,4 -4,4"/>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~dxcoil.f90</title>
<polygon fill="none" stroke="#000000" points="2516.2841,-970.966 2453.908,-970.966 2453.908,-948.9551 2516.2841,-948.9551 2516.2841,-970.966"/>
<text text-anchor="middle" x="2485.0961" y="-956.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">DXCoil.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-1163.966 528.0262,-1163.966 528.0262,-1141.9551 643.4123,-1141.9551 643.4123,-1163.966"/>
<text text-anchor="middle" x="585.7192" y="-1149.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-883.9605C1983.8169,-872.4403 1979.6742,-843.8992 2014.8486,-816.9605 2094.6095,-755.8749 2104.7052,-697.168 2205.1461,-694.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1151.9605C804.0282,-1145.0984 809.751,-1122.7911 855.7932,-1104.9605 881.0389,-1095.1837 1302.1553,-979.3696 1321.0291,-959.9605 1362.228,-917.5932 1309.9234,-867.6453 1357.0291,-831.9605 1460.8857,-753.2841 1813.2591,-909.4418 1941.0359,-883.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M643.459,-1154.9215C676.2645,-1155.4596 718.0655,-1155.1777 755.1332,-1151.9605"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2418.147,-970.966 2287.5683,-970.966 2287.5683,-948.9551 2418.147,-948.9551 2418.147,-970.966"/>
<text text-anchor="middle" x="2352.8577" y="-956.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M755.1332,-1151.9605C853.3503,-1141.3914 1524.4265,-959.9605 1623.2106,-959.9605 1623.2106,-959.9605 1623.2106,-959.9605 1803.7218,-959.9605 1921.4961,-959.9605 1952.2001,-942.7759 2068.7139,-959.9605"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1285.8118,-817.966 1187.8127,-817.966 1187.8127,-795.9551 1285.8118,-795.9551 1285.8118,-817.966"/>
<text text-anchor="middle" x="1236.8123" y="-803.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M605.4202,-1141.8809C646.0435,-1118.9 741.8416,-1064.0091 819.7932,-1013.9605 874.3188,-978.9526 998.6511,-870.196 1059.5131,-847.9605"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2122.4447,-2343.966 2014.9831,-2343.966 2014.9831,-2321.9551 2122.4447,-2321.9551 2122.4447,-2343.966"/>
<text text-anchor="middle" x="2068.7139" y="-2329.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M755.1332,-1151.9605C800.3014,-1151.8272 810.7326,-1162.842 855.7932,-1165.9605 976.3189,-1174.3019 1217.3735,-1151.1767 1357.0291,-1147.9605 1423.31,-1146.4341 1440.0434,-1143.6359 1506.2007,-1147.9605 1594.7758,-1153.7506 1639.5194,-1113.1917 1704.2205,-1173.9605 1764.9592,-1231.0079 1686.4542,-1294.2989 1740.2205,-1357.9605 1779.1555,-1404.0613 1831.8435,-1357.078 1867.2231,-1405.9605 1921.0848,-1480.3788 1858.5133,-2151.7097 1903.2231,-2231.9605 1932.4336,-2284.3911 1962.6489,-2278.3395 2014.8486,-2307.9605 2020.6153,-2311.2329 2026.8841,-2314.4388 2033.0388,-2317.4053"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2031.987,-2320.7773 2042.5279,-2321.8447 2034.9534,-2314.4368 2031.987,-2320.7773"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-1944.966 721.7644,-1944.966 721.7644,-1922.9551 788.502,-1922.9551 788.502,-1944.966"/>
<text text-anchor="middle" x="755.1332" y="-1930.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M589.6465,-1164.2952C601.6294,-1199.3968 637.9119,-1309.618 654.4731,-1403.9605 689.0104,-1600.7051 617.5046,-1666.0121 690.4731,-1851.9605 700.2296,-1876.8234 720.1702,-1900.2262 735.3425,-1915.6156"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="733.1742,-1918.3916 742.7629,-1922.8981 738.0774,-1913.3957 733.1742,-1918.3916"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.5454,-1507.966 1740.8982,-1507.966 1740.8982,-1485.9551 1866.5454,-1485.9551 1866.5454,-1507.966"/>
<text text-anchor="middle" x="1803.7218" y="-1493.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602.4543,-1164.0884C643.467,-1190.6082 753.1424,-1257.0296 855.7932,-1279.9605 903.7826,-1290.6808 917.9702,-1288.2966 966.4307,-1279.9605 1052.9458,-1265.0784 1066.5239,-1231.224 1152.5955,-1213.9605 1255.2908,-1193.3627 1564.4847,-1101.2318 1623.2106,-1187.9605"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1704.2303,-2343.966 1542.1908,-2343.966 1542.1908,-2321.9551 1704.2303,-2321.9551 1704.2303,-2343.966"/>
<text text-anchor="middle" x="1623.2106" y="-2329.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.8252,-1164.069C599.1542,-1199.7827 634.8777,-1313.9828 690.4731,-1393.9605 697.7465,-1404.4238 845.7203,-1545.1555 855.7932,-1552.9605 978.2934,-1647.8795 1015.728,-1663.2749 1152.5955,-1735.9605 1225.1287,-1774.4805 1270.0899,-1747.5395 1321.0291,-1811.9605 1373.2544,-1878.0082 1321.8285,-1921.4707 1357.0291,-1997.9605 1420.7172,-2136.3529 1553.1908,-2268.0045 1603.3679,-2314.8993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1601.2423,-2317.7013 1610.9568,-2321.9298 1605.9996,-2312.5662 1601.2423,-2317.7013"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1867.2245,-3333.966 1740.2191,-3333.966 1740.2191,-3311.9551 1867.2245,-3311.9551 1867.2245,-3333.966"/>
<text text-anchor="middle" x="1803.7218" y="-3319.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M593.8829,-1164.2684C609.9491,-1185.7133 647.8379,-1232.4257 690.4731,-1257.9605 1015.7817,-1452.7921 1219.3793,-1259.9314 1506.2007,-1507.9605 1533.5638,-1531.6228 1520.6631,-1551.8955 1542.2007,-1580.9605 1600.9857,-1660.2911 1663.8932,-1642.8343 1704.2205,-1732.9605 1771.8128,-1884.0206 1692.4657,-3063.5075 1740.2205,-3221.9605 1749.7054,-3253.432 1771.8332,-3284.6973 1787.2842,-3303.9181"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1784.777,-3306.3786 1793.8441,-3311.8592 1790.1737,-3301.9204 1784.777,-3306.3786"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2418.202,-959.9605C2426.7984,-959.9605 2435.4122,-959.9605 2443.4622,-959.9605"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2443.671,-963.4606 2453.671,-959.9605 2443.6709,-956.4606 2443.671,-963.4606"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-3675.966 358.7923,-3675.966 358.7923,-3653.9551 439.3754,-3653.9551 439.3754,-3675.966"/>
<text text-anchor="middle" x="399.0839" y="-3661.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.1273,-3676.2482C411.8073,-3734.1781 462.7895,-3997.7083 516.9653,-4057.9605 593.7253,-4143.33 640.3288,-4157.9605 755.1332,-4157.9605 755.1332,-4157.9605 755.1332,-4157.9605 1059.5131,-4157.9605 1224.8916,-4157.9605 1268.3606,-4131.5388 1431.6149,-4157.9605"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M585.7192,-4005.9605C713.9168,-4073.0411 1092.1249,-4005.9605 1236.8123,-4005.9605 1236.8123,-4005.9605 1236.8123,-4005.9605 1803.7218,-4005.9605 1966.0225,-4005.9605 2015.1808,-3949.6451 2122.5791,-3827.9605 2187.3033,-3754.6267 2168.9396,-3714.824 2205.1461,-3623.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-3100.966 536.1602,-3100.966 536.1602,-3078.9551 635.2783,-3078.9551 635.2783,-3100.966"/>
<text text-anchor="middle" x="585.7192" y="-3086.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M439.4547,-3662.0971C454.76,-3658.8734 470.9051,-3652.4694 480.9653,-3639.9605 543.559,-3562.1316 483.9741,-3286.2308 516.9653,-3191.9605 528.2105,-3159.8283 552.1103,-3128.1628 568.5445,-3108.842"/>
<polygon fill="#ff0036" stroke="#ff0036" points="571.3494,-3110.9509 575.2848,-3101.1141 566.074,-3106.3498 571.3494,-3110.9509"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.0073,-3675.9999C410.3141,-3725.6135 455.6694,-3928.8848 585.7192,-4005.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-3454.9605C1479.0425,-3431.3399 1483.7255,-3409.9416 1506.2007,-3361.9605 1512.0679,-3349.4349 1702.3368,-2399.6634 1704.2205,-2385.9605 1734.0785,-2168.7518 1714.8824,-2111.7427 1740.2205,-1893.9605 1757.0059,-1749.6882 1788.46,-1577.6525 1799.6455,-1518.3119"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1803.1233,-1518.7573 1801.5463,-1508.2805 1796.2457,-1517.454 1803.1233,-1518.7573"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4005.9605C596.3358,-4012.2526 956.576,-3784.3893 966.4307,-3776.9605 1039.2929,-3722.0341 1066.4833,-3713.214 1116.5955,-3636.9605 1142.7676,-3597.1355 1117.3772,-3568.0648 1152.5955,-3535.9605 1209.6926,-3483.9118 1248.9355,-3520.7397 1321.0291,-3492.9605 1337.9108,-3486.4556 1340.1456,-3480.461 1357.0291,-3473.9605 1388.9525,-3461.6693 1404.7995,-3476.2 1431.6149,-3454.9605"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1978.6623,-3314.966 1903.4095,-3314.966 1903.4095,-3292.9551 1978.6623,-3292.9551 1978.6623,-3314.966"/>
<text text-anchor="middle" x="1941.0359" y="-3300.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4005.9605C598.5637,-4013.2189 1609.0384,-3782.061 1623.2106,-3777.9605"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-3454.9605C1507.8384,-3416.9985 1542.7857,-3482.9425 1623.2106,-3454.9605"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2251.7802,-2039.966 2158.512,-2039.966 2158.512,-2017.9551 2251.7802,-2017.9551 2251.7802,-2039.966"/>
<text text-anchor="middle" x="2205.1461" y="-2025.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2231.3713,-2040.0504C2270.0997,-2054.7111 2339.4672,-2073.805 2352.8577,-2028.9605"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2208.653,-2017.9049C2217.2965,-1990.2409 2239.7842,-1915.6741 2251.7131,-1851.9605 2316.1341,-1507.8815 2345.3719,-1080.9289 2351.574,-981.3894"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2355.0843,-981.3268 2352.2031,-971.1313 2348.0974,-980.8982 2355.0843,-981.3268"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1427.966 350.2841,-1427.966 350.2841,-1405.9551 447.8836,-1405.9551 447.8836,-1427.966"/>
<text text-anchor="middle" x="399.0839" y="-1413.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.4311,-1405.76C411.85,-1355.7743 454.5604,-1147.9876 480.9653,-975.9605 491.0184,-910.4651 481.4056,-735.8731 516.9653,-679.9605 555.6485,-619.1367 595.3895,-635.2528 654.4731,-593.9605 671.0876,-582.3491 674.4359,-578.357 690.4731,-565.9605 763.7793,-509.2962 781.1291,-493.8232 855.7932,-438.9605 919.9731,-391.8016 936.0955,-380.0362 1002.4307,-335.9605 1141.6819,-243.4366 1185.666,-234.0852 1321.0291,-135.9605 1372.7931,-98.4368 1372.2994,-67.819 1431.6149,-43.9605"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M401.7263,-1405.8C413.3999,-1355.9842 460.6645,-1148.8143 480.9653,-975.9605 490.2567,-896.8482 469.1226,-323.6485 516.9653,-259.9605 612.6528,-132.582 698.6743,-169.324 855.7932,-142.9605 990.5891,-120.3427 1966.0444,-257.7359 2068.7139,-347.9605"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M755.1332,-579.9605C811.1773,-536.1329 841.0782,-556.4936 911.1119,-543.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M911.1119,-543.9605C1086.5767,-512.5597 1573.5166,-542.7566 1704.2205,-663.9605 1846.8645,-796.2368 2062.0307,-1626.5896 2122.5791,-1847.9605 2141.3517,-1916.5951 2115.3782,-1947.4203 2158.5791,-2003.9605 2160.8876,-2006.9818 2163.6688,-2009.68 2166.7093,-2012.0806"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2164.9555,-2015.118 2175.2163,-2017.7573 2168.841,-2009.2953 2164.9555,-2015.118"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1497.1099,-437.966 1366.1198,-437.966 1366.1198,-415.9551 1497.1099,-415.9551 1497.1099,-437.966"/>
<text text-anchor="middle" x="1431.6149" y="-423.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M400.75,-1405.6606C411.0504,-1336.5757 467.2436,-970.816 516.9653,-869.9605 558.7254,-785.2546 594.7159,-781.0909 654.4731,-707.9605 700.2671,-651.9183 701.4305,-628.4769 755.1332,-579.9605"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M755.1332,-579.9605C925.0445,-432.8387 1013.3702,-401.7044 1236.8123,-425.9605"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="801.757,-3216.966 708.5093,-3216.966 708.5093,-3194.9551 801.757,-3194.9551 801.757,-3216.966"/>
<text text-anchor="middle" x="755.1332" y="-3202.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M585.7192,-3205.9605C620.7666,-3234.4501 674.7266,-3228.7605 712.2988,-3219.6455"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="713.6355,-3222.9144 722.4322,-3217.0094 711.8731,-3216.1398 713.6355,-3222.9144"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M447.9629,-1421.5321C460.6511,-1425.1787 472.9805,-1431.4138 480.9653,-1441.9605 536.913,-1515.8589 487.673,-3022.0227 516.9653,-3109.9605 533.5508,-3159.7512 544.9962,-3172.8573 585.7192,-3205.9605"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M585.7192,-999.9605C756.739,-859.7542 850.2888,-919.5901 1059.5131,-847.9605"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1059.5131,-847.9605C1098.0444,-834.8888 1142.679,-824.5927 1177.5245,-817.5878"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1178.4094,-820.9808 1187.5421,-815.6101 1177.0536,-814.1133 1178.4094,-820.9808"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.461,-1924.966 1740.9826,-1924.966 1740.9826,-1902.9551 1866.461,-1902.9551 1866.461,-1924.966"/>
<text text-anchor="middle" x="1803.7218" y="-1910.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M755.1332,-999.9605C1097.354,-1020.727 1212.0708,-999.7959 1506.2007,-1175.9605 1563.3419,-1210.1844 1674.8513,-1341.1789 1704.2205,-1400.9605 1748.4385,-1490.9673 1790.4893,-1808.092 1801.1402,-1892.9466"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1797.6743,-1893.4384 1802.3823,-1902.9297 1804.6208,-1892.5741 1797.6743,-1893.4384"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M585.7192,-999.9605C615.234,-976.5893 718.1475,-992.9324 755.1332,-999.9605"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1481.0048,-3294.966 1382.2249,-3294.966 1382.2249,-3272.9551 1481.0048,-3272.9551 1481.0048,-3294.966"/>
<text text-anchor="middle" x="1431.6149" y="-3280.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M585.7192,-1799.9605C607.7234,-1832.9057 827.532,-2432.1959 855.7932,-2459.9605 893.4261,-2496.9322 934.3669,-2461.0672 966.4307,-2502.9605 1012.2057,-2562.7685 991.1953,-2765.4883 1002.4307,-2839.9605 1022.1571,-2970.7152 976.6413,-3028.916 1059.5131,-3131.9605"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1059.5131,-3131.9605C1095.5588,-3176.8179 1102.7451,-3193.2131 1152.5955,-3221.9605 1186.311,-3241.4034 1204.4425,-3224.3513 1236.8123,-3245.9605"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M911.1119,-543.9605C1044.317,-526.9671 1385.5358,-590.0338 1506.2007,-648.9605 1612.5372,-700.89 1640.5388,-727.217 1704.2205,-826.9605 1837.0679,-1035.0373 1811.904,-1117.3693 1867.2231,-1357.9605 1891.1602,-1462.0665 1950.6091,-2222.6124 2014.8486,-2307.9605 2017.256,-2311.1589 2020.1722,-2313.9621 2023.3875,-2316.4166"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2021.5624,-2319.4038 2031.8768,-2321.8255 2025.3239,-2313.5002 2021.5624,-2319.4038"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="966.25,-1543.966 855.9739,-1543.966 855.9739,-1521.9551 966.25,-1521.9551 966.25,-1543.966"/>
<text text-anchor="middle" x="911.1119" y="-1529.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-1533.9605C786.5223,-1552.1667 827.7863,-1551.0396 859.9876,-1545.8303"/>
<polygon fill="#00ffff" stroke="#00ffff" points="860.8759,-1549.2269 870.1001,-1544.0149 859.639,-1542.337 860.8759,-1549.2269"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-1417.9605C675.6947,-1433.1836 676.196,-1488.1757 755.1332,-1533.9605"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1115.3299,-703.966 1003.6963,-703.966 1003.6963,-681.9551 1115.3299,-681.9551 1115.3299,-703.966"/>
<text text-anchor="middle" x="1059.5131" y="-689.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M911.1119,-771.9605C957.7528,-757.868 1006.6683,-728.5626 1035.0596,-709.8768"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1037.1593,-712.6833 1043.5275,-704.2159 1033.2689,-706.8639 1037.1593,-712.6833"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1109.0619,-1467.966 1009.9642,-1467.966 1009.9642,-1445.9551 1109.0619,-1445.9551 1109.0619,-1467.966"/>
<text text-anchor="middle" x="1059.5131" y="-1453.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M911.1119,-1417.9605C949.4431,-1420.4681 991.6771,-1432.5248 1021.2554,-1442.5773"/>
<polygon fill="#005bff" stroke="#005bff" points="1020.1824,-1445.9097 1030.7772,-1445.8929 1022.4843,-1439.2991 1020.1824,-1445.9097"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504.8695,-1538.966 1358.3603,-1538.966 1358.3603,-1516.9551 1504.8695,-1516.9551 1504.8695,-1538.966"/>
<text text-anchor="middle" x="1431.6149" y="-1524.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M585.7192,-999.9605C604.7993,-984.1163 1267.8706,-1419.9457 1406.4028,-1511.3121"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1404.4822,-1514.238 1414.7567,-1516.8236 1408.3371,-1508.3951 1404.4822,-1514.238"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1116.678,-2037.966 1002.3481,-2037.966 1002.3481,-2015.9551 1116.678,-2015.9551 1116.678,-2037.966"/>
<text text-anchor="middle" x="1059.5131" y="-2023.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M448.2319,-1423.2615C460.3141,-1426.9674 472.2641,-1432.8006 480.9653,-1441.9605 526.4,-1489.7903 482.9206,-1529.4543 516.9653,-1585.9605 621.3745,-1759.2554 696.1686,-1765.6529 855.7932,-1889.9605 916.4725,-1937.2145 992.8247,-1985.919 1032.6082,-2010.5521"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1030.8656,-2013.5895 1041.2147,-2015.8583 1034.5393,-2007.6309 1030.8656,-2013.5895"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M448.0467,-1422.4019C460.4244,-1426.0873 472.5702,-1432.1251 480.9653,-1441.9605 556.13,-1530.0214 475.0469,-1592.0379 516.9653,-1699.9605 536.4933,-1750.2369 555.7628,-1755.1089 585.7192,-1799.9605"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-1799.9605C595.8241,-1815.0899 687.9626,-1884.2845 731.9556,-1916.8812"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="729.9526,-1919.7531 740.0737,-1922.8857 734.1152,-1914.1252 729.9526,-1919.7531"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1682.5461,-1905.966 1563.875,-1905.966 1563.875,-1883.9551 1682.5461,-1883.9551 1682.5461,-1905.966"/>
<text text-anchor="middle" x="1623.2106" y="-1891.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M911.1119,-1417.9605C1002.6319,-1423.9477 1028.7364,-1410.6446 1116.5955,-1436.9605 1217.2614,-1467.1124 1448.1856,-1617.3419 1506.2007,-1704.9605 1535.3004,-1748.9091 1514.2204,-1773.2909 1542.2007,-1817.9605 1557.1603,-1841.8431 1581.2195,-1863.4102 1599.2386,-1877.6024"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1597.4656,-1880.6531 1607.5328,-1883.9549 1601.7219,-1875.0957 1597.4656,-1880.6531"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M585.7192,-1417.9605C728.3117,-1442.0859 766.9962,-1405.9064 911.1119,-1417.9605"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M448.2085,-1412.781C486.0778,-1410.6264 539.5956,-1409.9068 585.7192,-1417.9605"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M447.9589,-1421.5351C460.6469,-1425.1819 472.9774,-1431.4162 480.9653,-1441.9605 535.4258,-1513.8499 464.4076,-2991.6685 516.9653,-3064.9605 519.8219,-3068.944 523.3797,-3072.2946 527.3625,-3075.1126"/>
<polygon fill="#ff0036" stroke="#ff0036" points="525.6452,-3078.1627 536.0461,-3080.181 529.1739,-3072.1172 525.6452,-3078.1627"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.0499,-1405.8453C404.6783,-1358.2276 428.1726,-1168.4045 516.9653,-1047.9605 539.0795,-1017.9635 556.7335,-1023.3846 585.7192,-999.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-999.9605C618.1893,-973.7207 625.5643,-966.0789 654.4731,-935.9605 671.4979,-918.2235 671.4125,-909.4891 690.4731,-893.9605 691.8305,-892.8547 909.4359,-772.4669 911.1119,-771.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-771.9605C1036.9056,-729.0458 1407.1765,-743.3044 1506.2007,-831.9605 1541.0823,-863.1899 1521.0633,-889.1848 1542.2007,-930.9605 1600.804,-1046.7833 1659.2062,-1052.2109 1704.2205,-1173.9605 1750.4841,-1299.0893 1658.6391,-1366.4048 1740.2205,-1471.9605 1742.7167,-1475.1904 1745.6912,-1478.0037 1748.9701,-1480.454"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1747.3036,-1483.5387 1757.6481,-1485.8279 1750.989,-1477.5874 1747.3036,-1483.5387"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-1761.9605C1171.0013,-1800.6595 1224.3887,-1740.2267 1321.0291,-1807.9605 1369.381,-1841.8497 1565.4571,-2220.3201 1612.8577,-2312.7092"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1609.8713,-2314.5562 1617.5461,-2321.8602 1616.1013,-2311.3643 1609.8713,-2314.5562"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1533.9605C901.3432,-1618.7646 902.2592,-1699.9902 1059.5131,-1761.9605"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1485.3406,-2458.966 1377.8892,-2458.966 1377.8892,-2436.9551 1485.3406,-2436.9551 1485.3406,-2458.966"/>
<text text-anchor="middle" x="1431.6149" y="-2444.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1059.5131,-1761.9605C1103.8351,-1777.4801 1108.8373,-1794.9157 1152.5955,-1811.9605 1224.587,-1840.0029 1271.5924,-1795.5873 1321.0291,-1854.9605 1396.5654,-1945.6792 1303.7121,-2279.6376 1357.0291,-2384.9605 1366.9118,-2404.483 1385.7938,-2420.3365 1402.0859,-2431.257"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1400.4828,-2434.3857 1410.797,-2436.8084 1404.2448,-2428.4825 1400.4828,-2434.3857"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-2306.966 517.2105,-2306.966 517.2105,-2284.9551 654.2279,-2284.9551 654.2279,-2306.966"/>
<text text-anchor="middle" x="585.7192" y="-2292.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M448.1225,-1421.8632C460.6553,-1425.5299 472.8628,-1431.6927 480.9653,-1441.9605 521.1697,-1492.9092 506.9416,-1960.8381 516.9653,-2024.9605 531.7862,-2119.7707 564.72,-2229.7657 578.9518,-2274.9484"/>
<polygon fill="#0066ff" stroke="#0066ff" points="575.705,-2276.2882 582.0701,-2284.758 582.3761,-2274.1676 575.705,-2276.2882"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1305.21,-1885.966 1168.4145,-1885.966 1168.4145,-1863.9551 1305.21,-1863.9551 1305.21,-1885.966"/>
<text text-anchor="middle" x="1236.8123" y="-1871.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M444.2219,-1428.0429C456.435,-1431.7612 469.4531,-1436.4054 480.9653,-1441.9605 761.5986,-1577.3784 755.0363,-1771.7265 1059.5131,-1837.9605"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.301,-1405.7161C400.8556,-1352.9488 413.5367,-1126.5584 516.9653,-985.9605 559.9609,-927.5135 606.5237,-952.4171 654.4731,-897.9605 679.1726,-869.9092 664.0871,-848.4316 690.4731,-821.9605 798.9458,-713.1383 857.1181,-722.8889 1002.4307,-672.9605 1137.0621,-626.7021 1185.1324,-597.5629 1321.0291,-639.9605 1416.5359,-669.7571 1437.5002,-695.2306 1506.2007,-767.9605 1527.2943,-790.2913 1520.7286,-804.9934 1542.2007,-826.9605 1602.0124,-888.1514 1660.5363,-857.3843 1704.2205,-930.9605 1761.4316,-1027.32 1671.6991,-1345.2864 1740.2205,-1433.9605 1776.6587,-1481.1156 1831.5218,-1429.2451 1867.2231,-1476.9605 1874.3429,-1486.4761 1932.7932,-3078.5768 1940.2535,-3282.5411"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1936.7665,-3282.9631 1940.6295,-3292.8285 1943.7618,-3282.7073 1936.7665,-3282.9631"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-999.9605C1019.2984,-1050.1581 1094.1267,-1069.6748 1321.0291,-1213.9605 1436.7106,-1287.5217 1443.0581,-1334.2811 1542.2007,-1428.9605 1613.6071,-1497.1524 1663.9941,-1490.7893 1704.2205,-1580.9605 1778.5225,-1747.5158 1687.789,-3047.2826 1740.2205,-3221.9605 1749.6702,-3253.4426 1771.8064,-3284.7053 1787.2689,-3303.9227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1784.7643,-3306.3861 1793.8342,-3311.8622 1790.1589,-3301.9252 1784.7643,-3306.3861"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="961.2392,-2533.966 860.9847,-2533.966 860.9847,-2511.9551 961.2392,-2511.9551 961.2392,-2533.966"/>
<text text-anchor="middle" x="911.1119" y="-2519.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.259,-1421.7565C460.794,-1425.4215 472.9685,-1431.6101 480.9653,-1441.9605 540.3885,-1518.8725 462.3092,-2235.5909 516.9653,-2315.9605 554.5626,-2371.2457 594.8509,-2346.7084 654.4731,-2376.9605 730.0447,-2415.3052 748.6097,-2425.9792 819.7932,-2471.9605 836.3718,-2482.6695 838.7144,-2488.0688 855.7932,-2497.9605 861.7368,-2501.403 868.2394,-2504.7129 874.6312,-2507.7347"/>
<polygon fill="#ff0000" stroke="#ff0000" points="873.2881,-2510.969 883.8385,-2511.9377 876.195,-2504.6011 873.2881,-2510.969"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1466.3157,-438.0648C1478.9373,-442.2422 1493.2737,-447.1486 1506.2007,-451.9605 1558.8794,-471.5698 1570.6464,-480.0462 1623.2106,-499.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-499.9605C1653.6739,-511.5018 2177.9666,-410.0027 2205.1461,-427.9605"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1623.2106,-499.9605C1895.4155,-583.0663 1794.2996,-884.4693 2068.7139,-959.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2068.7139,-959.9605C2128.7015,-968.8081 2145.9225,-946.947 2205.1461,-959.9605"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.2631,-3217.1602C787.6571,-3228.279 809.3927,-3246.8329 819.7932,-3268.9605 904.5758,-3449.3389 798.401,-3525.0926 855.7932,-3715.9605 894.6659,-3845.2386 901.6618,-3892.1298 1002.4307,-3981.9605 1156.3237,-4119.1489 1231.3707,-4108.9096 1431.6149,-4157.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-4195.9605C1733.3056,-4198.3556 1765.0497,-4194.0365 1867.2231,-4152.9605 1993.9535,-4102.0121 2018.9296,-4070.9162 2122.5791,-3981.9605 2163.7715,-3946.6078 2157.9538,-3918.7843 2205.1461,-3891.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-4157.9605C1517.3121,-4171.8301 1536.4103,-4197.4075 1623.2106,-4195.9605"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1286.9652,-3141.966 1186.6593,-3141.966 1186.6593,-3119.9551 1286.9652,-3119.9551 1286.9652,-3141.966"/>
<text text-anchor="middle" x="1236.8123" y="-3127.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1461,-3891.9605C2385.4443,-3788.9511 2302.1423,-2230.3217 2352.8577,-2028.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-3207.9605C1882.2025,-3204.3958 1924.6393,-3175.0985 1978.8486,-3231.9605 2041.3482,-3297.5185 1960.7763,-3565.2953 2014.8486,-3637.9605 2045.625,-3679.3195 2086.249,-3644.3835 2122.5791,-3680.9605 2193.5446,-3752.4084 2117.7085,-3941.9161 2205.1461,-3891.9605"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2068.7139,-3623.9605C2129.2547,-3620.5552 2183.5354,-3680.6153 2205.1461,-3623.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2205.1461,-3623.9605C2332.7457,-3289.4445 2267.506,-2372.4158 2287.7131,-2014.9605 2311.2459,-1598.6767 2344.322,-1090.2818 2351.4641,-981.1949"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2354.9618,-981.3429 2352.1233,-971.1354 2347.9768,-980.8851 2354.9618,-981.3429"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1803.7218,-3207.9605C1881.0939,-3197.4521 1918.2512,-3144.7181 1978.8486,-3193.9605 2130.3686,-3317.088 1873.648,-3632.2043 2068.7139,-3623.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1623.2106,-3207.9605C1693.781,-3169.8002 1723.5772,-3211.6009 1803.7218,-3207.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M2068.7139,-3623.9605C2151.3967,-3619.3097 2198.3936,-2240.3231 2204.4712,-2050.5217"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2207.9734,-2050.5064 2204.7924,-2040.4003 2200.9769,-2050.2843 2207.9734,-2050.5064"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1284.2527,-3142.0459C1384.1187,-3165.1581 1608.1236,-3215.7348 1623.2106,-3207.9605"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1623.2106,-3207.9605C1656.3267,-3190.257 1681.2047,-3213.6315 1704.2205,-3183.9605 1737.6129,-3140.9123 1733.3663,-2258.0088 1740.2205,-2203.9605 1753.1841,-2101.7368 1784.6292,-1982.3068 1797.7825,-1934.8922"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1801.1801,-1935.7386 1800.5059,-1925.1652 1794.4393,-1933.8513 1801.1801,-1935.7386"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1244.4417,-3142.3021C1261.6426,-3167.0342 1305.9552,-3226.218 1357.0291,-3258.9605 1363.1944,-3262.913 1370.0496,-3266.3066 1377.035,-3269.202"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1375.9981,-3272.5525 1386.5888,-3272.8472 1378.4935,-3266.0123 1375.9981,-3272.5525"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1237.9649,-3119.8025C1245.7719,-3044.0097 1291.4837,-2596.8001 1321.0291,-2231.9605 1339.979,-1997.9585 1302.706,-1933.3572 1357.0291,-1704.9605 1371.224,-1645.2792 1403.5352,-1579.9678 1420.5944,-1547.9392"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1423.6898,-1549.5729 1425.362,-1539.1108 1417.5306,-1546.2466 1423.6898,-1549.5729"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1431.6149,-2827.9605C1469.4746,-2743.2455 1484.2636,-2723.1201 1506.2007,-2632.9605 1540.0364,-2493.8983 1520.5684,-2454.4356 1542.2007,-2312.9605 1565.6036,-2159.905 1604.9434,-1977.4735 1618.4728,-1916.2045"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1621.9414,-1916.7292 1620.6891,-1906.2086 1615.1074,-1915.2139 1621.9414,-1916.7292"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1286.9698,-3123.9727C1299.2533,-3120.265 1311.5716,-3114.6027 1321.0291,-3105.9605 1419.1907,-3016.2615 1377.3602,-2949.3609 1431.6149,-2827.9605"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-2827.9605C1445.8232,-2796.1679 1482.1599,-2829.1537 1506.2007,-2803.9605 1643.5272,-2660.0513 1562.8473,-2561.4987 1623.2106,-2371.9605"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3207.9605C1648.346,-3194.5234 1824.364,-3259.1561 1903.1107,-3289.2433"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1902.0712,-3292.5932 1912.6614,-3292.9054 1904.5773,-3286.0572 1902.0712,-3292.5932"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.5191,-3142.0021C1291.4912,-3169.0892 1392.3078,-3237.1937 1431.6149,-3244.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3283.9605C1665.7229,-3290.6949 1713.2887,-3301.0913 1748.9169,-3309.4569"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1748.5649,-3312.9703 1759.1024,-3311.8694 1750.1783,-3306.1588 1748.5649,-3312.9703"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-3244.9605C1516.8664,-3261.8057 1537.3809,-3270.3642 1623.2106,-3283.9605"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2120.9966,-3711.966 2016.4312,-3711.966 2016.4312,-3689.9551 2120.9966,-3689.9551 2120.9966,-3711.966"/>
<text text-anchor="middle" x="2068.7139" y="-3697.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2071.0006,-3712.1073C2081.1425,-3758.8382 2125.1291,-3934.602 2205.1461,-3891.9605"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M2082.6499,-3689.6173C2095.6146,-3678.1288 2114.1597,-3659.0809 2122.5791,-3637.9605 2184.1168,-3483.5905 2202.556,-2229.1949 2204.8829,-2050.1897"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2208.3826,-2050.2219 2205.0106,-2040.178 2201.3832,-2050.1325 2208.3826,-2050.2219"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1243.59,-795.8316C1266.3767,-758.5866 1339.7597,-640.074 1357.0291,-629.9605 1581.825,-498.3121 1680.5277,-579.9605 1941.0359,-579.9605 1941.0359,-579.9605 1941.0359,-579.9605 2068.7139,-579.9605 2204.9509,-579.9605 2257.4647,-597.6943 2352.8577,-694.9605"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1866.6774,-1912.1001C1890.0545,-1911.8988 1916.7803,-1912.2469 1941.0359,-1913.9605"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1804.4448,-1925.2355C1808.1583,-1972.3438 1829.5425,-2153.944 1941.0359,-2217.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1941.0359,-2217.9605C1944.6152,-2220.0157 2065.1902,-2296.1097 2068.7139,-2293.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M2068.7139,-2293.9605C2165.9538,-2234.653 2083.6311,-2139.7265 2158.5791,-2053.9605 2161.3641,-2050.7735 2164.6573,-2047.9234 2168.185,-2045.3922"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2170.0924,-2048.3275 2176.7136,-2040.0564 2166.3796,-2042.3932 2170.0924,-2048.3275"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-3929.9605C2058.9345,-3942.7572 2100.4883,-3947.7332 2205.1461,-3891.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3701.9605C1752.2096,-3818.4975 1773.2379,-3884.5132 1941.0359,-3929.9605"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1623.2106,-3701.9605C1709.9612,-3771.2907 2021.7675,-3767.537 2122.5791,-3720.9605 2173.9734,-3697.2156 2185.769,-3677.1557 2205.1461,-3623.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1437.5031,-3295.1836C1450.7496,-3320.6683 1483.5093,-3385.0359 1506.2007,-3440.9605 1553.9965,-3558.757 1528.8796,-3616.7424 1623.2106,-3701.9605"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1436.6018,-3295.3014C1450.3348,-3325.7201 1491.0995,-3410.7519 1542.2007,-3468.9605 1572.4725,-3503.4427 1577.3789,-3530.7558 1623.2106,-3532.9605"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1623.2106,-3532.9605C1760.501,-3539.5648 1792.7166,-3458.464 1867.2231,-3342.9605 1979.2998,-3169.2142 2053.3191,-2485.1021 2066.5739,-2354.5509"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2070.0894,-2354.5724 2067.6074,-2344.2724 2063.1245,-2353.872 2070.0894,-2354.5724"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.9033,-3272.7466C1444.0328,-3222.6983 1485.257,-3014.6249 1506.2007,-2841.9605 1512.6942,-2788.4266 1508.5927,-2400.1334 1542.2007,-2357.9605 1544.7591,-2354.7501 1547.7216,-2351.9425 1550.9698,-2349.488"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1552.9607,-2352.3707 1559.5648,-2344.0859 1549.2357,-2346.444 1552.9607,-2352.3707"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.1707,-3279.7281C1520.0525,-3277.4235 1575.4087,-3276.3882 1623.2106,-3283.9605"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2098.8633,-2321.8283C2106.9855,-2318.0867 2115.4804,-2313.4432 2122.5791,-2307.9605 2249.8261,-2209.6807 2306.8556,-2183.0206 2352.8577,-2028.9605"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="950.3499,-173.966 871.874,-173.966 871.874,-151.9551 950.3499,-151.9551 950.3499,-173.966"/>
<text text-anchor="middle" x="911.1119" y="-159.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-119.9605C1958.102,-130.2053 1963.3192,-131.5088 1978.8486,-143.9605 2022.9491,-179.321 2014.019,-219.6886 2068.7139,-233.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2068.7139,-233.9605C2148.0857,-254.6715 2190.9645,-202.8385 2251.7131,-257.9605 2399.3509,-391.9238 2212.1292,-553.7566 2352.8577,-694.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-43.9605C1652.4403,16.3575 1744.7688,-2.1414 1941.0359,-119.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2352.8577,-694.9605C2426.4467,-768.0669 2466.1754,-890.5228 2479.7104,-939.1466"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2476.3473,-940.1182 2482.3352,-948.8586 2483.1049,-938.2918 2476.3473,-940.1182"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.4129,-154.0069C1071.1476,-126.497 1428.7116,-44.9932 1431.6149,-43.9605"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M924.2431,-174.0955C937.0492,-185.7091 956.0673,-205.1045 966.4307,-225.9605 1001.9597,-297.4616 974.4655,-327.1764 1002.4307,-401.9605 1049.9815,-529.1204 1084.0429,-550.7801 1152.5955,-667.9605 1177.5934,-710.6908 1207.8846,-760.1411 1224.4713,-787.0286"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1221.6935,-789.1916 1229.9269,-795.8595 1227.6487,-785.5125 1221.6935,-789.1916"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-1495.9605C1083.2031,-1483.5619 1097.2401,-1495.4081 1116.5955,-1476.9605 1148.6792,-1446.3815 1123.7214,-1417.5869 1152.5955,-1383.9605 1165.1176,-1369.3774 2339.2827,-681.3519 2352.8577,-694.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M954.7607,-1521.9082C969.8551,-1518.1017 986.8817,-1513.8254 1002.4307,-1509.9605 1027.7811,-1503.6594 1035.6786,-1506.6501 1059.5131,-1495.9605"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1059.5131,-1495.9605C1083.2328,-1483.6189 1093.749,-1490.8523 1116.5955,-1476.9605 1135.6627,-1465.3667 1132.3874,-1451.4268 1152.5955,-1441.9605 1375.2227,-1337.6732 1458.4064,-1397.1913 1704.2205,-1400.9605 1776.6917,-1402.0718 1795.174,-1398.072 1867.2231,-1405.9605 1900.4153,-1409.5947 1907.6788,-1418.4655 1941.0359,-1419.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1941.0359,-1419.9605C2059.9404,-1411.2046 2109.9068,-1538.6852 2205.1461,-1466.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2205.1461,-1466.9605C2281.8166,-1400.1984 2336.5041,-1068.5997 2349.755,-981.1387"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2353.2405,-981.4953 2351.2569,-971.0878 2346.3173,-980.4607 2353.2405,-981.4953"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M947.4169,-1521.8912C954.4761,-1518.3686 961.2739,-1513.8113 966.4307,-1507.9605 989.683,-1481.5786 1135.4492,-933.6636 1152.5955,-902.9605 1169.6212,-872.4732 1197.5745,-843.1623 1216.5649,-825.1201"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1219.1632,-827.4831 1224.0968,-818.1071 1214.393,-822.36 1219.1632,-827.4831"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1059.5131,-1590.9605C1192.1772,-1626.2538 1221.0187,-1526.5769 1357.0291,-1507.9605 1422.7151,-1498.9697 1445.6668,-1480.921 1506.2007,-1507.9605 1678.4756,-1584.913 1771.7944,-1820.871 1796.7942,-1892.8761"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1793.5753,-1894.2823 1800.1056,-1902.6254 1800.2034,-1892.031 1793.5753,-1894.2823"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M936.7875,-1544.0393C966.1185,-1556.4495 1015.7218,-1576.6924 1059.5131,-1590.9605"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M950.2493,-1521.886C956.5854,-1518.4128 962.385,-1513.876 966.4307,-1507.9605 1008.7672,-1446.0577 986.1364,-907.1646 1002.4307,-833.9605 1012.403,-789.1588 1035.1441,-740.2018 1048.7205,-713.3805"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1051.9612,-714.7323 1053.4293,-704.2397 1045.7384,-711.5266 1051.9612,-714.7323"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M938.3853,-1521.9377C947.4997,-1517.9143 957.5843,-1513.0841 966.4307,-1507.9605 983.5095,-1498.0688 985.2945,-1491.7525 1002.4307,-1481.9605 1008.4895,-1478.4984 1015.1188,-1475.1938 1021.6466,-1472.1872"/>
<polygon fill="#005bff" stroke="#005bff" points="1023.3377,-1475.266 1031.0595,-1468.0118 1020.4993,-1468.8673 1023.3377,-1475.266"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M914.1211,-1544.0226C925.2973,-1584.9856 965.6719,-1731.8786 1002.4307,-1851.9605 1019.575,-1907.9671 1041.4296,-1973.4791 1052.4621,-2006.1783"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1049.247,-2007.5969 1055.7663,-2015.9486 1055.8781,-2005.3543 1049.247,-2007.5969"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1059.5131,-1590.9605C1228.1047,-1637.4716 1288.4341,-1618.533 1431.6149,-1718.9605"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-1721.9605C1264.8563,-1759.0256 1290.6781,-1748.7595 1321.0291,-1783.9605 1343.3593,-1809.8592 1340.7495,-1821.888 1357.0291,-1851.9605 1454.2679,-2031.5861 1574.9543,-2247.0427 1611.926,-2312.8846"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1608.9944,-2314.8122 1616.9435,-2321.8166 1615.0974,-2311.3838 1608.9944,-2314.8122"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-1590.9605C1086.1091,-1598.036 1095.451,-1597.3444 1116.5955,-1614.9605 1139.0415,-1633.661 1131.6662,-1649.5768 1152.5955,-1669.9605 1184.109,-1700.6526 1210.0141,-1687.0755 1236.8123,-1721.9605"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1236.8123,-1721.9605C1271.8716,-1768.2977 1299.3743,-1768.0406 1321.0291,-1821.9605 1367.7504,-1938.2958 1300.629,-2272.997 1357.0291,-2384.9605 1366.8731,-2404.5026 1385.7555,-2420.3559 1402.0573,-2431.2714"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1400.4591,-2434.4029 1410.7747,-2436.8196 1404.2177,-2428.4976 1400.4591,-2434.4029"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M921.8268,-1544.1337C952.3284,-1575.9482 1042.2239,-1669.7695 1116.5955,-1747.9605 1153.2237,-1786.4698 1195.9711,-1831.6975 1219.3419,-1856.4487"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1216.8068,-1858.862 1226.2166,-1863.7309 1221.8969,-1854.0566 1216.8068,-1858.862"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1308.6498,-379.966 1164.9747,-379.966 1164.9747,-357.9551 1308.6498,-357.9551 1308.6498,-379.966"/>
<text text-anchor="middle" x="1236.8123" y="-365.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1269.9059,-357.8432C1286.8554,-350.8259 1306.8507,-340.3378 1321.0291,-325.9605 1346.43,-300.2033 1326.5667,-272.4717 1357.0291,-252.9605 1623.4777,-82.3004 1759.2444,-168.0179 2068.7139,-233.9605"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1431.6149,-387.9605C1552.0381,-402.3117 1587.4769,-367.1176 1704.2205,-399.9605 1918.4162,-460.2192 1961.155,-521.8163 2122.5791,-674.9605 2216.6581,-764.214 2306.931,-892.0483 2339.7998,-940.4172"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2336.9281,-942.4188 2345.4252,-948.7474 2342.7293,-938.5012 2336.9281,-942.4188"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1308.63,-374.9171C1345.4607,-378.2373 1391.0011,-382.7521 1431.6149,-387.9605"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1273.9117,-380.0064C1305.3597,-389.3697 1350.6348,-402.8497 1384.6141,-412.9667"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1383.7393,-416.358 1394.3223,-415.8571 1385.7369,-409.649 1383.7393,-416.358"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1431.6149,-387.9605C1559.0777,-406.1151 1619.6287,-388.9008 1704.2205,-485.9605 1787.6972,-581.7409 1960.2982,-1470.27 1978.8486,-1595.9605 1990.4141,-1674.3238 1970.5552,-2242.2897 2014.8486,-2307.9605 2016.9618,-2311.0936 2019.5743,-2313.8421 2022.4996,-2316.2518"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2020.5962,-2319.1895 2030.8461,-2321.8707 2024.5053,-2313.3827 2020.5962,-2319.1895"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1241.5044,-380.0465C1256.6344,-416.4398 1304.1312,-535.8897 1321.0291,-639.9605 1336.5697,-735.6721 1315.2881,-2297.4396 1357.0291,-2384.9605 1366.4484,-2404.7108 1385.3344,-2420.5623 1401.7443,-2431.4249"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1400.1997,-2434.5877 1410.5303,-2436.9394 1403.921,-2428.6588 1400.1997,-2434.5877"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1061.1507,-681.6614C1069.117,-628.107 1105.3631,-400.296 1152.5955,-348.9605 1206.5033,-290.3697 1265.7669,-345.2757 1321.0291,-287.9605 1357.3206,-250.3208 1317.0267,-209.63 1357.0291,-175.9605 1437.5701,-108.1702 1823.329,-55.7453 1941.0359,-119.9605"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1078.8258,-681.8738C1111.8618,-664.4074 1181.0533,-634.388 1236.8123,-653.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1236.8123,-653.9605C1273.5354,-666.8511 1284.3131,-665.0493 1321.0291,-677.9605 1405.2738,-707.5855 1433.8934,-703.5536 1506.2007,-755.9605 1614.8748,-834.7255 1633.1214,-870.1233 1704.2205,-983.9605 1802.4367,-1141.2153 1803.867,-1193.7151 1867.2231,-1367.9605 1944.0732,-1579.3174 1890.0655,-1664.8595 2014.8486,-1851.9605 2049.3082,-1903.6296 2082.582,-1893.4486 2122.5791,-1940.9605 2143.3479,-1965.6315 2135.4761,-1981.4605 2158.5791,-2003.9605 2161.8474,-2007.1435 2165.6027,-2010.0331 2169.5325,-2012.6233"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2167.9054,-2015.7274 2178.293,-2017.8127 2171.4731,-2009.7047 2167.9054,-2015.7274"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1068.0312,-703.9978C1083.0811,-722.755 1116.239,-760.8645 1152.5955,-781.9605 1160.4424,-786.5138 1169.1897,-790.3008 1177.9953,-793.4319"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1176.9402,-796.7693 1187.5333,-796.5772 1179.1325,-790.1214 1176.9402,-796.7693"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1187.9605C1644.2648,-1219.0542 1679.7382,-1183.4875 1704.2205,-1211.9605 1780.278,-1300.4158 1668.083,-1380.2802 1740.2205,-1471.9605 1742.858,-1475.3126 1746.0095,-1478.2163 1749.4782,-1480.7314"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1747.6879,-1483.7389 1758.0552,-1485.923 1751.3127,-1477.7505 1747.6879,-1483.7389"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-845.9605C1485.3918,-912.7848 1475.3394,-943.9291 1506.2007,-1023.9605 1523.4973,-1068.8152 1513.9395,-1087.0707 1542.2007,-1125.9605 1568.8541,-1162.6378 1597.7899,-1150.4183 1623.2106,-1187.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-653.9605C1273.5354,-666.8511 1289.6527,-654.9327 1321.0291,-677.9605 1393.0942,-730.8507 1375.5712,-776.3196 1431.6149,-845.9605"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-653.9605C1277.1863,-666.3434 1295.3374,-664.4443 1321.0291,-697.9605 1365.9002,-756.4975 1340.7558,-788.0218 1357.0291,-859.9605 1422.2338,-1148.2101 1459.9218,-1216.074 1506.2007,-1507.9605 1534.6375,-1687.3153 1516.8915,-1735.1377 1542.2007,-1914.9605 1563.7801,-2068.2838 1604.2804,-2250.5449 1618.2921,-2311.7431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1614.936,-2312.7666 1620.5895,-2321.727 1621.7577,-2311.1968 1614.936,-2312.7666"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1115.5645,-695.4653C1177.2918,-701.5586 1274.0147,-721.6775 1321.0291,-786.9605 1372.9231,-859.0195 1318.7268,-2304.8454 1357.0291,-2384.9605 1366.4672,-2404.7018 1385.353,-2420.5535 1401.7581,-2431.4183"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1400.2111,-2434.5797 1410.541,-2436.9343 1403.9341,-2428.6518 1400.2111,-2434.5797"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1060.3593,-704.0666C1068.6605,-812.7834 1135.6015,-1684.1369 1152.5955,-1735.9605 1167.9313,-1782.7279 1201.4682,-1830.2974 1221.2824,-1855.8628"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1218.7232,-1858.2696 1227.6662,-1863.9505 1224.2178,-1853.9326 1218.7232,-1858.2696"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1061.2531,-1445.6675C1067.1789,-1411.1387 1089.8129,-1306.0436 1152.5955,-1251.9605 1182.083,-1226.5589 1205.0167,-1250.4061 1236.8123,-1227.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-1227.9605C1453.3966,-1075.0664 1490.513,-997.0199 1740.2205,-907.9605 1824.8834,-877.7651 1853.6426,-904.984 1941.0359,-883.9605"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1236.8123,-1227.9605C1341.4034,-1163.5025 1387.3592,-1197.1189 1506.2007,-1165.9605 1545.3589,-1155.6939 2165.6077,-951.2725 2205.1461,-959.9605"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1109.2077,-1452.5961C1168.2387,-1447.649 1269.7186,-1439.8919 1357.0291,-1436.9605 1423.2902,-1434.7359 1441.0656,-1424.5946 1506.2007,-1436.9605 1599.131,-1454.6035 1641.8508,-1443.8455 1704.2205,-1514.9605 1755.2641,-1573.1615 1791.2321,-1819.0931 1801.0357,-1892.9206"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1797.571,-1893.4188 1802.3371,-1902.8811 1804.512,-1892.5119 1797.571,-1893.4188"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1431.6149,-1718.9605C1466.4345,-1744.3726 1474.5517,-1751.6942 1506.2007,-1780.9605 1523.0461,-1796.5378 1525.8825,-1801.8318 1542.2007,-1817.9605 1562.9552,-1838.4742 1587.2823,-1861.4595 1603.8217,-1876.9329"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1601.5674,-1879.6165 1611.2658,-1883.8818 1606.3441,-1874.4995 1601.5674,-1879.6165"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1094.5546,-1468.0625C1102.3967,-1471.6489 1110.2585,-1476.2252 1116.5955,-1481.9605 1140.7924,-1503.8602 1129.0582,-1523.3534 1152.5955,-1545.9605 1213.2154,-1604.185 1250.2349,-1586.65 1321.0291,-1631.9605 1373.7006,-1665.672 1381.101,-1682.0945 1431.6149,-1718.9605"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1097.5965,-1468.0928C1104.6665,-1471.5911 1111.4381,-1476.1227 1116.5955,-1481.9605 1153.743,-1524.0094 1118.5834,-1558.3374 1152.5955,-1602.9605 1206.0703,-1673.1185 1247.3486,-1659.4539 1321.0291,-1707.9605 1337.2994,-1718.6719 1340.7071,-1722.328 1357.0291,-1732.9605 1422.1011,-1775.3501 1460.7933,-1760.9572 1506.2007,-1823.9605 1535.7184,-1864.9167 1602.4349,-2219.8428 1619.2869,-2311.4561"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1615.8829,-2312.2985 1621.1289,-2321.5034 1622.7681,-2311.0361 1615.8829,-2312.2985"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2352.8577,-2028.9605C2466.0045,-1618.4736 2482.4908,-1092.523 2484.7533,-981.2255"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2488.257,-981.0541 2484.9438,-970.9907 2481.2583,-980.9238 2488.257,-981.0541"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-1419.9605C1833.5595,-1424.4346 1842.6612,-1426.4386 1867.2231,-1443.9605 1935.9957,-1493.0212 2330.4092,-2110.4018 2352.8577,-2028.9605"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1803.7218,-1419.9605C1864.0756,-1429.0103 1880.0686,-1417.228 1941.0359,-1419.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1623.2106,-1414.9605C1702.5888,-1403.1098 1724.3511,-1408.0593 1803.7218,-1419.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1442.8812,-1516.9242C1470.6314,-1490.8078 1545.6765,-1426.5359 1623.2106,-1414.9605"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1488.247,-1539.0082C1495.1155,-1542.4741 1501.3904,-1547.0148 1506.2007,-1552.9605 1595.3855,-1663.1955 1451.6949,-1760.8075 1542.2007,-1869.9605 1545.7824,-1874.2802 1550.0941,-1877.8678 1554.8388,-1880.8455"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1553.3062,-1883.9942 1563.7827,-1885.573 1556.5774,-1877.8055 1553.3062,-1883.9942"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-1414.9605C1660.3502,-1409.4158 1671.5396,-1420.4657 1704.2205,-1438.9605 1723.1104,-1449.6508 1721.8135,-1460.4586 1740.2205,-1471.9605 1746.1612,-1475.6727 1752.7451,-1479.0037 1759.3581,-1481.9316"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1758.4185,-1485.331 1768.9964,-1485.9303 1761.101,-1478.8653 1758.4185,-1485.331"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.0511,-1539.0275C1494.2708,-1542.4848 1500.9635,-1547.0179 1506.2007,-1552.9605 1560.1425,-1614.1674 1501.3608,-1662.334 1542.2007,-1732.9605 1590.1323,-1815.8511 1663.5284,-1788.2862 1704.2205,-1874.9605 1767.8481,-2010.4878 1696.8346,-3078.6644 1740.2205,-3221.9605 1749.7455,-3253.4199 1771.8636,-3284.6881 1787.3016,-3303.9128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1784.7914,-3306.37 1793.8554,-3311.8558 1790.1907,-3301.9149 1784.7914,-3306.37"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2112.598,-705.966 2024.8298,-705.966 2024.8298,-683.9551 2112.598,-683.9551 2112.598,-705.966"/>
<text text-anchor="middle" x="2068.7139" y="-691.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2112.6456,-694.9605C2139.386,-694.9605 2174.2357,-694.9605 2205.1461,-694.9605"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2069.3343,-706.1172C2072.6535,-753.3111 2092.6936,-935.2507 2205.1461,-959.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2205.1461,-959.9605C2228.2733,-965.0424 2253.9337,-966.4583 2277.2912,-966.1917"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2277.5724,-969.6865 2287.4937,-965.9693 2277.4198,-962.6882 2277.5724,-969.6865"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M2071.427,-706.1628C2080.5965,-744.5779 2110.5296,-874.6364 2122.5791,-983.9605 2135.003,-1096.6818 2098.6591,-1907.6795 2158.5791,-2003.9605 2160.373,-2006.843 2162.6211,-2009.4145 2165.1546,-2011.7047"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2163.3037,-2014.687 2173.4428,-2017.761 2167.4337,-2009.0351 2163.3037,-2014.687"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-1989.9605C1313.7747,-1951.8842 1537.3443,-1989.9605 1623.2106,-1989.9605 1623.2106,-1989.9605 1623.2106,-1989.9605 1941.0359,-1989.9605 2058.4182,-1989.9605 2090.406,-1965.1955 2205.1461,-1989.9605"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1236.8123,-1989.9605C1271.4768,-1972.2651 1293.915,-1993.8817 1321.0291,-1965.9605 1366.3871,-1919.2523 1314.8503,-1873.5586 1357.0291,-1823.9605 1360.5196,-1819.856 2063.3503,-1515.4731 2068.7139,-1514.9605"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1431.6149,-1837.9605C1619.038,-1783.4224 1678.2874,-1844.9186 1867.2231,-1893.9605 1984.5203,-1924.4073 2115.7635,-1985.0226 2174.1962,-2013.5013"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2172.7436,-2016.6872 2183.2632,-2017.948 2175.826,-2010.4023 2172.7436,-2016.6872"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1236.8123,-1989.9605C1271.4768,-1972.2651 1291.4008,-1991.1979 1321.0291,-1965.9605 1349.7878,-1941.4637 1332.5711,-1917.7523 1357.0291,-1888.9605 1383.0279,-1858.3548 1392.8875,-1848.5831 1431.6149,-1837.9605"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1062.8837,-2015.5877C1073.1491,-1980.3761 1104.087,-1869.872 1116.5955,-1775.9605 1129.4131,-1679.728 1116.526,-993.0937 1152.5955,-902.9605 1165.4823,-870.7579 1194.0701,-842.062 1214.356,-824.6133"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1216.7708,-827.1567 1222.2053,-818.0618 1212.2853,-821.7826 1216.7708,-827.1567"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1431.6149,-1837.9605C1491.8233,-1820.4405 1562.4872,-1856.0477 1598.8534,-1878.5146"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1597.0157,-1881.4936 1607.3329,-1883.903 1600.7701,-1875.5856 1597.0157,-1881.4936"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1116.9009,-2018.278C1160.3983,-2011.0878 1216.1019,-2000.3943 1236.8123,-1989.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-1989.9605C1278.3211,-1969.0486 1296.8096,-1967.6305 1321.0291,-1927.9605 1373.343,-1842.2735 1296.4693,-1785.0325 1357.0291,-1704.9605 1383.9927,-1669.3093 1664.6797,-1553.2257 1766.8187,-1511.8096"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1768.1752,-1515.0364 1776.1312,-1508.0399 1765.5486,-1508.5479 1768.1752,-1515.0364"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1236.8123,-2407.9605C1275.6539,-2433.1785 1327.2721,-2442.9514 1367.6149,-2446.5413"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1367.3707,-2450.0328 1377.614,-2447.3264 1367.9187,-2443.0543 1367.3707,-2450.0328"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1064.255,-2037.9967C1090.6854,-2099.3973 1219.258,-2396.5634 1236.8123,-2407.9605"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1090.9352,-2015.8668C1099.6284,-2012.1019 1108.8073,-2007.4365 1116.5955,-2001.9605 1160.7756,-1970.8967 1201.6041,-1921.6806 1222.4058,-1894.5393"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1225.4392,-1896.33 1228.6685,-1886.2392 1219.8514,-1892.1137 1225.4392,-1896.33"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M758.7426,-1922.5067C769.1465,-1891.0563 801.9388,-1802.1117 855.7932,-1747.9605 949.0105,-1654.2297 1010.8388,-1684.273 1116.5955,-1604.9605 1134.6978,-1591.3846 1134.9403,-1583.1131 1152.5955,-1568.9605 1492.0723,-1296.8335 1634.7182,-1310.1782 1978.8486,-1043.9605 1984.4682,-1039.6132 2347.8173,-689.9532 2352.8577,-694.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2068.7139,-1514.9605C2132.0974,-1504.2635 2156.669,-1509.1728 2205.1461,-1466.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M788.6238,-1939.0917C897.8188,-1955.0273 1241.0924,-1998.6135 1321.0291,-1929.9605 1397.8559,-1863.9784 1289.6324,-1780.5495 1357.0291,-1704.9605 1465.9659,-1582.782 1907.3051,-1542.2009 2068.7139,-1514.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1236.8123,-2027.9605C1447.5855,-1984.7716 1507.5438,-2066.7312 1704.2205,-2153.9605 1752.286,-2175.2784 1751.492,-2211.8949 1803.7218,-2217.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1803.7218,-2217.9605C1864.1511,-2226.491 1889.0342,-2186.0184 1941.0359,-2217.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M756.37,-1922.6302C763.1961,-1862.0247 798.0692,-1576.5197 855.7932,-1512.9605 873.2705,-1493.7166 893.9624,-1513.4971 911.1119,-1493.9605"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M911.1119,-1493.9605C935.4744,-1466.207 947.0519,-1463.3969 966.4307,-1431.9605 1061.7242,-1277.3746 1061.7683,-1225.0837 1116.5955,-1051.9605 1137.1643,-987.012 1104.7333,-951.4435 1152.5955,-902.9605 1206.8736,-847.9783 1267.8521,-916.0085 1321.0291,-859.9605 1377.1821,-800.7758 1337.4746,-759.1667 1357.0291,-679.9605 1378.4797,-593.0734 1410.6486,-491.3964 1424.6686,-448.1513"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1428.0559,-449.0526 1427.8244,-438.4603 1421.3999,-446.885 1428.0559,-449.0526"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M756.516,-1922.5954C763.5789,-1865.864 797.5788,-1607.9536 855.7932,-1403.9605 905.4706,-1229.8829 904.6609,-1176.3152 1002.4307,-1023.9605 1060.1097,-934.0793 1163.6535,-856.6216 1211.4108,-823.7633"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1213.6217,-826.4925 1219.9222,-817.9747 1209.685,-820.7043 1213.6217,-826.4925"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M764.0931,-1945.0471C778.0765,-1962.9029 805.0141,-1999.6168 819.7932,-2034.9605 847.7453,-2101.807 822.6189,-2129.5459 855.7932,-2193.9605 889.6102,-2259.6229 935.4012,-2250.9358 966.4307,-2317.9605 1015.0708,-2423.0252 979.7646,-2462.4233 1002.4307,-2575.9605 1054.1394,-2834.9761 1028.2029,-2917.9598 1152.5955,-3150.9605 1179.1689,-3200.7355 1188.128,-3217.4379 1236.8123,-3245.9605"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1236.8123,-3245.9605C1258.6177,-3260.5173 1323.3337,-3271.1954 1372.24,-3277.4624"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1372.0584,-3280.9668 1382.4149,-3278.7325 1372.9255,-3274.0207 1372.0584,-3280.9668"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1059.5131,-2179.9605C1325.8728,-2285.7642 1442.1835,-2077.8632 1704.2205,-2193.9605 1725.4907,-2203.3845 1720.4523,-2219.6945 1740.2205,-2231.9605 1823.696,-2283.7569 1935.6815,-2310.706 2004.9719,-2323.3434"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2004.4183,-2326.7998 2014.8767,-2325.1053 2005.6443,-2319.908 2004.4183,-2326.7998"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M911.1119,-2065.9605C986.5121,-2101.0623 983.3713,-2146.498 1059.5131,-2179.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M758.103,-1922.7986C768.9081,-1882.7943 808.0107,-1743.1788 855.7932,-1633.9605 868.5331,-1604.8404 886.7847,-1572.9355 898.7885,-1552.9358"/>
<polygon fill="#00ffff" stroke="#00ffff" points="901.9314,-1554.5032 904.1278,-1544.1385 895.9473,-1550.8712 901.9314,-1554.5032"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M757.0002,-1922.9088C764.7604,-1876.9526 795.2084,-1696.4429 819.7932,-1547.9605 835.9777,-1450.2131 833.652,-1424.5331 855.7932,-1327.9605 906.9738,-1104.7283 926.786,-1050.1316 1002.4307,-833.9605 1017.6678,-790.4172 1038.6888,-740.6468 1050.5058,-713.4218"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1053.7595,-714.7166 1054.5529,-704.1515 1047.3442,-711.9159 1053.7595,-714.7166"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M911.1119,-1493.9605C923.0005,-1480.4171 964.0035,-1470.8337 999.904,-1464.8184"/>
<polygon fill="#005bff" stroke="#005bff" points="1000.5487,-1468.2598 1009.866,-1463.2161 999.4371,-1461.3486 1000.5487,-1468.2598"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M759.3389,-1922.7266C773.7954,-1886.2548 825.3365,-1772.8784 911.1119,-1761.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M911.1119,-2065.9605C931.0188,-2075.2015 986.7806,-2056.3892 1023.9937,-2041.8083"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1025.4939,-2044.9782 1033.4868,-2038.0238 1022.9016,-2038.4759 1025.4939,-2044.9782"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M767.4936,-1945.1445C780.8463,-1957.4197 802.5266,-1977.9197 819.7932,-1996.9605 836.9985,-2015.9337 835.4454,-2026.4052 855.7932,-2041.9605 877.0846,-2058.2372 886.8032,-2054.6761 911.1119,-2065.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M911.1119,-2065.9605C977.2064,-2096.6424 1166.171,-2045.8399 1236.8123,-2027.9605"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1236.8123,-2027.9605C1274.5166,-2018.3094 1290.6327,-2028.2673 1321.0291,-2003.9605 1347.1247,-1983.0928 1329.7535,-1957.2605 1357.0291,-1937.9605 1414.3454,-1897.4038 1495.8758,-1889.6109 1553.569,-1890.1112"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1553.6339,-1893.6127 1563.6928,-1890.2857 1553.7546,-1886.6138 1553.6339,-1893.6127"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-1875.9605C1088.1928,-1832.3122 1183.6903,-2014.9642 1321.0291,-1894.9605 1410.8658,-1816.4631 1287.5076,-1725.9103 1357.0291,-1628.9605 1383.8051,-1591.6205 1498.3931,-1550.8217 1542.2007,-1536.9605 1604.116,-1517.3698 1677.4121,-1507.2176 1730.6318,-1502.054"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1731.0322,-1505.5319 1740.6631,-1501.1166 1730.3808,-1498.5623 1731.0322,-1505.5319"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-2217.9605C1091.4932,-2230.4117 1092.0927,-2245.9319 1116.5955,-2269.9605 1133.2058,-2286.2495 1132.3743,-2296.4566 1152.5955,-2307.9605 1263.0954,-2370.8247 1306.8144,-2395.1883 1431.6149,-2370.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-2370.9605C1475.8743,-2363.8548 1525.5105,-2353.9555 1563.1702,-2346.0422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1563.9068,-2349.4639 1572.9669,-2343.9717 1562.4593,-2342.6152 1563.9068,-2349.4639"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M911.1119,-2179.9605C1014.9112,-2274.6443 1028.6,-2317.8965 1152.5955,-2383.9605 1186.9442,-2402.2613 1204.1689,-2386.7668 1236.8123,-2407.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M911.1119,-1875.9605C977.2174,-1859.6663 993.1942,-1822.5579 1059.5131,-1837.9605"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M779.4368,-1922.9345C809.6631,-1909.6907 863.1437,-1887.7841 911.1119,-1875.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-2217.9605C1330.3379,-2314.3517 1486.792,-2081.9121 1704.2205,-2269.9605 1865.961,-2409.8459 1929.1365,-3146.8442 1939.4734,-3282.4929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1936.0075,-3283.0804 1940.2438,-3292.7915 1942.988,-3282.5582 1936.0075,-3283.0804"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M759.8507,-1945.0421C776.1039,-1982.1919 833.0932,-2104.2358 911.1119,-2179.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2179.9605C929.3106,-2197.6241 941.8585,-2187.6834 966.4307,-2193.9605 1007.8243,-2204.5348 1018.935,-2204.5938 1059.5131,-2217.9605"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-2179.9605C1091.9,-2196.9472 1680.5637,-2285.0712 1704.2205,-2312.9605 1769.6053,-2390.0438 1710.3081,-3125.4087 1740.2205,-3221.9605 1749.9476,-3253.358 1772.0173,-3284.641 1787.3892,-3303.886"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1784.8641,-3306.3264 1793.9123,-3311.8384 1790.2763,-3301.887 1784.8641,-3306.3264"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M756.4759,-1945.2697C764.6193,-2012.8367 808.6171,-2363.4899 855.7932,-2459.9605 864.1858,-2477.1225 878.5136,-2493.2467 890.4846,-2504.8861"/>
<polygon fill="#ff0000" stroke="#ff0000" points="888.2332,-2507.5728 897.9249,-2511.8531 893.0177,-2502.4632 888.2332,-2507.5728"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1506.2866,-283.966 1356.9431,-283.966 1356.9431,-261.9551 1506.2866,-261.9551 1506.2866,-283.966"/>
<text text-anchor="middle" x="1431.6149" y="-269.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1461,-427.9605C2224.757,-440.5118 2235.9333,-434.8399 2251.7131,-451.9605 2330.9951,-537.9789 2270.9471,-611.4414 2352.8577,-694.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1506.3247,-275.5773C1561.1507,-277.7945 1637.3871,-281.4953 1704.2205,-286.9605 1890.7048,-302.2102 1956.6999,-247.398 2122.5791,-333.9605 2171.8764,-359.6858 2158.3112,-397.9855 2205.1461,-427.9605"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1505.967,-283.9907C1664.3506,-308.7679 2028.2633,-372.9033 2122.5791,-451.9605 2204.9544,-521.009 2317.6373,-852.3389 2346.1117,-939.1181"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2342.8647,-940.4501 2349.2942,-948.8711 2349.5194,-938.2786 2342.8647,-940.4501"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1451.0336,-284.0842C1468.298,-295.0258 1492.8176,-313.3521 1506.2007,-335.9605 1547.3154,-405.4166 1525.074,-435.0857 1542.2007,-513.9605 1609.7777,-825.1782 1649.467,-898.2327 1704.2205,-1211.9605 1727.6878,-1346.4246 1721.437,-1381.7626 1740.2205,-1516.9605 1760.253,-1661.149 1789.7915,-1833.8935 1800.0516,-1892.9671"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1796.6235,-1893.683 1801.7874,-1902.9342 1803.5197,-1892.482 1796.6235,-1893.683"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1452.6297,-284.0152C1470.4602,-294.6771 1494.8933,-312.6219 1506.2007,-335.9605 1559.1811,-445.3124 1529.7649,-1308.0883 1542.2007,-1428.9605 1560.036,-1602.3145 1603.9732,-1808.4997 1618.4786,-1873.9478"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1615.0964,-1874.8619 1620.6898,-1883.8599 1621.9284,-1873.3377 1615.0964,-1874.8619"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-934.966 -.2403,-934.966 -.2403,-912.9551 130.719,-912.9551 130.719,-934.966"/>
<text text-anchor="middle" x="65.2394" y="-920.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-4195.9605C1516.5524,-4189.8983 1538.0688,-4197.3798 1623.2106,-4195.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-923.9605C333.3936,-958.1849 385.9621,-883.559 480.9653,-947.9605 485.2202,-950.8449 550.3211,-1081.5524 575.6987,-1132.7224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="572.6381,-1134.4288 580.2148,-1141.8345 578.91,-1131.3203 572.6381,-1134.4288"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M911.1119,-9.9605C976.703,-2.9743 994.255,1.6507 1059.5131,-7.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M755.1332,-85.9605C832.2482,-86.0429 834.4306,-18.128 911.1119,-9.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1059.5131,-7.9605C1223.129,-32.0579 1267.6573,15.6907 1431.6149,-5.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M399.0839,-347.9605C505.7836,-397.5102 420.3314,-178.0566 516.9653,-110.9605 604.3916,-50.2577 648.6993,-85.8468 755.1332,-85.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1431.6149,-5.9605C1768.9609,-47.8683 1840.6688,-143.9995 2122.5791,-333.9605 2183.6912,-375.14 2215.5824,-373.7343 2251.7131,-437.9605 2311.2855,-543.8567 2264.4081,-589.714 2287.7131,-708.9605 2304.5895,-795.3131 2333.6657,-896.1061 2346.4785,-938.9629"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2343.1352,-939.999 2349.3683,-948.5663 2349.8383,-937.9819 2343.1352,-939.999"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M223.8406,-347.9605C288.3136,-304.2633 328.5163,-314.9995 399.0839,-347.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M66.4278,-912.4894C74.4843,-837.2916 123.8143,-415.7544 223.8406,-347.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M223.8406,-3513.9605C271.8776,-3564.4601 260.2638,-3599.7641 317.2024,-3639.9605 326.6877,-3646.6568 338.0085,-3651.5942 349.1614,-3655.2227"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="348.2872,-3658.6139 358.8689,-3658.0858 350.2674,-3651.8998 348.2872,-3658.6139"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1059.5131,-4195.9605C1224.1401,-4180.2126 1266.5441,-4206.046 1431.6149,-4195.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1431.6149,-4195.9605C1609.6545,-4185.9997 2030.5698,-3940.7074 2122.5791,-3787.9605 2169.7035,-3709.7281 2200.8005,-2244.5619 2204.7251,-2050.192"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2208.226,-2050.1783 2204.9272,-2040.1101 2201.2274,-2050.0379 2208.226,-2050.1783"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M223.8406,-923.9605C320.3907,-954.1228 381.5813,-1304.9262 395.8626,-1395.6499"/>
<polygon fill="#ffda00" stroke="#ffda00" points="392.4146,-1396.2559 397.4039,-1405.6024 399.3322,-1395.1845 392.4146,-1396.2559"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M755.1332,-85.9605C824.457,-86.0346 851.7267,-50.1946 911.1119,-85.9605"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M911.1119,-85.9605C941.3531,-104.1739 946.5994,-113.7548 966.4307,-142.9605 1023.097,-226.4135 973.2271,-297.7091 1059.5131,-349.9605"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1059.5131,-349.9605C1081.8574,-363.4914 1092.784,-353.2197 1116.5955,-363.9605 1134.3522,-371.9702 1135.5992,-379.443 1152.5955,-388.9605 1188.2663,-408.9354 1196.1742,-421.4936 1236.8123,-425.9605"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1236.8123,-425.9605C1275.8241,-430.2487 1319.496,-430.8547 1355.5871,-430.2356"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1356.1163,-433.7255 1366.0416,-430.0189 1355.9711,-426.727 1356.1163,-433.7255"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M585.7192,-3359.9605C643.1266,-3313.4946 630.7453,-3274.4033 690.4731,-3230.9605 695.647,-3227.1974 701.46,-3223.9191 707.4237,-3221.0866"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="709.0687,-3224.1882 716.8492,-3216.9969 706.2823,-3217.7667 709.0687,-3224.1882"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-3513.9605C428.766,-3491.2749 453.4425,-3520.2224 480.9653,-3494.9605 519.1738,-3459.8907 480.7024,-3421.0385 516.9653,-3383.9605 539.5955,-3360.8217 560.5619,-3380.3231 585.7192,-3359.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-3435.9605C733.6709,-3399.361 1104.3096,-3204.8596 1208.3204,-3147.1276"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1210.2476,-3150.0603 1217.2729,-3142.1296 1206.8353,-3143.9483 1210.2476,-3150.0603"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-3513.9605C257.6155,-3549.5783 271.9118,-3473.8849 317.2024,-3454.9605 351.6729,-3440.5572 362.1789,-3441.7651 399.0839,-3435.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1059.5131,-4195.9605C1210.3382,-4179.979 1570.1741,-4042.9198 1704.2205,-3971.9605 1848.1022,-3895.7948 1996.9741,-3766.2245 2049.2088,-3718.9246"/>
<polygon fill="#48ff00" stroke="#48ff00" points="2051.7095,-3721.3811 2056.7468,-3712.0604 2046.9964,-3716.2054 2051.7095,-3721.3811"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M585.7192,-4195.9605C794.2214,-4225.434 849.3391,-4208.9503 1059.5131,-4195.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M911.1119,-85.9605C941.3197,-104.2291 950.5702,-111.4217 966.4307,-142.9605 1011.1411,-231.8682 937.9041,-288.1982 1002.4307,-363.9605 1037.1049,-404.6725 1082.473,-360.7849 1116.5955,-401.9605 1192.7182,-493.8181 1112.8526,-555.475 1152.5955,-667.9605 1168.9915,-714.3668 1202.1438,-762.0673 1221.6053,-787.7528"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1218.9924,-790.0962 1227.8681,-795.8818 1224.5375,-785.824 1218.9924,-790.0962"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M399.0839,-3435.9605C472.809,-3424.3646 650.0616,-3531.8167 654.4731,-3535.9605 678.8275,-3558.8365 661.7411,-3584.9043 690.4731,-3601.9605 739.8963,-3631.2998 763.586,-3613.9686 819.7932,-3601.9605 978.2766,-3568.1022 1003.8873,-3517.3752 1152.5955,-3452.9605 1396.4927,-3347.3136 1553.0933,-3440.6103 1704.2205,-3221.9605 1736.3972,-3175.4075 1733.1393,-2260.1067 1740.2205,-2203.9605 1753.1141,-2101.7279 1784.5986,-1982.3029 1797.7724,-1934.8909"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1801.1698,-1935.7382 1800.5002,-1925.1645 1794.4298,-1933.8479 1801.1698,-1935.7382"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M585.7192,-3815.9605C685.1013,-3846.9643 894.3987,-3618.1232 966.4307,-3542.9605 986.645,-3521.8676 979.8452,-3506.4924 1002.4307,-3487.9605 1044.7206,-3453.2607 1073.218,-3475.2909 1116.5955,-3441.9605 1137.7408,-3425.7129 1131.6213,-3410.4286 1152.5955,-3393.9605 1184.612,-3368.8224 1198.5819,-3371.9397 1236.8123,-3357.9605"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M399.0839,-3625.9605C431.4103,-3644.6867 450.6598,-3623.1146 480.9653,-3644.9605 553.2654,-3697.0785 500.6366,-3789.4177 585.7192,-3815.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M911.1119,-4119.9605C1336.3082,-3958.862 1598.5152,-4122.7584 1867.2231,-3755.9605 2040.747,-3519.093 2065.514,-2514.9734 2068.3797,-2354.5997"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2071.8864,-2354.2277 2068.5557,-2344.1701 2064.8874,-2354.1096 2071.8864,-2354.2277"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M755.1332,-85.9605C808.5014,-86.0175 862.5164,-122.6882 890.8539,-145.396"/>
<polygon fill="#00ffc8" stroke="#00ffc8" points="888.8514,-148.2811 898.7948,-151.939 893.3028,-142.8787 888.8514,-148.2811"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-347.9605C433.2911,-362.9782 445.5653,-355.023 480.9653,-366.9605 561.0812,-393.977 606.7961,-375.1369 654.4731,-444.9605 744.9354,-577.4435 591.1753,-1039.9641 690.4731,-1165.9605 727.5535,-1213.0108 781.1353,-1158.1976 819.7932,-1203.9605 907.5915,-1307.8955 775.4056,-1398.1933 855.7932,-1507.9605 858.0758,-1511.0773 860.8389,-1513.8141 863.8981,-1516.2159"/>
<polygon fill="#00ffff" stroke="#00ffff" points="862.2639,-1519.3272 872.561,-1521.8216 866.0669,-1513.4503 862.2639,-1519.3272"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M911.1119,-9.9605C1094.1313,-19.7076 1201.475,-272.6987 1229.4421,-348.0052"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1226.2877,-349.5727 1232.9919,-357.7766 1232.8669,-347.1825 1226.2877,-349.5727"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M585.7192,-273.9605C658.947,-291.5057 679.8329,-275.8676 755.1332,-275.9605"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-347.9605C452.4722,-372.5713 461.4618,-307.335 516.9653,-287.9605 546.4075,-277.6832 555.3932,-266.6945 585.7192,-273.9605"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M755.1332,-275.9605C882.0223,-276.1171 893.4557,-364.1553 966.4307,-467.9605 1013.7435,-535.2619 1042.9142,-630.2652 1054.1841,-671.9598"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1050.845,-673.024 1056.7767,-681.8026 1057.6141,-671.2409 1050.845,-673.024"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M585.7192,-273.9605C731.249,-308.8292 648.6647,-450.2706 690.4731,-593.9605 792.5967,-944.9457 999.1134,-1343.4724 1048.653,-1436.7157"/>
<polygon fill="#005bff" stroke="#005bff" points="1045.6369,-1438.498 1053.4304,-1445.6752 1051.8137,-1435.2045 1045.6369,-1438.498"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M1431.6149,-5.9605C1784.4797,-116.4308 2012.4191,-572.5554 2059.5987,-674.6324"/>
<polygon fill="#1200ff" stroke="#1200ff" points="2056.4791,-676.2268 2063.8178,-683.8684 2062.8462,-673.3182 2056.4791,-676.2268"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M399.0839,-347.9605C433.0113,-363.6002 457.2345,-338.1072 480.9653,-366.9605 556.1756,-458.4056 470.2254,-1323.1756 516.9653,-1431.9605 527.5547,-1456.6067 835.7481,-1758.1347 855.7932,-1775.9605 902.333,-1817.3476 925.7475,-1814.8041 966.4307,-1861.9605 1005.9788,-1907.8013 1036.7797,-1973.0296 1050.9649,-2006.0626"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1047.8704,-2007.7326 1054.9766,-2015.5909 1054.3219,-2005.0163 1047.8704,-2007.7326"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-923.9605C405.4597,-981.3369 199.397,-1626.2961 317.2024,-1775.9605 415.5424,-1900.8954 621.3266,-1927.1196 711.3696,-1932.5654"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="711.3307,-1936.0684 721.5068,-1933.1194 711.7128,-1929.0788 711.3307,-1936.0684"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1236.8123,-121.9605C1301.5549,-167.734 1374.633,-226.3546 1410.0605,-255.2434"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1408.2712,-258.3013 1418.2284,-261.9214 1412.702,-252.8821 1408.2712,-258.3013"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-2039.966 180.0456,-2039.966 180.0456,-2017.9551 267.6355,-2017.9551 267.6355,-2039.966"/>
<text text-anchor="middle" x="223.8406" y="-2025.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M66.8608,-935.257C82.0989,-1041.4238 200.0662,-1863.3206 220.7501,-2007.4286"/>
<polygon fill="#ff00a3" stroke="#ff00a3" points="217.3272,-2008.2163 222.2125,-2017.6176 224.2562,-2007.2217 217.3272,-2008.2163"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1236.8123,-121.9605C1312.6698,-175.5923 1287.6617,-231.1632 1357.0291,-292.9605 1413.3596,-343.1438 1466.5287,-309.7918 1506.2007,-373.9605 1537.0399,-423.8424 1536.1642,-1370.6268 1542.2007,-1428.9605 1560.1387,-1602.3039 1604.0083,-1808.496 1618.4876,-1873.9469"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1615.1049,-1874.8591 1620.6947,-1883.8594 1621.9376,-1873.3377 1615.1049,-1874.8591"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M65.5094,-935.0484C69.929,-1114.5108 128.3648,-3413.5904 223.8406,-3513.9605"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M223.8406,-3513.9605C316.8719,-3611.7609 229.3502,-3327.4385 317.2024,-3224.9605 373.6591,-3159.1049 470.0276,-3121.8505 530.6624,-3103.8226"/>
<polygon fill="#ff0036" stroke="#ff0036" points="531.8126,-3107.1334 540.4437,-3100.9889 529.8647,-3100.4099 531.8126,-3107.1334"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-121.9605C1346.1828,-197.8733 1400.9848,-171.3867 1506.2007,-252.9605 1533.0515,-273.7779 1691.8968,-454.2989 1704.2205,-485.9605 1780.6891,-682.4217 1655.4794,-1240.9232 1740.2205,-1433.9605 1748.2848,-1452.3307 1764.3812,-1468.2039 1778.3495,-1479.4221"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1776.6094,-1482.4972 1786.6809,-1485.7861 1780.8587,-1476.9344 1776.6094,-1482.4972"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-7.9605C1152.1962,-21.6109 1160.461,-67.6744 1236.8123,-121.9605"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459.7908,-397.966 338.377,-397.966 338.377,-375.9551 459.7908,-375.9551 459.7908,-397.966"/>
<text text-anchor="middle" x="399.0839" y="-383.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-347.9605C234.5216,-340.7213 304.7076,-359.1652 352.9487,-373.0953"/>
<polygon fill="#00ffff" stroke="#00ffff" points="352.0003,-376.4644 362.5801,-375.9002 353.9577,-369.7436 352.0003,-376.4644"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4043.9605C688.1601,-4012.8078 721.766,-4030.0336 819.7932,-3986.9605 989.3872,-3912.4411 1417.9227,-3676.8171 1506.2007,-3513.9605 1567.4406,-3400.9842 1464.2974,-2460.1616 1542.2007,-2357.9605 1544.5708,-2354.8512 1547.3212,-2352.1179 1550.3475,-2349.7162"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1552.4777,-2352.5052 1558.9309,-2344.1024 1548.6461,-2346.6469 1552.4777,-2352.5052"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-3513.9605C287.4431,-3581.0334 318.8568,-3580.0514 399.0839,-3625.9605"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-3625.9605C439.7221,-3649.2153 778.859,-3624.6903 819.7932,-3601.9605 1018.9908,-3491.3508 999.882,-3379.6443 1116.5955,-3183.9605 1135.126,-3152.8919 1134.1199,-3142.0619 1152.5955,-3110.9605 1218.9643,-2999.2365 1273.5573,-2992.9296 1321.0291,-2871.9605 1364.7711,-2760.4957 1322.9309,-2719.7433 1357.0291,-2604.9605 1372.3929,-2553.2422 1402.6763,-2497.1859 1419.546,-2468.0768"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1422.6644,-2469.6784 1424.7118,-2459.2832 1416.6288,-2466.1326 1422.6644,-2469.6784"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-475.966 539.0902,-475.966 539.0902,-453.9551 632.3482,-453.9551 632.3482,-475.966"/>
<text text-anchor="middle" x="585.7192" y="-461.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-923.9605C396.3124,-978.2858 189.2706,-655.7542 317.2024,-527.9605 324.7707,-520.4003 452.649,-492.6896 529.1603,-476.6493"/>
<polygon fill="#00ff66" stroke="#00ff66" points="530.068,-480.0353 539.1397,-474.5623 528.635,-473.1836 530.068,-480.0353"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-3513.9605C428.766,-3491.2749 457.2576,-3523.8329 480.9653,-3494.9605 559.8374,-3398.9066 472.2536,-2492.9261 516.9653,-2376.9605 526.7167,-2351.6692 547.9284,-2328.7232 564.2299,-2313.7639"/>
<polygon fill="#0066ff" stroke="#0066ff" points="566.6025,-2316.3379 571.7662,-2307.0866 561.9604,-2311.0985 566.6025,-2316.3379"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-3513.9605C237.2607,-3528.0686 383.6134,-3525.7844 399.0839,-3513.9605"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.3078,-3485.966 341.8599,-3485.966 341.8599,-3463.9551 456.3078,-3463.9551 456.3078,-3485.966"/>
<text text-anchor="middle" x="399.0839" y="-3471.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-3513.9605C232.8593,-3523.4415 305.4545,-3503.7018 354.3357,-3488.998"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="355.5204,-3492.2961 364.0723,-3486.0419 353.4868,-3485.598 355.5204,-3492.2961"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-3563.966 334.3841,-3563.966 334.3841,-3541.9551 463.7837,-3541.9551 463.7837,-3563.966"/>
<text text-anchor="middle" x="399.0839" y="-3549.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-3513.9605C249.3559,-3540.7838 288.9184,-3551.1122 324.0007,-3554.4778"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.9983,-3557.9882 334.2411,-3555.2801 324.5451,-3551.0096 323.9983,-3557.9882"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-3255.966 344.7839,-3255.966 344.7839,-3233.9551 453.3838,-3233.9551 453.3838,-3255.966"/>
<text text-anchor="middle" x="399.0839" y="-3241.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-3513.9605C244.4854,-3535.6637 354.0243,-3331.2445 388.6106,-3265.1527"/>
<polygon fill="#00ff66" stroke="#00ff66" points="391.8019,-3266.6024 393.3223,-3256.1172 385.5951,-3263.3657 391.8019,-3266.6024"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M755.1332,-1837.9605C823.3616,-1850.2359 842.2454,-1830.0103 911.1119,-1837.9605"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-923.9605C350.3622,-964.8403 250.5258,-1399.9253 317.2024,-1514.9605 413.6315,-1681.3268 513.0755,-1655.6416 654.4731,-1785.9605 671.5801,-1801.7271 670.2014,-1812.5461 690.4731,-1823.9605 716.0944,-1838.3871 726.1941,-1832.7539 755.1332,-1837.9605"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-1505.966 353.1239,-1505.966 353.1239,-1483.9551 445.0438,-1483.9551 445.0438,-1505.966"/>
<text text-anchor="middle" x="399.0839" y="-1491.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-923.9605C458.8295,-997.371 154.516,-1285.1849 317.2024,-1469.9605 324.1246,-1477.8226 333.4412,-1483.2506 343.3093,-1486.9888"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.2874,-1490.3368 352.8792,-1490.0794 344.4387,-1483.6755 342.2874,-1490.3368"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-475.966 168.8556,-475.966 168.8556,-453.9551 278.8255,-453.9551 278.8255,-475.966"/>
<text text-anchor="middle" x="223.8406" y="-461.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M69.1599,-912.6144C90.1142,-851.9717 188.9731,-565.8688 216.6335,-485.8181"/>
<polygon fill="#ff0000" stroke="#ff0000" points="219.9573,-486.9157 219.9151,-476.3209 213.3411,-484.6295 219.9573,-486.9157"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-475.966 340.6161,-475.966 340.6161,-453.9551 457.5516,-453.9551 457.5516,-475.966"/>
<text text-anchor="middle" x="399.0839" y="-461.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-923.9605C412.1663,-982.7935 183.7019,-635.2379 317.2024,-489.9605 321.2613,-485.5435 326.0756,-481.8978 331.3062,-478.8901"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.0065,-481.9545 340.442,-474.407 329.9227,-475.6703 333.0065,-481.9545"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M130.6151,-915.2756C159.7595,-913.5953 194.1416,-914.6826 223.8406,-923.9605"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-3967.9605C1379.9817,-3761.1262 1658.9393,-3997.489 1867.2231,-3677.9605 1905.9944,-3618.4815 1931.6246,-3395.9952 1938.9071,-3325.5166"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1942.425,-3325.5157 1939.9518,-3315.2136 1935.4607,-3324.8094 1942.425,-3325.5157"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-4119.9605C1002.8942,-4097.8254 976.8506,-4013.577 1059.5131,-3967.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4195.9605C622.7191,-4199.0396 875.0189,-4128.6651 911.1119,-4119.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4119.9605C470.6724,-4173.7803 497.0381,-4183.4247 585.7192,-4195.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-3967.9605C1121.3102,-3933.8583 1656.8882,-3519.3611 1704.2205,-3468.9605 1742.1407,-3428.5821 1776.0748,-3372.5198 1792.777,-3342.9935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1795.9462,-3344.4967 1797.7615,-3334.0586 1789.8331,-3341.0864 1795.9462,-3344.4967"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1489.018,-3504.966 1374.2118,-3504.966 1374.2118,-3482.9551 1489.018,-3482.9551 1489.018,-3504.966"/>
<text text-anchor="middle" x="1431.6149" y="-3490.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-3513.9605C416.7583,-3717.4044 174.9818,-3951.4822 399.0839,-4119.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4119.9605C470.6724,-4173.7803 500.2546,-4070.7427 585.7192,-4043.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4043.9605C869.6134,-3954.9961 910.33,-3860.6394 1152.5955,-3687.9605 1245.9933,-3621.3896 1358.4402,-3544.0529 1407.1472,-3510.6892"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1409.2068,-3513.5209 1415.4811,-3504.9837 1405.2524,-3507.7448 1409.2068,-3513.5209"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1309.3977,-3483.966 1164.2268,-3483.966 1164.2268,-3461.9551 1309.3977,-3461.9551 1309.3977,-3483.966"/>
<text text-anchor="middle" x="1236.8123" y="-3469.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-3815.9605C836.7774,-3890.0164 941.8393,-3755.8316 1116.5955,-3560.9605 1138.1262,-3536.9516 1127.3201,-3517.9895 1152.5955,-3497.9605 1157.5375,-3494.0443 1163.0798,-3490.741 1168.8996,-3487.9547"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1170.3942,-3491.1225 1178.227,-3483.9881 1167.6548,-3484.6808 1170.3942,-3491.1225"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3359.9605C633.6556,-3321.1605 636.8965,-3299.5036 690.4731,-3268.9605 743.0928,-3238.963 782.4273,-3273.6309 819.7932,-3225.9605 881.6812,-3147.0056 841.0451,-2875.19 855.7932,-2775.9605 868.7113,-2689.044 894.1463,-2587.3825 905.4578,-2544.1463"/>
<polygon fill="#ff0000" stroke="#ff0000" points="908.8471,-2545.0194 908.013,-2534.4574 902.0786,-2543.2342 908.8471,-2545.0194"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-665.966 323.0941,-665.966 323.0941,-643.9551 475.0737,-643.9551 475.0737,-665.966"/>
<text text-anchor="middle" x="399.0839" y="-651.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-923.9605C334.6702,-958.5837 232.3113,-759.1783 317.2024,-679.9605 321.0431,-676.3765 325.3841,-673.3055 330.014,-670.6743"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.7962,-673.698 339.218,-666.1371 328.701,-667.4194 331.7962,-673.698"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-624.966 317.3208,-624.966 317.3208,-602.9551 480.847,-602.9551 480.847,-624.966"/>
<text text-anchor="middle" x="399.0839" y="-610.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-923.9605C352.6804,-964.2101 218.8715,-727.4309 317.2024,-634.9605 318.9397,-633.3268 320.7863,-631.8159 322.7214,-630.4187"/>
<polygon fill="#00ffff" stroke="#00ffff" points="324.9558,-633.1582 331.7081,-624.9938 321.3382,-627.1655 324.9558,-633.1582"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1321.2464,-933.966 1152.3781,-933.966 1152.3781,-911.9551 1321.2464,-911.9551 1321.2464,-933.966"/>
<text text-anchor="middle" x="1236.8123" y="-919.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1298.5149,-911.7863C1306.9952,-907.955 1314.8852,-902.8251 1321.0291,-895.9605 1374.8571,-835.8181 1296.256,-771.0756 1357.0291,-717.9605 1577.6355,-525.1526 1722.0164,-684.5212 2014.8486,-674.9605 2062.7033,-673.3981 2075.0365,-669.2845 2122.5791,-674.9605 2160.0705,-679.4365 2167.3884,-694.9605 2205.1461,-694.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1461,-694.9605C2270.7798,-693.518 2306.89,-648.0901 2352.8577,-694.9605"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1240.3597,-933.9779C1263.5713,-1006.0663 1393.7926,-1410.4957 1424.9275,-1507.1916"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1421.6039,-1508.2892 1428.0004,-1516.7352 1428.267,-1506.1437 1421.6039,-1508.2892"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-693.9605C425.8802,-662.3047 545.8426,-705.3618 585.7192,-693.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-693.9605C620.3721,-684.0528 631.0825,-678.3806 654.4731,-650.9605 681.099,-619.7479 658.8917,-592.1478 690.4731,-565.9605 748.359,-517.9617 781.1066,-538.7112 855.7932,-529.9605 1230.3767,-486.0721 1328.3006,-544.3448 1704.2205,-513.9605 1891.4496,-498.8274 1939.4221,-495.641 2122.5791,-453.9605 2160.0929,-445.4236 2172.6412,-407.3791 2205.1461,-427.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-961.9605C470.6233,-894.4111 551.8129,-1070.1193 577.4887,-1132.1887"/>
<polygon fill="#ff0000" stroke="#ff0000" points="574.3673,-1133.8045 581.3748,-1141.751 580.8522,-1131.169 574.3673,-1133.8045"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M399.0839,-2390.9605C464.3016,-2424.1853 450.2274,-2306.0153 516.9653,-2275.9605 760.6169,-2166.2345 856.1469,-2291.7306 1116.5955,-2231.9605 1562.9569,-2129.5256 1726.0663,-2141.8094 2068.7139,-1837.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M224.7721,-2040.0379C229.8822,-2092.6584 259.635,-2317.8471 399.0839,-2390.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M224.4748,-2040.0932C232.5745,-2182.2392 315.5556,-3637.8655 317.2024,-3639.9605 325.03,-3649.9187 336.7198,-3656.0173 348.8329,-3659.7225"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="348.0175,-3663.1265 358.5725,-3662.2088 349.749,-3656.344 348.0175,-3663.1265"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M585.7192,-2390.9605C632.4356,-2386.6543 643.6481,-2380.8549 690.4731,-2377.9605 747.8392,-2374.4145 762.3682,-2375.5491 819.7932,-2377.9605 968.0972,-2384.1882 1004.2915,-2399.7328 1152.5955,-2405.9605 1227.3889,-2409.1013 1246.1951,-2407.9121 1321.0291,-2405.9605 1491.5102,-2401.5146 1538.8431,-2427.6009 1704.2205,-2385.9605 1721.3791,-2381.6401 1723.6312,-2375.1153 1740.2205,-2368.9605 1810.6828,-2342.8181 1829.9509,-2340.6803 1903.2231,-2323.9605 1939.6616,-2315.6457 2036.1167,-2312.245 2068.7139,-2293.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M399.0839,-2390.9605C472.9944,-2428.6138 502.8062,-2393.4055 585.7192,-2390.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M399.0839,-693.9605C424.5552,-666.6314 447.9147,-692.3767 480.9653,-674.9605 500.1675,-664.8419 500.8011,-656.446 516.9653,-641.9605 555.1397,-607.7506 646.5334,-516.3594 690.4731,-489.9605 765.659,-444.7892 985.3006,-303.2073 1059.5131,-349.9605"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M224.4496,-2017.8999C230.0077,-1917.8937 272.7479,-1168.392 317.2024,-947.9605 340.6504,-831.6916 322.451,-784.4905 399.0839,-693.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M223.9924,-2040.0895C225.604,-2150.959 241.0436,-3054.7089 317.2024,-3142.9605 397.2888,-3235.7635 490.6,-3128.6393 585.7192,-3205.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-2504.9605C636.3738,-2529.4033 643.5887,-2544.8932 690.4731,-2575.9605 878.5687,-2700.5994 970.9835,-2679.5889 1116.5955,-2851.9605 1185.4184,-2933.4313 1220.5217,-3060.2664 1232.2353,-3109.9725"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1228.8578,-3110.9039 1234.4961,-3119.8739 1235.6821,-3109.3456 1228.8578,-3110.9039"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M225.5902,-2040.2642C234.3757,-2096.0198 274.9317,-2341.5937 317.2024,-2404.9605 482.5206,-2652.7846 606.3353,-2641.1181 855.7932,-2803.9605 967.579,-2876.9326 1039.4875,-2843.9864 1116.5955,-2952.9605 1168.2583,-3025.9739 1089.4743,-3087.5909 1152.5955,-3150.9605 1160.7479,-3159.145 1345.6639,-3186.8916 1357.0291,-3188.9605 1439.2726,-3203.9324 1459.6561,-3208.7492 1542.2007,-3221.9605 1638.9752,-3237.4494 1911.258,-3212.9907 1978.8486,-3283.9605 2038.7204,-3346.8256 1966.4153,-3600.913 2014.8486,-3672.9605 2017.8226,-3677.3845 2021.7241,-3681.1534 2026.0704,-3684.3533"/>
<polygon fill="#48ff00" stroke="#48ff00" points="2024.5127,-3687.5066 2034.85,-3689.8283 2028.2167,-3681.5669 2024.5127,-3687.5066"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M585.7192,-883.9605C634.6258,-866.3579 642.7636,-852.5882 690.4731,-831.9605 746.7457,-807.6305 765.7129,-812.8374 819.7932,-783.9605 837.2032,-774.6642 837.014,-764.0329 855.7932,-757.9605 902.5802,-742.8317 917.4559,-753.5586 966.4307,-757.9605 1041.1302,-764.6746 1126.0535,-781.6222 1180.4708,-793.702"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1179.744,-797.1258 1190.2674,-795.8973 1181.2748,-790.2952 1179.744,-797.1258"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M399.0839,-961.9605C464.4507,-900.2394 501.1298,-914.4063 585.7192,-883.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M399.0839,-2028.9605C808.2212,-2060.5575 922.4289,-2176.4776 1321.0291,-2078.9605 1491.7963,-2037.1825 1687.9661,-1960.9834 1767.4621,-1928.8661"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1769.0595,-1931.9952 1777.0108,-1924.9932 1766.4285,-1925.5085 1769.0595,-1931.9952"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M755.1332,-2860.9605C791.4458,-2862.0007 793.8946,-2885.486 819.7932,-2910.9605 838.0529,-2928.9212 838.0278,-2937.5108 855.7932,-2955.9605 938.7865,-3042.1505 984.5646,-3038.6903 1059.5131,-3131.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M585.7192,-3050.9605C691.0797,-3068.8366 735.1958,-3061.2571 819.7932,-2995.9605 846.8637,-2975.0662 827.0886,-2946.5463 855.7932,-2927.9605 1210.1924,-2698.4925 1386.9061,-2933.184 1803.7218,-2865.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M399.0839,-541.9605C425.8622,-506.6185 447.8768,-514.4781 480.9653,-484.9605 486.4069,-480.1062 650.2526,-293.9071 654.4731,-287.9605 673.3621,-261.3467 664.7729,-244.0748 690.4731,-223.9605 740.1863,-185.0527 813.1536,-170.9432 861.3775,-165.8377"/>
<polygon fill="#00ffc8" stroke="#00ffc8" points="861.9569,-169.2981 871.5742,-164.853 861.284,-162.3305 861.9569,-169.2981"/>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M224.4311,-2017.6811C231.3931,-1885.0367 297.9112,-626.5125 317.2024,-593.9605 339.181,-556.8738 374.5608,-577.4162 399.0839,-541.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1761.9605C566.2231,-1664.2843 782.5481,-1580.2147 870.8773,-1547.5213"/>
<polygon fill="#00ffff" stroke="#00ffff" points="872.089,-1550.8049 880.2621,-1544.0631 869.6687,-1544.2367 872.089,-1550.8049"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.0446,-2017.8669C240.0094,-1975.2797 293.0352,-1821.6759 399.0839,-1761.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M399.0839,-541.9605C403.2186,-535.9824 648.7334,-489.4203 654.4731,-484.9605 682.411,-463.2527 664.8576,-438.3654 690.4731,-413.9605 748.7562,-358.432 777.3051,-357.8478 855.7932,-339.9605 919.3598,-325.4738 937.2403,-336.8495 1002.4307,-335.9605 1053.1659,-335.2687 1066.3101,-329.1841 1116.5955,-335.9605 1143.5007,-339.5863 1172.9023,-347.5818 1195.8941,-354.7944"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1195.06,-358.2025 1205.6512,-357.9282 1197.2006,-351.5378 1195.06,-358.2025"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M585.7192,-693.9605C727.2482,-656.9871 900.7793,-670.8992 993.5557,-682.842"/>
<polygon fill="#0091ff" stroke="#0091ff" points="993.2709,-686.3347 1003.6431,-684.1741 994.1874,-679.395 993.2709,-686.3347"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M399.0839,-1455.9605C414.9791,-1430.7724 840.2676,-1447.137 999.8115,-1454.1902"/>
<polygon fill="#005bff" stroke="#005bff" points="999.783,-1457.6923 1009.9289,-1454.6408 1000.0945,-1450.6992 999.783,-1457.6923"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M399.0839,-1761.9605C596.171,-1648.1895 685.3653,-1790.6946 911.1119,-1761.9605"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M911.1119,-1761.9605C1002.0274,-1751.3055 1038.1746,-1823.1763 1116.5955,-1775.9605 1145.8916,-1758.3219 1130.7284,-1734.2515 1152.5955,-1707.9605 1171.1283,-1685.6783 1330.9759,-1558.6569 1357.0291,-1545.9605 1359.611,-1544.7023 1362.2872,-1543.5282 1365.0234,-1542.4332"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1366.292,-1545.6964 1374.5079,-1539.0069 1363.9136,-1539.1128 1366.292,-1545.6964"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M399.0839,-961.9605C500.1997,-873.8588 868.3429,-950.5683 1002.4307,-947.9605 1011.28,-947.7884 1314.1174,-948.4895 1321.0291,-942.9605 1374.2291,-900.4031 1308.6578,-841.9356 1357.0291,-793.9605 1443.2735,-708.4224 1501.7409,-731.9605 1623.2106,-731.9605 1623.2106,-731.9605 1623.2106,-731.9605 1803.7218,-731.9605 1877.2541,-731.9605 1961.1707,-717.8133 2014.5136,-707.0147"/>
<polygon fill="#1200ff" stroke="#1200ff" points="2015.346,-710.4169 2024.4354,-704.9733 2013.9352,-703.5605 2015.346,-710.4169"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M399.0839,-2028.9605C440.6271,-2032.1688 545.1451,-2020.4407 585.7192,-2010.9605"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M267.8445,-2027.0876C303.3296,-2026.028 354.4931,-2025.5169 399.0839,-2028.9605"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M585.7192,-2010.9605C647.507,-1996.5237 631.3957,-1937.1122 690.4731,-1913.9605 743.9863,-1892.9895 765.5898,-1894.8441 819.7932,-1913.9605 839.1691,-1920.794 838.1143,-1932.4925 855.7932,-1942.9605 907.4055,-1973.5212 972.2121,-1998.1561 1014.6919,-2012.6605"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1013.6014,-2015.9864 1024.1955,-2015.8636 1015.8371,-2009.353 1013.6014,-2015.9864"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-2010.9605C636.3339,-1999.1343 642.9041,-1979.9103 690.4731,-1958.9605 698.4691,-1955.439 707.1296,-1951.9044 715.4349,-1948.6473"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="716.8927,-1951.8363 724.9603,-1944.9686 714.3708,-1945.3064 716.8927,-1951.8363"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M399.0839,-1455.9605C418.7266,-1424.1827 456.0428,-1464.791 480.9653,-1436.9605 571.7299,-1335.6057 433.8573,-1240.6827 516.9653,-1132.9605 605.2983,-1018.4659 686.8208,-1070.7943 819.7932,-1013.9605 969.6588,-949.9064 997.5553,-910.2118 1152.5955,-859.9605 1225.1616,-836.4405 1270.2544,-883.8901 1321.0291,-826.9605 1388.2453,-751.5964 1321.6731,-468.553 1357.0291,-373.9605 1369.1825,-341.4447 1395.078,-310.299 1412.9154,-291.4015"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1415.5596,-293.7022 1420.0031,-284.0842 1410.5316,-288.832 1415.5596,-293.7022"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M224.0923,-2017.9003C225.9308,-1947.0803 239.5105,-1557.5467 317.2024,-1474.9605 342.8004,-1447.75 379.8996,-1488.0172 399.0839,-1455.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M585.7192,-883.9605C803.6223,-814.5786 1082.9046,-878.9296 1191.1305,-909.1984"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1190.1837,-912.5678 1200.7593,-911.9285 1192.0933,-905.8333 1190.1837,-912.5678"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M585.7192,-2010.9605C706.6449,-1984.0288 732.9259,-2064.0874 855.7932,-2079.9605 1061.5434,-2106.5411 1124.1419,-2107.3451 1321.0291,-2041.9605 1376.1754,-2023.6469 1528.4691,-1944.8262 1593.3312,-1910.7528"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1595.0247,-1913.8168 1602.2446,-1906.0628 1591.7651,-1907.622 1595.0247,-1913.8168"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M399.0839,-3055.9605C433.6324,-3085.7196 485.3993,-3093.2347 525.6559,-3093.8617"/>
<polygon fill="#ff0036" stroke="#ff0036" points="525.8823,-3097.362 535.8882,-3093.8789 525.8942,-3090.362 525.8823,-3097.362"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M224.0918,-2039.995C226.568,-2144.4908 248.0077,-2957.68 317.2024,-3036.9605 341.7679,-3065.1067 370.7783,-3031.5789 399.0839,-3055.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.896,-2017.8347C224.6559,-1914.0765 235.8038,-1116.134 399.0839,-961.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-961.9605C509.4258,-857.7726 547.4114,-834.5945 690.4731,-783.9605 954.6642,-690.4551 1054.4046,-700.638 1321.0291,-786.9605 1374.0274,-804.1193 1396.6895,-802.5616 1431.6149,-845.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.4393,-2017.8315C232.0898,-1875.7271 310.5917,-420.3724 317.2024,-411.9605 320.6464,-407.5781 324.8384,-403.9432 329.4854,-400.9308"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.162,-404.0031 338.278,-396.1537 327.8202,-397.8523 331.162,-404.0031"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-2694.9605C1466.7383,-2669.9701 1485.3934,-2670.7129 1506.2007,-2632.9605 1565.6998,-2525.0063 1462.7142,-2452.1739 1542.2007,-2357.9605 1544.9769,-2354.67 1548.1762,-2351.805 1551.6658,-2349.3113"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1553.5026,-2352.2909 1560.2723,-2344.1409 1549.8978,-2346.2904 1553.5026,-2352.2909"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2407.9605C941.6005,-2419.3639 943.4832,-2432.8737 966.4307,-2455.9605 983.7625,-2473.3976 982.6739,-2483.3279 1002.4307,-2497.9605 1046.9441,-2530.929 1079.0154,-2507.2652 1116.5955,-2547.9605 1149.7795,-2583.8954 1115.0348,-2620.6286 1152.5955,-2651.9605 1248.9467,-2732.3335 1329.3793,-2767.7015 1431.6149,-2694.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M911.1119,-2407.9605C936.881,-2415.3232 943.3779,-2418.2922 966.4307,-2431.9605 983.8661,-2442.2983 984.9369,-2449.7218 1002.4307,-2459.9605 1026.1827,-2473.8621 1033.1539,-2476.0481 1059.5131,-2483.9605"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1059.5131,-2483.9605C1136.7901,-2507.1573 1158.3867,-2541.9146 1236.8123,-2522.9605"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-2390.9605C730.3097,-2382.8779 771.8678,-2368.1762 911.1119,-2407.9605"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1236.8123,-2522.9605C1274.7637,-2513.7884 1284.4413,-2511.5904 1321.0291,-2497.9605 1348.3761,-2487.7731 1378.502,-2473.9734 1400.395,-2463.4521"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1402.0668,-2466.5313 1409.5378,-2459.0189 1399.0127,-2460.2326 1402.0668,-2466.5313"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-541.9605C421.9861,-511.7342 447.2077,-535.2394 480.9653,-517.9605 499.0089,-508.725 499.2247,-499.7654 516.9653,-489.9605 523.9217,-486.1159 531.5854,-482.657 539.1951,-479.6251"/>
<polygon fill="#00ff66" stroke="#00ff66" points="540.6301,-482.8244 548.7477,-476.016 538.1561,-476.2762 540.6301,-482.8244"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-2390.9605C462.0669,-2423.0469 537.0265,-2351.6088 569.4474,-2315.3802"/>
<polygon fill="#0066ff" stroke="#0066ff" points="572.4584,-2317.253 576.3966,-2307.4173 567.1843,-2312.6504 572.4584,-2317.253"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M224.495,-2040.2763C232.2006,-2173.3311 305.5673,-3435.2755 317.2024,-3449.9605 321.3214,-3455.1593 326.4925,-3459.3052 332.2237,-3462.6075"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="331.0918,-3465.947 341.6202,-3467.1322 334.1289,-3459.6402 331.0918,-3465.947"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-2986.966 334.8633,-2986.966 334.8633,-2964.9551 463.3044,-2964.9551 463.3044,-2986.966"/>
<text text-anchor="middle" x="399.0839" y="-2972.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2361,-2040.2578C227.8436,-2140.5723 256.3107,-2876.8345 317.2024,-2950.9605 319.8338,-2954.1638 322.8637,-2956.9658 326.174,-2959.416"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.5652,-2962.536 334.9131,-2964.81 328.2419,-2956.5793 324.5652,-2962.536"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-3027.966 354.6193,-3027.966 354.6193,-3005.9551 443.5485,-3005.9551 443.5485,-3027.966"/>
<text text-anchor="middle" x="399.0839" y="-3013.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M224.154,-2040.1742C227.1245,-2142.9583 251.6667,-2919.4043 317.2024,-2995.9605 324.3632,-3004.3254 334.3602,-3009.591 344.9159,-3012.8553"/>
<polygon fill="#cbff00" stroke="#cbff00" points="344.1493,-3016.2715 354.7015,-3015.3221 345.8604,-3009.4838 344.1493,-3016.2715"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M224.3618,-2040.2464C229.8777,-2158.7317 278.0926,-3171.234 317.2024,-3219.9605 321.9996,-3225.9373 328.1862,-3230.5207 335.0078,-3234.0295"/>
<polygon fill="#00ff66" stroke="#00ff66" points="334.064,-3237.434 344.6327,-3238.1781 336.8348,-3231.0057 334.064,-3237.434"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1761.9605C431.2541,-1743.8456 448.405,-1758.5564 480.9653,-1775.9605 501.4827,-1786.9274 496.0824,-1803.7069 516.9653,-1813.9605 612.4632,-1860.8503 650.1425,-1820.7717 755.1332,-1837.9605"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-2986.966 690.3127,-2986.966 690.3127,-2964.9551 819.9536,-2964.9551 819.9536,-2986.966"/>
<text text-anchor="middle" x="755.1332" y="-2972.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-2936.9605C424.0673,-2964.7364 447.8683,-2938.6327 480.9653,-2955.9605 536.6471,-2985.1125 523.7534,-3040.4471 585.7192,-3050.9605"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M585.7192,-3050.9605C636.5812,-3059.59 643.1012,-3021.3886 690.4731,-3000.9605 698.496,-2997.5008 707.1682,-2993.993 715.4764,-2990.7425"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="716.9344,-2993.9314 725.0015,-2987.0632 714.412,-2987.4016 716.9344,-2993.9314"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.5008,-2017.8072C249.3939,-1951.0947 363.0552,-1604.7468 392.245,-1515.7999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="395.6511,-1516.6453 395.4438,-1506.0525 389.0001,-1514.4626 395.6511,-1516.6453"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.4156,-2017.5949C231.3303,-1881.2254 298.6101,-562.9391 317.2024,-527.9605 328.0273,-507.5951 348.6359,-491.7938 366.4688,-481.1097"/>
<polygon fill="#00ffff" stroke="#00ffff" points="368.5096,-483.9757 375.4746,-475.992 365.0511,-477.8897 368.5096,-483.9757"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3777.9605C1714.1849,-3750.994 1733.2963,-3727.5512 1803.7218,-3663.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0578,-2040.0202C226.2469,-2146.5139 245.758,-2987.9588 317.2024,-3069.9605 467.7951,-3242.8062 667.8189,-3014.3284 819.7932,-3185.9605 920.5294,-3299.7269 760.3033,-3407.7563 855.7932,-3525.9605 968.5898,-3665.5881 1451.1156,-3828.9727 1623.2106,-3777.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.4395,-2039.9829C229.7384,-2133.5756 271.4529,-2795.0641 399.0839,-2936.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2936.9605C426.8198,-2967.7965 544.5098,-2941.6426 585.7192,-2936.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2860.9605C853.5179,-2866.0834 885.3723,-2871.9664 966.4307,-2927.9605 1054.9895,-2989.1358 1057.2421,-3028.1704 1116.5955,-3117.9605 1135.0207,-3145.8344 1125.8617,-3163.9168 1152.5955,-3183.9605 1203.3765,-3222.0338 1369.3499,-3232.6574 1431.6149,-3244.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2936.9605C639.4741,-2930.8531 640.1087,-2894.7167 690.4731,-2874.9605 717.8462,-2864.223 725.7622,-2859.5732 755.1332,-2860.9605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-2936.9605C689.4597,-2925.4687 742.1737,-2886.1798 819.7932,-2955.9605 883.7085,-3013.421 812.7601,-3071.5628 855.7932,-3145.9605 902.4522,-3226.6269 1136.9498,-3400.646 1212.9776,-3455.8152"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1211.2873,-3458.9123 1221.4404,-3461.9397 1215.3912,-3453.2415 1211.2873,-3458.9123"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2390.9605C485.6917,-2435.0824 495.6168,-2468.5022 585.7192,-2504.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2504.9605C672.771,-2540.1844 783.7259,-2537.2996 850.9947,-2530.9152"/>
<polygon fill="#ff0000" stroke="#ff0000" points="851.4003,-2534.3922 860.9998,-2529.909 850.6998,-2527.4273 851.4003,-2534.3922"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.4282,-2017.9443C231.2239,-1890.9287 295.0802,-707.7816 317.2024,-679.9605 319.7319,-676.7794 322.6552,-673.9927 325.8593,-671.5523"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.7695,-674.4854 334.3379,-666.1724 324.019,-668.5749 327.7695,-674.4854"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.4165,-2017.5725C231.0791,-1886.2702 293.7324,-663.2067 317.2024,-634.9605 318.2282,-633.7259 319.3158,-632.5585 320.4581,-631.4548"/>
<polygon fill="#00ffff" stroke="#00ffff" points="322.9534,-633.9491 328.7147,-625.0576 318.6661,-628.4157 322.9534,-633.9491"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.0359,-1913.9605C2062.8778,-1922.5687 2087.2608,-1957.9825 2205.1461,-1989.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1461,-1989.9605C2238.3316,-1997.1231 2343.8362,-2061.6896 2352.8577,-2028.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1682.7359,-1894.3535C1701.1625,-1894.192 1721.5309,-1894.0404 1740.2205,-1893.9605 1796.6656,-1893.7193 1811.2708,-1886.5145 1867.2231,-1893.9605 1900.9147,-1898.4442 1907.6331,-1907.6776 1941.0359,-1913.9605"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2068.7139,-1837.9605C2251.4789,-1805.3897 2336.1982,-1112.2775 2350.6109,-981.2338"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2354.0963,-981.5569 2351.6926,-971.2384 2347.1369,-980.8037 2354.0963,-981.5569"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1654.5618,-1883.8736C1677.8802,-1876.115 1710.647,-1866.2304 1740.2205,-1860.9605 1812.2628,-1848.1229 2010.6401,-1882.4841 2068.7139,-1837.9605"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1682.5667,-1901.2082C1697.9082,-1902.8229 1714.6042,-1904.5803 1730.5603,-1906.2598"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1730.6059,-1909.7838 1740.9173,-1907.3499 1731.3387,-1902.8223 1730.6059,-1909.7838"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1628.2269,-1883.9003C1652.9207,-1829.4543 1761.6886,-1589.6373 1794.3903,-1517.535"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1797.7011,-1518.7087 1798.6442,-1508.1559 1791.3262,-1515.8173 1797.7011,-1518.7087"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1626.3024,-1906.181C1638.7918,-1952.0725 1685.7311,-2130.1455 1704.2205,-2279.9605 1729.8795,-2487.8693 1678.3659,-3021.8144 1740.2205,-3221.9605 1749.9258,-3253.3647 1772.0007,-3284.6461 1787.3798,-3303.8889"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1784.8563,-3306.3311 1793.9061,-3311.8403 1790.2671,-3301.89 1784.8563,-3306.3311"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5077,-3095.9232C689.7765,-3105.2227 774.8575,-3128.5417 819.7932,-3185.9605 887.3512,-3272.2862 818.8435,-3326.7573 855.7932,-3429.9605 898.4405,-3549.0774 912.8189,-3584.6446 1002.4307,-3673.9605 1159.7417,-3830.7522 1209.5104,-3929.9605 1431.6149,-3929.9605 1431.6149,-3929.9605 1431.6149,-3929.9605 1623.2106,-3929.9605 1764.4663,-3929.9605 1801.0621,-3910.9737 1941.0359,-3929.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M755.1332,-3090.9605C785.534,-3093.4398 800.4712,-3090.3593 819.7932,-3113.9605 890.905,-3200.8213 802.9175,-3264.9361 855.7932,-3363.9605 897.0963,-3441.312 934.0272,-3441.0956 1002.4307,-3495.9605 1066.3577,-3547.235 1082.1127,-3561.1524 1152.5955,-3602.9605 1318.1227,-3701.146 1360.904,-3727.3761 1542.2007,-3791.9605 1654.7272,-3832.0465 1684.2685,-3853.9605 1803.7218,-3853.9605 1803.7218,-3853.9605 1803.7218,-3853.9605 1941.0359,-3853.9605 2096.6893,-3853.9605 2149.6716,-3769.3929 2205.1461,-3623.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M755.1332,-3090.9605C785.6397,-3093.9585 799.6939,-3091.8163 819.7932,-3114.9605 869.0086,-3171.6317 819.0412,-3214.5154 855.7932,-3279.9605 941.518,-3432.6125 1003.1821,-3447.708 1152.5955,-3538.9605 1314.9077,-3638.091 1356.5332,-3674.7333 1542.2007,-3715.9605 1747.2832,-3761.4988 1804.7741,-3719.8494 2014.8486,-3720.9605 2062.7282,-3721.2138 2087.9074,-3753.9815 2122.5791,-3720.9605 2186.1034,-3660.4605 2202.9416,-2242.6268 2204.9346,-2050.4484"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2208.4366,-2050.2622 2205.0384,-2040.2271 2201.4369,-2050.191 2208.4366,-2050.2622"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M596.0367,-3101.1641C613.7755,-3119.8754 651.8829,-3157.7184 690.4731,-3180.9605 696.7107,-3184.7173 703.6114,-3188.0946 710.5133,-3191.0621"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="709.2813,-3194.3393 719.8638,-3194.8518 711.9107,-3187.8519 709.2813,-3194.3393"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M633.8241,-3078.8699C641.4604,-3075.4117 648.723,-3070.8844 654.4731,-3064.9605 690.0078,-3028.3524 658.9874,-2996.1042 690.4731,-2955.9605 732.3275,-2902.5971 782.3074,-2931.4782 819.7932,-2874.9605 875.2844,-2791.2961 803.8663,-2737.8826 855.7932,-2651.9605 887.5879,-2599.3507 937.9508,-2623.4361 966.4307,-2568.9605 1017.5308,-2471.2174 945.8964,-1671.6643 1002.4307,-1576.9605 1032.5867,-1526.4445 1085.8614,-1560.127 1116.5955,-1509.9605 1187.1852,-1394.7385 1101.263,-1027.9565 1152.5955,-902.9605 1165.772,-870.8754 1194.2954,-842.1534 1214.4875,-824.6665"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1216.8963,-827.214 1222.2971,-818.0991 1212.3909,-821.8565 1216.8963,-827.214"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M911.1119,-3131.9605C1189.8961,-3037.9207 1302.76,-3054.5069 1506.2007,-2841.9605 1715.0427,-2623.7711 1678.6117,-2499.6393 1740.2205,-2203.9605 1761.2438,-2103.0634 1788.1693,-1982.8467 1798.9487,-1935.0561"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1802.4295,-1935.5313 1801.2185,-1925.0059 1795.6014,-1933.9891 1802.4295,-1935.5313"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1236.8123,-3283.9605C1282.2375,-3281.6926 1333.6953,-3281.8075 1372.312,-3282.4275"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1372.2832,-3285.9275 1382.3434,-3282.6045 1372.4067,-3278.9286 1372.2832,-3285.9275"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M755.1332,-2561.9605C827.7123,-2501.7719 902.0846,-2611.8806 966.4307,-2542.9605 1031.2385,-2473.5459 983.2972,-926.9786 1002.4307,-833.9605 1011.6781,-789.0036 1034.6786,-740.1021 1048.4963,-713.3325"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1051.7366,-714.6905 1053.2946,-704.2108 1045.5415,-711.4316 1051.7366,-714.6905"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M755.1332,-3090.9605C789.5935,-3095.5174 799.2154,-3074.9754 819.7932,-3046.9605 852.5044,-3002.4273 828.7635,-2976.1542 855.7932,-2927.9605 891.9228,-2863.5417 936.4529,-2871.4622 966.4307,-2803.9605 1027.03,-2667.5074 947.9343,-2608.9638 1002.4307,-2469.9605 1088.9869,-2249.1826 1234.5776,-2262.7794 1321.0291,-2041.9605 1375.9428,-1901.697 1319.3811,-1850.8098 1357.0291,-1704.9605 1372.3617,-1645.5613 1404.1755,-1580.1265 1420.8646,-1548.0062"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1423.9648,-1549.6305 1425.5234,-1539.1509 1417.7699,-1546.3712 1423.9648,-1549.6305"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M755.1332,-3090.9605C863.4529,-3105.2842 839.4691,-2884.5326 855.7932,-2851.9605 872.3394,-2818.9452 900.7916,-2825.4186 911.1119,-2789.9605"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M911.1119,-2789.9605C921.4323,-2754.5024 952.1777,-2762.0286 966.4307,-2727.9605 1014.7306,-2612.512 974.2883,-2287.9 1002.4307,-2165.9605 1012.6265,-2121.7824 1035.2877,-2073.5241 1048.7896,-2047.0872"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1051.9661,-2048.5649 1053.4709,-2038.0775 1045.7545,-2045.3375 1051.9661,-2048.5649"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M635.6114,-3086.9836C669.4756,-3085.7631 715.1856,-3085.6781 755.1332,-3090.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M635.4751,-3079.8217C642.838,-3076.2607 649.5811,-3071.4523 654.4731,-3064.9605 689.1282,-3018.9726 685.457,-2605.3252 690.4731,-2547.9605 710.8084,-2315.4071 743.3418,-2034.1518 752.6007,-1955.3717"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="756.0993,-1955.5883 753.7937,-1945.2474 749.1474,-1954.7691 756.0993,-1955.5883"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M911.1119,-2941.9605C934.2831,-2913.2049 945.6984,-2910.5213 966.4307,-2879.9605 986.516,-2850.3534 976.5224,-2832.6336 1002.4307,-2807.9605 1153.3634,-2664.2236 1287.2189,-2769.2629 1431.6149,-2618.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-3131.9605C911.5733,-3131.8456 1356.6411,-2814.2354 1357.0291,-2813.9605 1423.1835,-2767.0899 1464.5265,-2778.5057 1506.2007,-2708.9605 1573.6404,-2596.4185 1468.3633,-2524.4127 1542.2007,-2415.9605 1565.2591,-2382.0924 1610.7772,-2411.0009 1623.2106,-2371.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3090.9605C826.4238,-3098.4106 839.8518,-3139.696 911.1119,-3131.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-2371.9605C1634.6538,-2336.7941 1680.1331,-2381.0216 1704.2205,-2352.9605 1737.5407,-2314.1435 1734.1756,-1944.7588 1740.2205,-1893.9605 1757.4219,-1749.407 1788.7422,-1576.8922 1799.7599,-1517.9164"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1803.2226,-1518.4404 1801.6279,-1507.9663 1796.3428,-1517.1487 1803.2226,-1518.4404"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3090.9605C828.8163,-3100.704 948.6389,-2976.614 966.4307,-2955.9605 988.2384,-2930.6451 977.9588,-2912.7108 1002.4307,-2889.9605 1155.8785,-2747.3075 1257.5932,-2811.6334 1431.6149,-2694.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1236.8123,-2637.9605C1298.7307,-2572.5929 1376.4239,-2499.248 1412.086,-2466.0333"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1414.489,-2468.5782 1419.4311,-2459.2067 1409.7235,-2463.4508 1414.489,-2468.5782"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M755.1332,-3090.9605C785.5222,-3094.979 798.5755,-3089.084 819.7932,-3066.9605 855.6917,-3029.5296 817.935,-2991.4081 855.7932,-2955.9605 874.306,-2938.6265 895.591,-2962.0177 911.1119,-2941.9605"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M911.1119,-2941.9605C933.7126,-2912.7545 949.9383,-2913.0027 966.4307,-2879.9605 1002.8656,-2806.964 946.5341,-2759.3875 1002.4307,-2699.9605 1076.2562,-2621.4722 1162.7116,-2716.1891 1236.8123,-2637.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M635.4563,-3084.4229C689.679,-3075.5869 774.7189,-3052.9946 819.7932,-2995.9605 881.2263,-2918.2272 813.1125,-2865.3745 855.7932,-2775.9605 887.61,-2709.3059 938.2047,-2720.2133 966.4307,-2651.9605 1021.2922,-2519.3006 926.5624,-2128.8312 1002.4307,-2006.9605 1042.5937,-1942.4448 1126.4022,-1906.6127 1182.1401,-1889.0667"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1183.3169,-1892.367 1191.8607,-1886.1018 1181.2746,-1885.6715 1183.3169,-1892.367"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M630.4097,-3078.9498C639.0107,-3075.4426 647.5,-3070.8767 654.4731,-3064.9605 679.3589,-3043.8468 665.8018,-3022.3243 690.4731,-3000.9605 694.6812,-2997.3167 699.4792,-2994.1734 704.5167,-2991.4689"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="706.2451,-2994.5224 713.7671,-2987.0611 703.2339,-2988.2031 706.2451,-2994.5224"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3090.9605C785.6207,-3094.1466 798.2594,-3093.1446 819.7932,-3114.9605 853.2705,-3148.8763 829.642,-3176.1218 855.7932,-3215.9605 857.3889,-3218.3914 1151.4493,-3492.329 1152.5955,-3492.9605 1218.1096,-3529.0581 1749.3046,-3715.2822 1803.7218,-3663.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-3663.9605C1908.1826,-3569.6377 1933.689,-3387.179 1939.461,-3325.1764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1942.9622,-3325.3103 1940.3237,-3315.0493 1935.9874,-3324.7161 1942.9622,-3325.3103"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-3283.9605C1324.9994,-3279.5577 1344.9927,-3227.8445 1431.6149,-3244.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3090.9605C785.5877,-3094.4473 793.3942,-3099.3807 819.7932,-3114.9605 837.9772,-3125.6922 837.6702,-3135.1262 855.7932,-3145.9605 1010.382,-3238.3767 1056.9296,-3292.9413 1236.8123,-3283.9605"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.3161,-3079.2554C642.6029,-3075.7577 649.3622,-3071.1172 654.4731,-3064.9605 717.1976,-2989.4019 671.6011,-2943.3312 690.4731,-2846.9605 715.4343,-2719.4958 655.1533,-2644.8721 755.1332,-2561.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2561.9605C769.8767,-2549.734 813.6382,-2539.4084 851.0687,-2532.4593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="851.7081,-2535.9005 860.9264,-2530.6783 850.4634,-2529.012 851.7081,-2535.9005"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1813.9955,-1485.8587C1835.4592,-1463.9722 1887.5197,-1417.562 1941.0359,-1419.9605"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M459.9866,-376.7957C467.9065,-373.2139 475.2404,-368.4058 480.9653,-361.9605 540.9445,-294.4347 453.8675,-226.5817 516.9653,-161.9605 612.9436,-63.6651 695.0034,-157.4177 819.7932,-99.9605 838.2051,-91.4831 836.6206,-78.5388 855.7932,-71.9605 1071.5845,2.0791 1647.8037,-185.4878 1867.2231,-247.9605 1917.2287,-262.198 1932.3767,-259.6449 1978.8486,-282.9605 2022.9072,-305.0653 2030.7338,-316.5393 2068.7139,-347.9605"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M2068.7139,-347.9605C2095.1623,-365.566 2100.8408,-371.789 2122.5791,-394.9605 2140.5819,-414.1502 2138.538,-424.9106 2158.5791,-441.9605 2194.3624,-472.4032 2224.3679,-453.758 2251.7131,-491.9605 2308.616,-571.4564 2267.413,-613.3288 2287.7131,-708.9605 2305.9832,-795.029 2334.3252,-895.9717 2346.7125,-938.9152"/>
<polygon fill="#ff3600" stroke="#ff3600" points="2343.3564,-939.9089 2349.5023,-948.539 2350.0796,-937.9599 2343.3564,-939.9089"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1650.3381,-2321.8747C1724.8041,-2291.6126 1927.7575,-2210.3364 1941.0359,-2217.9605"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M1485.5045,-2447.256C1540.9406,-2445.5931 1629.4981,-2440.3177 1704.2205,-2423.9605 1847.4358,-2392.6099 1876.691,-2362.0113 2014.8486,-2312.9605 2038.7714,-2304.4671 2047.0411,-2307.179 2068.7139,-2293.9605"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1435.4421,-2436.9141C1459.0087,-2368.894 1584.455,-2006.8201 1616.0053,-1915.757"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1619.4076,-1916.628 1619.3743,-1906.0332 1612.7933,-1914.3363 1619.4076,-1916.628"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1444.816,-2436.7391C1471.7593,-2413.9073 1531.4511,-2363.7112 1542.2007,-2357.9605 1549.9329,-2353.824 1558.4538,-2350.2588 1566.9774,-2347.2231"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1568.1866,-2350.5093 1576.5602,-2344.0183 1565.9664,-2343.8707 1568.1866,-2350.5093"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M594.4537,-453.8404C615.342,-427.4377 668.1047,-361.9176 690.4731,-344.9605 733.7446,-312.1573 858.0306,-228.5222 911.1119,-239.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M911.1119,-239.9605C1085.8991,-281.5474 1562.7619,-286.1929 1704.2205,-396.9605 1901.4912,-551.4312 2076.8548,-1197.6148 2122.5791,-1443.9605 2145.3363,-1566.5677 2091.1659,-1899.0516 2158.5791,-2003.9605 2160.4145,-2006.8168 2162.6921,-2009.3696 2165.2457,-2011.6471"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2163.4181,-2014.6451 2173.5686,-2017.6814 2167.5271,-2008.978 2163.4181,-2014.6451"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M911.1119,-239.9605C946.8877,-249.119 950.4856,-268.6508 966.4307,-301.9605 1008.6418,-390.1408 962.2318,-429.845 1002.4307,-518.9605 1030.2911,-580.7235 1170.4299,-735.2405 1219.6721,-788.5417"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1217.1465,-790.9655 1226.5095,-795.9238 1222.2821,-786.2089 1217.1465,-790.9655"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M632.3723,-458.2444C711.7631,-449.6332 873.5415,-444.7418 966.4307,-529.9605 1013.1383,-572.8112 961.2777,-619.7504 1002.4307,-667.9605 1005.2359,-671.2468 1008.5552,-674.1162 1012.1598,-676.6188"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1010.5882,-679.7552 1020.9807,-681.816 1014.1417,-673.7242 1010.5882,-679.7552"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M590.6088,-476.3289C603.9102,-507.9011 640.6741,-599.625 654.4731,-679.9605 676.5287,-808.3637 645.8959,-1729.5404 690.4731,-1851.9605 699.5588,-1876.912 719.4142,-1900.1544 734.7415,-1915.4756"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="732.6363,-1918.3079 742.2629,-1922.7326 737.4967,-1913.2703 732.6363,-1918.3079"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M597.3527,-453.794C612.5254,-438.6295 638.9566,-410.0619 654.4731,-380.9605 680.4705,-332.2022 649.8821,-299.4518 690.4731,-261.9605 745.7132,-210.939 781.1441,-235.0254 855.7932,-225.9605 954.5184,-213.972 1293.3802,-215.8921 1321.0291,-221.9605 1351.43,-228.633 1383.4361,-244.4966 1405.148,-256.774"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1403.6652,-259.96 1414.072,-261.9475 1407.176,-253.904 1403.6652,-259.96"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M590.4486,-476.358C603.3404,-508.0045 639.1548,-599.9008 654.4731,-679.9605 698.3425,-909.2392 631.479,-978.1001 690.4731,-1203.9605 733.8482,-1370.0229 769.3041,-1404.7116 855.7932,-1552.9605 898.8091,-1626.693 921.3325,-1637.4829 966.4307,-1709.9605 984.0832,-1738.3301 982.9692,-1748.8 1002.4307,-1775.9605 1024.2467,-1806.4072 1023.0283,-1829.4869 1059.5131,-1837.9605"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1059.5131,-1837.9605C1096.9647,-1846.1075 1138.9469,-1854.8845 1172.6548,-1861.8445"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1172.3352,-1865.3522 1182.836,-1863.9435 1173.7487,-1858.4963 1172.3352,-1865.3522"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M654.5102,-2296.2047C721.4134,-2298.1444 825.2347,-2305.7035 911.1119,-2331.9605"/>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M911.1119,-2331.9605C1305.8817,-2396.0475 1407.7103,-2162.0575 1803.7218,-2217.9605"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M594.0188,-2284.7138C608.704,-2264.2194 639.1586,-2218.9332 654.4731,-2175.9605 687.2919,-2083.8711 628.7629,-2034.7852 690.4731,-1958.9605 696.1033,-1952.0426 703.8926,-1947.0349 712.1189,-1943.4112"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="713.3747,-1946.6783 721.5007,-1939.8799 710.9088,-1940.127 713.3747,-1946.6783"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2331.9605C1129.2818,-2410.8152 1202.5649,-2407.7338 1431.6149,-2370.9605"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M442.2813,-3486.0542C454.972,-3489.87 468.7258,-3494.5625 480.9653,-3499.9605 579.966,-3543.6232 590.4457,-3582.7043 690.4731,-3623.9605 985.6741,-3745.7159 1904.9143,-3975.6056 2122.5791,-3741.9605 2183.1464,-3676.9466 2202.5554,-2243.3448 2204.8968,-2050.3743"/>
<polygon fill="#ffa300" stroke="#ffa300" points="2208.3969,-2050.3808 2205.0166,-2040.3397 2201.3974,-2050.2972 2208.3969,-2050.3808"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M755.1332,-3587.9605C856.371,-3564.6089 877.9403,-3542.4018 966.4307,-3487.9605 983.6948,-3477.3392 985.3661,-3470.8997 1002.4307,-3459.9605 1065.7447,-3419.3732 1082.7079,-3409.7405 1152.5955,-3381.9605 1188.7628,-3367.5842 1199.9301,-3370.389 1236.8123,-3357.9605"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M456.2162,-3541.9222C465.1182,-3538.4631 473.7441,-3533.9218 480.9653,-3527.9605 507.3366,-3506.1904 492.8683,-3484.224 516.9653,-3459.9605 624.6729,-3351.5088 728.7899,-3419.7657 819.7932,-3296.9605 868.1076,-3231.7623 824.28,-3192.7402 855.7932,-3117.9605 889.6521,-3037.6145 938.8084,-3038.6583 966.4307,-2955.9605 1022.106,-2789.2752 964.4908,-2337.554 1002.4307,-2165.9605 1012.2189,-2121.6903 1035.0259,-2073.465 1048.6636,-2047.0587"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1051.8389,-2048.5403 1053.3951,-2038.0604 1045.6432,-2045.2824 1051.8389,-2048.5403"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M463.2218,-3541.783C469.9822,-3538.3113 476.1367,-3533.8039 480.9653,-3527.9605 528.8003,-3470.0733 491.2215,-3262.5039 516.9653,-3191.9605 528.636,-3159.9804 552.4315,-3128.2776 568.7263,-3108.907"/>
<polygon fill="#ff0036" stroke="#ff0036" points="571.5281,-3111.0172 575.404,-3101.1567 566.225,-3106.448 571.5281,-3111.0172"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.1932,-3564.0721C442.3949,-3576.6854 481.8649,-3597.5114 516.9653,-3612.9605 642.9571,-3668.4147 683.2424,-3695.3661 819.7932,-3677.9605 886.5778,-3669.4478 908.0249,-3673.448 966.4307,-3639.9605 979.1479,-3632.669 1140.4407,-3461.1555 1152.5955,-3452.9605 1293.9984,-3357.6234 1409.2012,-3444.2284 1506.2007,-3303.9605 1566.0288,-3217.445 1478.1457,-2441.395 1542.2007,-2357.9605 1544.5815,-2354.8594 1547.3404,-2352.1326 1550.3734,-2349.736"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1552.5039,-2352.5252 1558.9701,-2344.1324 1548.6814,-2346.661 1552.5039,-2352.5252"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M755.1332,-3587.9605C801.0425,-3573.4006 972.3103,-3269.5426 1002.4307,-3231.9605 1049.2795,-3173.5058 1074.6238,-3170.0101 1116.5955,-3107.9605 1121.6884,-3100.4313 1369.9556,-2577.8036 1422.0783,-2468.0447"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1425.2451,-2469.5351 1426.3731,-2459.0005 1418.9218,-2466.5324 1425.2451,-2469.5351"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M427.0104,-3563.9677C488.584,-3586.4961 639.705,-3632.1651 755.1332,-3587.9605"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M440.4124,-3541.9384C453.5533,-3538.0117 468.0292,-3533.2389 480.9653,-3527.9605 561.3987,-3495.1407 577.3821,-3478.0059 654.4731,-3437.9605 727.9712,-3399.7815 757.3047,-3406.3184 819.7932,-3351.9605 904.5842,-3278.202 918.7549,-3247.7292 966.4307,-3145.9605 1077.5685,-2908.7257 1075.1782,-2834.643 1116.5955,-2575.9605 1137.7127,-2444.0672 1103.3632,-2100.1296 1152.5955,-1975.9605 1166.0415,-1942.048 1195.5127,-1911.1211 1215.7654,-1892.6649"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1218.1251,-1895.2503 1223.2843,-1885.9964 1213.4804,-1890.0132 1218.1251,-1895.2503"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-3066.966 166.6166,-3066.966 166.6166,-3044.9551 281.0645,-3044.9551 281.0645,-3066.966"/>
<text text-anchor="middle" x="223.8406" y="-3052.8105" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M226.3533,-3044.8112C241.3422,-2980.8325 324.8877,-2657.4083 516.9653,-2490.9605 565.8843,-2448.5691 597.8141,-2474.2632 654.4731,-2442.9605 809.7503,-2357.174 851.7641,-2329.319 966.4307,-2193.9605 1006.1181,-2147.1114 1037.0512,-2080.7724 1051.1597,-2047.5705"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1054.5229,-2048.5986 1055.139,-2038.0217 1048.0615,-2045.9059 1054.5229,-2048.5986"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M224.6891,-3044.6598C230.653,-2966.6227 267.4882,-2507.0012 317.2024,-2376.9605 373.8771,-2228.7129 393.749,-2180.9961 516.9653,-2080.9605 568.1955,-2039.3683 605.2606,-2068.9216 654.4731,-2024.9605 679.392,-2002.7008 665.3571,-1980.9975 690.4731,-1958.9605 696.712,-1953.4865 704.2816,-1949.1476 712.0124,-1945.7294"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="713.4299,-1948.9327 721.4435,-1942.0022 710.857,-1942.4226 713.4299,-1948.9327"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M281.0921,-3048.2078C325.3625,-3043.5948 381.9105,-3041.1679 399.0839,-3055.9605"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M224.9582,-3067.0118C229.2197,-3102.7423 247.8928,-3215.6782 317.2024,-3264.9605 408.4092,-3329.8129 716.7157,-3340.5443 819.7932,-3296.9605 905.9561,-3260.5287 911.2034,-3221.4673 966.4307,-3145.9605 1049.7961,-3031.9832 1068.9313,-2998.8844 1116.5955,-2865.9605 1144.2803,-2788.7539 1104.3367,-2751.2809 1152.5955,-2684.9605 1177.8157,-2650.3012 1208.5999,-2670.2311 1236.8123,-2637.9605"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.5409,-3067.3721C228.7586,-3132.4902 252.7935,-3456.6907 317.2024,-3527.9605 320.3136,-3531.4031 323.8837,-3534.3779 327.7544,-3536.9477"/>
<polygon fill="#ff0000" stroke="#ff0000" points="326.2156,-3540.0978 336.6472,-3541.951 329.6481,-3533.9971 326.2156,-3540.0978"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M224.3757,-3044.6202C227.8535,-2975.3428 249.2736,-2609.3647 317.2024,-2524.9605 377.3747,-2450.1941 426.1578,-2474.0204 516.9653,-2442.9605 576.9583,-2422.4405 604.7958,-2444.3608 654.4731,-2404.9605 680.6521,-2384.1974 674.1331,-2368.1058 690.4731,-2338.9605 762.4603,-2210.5591 767.683,-2169.8828 855.7932,-2051.9605 895.0935,-1999.3631 994.882,-1826.3923 1059.5131,-1837.9605"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M463.6941,-2986.9108C469.8853,-2989.5729 475.7786,-2992.8726 480.9653,-2996.9605 507.8226,-3018.1282 491.1737,-3042.5067 516.9653,-3064.9605 521.2162,-3068.6613 526.0592,-3071.8302 531.1614,-3074.5405"/>
<polygon fill="#ff0036" stroke="#ff0036" points="530.0127,-3077.8674 540.5531,-3078.9396 532.9819,-3071.5283 530.0127,-3077.8674"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M911.1119,-2445.9605C979.196,-2445.9483 994.3036,-2464.3861 1059.5131,-2483.9605"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M457.284,-2964.8512C465.8577,-2961.4023 474.1002,-2956.8829 480.9653,-2950.9605 645.2691,-2809.2192 525.1805,-2650.5473 690.4731,-2509.9605 768.2496,-2443.8091 809.0082,-2445.9788 911.1119,-2445.9605"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M443.2474,-3028.0472C455.7029,-3031.8121 469.0896,-3036.4791 480.9653,-3041.9605 498.2043,-3049.9174 499.9408,-3056.5546 516.9653,-3064.9605 524.6597,-3068.7596 533.0815,-3072.2947 541.3109,-3075.4406"/>
<polygon fill="#ff0036" stroke="#ff0036" points="540.2346,-3078.774 550.8281,-3078.9472 542.6548,-3072.2057 540.2346,-3078.774"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M443.5466,-3019.6741C501.7662,-3020.5382 602.5091,-3012.2723 654.4731,-2950.9605 712.6065,-2882.3697 637.3447,-2620.4972 690.4731,-2547.9605 727.277,-2497.712 763.434,-2520.4762 819.7932,-2493.9605 861.2821,-2474.441 865.3113,-2448.1151 911.1119,-2445.9605"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M434.3524,-3256.0273C457.6074,-3262.9528 488.8517,-3271.5561 516.9653,-3276.9605 702.9285,-3312.7089 1135.6132,-3388.4313 1236.8123,-3357.9605"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1236.8123,-3357.9605C1292.5955,-3339.1628 1356.1635,-3314.3663 1395.0854,-3298.7903"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1396.4543,-3302.0123 1404.43,-3295.0382 1393.846,-3295.5164 1396.4543,-3302.0123"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M453.4393,-3249.7915C505.1768,-3254.5058 585.1966,-3262.0982 654.4731,-3269.9605 699.2948,-3275.0474 714.7808,-3303.1234 755.1332,-3282.9605"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M755.1332,-3282.9605C781.8538,-3267.9389 800.954,-3283.1416 819.7932,-3258.9605 865.266,-3200.594 837.8616,-2999.7441 855.7932,-2927.9605 871.8074,-2863.8528 892.6459,-2853.4054 911.1119,-2789.9605"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M405.0845,-3233.6499C420.984,-3203.0255 464.1287,-3115.5098 480.9653,-3036.9605 516.4481,-2871.4204 461.9881,-2436.0857 516.9653,-2275.9605 551.4024,-2175.66 593.9563,-2168.0456 654.4731,-2080.9605 686.031,-2035.5481 722.6066,-1981.8673 741.7987,-1953.6174"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="744.8869,-1955.2999 747.6086,-1945.0606 739.0956,-1951.3677 744.8869,-1955.2999"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M414.1025,-3233.8641C430.6994,-3221.4962 458.1072,-3200.7585 480.9653,-3181.9605 511.3327,-3156.9872 545.3383,-3126.6653 566.1387,-3107.8371"/>
<polygon fill="#ff0036" stroke="#ff0036" points="568.6335,-3110.2994 573.6845,-3100.9861 563.9281,-3105.1167 568.6335,-3110.2994"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M755.1332,-3282.9605C781.5941,-3268.0849 799.2189,-3283.2801 819.7932,-3260.9605 864.2137,-3212.772 826.769,-3176.7219 855.7932,-3117.9605 885.9489,-3056.9084 1190.8806,-2688.23 1236.8123,-2637.9605"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1246.4635,-1863.6741C1265.0258,-1841.175 1305.2577,-1788.3776 1321.0291,-1735.9605 1378.9555,-1543.4381 1334.7661,-1031.7722 1357.0291,-831.9605 1373.5748,-683.4607 1412.8146,-507.5041 1426.6675,-447.8914"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1430.0771,-448.6816 1428.9475,-438.1472 1423.2612,-447.0867 1430.0771,-448.6816"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1250.2028,-1886.052C1269.6925,-1903.0895 1305.2644,-1937.7623 1321.0291,-1975.9605 1390.6443,-2144.6403 1272.9899,-2222.9834 1357.0291,-2384.9605 1367.1063,-2404.3834 1385.9866,-2420.2377 1402.2292,-2431.1835"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1400.602,-2434.2978 1410.9089,-2436.751 1404.3814,-2428.4058 1400.602,-2434.2978"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M771.0797,-2964.8828C786.0625,-2953.5912 807.907,-2934.6849 819.7932,-2912.9605 857.9075,-2843.2993 813.8518,-2805.3868 855.7932,-2737.9605 888.6888,-2685.0765 917.264,-2690.1899 966.4307,-2651.9605 982.4325,-2639.5184 984.9369,-2634.1993 1002.4307,-2623.9605 1049.9347,-2596.1574 1066.0412,-2597.7302 1116.5955,-2575.9605 1170.2261,-2552.8661 1180.0546,-2536.6778 1236.8123,-2522.9605"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M445.0664,-1502.3265C457.691,-1506.0345 470.7117,-1511.6027 480.9653,-1519.9605 506.8646,-1541.0714 494.462,-1561.2615 516.9653,-1585.9605 586.981,-1662.8077 809.8118,-1814.5945 911.1119,-1837.9605"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M911.1119,-1837.9605C976.6328,-1845.5245 995.0643,-1823.9407 1059.5131,-1837.9605"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-425.9605C435.6324,-418.2227 452.1595,-430.749 480.9653,-406.9605 511.3416,-381.8751 486.3264,-350.7245 516.9653,-325.9605 537.9951,-308.9632 728.0932,-276.002 755.1332,-275.9605"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M272.5271,-453.9477C307.672,-446.0413 356.277,-435.1959 399.0839,-425.9605"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-425.9605C453.188,-414.506 516.1634,-434.6128 553.3875,-449.9646"/>
<polygon fill="#00ff66" stroke="#00ff66" points="552.1532,-453.2431 562.7251,-453.9404 554.8955,-446.8026 552.1532,-453.2431"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-464.9605C295.1003,-464.9605 313.1505,-464.9605 330.2066,-464.9605"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-468.4606 340.6733,-464.9605 330.6733,-461.4606 330.6733,-468.4606"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M443.718,-453.843C456.053,-450.1017 469.2594,-445.4545 480.9653,-439.9605 564.4933,-400.7579 578.4966,-378.3183 654.4731,-325.9605 670.7245,-314.7612 673.0631,-309.2568 690.4731,-299.9605 717.5133,-285.5221 724.4828,-276.4003 755.1332,-275.9605"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M457.3688,-464.9605C480.1853,-464.9605 506.2705,-464.9605 528.9395,-464.9605"/>
<polygon fill="#00ff66" stroke="#00ff66" points="529.0906,-468.4606 539.0906,-464.9605 529.0906,-461.4606 529.0906,-468.4606"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1941.915,-3315.3058C1946.4485,-3371.2431 1968.774,-3617.3321 2014.8486,-3675.9605 2017.357,-3679.1523 2020.368,-3681.9537 2023.6677,-3684.4092"/>
<polygon fill="#48ff00" stroke="#48ff00" points="2022.0068,-3687.4984 2032.3428,-3689.826 2025.7144,-3681.5608 2022.0068,-3687.4984"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1945.3416,-3292.909C1953.3055,-3271.9899 1970.3017,-3225.0192 1978.8486,-3183.9605 2046.638,-2858.3077 2064.5905,-2451.3327 2068.0269,-2354.3868"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2071.5338,-2354.2407 2068.3764,-2344.1273 2064.5378,-2354.0023 2071.5338,-2354.2407"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1867.5549,-3314.128C1876.1235,-3312.9424 1884.7927,-3311.7428 1893.0252,-3310.6037"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1893.7533,-3314.0364 1903.1792,-3309.1987 1892.7938,-3307.1025 1893.7533,-3314.0364"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1489.0641,-3483.075C1495.721,-3479.5805 1501.7194,-3474.9887 1506.2007,-3468.9605 1544.5342,-3417.3947 1535.0652,-2376.8165 1542.2007,-2312.9605 1559.3953,-2159.0838 1602.6862,-1977.1749 1617.8574,-1916.1231"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1621.3172,-1916.7144 1620.3503,-1906.1638 1614.5267,-1915.0147 1621.3172,-1916.7144"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1489.1002,-3485.8293C1527.6301,-3479.5151 1579.1777,-3469.385 1623.2106,-3454.9605"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1248.4147,-3461.7037C1280.8199,-3430.2637 1372.5297,-3341.2857 1412.5459,-3302.4615"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1415.087,-3304.8727 1419.827,-3295.3973 1410.2126,-3299.8487 1415.087,-3304.8727"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1263.0073,-3484.0877C1287.0034,-3493.7481 1323.7466,-3507.2149 1357.0291,-3513.9605 1473.2695,-3537.5199 1504.6228,-3531.0036 1623.2106,-3532.9605"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1274.1924,-3461.8718C1303.223,-3453.4752 1341.1282,-3443.0406 1357.0291,-3440.9605 1422.7675,-3432.3609 1440.0197,-3437.0154 1506.2007,-3440.9605 1558.4832,-3444.0772 1573.4378,-3471.2653 1623.2106,-3454.9605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3454.9605C1691.5403,-3431.1868 1756.04,-3372.0812 1786.0798,-3341.6783"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1788.8279,-3343.8725 1793.2856,-3334.261 1783.8071,-3338.9948 1788.8279,-3343.8725"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1803.7218,-2865.9605C2035.6149,-2895.9602 2064.6,-2456.5461 2068.2047,-2354.0731"/>
<polygon fill="#00ff91" stroke="#00ff91" points="2071.705,-2354.1141 2068.5125,-2344.0118 2064.7083,-2353.9001 2071.705,-2354.1141"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1059.5131,-2561.9605C1120.6781,-2596.6975 1094.6609,-2650.0681 1152.5955,-2689.9605 1183.4583,-2711.212 1766.3898,-2869.1948 1803.7218,-2865.9605"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1059.5131,-2561.9605C1208.9059,-2637.284 1306.7945,-2730.3684 1431.6149,-2618.9605"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M1431.6149,-2618.9605C1483.4718,-2564.9824 1481.9374,-2538.7706 1506.2007,-2467.9605 1524.6812,-2414.0268 1600.805,-2013.6491 1619.1971,-1916.2642"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1622.6883,-1916.6375 1621.1031,-1906.162 1615.8097,-1915.3397 1622.6883,-1916.6375"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M961.3442,-2529.5116C991.3108,-2534.9936 1029.2841,-2544.7928 1059.5131,-2561.9605"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M475.0049,-643.9155C616.9468,-623.2952 908.5398,-581.0866 911.1119,-581.9605"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~dxcoil.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M911.1119,-581.9605C963.4844,-601.0732 955.9229,-637.2165 1002.4307,-667.9605 1007.7612,-671.4843 1013.6705,-674.7128 1019.6077,-677.5947"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1018.3313,-680.8595 1028.8816,-681.8308 1021.2398,-674.4923 1018.3313,-680.8595"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M432.4447,-602.9207C516.0792,-577.1163 740.2165,-519.5944 911.1119,-581.9605"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefiledxcoilf90EfferentGraph = svgPanZoom('#sourcefiledxcoilf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~dxcoil.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefiledxcoilf90AfferentGraph" width="641pt" height="436pt"
 viewBox="0.00 0.00 641.00 435.93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~dxcoil.f90~~AfferentGraph" class="graph" transform="scale(.2087 .2087) rotate(0) translate(4 2084.3555)">
<title>sourcefile~~dxcoil.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2084.3555 3066.74,-2084.3555 3066.74,4 -4,4"/>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~dxcoil.f90</title>
<polygon fill="none" stroke="#000000" points="62.2819,-1374.0668 -.0942,-1374.0668 -.0942,-1352.056 62.2819,-1352.056 62.2819,-1374.0668"/>
<text text-anchor="middle" x="31.0939" y="-1359.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">DXCoil.f90</text>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="805.9238,-1164.0668 679.5691,-1164.0668 679.5691,-1142.056 805.9238,-1142.056 805.9238,-1164.0668"/>
<text text-anchor="middle" x="742.7465" y="-1149.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge211" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1229.0614C248.5603,-1198.4487 275.6453,-1233.1416 360.7343,-1229.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M360.7343,-1229.0614C423.4774,-1226.0528 596.3486,-1187.3837 686.4574,-1166.398"/>
<polygon fill="#ff0000" stroke="#ff0000" points="687.2902,-1169.7978 696.2322,-1164.1153 685.6982,-1162.9812 687.2902,-1169.7978"/>
</g>
<!-- sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~hvacmultispeedheatpump.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/hvacmultispeedheatpump.f90.html" xlink:title="HVACMultiSpeedHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440.7853,-1395.0668 280.6832,-1395.0668 280.6832,-1373.056 440.7853,-1373.056 440.7853,-1395.0668"/>
<text text-anchor="middle" x="360.7343" y="-1380.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACMultiSpeedHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge212" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1229.0614C238.8996,-1202.2733 213.5696,-1317.7767 275.9407,-1359.0614 282.0997,-1363.1382 288.9396,-1366.5657 295.9868,-1369.4439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="295.0876,-1372.8433 305.6806,-1373.0378 297.5209,-1366.2798 295.0876,-1372.8433"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~desiccantdehumidifiers.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/desiccantdehumidifiers.f90.html" xlink:title="DesiccantDehumidifiers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="622.9987,-1470.0668 483.389,-1470.0668 483.389,-1448.056 622.9987,-1448.056 622.9987,-1470.0668"/>
<text text-anchor="middle" x="553.1938" y="-1455.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DesiccantDehumidifiers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge213" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1229.0614C227.5822,-1206.6145 220.3342,-1292.1454 275.9407,-1321.0614 344.9278,-1356.9356 384.6794,-1315.6502 445.5278,-1364.0614 472.9046,-1385.8425 455.1278,-1411.1062 481.5278,-1434.0614 485.754,-1437.7361 490.5522,-1440.8797 495.6159,-1443.5673"/>
<polygon fill="#ff0000" stroke="#ff0000" points="494.4098,-1446.8669 504.9513,-1447.9287 497.3727,-1440.5249 494.4098,-1446.8669"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1416.3247,-1360.0668 1319.4614,-1360.0668 1319.4614,-1338.056 1416.3247,-1338.056 1416.3247,-1360.0668"/>
<text text-anchor="middle" x="1367.8931" y="-1345.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge214" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M37.9699,-1351.6963C55.559,-1323.9177 105.3283,-1253.0982 169.0642,-1229.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.6956,-1350.0614C1211.6679,-1357.8711 1268.0538,-1356.8919 1309.3109,-1354.3727"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1309.7123,-1357.854 1319.4604,-1353.7035 1309.2517,-1350.8691 1309.7123,-1357.854"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1229.0614C226.373,-1207.4484 220.0449,-1167.1031 275.9407,-1142.0614 499.0235,-1042.1185 586.7105,-1047.9596 824.6331,-1104.0614 926.3013,-1128.0346 963.0561,-1133.2364 1034.9011,-1209.0614 1062.5571,-1238.2494 1044.7442,-1261.5228 1070.9011,-1292.0614 1102.2945,-1328.7136 1115.0387,-1342.4615 1162.6956,-1350.0614"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/plantwaterthermaltank.f90.html" xlink:title="PlantWaterThermalTank.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="239.8174,-1915.0668 98.3111,-1915.0668 98.3111,-1893.056 239.8174,-1893.056 239.8174,-1915.0668"/>
<text text-anchor="middle" x="169.0642" y="-1900.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterThermalTank.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge215" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M31.319,-1374.3967C32.8226,-1440.5734 43.113,-1776.9438 98.1877,-1861.0614 105.7894,-1872.6717 117.7195,-1881.6361 129.6392,-1888.3007"/>
<polygon fill="#ff0000" stroke="#ff0000" points="128.1872,-1891.4898 138.6802,-1892.9547 131.3909,-1885.2659 128.1872,-1891.4898"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="997.2254,-1240.0668 898.3088,-1240.0668 898.3088,-1218.056 997.2254,-1218.056 997.2254,-1240.0668"/>
<text text-anchor="middle" x="947.7671" y="-1225.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge216" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1229.0614C306.4644,-1176.1508 699.17,-1056.0071 824.6331,-1133.0614 854.7813,-1151.5772 833.3569,-1181.5278 860.6331,-1204.0614 868.7242,-1210.7457 878.5128,-1215.6441 888.5653,-1219.2332"/>
<polygon fill="#ff0000" stroke="#ff0000" points="887.6476,-1222.6138 898.2374,-1222.2889 889.7564,-1215.9389 887.6476,-1222.6138"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1245.1973,-1516.0668 1080.1938,-1516.0668 1080.1938,-1494.056 1245.1973,-1494.056 1245.1973,-1516.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1501.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge217" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M553.1938,-1838.0614C596.4544,-1833.7679 821.8309,-1615.665 860.6331,-1596.0614 896.4856,-1577.948 910.2887,-1586.5139 947.7671,-1572.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1847.0614C199.7363,-1876.7581 511.2113,-1845.8162 553.1938,-1838.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M32.818,-1374.3825C43.0894,-1440.4321 98.1784,-1775.5375 169.0642,-1847.0614"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.6095,-1279.0668 277.859,-1279.0668 277.859,-1257.056 443.6095,-1257.056 443.6095,-1279.0668"/>
<text text-anchor="middle" x="360.7343" y="-1264.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge218" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1229.0614C182.021,-1224.0913 256.58,-1241.3697 308.7881,-1254.5102"/>
<polygon fill="#ff0000" stroke="#ff0000" points="308.028,-1257.9281 318.5814,-1256.9922 309.7478,-1251.1426 308.028,-1257.9281"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1247.3932,-1283.0668 1077.9979,-1283.0668 1077.9979,-1261.056 1247.3932,-1261.056 1247.3932,-1283.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1268.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge219" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-962.0614C230.5509,-802.7938 382.4696,-962.0614 553.1938,-962.0614 553.1938,-962.0614 553.1938,-962.0614 742.7465,-962.0614 873.0304,-962.0614 940.3652,-896.4129 1034.9011,-986.0614 1121.1474,-1067.8488 990.7153,-1163.3241 1070.9011,-1251.0614 1072.1143,-1252.3888 1073.3927,-1253.641 1074.7285,-1254.8218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1072.8133,-1257.7572 1082.9517,-1260.8334 1076.9445,-1252.1062 1072.8133,-1257.7572"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1234.7967,-1557.0668 1090.5944,-1557.0668 1090.5944,-1535.056 1234.7967,-1535.056 1234.7967,-1557.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1542.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge220" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M553.1938,-1838.0614C781.4675,-1785.405 857.6651,-1777.2572 1034.9011,-1624.0614 1057.5696,-1604.4676 1046.4488,-1584.3779 1070.9011,-1567.0614 1074.0197,-1564.8529 1077.3341,-1562.8726 1080.7826,-1561.0973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1082.5031,-1564.161 1090.1815,-1556.8607 1079.6265,-1557.7793 1082.5031,-1564.161"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.6414,-1598.0668 1121.7498,-1598.0668 1121.7498,-1576.056 1203.6414,-1576.056 1203.6414,-1598.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1583.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge221" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-1847.0614C205.1062,-1883.4279 226.1749,-1878.0233 275.9407,-1890.0614 426.8921,-1926.5759 473.9189,-1945.6191 624.8599,-1909.0614 824.0541,-1860.8169 865.1939,-1812.976 1034.9011,-1698.0614 1077.0949,-1669.4905 1120.7601,-1628.6986 1144.5456,-1605.3492"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1147.179,-1607.667 1151.819,-1598.1422 1142.252,-1602.6946 1147.179,-1607.667"/>
</g>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~heatrecovery.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/heatrecovery.f90.html" xlink:title="HeatRecovery.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.8314,-1509.0668 121.297,-1509.0668 121.297,-1487.056 216.8314,-1487.056 216.8314,-1509.0668"/>
<text text-anchor="middle" x="169.0642" y="-1494.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatRecovery.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge222" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M42.3846,-1374.109C66.0332,-1397.2485 120.986,-1451.0182 150.1294,-1479.5343"/>
<polygon fill="#ff0000" stroke="#ff0000" points="148.0221,-1482.3691 157.6175,-1486.8611 152.9177,-1477.3657 148.0221,-1482.3691"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="228.006,-1088.0668 110.1225,-1088.0668 110.1225,-1066.056 228.006,-1066.056 228.006,-1088.0668"/>
<text text-anchor="middle" x="169.0642" y="-1073.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge223" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M35.9592,-1351.8354C46.7701,-1327.0032 73.7661,-1265.6121 98.1877,-1215.0614 118.5502,-1172.9128 143.9315,-1124.3893 158.1322,-1097.5728"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.3954,-1098.8901 162.9935,-1088.4165 155.2128,-1095.6076 161.3954,-1098.8901"/>
</g>
<!-- sourcefile~costestimatemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~costestimatemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/costestimatemanager.f90.html" xlink:title="CostEstimateManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2052.9067,-78.0668 1920.2732,-78.0668 1920.2732,-56.056 2052.9067,-56.056 2052.9067,-78.0668"/>
<text text-anchor="middle" x="1986.59" y="-63.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CostEstimateManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~costestimatemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge224" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~costestimatemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M742.7465,-107.0614C929.1577,-116.3806 976.0515,-107.0614 1162.6956,-107.0614 1162.6956,-107.0614 1162.6956,-107.0614 1563.457,-107.0614 1685.0604,-107.0614 1825.4526,-90.4847 1910.0482,-78.6739"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1910.67,-82.1209 1920.0832,-77.2586 1909.6924,-75.1895 1910.67,-82.1209"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.0642,-962.0614C235.5932,-785.3364 142.395,-252.5658 275.9407,-119.0614 422.7147,27.6673 535.5489,-95.1828 742.7465,-107.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M31.8342,-1351.965C34.9116,-1310.9775 48.9331,-1164.9101 98.1877,-1057.0614 120.0718,-1009.1438 150.3643,-1011.309 169.0642,-962.0614"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="606.6999,-1279.0668 499.6878,-1279.0668 499.6878,-1257.056 606.6999,-1257.056 606.6999,-1279.0668"/>
<text text-anchor="middle" x="553.1938" y="-1264.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge225" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M360.7343,-1229.0614C414.032,-1226.5057 474.0982,-1241.6527 512.7346,-1253.8115"/>
<polygon fill="#ff0000" stroke="#ff0000" points="511.9672,-1257.2416 522.559,-1256.9848 514.1188,-1250.5805 511.9672,-1257.2416"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.398,-1164.1016C800.4878,-1167.7983 813.3169,-1172.4421 824.6331,-1178.0614 842.3101,-1186.8393 842.8824,-1195.4332 860.6331,-1204.0614 869.3523,-1208.2996 878.9206,-1211.9457 888.4246,-1215.0393"/>
<polygon fill="#ff0000" stroke="#ff0000" points="887.6801,-1218.472 898.2671,-1218.0647 889.7368,-1211.7809 887.6801,-1218.472"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1626.1706,-1321.0668 1500.7435,-1321.0668 1500.7435,-1299.056 1626.1706,-1299.056 1626.1706,-1321.0668"/>
<text text-anchor="middle" x="1563.457" y="-1306.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M806.1589,-1149.694C916.0263,-1144.376 1132.9384,-1136.3458 1162.6956,-1154.0614"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1852.5558,-1049.0668 1708.8602,-1049.0668 1708.8602,-1027.056 1852.5558,-1027.056 1852.5558,-1049.0668"/>
<text text-anchor="middle" x="1780.708" y="-1034.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M752.7767,-1141.8796C771.6156,-1121.7465 814.5626,-1079.8424 860.6331,-1062.0614 986.2732,-1013.5703 1028.0225,-1037.957 1162.6956,-1038.0614"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="982.5482,-1507.0668 912.986,-1507.0668 912.986,-1485.056 982.5482,-1485.056 982.5482,-1507.0668"/>
<text text-anchor="middle" x="947.7671" y="-1492.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.3357,-1164.0852C778.6726,-1213.1659 897.6386,-1412.1963 935.8725,-1476.1617"/>
<polygon fill="#ff0000" stroke="#ff0000" points="932.9645,-1478.1185 941.0994,-1484.9063 938.973,-1474.5271 932.9645,-1478.1185"/>
</g>
<!-- sourcefile~hvacmultispeedheatpump.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~hvacmultispeedheatpump.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M370.2346,-1395.0848C386.0102,-1413.4297 418.546,-1451.4353 445.5278,-1484.0614 542.6839,-1601.5415 529.3742,-1673.9097 660.8599,-1751.0614 772.4317,-1816.5282 819.0761,-1786.9161 947.7671,-1800.0614"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M568.8861,-1447.8612C584.4506,-1436.1968 608.3068,-1416.7627 624.8599,-1396.0614 690.2565,-1314.2759 640.2283,-1213.4061 742.7465,-1192.0614"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M1367.8931,-1800.0614C1487.8816,-1701.1436 1424.5487,-1613.843 1481.2961,-1469.0614 1501.6705,-1417.0797 1533.9213,-1359.7359 1551.3385,-1330.1671"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="1554.5367,-1331.6365 1556.638,-1321.2522 1548.5195,-1328.0597 1554.5367,-1331.6365"/>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M571.5314,-1470.1513C588.135,-1481.1924 611.9158,-1499.6938 624.8599,-1522.0614 665.2869,-1591.92 607.7917,-1639.2475 660.8599,-1700.0614 705.2531,-1750.9342 880.5315,-1793.8831 947.7671,-1800.0614"/>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M947.7671,-1800.0614C994.3122,-1803.6162 1331.8741,-1829.7552 1367.8931,-1800.0614"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M570.2304,-1470.0714C590.7591,-1482.623 626.7571,-1502.3928 660.8599,-1510.0614 744.6807,-1528.91 845.6182,-1516.0497 902.6746,-1505.6221"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="903.6256,-1509.0045 912.8036,-1503.7115 902.3281,-1502.1258 903.6256,-1509.0045"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1416.2347,-1339.421C1440.9076,-1334.5006 1471.2796,-1328.4437 1498.0162,-1323.1118"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1498.9435,-1326.4959 1508.0658,-1321.1077 1497.5744,-1319.6311 1498.9435,-1326.4959"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1162.6956,-2027.0614C1203.9139,-2025.0112 1213.9186,-2020.6189 1254.49,-2013.0614 1267.1747,-2010.6986 1357.0495,-1995.0544 1367.8931,-1988.0614"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M553.1938,-2067.0614C601.8001,-2064.5678 612.4933,-2052.489 660.8599,-2047.0614 882.6827,-2022.1691 939.756,-2038.1505 1162.6956,-2027.0614"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M182.8143,-1915.1636C230.8572,-1952.7575 396.8118,-2072.6232 553.1938,-2067.0614"/>
</g>
<!-- sourcefile~nonzoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node36" class="node">
<title>sourcefile~nonzoneequipmentmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node36"><a xlink:href="../sourcefile/nonzoneequipmentmanager.f90.html" xlink:title="NonZoneEquipmentManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="824.5198,-2078.0668 660.9731,-2078.0668 660.9731,-2056.056 824.5198,-2056.056 824.5198,-2078.0668"/>
<text text-anchor="middle" x="742.7465" y="-2063.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NonZoneEquipmentManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~nonzoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~nonzoneequipmentmanager.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M553.1938,-2067.0614C584.7881,-2065.4406 619.3835,-2065.037 650.2709,-2065.1651"/>
<polygon fill="#65ff00" stroke="#65ff00" points="650.5727,-2068.6669 660.5939,-2065.228 650.6154,-2061.6671 650.5727,-2068.6669"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node37" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node37"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1035.0354,-626.0668 860.4988,-626.0668 860.4988,-604.056 1035.0354,-604.056 1035.0354,-626.0668"/>
<text text-anchor="middle" x="947.7671" y="-611.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M217.3468,-1915.0748C276.1676,-1925.6601 376.2466,-1934.2622 445.5278,-1890.0614 448.2287,-1888.3383 659.362,-1484.8934 660.8599,-1482.0614 733.528,-1344.6645 781.6816,-1322.4392 824.6331,-1173.0614 855.1107,-1067.0656 806.9177,-774.3872 860.6331,-678.0614 872.2746,-657.185 894.0698,-641.4311 912.9488,-630.8983"/>
<polygon fill="#65ff00" stroke="#65ff00" points="914.7239,-633.9188 921.9251,-626.1475 911.4494,-627.7319 914.7239,-633.9188"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node38" class="node">
<title>sourcefile~packagedthermalstoragecoil.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node38"><a xlink:href="../sourcefile/packagedthermalstoragecoil.f90.html" xlink:title="PackagedThermalStorageCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.3219,-1566.0668 276.1466,-1566.0668 276.1466,-1544.056 445.3219,-1544.056 445.3219,-1566.0668"/>
<text text-anchor="middle" x="360.7343" y="-1551.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedThermalStorageCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M195.9401,-1892.9525C210.6199,-1885.7248 228.1553,-1875.033 239.9407,-1861.0614 315.4052,-1771.598 347.4549,-1629.2857 357.2398,-1576.0597"/>
<polygon fill="#65ff00" stroke="#65ff00" points="360.7052,-1576.5614 358.9974,-1566.1051 353.8119,-1575.3442 360.7052,-1576.5614"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node39" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node39"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1431.3958,-2038.0668 1304.3904,-2038.0668 1304.3904,-2016.056 1431.3958,-2016.056 1431.3958,-2038.0668"/>
<text text-anchor="middle" x="1367.8931" y="-2023.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1162.6956,-2027.0614C1206.1358,-2024.9007 1254.813,-2024.8009 1293.8517,-2025.2878"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1294.0277,-2028.7905 1304.0759,-2025.4313 1294.126,-2021.7912 1294.0277,-2028.7905"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M953.2302,-1217.9614C974.1676,-1177.178 1053.6227,-1037.9768 1162.6956,-1038.0614"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node35" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node35"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1422.2033,-818.0668 1313.5828,-818.0668 1313.5828,-796.056 1422.2033,-796.056 1422.2033,-818.0668"/>
<text text-anchor="middle" x="1367.8931" y="-803.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M956.2494,-1217.7181C973.1482,-1194.6942 1011.4069,-1140.3861 1034.9011,-1090.0614 1056.8404,-1043.0673 1039.3223,-1020.2021 1070.9011,-979.0614 1130.1075,-901.9278 1175.2423,-916.4067 1254.49,-860.0614 1271.0098,-848.3158 1272.5742,-841.5423 1290.49,-832.0614 1298.1984,-827.9822 1306.6922,-824.4162 1315.144,-821.3532"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1316.2967,-824.6581 1324.6244,-818.1082 1314.0298,-818.0353 1316.2967,-824.6581"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1245.2344,-1500.6256C1355.4102,-1489.9132 1547.9633,-1453.499 1645.6179,-1330.0614 1719.9099,-1236.1547 1601.8701,-1152.3814 1681.6179,-1063.0614 1686.6547,-1057.4201 1692.7613,-1052.9643 1699.4418,-1049.4556"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1701.1659,-1052.5185 1708.8608,-1045.2357 1698.3038,-1046.1303 1701.1659,-1052.5185"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1418.6794,-1590.0668 1317.1068,-1590.0668 1317.1068,-1568.056 1418.6794,-1568.056 1418.6794,-1590.0668"/>
<text text-anchor="middle" x="1367.8931" y="-1575.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1219.5393,-1516.083C1231.2272,-1518.9005 1243.3584,-1522.2355 1254.49,-1526.0614 1283.9822,-1536.1978 1316.0436,-1551.6236 1338.527,-1563.224"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1337.0572,-1566.4049 1347.541,-1567.9347 1340.2994,-1560.201 1337.0572,-1566.4049"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge140" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1229.0614C602.5459,-1209.88 611.4819,-1197.1761 660.8599,-1178.0614 671.0483,-1174.1174 682.1364,-1170.3773 692.7677,-1167.0491"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="693.8246,-1170.386 702.3639,-1164.1145 691.7774,-1163.692 693.8246,-1170.386"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge141" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1382.0614C675.1847,-1441.3413 1028.4345,-1330.8302 1162.6956,-1350.0614"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge142" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1229.0614C633.199,-1197.9662 658.713,-1209.5575 742.7465,-1192.0614"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M742.7465,-1192.0614C771.5443,-1186.0656 846.5146,-1202.6259 897.3579,-1215.4997"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="896.6282,-1218.9258 907.184,-1218.0176 898.3657,-1212.1448 896.6282,-1218.9258"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge143" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M947.7671,-1572.0614C1002.2751,-1551.042 1014.9405,-1542.8347 1070.9011,-1526.0614 1079.9668,-1523.3441 1089.6264,-1520.7819 1099.1477,-1518.4436"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1100.0772,-1521.8201 1108.9893,-1516.0908 1098.4495,-1515.012 1100.0772,-1521.8201"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1382.0614C583.2427,-1397.0736 600.9884,-1382.4298 624.8599,-1406.0614 659.6208,-1440.4732 632.1224,-1470.4805 660.8599,-1510.0614 687.6796,-1547.001 701.4356,-1552.6386 742.7465,-1572.0614"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M742.7465,-1572.0614C783.9769,-1591.4464 905.2581,-1588.4538 947.7671,-1572.0614"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge146" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M947.7671,-1306.0614C995.2125,-1300.1397 1048.2782,-1291.7629 1089.8102,-1284.8059"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1090.5592,-1288.2291 1099.8386,-1283.1162 1089.396,-1281.3264 1090.5592,-1288.2291"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge147" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M947.7671,-1610.0614C987.2057,-1602.4393 997.5566,-1600.8561 1034.9011,-1586.0614 1051.721,-1579.3979 1053.9392,-1573.3543 1070.9011,-1567.0614 1078.2295,-1564.3425 1086.0225,-1561.9067 1093.8509,-1559.7431"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1094.9678,-1563.0687 1103.7535,-1557.1473 1093.1928,-1556.2974 1094.9678,-1563.0687"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M742.7465,-1572.0614C826.6118,-1611.4917 856.7786,-1627.6463 947.7671,-1610.0614"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge152" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1382.0614C589.6009,-1400.2501 602.9141,-1404.7877 624.8599,-1439.0614 661.1312,-1495.708 612.072,-1539.7561 660.8599,-1586.0614 790.2717,-1708.8882 1033.7741,-1635.8435 1126.0189,-1601.7034"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1127.3621,-1604.9376 1135.487,-1598.1378 1124.8951,-1598.3867 1127.3621,-1604.9376"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge153" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M443.7509,-1268.0614C458.978,-1268.0614 474.6549,-1268.0614 489.2176,-1268.0614"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="489.6021,-1271.5615 499.6021,-1268.0614 489.6021,-1264.5615 489.6021,-1271.5615"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge148" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M742.7465,-1496.0614C779.7687,-1503.5844 1033.6315,-1413.243 1070.9011,-1407.0614 1136.1429,-1396.2403 1305.8012,-1410.8253 1367.8931,-1388.0614"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1367.8931,-1388.0614C1401.0436,-1375.5792 1412.0443,-1381.2711 1445.2961,-1369.0614 1477.2668,-1357.3221 1511.9166,-1339.3431 1535.3736,-1326.3172"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1537.3943,-1329.1964 1544.3955,-1321.2445 1533.9635,-1323.0948 1537.3943,-1329.1964"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1382.0614C582.3293,-1396.3569 596.4208,-1380.4263 624.8599,-1396.0614 645.2465,-1407.2694 643.5275,-1418.5429 660.8599,-1434.0614 694.8691,-1464.5115 698.0669,-1486.7036 742.7465,-1496.0614"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge149" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M742.7465,-1496.0614C796.9292,-1507.0714 860.843,-1504.7201 902.7294,-1501.1685"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="903.2418,-1504.6365 912.8846,-1500.2471 902.6092,-1497.6652 903.2418,-1504.6365"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1252.0347,-1126.0668 1073.3564,-1126.0668 1073.3564,-1104.056 1252.0347,-1104.056 1252.0347,-1126.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1111.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge145" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M410.4897,-1279.0889C422.3413,-1282.6935 434.6872,-1287.2967 445.5278,-1293.0614 500.3433,-1322.2107 496.7871,-1356.1252 553.1938,-1382.0614"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1382.0614C601.4749,-1404.2614 610.6144,-1347.3615 660.8599,-1330.0614 680.9633,-1323.1396 1019.0934,-1263.2803 1034.9011,-1249.0614 1072.8324,-1214.9428 1033.8808,-1175.1664 1070.9011,-1140.0614 1074.6989,-1136.4601 1078.963,-1133.3673 1083.5196,-1130.7122"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1085.2491,-1133.7599 1092.5975,-1126.1275 1082.0934,-1127.5115 1085.2491,-1133.7599"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1207.3133,-1242.0668 1118.0778,-1242.0668 1118.0778,-1220.056 1207.3133,-1220.056 1207.3133,-1242.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1227.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge151" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M947.7671,-1306.0614C987.6262,-1301.0865 999.3046,-1300.6729 1034.9011,-1282.0614 1053.3579,-1272.4114 1052.2371,-1261.3043 1070.9011,-1252.0614 1082.3454,-1246.3939 1095.3527,-1242.2298 1107.9035,-1239.1794"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1108.8345,-1242.5578 1117.8325,-1236.9643 1107.3103,-1235.7258 1108.8345,-1242.5578"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1382.0614C573.6367,-1391.0301 925.6153,-1308.8262 947.7671,-1306.0614"/>
</g>
<!-- sourcefile~unitventilator.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node55" class="node">
<title>sourcefile~unitventilator.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node55"><a xlink:href="../sourcefile/unitventilator.f90.html" xlink:title="UnitVentilator.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1208.5924,-1010.0668 1116.7987,-1010.0668 1116.7987,-988.056 1208.5924,-988.056 1208.5924,-1010.0668"/>
<text text-anchor="middle" x="1162.6956" y="-995.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UnitVentilator.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~unitventilator.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge144" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~unitventilator.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M427.3311,-1257.0499C473.4845,-1248.9483 530.5531,-1237.8611 553.1938,-1229.0614"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M553.1938,-1229.0614C649.1162,-1191.7798 578.1657,-1085.3205 660.8599,-1024.0614 727.9939,-974.3291 951.4603,-981.8283 1034.9011,-986.0614 1058.5612,-987.2617 1084.5906,-989.7044 1106.9489,-992.1517"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="1106.6138,-995.6359 1116.9416,-993.272 1107.3938,-988.6795 1106.6138,-995.6359"/>
</g>
<!-- sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node56" class="node">
<title>sourcefile~ventilatedslab.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node56"><a xlink:href="../sourcefile/ventilatedslab.f90.html" xlink:title="VentilatedSlab.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="601.3507,-934.0668 505.037,-934.0668 505.037,-912.056 601.3507,-912.056 601.3507,-934.0668"/>
<text text-anchor="middle" x="553.1938" y="-919.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VentilatedSlab.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge150" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M426.9391,-1257.0459C433.9758,-1253.547 440.4161,-1248.989 445.5278,-1243.0614 520.851,-1155.7165 426.7981,-1087.5866 481.5278,-986.0614 491.8084,-966.9907 510.2886,-950.9632 525.9075,-939.8467"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="527.9233,-942.7085 534.2201,-934.1879 523.9841,-936.922 527.9233,-942.7085"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge154" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1241.8049,-1260.8803C1246.4576,-1258.1926 1250.755,-1254.9544 1254.49,-1251.0614 1315.2017,-1187.7814 1230.2803,-1120.8193 1290.49,-1057.0614 1314.8107,-1031.3075 1333.6757,-1047.2229 1367.8931,-1038.0614"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge155" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1173.4281,-1283.159C1193.623,-1304.85 1236.8272,-1355.2908 1254.49,-1407.0614 1297.2623,-1532.4298 1209.3359,-1897.3679 1290.49,-2002.0614 1292.9976,-2005.2964 1295.9296,-2008.1193 1299.1577,-2010.582"/>
<polygon fill="#00cbff" stroke="#00cbff" points="1297.3955,-2013.6086 1307.719,-2015.9911 1301.1345,-2007.6908 1297.3955,-2013.6086"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge156" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1233.2628,-1534.9834C1240.7141,-1532.3496 1247.948,-1529.0915 1254.49,-1525.0614 1321.7877,-1483.6034 1293.6805,-1415.2689 1367.8931,-1388.0614"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge158" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1203.7124,-1579.0515C1219.7002,-1575.5729 1238.0895,-1571.1294 1254.49,-1566.0614 1434.9147,-1510.3069 1535.0637,-1553.1608 1645.6179,-1400.0614 1733.8011,-1277.9422 1582.8578,-1176.7971 1681.6179,-1063.0614 1686.5763,-1057.3511 1692.6307,-1052.8493 1699.2785,-1049.3119"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1700.9979,-1052.3755 1708.6645,-1045.0629 1698.1111,-1045.9985 1700.9979,-1052.3755"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge157" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1203.7272,-1585.4617C1233.2989,-1584.3088 1273.6992,-1582.7337 1307.0213,-1581.4346"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1307.2595,-1584.9281 1317.1155,-1581.0411 1306.9867,-1577.9334 1307.2595,-1584.9281"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge160" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M360.7343,-1498.0614C410.8997,-1495.5265 467.0702,-1482.9915 505.7175,-1472.8067"/>
<polygon fill="#6500ff" stroke="#6500ff" points="506.8918,-1476.1154 515.6417,-1470.1414 505.0761,-1469.355 506.8918,-1476.1154"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M216.7526,-1499.3962C255.553,-1500.161 311.7146,-1500.5384 360.7343,-1498.0614"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge162" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M360.7343,-1498.0614C478.2768,-1492.1219 527.2105,-1544.7586 624.8599,-1479.0614 654.8744,-1458.8681 636.5185,-1432.8222 660.8599,-1406.0614 733.4167,-1326.2928 850.144,-1269.6628 909.8807,-1244.1833"/>
<polygon fill="#6500ff" stroke="#6500ff" points="911.4481,-1247.3211 919.31,-1240.2189 908.7351,-1240.8682 911.4481,-1247.3211"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge163" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M171.6274,-1486.7665C180.0585,-1452.2323 210.2324,-1347.1233 275.9407,-1293.0614 280.5721,-1289.2509 285.7654,-1286.0211 291.2412,-1283.2836"/>
<polygon fill="#6500ff" stroke="#6500ff" points="292.9349,-1286.362 300.6737,-1279.1258 290.1115,-1279.9567 292.9349,-1286.362"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge164" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M553.1938,-1895.0614C601.185,-1901.1599 612.6144,-1907.4962 660.8599,-1911.0614 924.9856,-1930.5798 1002.4483,-1940.4145 1254.49,-1859.0614 1308.5579,-1841.6096 1324.5234,-1836.7626 1367.8931,-1800.0614"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge159" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M360.7343,-1876.0614C458.9896,-1957.9386 1270.9317,-2046.4537 1367.8931,-1988.0614"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1367.8931,-1988.0614C1463.1031,-1928.3585 1420.0846,-1856.3086 1481.2961,-1762.0614 1539.0569,-1673.1274 1602.9581,-1686.1475 1645.6179,-1589.0614 1692.75,-1481.7973 1606.4992,-1152.9736 1681.6179,-1063.0614 1686.5449,-1057.1641 1692.6412,-1052.5467 1699.37,-1048.945"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1701.2197,-1051.9497 1708.8874,-1044.6381 1698.3338,-1045.5722 1701.2197,-1051.9497"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge165" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M179.6298,-1509.1248C197.4878,-1526.954 235.6508,-1561.4209 275.9407,-1575.0614 506.9714,-1653.2792 593.923,-1665.2198 824.6331,-1586.0614 843.8057,-1579.4831 844.3716,-1570.1622 860.6331,-1558.0614 881.4344,-1542.5823 905.4717,-1525.5404 923.0237,-1513.2474"/>
<polygon fill="#6500ff" stroke="#6500ff" points="925.3656,-1515.8809 931.5597,-1507.2853 921.3573,-1510.1422 925.3656,-1515.8809"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1228.8435,-1850.0668 1096.5476,-1850.0668 1096.5476,-1828.056 1228.8435,-1828.056 1228.8435,-1850.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1835.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge161" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M360.7343,-1876.0614C426.7662,-1931.0865 467.6626,-1886.5528 553.1938,-1895.0614"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M553.1938,-1895.0614C754.6828,-1915.1053 993.9092,-1874.2838 1103.0604,-1852.1009"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1103.8063,-1855.5208 1112.8976,-1850.0803 1102.3978,-1848.664 1103.8063,-1855.5208"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M171.3648,-1509.3577C182.3323,-1560.2771 234.1161,-1770.5492 360.7343,-1876.0614"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge187" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M228.0297,-1084.873C333.4983,-1098.8452 554.1567,-1128.0775 669.287,-1143.3297"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="669.0437,-1146.828 679.4168,-1144.6717 669.9631,-1139.8886 669.0437,-1146.828"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge188" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M175.5241,-1088.2401C188.7367,-1111.3855 219.338,-1166.4581 239.9407,-1215.0614 259.3585,-1260.8697 246.6444,-1280.8472 275.9407,-1321.0614 290.1022,-1340.5006 312.0062,-1356.556 330.0039,-1367.5933"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="328.6064,-1370.8325 338.9978,-1372.8989 332.1631,-1364.8033 328.6064,-1370.8325"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge189" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360.7343,-1307.0614C389.6709,-1333.4562 417.0091,-1304.2156 445.5278,-1331.0614 480.8378,-1364.3001 447.2276,-1399.7817 481.5278,-1434.0614 485.1629,-1437.6942 489.3536,-1440.8004 493.8464,-1443.4561"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="492.2945,-1446.5936 502.7919,-1448.0278 495.4801,-1440.3604 492.2945,-1446.5936"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge190" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M742.7465,-1038.0614C831.86,-1063.4961 862.6122,-1039.4993 947.7671,-1076.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M947.7671,-1076.0614C984.1033,-1091.6627 1003.6827,-1069.7893 1034.9011,-1094.0614 1063.7751,-1116.5107 1042.3255,-1145.2335 1070.9011,-1168.0614 1136.3769,-1220.3673 1192.9569,-1154.1697 1254.49,-1211.0614 1293.1922,-1246.8443 1253.2933,-1286.716 1290.49,-1324.0614 1296.0255,-1329.6191 1302.803,-1333.9419 1310.0229,-1337.3042"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1308.7615,-1340.5694 1319.3445,-1341.07 1311.3835,-1334.079 1308.7615,-1340.5694"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge191" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M742.7465,-1038.0614C786.6559,-1050.5432 794.8414,-1065.474 824.6331,-1100.0614 846.4393,-1125.378 838.549,-1140.9867 860.6331,-1166.0614 877.2039,-1184.8763 900.3709,-1201.2898 918.6516,-1212.6428"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="917.0736,-1215.7785 927.4434,-1217.9509 920.6917,-1209.786 917.0736,-1215.7785"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge192" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M742.7465,-1038.0614C778.9264,-1048.346 1014.0791,-1177.7373 1034.9011,-1209.0614 1102.1628,-1310.248 990.9229,-1388.5937 1070.9011,-1480.0614 1073.7755,-1483.3487 1077.0351,-1486.2236 1080.5698,-1488.7363"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1078.8914,-1491.811 1089.2649,-1493.9654 1082.499,-1485.8123 1078.8914,-1491.811"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge197" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M947.7671,-1076.0614C991.4409,-1094.8132 1006.8845,-1099.6674 1034.9011,-1138.0614 1065.9712,-1180.6399 1032.1066,-1215.3787 1070.9011,-1251.0614 1072.6609,-1252.68 1074.5191,-1254.1822 1076.4589,-1255.576"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1075.068,-1258.8257 1085.4336,-1261.0178 1078.6974,-1252.8401 1075.068,-1258.8257"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge199" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360.7343,-1307.0614C388.954,-1332.8024 414.9697,-1298.1451 445.5278,-1321.0614 475.1085,-1343.2447 453.4245,-1372.0341 481.5278,-1396.0614 532.0789,-1439.2807 579.0529,-1390.8427 624.8599,-1439.0614 671.1875,-1487.8282 609.7199,-1542.3676 660.8599,-1586.0614 758.146,-1669.1823 822.1322,-1634.3422 947.7671,-1610.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M174.8217,-1088.1206C186.9735,-1111.4951 216.0857,-1167.6673 239.9407,-1215.0614 256.2048,-1247.3743 247.5082,-1265.6954 275.9407,-1288.0614 306.2951,-1311.9393 332.132,-1281.1103 360.7343,-1307.0614"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~costestimatemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge204" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~costestimatemanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M553.1938,-107.0614C636.9844,-115.806 658.6059,-102.855 742.7465,-107.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M180.1252,-1065.828C196.5484,-1048.3405 226.8483,-1012.7844 239.9407,-976.0614 313.5683,-769.5424 200.0246,-689.7502 275.9407,-484.0614 347.9567,-288.9394 346.3295,-85.4725 553.1938,-107.0614"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge198" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1367.8931,-1310.0614C1408.0241,-1317.4756 1453.5832,-1317.9275 1490.626,-1316.3205"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1491.0212,-1319.8053 1500.8365,-1315.8167 1490.6761,-1312.8138 1491.0212,-1319.8053"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1162.6956,-1154.0614C1198.8091,-1174.0356 1218.7606,-1147.408 1254.49,-1168.0614 1324.415,-1208.4817 1288.4701,-1295.388 1367.8931,-1310.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M947.7671,-1000.0614C994.4593,-1008.942 1004.0912,-1025.8705 1034.9011,-1062.0614 1058.3509,-1089.6068 1042.287,-1112.9283 1070.9011,-1135.0614 1103.8555,-1160.5517 1126.2381,-1133.897 1162.6956,-1154.0614"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge201" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M742.7465,-1420.0614C793.2523,-1452.5368 859.6178,-1473.8955 902.9618,-1485.4767"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="902.0934,-1488.8672 912.6532,-1488.0057 903.8609,-1482.094 902.0934,-1488.8672"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M196.964,-1088.2404C218.3971,-1096.6482 248.8239,-1108.1963 275.9407,-1117.0614 429.0425,-1167.1137 497.7463,-1116.1294 624.8599,-1215.0614 707.8013,-1279.6144 654.343,-1363.2177 742.7465,-1420.0614"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge195" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M742.7465,-1038.0614C831.8871,-1063.4007 856.7269,-982.7461 947.7671,-1000.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M947.7671,-1000.0614C980.8075,-1006.3455 1040.7016,-1073.2576 1070.9011,-1088.0614 1081.284,-1093.1511 1092.8073,-1097.4691 1104.0832,-1101.0589"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1103.3087,-1104.4812 1113.8938,-1104.0271 1105.3359,-1097.7811 1103.3087,-1104.4812"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M553.1938,-1000.0614C639.1096,-999.0417 660.0989,-1014.5679 742.7465,-1038.0614"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~unitventilator.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge194" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~unitventilator.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M189.4974,-1065.8535C210.6783,-1054.5395 244.9644,-1037.0677 275.9407,-1025.0614 312.575,-1010.8621 324.4745,-1015.1917 360.7343,-1000.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360.7343,-1000.0614C424.2773,-973.5465 422.0091,-937.6775 481.5278,-903.0614 555.6289,-859.9642 576.6557,-848.1237 660.8599,-832.0614 824.156,-800.912 903.7002,-729.972 1034.9011,-832.0614 1086.2856,-872.0445 1025.2701,-927.6198 1070.9011,-974.0614 1080.4947,-983.8255 1093.497,-989.8877 1106.6956,-993.6216"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1106.2325,-997.11 1116.7737,-996.0459 1107.8696,-990.3041 1106.2325,-997.11"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge202" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360.7343,-1000.0614C414.1624,-977.7672 476.4401,-953.0867 515.3482,-937.8223"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="516.6829,-941.0585 524.717,-934.1516 514.1293,-934.5409 516.6829,-941.0585"/>
</g>
<!-- sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node62" class="node">
<title>sourcefile~poweredinductionunits.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node62"><a xlink:href="../sourcefile/poweredinductionunits.f90.html" xlink:title="PoweredInductionUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="429.7276,-515.0668 291.7409,-515.0668 291.7409,-493.056 429.7276,-493.056 429.7276,-515.0668"/>
<text text-anchor="middle" x="360.7343" y="-500.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PoweredInductionUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge193" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M179.6915,-1066.0543C195.8307,-1048.5903 226.1027,-1012.739 239.9407,-976.0614 291.5531,-839.2625 230.0303,-787.8779 275.9407,-649.0614 292.0653,-600.3062 326.1277,-550.0169 345.8207,-523.3731"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="348.6927,-525.3773 351.9017,-515.2802 343.0964,-521.1723 348.6927,-525.3773"/>
</g>
<!-- sourcefile~unitheater.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node63" class="node">
<title>sourcefile~unitheater.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node63"><a xlink:href="../sourcefile/unitheater.f90.html" xlink:title="UnitHeater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1202.3229,-539.0668 1123.0683,-539.0668 1123.0683,-517.056 1202.3229,-517.056 1202.3229,-539.0668"/>
<text text-anchor="middle" x="1162.6956" y="-524.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UnitHeater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~unitheater.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge196" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~unitheater.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M177.981,-1065.6944C222.8276,-1009.3653 430.6785,-758.1504 660.8599,-640.0614 813.3967,-561.8061 1019.4992,-537.9315 1112.9506,-530.8868"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1113.2545,-534.3741 1122.9767,-530.1636 1112.7508,-527.3923 1113.2545,-534.3741"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node64" class="node">
<title>sourcefile~hvacsingleductsystem.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node64"><a xlink:href="../sourcefile/hvacsingleductsystem.f90.html" xlink:title="HVACSingleDuctSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1019.4635,-896.0668 876.0707,-896.0668 876.0707,-874.056 1019.4635,-874.056 1019.4635,-896.0668"/>
<text text-anchor="middle" x="947.7671" y="-881.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSingleDuctSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacsingleductsystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge200" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacsingleductsystem.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360.7343,-1000.0614C439.675,-967.1214 467.7629,-1004.3323 553.1938,-1000.0614"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M553.1938,-1000.0614C695.3904,-992.9526 723.8864,-949.694 860.6331,-910.0614 873.1567,-906.4317 886.7006,-902.5329 899.2927,-898.9194"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="900.5017,-902.2138 909.1496,-896.0931 898.5722,-895.485 900.5017,-902.2138"/>
</g>
<!-- sourcefile~hvacsingleductinduc.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node65" class="node">
<title>sourcefile~hvacsingleductinduc.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node65"><a xlink:href="../sourcefile/hvacsingleductinduc.f90.html" xlink:title="HVACSingleDuctInduc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1015.1429,-233.0668 880.3913,-233.0668 880.3913,-211.056 1015.1429,-211.056 1015.1429,-233.0668"/>
<text text-anchor="middle" x="947.7671" y="-218.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSingleDuctInduc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacsingleductinduc.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge203" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacsingleductinduc.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M553.1938,-107.0614C607.1589,-115.1329 609.5473,-147.5034 660.8599,-166.0614 729.5473,-190.9034 811.6855,-205.5129 870.4402,-213.5436"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="870.0202,-217.0185 880.3953,-214.872 870.9462,-210.08 870.0202,-217.0185"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2774.7045,-157.0668 2675.7469,-157.0668 2675.7469,-135.056 2774.7045,-135.056 2774.7045,-157.0668"/>
<text text-anchor="middle" x="2725.2257" y="-142.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~costestimatemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge205" class="edge">
<title>sourcefile~costestimatemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M2569.5417,-29.0614C2601.3414,-34.8387 2614.7785,-27.526 2639.7363,-48.0614 2667.671,-71.0462 2650.2799,-95.3591 2675.7363,-121.0614 2678.9867,-124.3432 2682.7573,-127.273 2686.7389,-129.8675"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="2685.2609,-133.0554 2695.6724,-135.0183 2688.7574,-126.9912 2685.2609,-133.0554"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2930.3226,-157.0668 2810.5121,-157.0668 2810.5121,-135.056 2930.3226,-135.056 2930.3226,-157.0668"/>
<text text-anchor="middle" x="2870.4174" y="-142.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~costestimatemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge206" class="edge">
<title>sourcefile~costestimatemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M2569.5417,-29.0614C2663.5248,-46.1362 2687.2547,-54.655 2774.7151,-93.0614 2798.9251,-103.6927 2825.1065,-118.4353 2843.9552,-129.6735"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="2842.2078,-132.7069 2852.5784,-134.8755 2845.8237,-126.7131 2842.2078,-132.7069"/>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M2027.6115,-56.0264C2123.8558,-31.9312 2371.0283,19.4912 2569.5417,-29.0614"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge207" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M600.9185,-1256.9108C609.4966,-1253.4382 617.9075,-1248.9211 624.8599,-1243.0614 650.1109,-1221.7788 635.1952,-1198.8434 660.8599,-1178.0614 665.5221,-1174.2861 670.7496,-1171.0799 676.2482,-1168.357"/>
<polygon fill="#ff0066" stroke="#ff0066" points="677.9494,-1171.433 685.706,-1164.216 675.1418,-1165.0207 677.9494,-1171.433"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge209" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M592.0547,-1256.938C602.9595,-1253.1726 614.626,-1248.5144 624.8599,-1243.0614 642.5106,-1233.6565 642.9772,-1225.0174 660.8599,-1216.0614 694.7699,-1199.0786 705.6177,-1199.7918 742.7465,-1192.0614"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge208" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M602.9226,-1279.1167C663.4457,-1291.9566 768.9298,-1312.3608 860.6331,-1320.0614 937.8139,-1326.5425 957.4574,-1321.224 1034.9011,-1320.0614 1182.9476,-1317.8389 1222.237,-1283.472 1367.8931,-1310.0614"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge210" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M565.3711,-1279.3462C594.4913,-1305.9814 671.076,-1373.9771 742.7465,-1420.0614"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1780.708,-1153.0614C1976.8105,-1059.1044 2063.8217,-1150.4739 2260.6567,-1058.0614 2322.5294,-1029.0127 2327.3226,-1004.6153 2380.002,-961.0614"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2035.869,-1088.0668 1937.3109,-1088.0668 1937.3109,-1066.056 2035.869,-1066.056 2035.869,-1088.0668"/>
<text text-anchor="middle" x="1986.59" y="-1073.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1780.708,-1153.0614C1821.5731,-1133.4821 1838.8116,-1148.3853 1879.7981,-1129.0614 1897.8883,-1120.5324 1898.1655,-1111.5002 1915.7981,-1102.0614 1923.069,-1098.1693 1931.0704,-1094.6739 1938.9969,-1091.6169"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1940.3885,-1094.8346 1948.5743,-1088.1082 1937.9805,-1088.2618 1940.3885,-1094.8346"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1575.6451,-1298.7588C1607.1172,-1270.1613 1694.6758,-1194.2813 1780.708,-1153.0614"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1852.6995,-1034.0697C1966.1995,-1026.6063 2193.0574,-1006.9339 2380.002,-961.0614"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2380.002,-961.0614C2550.1055,-911.6403 2693.8215,-290.2119 2720.7127,-167.1549"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2724.19,-167.634 2722.8869,-157.1197 2717.3487,-166.1518 2724.19,-167.634"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1838.88,-1049.0809C1866.5208,-1054.3168 1899.51,-1060.5659 1927.2936,-1065.829"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1926.7979,-1069.2972 1937.2746,-1067.7196 1928.1007,-1062.4195 1926.7979,-1069.2972"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982.7774,-1497.5274C1006.3955,-1498.5164 1038.7533,-1499.8714 1069.5203,-1501.1597"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1069.7407,-1504.672 1079.8784,-1501.5935 1070.0336,-1497.6781 1069.7407,-1504.672"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M954.5406,-1485.0481C971.6915,-1457.7145 1019.1637,-1385.4191 1070.9011,-1336.0614 1090.3171,-1317.5385 1115.504,-1300.3723 1134.5821,-1288.4911"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1136.4333,-1291.4617 1143.1396,-1283.2595 1132.7821,-1285.4894 1136.4333,-1291.4617"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982.7832,-1504.3711C1007.418,-1510.2019 1041.1642,-1518.1582 1070.9011,-1525.0614 1081.6304,-1527.5521 1093.0704,-1530.1864 1104.1038,-1532.7161"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1103.5611,-1536.1824 1114.0901,-1535.0028 1105.1236,-1529.359 1103.5611,-1536.1824"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M963.7332,-1507.1781C986.5118,-1522.5512 1030.1069,-1550.1959 1070.9011,-1566.0614 1083.7712,-1571.0668 1098.1419,-1575.0553 1111.6218,-1578.1531"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1111.201,-1581.6434 1121.7167,-1580.3505 1112.6899,-1574.8036 1111.201,-1581.6434"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1162.6956,-1466.0614C1204.0566,-1461.0601 1215.2394,-1461.0305 1254.49,-1447.0614 1308.0158,-1428.0119 1314.5503,-1407.6177 1367.8931,-1388.0614"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982.7094,-1490.7824C1025.1951,-1484.4566 1099.11,-1473.7501 1162.6956,-1466.0614"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1162.6956,-1466.0614C1299.2696,-1449.5469 1658.7393,-1565.6918 1780.708,-1502.0614"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M954.6747,-1507.0852C985.4294,-1556.1659 1110.1446,-1755.1963 1150.2262,-1819.1617"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1147.4299,-1821.2909 1155.7056,-1827.9063 1153.3616,-1817.574 1147.4299,-1821.2909"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1216.875,-1438.0668 1108.5161,-1438.0668 1108.5161,-1416.056 1216.875,-1416.056 1216.875,-1438.0668"/>
<text text-anchor="middle" x="1162.6956" y="-1423.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M976.9093,-1484.9293C1001.7248,-1475.6234 1038.4162,-1462.2722 1070.9011,-1452.0614 1083.3343,-1448.1533 1096.8239,-1444.2793 1109.5374,-1440.7896"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1110.7962,-1444.0748 1119.532,-1438.0801 1108.9645,-1437.3187 1110.7962,-1444.0748"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M954.5532,-1484.9777C970.864,-1457.8558 1012.5681,-1385.5725 1034.9011,-1320.0614 1061.226,-1242.8409 1015.2217,-1199.6919 1070.9011,-1140.0614 1074.0292,-1136.7113 1077.5578,-1133.7938 1081.3632,-1131.2543"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1083.1359,-1134.2726 1090.0883,-1126.278 1079.6678,-1128.1921 1083.1359,-1134.2726"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M953.274,-1484.829C976.5252,-1437.4448 1065.7053,-1256.1287 1070.9011,-1252.0614 1081.4671,-1243.7903 1094.6939,-1238.6642 1107.7891,-1235.5166"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1108.6392,-1238.9152 1117.7312,-1233.476 1107.2317,-1232.0582 1108.6392,-1238.9152"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2774.7864,-146.0614C2783.0527,-146.0614 2791.7636,-146.0614 2800.4251,-146.0614"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2800.5405,-149.5615 2810.5405,-146.0614 2800.5405,-142.5615 2800.5405,-149.5615"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2177.0193,-1154.0614C2266.7854,-1163.0448 2289.8598,-1157.6731 2380.002,-1154.0614"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2004.0779,-1088.121C2036.5992,-1107.7547 2109.2452,-1147.2789 2177.0193,-1154.0614"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2248.8568,-1049.0668 2105.1817,-1049.0668 2105.1817,-1027.056 2248.8568,-1027.056 2248.8568,-1049.0668"/>
<text text-anchor="middle" x="2177.0193" y="-1034.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2036.1259,-1066.9164C2059.6695,-1062.0947 2088.0963,-1056.2729 2113.232,-1051.1251"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2113.9543,-1054.5499 2123.0487,-1049.1146 2112.5497,-1047.6922 2113.9543,-1054.5499"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3056.1383,-137.0668 2972.7213,-137.0668 2972.7213,-115.056 3056.1383,-115.056 3056.1383,-137.0668"/>
<text text-anchor="middle" x="3014.4298" y="-122.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2930.2405,-137.7534C2940.9051,-136.2723 2951.9369,-134.7402 2962.3633,-133.2922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2963.1283,-136.7197 2972.5517,-131.8773 2962.1653,-129.7862 2963.1283,-136.7197"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3062.5509,-178.0668 2966.3087,-178.0668 2966.3087,-156.056 3062.5509,-156.056 3062.5509,-178.0668"/>
<text text-anchor="middle" x="3014.4298" y="-163.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2930.2405,-154.7849C2938.7014,-156.0186 2947.3935,-157.2861 2955.8309,-158.5165"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2955.5635,-162.0144 2965.9639,-159.9941 2956.5736,-155.0877 2955.5635,-162.0144"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2380.002,-1154.0614C2554.3898,-1130.2968 2594.0769,-1077.4321 2725.2257,-960.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2186.8546,-1049.123C2214.3679,-1078.7507 2295.6453,-1157.4413 2380.002,-1154.0614"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2463.1927,-350.0668 2296.8112,-350.0668 2296.8112,-328.056 2463.1927,-328.056 2463.1927,-350.0668"/>
<text text-anchor="middle" x="2380.002" y="-335.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2183.3827,-1026.7575C2198.7053,-999.1182 2238.0509,-925.5841 2260.6567,-860.0614 2325.7241,-671.4646 2365.6768,-432.1745 2376.8056,-360.3611"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2380.2911,-360.7212 2378.3436,-350.3069 2373.3716,-359.6626 2380.2911,-360.7212"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2418.3883,-327.9304C2473.8334,-310.0995 2576.5883,-270.2444 2639.7363,-204.0614 2666.0935,-176.4375 2647.8644,-152.1561 2675.7363,-126.0614 2692.9355,-109.9589 2701.6663,-106.826 2725.2257,-107.0614"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2634.5471,-195.0668 2504.5364,-195.0668 2504.5364,-173.056 2634.5471,-173.056 2634.5471,-195.0668"/>
<text text-anchor="middle" x="2569.5417" y="-180.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.7102,-327.953C2416.9068,-316.4539 2444.4911,-297.1039 2463.3472,-275.0614 2485.0673,-249.6709 2473.9382,-230.76 2499.3472,-209.0614 2503.651,-205.386 2508.534,-202.2367 2513.6724,-199.541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2515.5237,-202.5408 2523.1275,-195.163 2512.5824,-196.1887 2515.5237,-202.5408"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2614.9905,-172.9681C2632.2563,-168.7538 2652.1098,-163.9078 2670.1691,-159.4999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2671.1048,-162.8743 2679.9896,-157.1028 2669.4448,-156.074 2671.1048,-162.8743"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2581.8324,-172.9291C2606.8752,-151.458 2666.429,-106.4739 2725.2257,-107.0614"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1211.4656,-1850.1008C1273.3687,-1861.0329 1379.9429,-1869.1222 1445.2961,-1814.0614 1493.1136,-1773.7747 1453.1332,-1733.8859 1481.2961,-1678.0614 1533.8909,-1573.8084 1602.1284,-1581.4291 1645.6179,-1473.0614 1679.6821,-1388.1799 1622.3045,-1132.6829 1681.6179,-1063.0614 1686.6014,-1057.2118 1692.7351,-1052.626 1699.487,-1049.0437"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1701.3409,-1052.0479 1709.0276,-1044.7564 1698.4716,-1045.6629 1701.3409,-1052.0479"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1168.1031,-1850.1857C1187.3481,-1889.3513 1253.3407,-2019.9592 1290.49,-2047.0614 1319.1065,-2067.9386 1333.5947,-2057.2078 1367.8931,-2066.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1367.8931,-2066.0614C1655.5917,-2140.3263 1768.1242,-1911.4062 1879.7981,-1636.0614 1960.331,-1437.4983 1981.0573,-1174.1939 1985.5121,-1098.3349"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1989.0167,-1098.3467 1986.0754,-1088.1684 1982.0274,-1097.9594 1989.0167,-1098.3467"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1171.5126,-1827.8895C1203.3471,-1787.5529 1312.5903,-1649.134 1352.8437,-1598.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1355.661,-1600.2098 1359.1088,-1590.1917 1350.1661,-1595.8731 1355.661,-1600.2098"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1187.9162,-1415.8934C1213.5226,-1404.7228 1254.4263,-1387.3391 1290.49,-1374.0614 1300.5325,-1370.364 1311.4121,-1366.6649 1321.7532,-1363.2892"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1323.0132,-1366.5604 1331.458,-1360.1622 1320.8664,-1359.8977 1323.0132,-1366.5604"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1217.1313,-1421.6313C1259.2518,-1416.2683 1318.5258,-1406.1602 1367.8931,-1388.0614"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1216.9235,-1434.0769C1366.5522,-1453.3789 1774.6112,-1505.6194 1780.708,-1502.0614"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1780.708,-1502.0614C1978.4056,-1376.1164 1943.7776,-1130.7198 2177.0193,-1154.0614"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1252.012,-1114.8482C1387.8239,-1113.8969 1654.3123,-1109.571 1879.7981,-1091.0614 1895.2385,-1089.7939 1911.8703,-1087.8805 1927.305,-1085.8719"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1927.8016,-1089.3368 1937.2504,-1084.5441 1926.8752,-1082.3983 1927.8016,-1089.3368"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1445.1993,-1088.0668 1290.5868,-1088.0668 1290.5868,-1066.056 1445.1993,-1066.056 1445.1993,-1088.0668"/>
<text text-anchor="middle" x="1367.8931" y="-1073.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1222.3228,-1104.0192C1246.0351,-1099.628 1273.4851,-1094.5446 1298.1146,-1089.9835"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1298.9216,-1093.3936 1308.1171,-1088.1312 1297.6469,-1086.5107 1298.9216,-1093.3936"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1175.6674,-1220.0541C1194.84,-1203.2671 1231.0019,-1169.5633 1254.49,-1135.0614 1275.9762,-1103.5 1261.0322,-1081.3517 1290.49,-1057.0614 1317.8197,-1034.5259 1333.6757,-1047.2229 1367.8931,-1038.0614"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1207.6214,-1231.6884C1224.3162,-1234.178 1242.1714,-1239.8732 1254.49,-1252.0614 1303.2264,-1300.2818 1268.67,-1337.0665 1290.49,-1402.0614 1310.1272,-1460.5543 1341.5137,-1526.3854 1357.6216,-1558.8005"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1354.4924,-1560.3686 1362.1001,-1567.7425 1360.7513,-1557.2338 1354.4924,-1560.3686"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1178.5517,-1219.8244C1199.8641,-1203.7383 1237.0816,-1171.9785 1254.49,-1135.0614 1312.3309,-1012.4011 1204.3423,-936.7977 1290.49,-832.0614 1294.3404,-827.3802 1299.0755,-823.566 1304.2904,-820.4596"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1306.0751,-823.4802 1313.4483,-815.8719 1302.9398,-817.2216 1306.0751,-823.4802"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1418.6163,-1587.9114C1478.088,-1595.4598 1577.2104,-1598.9397 1645.6179,-1554.0614 1673.5556,-1535.733 1664.272,-1516.6195 1681.6179,-1488.0614 1778.3976,-1328.7249 1793.1597,-1280.4689 1915.7981,-1140.0614 1930.4548,-1123.281 1949.4148,-1106.6246 1964.0239,-1094.6566"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1966.4646,-1097.1849 1972.0573,-1088.1864 1962.0738,-1091.7333 1966.4646,-1097.1849"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1418.6594,-1583.4089C1438.2202,-1584.8829 1460.7824,-1586.3387 1481.2961,-1587.0614 1554.2828,-1589.6326 1575.4466,-1607.3011 1645.6179,-1587.0614 1713.7758,-1567.4025 1721.2299,-1540.7179 1780.708,-1502.0614"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1384.7768,-1590.1648C1439.4854,-1625.0364 1617.7791,-1730.0614 1780.708,-1730.0614 1780.708,-1730.0614 1780.708,-1730.0614 2569.5417,-1730.0614 2704.3265,-1730.0614 2776.8394,-1789.0671 2870.4174,-1692.0614"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1377.3255,-1088.2995C1408.4987,-1125.44 1508.4462,-1244.52 1547.555,-1291.1154"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1545.0094,-1293.5266 1554.1192,-1298.9361 1550.3711,-1289.0264 1545.0094,-1293.5266"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1563.457,-1077.0614C1578.4001,-1082.133 1664.0585,-1064.5315 1723.2433,-1051.3347"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1724.2394,-1054.6983 1733.2305,-1049.0938 1722.7068,-1047.8681 1724.2394,-1054.6983"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1441.2329,-1066.0462C1478.7373,-1063.136 1524.5545,-1063.858 1563.457,-1077.0614"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1780.708,-1077.0614C1829.9148,-1074.7363 1885.8108,-1074.9147 1926.9319,-1075.5749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1926.9953,-1079.0764 1937.055,-1075.7519 1927.1177,-1072.0775 1926.9953,-1079.0764"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1780.708,-1077.0614C1841.3348,-1074.1967 1855.4691,-1063.7119 1915.7981,-1057.0614 1975.6487,-1050.4636 2043.4764,-1045.6077 2095.0142,-1042.457"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2095.326,-1045.9446 2105.0974,-1041.8495 2094.905,-1038.9573 2095.326,-1045.9446"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1563.457,-1077.0614C1654.8904,-1108.0936 1684.1964,-1079.9885 1780.708,-1077.0614"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1828.0218,-1627.0668 1733.3943,-1627.0668 1733.3943,-1605.056 1828.0218,-1605.056 1828.0218,-1627.0668"/>
<text text-anchor="middle" x="1780.708" y="-1612.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1563.457,-1077.0614C1754.7925,-1142 1590.2187,-1335.8603 1681.6179,-1516.0614 1699.2433,-1550.8112 1733.3444,-1581.0614 1756.5657,-1598.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1754.4789,-1601.7498 1764.5781,-1604.9525 1758.6804,-1596.1509 1754.4789,-1601.7498"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1791.0267,-1604.8022C1811.0496,-1582.3703 1855.348,-1529.7947 1879.7981,-1478.0614 1944.4252,-1341.3186 1974.8732,-1159.1812 1983.7385,-1098.0589"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1987.2131,-1098.4838 1985.1461,-1088.0926 1980.2819,-1097.5048 1987.2131,-1098.4838"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2725.2257,-1692.0614C2848.4317,-1589.8426 2868.0011,-346.2984 2870.1832,-167.436"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2873.6854,-167.258 2870.3027,-157.2178 2866.6859,-167.1761 2873.6854,-167.258"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7429,-1627.1125C1882.7813,-1648.1909 2040.7569,-1692.0614 2177.0193,-1692.0614 2177.0193,-1692.0614 2177.0193,-1692.0614 2380.002,-1692.0614 2456.7183,-1692.0614 2666.184,-1741.0459 2725.2257,-1692.0614"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2870.4174,-1692.0614C2979.9459,-1578.5208 3010.1585,-365.2308 3013.9897,-188.4888"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3017.4914,-188.4408 3014.2044,-178.3688 3010.4929,-188.2922 3017.4914,-188.4408"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2725.2257,-1692.0614C2772.7144,-1648.3704 2825.6159,-1738.5039 2870.4174,-1692.0614"/>
</g>
<!-- sourcefile~nonzoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~nonzoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M824.7516,-2062.5296C970.0604,-2055.2316 1266.9377,-2043.8156 1367.8931,-2066.0614"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M985.0878,-604.0131C1043.3328,-588.4454 1159.0663,-564.2575 1254.49,-586.0614 1346.2702,-607.0328 1386.4747,-604.5533 1445.2961,-678.0614 1489.483,-733.2809 1441.4028,-774.6645 1481.2961,-833.0614 1548.0526,-930.7814 1678.0637,-995.4738 1742.5479,-1022.9903"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1741.3679,-1026.2908 1751.9432,-1026.9335 1744.0769,-1019.8362 1741.3679,-1026.2908"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M956.0818,-603.8382C973.9989,-580.7021 1018.866,-528.1892 1070.9011,-508.0614 1148.5041,-478.0437 1365.6856,-478.8652 1445.2961,-503.0614 1459.1947,-507.2856 1870.9267,-782.5587 1879.7981,-794.0614 1909.6699,-832.7934 1898.7997,-852.1969 1915.7981,-898.0614 1937.1762,-955.7433 1964.4125,-1023.0225 1978.0289,-1056.2731"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1974.9115,-1057.8958 1981.9465,-1065.8178 1981.3872,-1055.2377 1974.9115,-1057.8958"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1563.457,-297.0614C1657.3911,-292.803 1898.956,-264.9728 1986.59,-299.0614"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2380.002,-261.0614C2419.3879,-255.062 2428.7537,-247.8235 2463.3472,-228.0614 2480.9475,-218.0069 2481.0303,-208.7423 2499.3472,-200.0614 2500.1872,-199.6633 2501.0377,-199.2748 2501.8973,-198.8957"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2503.3564,-202.0833 2511.3966,-195.1837 2500.8085,-195.5635 2503.3564,-202.0833"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M955.447,-603.8508C971.8564,-579.5073 1010.8005,-519.6049 1034.9011,-465.0614 1056.3756,-416.4614 1033.0701,-388.3699 1070.9011,-351.0614 1143.4603,-279.5044 1190.6799,-305.6329 1290.49,-285.0614 1466.1686,-248.8529 1914.2004,-210.3118 2093.3818,-202.0614 2167.6476,-198.6418 2188.2627,-185.1441 2260.6567,-202.0614 2318.2745,-215.5257 2321.5067,-269.9716 2380.002,-261.0614"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node40" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node40"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1842.0354,-271.0668 1719.3807,-271.0668 1719.3807,-249.056 1842.0354,-249.056 1842.0354,-271.0668"/>
<text text-anchor="middle" x="1780.708" y="-256.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1367.8931,-299.0614C1452.9247,-281.0328 1476.6243,-300.9978 1563.457,-297.0614"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1563.457,-297.0614C1619.3049,-294.5296 1682.1764,-282.834 1725.8595,-273.2604"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1726.706,-276.6576 1735.7058,-271.0671 1725.1841,-269.8251 1726.706,-276.6576"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M952.8273,-603.947C967.2019,-573.4576 1011.1371,-487.4304 1070.9011,-437.0614 1072.6401,-435.5958 1365.6683,-299.5331 1367.8931,-299.0614"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node41" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node41"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1236.5938,-617.0668 1088.7973,-617.0668 1088.7973,-595.056 1236.5938,-595.056 1236.5938,-617.0668"/>
<text text-anchor="middle" x="1162.6956" y="-602.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1035.1867,-611.4008C1049.4953,-610.8016 1064.2954,-610.1819 1078.5232,-609.5861"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1078.9222,-613.0725 1088.767,-609.1571 1078.6293,-606.0787 1078.9222,-613.0725"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node42" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node42"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1879.8883,-646.0668 1681.5278,-646.0668 1681.5278,-624.056 1879.8883,-624.056 1879.8883,-646.0668"/>
<text text-anchor="middle" x="1780.708" y="-631.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1367.8931,-748.0614C1440.683,-740.8851 1645.6559,-677.9185 1736.4606,-649.2137"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1737.7026,-652.4917 1746.1784,-646.1347 1735.5883,-645.8187 1737.7026,-652.4917"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1028.6964,-626.3093C1030.8728,-627.7419 1032.9495,-629.3214 1034.9011,-631.0614 1075.8275,-667.5504 1026.8346,-716.4338 1070.9011,-749.0614 1123.9429,-788.3345 1302.2817,-755.2001 1367.8931,-748.0614"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node43" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node43"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1252.847,-818.0668 1072.5441,-818.0668 1072.5441,-796.056 1252.847,-796.056 1252.847,-818.0668"/>
<text text-anchor="middle" x="1162.6956" y="-803.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1014.7253,-626.1919C1022.228,-629.665 1029.2052,-634.1854 1034.9011,-640.0614 1080.2173,-686.8102 1025.2701,-735.6198 1070.9011,-782.0614 1074.3377,-785.5591 1078.2118,-788.5817 1082.3756,-791.1925"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1080.8185,-794.3293 1091.2819,-795.9932 1084.1399,-788.1674 1080.8185,-794.3293"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node44" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node44"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1618.51,-347.0668 1508.404,-347.0668 1508.404,-325.056 1618.51,-325.056 1618.51,-347.0668"/>
<text text-anchor="middle" x="1563.457" y="-332.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1367.8931,-299.0614C1395.2481,-293.2615 1466.1826,-309.5845 1514.6585,-322.3754"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1513.7716,-325.7611 1524.3362,-324.9603 1515.5781,-318.9982 1513.7716,-325.7611"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node45" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node45"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1226.1572,-740.0668 1099.2339,-740.0668 1099.2339,-718.056 1226.1572,-718.056 1226.1572,-740.0668"/>
<text text-anchor="middle" x="1162.6956" y="-725.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1009.8909,-626.1226C1018.8868,-629.5778 1027.5686,-634.1118 1034.9011,-640.0614 1061.4556,-661.6077 1043.7694,-687.2467 1070.9011,-708.0614 1076.3915,-712.2734 1082.5758,-715.6667 1089.0744,-718.3968"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1088.1826,-721.7972 1098.7765,-721.9404 1090.5841,-715.222 1088.1826,-721.7972"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node46" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node46"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1254.2849,-699.0668 1071.1062,-699.0668 1071.1062,-677.056 1254.2849,-677.056 1254.2849,-699.0668"/>
<text text-anchor="middle" x="1162.6956" y="-684.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M998.2499,-626.1797C1010.5724,-629.7986 1023.4869,-634.3855 1034.9011,-640.0614 1052.8092,-648.9664 1052.757,-658.6477 1070.9011,-667.0614 1076.5463,-669.6791 1082.542,-671.9827 1088.6592,-674.0076"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1087.7528,-677.3904 1098.3391,-676.9654 1089.7984,-670.6959 1087.7528,-677.3904"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node47" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node47"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1645.7791,-759.0668 1481.1349,-759.0668 1481.1349,-737.056 1645.7791,-737.056 1645.7791,-759.0668"/>
<text text-anchor="middle" x="1563.457" y="-744.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1367.8931,-748.0614C1401.2781,-744.77 1438.0251,-744.0193 1470.5655,-744.3384"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1470.9272,-747.8435 1480.9732,-744.4778 1471.021,-740.8441 1470.9272,-747.8435"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node48" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node48"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1226.8314,-658.0668 1098.5597,-658.0668 1098.5597,-636.056 1226.8314,-636.056 1226.8314,-658.0668"/>
<text text-anchor="middle" x="1162.6956" y="-643.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1021.7333,-626.074C1043.2227,-629.2735 1066.6978,-632.7686 1088.2184,-635.9728"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1087.874,-639.46 1098.2805,-637.4709 1088.9049,-632.5363 1087.874,-639.46"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M398.3645,-1543.9774C415.0604,-1537.2628 433.5896,-1527.0306 445.5278,-1512.0614 486.6607,-1460.4854 453.8233,-1427.9318 481.5278,-1368.0614 495.8268,-1337.1608 520.1065,-1305.9686 536.3925,-1286.8296"/>
<polygon fill="#00ffff" stroke="#00ffff" points="539.132,-1289.0128 543.0393,-1279.1647 533.8435,-1284.4267 539.132,-1289.0128"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1418.0408,-2016.0129C1427.6296,-2012.517 1437.1922,-2007.965 1445.2961,-2002.0614 1467.4289,-1985.9379 1464.1643,-1973.4232 1481.2961,-1952.0614 1582.2422,-1826.1915 1715.1562,-1684.7559 1762.7789,-1634.7697"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1765.5457,-1636.9402 1769.9192,-1627.2902 1760.4824,-1632.1066 1765.5457,-1636.9402"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node54" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node54"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1616.4495,-1983.0668 1510.4646,-1983.0668 1510.4646,-1961.056 1616.4495,-1961.056 1616.4495,-1983.0668"/>
<text text-anchor="middle" x="1563.457" y="-1968.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1407.4684,-2015.9313C1438.3181,-2007.2552 1481.321,-1995.1612 1514.3642,-1985.8682"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1515.5958,-1989.1576 1524.2748,-1983.0809 1513.7006,-1982.4191 1515.5958,-1989.1576"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1794.8704,-271.2903C1837.1225,-303.9807 1967.1989,-398.8109 2093.3818,-431.0614 2165.4108,-449.471 2187.3923,-443.6875 2260.6567,-431.0614 2454.1812,-397.7102 2531.8318,-368.1365 2639.7363,-204.0614 2668.2338,-160.7293 2635.7344,-126.0709 2675.7363,-93.0614 2742.9781,-37.5737 2789.7515,-35.9954 2870.4174,-69.0614"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1842.2783,-269.1787C1893.0726,-277.1686 1960.8227,-289.0382 1986.59,-299.0614"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node49" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node49"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2223.0801,-233.0668 2130.9584,-233.0668 2130.9584,-211.056 2223.0801,-211.056 2223.0801,-233.0668"/>
<text text-anchor="middle" x="2177.0193" y="-218.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1842.1113,-249.9351C1865.1681,-246.4058 1891.6379,-242.6782 1915.7981,-240.0614 1986.1315,-232.4436 2067.4876,-227.4357 2120.4728,-224.6797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2120.8715,-228.164 2130.6799,-224.1584 2120.5144,-221.1731 2120.8715,-228.164"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node50" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node50"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2057.1743,-271.0668 1916.0056,-271.0668 1916.0056,-249.056 2057.1743,-249.056 2057.1743,-271.0668"/>
<text text-anchor="middle" x="1986.59" y="-256.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1841.922,-260.0614C1861.8872,-260.0614 1884.3732,-260.0614 1905.5606,-260.0614"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1905.8407,-263.5615 1915.8406,-260.0614 1905.8406,-256.5615 1905.8407,-263.5615"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node53" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node53"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1423.6152,-709.0668 1312.1709,-709.0668 1312.1709,-687.056 1423.6152,-687.056 1423.6152,-709.0668"/>
<text text-anchor="middle" x="1367.8931" y="-694.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1224.3197,-617.1604C1234.58,-619.8547 1244.9724,-623.1253 1254.49,-627.0614 1288.41,-641.0894 1323.6642,-664.8524 1345.6807,-680.9868"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="1343.6033,-683.8036 1353.7145,-686.9682 1347.7836,-678.1889 1343.6033,-683.8036"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1861.2298,-646.2055C1868.1823,-649.7477 1874.5522,-654.2802 1879.7981,-660.0614 1951.6881,-739.2875 1887.9476,-794.7692 1915.7981,-898.0614 1931.8127,-957.4563 1961.3988,-1023.985 1976.7589,-1056.6788"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1973.7592,-1058.5213 1981.2108,-1066.0528 1980.0823,-1055.5182 1973.7592,-1058.5213"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1870.0849,-646.2076C1873.5837,-648.4624 1876.85,-651.0644 1879.7981,-654.0614 1944.9765,-720.3199 1847.458,-797.0689 1915.7981,-860.0614 2001.5235,-939.0788 2060.432,-884.0614 2177.0193,-884.0614 2177.0193,-884.0614 2177.0193,-884.0614 2380.002,-884.0614 2389.8211,-884.0614 2718.1475,-966.8669 2725.2257,-960.0614"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2725.2257,-960.0614C2839.7948,-842.0866 2865.5874,-283.2506 2869.7407,-167.1973"/>
<polygon fill="#aaff00" stroke="#aaff00" points="2873.2418,-167.2232 2870.0861,-157.1093 2866.2459,-166.9836 2873.2418,-167.2232"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1181.0516,-795.9291C1205.6363,-781.1697 1250.7701,-754.5972 1290.49,-734.0614 1304.2617,-726.9412 1319.703,-719.6288 1333.1499,-713.4703"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1334.8775,-716.5298 1342.5363,-709.209 1331.9839,-710.1558 1334.8775,-716.5298"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1986.59,-846.0614C2219.3558,-946.2385 2349.064,-468.1816 2375.0994,-360.3092"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="2378.5736,-360.8271 2377.474,-350.2895 2371.7622,-359.2128 2378.5736,-360.8271"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1618.5089,-337.6534C1689.14,-342.7502 1810.7545,-362.3415 1879.7981,-435.0614 2009.7474,-571.9301 1801.9959,-806.7563 1986.59,-846.0614"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1601.6653,-325.0031C1615.5671,-320.8304 1631.3628,-315.9152 1645.6179,-311.0614 1679.0118,-299.691 1716.5112,-285.4111 1743.5127,-274.8559"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="1744.929,-278.06 1752.9585,-271.148 1742.3711,-271.5441 1744.929,-278.06"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1226.2161,-719.4651C1250.213,-715.8398 1277.5631,-711.7079 1301.791,-708.0477"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1302.5994,-711.4654 1311.9644,-706.5108 1301.5537,-704.5439 1302.5994,-711.4654"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1254.4912,-692.5349C1270.4442,-693.3124 1286.7494,-694.107 1301.8411,-694.8425"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1301.9175,-698.3502 1312.0761,-695.3412 1302.2583,-691.3585 1301.9175,-698.3502"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1621.287,-759.1448C1630.0593,-762.5974 1638.532,-767.1248 1645.6179,-773.0614 1666.4359,-790.5028 1744.263,-958.2284 1771.3463,-1017.467"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1768.3182,-1019.2622 1775.6525,-1026.908 1774.687,-1016.3572 1768.3182,-1019.2622"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1780.708,-808.0614C1886.1462,-866.9481 1954.9045,-1004.4521 1977.9841,-1056.5552"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1974.9129,-1058.2707 1982.1008,-1066.0543 1981.3357,-1055.4871 1974.9129,-1058.2707"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1636.0038,-759.0793C1679.9026,-767.884 1735.8699,-783.0196 1780.708,-808.0614"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1780.708,-808.0614C1843.2678,-843.0007 1847.966,-872.9683 1915.7981,-896.0614 1958.4998,-910.599 2693.7997,-992.4216 2725.2257,-960.0614"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1608.2304,-736.9289C1620.6074,-733.1874 1633.862,-728.5439 1645.6179,-723.0614 1688.0092,-703.2918 1732.6201,-671.8346 1758.4895,-652.3724"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1760.6753,-655.1073 1766.5138,-646.2663 1756.4363,-649.5367 1760.6753,-655.1073"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1212.3132,-658.0909C1226.0009,-661.221 1240.8394,-664.6954 1254.49,-668.0614 1275.2957,-673.1917 1298.1566,-679.173 1317.8683,-684.4388"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1316.9991,-687.8293 1327.5644,-687.039 1318.8122,-681.0682 1316.9991,-687.8293"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2223.2041,-227.2516C2281.7937,-231.8556 2384.6701,-233.2181 2463.3472,-198.0614 2483.4402,-189.0829 2482.7933,-178.5637 2499.3472,-164.0614 2529.5757,-137.5792 2529.6961,-112.2952 2569.5417,-107.0614"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2870.4174,-69.0614C2920.0408,-91.8177 2919.4019,-117.8163 2966.1196,-146.0614 2969.321,-147.9969 2972.7328,-149.8501 2976.206,-151.5978"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2974.9042,-154.8537 2985.4409,-155.9619 2977.895,-148.5248 2974.9042,-154.8537"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2196.1826,-211.0162C2214.4777,-199.7487 2241.9532,-180.8597 2260.6567,-159.0614 2282.6692,-133.4066 2271.2515,-114.3614 2296.6567,-92.0614 2369.0799,-28.4903 2404.5645,-32.4584 2499.3472,-15.0614 2663.2661,15.0252 2718.9293,.408 2870.4174,-69.0614"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2196.1154,-233.0685C2232.0821,-253.7998 2310.0129,-298.7194 2351.9459,-322.8898"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2350.397,-326.0368 2360.8087,-327.9983 2353.8928,-319.9721 2350.397,-326.0368"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2217.509,-233.1168C2267.3875,-246.1602 2349.2877,-265.5481 2380.002,-261.0614"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2027.6588,-271.1991C2037.7734,-274.8356 2048.3003,-279.4259 2057.3818,-285.0614 2076.343,-296.8278 2072.9946,-310.9875 2093.3818,-320.0614 2153.7689,-346.9384 2228.4567,-351.0778 2286.4497,-348.8194"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2286.8801,-352.3034 2296.7084,-348.347 2286.558,-345.3108 2286.8801,-352.3034"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2057.3909,-266.4738C2136.4965,-272.1957 2268.151,-277.4005 2380.002,-261.0614"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2041.9258,-249.0192C2066.7305,-244.0694 2095.9424,-238.2402 2120.845,-233.2709"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2121.7482,-236.6598 2130.8699,-231.2705 2120.3783,-229.7951 2121.7482,-236.6598"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node51" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node51"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2230.745,-311.0668 2123.2936,-311.0668 2123.2936,-289.056 2230.745,-289.056 2230.745,-311.0668"/>
<text text-anchor="middle" x="2177.0193" y="-296.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2039.1297,-271.0975C2062.4485,-275.9956 2090.0731,-281.7982 2114.4498,-286.9186"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2113.8148,-290.3615 2124.3208,-288.992 2115.2538,-283.511 2113.8148,-290.3615"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node52" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node52"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2260.7944,-389.0668 2093.2442,-389.0668 2093.2442,-367.056 2260.7944,-367.056 2260.7944,-389.0668"/>
<text text-anchor="middle" x="2177.0193" y="-374.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2033.8238,-271.1894C2042.2893,-274.664 2050.5714,-279.1876 2057.3818,-285.0614 2083.2773,-307.3954 2066.9468,-331.3688 2093.3818,-353.0614 2098.0351,-356.8799 2103.2578,-360.1153 2108.7611,-362.8566"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2107.6737,-366.2017 2118.2369,-367.0193 2110.4891,-359.7928 2107.6737,-366.2017"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2230.882,-310.4103C2255.9811,-315.2327 2286.1061,-321.0208 2312.6892,-326.1283"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2312.2054,-329.5993 2322.6862,-328.0491 2313.5262,-322.725 2312.2054,-329.5993"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2227.6909,-289.0182C2268.6246,-280.4138 2327.8056,-268.6862 2380.002,-261.0614"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2234.3721,-367.042C2258.6937,-362.3689 2287.2155,-356.8889 2312.5403,-352.0231"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2313.2791,-355.4453 2322.4391,-350.1212 2311.9583,-348.571 2313.2791,-355.4453"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1411.295,-709.158C1440.5385,-716.6347 1479.2966,-726.5441 1510.3769,-734.4904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1509.621,-737.9096 1520.1764,-736.9958 1511.355,-731.1278 1509.621,-737.9096"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1570.1972,-1961.0167C1600.9838,-1910.5678 1728.4595,-1701.6788 1768.5692,-1635.9527"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1771.6096,-1637.6894 1773.8312,-1627.3301 1765.6344,-1634.043 1771.6096,-1637.6894"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1367.8931,-1038.0614C1480.4494,-1012.7981 1614.6595,-1019.3028 1698.7993,-1027.6149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1698.5037,-1031.1028 1708.8072,-1028.6355 1699.214,-1024.1389 1698.5037,-1031.1028"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1208.641,-1009.981C1264.3597,-1022.8811 1352.7432,-1042.1177 1367.8931,-1038.0614"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1190.1043,-1010.1176C1211.4539,-1020.2705 1239.8461,-1037.4871 1254.49,-1062.0614 1332.277,-1192.5978 1251.5913,-1255.1687 1290.49,-1402.0614 1306.2847,-1461.7068 1339.3513,-1527.0339 1356.7089,-1559.0742"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1353.676,-1560.8227 1361.5549,-1567.906 1359.8129,-1557.4553 1353.676,-1560.8227"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1187.0174,-987.8859C1207.6581,-977.2562 1236.6799,-959.4274 1254.49,-936.0614 1284.1413,-897.1603 1255.5447,-866.286 1290.49,-832.0614 1294.5256,-828.1091 1299.1898,-824.7815 1304.1876,-821.9799"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1306.0029,-824.9898 1313.4803,-817.4838 1302.9542,-818.6885 1306.0029,-824.9898"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge138" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1162.6956,-1038.0614C1253.8927,-1037.4957 1279.7972,-1061.6485 1367.8931,-1038.0614"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M742.7465,-846.0614C803.3435,-822.3791 985.2682,-822.9969 1034.9011,-865.0614 1088.5234,-910.5069 1020.5682,-969.9978 1070.9011,-1019.0614 1100.7346,-1048.1425 1121.0341,-1038.3198 1162.6956,-1038.0614"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge139" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M742.7465,-846.0614C816.9382,-817.0661 792.0598,-751.5933 860.6331,-711.0614 894.7545,-690.8931 909.0661,-683.5022 947.7671,-692.0614"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M579.7872,-911.9984C616.3766,-896.8367 684.3546,-868.8819 742.7465,-846.0614"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node57" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node57"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="806.1602,-157.0668 679.3327,-157.0668 679.3327,-135.056 806.1602,-135.056 806.1602,-157.0668"/>
<text text-anchor="middle" x="742.7465" y="-142.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge137" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M554.2778,-912.0395C560.3353,-852.4008 592.2171,-562.6402 660.8599,-336.0614 680.2913,-271.9214 714.8964,-200.3481 732.2349,-166.2481"/>
<polygon fill="#00ffff" stroke="#00ffff" points="735.381,-167.7833 736.8335,-157.2885 729.1534,-164.5869 735.381,-167.7833"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge127" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2380.002,-184.0614C2433.7327,-186.4083 2445.9701,-170.6482 2499.3472,-164.0614 2555.4275,-157.1411 2619.6859,-152.3199 2665.2904,-149.4208"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2665.5434,-152.9119 2675.306,-148.796 2665.1074,-145.9255 2665.5434,-152.9119"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2177.0193,-145.0614C2268.8384,-142.1713 2288.3064,-178.4913 2380.002,-184.0614"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge133" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1367.8931,-223.0614C1409.0705,-238.7835 1417.5003,-250.8539 1445.2961,-285.0614 1467.6076,-312.5196 1453.1276,-334.6538 1481.2961,-356.0614 1540.6028,-401.1335 1579.6459,-354.4715 1645.6179,-389.0614 1773.7213,-456.2274 1813.7071,-486.4001 1879.7981,-615.0614 1930.0862,-712.9588 1890.641,-752.9171 1915.7981,-860.0614 1933.1026,-933.7614 1964.0031,-1018.3085 1978.5711,-1056.4711"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1975.3637,-1057.8818 1982.222,-1065.9573 1981.8965,-1055.3675 1975.3637,-1057.8818"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge129" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2380.002,-106.0614C2463.3765,-94.0093 2485.9476,-117.4818 2569.5417,-107.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2569.5417,-107.0614C2638.2032,-98.5024 2656.0365,-107.7687 2725.2257,-107.0614"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge136" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1986.59,-299.0614C2022.5855,-313.4843 2029.7,-322.906 2057.3818,-350.0614 2076.4182,-368.7357 2069.5304,-386.1357 2093.3818,-398.0614 2159.8775,-431.3092 2189.5023,-419.6052 2260.6567,-398.0614 2279.0612,-392.489 2279.7151,-383.1587 2296.6567,-374.0614 2310.4745,-366.6416 2326.2055,-359.6809 2340.2501,-353.9518"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2341.6724,-357.1526 2349.6597,-350.1917 2339.0748,-350.6524 2341.6724,-357.1526"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1563.457,-221.0614C1703.7147,-208.1645 1752.9086,-178.9255 1879.7981,-240.0614 1901.3451,-250.4429 1895.409,-267.558 1915.7981,-280.0614 1943.5688,-297.0915 1956.1668,-287.414 1986.59,-299.0614"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge130" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2380.002,-184.0614C2417.5531,-185.7016 2459.329,-185.8781 2494.0837,-185.5706"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2494.1965,-189.0697 2504.1597,-185.4663 2494.124,-182.0701 2494.1965,-189.0697"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge128" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M748.2814,-157.4124C762.352,-186.5601 800.1091,-266.6309 824.6331,-336.0614 844.4575,-392.1872 837.4972,-410.2176 860.6331,-465.0614 881.4564,-514.4235 915.4141,-567.6135 934.1975,-595.4762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="931.422,-597.6185 939.945,-603.9122 937.207,-593.6772 931.422,-597.6185"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge132" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M748.9189,-157.2142C764.4852,-185.8968 805.463,-264.9662 824.6331,-336.0614 842.0562,-400.678 816.2856,-584.9399 860.6331,-635.0614 913.4964,-694.8075 975.9751,-624.2855 1034.9011,-678.0614 1071.0307,-711.0333 1035.1695,-748.6586 1070.9011,-782.0614 1074.7245,-785.6356 1079.0078,-788.708 1083.5785,-791.348"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1082.1693,-794.5568 1092.6774,-795.9104 1085.307,-788.2993 1082.1693,-794.5568"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node58" class="node">
<title>sourcefile~economiclifecyclecost.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node58"><a xlink:href="../sourcefile/economiclifecyclecost.f90.html" xlink:title="EconomicLifeCycleCost.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2639.9314,-79.0668 2499.152,-79.0668 2499.152,-57.056 2639.9314,-57.056 2639.9314,-79.0668"/>
<text text-anchor="middle" x="2569.5417" y="-64.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicLifeCycleCost.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge131" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2177.0193,-145.0614C2222.9516,-145.0614 2334.5422,-112.6328 2380.002,-106.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1367.8931,-223.0614C1449.1662,-253.8848 1476.8915,-228.9238 1563.457,-221.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1563.457,-221.0614C1837.109,-196.2069 1902.2409,-145.0614 2177.0193,-145.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M806.3253,-144.0964C922.049,-142.6217 1173.1141,-149.1901 1367.8931,-223.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2380.002,-106.0614C2424.4813,-99.6318 2474.2893,-89.5311 2511.6809,-81.3592"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2512.8712,-84.6809 2521.8832,-79.1101 2511.3642,-77.8451 2512.8712,-84.6809"/>
</g>
<!-- sourcefile~economictariff.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node59" class="node">
<title>sourcefile~economictariff.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node59"><a xlink:href="../sourcefile/economictariff.f90.html" xlink:title="EconomicTariff.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2429.1862,-156.0668 2330.8177,-156.0668 2330.8177,-134.056 2429.1862,-134.056 2429.1862,-156.0668"/>
<text text-anchor="middle" x="2380.002" y="-141.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicTariff.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge134" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2177.0193,-145.0614C2225.3222,-145.0614 2280.0908,-145.0614 2320.5539,-145.0614"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2320.7819,-148.5615 2330.7818,-145.0614 2320.7818,-141.5615 2320.7819,-148.5615"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node60" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node60"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1000.6295,-742.0668 894.9047,-742.0668 894.9047,-720.056 1000.6295,-720.056 1000.6295,-742.0668"/>
<text text-anchor="middle" x="947.7671" y="-727.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge135" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.0157,-157.1887C764.809,-185.8114 806.2759,-264.752 824.6331,-336.0614 845.228,-416.0635 807.7819,-642.5693 860.6331,-706.0614 867.1272,-713.8631 875.8802,-719.3204 885.3416,-723.1196"/>
<polygon fill="#ff0000" stroke="#ff0000" points="884.3873,-726.4917 894.9816,-726.3914 886.637,-719.8631 884.3873,-726.4917"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2725.2257,-107.0614C2763.8641,-107.4475 2806.3699,-120.4299 2835.3483,-131.3105"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2834.4163,-134.7028 2845.0056,-135.0474 2836.9425,-128.1744 2834.4163,-134.7028"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2597.1449,-79.1677C2627.8677,-90.5334 2679.253,-106.602 2725.2257,-107.0614"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge120" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2426.0595,-134.0203C2464.2636,-125.2991 2520.1281,-113.5519 2569.5417,-107.0614"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2429.3065,-155.2064C2452.6364,-160.0068 2480.7839,-165.7985 2505.7201,-170.9294"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2505.323,-174.4209 2515.8232,-173.0082 2506.7338,-167.5645 2505.323,-174.4209"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge119" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2427.4097,-133.982C2439.4577,-130.3258 2452.1539,-125.7115 2463.3472,-120.0614 2481.2015,-111.049 2481.7272,-102.5237 2499.3472,-93.0614 2506.5584,-89.1888 2514.4931,-85.7033 2522.3531,-82.6501"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2523.6813,-85.8907 2531.8498,-79.1434 2521.2565,-79.3241 2523.6813,-85.8907"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge123" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1367.8931,-846.0614C1502.5725,-818.4127 1852.4456,-815.9236 1986.59,-846.0614"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge125" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M957.3612,-742.3889C975.5164,-764.4526 1014.8682,-815.3922 1034.9011,-865.0614 1066.5595,-943.5547 1024.5356,-981.2539 1070.9011,-1052.0614 1084.5211,-1072.8613 1107.6289,-1088.6642 1127.2515,-1099.2406"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1125.7667,-1102.4126 1136.2606,-1103.8713 1128.9668,-1096.1869 1125.7667,-1102.4126"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge124" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1000.8258,-737.7077C1013.2272,-741.4302 1025.5336,-747.1851 1034.9011,-756.0614 1070.4063,-789.7048 1031.057,-831.6899 1070.9011,-860.0614 1178.5434,-936.7094 1238.773,-874.1644 1367.8931,-846.0614"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1367.8931,-846.0614C1402.592,-838.938 1412.8806,-841.344 1445.2961,-827.0614 1481.9395,-810.916 1519.6043,-783.4976 1542.2728,-765.5843"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1544.585,-768.2164 1550.1931,-759.2276 1540.2035,-762.7572 1544.585,-768.2164"/>
</g>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node61" class="node">
<title>sourcefile~weathermanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node61"><a xlink:href="../sourcefile/weathermanager.f90.html" xlink:title="WeatherManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2624.4205,-1010.0668 2514.663,-1010.0668 2514.663,-988.056 2624.4205,-988.056 2624.4205,-1010.0668"/>
<text text-anchor="middle" x="2569.5417" y="-995.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WeatherManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge126" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M984.764,-742.1218C1002.1739,-749.0402 1021.9149,-759.6326 1034.9011,-775.0614 1070.2094,-817.0108 1030.7178,-855.7556 1070.9011,-893.0614 1170.067,-985.1261 1232.5795,-960.0614 1367.8931,-960.0614 1367.8931,-960.0614 1367.8931,-960.0614 1780.708,-960.0614 2049.6506,-960.0614 2369.5417,-982.9552 2504.4359,-993.6616"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2504.351,-997.1659 2514.5979,-994.4729 2504.9082,-990.1881 2504.351,-997.1659"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge121" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2588.2933,-987.9281C2604.8696,-976.98 2628.1606,-958.6493 2639.7363,-936.0614 2711.4407,-796.1437 2723.2307,-279.1086 2724.9539,-167.4207"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2728.4578,-167.1698 2725.1013,-157.1207 2721.4585,-167.0696 2728.4578,-167.1698"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge122" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2624.4453,-997.7393C2657.2835,-994.1917 2697.8185,-984.5893 2725.2257,-960.0614"/>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge179" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M375.6517,-515.2264C417.7765,-546.0592 542.2917,-632.4491 660.8599,-668.0614 783.4111,-704.87 822.3257,-666.8002 947.7671,-692.0614"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node66" class="node">
<title>sourcefile~zoneplenumcomponent.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node66"><a xlink:href="../sourcefile/zoneplenumcomponent.f90.html" xlink:title="ZonePlenumComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="625.0263,-462.0668 481.3614,-462.0668 481.3614,-440.056 625.0263,-440.056 625.0263,-462.0668"/>
<text text-anchor="middle" x="553.1938" y="-447.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZonePlenumComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge177" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.0801,-492.9509C430.7195,-484.7887 471.1832,-473.6457 502.9262,-464.9042"/>
<polygon fill="#ff0000" stroke="#ff0000" points="504.1893,-468.1868 512.9011,-462.1573 502.3307,-461.438 504.1893,-468.1868"/>
</g>
<!-- sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node67" class="node">
<title>sourcefile~zoneairloopequipmentmanager.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node67"><a xlink:href="../sourcefile/zoneairloopequipmentmanager.f90.html" xlink:title="Zoneairloopequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1250.0635,-271.0668 1075.3276,-271.0668 1075.3276,-249.056 1250.0635,-249.056 1250.0635,-271.0668"/>
<text text-anchor="middle" x="1162.6956" y="-256.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneairloopequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge178" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M378.5564,-492.8581C401.9586,-478.2474 444.4304,-452.075 481.5278,-431.0614 560.0078,-386.6069 576.7207,-368.5561 660.8599,-336.0614 746.3421,-303.048 770.261,-300.227 860.6331,-285.0614 928.4544,-273.6801 1005.7518,-267.4039 1065.1746,-263.9865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1065.5134,-267.4731 1075.3029,-263.4216 1065.1235,-260.484 1065.5134,-267.4731"/>
</g>
<!-- sourcefile~unitheater.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge180" class="edge">
<title>sourcefile~unitheater.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1202.3731,-517.8975C1263.1174,-504.9497 1379.0703,-490.9586 1445.2961,-552.0614 1516.8258,-618.0577 1427.1318,-687.2021 1481.2961,-768.0614 1529.1348,-839.4773 1581.2523,-813.0892 1645.6179,-870.0614 1698.1322,-916.5435 1746.1468,-984.9888 1768.1132,-1018.3409"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1765.2113,-1020.2986 1773.6002,-1026.7699 1771.0779,-1016.4797 1765.2113,-1020.2986"/>
</g>
<!-- sourcefile~unitheater.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge181" class="edge">
<title>sourcefile~unitheater.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1192.0415,-539.22C1212.6964,-548.6005 1239.2754,-564.0369 1254.49,-586.0614 1299.8698,-651.753 1243.906,-697.2181 1290.49,-762.0614 1299.6272,-774.7801 1313.561,-784.4576 1327.1008,-791.5178"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1325.8217,-794.787 1336.3477,-795.9926 1328.8709,-788.4861 1325.8217,-794.787"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge184" class="edge">
<title>sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M971.3322,-896.1836C991.2316,-906.7791 1018.961,-924.5877 1034.9011,-948.0614 1071.4774,-1001.9241 1025.2701,-1043.6198 1070.9011,-1090.0614 1074.3377,-1093.5591 1078.2118,-1096.5817 1082.3756,-1099.1925"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1080.8185,-1102.3293 1091.2819,-1103.9932 1084.1399,-1096.1674 1080.8185,-1102.3293"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge183" class="edge">
<title>sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M972.642,-896.2685C992.7969,-906.7059 1020.1821,-924.2412 1034.9011,-948.0614 1086.9827,-1032.3467 1017.7898,-1084.4212 1070.9011,-1168.0614 1084.2287,-1189.0498 1107.3379,-1204.8519 1127.0343,-1215.3806"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1125.5834,-1218.5693 1136.0831,-1219.9858 1128.7584,-1212.3308 1125.5834,-1218.5693"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge182" class="edge">
<title>sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M957.7068,-873.8657C976.4527,-852.0273 1016.7706,-801.4562 1034.9011,-751.0614 1082.4541,-618.8855 1029.8878,-571.4104 1070.9011,-437.0614 1089.4828,-376.1928 1128.7195,-311.4612 1149.3598,-279.8093"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1152.2981,-281.7113 1154.8908,-271.4385 1146.4578,-277.8523 1152.2981,-281.7113"/>
</g>
<!-- sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge186" class="edge">
<title>sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1014.9845,-216.1563C1095.004,-210.7492 1221.9338,-207.8368 1254.49,-240.0614 1337.129,-321.8586 1229.0691,-663.3321 1290.49,-762.0614 1298.5623,-775.0371 1311.8501,-784.6832 1325.157,-791.6435"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1323.7793,-794.8645 1334.3086,-796.0409 1326.8111,-788.5551 1323.7793,-794.8645"/>
</g>
<!-- sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge185" class="edge">
<title>sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1010.222,-233.1036C1035.1692,-237.5144 1064.0662,-242.6234 1089.9519,-247.2001"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1089.6282,-250.6971 1100.0849,-248.9916 1090.847,-243.804 1089.6282,-250.6971"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge173" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.6956,-451.0614C1255.3663,-470.6883 1437.0588,-661.6412 1445.2961,-678.0614 1486.6053,-760.4065 1460.9282,-1001.2154 1481.2961,-1091.0614 1498.4478,-1166.7196 1535.7548,-1251.416 1553.5839,-1289.5284"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1550.6229,-1291.4538 1558.0632,-1298.9965 1556.9505,-1288.4602 1550.6229,-1291.4538"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge167" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M947.7671,-451.0614C1041.1509,-442.8697 1286.4652,-366.6162 1367.8931,-413.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M624.8716,-452.858C703.9647,-454.4216 835.008,-455.7749 947.7671,-451.0614"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge172" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M556.123,-462.4347C565.6157,-497.3126 598.5827,-604.2589 660.8599,-668.0614 792.0998,-802.5157 922.9803,-714.1454 1034.9011,-865.0614 1085.3177,-933.044 1012.2589,-991.0323 1070.9011,-1052.0614 1128.9655,-1112.4892 1198.6836,-1032.5423 1254.49,-1095.0614 1300.2319,-1146.3054 1272.5334,-1335.7603 1290.49,-1402.0614 1306.6197,-1461.617 1339.5398,-1526.9834 1356.7885,-1559.0529"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1353.7462,-1560.7848 1361.6024,-1567.8932 1359.8938,-1557.4371 1353.7462,-1560.7848"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge169" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M742.7465,-654.0614C827.7897,-690.8825 857.2814,-672.0494 947.7671,-692.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M947.7671,-692.0614C986.4681,-700.6206 1005.6922,-684.2684 1034.9011,-711.0614 1074.6813,-747.5513 1027.4404,-795.0436 1070.9011,-827.0614 1107.136,-853.7558 1231.5496,-834.8664 1307.376,-820.0651"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1308.1549,-823.4789 1317.2832,-818.1007 1306.7934,-816.6126 1308.1549,-823.4789"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge168" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M559.0399,-462.0961C578.896,-498.2193 647.832,-612.9664 742.7465,-654.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M742.7465,-654.0614C802.0012,-679.7169 878.1127,-650.7525 918.8956,-630.7818"/>
<polygon fill="#ff0000" stroke="#ff0000" points="920.6483,-633.8177 927.9961,-626.1849 917.4921,-627.5696 920.6483,-633.8177"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge171" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M561.3649,-439.9962C593.4834,-397.6357 716.4003,-245.9544 860.6331,-202.0614 895.3538,-191.4952 1252.426,-207.5416 1254.49,-209.0614 1293.877,-238.0641 1254.3405,-280.1113 1290.49,-313.0614 1342.8485,-360.786 1384.0476,-315.457 1445.2961,-351.0614 1465.4092,-362.7533 1461.1049,-377.505 1481.2961,-389.0614 1546.3532,-426.2967 1584.2218,-384.0567 1645.6179,-427.0614 1681.3424,-452.0845 1745.1262,-567.765 1770.1861,-614.9455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1767.1581,-616.7068 1774.9218,-623.9163 1773.3485,-613.4389 1767.1581,-616.7068"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge175" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.6956,-451.0614C1288.3769,-473.7272 1343.7602,-425.6017 1445.2961,-503.0614 1484.1026,-532.6661 1537.2836,-674.2113 1556.3207,-727.6106"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1553.0266,-728.7934 1559.6585,-737.0558 1559.6266,-726.461 1553.0266,-728.7934"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M947.7671,-451.0614C1042.9254,-442.714 1069.2447,-431.2693 1162.6956,-451.0614"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge170" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M554.0879,-439.7905C558.0328,-397.7636 577.5965,-248.6305 660.8599,-171.0614 664.8703,-167.3252 669.4245,-164.1466 674.2824,-161.4426"/>
<polygon fill="#ff0000" stroke="#ff0000" points="675.8313,-164.5813 683.3031,-157.0698 672.7779,-158.2824 675.8313,-164.5813"/>
</g>
<!-- sourcefile~returnairpath.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_node68" class="node">
<title>sourcefile~returnairpath.f90</title>
<g id="a_sourcefile~~dxcoil.f90~~AfferentGraph_node68"><a xlink:href="../sourcefile/returnairpath.f90.html" xlink:title="ReturnAirPath.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="790.7093,-367.0668 694.7837,-367.0668 694.7837,-345.056 790.7093,-345.056 790.7093,-367.0668"/>
<text text-anchor="middle" x="742.7465" y="-352.9114" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReturnAirPath.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~returnairpath.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge174" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~returnairpath.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M575.3089,-439.9778C608.9802,-423.1024 673.2307,-390.9013 711.6073,-371.6677"/>
<polygon fill="#ff0000" stroke="#ff0000" points="713.4004,-374.6841 720.7722,-367.0744 710.264,-368.4261 713.4004,-374.6841"/>
</g>
<!-- sourcefile~zoneairloopequipmentmanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge176" class="edge">
<title>sourcefile~zoneairloopequipmentmanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1228.9997,-271.1349C1238.1506,-274.5913 1246.9732,-279.1224 1254.49,-285.0614 1280.7075,-305.7758 1264.6365,-329.8944 1290.49,-351.0614 1346.2264,-396.6945 1381.4306,-365.7429 1445.2961,-399.0614 1463.2673,-408.4369 1464.2485,-416.0958 1481.2961,-427.0614 1550.6221,-471.6541 1598.9179,-445.1371 1645.6179,-513.0614 1684.7838,-570.0276 1662.9757,-755.4913 1681.6179,-822.0614 1702.8611,-897.9195 1747.5388,-980.7791 1768.8764,-1017.9969"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1765.9612,-1019.9469 1774.0042,-1026.8434 1772.0174,-1016.4365 1765.9612,-1019.9469"/>
</g>
<!-- sourcefile~returnairpath.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~dxcoil.f90~~AfferentGraph_edge166" class="edge">
<title>sourcefile~returnairpath.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M790.6898,-346.6286C883.3911,-330.5063 1092.3578,-304.5458 1254.49,-361.0614 1273.6303,-367.7333 1272.5188,-379.6859 1290.49,-389.0614 1322.4228,-405.7206 1335.3256,-397.6799 1367.8931,-413.0614"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1367.8931,-413.0614C1403.7048,-427.7932 1415.9072,-427.8464 1445.2961,-453.0614 1560.0573,-551.5237 1573.4347,-595.191 1645.6179,-728.0614 1666.9737,-767.3719 1664.282,-780.82 1681.6179,-822.0614 1712.2912,-895.0319 1752.6435,-979.9462 1770.9394,-1017.9179"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1767.792,-1019.4489 1775.2933,-1026.931 1774.0951,-1016.4041 1767.792,-1019.4489"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefiledxcoilf90AfferentGraph = svgPanZoom('#sourcefiledxcoilf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/dxcoils.html">DXCoils</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/dxcoil.f90.html#src">DXCoil.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">DXCoils</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="c">! Module containing the DX coil simulation routines</span>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>  <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-7"></a>  <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-8"></a>  <span class="c">!       MODIFIED       Don Shirey, Aug/Sept 2000, Feb/Oct 2001, Sept 2003, Jan 2004</span>
<a name="ln-9"></a>  <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-10"></a>  <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-11"></a>  <span class="c">!                        Work supported by ASHRAE research project 1254-RP</span>
<a name="ln-12"></a>  <span class="c">!                      Aug 2006 B Griffith, NREL</span>
<a name="ln-13"></a>  <span class="c">!                        Added water system interactions for new water manager,</span>
<a name="ln-14"></a>  <span class="c">!                      Feb 2010 B Nigusse, FSEC</span>
<a name="ln-15"></a>  <span class="c">!                        Added Standard Rating for Coil:Cooling:DX:SingleSpeed</span>
<a name="ln-16"></a>  <span class="c">!                      April 2010 Chandan Sharma, FSEC</span>
<a name="ln-17"></a>  <span class="c">!                        Added basin heater routines for Coil:Cooling:DX:SingleSpeed,</span>
<a name="ln-18"></a>  <span class="c">!                        Coil:Cooling:DX:TwoSpeed, Coil:Cooling:DX:MultiSpeed</span>
<a name="ln-19"></a>  <span class="c">!                        and Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-20"></a>  <span class="c">!                      Feb 2013 Bereket Nigusse, FSEC</span>
<a name="ln-21"></a>  <span class="c">!                        Added DX Coil Model For 100% OA systems</span>
<a name="ln-22"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-23"></a>
<a name="ln-24"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-25"></a>  <span class="c">! To encapsulate the data and algorithms required to simulate DX cooling coils in</span>
<a name="ln-26"></a>  <span class="c">! EnergyPlus. Module currently models air-cooled or evap-cooled direct expansion systems</span>
<a name="ln-27"></a>  <span class="c">! (split or packaged). Air-side performance is modeled to determine coil discharge</span>
<a name="ln-28"></a>  <span class="c">! air conditions. The module also determines the DX unit&#39;s electrical energy usage.</span>
<a name="ln-29"></a>  <span class="c">! Neither the air-side performance nor the electrical energy usage includes the effect</span>
<a name="ln-30"></a>  <span class="c">! of supply air fan heat/energy usage. The supply air fan is modeled by other modules.</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-33"></a>  <span class="c">!</span>
<a name="ln-34"></a>
<a name="ln-35"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-36"></a>
<a name="ln-37"></a>
<a name="ln-38"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-39"></a>  <span class="c">!</span>
<a name="ln-40"></a>
<a name="ln-41"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-42"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-43"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-44"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-45"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-46"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-47"></a><span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-48"></a><span class="k">Use </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">CurMnDy</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-49"></a><span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HeatReclaimDXCoil</span>
<a name="ln-50"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-51"></a>
<a name="ln-52"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-53"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-58"></a>
<a name="ln-59"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-60"></a><span class="c">! Defrost strategy (heat pump only)</span>
<a name="ln-61"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ReverseCycle</span>     <span class="o">=</span> <span class="mi">1</span> <span class="c">! uses reverse cycle defrost strategy</span>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Resistive</span>        <span class="o">=</span> <span class="mi">2</span> <span class="c">! uses electric resistance heater for defrost</span>
<a name="ln-63"></a><span class="c">! Defrost control  (heat pump only)</span>
<a name="ln-64"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Timed</span>            <span class="o">=</span> <span class="mi">1</span> <span class="c">! defrost cycle is timed</span>
<a name="ln-65"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OnDemand</span>         <span class="o">=</span> <span class="mi">2</span> <span class="c">! defrost cycle occurs only when required</span>
<a name="ln-66"></a><span class="c">! Compressor operation</span>
<a name="ln-67"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">On</span>               <span class="o">=</span> <span class="mi">1</span> <span class="c">! normal compressor operation</span>
<a name="ln-68"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Off</span>              <span class="o">=</span> <span class="mi">0</span> <span class="c">! signal DXCoil that compressor shouldn&#39;t run</span>
<a name="ln-69"></a>
<a name="ln-70"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletAirTemp</span>   <span class="o">=</span> <span class="mi">2</span><span class="mf">6.6667d0</span>   <span class="c">! 26.6667C or 80F</span>
<a name="ln-71"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletWetbulbTemp</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">9.44d0</span>   <span class="c">! 19.44 or 67F</span>
<a name="ln-72"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletAirHumRat</span> <span class="o">=</span> <span class="mf">0.01125d0</span>   <span class="c">! Humidity ratio corresponding to 80F dry bulb/67F wet bulb</span>
<a name="ln-73"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedOutdoorAirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.0d0</span>      <span class="c">! 35 C or 95F</span>
<a name="ln-74"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletAirTempHeat</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.11d0</span>   <span class="c">! 21.11C or 70F</span>
<a name="ln-75"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedOutdoorAirTempHeat</span> <span class="o">=</span> <span class="mf">8.33d0</span>  <span class="c">! 8.33 C or 47F</span>
<a name="ln-76"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">RatedInletWetbulbTempHeat</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">5.55d0</span> <span class="c">! 15.55 or 60F</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="c">! Airflow per total capacity range (Regular DX coils)</span>
<a name="ln-79"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxRatedVolFlowPerRatedTotCap1</span> <span class="o">=</span> <span class="mf">0.00006041d0</span> <span class="c">! m3/s per watt = 450 cfm/ton</span>
<a name="ln-80"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinRatedVolFlowPerRatedTotCap1</span> <span class="o">=</span> <span class="mf">0.00004027d0</span> <span class="c">! m3/s per watt = 300 cfm/ton</span>
<a name="ln-81"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxHeatVolFlowPerRatedTotCap1</span>  <span class="o">=</span> <span class="mf">0.00008056d0</span> <span class="c">! m3/s per watt = 600 cfm/ton</span>
<a name="ln-82"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxCoolVolFlowPerRatedTotCap1</span>  <span class="o">=</span> <span class="mf">0.00006713d0</span> <span class="c">! m3/s per watt = 500 cfm/ton</span>
<a name="ln-83"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinOperVolFlowPerRatedTotCap1</span>  <span class="o">=</span> <span class="mf">0.00002684d0</span> <span class="c">! m3/s per watt = 200 cfm/ton</span>
<a name="ln-84"></a>
<a name="ln-85"></a><span class="c">! dx coil type (DXCT)</span>
<a name="ln-86"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RegularDXCoil</span>        <span class="o">=</span> <span class="mi">1</span> <span class="c">! Regular DX coils or mixed air dx coils</span>
<a name="ln-87"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DOASDXCoil</span>           <span class="o">=</span> <span class="mi">2</span> <span class="c">! 100% DOAS DX coils</span>
<a name="ln-88"></a><span class="c">! 100% DOAS DX coils Airflow per total capacity ratio</span>
<a name="ln-89"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxRatedVolFlowPerRatedTotCap2</span> <span class="o">=</span> <span class="mf">0.00003355d0</span> <span class="c">! m3/s per watt = 250 cfm/ton</span>
<a name="ln-90"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinRatedVolFlowPerRatedTotCap2</span> <span class="o">=</span> <span class="mf">0.00001677d0</span> <span class="c">! m3/s per watt = 125 cfm/ton</span>
<a name="ln-91"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxHeatVolFlowPerRatedTotCap2</span>  <span class="o">=</span> <span class="mf">0.00004026d0</span> <span class="c">! m3/s per watt = 300 cfm/ton</span>
<a name="ln-92"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxCoolVolFlowPerRatedTotCap2</span>  <span class="o">=</span> <span class="mf">0.00004026d0</span> <span class="c">! m3/s per watt = 300 cfm/ton</span>
<a name="ln-93"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinOperVolFlowPerRatedTotCap2</span>  <span class="o">=</span> <span class="mf">0.00001342d0</span> <span class="c">! m3/s per watt = 100 cfm/ton</span>
<a name="ln-94"></a>
<a name="ln-95"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">DryCoilOutletHumRatioMin</span>       <span class="o">=</span> <span class="mf">0.00001d0</span>    <span class="c">! dry coil outlet minimum hum ratio kgH2O/kgdry air</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="c">! Curve Types</span>
<a name="ln-98"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Linear</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-99"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Bilinear</span>    <span class="o">=</span> <span class="mi">2</span>
<a name="ln-100"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Quadratic</span>   <span class="o">=</span> <span class="mi">3</span>
<a name="ln-101"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Biquadratic</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-102"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Cubic</span>       <span class="o">=</span> <span class="mi">5</span>
<a name="ln-103"></a>
<a name="ln-104"></a><span class="c">! Multimode DX Coil</span>
<a name="ln-105"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxCapacityStages</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! Maximum number of capacity stages supported</span>
<a name="ln-106"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxDehumidModes</span>   <span class="o">=</span> <span class="mi">1</span>  <span class="c">! Maximum number of enhanced dehumidification modes supported</span>
<a name="ln-107"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxModes</span><span class="o">=</span><span class="n">MaxCapacityStages</span><span class="o">*</span><span class="p">(</span><span class="n">MaxDehumidModes</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Maximum number of performance modes</span>
<a name="ln-108"></a>
<a name="ln-109"></a><span class="c">!Water Systems</span>
<a name="ln-110"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateDiscarded</span> <span class="o">=</span> <span class="mi">1001</span> <span class="c">! default mode where water is &quot;lost&quot;</span>
<a name="ln-111"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateToTank</span>    <span class="o">=</span> <span class="mi">1002</span> <span class="c">! collect coil condensate from air and store in water storage tank</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterSupplyFromMains</span> <span class="o">=</span> <span class="mi">101</span>
<a name="ln-114"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterSupplyFromTank</span>  <span class="o">=</span> <span class="mi">102</span>
<a name="ln-115"></a>
<a name="ln-116"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidOutputFuelTypes</span><span class="o">=</span><span class="mi">9</span>
<a name="ln-117"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NumValidOutputFuelTypes</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cValidOutputFuelTypes</span><span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-118"></a>                 <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-119"></a>                   <span class="s1">&#39;Gas        &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-120"></a>                   <span class="s1">&#39;Propane    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-121"></a>                   <span class="s1">&#39;Diesel     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-122"></a>                   <span class="s1">&#39;Gasoline   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-123"></a>                   <span class="s1">&#39;FuelOil#1  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-124"></a>                   <span class="s1">&#39;FuelOil#2  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-125"></a>                   <span class="s1">&#39;OtherFuel1 &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-126"></a>                   <span class="s1">&#39;OtherFuel2 &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="c">! Fuel Types</span>
<a name="ln-129"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeElectricity</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c">! Fuel type for electricity</span>
<a name="ln-130"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeNaturalGas</span>  <span class="o">=</span> <span class="mi">2</span>     <span class="c">! Fuel type for natural gas</span>
<a name="ln-131"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypePropaneGas</span>  <span class="o">=</span> <span class="mi">3</span>     <span class="c">! Fuel type for propane gas</span>
<a name="ln-132"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeDiesel</span>      <span class="o">=</span> <span class="mi">4</span>     <span class="c">! Fuel type for diesel</span>
<a name="ln-133"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeGasoline</span>    <span class="o">=</span> <span class="mi">5</span>     <span class="c">! Fuel type for gasoline</span>
<a name="ln-134"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeFuelOil1</span>    <span class="o">=</span> <span class="mi">6</span>     <span class="c">! Fuel type for fuel oil #1</span>
<a name="ln-135"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeFuelOil2</span>    <span class="o">=</span> <span class="mi">7</span>     <span class="c">! Fuel type for fuel oil #2</span>
<a name="ln-136"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeOtherFuel1</span>  <span class="o">=</span> <span class="mi">8</span>     <span class="c">! Fuel type for other fuel #1</span>
<a name="ln-137"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FuelTypeOtherFuel2</span>  <span class="o">=</span> <span class="mi">9</span>     <span class="c">! Fuel type for other fuel #2</span>
<a name="ln-138"></a>
<a name="ln-139"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-140"></a><span class="k">TYPE</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">DXCoilData</span>
<a name="ln-141"></a><span class="c">!          Some variables in this type are arrays (dimension=MaxModes) to support coil type</span>
<a name="ln-142"></a><span class="c">!          COIL:DX:MultiMode:CoolingEmpirical.  Other coil types only use the first element.</span>
<a name="ln-143"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! Name of the DX Coil</span>
<a name="ln-144"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilType</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! type of coil</span>
<a name="ln-145"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Integer equivalent to DXCoilType</span>
<a name="ln-146"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Schedule</span>       <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! WaterCoil Operation Schedule</span>
<a name="ln-147"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SchedPtr</span>               <span class="o">=</span> <span class="mi">0</span> <span class="c">! Pointer to the correct schedule</span>
<a name="ln-148"></a><span class="c">!          RatedCoolCap, RatedSHR and RatedCOP do not include the thermal or electrical</span>
<a name="ln-149"></a><span class="c">!          effects due to the supply air fan</span>
<a name="ln-150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCap</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Gross total cooling capacity at rated conditions [watts]</span>
<a name="ln-151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatSizeRatio</span>          <span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! heat pump heating to cooling sizing ratio when autosized</span>
<a name="ln-152"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">!if true, then EMS is calling to override rated total capacity</span>
<a name="ln-153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCapEMSOverrideValue</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! value to use for EMS override</span>
<a name="ln-154"></a>
<a name="ln-155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHR</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible heat ratio (sens cap/total cap) at rated conditions</span>
<a name="ln-156"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedSHREMSOverrideOn</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! if true, then EMS is calling to override Sensible heat ratio</span>
<a name="ln-157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHREMSOverrideValue</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! value to use for EMS override forSensible heat ratio</span>
<a name="ln-158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCOP</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Coefficient of performance at rated conditions</span>
<a name="ln-159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air volume flow rate through coil at rated conditions [m3/s]</span>
<a name="ln-160"></a>                                                   <span class="c">! This is adjusted for bypassed air if any (see BypassedFlowFrac)</span>
<a name="ln-161"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RatedAirVolFlowRateEMSOverrideON</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! if true, then EMS is calling to override Air volume flow rate</span>
<a name="ln-162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateEMSOverrideValue</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! value to use for EMS override Air volume flow rate</span>
<a name="ln-163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Fan Power Per Air volume flow rate through the</span>
<a name="ln-164"></a>                                                         <span class="c">! Evaporator coil at rated conditions [W/(m3/s)]</span>
<a name="ln-165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air mass flow rate through coil at rated conditions [kg/s]</span>
<a name="ln-166"></a>                                                 <span class="c">! This is adjusted for bypassed air if any (see BypassedFlowFrac)</span>
<a name="ln-167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Fraction of air flow bypassed around coil</span>
<a name="ln-168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBF</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! rated coil bypass factor, determined using RatedTotCap and RatedSHR</span>
<a name="ln-169"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirInNode</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Air inlet node number</span>
<a name="ln-170"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirOutNode</span>             <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Air outlet node number</span>
<a name="ln-171"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CCapFTemp</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of total cooling capacity modifier curve</span>
<a name="ln-172"></a>                                         <span class="c">! (function of entering wetbulb, outside drybulb)</span>
<a name="ln-173"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CCapFTempErrorIndex</span>    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for warning messages when output of CCapFTemp is negative</span>
<a name="ln-174"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!type of curve for CCapFTemp (cubic,quadratic,bi-quadratic)</span>
<a name="ln-175"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CCapFFlow</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of total cooling capacity modifier curve</span>
<a name="ln-176"></a>                                         <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CCapFFlowErrorIndex</span>    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for warning messages when output of CCapFFlow is negative</span>
<a name="ln-178"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFTemp</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of energy input ratio modifier curve</span>
<a name="ln-179"></a>                                         <span class="c">! (function of entering wetbulb, outside drybulb)</span>
<a name="ln-180"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFTempErrorIndex</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for warning messages when output of EIRFTemp is negative</span>
<a name="ln-181"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!type of curve for EIRFTemp (cubic,quadratic,bi-quadratic)</span>
<a name="ln-182"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFFlow</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of energy input ratio modifier curve</span>
<a name="ln-183"></a>                                         <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-184"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFFlowErrorIndex</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for warning messages when output of EIRFFlow is negative</span>
<a name="ln-185"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PLFFPLR</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>      <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of part-load factor vs part-load ratio curve</span>
<a name="ln-186"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ReportCoolingCoilCrankcasePower</span> <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! logical determines if the cooling coil crankcase heater power is reported</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! total crankcase heater capacity [W]</span>
<a name="ln-188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterPower</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! report variable for average crankcase heater power [W]</span>
<a name="ln-189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxOATCrankcaseHeater</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! maximum OAT for crankcase heater operation [C]</span>
<a name="ln-190"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterConsumption</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! report variable for total crankcase heater energy consumption [J]</span>
<a name="ln-191"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterPowerFTempDiff</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Basin heater capacity per degree C below setpoint (W/C)</span>
<a name="ln-192"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterSetPointTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! setpoint temperature for basin heater operation (C)</span>
<a name="ln-193"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompanionUpstreamDXCoil</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index number of the DX coil that is &quot;upstream&quot; of this DX coil. Currently used for</span>
<a name="ln-194"></a>                                          <span class="c">! UnitarySystem:HeatPump:AirToAir for proper calculation of crankcase heater energy</span>
<a name="ln-195"></a>                                          <span class="c">! consumption</span>
<a name="ln-196"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Flag to get the companion coil in Init.</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Node number of outdoor condenser(s) (actually an evaporator for heating coils)</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LowOutletTempIndex</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! used for low outlet temperature warnings</span>
<a name="ln-199"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTempLast</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! used for low outlet temperature warnings</span>
<a name="ln-200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadInletAirTempLast</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! used for low outlet temperature warnings</span>
<a name="ln-201"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PrintLowOutTempMessage</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! used to print warning message for low outlet air dry-bulb conditions</span>
<a name="ln-202"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowOutTempBuffer1</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! holds warning message until next iteration (only prints 1 message/iteration)</span>
<a name="ln-203"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowOutTempBuffer2</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! holds warning message until next iteration (only prints 1 message/iteration)</span>
<a name="ln-204"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatingCoilPLFCurvePTR</span>  <span class="o">=</span> <span class="mi">0</span>      <span class="c">! PLF curve index to gas or electric heating coil (used in latent degradation model)</span>
<a name="ln-205"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BasinHeaterSchedulePtr</span>  <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Pointer to basin heater schedule</span>
<a name="ln-206"></a>
<a name="ln-207"></a><span class="c">! start of multi-speed compressor variables</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCap2</span>           <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Gross total cooling capacity at rated conditions, low speed [watts]</span>
<a name="ln-209"></a>                                         <span class="c">! Note: For HPWHs, RatedTotCap2   = Water Heating Capacity for Coil:DX:HPWH and</span>
<a name="ln-210"></a>                                         <span class="c">!                  RatedTotCap(1) = Air Cooling Coil Capacity for Coil:DX:HPWH</span>
<a name="ln-211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHR2</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible heat ratio (sens cap/total cap) at rated conditions, low speed</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCOP2</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Coefficient of performance at rated conditions, low speed</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRate2</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air volume flow rate through unit at rated conditions, low speed [m3/s]</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirMassFlowRate2</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air mass flow rate through unit at rated conditions, low speed [kg/s]</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBF2</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! rated coil bypass factor (low speed), determined using RatedTotCap2 and RatedSHR2</span>
<a name="ln-216"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CCapFTemp2</span>             <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of total cooling capacity modifier curve (low speed)</span>
<a name="ln-217"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFTemp2</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of energy input ratio modifier curve (low speed)</span>
<a name="ln-218"></a>                                         <span class="c">! (function of entering wetbulb, outside drybulb)</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedEIR2</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! rated energy input ratio (low speed, inverse of COP2)</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InternalStaticPressureDrop</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! for rating VAV system</span>
<a name="ln-221"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RateWithInternalStaticAndFanObject</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-222"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SupplyFanIndex</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-223"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyFanName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-224"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilSystemName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-225"></a><span class="c">! end of multi-speed compressor variables</span>
<a name="ln-226"></a>
<a name="ln-227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedEIR</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! rated energy input ratio (inverse of COP)</span>
<a name="ln-228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirMassFlowRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirMassFlowRateMax</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirTemp</span>           <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>         <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>       <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-233"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-234"></a><span class="c">!  REAL(r64) :: InletAirPressure       =0.0d0</span>
<a name="ln-235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>          <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>        <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>      <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Ratio of actual sensible cooling load to steady-state sensible cooling capacity</span>
<a name="ln-239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolingEnergy</span>     <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolingEnergy</span>      <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatCoolingEnergy</span>       <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensCoolingEnergyRate</span>  <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatCoolingEnergyRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingConsumption</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingPower</span>       <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Run time fraction of the DX cooling unit</span>
<a name="ln-248"></a>
<a name="ln-249"></a><span class="c">! start of variables used in heat pump heating coils only</span>
<a name="ln-250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalHeatingEnergy</span>     <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-252"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecHeatingConsumption</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecHeatingPower</span>       <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-254"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Run time fraction of the DX heating unit</span>
<a name="ln-255"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DefrostStrategy</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! defrost strategy; 1=reverse-cycle, 2=resistive</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DefrostControl</span>         <span class="o">=</span> <span class="mi">0</span>   <span class="c">! defrost control; 1=timed, 2=on-demand</span>
<a name="ln-257"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EIRFPLR</span>                <span class="o">=</span> <span class="mi">0</span>   <span class="c">! index of energy input ratio vs part-load ratio curve</span>
<a name="ln-258"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DefrostEIRFT</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! index of defrost mode total cooling capacity for reverse cycle heat pump</span>
<a name="ln-259"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RegionNum</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Region number for calculating HSPF of single speed DX heating coil</span>
<a name="ln-260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinOATCompressor</span>       <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Minimum OAT for heat pump compressor operation</span>
<a name="ln-261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OATempCompressorOn</span>   <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! The outdoor tempearture when the compressor is automatically turned back on,</span>
<a name="ln-262"></a>                                           <span class="c">! if applicable, following automatic shut off. This field is used only for</span>
<a name="ln-263"></a>                                           <span class="c">! HSPF calculation.</span>
<a name="ln-264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxOATCompressor</span>       <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Maximum OAT for VRF heat pump compressor operation</span>
<a name="ln-265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxOATDefrost</span>          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Maximum OAT for defrost operation</span>
<a name="ln-266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostTime</span>            <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Defrost time period in hours</span>
<a name="ln-267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostCapacity</span>        <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Resistive defrost to nominal capacity (at 21.11C/8.33C) ratio</span>
<a name="ln-268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPCompressorRuntime</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! keep track of compressor runtime</span>
<a name="ln-269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPCompressorRuntimeLast</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! keep track of last time step compressor runtime (if simulation downshifts)</span>
<a name="ln-270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TimeLeftToDefrost</span>      <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! keep track of time left to defrost heat pump</span>
<a name="ln-271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostPower</span>           <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! power used during defrost</span>
<a name="ln-272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostConsumption</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! energy used during defrost</span>
<a name="ln-273"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HeatingPerformanceOATType</span><span class="o">=</span><span class="n">DryBulbIndicator</span>  <span class="c">! Heating performance curve OAT type (1-wetbulb, 2-drybulb)</span>
<a name="ln-274"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HPCoilIsInCoilSystemHeatingDX</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-275"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">OATempCompressorOnOffBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-276"></a><span class="c">! end of variables used in heat pump heating coils only</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="c">! start of variables for DX cooling coil latent degradation model</span>
<a name="ln-279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_Rated</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s</span>
<a name="ln-280"></a>                                                       <span class="c">! condensate drain line (sec)</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_Rated</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Initial moisture evaporation rate divided by steady-state</span>
<a name="ln-282"></a>                                                       <span class="c">! AC latent capacity (dimensionless)</span>
<a name="ln-283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Maximum ON/OFF cycles per hour for the compressor (cycles/hour)</span>
<a name="ln-284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentCapacityTimeConstant</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Time constant for latent capacity to reach steady state</span>
<a name="ln-285"></a>                                                       <span class="c">! after startup (sec)</span>
<a name="ln-286"></a><span class="c">! end of variables for DX cooling coil latent degradation model</span>
<a name="ln-287"></a>
<a name="ln-288"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CondenserType</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="n">AirCooled</span> <span class="c">! Type of condenser for DX cooling coil: AIR COOLED or EVAP COOLED</span>
<a name="ln-289"></a>
<a name="ln-290"></a><span class="c">! start of variables for DX cooling coil evaporative condenser option</span>
<a name="ln-291"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ReportEvapCondVars</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! true if any performance mode includes an evap condenser</span>
<a name="ln-292"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! effectiveness of the evaporatively cooled condenser</span>
<a name="ln-293"></a>                                            <span class="c">! [high speed for multi-speed unit] (-)</span>
<a name="ln-294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>  <span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Evap condenser inlet temperature [C], report variable</span>
<a name="ln-295"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Air flow rate through the evap condenser at high speed,</span>
<a name="ln-296"></a>                                                 <span class="c">! for water use calcs [m3/s]</span>
<a name="ln-297"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Nominal power input to the evap condenser water circulation pump</span>
<a name="ln-298"></a>                                                     <span class="c">! at high speed [W]</span>
<a name="ln-299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span><span class="mf">0.0d0</span>    <span class="c">! Average power consumed by the evap condenser water circulation pump over</span>
<a name="ln-300"></a>                                           <span class="c">! the time step [W]</span>
<a name="ln-301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Electric energy consumed by the evap condenser water circulation pump [J]</span>
<a name="ln-302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterConsumpRate</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Evap condenser water consumption rate [m3/s]</span>
<a name="ln-303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterConsump</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Evap condenser water consumption [m3]</span>
<a name="ln-304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlow2</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air flow rate through the evap condenser at low speed, for water use calcs [m3/s]</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondEffect2</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! effectiveness of the evaporatively cooled condenser at low speed (-)</span>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPower2</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Nominal power input to the evap condenser water circulation pump at low speed [W]</span>
<a name="ln-307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterPower</span>          <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Basin heater power (W)</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterConsumption</span>    <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Basin heater energy consumption (J)</span>
<a name="ln-309"></a><span class="c">! end of variables for DX cooling coil evaporative condenser option</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="c">! start of variables for Multimode DX cooling coil</span>
<a name="ln-312"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCapacityStages</span><span class="o">=</span><span class="mi">1</span> <span class="c">! number of capacity stages, up to MaxCapacityStages for Multimode DX coil,</span>
<a name="ln-313"></a>                                 <span class="c">! always 1 for other coils</span>
<a name="ln-314"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDehumidModes</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! number of enhanced dehumidification modes, up to MaxDehumidModes for Multimode DX coil,</span>
<a name="ln-315"></a>                                 <span class="c">! always 0 for other coils)</span>
<a name="ln-316"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilPerformanceType</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>    <span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! Coil Performance object type</span>
<a name="ln-317"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CoilPerformanceType_Num</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span><span class="o">=</span> <span class="mi">0</span>   <span class="c">! Coil Performance object type number</span>
<a name="ln-318"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>    <span class="o">=</span><span class="s1">&#39; &#39;</span>  <span class="c">! Coil Performance object names</span>
<a name="ln-319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilStg2RuntimeFrac</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Run time fraction of stage 2</span>
<a name="ln-320"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DehumidificationMode</span>               <span class="o">=</span><span class="mi">0</span>   <span class="c">! Dehumidification mode for multimode coil,</span>
<a name="ln-321"></a>                                                     <span class="c">! 0=normal, 1+=enhanced dehumidification mode</span>
<a name="ln-322"></a><span class="c">! end of variables for Multimode DX cooling coil</span>
<a name="ln-323"></a>
<a name="ln-324"></a><span class="c">! start of variables for heat pump water heater DX coil</span>
<a name="ln-325"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterInNode</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Condenser water inlet node number for HPWH DX coil</span>
<a name="ln-326"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterOutNode</span>                <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Condenser water outlet node number for HPWH DX coil</span>
<a name="ln-327"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFTemp</span>                   <span class="o">=</span> <span class="mi">0</span>       <span class="c">! COP as a function of temperature curve index</span>
<a name="ln-328"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFTempErrorIndex</span>         <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Used for warning messages when output of HCOPFTemp is negative</span>
<a name="ln-329"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFTempCurveType</span>          <span class="o">=</span> <span class="mi">0</span>       <span class="c">! COP as a function of temperature curve type</span>
<a name="ln-330"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFAirFlow</span>                <span class="o">=</span> <span class="mi">0</span>       <span class="c">! COP as a function of air flow rate ratio curve index</span>
<a name="ln-331"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFAirFlowErrorIndex</span>      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Used for warning messages when output of HCOPFAirFlow is negative</span>
<a name="ln-332"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFWaterFlow</span>              <span class="o">=</span> <span class="mi">0</span>       <span class="c">! COP as a function of water flow rate ratio curve index</span>
<a name="ln-333"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCOPFWaterFlowErrorIndex</span>    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Used for warning messages when output of HCOPFWaterFlow is negative</span>
<a name="ln-334"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFTemp</span>                   <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Heating capacity as a function of temperature curve index</span>
<a name="ln-335"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFTempErrorIndex</span>         <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Used for warning messages when output of HCapFTemp is negative</span>
<a name="ln-336"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFTempCurveType</span>          <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Heating capacity as a function of temperature curve type</span>
<a name="ln-337"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFAirFlow</span>                <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Heating capacity as a function of air flow rate ratio curve index</span>
<a name="ln-338"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFAirFlowErrorIndex</span>      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Used for warning messages when output of HCapFAirFlow is negative</span>
<a name="ln-339"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFWaterFlow</span>              <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Heating capacity as a function of water flow rate ratio curve index</span>
<a name="ln-340"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HCapFWaterFlowErrorIndex</span>    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Used for warning messages when output of HCapFWaterFlow is negative</span>
<a name="ln-341"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletAirTemperatureType</span>     <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Specifies to use either air wet-bulb or dry-bulb temp for curve objects</span>
<a name="ln-342"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedInletDBTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Rated inlet air dry-bulb temperature [C]</span>
<a name="ln-343"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedInletWBTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Rated inlet air wet-bulb temperature [C]</span>
<a name="ln-344"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedInletWaterTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Rated condenser water inlet temperature [C]</span>
<a name="ln-345"></a><span class="c">!  REAL(r64) :: CondenserInletWaterTemp     = 0.0     ! Actual inlet water temperature to condenser of the HPWH DX coil [C]</span>
<a name="ln-346"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPWHCondPumpElecNomPower</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Nominal power input to the condenser water circulation pump [W]</span>
<a name="ln-347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPWHCondPumpFracToWater</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Nominal power fraction to water for the condenser water circulation pump</span>
<a name="ln-348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHPWHCondWaterFlow</span>      <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Rated water flow rate through the condenser of the HPWH DX coil [m3/s]</span>
<a name="ln-349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecWaterHeatingPower</span>       <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Total electric power consumed by compressor and condenser pump [W]</span>
<a name="ln-350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecWaterHeatingConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Total electric consumption by compressor and condenser pump [J]</span>
<a name="ln-351"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FanPowerIncludedInCOP</span>       <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Indicates that fan heat is included in heating capacity and COP</span>
<a name="ln-352"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CondPumpHeatInCapacity</span>      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Indicates that condenser pump heat is included in heating capacity</span>
<a name="ln-353"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CondPumpPowerInCOP</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Indicates that condenser pump power is included in heating COP</span>
<a name="ln-354"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">AirVolFlowAutoSized</span>         <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used to report autosizing info for the HPWH DX coil</span>
<a name="ln-355"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WaterVolFlowAutoSized</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used to report autosizing info for the HPWH DX coil</span>
<a name="ln-356"></a><span class="c">! end of variables for heat pump water heater DX coil</span>
<a name="ln-357"></a>
<a name="ln-358"></a><span class="c">! Error tracking</span>
<a name="ln-359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowTempLast</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! low ambient temp entering condenser when warning message occurred</span>
<a name="ln-360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighTempLast</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! high ambient temp entering condenser when warning message occurred</span>
<a name="ln-361"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrIndex1</span><span class="o">=</span><span class="mi">0</span>     <span class="c">! index/pointer to recurring error structure for Air volume flow rate per watt of</span>
<a name="ln-362"></a>                             <span class="c">! rated total cooling capacity error</span>
<a name="ln-363"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrIndex2</span><span class="o">=</span><span class="mi">0</span>     <span class="c">! index/pointer to recurring error structure for PLF curve values must be &gt;= 0.7. error</span>
<a name="ln-364"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrIndex3</span><span class="o">=</span><span class="mi">0</span>     <span class="c">! index/pointer to recurring error structure for DX cooling coil runtime fraction &gt; 1.0 warning</span>
<a name="ln-365"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrIndex4</span><span class="o">=</span><span class="mi">0</span>     <span class="c">! index/pointer to recurring error structure for DX heating coil runtime fraction &gt; 1.0 warning</span>
<a name="ln-366"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LowAmbErrIndex</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! index/pointer to recurring error structure for low ambient temp entering condenser</span>
<a name="ln-367"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HighAmbErrIndex</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! index/pointer to recurring error structure for high ambient temp entering condenser</span>
<a name="ln-368"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PLFErrIndex</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! index/pointer to recurring error structure for PLF &lt;&gt; 1 at speed 1 for a multiple speed coil</span>
<a name="ln-369"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PLRErrIndex</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! index/pointer to recurring error structure for PLR &lt; .7</span>
<a name="ln-370"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PrintLowAmbMessage</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! used to print warning message for low ambient conditions</span>
<a name="ln-371"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowAmbBuffer1</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! holds warning message until next iteration (only prints 1 message/iteration)</span>
<a name="ln-372"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowAmbBuffer2</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! holds warning message until next iteration (only prints 1 message/iteration)</span>
<a name="ln-373"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PrintHighAmbMessage</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! used to print warning message for high ambient conditions</span>
<a name="ln-374"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighAmbBuffer1</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! holds warning message until next iteration (only prints 1 message/iteration)</span>
<a name="ln-375"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighAmbBuffer2</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! holds warning message until next iteration (only prints 1 message/iteration)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>  <span class="c">!begin variables for Water System interactions</span>
<a name="ln-378"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">EvapWaterSupplyMode</span>                   <span class="o">=</span> <span class="n">WaterSupplyFromMains</span> <span class="c">!  where does water come from</span>
<a name="ln-379"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-380"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">EvapWaterSupTankID</span>                    <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-381"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">EvapWaterTankDemandARRID</span>              <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-382"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateCollectMode</span>                 <span class="o">=</span> <span class="n">CondensateDiscarded</span> <span class="c">!  where does water come from</span>
<a name="ln-383"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-384"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateTankID</span>                      <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-385"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateTankSupplyARRID</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-386"></a>
<a name="ln-387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondensateVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! rate of water condensation from air stream [m3/s]</span>
<a name="ln-388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondensateVol</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! amount of water condensed from air stream [m3]</span>
<a name="ln-389"></a>
<a name="ln-390"></a>  <span class="c">!end variables for water system interactions</span>
<a name="ln-391"></a>
<a name="ln-392"></a>  <span class="c">! used to print low ambient warning message for DOE2 coil only after time step has incremented</span>
<a name="ln-393"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TimeStepSysLast</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-395"></a>  <span class="c">! for multispeed DX coil type</span>
<a name="ln-396"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FuelType</span>       <span class="o">=</span><span class="mi">0</span>   <span class="c">! Fuel type</span>
<a name="ln-397"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfSpeeds</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of speeds</span>
<a name="ln-398"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PLRImpact</span>      <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! Part load fraction applied to Speed Number &gt; 1</span>
<a name="ln-399"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LatentImpact</span>   <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! Latent degradation applied to Speed Number &gt; 1</span>
<a name="ln-400"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSErrIndex</span> <span class="c">! index flag for num speeds/recurring messages</span>
<a name="ln-401"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSRatedTotCap</span> <span class="c">! Rated cooling capacity for MS heat pump [W]</span>
<a name="ln-402"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSRatedSHR</span>    <span class="c">! Rated SHR for MS heat pump [dimensionless]</span>
<a name="ln-403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSRatedCOP</span>    <span class="c">! Rated COP for MS heat pump [dimensionless]</span>
<a name="ln-404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSRatedAirVolFlowRate</span>  <span class="c">! Air volume flow rate through unit at rated conditions [m3/s]</span>
<a name="ln-405"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSRatedAirMassFlowRate</span> <span class="c">! Air mass flow rate through unit at rated conditions [m3/s]</span>
<a name="ln-406"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSRatedCBF</span>    <span class="c">! rated coil bypass factor</span>
<a name="ln-407"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSCCapFTemp</span>   <span class="c">! index of total cooling capacity modifier curve</span>
<a name="ln-408"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSCCapFFlow</span>   <span class="c">! index of total cooling capacity modifier curve</span>
<a name="ln-409"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSEIRFTemp</span>    <span class="c">! index of energy input ratio modifier curve as a function of temperature</span>
<a name="ln-410"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSEIRFFlow</span>    <span class="c">! index of energy input ratio modifier curve as a function of flow fraction</span>
<a name="ln-411"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSPLFFPLR</span>     <span class="c">! index of part load factor as a function of part load ratio</span>
<a name="ln-412"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSWasteHeat</span>   <span class="c">! index of waste heat as a function of temperature</span>
<a name="ln-413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSWasteHeatFrac</span>  <span class="c">! Waste heat fraction</span>
<a name="ln-414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSEvapCondEffect</span> <span class="c">! effectiveness of the evaporatively cooled condenser</span>
<a name="ln-415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSEvapCondAirFlow</span> <span class="c">! Air flow rate through the evap condenser for water use calcs [m3/s]</span>
<a name="ln-416"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSEvapCondPumpElecNomPower</span> <span class="c">! Nominal power input to the evap condenser</span>
<a name="ln-417"></a>                                                                     <span class="c">! water circulation pump</span>
<a name="ln-418"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSTotCapTempModFacCurveType</span> <span class="c">! type of curve for CCapFTemp (cubic,quadratic,bi-quadratic)</span>
<a name="ln-419"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSEIRTempModFacCurveType</span> <span class="c">!type of curve for EIRFTemp (cubic,quadratic,bi-quadratic)</span>
<a name="ln-420"></a>
<a name="ln-421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSTwet_Rated</span>      <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s</span>
<a name="ln-422"></a>                                                   <span class="c">! condensate drain line (sec)</span>
<a name="ln-423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSGamma_Rated</span>     <span class="c">! Initial moisture evaporation rate divided by steady-state</span>
<a name="ln-424"></a>                                                   <span class="c">! AC latent capacity (dimensionless)</span>
<a name="ln-425"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSMaxONOFFCyclesperHour</span> <span class="c">! Maximum ON/OFF cycles per hour for the compressor (cycles/hour)</span>
<a name="ln-426"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSLatentCapacityTimeConstant</span> <span class="c">! Time constant for latent capacity to reach steady state</span>
<a name="ln-427"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSFanPowerPerEvapAirFlowRate</span>
<a name="ln-428"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelUsed</span>            <span class="c">! Energy used, in addition to electricity [W]</span>
<a name="ln-429"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelConsumed</span>        <span class="c">! Energy consumed, in addition to electricity [J]</span>
<a name="ln-430"></a>  <span class="c">! End of multispeed DX coil input</span>
<a name="ln-431"></a>
<a name="ln-432"></a>  <span class="c">! VRF system variables used for sizing</span>
<a name="ln-433"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CoolingCoilPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! FALSE if coil not present</span>
<a name="ln-434"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">HeatingCoilPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! FALSE if coil not present</span>
<a name="ln-435"></a>
<a name="ln-436"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ISHundredPercentDOASDXCoil</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! FALSE if coil is regular dx coil</span>
<a name="ln-437"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFTemp</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of sensible heat ratio modifier curve</span>
<a name="ln-438"></a>                                           <span class="c">! (function of entering wetbulb and drybulb)</span>
<a name="ln-439"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFTempErrorIndex</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for warning messages when output of SHRFTemp is negative</span>
<a name="ln-440"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFTempCurveType</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!type of curve for SHRFTemp (cubic,quadratic,bi-quadratic)</span>
<a name="ln-441"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFFlow</span><span class="p">(</span><span class="n">MaxModes</span><span class="p">)</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of sensible heat ratio modifier curve</span>
<a name="ln-442"></a>                                           <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-443"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFFlowErrorIndex</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for warning messages when output of SHRFFlow is negative</span>
<a name="ln-444"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFTemp2</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of sensible heat ratio modifier curve</span>
<a name="ln-445"></a>                                           <span class="c">! (function of entering wetbulb and drybulb)</span>
<a name="ln-446"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFFlow2</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! index of sensible heat ratio modifier curve</span>
<a name="ln-447"></a>                                           <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-448"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SHRFTempCurveType2</span>     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! type of curve for SHRFTemp (cubic,quadratic,bi-quadratic)</span>
<a name="ln-449"></a>
<a name="ln-450"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">UserSHRCurveExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! TRUE if user specified SHR modifier curve exists</span>
<a name="ln-451"></a>
<a name="ln-452"></a><span class="k">END TYPE </span><span class="n">DXCoilData</span>
<a name="ln-453"></a>
<a name="ln-454"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-455"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DXCoilData</span><span class="p">)</span> <span class="p">,</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoil</span>
<a name="ln-456"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilOutletTemp</span>    <span class="c">! DX coil outlet dry bulb temperature [C]</span>
<a name="ln-457"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilOutletHumRat</span>  <span class="c">! DX coil outlet humidity ratio [kgWater/kgDryAir]</span>
<a name="ln-458"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilPartLoadRatio</span> <span class="c">! DX coil part-load ratio</span>
<a name="ln-459"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilFanOpMode</span>       <span class="c">! supply air fan operating mode</span>
<a name="ln-460"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilFullLoadOutAirTemp</span> <span class="c">! DX coil full load outlet dry bulb temperature [C]</span>
<a name="ln-461"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilFullLoadOutAirHumRat</span> <span class="c">! DX coil full load outlet humidity ratio [kgWater/kgDryAir]</span>
<a name="ln-462"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilTotalCooling</span> <span class="c">! DX cooling coil total cooling output [W]</span>
<a name="ln-463"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilTotalHeating</span> <span class="c">! DX heating coil total heating output [W]</span>
<a name="ln-464"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilCoolInletAirWBTemp</span> <span class="c">! DX cooling coil inlet air wet-bulb temp [C]</span>
<a name="ln-465"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilHeatInletAirDBTemp</span> <span class="c">! DX heating coil inlet air dry-bulb temp [C]</span>
<a name="ln-466"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DXCoilHeatInletAirWBTemp</span> <span class="c">! DX heating coil inlet air wet-bulb temp [C]</span>
<a name="ln-467"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">CurDXCoilNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-468"></a>
<a name="ln-469"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">NumDXCoils</span>             <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Total number of DX coils</span>
<a name="ln-470"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span>    <span class="kd">::</span> <span class="n">HPWHHeatingCapacity</span>    <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Used by Heat Pump:Water Heater object as total water heating capacity [W]</span>
<a name="ln-471"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PUBLIC</span>    <span class="kd">::</span> <span class="n">HPWHHeatingCOP</span>         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Used by Heat Pump:Water Heater object as water heating COP [W/W]</span>
<a name="ln-472"></a><span class="kt">LOGICAL</span>         <span class="kd">::</span> <span class="n">GetCoilsInputFlag</span>      <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! First time, input is &quot;gotten&quot;</span>
<a name="ln-473"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumVRFHeatingCoils</span>     <span class="o">=</span> <span class="mi">0</span>     <span class="c">! number of VRF heat pump heating coils</span>
<a name="ln-474"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumVRFCoolingCoils</span>     <span class="o">=</span> <span class="mi">0</span>     <span class="c">! number of VRF heat pump cooling coils</span>
<a name="ln-475"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDXHeatingCoils</span>     <span class="o">=</span> <span class="mi">0</span>      <span class="c">! number of DX heat pump heating coils</span>
<a name="ln-476"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDoe2DXCoils</span>        <span class="o">=</span> <span class="mi">0</span>      <span class="c">! number of doe2 DX  coils</span>
<a name="ln-477"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! number of DX  water heater coils</span>
<a name="ln-478"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDXMulSpeedCoils</span>    <span class="o">=</span> <span class="mi">0</span>      <span class="c">! number of DX coils with multi-speed compressor</span>
<a name="ln-479"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDXMulModeCoils</span>     <span class="o">=</span> <span class="mi">0</span>      <span class="c">! number of DX coils with multi-mode performance</span>
<a name="ln-480"></a>
<a name="ln-481"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDXMulSpeedCoolCoils</span><span class="o">=</span> <span class="mi">0</span>      <span class="c">! number of multispeed DX cooling coils</span>
<a name="ln-482"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">NumDXMulSpeedHeatCoils</span><span class="o">=</span> <span class="mi">0</span>      <span class="c">! number of multispeed DX heating coils</span>
<a name="ln-483"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-484"></a>
<a name="ln-485"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">DXCT</span> <span class="o">=</span> <span class="mi">1</span>                       <span class="c">! dx coil type: regular DX coil ==1, 100% DOAS DX coil = 2</span>
<a name="ln-486"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span>
<a name="ln-487"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span>
<a name="ln-488"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxHeatVolFlowPerRatedTotCap</span>
<a name="ln-489"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxCoolVolFlowPerRatedTotCap</span>
<a name="ln-490"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinOperVolFlowPerRatedTotCap</span>
<a name="ln-491"></a>
<a name="ln-492"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-493"></a>
<a name="ln-494"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-495"></a><span class="k">PUBLIC  </span><span class="n">SimDXCoil</span>
<a name="ln-496"></a><span class="k">PUBLIC  </span><span class="n">SimDXCoilMultiSpeed</span>
<a name="ln-497"></a><span class="k">PUBLIC  </span><span class="n">SimDXCoilMultiMode</span>
<a name="ln-498"></a>
<a name="ln-499"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-500"></a><span class="k">PRIVATE </span><span class="n">GetDXCoils</span>
<a name="ln-501"></a>
<a name="ln-502"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-503"></a><span class="k">PRIVATE </span><span class="n">InitDXCoil</span>
<a name="ln-504"></a><span class="k">PRIVATE </span><span class="n">SizeDXCoil</span>
<a name="ln-505"></a><span class="k">PRIVATE </span><span class="n">CalcBasinHeaterPowerForMultiModeDXCoil</span>
<a name="ln-506"></a>
<a name="ln-507"></a>          <span class="c">! Update routines to check convergence and update nodes</span>
<a name="ln-508"></a><span class="k">PUBLIC  </span><span class="n">CalcHPWHDXCoil</span>
<a name="ln-509"></a><span class="k">PUBLIC  </span><span class="n">CalcDoe2DXCoil</span>
<a name="ln-510"></a><span class="k">PUBLIC  </span><span class="n">CalcVRFCoolingCoil</span>
<a name="ln-511"></a><span class="k">PUBLIC  </span><span class="n">CalcDXHeatingCoil</span>
<a name="ln-512"></a><span class="k">PUBLIC  </span><span class="n">CalcMultiSpeedDXCoil</span>
<a name="ln-513"></a><span class="k">PUBLIC  </span><span class="n">CalcMultiSpeedDXCoilCooling</span>
<a name="ln-514"></a><span class="k">PUBLIC  </span><span class="n">CalcMultiSpeedDXCoilHeating</span>
<a name="ln-515"></a><span class="k">PRIVATE </span><span class="n">UpdateDXCoil</span>
<a name="ln-516"></a><span class="k">PRIVATE </span><span class="n">ReportDXCoil</span>
<a name="ln-517"></a>
<a name="ln-518"></a>          <span class="c">! Common routines</span>
<a name="ln-519"></a><span class="k">PRIVATE </span><span class="n">CalcTotCapSHR</span>
<a name="ln-520"></a><span class="k">PRIVATE </span><span class="n">CalcCBF</span>
<a name="ln-521"></a><span class="k">PRIVATE </span><span class="n">AdjustCBF</span>
<a name="ln-522"></a><span class="k">PRIVATE </span><span class="n">CalcSHRUserDefinedCurves</span>
<a name="ln-523"></a>
<a name="ln-524"></a>
<a name="ln-525"></a><span class="k">PRIVATE  </span><span class="n">CalcTwoSpeedDXCoilStandardRating</span>
<a name="ln-526"></a>
<a name="ln-527"></a>          <span class="c">! External function calls</span>
<a name="ln-528"></a><span class="k">PUBLIC  </span><span class="n">GetDXCoilIndex</span>
<a name="ln-529"></a><span class="k">PUBLIC  </span><span class="n">GetCoilCapacity</span>
<a name="ln-530"></a><span class="k">PUBLIC  </span><span class="n">GetCoilCapacityByIndexType</span>
<a name="ln-531"></a><span class="k">PUBLIC  </span><span class="n">GetCoilTypeNum</span>
<a name="ln-532"></a><span class="k">PUBLIC  </span><span class="n">GetMinOATCompressor</span>
<a name="ln-533"></a><span class="k">PUBLIC  </span><span class="n">GetCoilInletNode</span>
<a name="ln-534"></a><span class="k">PUBLIC  </span><span class="n">GetCoilOutletNode</span>
<a name="ln-535"></a><span class="k">PUBLIC  </span><span class="n">GetCoilCondenserInletNode</span>
<a name="ln-536"></a><span class="k">PUBLIC  </span><span class="n">GetDXCoilBypassedFlowFrac</span>
<a name="ln-537"></a><span class="k">PUBLIC  </span><span class="n">GetDXCoilAvailSchPtr</span>
<a name="ln-538"></a><span class="k">PRIVATE </span><span class="n">GetHPCoolingCoilIndex</span>
<a name="ln-539"></a><span class="k">PUBLIC  </span><span class="n">GetDXCoilNumberOfSpeeds</span>
<a name="ln-540"></a><span class="k">PUBLIC  </span><span class="n">SetDXCoolingCoilData</span>
<a name="ln-541"></a><span class="k">PUBLIC  </span><span class="n">SetCoilSystemHeatingDXFlag</span>
<a name="ln-542"></a><span class="k">PRIVATE </span><span class="n">GetFanIndexForTwoSpeedCoil</span>
<a name="ln-543"></a><span class="k">PUBLIC  </span><span class="n">SetCoilSystemCoolingData</span>
<a name="ln-544"></a><span class="k">PUBLIC  </span><span class="n">SetDXCoilTypeData</span>
<a name="ln-545"></a><span class="k">PUBLIC  </span><span class="n">GetDXCoilAirFlow</span>
<a name="ln-546"></a><span class="k">PUBLIC  </span><span class="n">GetDXCoilCapFTCurveIndex</span>
<a name="ln-547"></a>
<a name="ln-548"></a><span class="k">CONTAINS</span>
<a name="ln-549"></a>
<a name="ln-550"></a><span class="k">SUBROUTINE </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">OnOffAFR</span><span class="p">,</span> <span class="n">CoilCoolingHeatingPLRRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-551"></a>                     <span class="n">MaxCap</span><span class="p">,</span> <span class="n">CompCyclingRatio</span><span class="p">)</span>
<a name="ln-552"></a>
<a name="ln-553"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-554"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-555"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-556"></a>          <span class="c">!       MODIFIED       Don Shirey, Sept 2000, October 2001, June 2005</span>
<a name="ln-557"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-558"></a>
<a name="ln-559"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-560"></a>          <span class="c">! Manages the simulation of a single speed on/off DX coil.</span>
<a name="ln-561"></a>
<a name="ln-562"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-563"></a>          <span class="c">! NA</span>
<a name="ln-564"></a>
<a name="ln-565"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-566"></a>          <span class="c">! na</span>
<a name="ln-567"></a>
<a name="ln-568"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-569"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-570"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-571"></a>
<a name="ln-572"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-573"></a>
<a name="ln-574"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-575"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! name of the fan coil unit</span>
<a name="ln-576"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompOp</span>              <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-577"></a>  <span class="kt">LOGICAL</span>         <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-578"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! part load ratio (for single speed cycling unit)</span>
<a name="ln-579"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-580"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FanOpMode</span>  <span class="c">! allows parent object to control fan mode</span>
<a name="ln-581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OnOffAFR</span>   <span class="c">! ratio of compressor on airflow to compressor off airflow</span>
<a name="ln-582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CoilCoolingHeatingPLRRatio</span> <span class="c">! used for cycling fan RH control</span>
<a name="ln-583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MaxCap</span> <span class="c">! maximum cooling capacity of VRF terminal units</span>
<a name="ln-584"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CompCyclingRatio</span> <span class="c">! cycling ratio of VRF condenser connected to this TU</span>
<a name="ln-585"></a>
<a name="ln-586"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-587"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-588"></a>
<a name="ln-589"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-590"></a>          <span class="c">! na</span>
<a name="ln-591"></a>
<a name="ln-592"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-593"></a>          <span class="c">! na</span>
<a name="ln-594"></a>
<a name="ln-595"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-596"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DXCoilNum</span>        <span class="c">! index of fan coil unit being simulated</span>
<a name="ln-597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRatio</span>        <span class="c">! ratio of compressor on airflow to compressor off airflow</span>
<a name="ln-598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompCycRatio</span>        <span class="c">! compressor cycling ratio of VRF condenser</span>
<a name="ln-599"></a>
<a name="ln-600"></a>          <span class="c">! FLOW</span>
<a name="ln-601"></a>
<a name="ln-602"></a><span class="c">! First time SimDXCoil is called, get the input for all the DX coils (condensing units)</span>
<a name="ln-603"></a><span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-604"></a><span class="k">  CALL </span><span class="n">GetDXCoils</span>
<a name="ln-605"></a>  <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set GetInputFlag false so you don&#39;t get coil inputs again</span>
<a name="ln-606"></a><span class="k">END IF</span>
<a name="ln-607"></a>
<a name="ln-608"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-609"></a><span class="k">  </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-610"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-611"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-612"></a>  <span class="n">ENDIF</span>
<a name="ln-613"></a>  <span class="n">CompIndex</span><span class="o">=</span><span class="n">DXCoilNum</span>
<a name="ln-614"></a><span class="k">ELSE</span>
<a name="ln-615"></a><span class="k">  </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-616"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">&gt;</span> <span class="n">NumDXCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DXCoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-617"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoil: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-618"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-619"></a>                        <span class="s1">&#39;, Number of DX Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-620"></a>                        <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-621"></a>  <span class="n">ENDIF</span>
<a name="ln-622"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-623"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompName</span> <span class="o">/=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-624"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoil: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-625"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-626"></a>                          <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-627"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-628"></a>    <span class="n">ENDIF</span>
<a name="ln-629"></a>    <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-630"></a>  <span class="n">ENDIF</span>
<a name="ln-631"></a><span class="n">ENDIF</span>
<a name="ln-632"></a>
<a name="ln-633"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">OnOffAFR</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-634"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAFR</span>
<a name="ln-635"></a><span class="k">ELSE</span>
<a name="ln-636"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-637"></a><span class="k">END IF</span>
<a name="ln-638"></a>
<a name="ln-639"></a><span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompCyclingRatio</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-640"></a><span class="k">  </span><span class="n">CompCycRatio</span> <span class="o">=</span> <span class="n">CompCyclingRatio</span>
<a name="ln-641"></a><span class="k">ELSE</span>
<a name="ln-642"></a><span class="k">  </span><span class="n">CompCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-643"></a><span class="k">END IF</span>
<a name="ln-644"></a>
<a name="ln-645"></a><span class="n">CurDXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span>
<a name="ln-646"></a>
<a name="ln-647"></a><span class="c">! Initialize the DX coil unit</span>
<a name="ln-648"></a><span class="k">CALL </span><span class="n">InitDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-649"></a>
<a name="ln-650"></a><span class="c">! Select the correct unit type</span>
<a name="ln-651"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span><span class="c">!Objexx:OPTIONAL PartLoadRatio, MaxCap used in this block without PRESENT check</span>
<a name="ln-652"></a>
<a name="ln-653"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span>
<a name="ln-654"></a>
<a name="ln-655"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoilCoolingHeatingPLRRatio</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-656"></a><span class="k">      CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-657"></a>                          <span class="n">OnOffAirFlowRatio</span><span class="o">=</span><span class="n">AirFlowRatio</span><span class="p">,</span> <span class="n">CoolingHeatingPLR</span><span class="o">=</span><span class="n">CoilCoolingHeatingPLRRatio</span><span class="p">)</span>
<a name="ln-658"></a>    <span class="k">ELSE</span>
<a name="ln-659"></a><span class="k">      CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="o">=</span><span class="n">AirFlowRatio</span><span class="p">)</span>
<a name="ln-660"></a>    <span class="k">END IF</span>
<a name="ln-661"></a>
<a name="ln-662"></a><span class="k">  CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span>
<a name="ln-663"></a>
<a name="ln-664"></a>    <span class="k">CALL </span><span class="n">CalcDXHeatingCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="o">=</span><span class="n">AirFlowRatio</span><span class="p">)</span>
<a name="ln-665"></a>
<a name="ln-666"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span>
<a name="ln-667"></a>
<a name="ln-668"></a><span class="c">!   call the HPWHDXCoil routine to calculate water side performance set up the DX coil info for air-side calcs</span>
<a name="ln-669"></a>    <span class="k">CALL </span><span class="n">CalcHPWHDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-670"></a><span class="c">!    CALL CalcDOE2DXCoil(DXCoilNum, CompOp, FirstHVACIteration,PartLoadRatio), perform air-side calculations</span>
<a name="ln-671"></a>    <span class="k">CALL </span><span class="n">CalcDOE2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-672"></a>
<a name="ln-673"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilVRF_Cooling</span><span class="p">)</span>
<a name="ln-674"></a>
<a name="ln-675"></a>    <span class="k">CALL </span><span class="n">CalcVRFCoolingCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">CompCycRatio</span><span class="p">,</span> <span class="n">MaxCoolCap</span><span class="o">=</span><span class="n">MaxCap</span><span class="p">)</span>
<a name="ln-676"></a>
<a name="ln-677"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilVRF_Heating</span><span class="p">)</span>
<a name="ln-678"></a>
<a name="ln-679"></a>    <span class="k">CALL </span><span class="n">CalcDXHeatingCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">MaxHeatCap</span><span class="o">=</span><span class="n">MaxCap</span><span class="p">)</span>
<a name="ln-680"></a>
<a name="ln-681"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-682"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Error detected in DX Coil=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-683"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid DX Coil Type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">))</span>
<a name="ln-684"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-685"></a>
<a name="ln-686"></a>
<a name="ln-687"></a><span class="k">END SELECT</span>
<a name="ln-688"></a>
<a name="ln-689"></a><span class="c">! Update the unit outlet nodes</span>
<a name="ln-690"></a><span class="k">CALL </span><span class="n">UpdateDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-691"></a>
<a name="ln-692"></a><span class="c">! Report the result of the simulation</span>
<a name="ln-693"></a><span class="k">CALL </span><span class="n">ReportDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-694"></a>
<a name="ln-695"></a>
<a name="ln-696"></a><span class="k">RETURN</span>
<a name="ln-697"></a><span class="k">END SUBROUTINE </span><span class="n">SimDXCoil</span>
<a name="ln-698"></a>
<a name="ln-699"></a><span class="k">SUBROUTINE </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-700"></a>
<a name="ln-701"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-702"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-703"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-704"></a>          <span class="c">!       MODIFIED       Lixing Gu, Sep. 2007</span>
<a name="ln-705"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-706"></a>
<a name="ln-707"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-708"></a>          <span class="c">! Manages the simulation of a multi speed DX coil.</span>
<a name="ln-709"></a>
<a name="ln-710"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-711"></a>          <span class="c">! NA</span>
<a name="ln-712"></a>
<a name="ln-713"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-714"></a>          <span class="c">! na</span>
<a name="ln-715"></a>
<a name="ln-716"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-717"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-718"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-719"></a>
<a name="ln-720"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-721"></a>
<a name="ln-722"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-723"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! name of the fan coil unit</span>
<a name="ln-724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>          <span class="c">! = (CompressorSpeed - CompressorSpeedMin) /</span>
<a name="ln-725"></a>                                                       <span class="c">!   (CompressorSpeedMax - CompressorSpeedMin)</span>
<a name="ln-726"></a>                                                       <span class="c">! for variable speed or 2 speed compressors</span>
<a name="ln-727"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>            <span class="c">! cycling part load ratio for variable speed</span>
<a name="ln-728"></a>                                                       <span class="c">! or 2 speed compressors</span>
<a name="ln-729"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-730"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SpeedNum</span>            <span class="c">! Speed number for multispeed cooling coil onlyn</span>
<a name="ln-731"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Fan operation mode</span>
<a name="ln-732"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CompOp</span>              <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-733"></a>
<a name="ln-734"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-735"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-736"></a>
<a name="ln-737"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-738"></a>          <span class="c">! na</span>
<a name="ln-739"></a>
<a name="ln-740"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-741"></a>          <span class="c">! na</span>
<a name="ln-742"></a>
<a name="ln-743"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-744"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DXCoilNum</span>              <span class="c">! index of fan coil unit being simulated</span>
<a name="ln-745"></a>
<a name="ln-746"></a>          <span class="c">! FLOW</span>
<a name="ln-747"></a>
<a name="ln-748"></a><span class="c">! First time SimDXCoil is called, get the input for all the DX coils (condensing units)</span>
<a name="ln-749"></a><span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-750"></a><span class="k">  CALL </span><span class="n">GetDXCoils</span>
<a name="ln-751"></a>  <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set GetInputFlag false so you don&#39;t get coil inputs again</span>
<a name="ln-752"></a><span class="k">END IF</span>
<a name="ln-753"></a>
<a name="ln-754"></a><span class="c">!  find correct DX Coil</span>
<a name="ln-755"></a>
<a name="ln-756"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-757"></a><span class="k">  </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-758"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-759"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-760"></a>  <span class="n">ENDIF</span>
<a name="ln-761"></a>  <span class="n">CompIndex</span><span class="o">=</span><span class="n">DXCoilNum</span>
<a name="ln-762"></a><span class="k">ELSE</span>
<a name="ln-763"></a><span class="k">  </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-764"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">&gt;</span> <span class="n">NumDXCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DXCoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-765"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoilMultiSpeed: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-766"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-767"></a>                        <span class="s1">&#39;, Number of DX Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-768"></a>                        <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-769"></a>  <span class="n">ENDIF</span>
<a name="ln-770"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-771"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompName</span> <span class="o">/=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-772"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoilMultiSpeed: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-773"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-774"></a>                          <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-775"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-776"></a>    <span class="n">ENDIF</span>
<a name="ln-777"></a>    <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-778"></a>  <span class="n">ENDIF</span>
<a name="ln-779"></a><span class="n">ENDIF</span>
<a name="ln-780"></a>
<a name="ln-781"></a><span class="n">CurDXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span>
<a name="ln-782"></a>
<a name="ln-783"></a><span class="c">! Initialize the DX coil unit</span>
<a name="ln-784"></a><span class="k">CALL </span><span class="n">InitDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-785"></a>
<a name="ln-786"></a><span class="c">! Select the correct unit type</span>
<a name="ln-787"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-788"></a>
<a name="ln-789"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-790"></a>
<a name="ln-791"></a>    <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">)</span>
<a name="ln-792"></a>
<a name="ln-793"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-794"></a>    <span class="k">If</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">))</span> <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilCooling</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span> <span class="c">!Objexx:OPTIONAL FanOpMode, CompOp used without PRESENT check</span>
<a name="ln-795"></a>
<a name="ln-796"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-797"></a>    <span class="k">If</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">))</span> <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilHeating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span> <span class="c">!Objexx:OPTIONAL FanOpMode used without PRESENT check</span>
<a name="ln-798"></a>
<a name="ln-799"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-800"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Error detected in DX Coil=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-801"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid DX Coil Type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">))</span>
<a name="ln-802"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-803"></a>
<a name="ln-804"></a>
<a name="ln-805"></a><span class="k">END SELECT</span>
<a name="ln-806"></a>
<a name="ln-807"></a><span class="c">! Update the unit outlet nodes</span>
<a name="ln-808"></a><span class="k">CALL </span><span class="n">UpdateDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-809"></a>
<a name="ln-810"></a><span class="c">! Report the result of the simulation</span>
<a name="ln-811"></a><span class="k">CALL </span><span class="n">ReportDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-812"></a>
<a name="ln-813"></a>
<a name="ln-814"></a><span class="k">RETURN</span>
<a name="ln-815"></a>
<a name="ln-816"></a><span class="k">END SUBROUTINE </span><span class="n">SimDXCoilMultiSpeed</span>
<a name="ln-817"></a>
<a name="ln-818"></a><span class="k">SUBROUTINE </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-819"></a>
<a name="ln-820"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-821"></a>          <span class="c">!       AUTHOR         M. J. Witte (based on SimDXCoilMultiSpeed by Fred Buhl)</span>
<a name="ln-822"></a>          <span class="c">!       DATE WRITTEN   February 2005</span>
<a name="ln-823"></a>          <span class="c">!       MODIFIED       April 2010, Chandan sharma, added basin heater</span>
<a name="ln-824"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-825"></a>
<a name="ln-826"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-827"></a>          <span class="c">! Manages the simulation of a DX coil with multiple performance modes, such as</span>
<a name="ln-828"></a>          <span class="c">! multiple stages, or sub-cool reheat for humidity control.</span>
<a name="ln-829"></a>
<a name="ln-830"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-831"></a>          <span class="c">! NA</span>
<a name="ln-832"></a>
<a name="ln-833"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-834"></a>          <span class="c">! na</span>
<a name="ln-835"></a>
<a name="ln-836"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-837"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-838"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-839"></a>
<a name="ln-840"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-841"></a>
<a name="ln-842"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-843"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! name of the fan coil unit</span>
<a name="ln-844"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>              <span class="c">! compressor operation; 1=on, 0=off !unused1208</span>
<a name="ln-845"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>          <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! true if first hvac iteration</span>
<a name="ln-846"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>        <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! part load ratio</span>
<a name="ln-847"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DehumidMode</span>         <span class="c">! dehumidification mode (0=normal, 1=enhanced)</span>
<a name="ln-848"></a>  <span class="kt">INTEGER</span><span class="p">,</span>        <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-849"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! allows parent object to control fan mode</span>
<a name="ln-850"></a>
<a name="ln-851"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-852"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SimDXCoilMultiMode&#39;</span>
<a name="ln-853"></a>
<a name="ln-854"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-855"></a>          <span class="c">! na</span>
<a name="ln-856"></a>
<a name="ln-857"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-858"></a>          <span class="c">! na</span>
<a name="ln-859"></a>
<a name="ln-860"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-861"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>                 <span class="c">! index of coil being simulated</span>
<a name="ln-862"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PerfMode</span>                  <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-863"></a>                                       <span class="c">! 1-2=normal mode: 1=stage 1 only, 2=stage 1&amp;2</span>
<a name="ln-864"></a>                                       <span class="c">! 3-4=enhanced dehumidification mode: 3=stage 1 only, 4=stage 1&amp;2</span>
<a name="ln-865"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>               <span class="c">! Dry air mass flow rate through coil [kg/s]</span>
<a name="ln-866"></a>
<a name="ln-867"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1OutletAirTemp</span>           <span class="c">! Stage 1   Outlet air dry bulb temp [C]</span>
<a name="ln-868"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1OutletAirHumRat</span>         <span class="c">! Stage 1   Outlet air humidity ratio [kgWater/kgDryAir]</span>
<a name="ln-869"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1OutletAirEnthalpy</span>       <span class="c">! Stage 1   Outlet air enthalpy</span>
<a name="ln-870"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1PLR</span>                     <span class="c">! Stage 1   Ratio of actual sensible cooling load to</span>
<a name="ln-871"></a>                                         <span class="c">!           steady-state sensible cooling capacity</span>
<a name="ln-872"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1TotalCoolingEnergyRate</span>  <span class="c">! Stage 1   Total cooling rate [W]</span>
<a name="ln-873"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1SensCoolingEnergyRate</span>   <span class="c">! Stage 1   Sensible cooling rate [W]</span>
<a name="ln-874"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1LatCoolingEnergyRate</span>    <span class="c">! Stage 1   Latent cooling rate [W]</span>
<a name="ln-875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1ElecCoolingPower</span>        <span class="c">! Stage 1   Electric power input [W]</span>
<a name="ln-876"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1RuntimeFraction</span> <span class="o">=</span><span class="mf">0.0d0</span>    <span class="c">! Stage 1   Run time fraction (overlaps with stage1&amp;2 run time)</span>
<a name="ln-877"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1EvapCondPumpElecPower</span>   <span class="c">! Stage 1   Evaporative condenser pump electric power input [W]</span>
<a name="ln-878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1EvapWaterConsumpRate</span>    <span class="c">! Stage 1   Evap condenser water consumption rate [m3/s]</span>
<a name="ln-879"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1CrankcaseHeaterPower</span>    <span class="c">! Stage 1   Report variable for average crankcase heater power [W]</span>
<a name="ln-880"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1FFullLoadOutAirTemp</span>     <span class="c">! Stage 1   Full load outlet temperature [C]</span>
<a name="ln-881"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S1FullLoadOutAirHumRat</span>    <span class="c">! Stage 1   Full load outlet humidity ratio [kgWater/kgDryAir]</span>
<a name="ln-882"></a>
<a name="ln-883"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12OutletAirTemp</span>          <span class="c">! Stage 1&amp;2 Outlet air dry bulb temp [C]</span>
<a name="ln-884"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12OutletAirHumRat</span>        <span class="c">! Stage 1&amp;2 Outlet air humidity ratio [kgWater/kgDryAir]</span>
<a name="ln-885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12OutletAirEnthalpy</span>      <span class="c">! Stage 1&amp;2 Outlet air enthalpy</span>
<a name="ln-886"></a><span class="c">!  REAL(r64) :: S12PLR                  ! Stage 1&amp;2 Ratio of actual sensible cooling load to</span>
<a name="ln-887"></a><span class="c">!                                       !           steady-state sensible cooling capacity</span>
<a name="ln-888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12TotalCoolingEnergyRate</span> <span class="c">! Stage 1&amp;2 Total cooling rate [W]</span>
<a name="ln-889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12SensCoolingEnergyRate</span>  <span class="c">! Stage 1&amp;2 Sensible cooling rate [W]</span>
<a name="ln-890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12LatCoolingEnergyRate</span>   <span class="c">! Stage 1&amp;2 Latent cooling rate [W]</span>
<a name="ln-891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12ElecCoolingPower</span>       <span class="c">! Stage 1&amp;2 Electric power input [W]</span>
<a name="ln-892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12ElecCoolFullLoadPower</span>  <span class="c">! Stage 1&amp;2 Electric power input at full load (PLR=1) [W]</span>
<a name="ln-893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12RuntimeFraction</span> <span class="o">=</span><span class="mf">0.0d0</span>   <span class="c">! Stage 1&amp;2 Run time fraction (overlaps with stage1 run time)</span>
<a name="ln-894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12EvapCondPumpElecPower</span>  <span class="c">! Stage 1&amp;2 Evaporative condenser pump electric power input [W]</span>
<a name="ln-895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12EvapWaterConsumpRate</span>   <span class="c">! Stage 1&amp;2 Evap condenser water consumption rate [m3/s]</span>
<a name="ln-896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S12CrankcaseHeaterPower</span>   <span class="c">! Stage 1&amp;2 Report variable for average crankcase heater power [W]</span>
<a name="ln-897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S2PLR</span>                     <span class="c">! Stage 2   Ratio of actual sensible cooling load to</span>
<a name="ln-898"></a>                                         <span class="c">!           steady-state sensible cooling capacity</span>
<a name="ln-899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! minimum of the inlet air humidity ratio and the outlet air humidity ratio</span>
<a name="ln-900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TSat</span>                      <span class="c">! calculation to avoid calling psych routines twice</span>
<a name="ln-901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NodePress</span>                 <span class="c">! Pressure at condenser inlet node (Pa)</span>
<a name="ln-902"></a>          <span class="c">! FLOW</span>
<a name="ln-903"></a>
<a name="ln-904"></a><span class="c">! First time SimDXCoil is called, get the input for all the DX coils (condensing units)</span>
<a name="ln-905"></a><span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-906"></a><span class="k">  CALL </span><span class="n">GetDXCoils</span>
<a name="ln-907"></a>  <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set GetInputFlag false so you don&#39;t get coil inputs again</span>
<a name="ln-908"></a><span class="k">END IF</span>
<a name="ln-909"></a>
<a name="ln-910"></a><span class="c">!  find correct DX Coil</span>
<a name="ln-911"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-912"></a><span class="k">  </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-913"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-914"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-915"></a>  <span class="n">ENDIF</span>
<a name="ln-916"></a>  <span class="n">CompIndex</span><span class="o">=</span><span class="n">DXCoilNum</span>
<a name="ln-917"></a><span class="k">ELSE</span>
<a name="ln-918"></a><span class="k">  </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-919"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">&gt;</span> <span class="n">NumDXCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DXCoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-920"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoilMultiMode: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-921"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-922"></a>                        <span class="s1">&#39;, Number of DX Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-923"></a>                        <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-924"></a>  <span class="n">ENDIF</span>
<a name="ln-925"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-926"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">CompName</span> <span class="o">/=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-927"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoilMultiMode: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-928"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-929"></a>                          <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-930"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-931"></a>    <span class="n">ENDIF</span>
<a name="ln-932"></a>    <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-933"></a>  <span class="n">ENDIF</span>
<a name="ln-934"></a><span class="n">ENDIF</span>
<a name="ln-935"></a>
<a name="ln-936"></a><span class="n">CurDXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span>
<a name="ln-937"></a>
<a name="ln-938"></a><span class="c">! Initialize the DX coil unit</span>
<a name="ln-939"></a><span class="k">CALL </span><span class="n">InitDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-940"></a>
<a name="ln-941"></a><span class="c">! Select the correct unit type</span>
<a name="ln-942"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-943"></a>
<a name="ln-944"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span>
<a name="ln-945"></a>
<a name="ln-946"></a>    <span class="c">! Initialize local variables</span>
<a name="ln-947"></a>    <span class="n">S1RuntimeFraction</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-948"></a>    <span class="n">S1OutletAirEnthalpy</span>          <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-949"></a>    <span class="n">S1OutletAirHumRat</span>            <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-950"></a>    <span class="n">S1OutletAirTemp</span>              <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-951"></a>    <span class="n">S1ElecCoolingPower</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-952"></a>    <span class="n">S1TotalCoolingEnergyRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-953"></a>    <span class="n">S1SensCoolingEnergyRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-954"></a>    <span class="n">S1LatCoolingEnergyRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-955"></a>    <span class="n">S1CrankcaseHeaterPower</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-956"></a>    <span class="n">S1EvapWaterConsumpRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-957"></a>    <span class="n">S1EvapCondPumpElecPower</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-958"></a>
<a name="ln-959"></a>    <span class="n">S12RuntimeFraction</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-960"></a>    <span class="n">S12OutletAirEnthalpy</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-961"></a>    <span class="n">S12OutletAirHumRat</span>           <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-962"></a>    <span class="n">S12OutletAirTemp</span>             <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-963"></a>    <span class="n">S12ElecCoolingPower</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-964"></a>    <span class="n">S12TotalCoolingEnergyRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-965"></a>    <span class="n">S12SensCoolingEnergyRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-966"></a>    <span class="n">S12LatCoolingEnergyRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-967"></a>    <span class="n">S12CrankcaseHeaterPower</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-968"></a>    <span class="n">S12EvapWaterConsumpRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-969"></a>    <span class="n">S12EvapCondPumpElecPower</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-970"></a>
<a name="ln-971"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DehumidificationMode</span> <span class="o">=</span> <span class="n">DehumidMode</span>
<a name="ln-972"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DehumidMode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-973"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-974"></a>        <span class="s1">&#39;&quot; - Requested enhanced dehumidification mode not available.&#39;</span><span class="p">)</span>
<a name="ln-975"></a>    <span class="k">END IF</span>
<a name="ln-976"></a>
<a name="ln-977"></a>    <span class="c">! If a single-stage coil OR If part load is zero,</span>
<a name="ln-978"></a>    <span class="c">! run stage 1 at zero part load to set leaving conditions</span>
<a name="ln-979"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-980"></a>      <span class="c">! Run stage 1 at its part load</span>
<a name="ln-981"></a>      <span class="n">PerfMode</span> <span class="o">=</span> <span class="n">DehumidMode</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-982"></a>      <span class="k">CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PerfMode</span><span class="p">)</span>
<a name="ln-983"></a>      <span class="n">S1PLR</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-984"></a>      <span class="n">S2PLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-985"></a>    <span class="k">ELSE</span>
<a name="ln-986"></a>      <span class="c">! If a two-stage coil</span>
<a name="ln-987"></a>      <span class="c">! Run stage 1 at full load</span>
<a name="ln-988"></a>      <span class="n">PerfMode</span> <span class="o">=</span> <span class="n">DehumidMode</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-989"></a>      <span class="k">CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span><span class="n">PerfMode</span><span class="p">)</span>
<a name="ln-990"></a>      <span class="n">S1SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-991"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">S1SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-992"></a><span class="k">        </span><span class="n">S1PLR</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-993"></a>      <span class="k">ELSE</span>
<a name="ln-994"></a><span class="k">        </span><span class="n">S1PLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-995"></a>      <span class="k">END IF</span>
<a name="ln-996"></a>      <span class="c">! Run stage 1+2 at full load</span>
<a name="ln-997"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-998"></a><span class="k">        </span><span class="n">PerfMode</span> <span class="o">=</span> <span class="n">DehumidMode</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-999"></a>        <span class="k">CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PerfMode</span><span class="p">)</span>
<a name="ln-1000"></a>        <span class="n">S12SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-1001"></a>        <span class="n">S12ElecCoolFullLoadPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-1002"></a>      <span class="k">END IF</span>
<a name="ln-1003"></a>
<a name="ln-1004"></a>      <span class="c">! Determine run-time fractions for each stage based on sensible capacities</span>
<a name="ln-1005"></a>      <span class="c">!   Relationships:</span>
<a name="ln-1006"></a>      <span class="c">!     Stage 1   PLR1=   Load/Cap1</span>
<a name="ln-1007"></a>      <span class="c">!     Stage1+2  PLR12=  Load/Cap12</span>
<a name="ln-1008"></a>      <span class="c">!     Stage 2   PLR2=   (Load-Cap1)/(Cap2)</span>
<a name="ln-1009"></a>      <span class="c">!     PLR = Load/(Cap1+Cap2)</span>
<a name="ln-1010"></a>      <span class="c">!     Load= PLR*(Cap1+Cap2)</span>
<a name="ln-1011"></a>      <span class="c">!     PLR1= Min(1,(PLR*(Cap1+Cap2)/Cap1))</span>
<a name="ln-1012"></a>      <span class="c">!     PLR2= Min(1,((PLR*(Cap1+Cap2)-Cap1)/Cap2))</span>
<a name="ln-1013"></a>
<a name="ln-1014"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">S1SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1015"></a><span class="k">        </span><span class="n">S1PLR</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">S12SensCoolingEnergyRate</span><span class="o">/</span><span class="n">S1SensCoolingEnergyRate</span>
<a name="ln-1016"></a>      <span class="k">ELSE</span>
<a name="ln-1017"></a><span class="k">        </span><span class="n">S1PLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1018"></a>      <span class="k">END IF</span>
<a name="ln-1019"></a><span class="k">      </span><span class="n">S1PLR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">S1PLR</span><span class="p">)</span>
<a name="ln-1020"></a>      <span class="n">S1PLR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">S1PLR</span><span class="p">)</span>
<a name="ln-1021"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">S12SensCoolingEnergyRate</span><span class="o">-</span><span class="n">S1SensCoolingEnergyRate</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1022"></a><span class="k">        </span><span class="n">S2PLR</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">S12SensCoolingEnergyRate</span><span class="o">-</span><span class="n">S1SensCoolingEnergyRate</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1023"></a>                <span class="p">(</span><span class="n">S12SensCoolingEnergyRate</span><span class="o">-</span><span class="n">S1SensCoolingEnergyRate</span><span class="p">)</span>
<a name="ln-1024"></a>      <span class="k">ELSE</span>
<a name="ln-1025"></a><span class="k">        </span><span class="n">S2PLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1026"></a>      <span class="k">END IF</span>
<a name="ln-1027"></a><span class="k">      </span><span class="n">S2PLR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">S2PLR</span><span class="p">)</span>
<a name="ln-1028"></a>      <span class="n">S2PLR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">S2PLR</span><span class="p">)</span>
<a name="ln-1029"></a>
<a name="ln-1030"></a>      <span class="c">! Run stage 1 at its part load</span>
<a name="ln-1031"></a>      <span class="n">PerfMode</span> <span class="o">=</span> <span class="n">DehumidMode</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1032"></a>      <span class="k">CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">S1PLR</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PerfMode</span><span class="p">)</span>
<a name="ln-1033"></a>    <span class="n">ENDIF</span>
<a name="ln-1034"></a>    <span class="c">! For stage-1 only operation, all outputs are set by CalcDoe2DXCoil.</span>
<a name="ln-1035"></a>    <span class="c">! No further adjustments are necessary.</span>
<a name="ln-1036"></a>
<a name="ln-1037"></a>    <span class="c">! Run stage 2 if needed and available</span>
<a name="ln-1038"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">S2PLR</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1039"></a>      <span class="c">! Store stage 1 outputs</span>
<a name="ln-1040"></a>      <span class="n">S1RuntimeFraction</span>            <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-1041"></a>      <span class="n">S1OutletAirEnthalpy</span>          <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-1042"></a>      <span class="n">S1OutletAirHumRat</span>            <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-1043"></a>      <span class="n">S1OutletAirTemp</span>              <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-1044"></a>      <span class="n">S1ElecCoolingPower</span>           <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-1045"></a>      <span class="n">S1TotalCoolingEnergyRate</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-1046"></a>      <span class="n">S1SensCoolingEnergyRate</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-1047"></a>      <span class="n">S1LatCoolingEnergyRate</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span>
<a name="ln-1048"></a>      <span class="n">S1CrankcaseHeaterPower</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span>
<a name="ln-1049"></a>      <span class="n">S1EvapWaterConsumpRate</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-1050"></a>      <span class="n">S1EvapCondPumpElecPower</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span>
<a name="ln-1051"></a>
<a name="ln-1052"></a>      <span class="c">! Save first stage full load outlet conditions to pass to heat recovery</span>
<a name="ln-1053"></a>      <span class="n">S1FFullLoadOutAirTemp</span>        <span class="o">=</span> <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-1054"></a>      <span class="n">S1FullLoadOutAirHumRat</span>       <span class="o">=</span> <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a>      <span class="c">! Run stage 1+2 at its part load</span>
<a name="ln-1057"></a>      <span class="n">PerfMode</span> <span class="o">=</span> <span class="n">DehumidMode</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-1058"></a>      <span class="k">CALL </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">S2PLR</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PerfMode</span><span class="p">)</span>
<a name="ln-1059"></a>      <span class="n">S12RuntimeFraction</span>            <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-1060"></a>      <span class="n">S12OutletAirEnthalpy</span>          <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-1061"></a>      <span class="n">S12OutletAirHumRat</span>            <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-1062"></a>      <span class="n">S12OutletAirTemp</span>              <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-1063"></a>      <span class="n">S12ElecCoolingPower</span>           <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-1064"></a>      <span class="n">S12TotalCoolingEnergyRate</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-1065"></a>      <span class="n">S12SensCoolingEnergyRate</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-1066"></a>      <span class="n">S12LatCoolingEnergyRate</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span>
<a name="ln-1067"></a>      <span class="n">S12CrankcaseHeaterPower</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span>
<a name="ln-1068"></a>      <span class="n">S12EvapWaterConsumpRate</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-1069"></a>      <span class="n">S12EvapCondPumpElecPower</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>      <span class="c">! Determine combined performance</span>
<a name="ln-1072"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">S12RuntimeFraction</span><span class="p">)</span><span class="o">*</span><span class="n">S1OutletAirEnthalpy</span> <span class="p">&amp;</span>
<a name="ln-1073"></a>                                             <span class="o">+</span><span class="n">S12RuntimeFraction</span><span class="o">*</span><span class="n">S12OutletAirEnthalpy</span>
<a name="ln-1074"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">S12RuntimeFraction</span><span class="p">)</span><span class="o">*</span><span class="n">S1OutletAirHumRat</span> <span class="p">&amp;</span>
<a name="ln-1075"></a>                                            <span class="o">+</span><span class="n">S12RuntimeFraction</span><span class="o">*</span><span class="n">S12OutletAirHumRat</span>
<a name="ln-1076"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1077"></a>         <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-1078"></a>      <span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-1079"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">PerfMode</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1080"></a><span class="k">        </span><span class="n">NodePress</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">PerfMode</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-1081"></a>        <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-1082"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NodePress</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="n">NodePress</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-1083"></a>        <span class="n">TSat</span><span class="o">=</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">NodePress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-1084"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TSat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1085"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">TSat</span>
<a name="ln-1086"></a>        <span class="n">ENDIF</span>
<a name="ln-1087"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1088"></a>           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-1089"></a>      <span class="k">ELSE</span>
<a name="ln-1090"></a><span class="k">        </span><span class="n">TSat</span><span class="o">=</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-1091"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TSat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1092"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">TSat</span>
<a name="ln-1093"></a>        <span class="n">ENDIF</span>
<a name="ln-1094"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-1095"></a><span class="c">!      IF(DXCoil(DXCoilNum)%OutletAirTemp .LT. PsyTsatFnHPb(DXCoil(DXCoilNum)%OutletAirEnthalpy, &amp;</span>
<a name="ln-1096"></a><span class="c">!                 Node(DXCoil(DXCoilNum)%AirInNode)%Press)) THEN</span>
<a name="ln-1097"></a><span class="c">!        DXCoil(DXCoilNum)%OutletAirTemp = PsyTsatFnHPb(DXCoil(DXCoilNum)%OutletAirEnthalpy, &amp;</span>
<a name="ln-1098"></a><span class="c">!                 Node(DXCoil(DXCoilNum)%AirInNode)%Press)</span>
<a name="ln-1099"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1100"></a>           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-1101"></a>      <span class="k">END IF</span>
<a name="ln-1102"></a>
<a name="ln-1103"></a><span class="c">!      DXCoil(DXCoilNum)%ElecCoolingPower = (1-S12RuntimeFraction)*S1ElecCoolingPower &amp;</span>
<a name="ln-1104"></a><span class="c">!                                             +S12RuntimeFraction*S12ElecCoolingPower</span>
<a name="ln-1105"></a>      <span class="c">!  S12ElecCoolingPower overstates S1 portion of power, because it is also adjust by S12PLR</span>
<a name="ln-1106"></a>      <span class="c">!  So, must make an adjustment for S12ElecCoolingPower/S12ElecCoolFullLoadPower</span>
<a name="ln-1107"></a>      <span class="c">!  when subtracting off S1ElecCoolingPower</span>
<a name="ln-1108"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">S12ElecCoolFullLoadPower</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1109"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">S1RuntimeFraction</span><span class="o">*</span><span class="n">S1ElecCoolingPower</span> <span class="p">&amp;</span>
<a name="ln-1110"></a>         <span class="o">+</span><span class="n">S12RuntimeFraction</span><span class="o">*</span><span class="p">(</span><span class="n">S12ElecCoolingPower</span><span class="o">-</span><span class="n">S1ElecCoolingPower</span><span class="o">*</span><span class="n">S12ElecCoolingPower</span><span class="o">/</span><span class="n">S12ElecCoolFullLoadPower</span><span class="p">)</span>
<a name="ln-1111"></a>      <span class="k">ELSE</span>
<a name="ln-1112"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1113"></a>      <span class="k">END IF</span>
<a name="ln-1114"></a>
<a name="ln-1115"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="n">S1RuntimeFraction</span>
<a name="ln-1116"></a>
<a name="ln-1117"></a>      <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-1118"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1119"></a>                                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-1120"></a>      <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-1121"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1122"></a>              <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1123"></a>               <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span>
<a name="ln-1124"></a>      <span class="c">!  Don&#39;t let sensible capacity be greater than total capacity</span>
<a name="ln-1125"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1126"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-1127"></a>      <span class="k">END IF</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-1130"></a>
<a name="ln-1131"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">S12RuntimeFraction</span><span class="p">)</span><span class="o">*</span><span class="n">S1EvapWaterConsumpRate</span> <span class="p">&amp;</span>
<a name="ln-1132"></a>                                                 <span class="o">+</span><span class="n">S12RuntimeFraction</span><span class="o">*</span><span class="n">S12EvapWaterConsumpRate</span>
<a name="ln-1133"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">S12RuntimeFraction</span><span class="p">)</span><span class="o">*</span><span class="n">S1EvapCondPumpElecPower</span> <span class="p">&amp;</span>
<a name="ln-1134"></a>                                                  <span class="o">+</span><span class="n">S12RuntimeFraction</span><span class="o">*</span><span class="n">S12EvapCondPumpElecPower</span>
<a name="ln-1135"></a>
<a name="ln-1136"></a>
<a name="ln-1137"></a>      <span class="c">! Stage 1 runtime sets the crankcase heater power</span>
<a name="ln-1138"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">S1CrankcaseHeaterPower</span>
<a name="ln-1139"></a>
<a name="ln-1140"></a>      <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-1141"></a>      <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a><span class="c">!     calculate average full load outlet conditions for second stage operation</span>
<a name="ln-1144"></a>      <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">S2PLR</span><span class="p">)</span><span class="o">*</span><span class="n">S1FFullLoadOutAirTemp</span> <span class="o">+</span> <span class="n">S2PLR</span><span class="o">*</span><span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-1145"></a>      <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">S2PLR</span><span class="p">)</span><span class="o">*</span><span class="n">S1FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="n">S2PLR</span><span class="o">*</span><span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-1146"></a>
<a name="ln-1147"></a>    <span class="n">ENDIF</span> <span class="c">! End if stage 2 is operating</span>
<a name="ln-1148"></a>
<a name="ln-1149"></a><span class="c">!   set the part load ratio and heat reclaim capacity for use by desuperheater heating coils</span>
<a name="ln-1150"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>            <span class="o">=</span> <span class="n">S1PLR</span>
<a name="ln-1151"></a>    <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>             <span class="o">=</span> <span class="n">S1PLR</span>
<a name="ln-1152"></a>
<a name="ln-1153"></a><span class="c">!   Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-1154"></a>    <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-1155"></a>
<a name="ln-1156"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilStg2RuntimeFrac</span> <span class="o">=</span> <span class="n">S12RuntimeFraction</span>
<a name="ln-1157"></a>
<a name="ln-1158"></a><span class="c">!   Calculate basin heater power</span>
<a name="ln-1159"></a>    <span class="k">CALL </span><span class="n">CalcBasinHeaterPowerForMultiModeDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">DehumidMode</span><span class="p">)</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1162"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Error detected in DX Coil=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-1163"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid DX Coil Type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">))</span>
<a name="ln-1164"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1165"></a>
<a name="ln-1166"></a>
<a name="ln-1167"></a><span class="k">END SELECT</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a><span class="c">! Update the unit outlet nodes</span>
<a name="ln-1170"></a><span class="k">CALL </span><span class="n">UpdateDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-1171"></a>
<a name="ln-1172"></a><span class="c">! Report the result of the simulation</span>
<a name="ln-1173"></a><span class="k">CALL </span><span class="n">ReportDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-1174"></a>
<a name="ln-1175"></a>
<a name="ln-1176"></a><span class="k">RETURN</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a><span class="k">END SUBROUTINE </span><span class="n">SimDXCoilMultiMode</span>
<a name="ln-1179"></a>
<a name="ln-1180"></a>
<a name="ln-1181"></a><span class="k">SUBROUTINE </span><span class="n">GetDXCoils</span>
<a name="ln-1182"></a>
<a name="ln-1183"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1184"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-1185"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-1186"></a>          <span class="c">!       MODIFIED       Don Shirey, Aug/Sept 2000, Feb/Oct 2001, Sept 2003, Jan/July 2004</span>
<a name="ln-1187"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-1188"></a>          <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-1189"></a>          <span class="c">!                      May 2005, Rich Raustad, FSEC, Added COIL:DX:HeatPumpWaterHeater</span>
<a name="ln-1190"></a>          <span class="c">!                      June 2007 L. Gu, FSEC</span>
<a name="ln-1191"></a>          <span class="c">!                      Added new coil type COIL:DX:MULTISPEED:COOLING and COIL:DX:MULTISPEED:HEATING</span>
<a name="ln-1192"></a>          <span class="c">!                      April 2010, Chandan Sharma, FSEC, added basin heater inputs</span>
<a name="ln-1193"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1196"></a>          <span class="c">! Obtains input data for DX coils and stores it in DX coil data structure</span>
<a name="ln-1197"></a>
<a name="ln-1198"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1199"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-1200"></a>
<a name="ln-1201"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1202"></a>          <span class="c">! na</span>
<a name="ln-1203"></a>
<a name="ln-1204"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1205"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">GetObjectItemNum</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span><span class="n">GetObjectDefMaxArgs</span>
<a name="ln-1206"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">GetCurveType</span><span class="p">,</span> <span class="n">CurveValue</span><span class="p">,</span> <span class="n">SetCurveOutputMinMaxValues</span>
<a name="ln-1207"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-1208"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-1209"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-1210"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1211"></a>  <span class="k">USE </span><span class="n">WaterManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupTankDemandComponent</span><span class="p">,</span> <span class="n">SetupTankSupplyComponent</span>
<a name="ln-1212"></a>  <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-1213"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-1214"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">,</span> <span class="n">emsCallFromComponentGetInput</span>
<a name="ln-1215"></a>  <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">ManageEMS</span>
<a name="ln-1216"></a>  <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-1217"></a>
<a name="ln-1218"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1221"></a>          <span class="c">! na</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1224"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-1225"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetDXCoils: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-1226"></a>
<a name="ln-1227"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1228"></a>          <span class="c">! na</span>
<a name="ln-1229"></a>
<a name="ln-1230"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1231"></a>          <span class="c">! na</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1234"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DXCoilIndex</span>          <span class="c">! loop index</span>
<a name="ln-1235"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>            <span class="c">! current DX coil number</span>
<a name="ln-1236"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>            <span class="c">! Number of alphas in input</span>
<a name="ln-1237"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>           <span class="c">! Number of numeric items in input</span>
<a name="ln-1238"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Alphas2</span>         <span class="c">! Alpha input items for object</span>
<a name="ln-1239"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Numbers2</span>           <span class="c">! Numeric input items for object</span>
<a name="ln-1240"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields2</span>   <span class="c">! Alpha field names</span>
<a name="ln-1241"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields2</span> <span class="c">! Numeric field names</span>
<a name="ln-1242"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks2</span>      <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-1243"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks2</span>    <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-1244"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas2</span>           <span class="c">! Number of alphas in input for performance object</span>
<a name="ln-1245"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers2</span>          <span class="c">! Number of numeric items in input for performance object</span>
<a name="ln-1246"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>             <span class="c">! Input status returned from GetObjectItem</span>
<a name="ln-1247"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-1248"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-1249"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! Set to true if errors in input, fatal at end of routine</span>
<a name="ln-1250"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DXHPWaterHeaterCoilNum</span> <span class="c">! Loop index for 1,NumDXHeatPumpWaterHeaterCoils</span>
<a name="ln-1251"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CapacityStageNum</span>     <span class="c">! Loop index for 1,Number of capacity stages</span>
<a name="ln-1252"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DehumidModeNum</span>       <span class="c">! Loop index for 1,Number of enhanced dehumidification modes</span>
<a name="ln-1253"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PerfModeNum</span>          <span class="c">! Performance mode index</span>
<a name="ln-1254"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PerfObjectNum</span>        <span class="c">! Item number for performance object</span>
<a name="ln-1255"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AlphaIndex</span>           <span class="c">! Index for current alpha field</span>
<a name="ln-1256"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>     <span class="c">! Object type for getting and error messages</span>
<a name="ln-1257"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PerfObjectType</span>   <span class="c">! Performance object type for getting and error messages</span>
<a name="ln-1258"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PerfObjectName</span>   <span class="c">! Performance object name for getting and error messages</span>
<a name="ln-1259"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirTemp</span>       <span class="c">! Used to pass proper inlet air temp to HPWH DX coil performance curves</span>
<a name="ln-1260"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterTemp</span>     <span class="c">! Used to pass proper inlet water temp to HPWH DX coil performance curves</span>
<a name="ln-1261"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapFTemp</span>       <span class="c">! Used to verify HPWH DX coil heating capacity (function of temp) performance curve</span>
<a name="ln-1262"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCOPFTemp</span>       <span class="c">! Used to verify HPWH DX coil heating COP (function of temp) performance curve</span>
<a name="ln-1263"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapFAirFlow</span>    <span class="c">! Used to verify HPWH DX coil heating capacity (function of air flow) performance curve</span>
<a name="ln-1264"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCOPFAirFlow</span>    <span class="c">! Used to verify HPWH DX coil heating COP (function of air flow) performance curve</span>
<a name="ln-1265"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapFWaterFlow</span>  <span class="c">! Used to verify HPWH DX coil heating capacity (function of water flow) performance curve</span>
<a name="ln-1266"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCOPFWaterFlow</span>  <span class="c">! Used to verify HPWH DX coil heating COP (function of water flow) performance curve</span>
<a name="ln-1267"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">I</span>                  <span class="c">! Index of speeds</span>
<a name="ln-1268"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurveVal</span>           <span class="c">! Used to verify modifier curves equal 1 at rated conditions</span>
<a name="ln-1269"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Alphas</span>         <span class="c">! Alpha input items for object</span>
<a name="ln-1270"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-1271"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-1272"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Numbers</span>           <span class="c">! Numeric input items for object</span>
<a name="ln-1273"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>      <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-1274"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>    <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-1275"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MaxNumbers</span><span class="o">=</span><span class="mi">0</span>          <span class="c">! Maximum number of numeric input fields</span>
<a name="ln-1276"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>        <span class="c">! Maximum number of alpha input fields</span>
<a name="ln-1277"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TotalArgs</span><span class="o">=</span><span class="mi">0</span>        <span class="c">! Total number of alpha and numeric arguments (max) for a</span>
<a name="ln-1278"></a>                                <span class="c">!   certain object in the input file</span>
<a name="ln-1279"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinCurveVal</span>        <span class="c">! used for testing PLF curve output</span>
<a name="ln-1280"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinCurvePLR</span>        <span class="c">! used for testing PLF curve output</span>
<a name="ln-1281"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxCurveVal</span>        <span class="c">! used for testing PLF curve output</span>
<a name="ln-1282"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxCurvePLR</span>        <span class="c">! used for testing PLF curve output</span>
<a name="ln-1283"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurveInput</span>         <span class="c">! index used for testing PLF curve output</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-1286"></a>
<a name="ln-1287"></a><span class="c">! find number of each type of DX coil and calculate the total number</span>
<a name="ln-1288"></a><span class="n">NumDoe2DXCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">)</span>
<a name="ln-1289"></a><span class="n">NumDXHeatingCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:SingleSpeed&#39;</span><span class="p">)</span>
<a name="ln-1290"></a><span class="n">NumDXMulSpeedCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">)</span>
<a name="ln-1291"></a><span class="n">NumDXMulModeCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span><span class="p">)</span>
<a name="ln-1292"></a><span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:WaterHeating:AirToWaterHeatPump&#39;</span><span class="p">)</span>
<a name="ln-1293"></a><span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">)</span>
<a name="ln-1294"></a><span class="n">NumDXMulSpeedHeatCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">)</span>
<a name="ln-1295"></a><span class="n">NumVRFCoolingCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoilVRF_Cooling</span><span class="p">))</span>
<a name="ln-1296"></a><span class="n">NumVRFHeatingCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoilVRF_Heating</span><span class="p">))</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a><span class="n">NumDXCoils</span> <span class="o">=</span> <span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="p">&amp;</span>
<a name="ln-1299"></a>             <span class="o">+</span> <span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedHeatCoils</span> <span class="o">+</span> <span class="n">NumVRFCoolingCoils</span> <span class="o">+</span> <span class="n">NumVRFHeatingCoils</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a><span class="c">! Determine max number of alpha and numeric arguments for all objects being read, in order to allocate local arrays</span>
<a name="ln-1302"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1303"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="n">NumNumbers</span>
<a name="ln-1304"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="n">NumAlphas</span>
<a name="ln-1305"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:SingleSpeed&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1306"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1307"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1308"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1309"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1310"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1311"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1312"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1313"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1314"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:WaterHeating:AirToWaterHeatPump&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1315"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1316"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1317"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1318"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1319"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1320"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1321"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1322"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1323"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoilVRF_Cooling</span><span class="p">),</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1324"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1325"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1326"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoilVRF_Heating</span><span class="p">),</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1327"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1328"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1329"></a><span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;CoilPerformance:DX:Cooling&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1330"></a><span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1331"></a><span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1332"></a>
<a name="ln-1333"></a>
<a name="ln-1334"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1335"></a><span class="n">Alphas</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1336"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1337"></a><span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1338"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1339"></a><span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1340"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1341"></a><span class="n">Numbers</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1342"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1343"></a><span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1344"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1345"></a><span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1348"></a><span class="n">Alphas2</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1349"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1350"></a><span class="n">cAlphaFields2</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1351"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields2</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1352"></a><span class="n">cNumericFields2</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1353"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Numbers2</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1354"></a><span class="n">Numbers2</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1355"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1356"></a><span class="n">lAlphaBlanks2</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1357"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks2</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1358"></a><span class="n">lNumericBlanks2</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1359"></a>
<a name="ln-1360"></a><span class="c">! allocate the data structure</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a><span class="c">! Derived types</span>
<a name="ln-1363"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1364"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1365"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1366"></a><span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1367"></a>
<a name="ln-1368"></a>
<a name="ln-1369"></a>
<a name="ln-1370"></a><span class="c">! Module level variable arrays</span>
<a name="ln-1371"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1372"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1373"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1374"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilFanOpMode</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1375"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1376"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1377"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilTotalCooling</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1378"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilTotalHeating</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1379"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilCoolInletAirWBTemp</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1380"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilHeatInletAirDBTemp</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1381"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoilHeatInletAirWBTemp</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-1382"></a><span class="c">!</span>
<a name="ln-1383"></a><span class="c">! initialize the module level arrays</span>
<a name="ln-1384"></a><span class="c">!</span>
<a name="ln-1385"></a><span class="n">DXCoilOutletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1386"></a><span class="n">DXCoilOutletHumRat</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1387"></a><span class="n">DXCoilPartLoadRatio</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1388"></a><span class="n">DXCoilFanOpMode</span>            <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1389"></a><span class="n">DXCoilFullLoadOutAirTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1390"></a><span class="n">DXCoilFullLoadOutAirHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1391"></a>
<a name="ln-1392"></a><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MaxRatedVolFlowPerRatedTotCap1</span>
<a name="ln-1393"></a><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MinRatedVolFlowPerRatedTotCap1</span>
<a name="ln-1394"></a><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MaxHeatVolFlowPerRatedTotCap1</span>
<a name="ln-1395"></a><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MaxCoolVolFlowPerRatedTotCap1</span>
<a name="ln-1396"></a><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MinOperVolFlowPerRatedTotCap1</span>
<a name="ln-1397"></a><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">MaxRatedVolFlowPerRatedTotCap2</span>
<a name="ln-1398"></a><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">MinRatedVolFlowPerRatedTotCap2</span>
<a name="ln-1399"></a><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MaxHeatVolFlowPerRatedTotCap2</span>
<a name="ln-1400"></a><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MaxCoolVolFlowPerRatedTotCap2</span>
<a name="ln-1401"></a><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MinOperVolFlowPerRatedTotCap2</span>
<a name="ln-1402"></a><span class="c">! initialize the coil counter</span>
<a name="ln-1403"></a><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1404"></a>
<a name="ln-1405"></a><span class="c">! Loop over the Doe2 DX Coils and get &amp; load the data</span>
<a name="ln-1406"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span>
<a name="ln-1407"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDoe2DXCoils</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1410"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1411"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1414"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1415"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1416"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1417"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1418"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1419"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1420"></a>  <span class="n">ENDIF</span>
<a name="ln-1421"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1422"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1423"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1424"></a>  <span class="n">ENDIF</span>
<a name="ln-1425"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1426"></a><span class="c">! Initialize DataHeatBalance heat reclaim variable name for use by heat reclaim coils</span>
<a name="ln-1427"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1428"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SourceType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1429"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1430"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_CoolingSingleSpeed</span>
<a name="ln-1431"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1432"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1433"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1434"></a>  <span class="k">ELSE</span>
<a name="ln-1435"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-1436"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1437"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1438"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1439"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1440"></a>    <span class="k">END IF</span>
<a name="ln-1441"></a><span class="k">  END IF</span>
<a name="ln-1442"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1443"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1444"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1445"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1446"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1447"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1448"></a>        <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1449"></a>     <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1450"></a>  <span class="k">END IF</span>
<a name="ln-1451"></a>
<a name="ln-1452"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1453"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1454"></a>
<a name="ln-1455"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1456"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1457"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1458"></a>
<a name="ln-1459"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1460"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1461"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1462"></a>
<a name="ln-1463"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1464"></a>
<a name="ln-1465"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1466"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1467"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1468"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1469"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1470"></a>    <span class="k">ELSE</span>
<a name="ln-1471"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1472"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1473"></a>    <span class="k">END IF</span>
<a name="ln-1474"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1475"></a>  <span class="k">ELSE</span>
<a name="ln-1476"></a>    <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-1477"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1478"></a>
<a name="ln-1479"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1480"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1483"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1484"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1485"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1486"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic.&#39;</span><span class="p">)</span>
<a name="ln-1487"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1488"></a>    <span class="k">END SELECT</span>
<a name="ln-1489"></a><span class="k">  END IF</span>
<a name="ln-1490"></a>
<a name="ln-1491"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1492"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1493"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1494"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1495"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1496"></a>    <span class="k">ELSE</span>
<a name="ln-1497"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1498"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1499"></a>    <span class="k">END IF</span>
<a name="ln-1500"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1501"></a>  <span class="k">ELSE</span>
<a name="ln-1502"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1503"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1504"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1507"></a>
<a name="ln-1508"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1509"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1510"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1511"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1512"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1513"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1514"></a>    <span class="k">END SELECT</span>
<a name="ln-1515"></a><span class="k">  END IF</span>
<a name="ln-1516"></a>
<a name="ln-1517"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1518"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1519"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1520"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1521"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1522"></a>    <span class="k">ELSE</span>
<a name="ln-1523"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1524"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1525"></a>    <span class="k">END IF</span>
<a name="ln-1526"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1527"></a>  <span class="k">ELSE</span>
<a name="ln-1528"></a>    <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-1529"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1530"></a>
<a name="ln-1531"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1532"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-1533"></a>
<a name="ln-1534"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1535"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1536"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1537"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1538"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic.&#39;</span><span class="p">)</span>
<a name="ln-1539"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1540"></a>    <span class="k">END SELECT</span>
<a name="ln-1541"></a><span class="k">  END IF</span>
<a name="ln-1542"></a>
<a name="ln-1543"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1544"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1545"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1546"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1547"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1548"></a>    <span class="k">ELSE</span>
<a name="ln-1549"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1550"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1551"></a>    <span class="k">END IF</span>
<a name="ln-1552"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1553"></a>  <span class="k">ELSE</span>
<a name="ln-1554"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1555"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1558"></a>
<a name="ln-1559"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1560"></a>
<a name="ln-1561"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1562"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1563"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1564"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1565"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1566"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1567"></a>    <span class="k">END SELECT</span>
<a name="ln-1568"></a><span class="k">  END IF</span>
<a name="ln-1569"></a>
<a name="ln-1570"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1571"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1572"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1573"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-1574"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1575"></a>    <span class="k">ELSE</span>
<a name="ln-1576"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1577"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1578"></a>    <span class="k">END IF</span>
<a name="ln-1579"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1580"></a>  <span class="k">ELSE</span>
<a name="ln-1581"></a>    <span class="c">! Verify Curve Object, only legal types are Quadratic or Cubic</span>
<a name="ln-1582"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1585"></a>
<a name="ln-1586"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1587"></a>
<a name="ln-1588"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1589"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1590"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1591"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1592"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1593"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1594"></a>    <span class="k">END SELECT</span>
<a name="ln-1595"></a>
<a name="ln-1596"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1597"></a><span class="c">!     Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-1598"></a>      <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-1599"></a>      <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-1600"></a>      <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1601"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1602"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-1603"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1604"></a><span class="k">          </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-1605"></a>          <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-1606"></a>        <span class="k">END IF</span>
<a name="ln-1607"></a><span class="k">        IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1608"></a><span class="k">          </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-1609"></a>          <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-1610"></a>        <span class="k">END IF</span>
<a name="ln-1611"></a><span class="k">        </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-1612"></a>      <span class="k">END DO</span>
<a name="ln-1613"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1614"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1615"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; has out of range values.&#39;</span><span class="p">)</span>
<a name="ln-1616"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1617"></a>                        <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1618"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-1619"></a>        <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-1620"></a>      <span class="k">END IF</span>
<a name="ln-1621"></a>
<a name="ln-1622"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1623"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1624"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-1625"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1626"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1627"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-1628"></a>        <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1629"></a>      <span class="k">END IF</span>
<a name="ln-1630"></a>
<a name="ln-1631"></a><span class="k">    END IF</span>
<a name="ln-1632"></a><span class="k">  END IF</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1635"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>           <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1636"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1637"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatentCapacityTimeConstant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1638"></a>
<a name="ln-1639"></a>  <span class="c">! Numbers (6) through (9) must all be greater than zero to use the latent capacity degradation model</span>
<a name="ln-1640"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1641"></a>    <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1642"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1643"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...At least one of the four input parameters for the latent capacity degradation model&#39;</span><span class="p">)</span>
<a name="ln-1644"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...is set to zero. Therefore, the latent degradation model will not be used for this simulation.&#39;</span><span class="p">)</span>
<a name="ln-1645"></a>  <span class="k">END IF</span>
<a name="ln-1646"></a>
<a name="ln-1647"></a><span class="c">! outdoor condenser node</span>
<a name="ln-1648"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1649"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1650"></a>  <span class="k">ELSE</span>
<a name="ln-1651"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1652"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1653"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1654"></a>
<a name="ln-1655"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-1656"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, may be invalid&#39;</span><span class="p">)</span>
<a name="ln-1657"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1658"></a>                               <span class="s1">&#39;&quot;, node does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-1659"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This node needs to be included in an air system or the coil model will not be valid&#39;</span> <span class="p">&amp;</span>
<a name="ln-1660"></a>                             <span class="o">//</span><span class="s1">&#39;, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-1661"></a>    <span class="k">END IF</span>
<a name="ln-1662"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-1663"></a>
<a name="ln-1664"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1665"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">AirCooled</span>
<a name="ln-1666"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;EvaporativelyCooled&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1667"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCooled</span>
<a name="ln-1668"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1669"></a>  <span class="k">ELSE</span>
<a name="ln-1670"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1671"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1672"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...must be AirCooled or EvaporativelyCooled.&#39;</span><span class="p">)</span>
<a name="ln-1673"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1674"></a>  <span class="k">END IF</span>
<a name="ln-1675"></a>
<a name="ln-1676"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1677"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1678"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1679"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0 or &gt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-1680"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1681"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1682"></a>  <span class="k">END IF</span>
<a name="ln-1683"></a>
<a name="ln-1684"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1685"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1686"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1687"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1688"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1689"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1690"></a>  <span class="k">END IF</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1693"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1694"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1695"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1696"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1697"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1698"></a>  <span class="k">END IF</span>
<a name="ln-1699"></a>
<a name="ln-1700"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-1701"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1702"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1703"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1704"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1705"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1706"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1707"></a>  <span class="k">END IF</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>  <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-1710"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1711"></a>
<a name="ln-1712"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1713"></a><span class="k">     </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1714"></a>  <span class="k">END IF</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a>  <span class="c">! Get Water System tank connections</span>
<a name="ln-1717"></a>  <span class="c">!  A12, \field Name of Water Storage Tank for Supply</span>
<a name="ln-1718"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1719"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1720"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromMains</span>
<a name="ln-1721"></a>  <span class="k">ELSE</span>
<a name="ln-1722"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromTank</span>
<a name="ln-1723"></a>    <span class="k">CALL </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1724"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1725"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span> <span class="p">)</span>
<a name="ln-1726"></a>  <span class="n">ENDIF</span>
<a name="ln-1727"></a>
<a name="ln-1728"></a>  <span class="c">!A13; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-1729"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1730"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1731"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-1732"></a>  <span class="k">ELSE</span>
<a name="ln-1733"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-1734"></a>    <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1735"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1736"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-1737"></a>  <span class="k">END IF</span>
<a name="ln-1738"></a>
<a name="ln-1739"></a>  <span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-1740"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1741"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1742"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1743"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1744"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1745"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1746"></a>  <span class="k">END IF</span>
<a name="ln-1747"></a>
<a name="ln-1748"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1749"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1750"></a><span class="k">    IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">16</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1751"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-1752"></a>    <span class="n">ENDIF</span>
<a name="ln-1753"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1754"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, freeze possible&#39;</span><span class="p">)</span>
<a name="ln-1755"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &lt; 2 {C}. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-1756"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1757"></a>    <span class="k">END IF</span>
<a name="ln-1758"></a><span class="k">  END IF</span>
<a name="ln-1759"></a>
<a name="ln-1760"></a><span class="k">  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1761"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<a name="ln-1762"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1763"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1764"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1765"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Basin heater will be available to operate throughout the simulation.&#39;</span><span class="p">)</span>
<a name="ln-1766"></a>    <span class="k">END IF</span>
<a name="ln-1767"></a><span class="k">  END IF</span>
<a name="ln-1768"></a>
<a name="ln-1769"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&gt;</span> <span class="mi">14</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1770"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1771"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1772"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1773"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1774"></a>    <span class="k">ELSE</span>
<a name="ln-1775"></a>     <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-1776"></a>     <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1777"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1778"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTempCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-1779"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1780"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1781"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1782"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1783"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic.&#39;</span><span class="p">)</span>
<a name="ln-1784"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1785"></a>     <span class="k">END SELECT</span>
<a name="ln-1786"></a><span class="k">    END IF</span>
<a name="ln-1787"></a><span class="k">  END IF</span>
<a name="ln-1788"></a>
<a name="ln-1789"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1790"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1791"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1792"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1793"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1794"></a>    <span class="k">ELSE</span>
<a name="ln-1795"></a>     <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-1796"></a>     <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1797"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1798"></a>
<a name="ln-1799"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1800"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1801"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1802"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-1803"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be quadratic or cubic.&#39;</span><span class="p">)</span>
<a name="ln-1804"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1805"></a>     <span class="k">END SELECT</span>
<a name="ln-1806"></a><span class="k">    END IF</span>
<a name="ln-1807"></a><span class="k">  END IF</span>
<a name="ln-1808"></a>
<a name="ln-1809"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1810"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1811"></a>  <span class="n">ENDIF</span>
<a name="ln-1812"></a>
<a name="ln-1813"></a><span class="k">END DO</span> <span class="c">! end of the Doe2 DX coil loop</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1816"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1817"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1818"></a><span class="k">END IF</span>
<a name="ln-1819"></a>
<a name="ln-1820"></a><span class="c">! Loop over the Multimode DX Coils and get &amp; load the data</span>
<a name="ln-1821"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span>
<a name="ln-1822"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDXMulModeCoils</span>
<a name="ln-1823"></a>
<a name="ln-1824"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1825"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1826"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1827"></a>
<a name="ln-1828"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1829"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1830"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1831"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1832"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1833"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1834"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1835"></a>  <span class="n">ENDIF</span>
<a name="ln-1836"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1837"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1838"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1839"></a>  <span class="n">ENDIF</span>
<a name="ln-1840"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1841"></a><span class="c">! Initialize DataHeatBalance heat reclaim variable name for use by heat reclaim coils</span>
<a name="ln-1842"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1843"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SourceType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1844"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1845"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span>
<a name="ln-1846"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1847"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1848"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1849"></a>  <span class="k">ELSE</span>
<a name="ln-1850"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-1851"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1852"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1853"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1854"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1855"></a>    <span class="k">END IF</span>
<a name="ln-1856"></a><span class="k">  END IF</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1859"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1860"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1861"></a>
<a name="ln-1862"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1863"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1864"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1867"></a>
<a name="ln-1868"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-1869"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1870"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1871"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1872"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1873"></a>        <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1874"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1875"></a>  <span class="k">END IF</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a>  <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-1878"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1879"></a>
<a name="ln-1880"></a>  <span class="c">!  Number of capacity stages</span>
<a name="ln-1881"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1882"></a>  <span class="c">!  Check if requested number of capacity stages exceeds limits</span>
<a name="ln-1883"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCapacityStages</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1884"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1885"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span><span class="p">)))</span>
<a name="ln-1886"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Valid range is 1 to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCapacityStages</span><span class="p">)))</span>
<a name="ln-1887"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1888"></a>  <span class="k">END IF</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a>  <span class="c">!  Number of enhanced dehumidification modes</span>
<a name="ln-1891"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1892"></a>  <span class="c">!  Check if requested number of enhanced dehumidification modes exceeds limits</span>
<a name="ln-1893"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxDehumidModes</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1894"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1895"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span><span class="p">)))</span>
<a name="ln-1896"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Valid range is 0 to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxDehumidModes</span><span class="p">)))</span>
<a name="ln-1897"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1898"></a>  <span class="k">END IF</span>
<a name="ln-1899"></a>
<a name="ln-1900"></a>  <span class="c">!  Set starting alpha index for coil performance inputs</span>
<a name="ln-1901"></a>  <span class="n">AlphaIndex</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-1902"></a>
<a name="ln-1903"></a>  <span class="c">!  Loop through capacity stages and dehumidification modes</span>
<a name="ln-1904"></a>  <span class="k">DO </span><span class="n">DehumidModeNum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span>
<a name="ln-1905"></a>    <span class="k">DO </span><span class="n">CapacityStageNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span>
<a name="ln-1906"></a>      <span class="c">!  Check if sufficient number of fields entered</span>
<a name="ln-1907"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">AlphaIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">NumAlphas</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1908"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1909"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not enough remaining fields for specified Number of Operating Modes.&#39;</span><span class="p">)</span>
<a name="ln-1910"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Need additional Coil Performance Object Type and Coil Performance Object Name fields.&#39;</span><span class="p">)</span>
<a name="ln-1911"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1912"></a>      <span class="k">ELSE</span>
<a name="ln-1913"></a><span class="k">        </span><span class="n">PerfObjectType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="p">))</span>
<a name="ln-1914"></a>        <span class="n">PerfObjectName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1915"></a>        <span class="n">PerfModeNum</span>    <span class="o">=</span> <span class="n">DehumidModeNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">CapacityStageNum</span>
<a name="ln-1916"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceType</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">PerfObjectType</span>
<a name="ln-1917"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">,</span><span class="s1">&#39;CoilPerformance:DX:Cooling&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1918"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceType_Num</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoilPerfDX_CoolByPassEmpirical</span>
<a name="ln-1919"></a>        <span class="k">ELSE</span>
<a name="ln-1920"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1921"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1922"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Must be &quot;CoilPerformance:DX:Cooling&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1923"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1924"></a>        <span class="k">END IF</span>
<a name="ln-1925"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">PerfObjectName</span>
<a name="ln-1926"></a>        <span class="c">! Get for CoilPerformance object</span>
<a name="ln-1927"></a>        <span class="n">PerfObjectNum</span> <span class="o">=</span> <span class="n">GetObjectItemNum</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">,</span><span class="n">PerfObjectName</span><span class="p">)</span>
<a name="ln-1928"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PerfObjectNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a><span class="k">          CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">,</span><span class="n">PerfObjectNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1931"></a>                             <span class="n">Alphas2</span><span class="p">,</span><span class="n">NumAlphas2</span><span class="p">,</span><span class="n">Numbers2</span><span class="p">,</span><span class="n">NumNumbers2</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1932"></a>                             <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks2</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1933"></a>                             <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields2</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields2</span><span class="p">)</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1936"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1937"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1938"></a>               <span class="c">! Rated flow is immediately adjusted for bypass fraction if not autosized</span>
<a name="ln-1939"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1940"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1941"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1942"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1943"></a>               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))</span>
<a name="ln-1944"></a>          <span class="n">ENDIF</span>
<a name="ln-1945"></a>
<a name="ln-1946"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1947"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1948"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1949"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1950"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1951"></a>            <span class="k">ELSE</span>
<a name="ln-1952"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1953"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1954"></a>            <span class="k">END IF</span>
<a name="ln-1955"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1956"></a>          <span class="k">ELSE</span>
<a name="ln-1957"></a>            <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-1958"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-1959"></a>
<a name="ln-1960"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1961"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-1962"></a>
<a name="ln-1963"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1964"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1965"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1966"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-1967"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-1968"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1969"></a>            <span class="k">END SELECT</span>
<a name="ln-1970"></a><span class="k">          END IF</span>
<a name="ln-1971"></a>
<a name="ln-1972"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-1973"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1974"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1975"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1976"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1977"></a>            <span class="k">ELSE</span>
<a name="ln-1978"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1979"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1980"></a>            <span class="k">END IF</span>
<a name="ln-1981"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1982"></a>          <span class="k">ELSE</span>
<a name="ln-1983"></a>            <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1984"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-1985"></a>
<a name="ln-1986"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1987"></a>
<a name="ln-1988"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1991"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1992"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1993"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-1994"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-1995"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1996"></a>            <span class="k">END SELECT</span>
<a name="ln-1997"></a><span class="k">          END IF</span>
<a name="ln-1998"></a>
<a name="ln-1999"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2000"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2001"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2002"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2003"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2004"></a>            <span class="k">ELSE</span>
<a name="ln-2005"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2006"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2007"></a>            <span class="k">END IF</span>
<a name="ln-2008"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2009"></a>          <span class="k">ELSE</span>
<a name="ln-2010"></a>            <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-2011"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2014"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2017"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2018"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2019"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-2020"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2021"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2022"></a>            <span class="k">END SELECT</span>
<a name="ln-2023"></a><span class="k">          END IF</span>
<a name="ln-2024"></a>
<a name="ln-2025"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2026"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2027"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2028"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2029"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2030"></a>            <span class="k">ELSE</span>
<a name="ln-2031"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2032"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2033"></a>            <span class="k">END IF</span>
<a name="ln-2034"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2035"></a>          <span class="k">ELSE</span>
<a name="ln-2036"></a>            <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-2037"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-2038"></a>
<a name="ln-2039"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2040"></a>
<a name="ln-2041"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2042"></a>
<a name="ln-2043"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2044"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2045"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2046"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-2047"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2048"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2049"></a>            <span class="k">END SELECT</span>
<a name="ln-2050"></a><span class="k">          END IF</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2053"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2054"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2055"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2056"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2057"></a>            <span class="k">ELSE</span>
<a name="ln-2058"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2059"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2060"></a>            <span class="k">END IF</span>
<a name="ln-2061"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2062"></a>          <span class="k">ELSE</span>
<a name="ln-2063"></a>            <span class="c">! Verify Curve Object, only legal types are Quadratic or Cubic</span>
<a name="ln-2064"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-2065"></a>
<a name="ln-2066"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2069"></a>
<a name="ln-2070"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2071"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2072"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2073"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-2074"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2075"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2076"></a>            <span class="k">END SELECT</span>
<a name="ln-2077"></a>
<a name="ln-2078"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2079"></a><span class="c">!             Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-2080"></a>              <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-2081"></a>              <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-2082"></a>              <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2083"></a>              <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2084"></a>                <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-2085"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2086"></a><span class="k">                  </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-2087"></a>                  <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-2088"></a>                <span class="k">END IF</span>
<a name="ln-2089"></a><span class="k">                IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2090"></a><span class="k">                  </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-2091"></a>                  <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-2092"></a>                <span class="k">END IF</span>
<a name="ln-2093"></a><span class="k">                </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-2094"></a>              <span class="k">END DO</span>
<a name="ln-2095"></a><span class="k">              IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2096"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2097"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-2098"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2099"></a>                        <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2100"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2101"></a>                <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-2102"></a>              <span class="k">END IF</span>
<a name="ln-2103"></a>
<a name="ln-2104"></a><span class="k">              IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2105"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2106"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-2107"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2108"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2109"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2110"></a>                <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2111"></a>              <span class="k">END IF</span>
<a name="ln-2112"></a>
<a name="ln-2113"></a><span class="k">            END IF</span>
<a name="ln-2114"></a><span class="k">          END IF</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2117"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2118"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2119"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatentCapacityTimeConstant</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2120"></a>          <span class="c">! Numbers2 (6) through (9) must all be greater than zero to use the latent capacity degradation model</span>
<a name="ln-2121"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">Numbers2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2122"></a>              <span class="p">(</span><span class="n">Numbers2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2123"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2124"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...At least one of the four input parameters for the latent capacity degradation model&#39;</span><span class="p">)</span>
<a name="ln-2125"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...is set to zero. Therefore, the latent degradation model will not be used &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2126"></a>               <span class="s1">&#39;for this simulation.&#39;</span><span class="p">)</span>
<a name="ln-2127"></a>          <span class="k">END IF</span>
<a name="ln-2128"></a>
<a name="ln-2129"></a>          <span class="c">! outdoor condenser node</span>
<a name="ln-2130"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2131"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2132"></a>          <span class="k">ELSE</span>
<a name="ln-2133"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2134"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">PerfObjectType</span><span class="p">,</span><span class="n">PerfObjectName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2135"></a>                                 <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2136"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2137"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2138"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;may not be valid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2139"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;node does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-2140"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This node needs to be included in an air system or the coil model will not be valid&#39;</span> <span class="p">&amp;</span>
<a name="ln-2141"></a>                             <span class="o">//</span><span class="s1">&#39;, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2142"></a>            <span class="k">END IF</span>
<a name="ln-2143"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-2144"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2145"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AirCooled</span>
<a name="ln-2146"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;EvaporativelyCooled&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2147"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCooled</span>
<a name="ln-2148"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2149"></a>          <span class="k">ELSE</span>
<a name="ln-2150"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2151"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2152"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...must be AirCooled or EvaporativelyCooled.&#39;</span><span class="p">)</span>
<a name="ln-2153"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2154"></a>          <span class="k">END IF</span>
<a name="ln-2155"></a>
<a name="ln-2156"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2157"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2158"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2159"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2160"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields2</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0 or &gt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-2161"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers2</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2162"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2163"></a>          <span class="k">END IF</span>
<a name="ln-2164"></a>
<a name="ln-2165"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2166"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2167"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2168"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2169"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields2</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-2170"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers2</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2171"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2172"></a>          <span class="k">END IF</span>
<a name="ln-2173"></a>
<a name="ln-2174"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers2</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2175"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2176"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2177"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2178"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields2</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be less than zero.&#39;</span><span class="p">)</span>
<a name="ln-2179"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers2</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2180"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2181"></a>          <span class="k">END IF</span>
<a name="ln-2182"></a>
<a name="ln-2183"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span>
<a name="ln-2184"></a>
<a name="ln-2185"></a>          <span class="c">! read in user specified SHR modifer curves</span>
<a name="ln-2186"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas2</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2187"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2188"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2189"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2190"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2191"></a>            <span class="k">ELSE</span>
<a name="ln-2192"></a>             <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-2193"></a>             <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-2194"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2195"></a>                <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTempCurveType</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2196"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2197"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2198"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2199"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-2200"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic.&#39;</span><span class="p">)</span>
<a name="ln-2201"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2202"></a>             <span class="k">END SELECT</span>
<a name="ln-2203"></a><span class="k">            END IF</span>
<a name="ln-2204"></a><span class="k">          END IF</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas2</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2207"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2208"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2209"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2210"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2211"></a>            <span class="k">ELSE</span>
<a name="ln-2212"></a>             <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-2213"></a>             <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)))</span>
<a name="ln-2214"></a>              <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2215"></a>
<a name="ln-2216"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2217"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2218"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2219"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">))))</span>
<a name="ln-2220"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be quadratic or cubic.&#39;</span><span class="p">)</span>
<a name="ln-2221"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2222"></a>             <span class="k">END SELECT</span>
<a name="ln-2223"></a><span class="k">            END IF</span>
<a name="ln-2224"></a><span class="k">          END IF</span>
<a name="ln-2225"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2226"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2227"></a>          <span class="k">ELSE</span>
<a name="ln-2228"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2229"></a>          <span class="n">ENDIF</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a>        <span class="k">ELSE</span> <span class="c">! invalid performance object</span>
<a name="ln-2232"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2233"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PerfObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2234"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2235"></a>        <span class="k">END IF</span> <span class="c">! end of valid performance object check</span>
<a name="ln-2236"></a>        <span class="n">AlphaIndex</span> <span class="o">=</span> <span class="n">AlphaIndex</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2237"></a>      <span class="k">END IF</span> <span class="c">! end of sufficient number of fields entered check</span>
<a name="ln-2238"></a>    <span class="k">END DO</span> <span class="c">! End of multimode DX capacity stages loop</span>
<a name="ln-2239"></a>    <span class="c">! Warn if inputs entered for unused capacity stages</span>
<a name="ln-2240"></a>    <span class="k">DO </span><span class="n">CapacityStageNum</span> <span class="o">=</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MaxCapacityStages</span>
<a name="ln-2241"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">AlphaIndex</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">NumAlphas</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2242"></a>         <span class="p">((</span><span class="n">Alphas</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Blank</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2243"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2244"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Capacity Stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CapacityStageNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not active. Therefore,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2245"></a>            <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="p">)))</span>
<a name="ln-2246"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... and &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">AlphaIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; fields will be ignored.&#39;</span><span class="p">)</span>
<a name="ln-2247"></a>      <span class="k">END IF</span>
<a name="ln-2248"></a><span class="k">      </span><span class="n">AlphaIndex</span> <span class="o">=</span> <span class="n">AlphaIndex</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2249"></a>    <span class="k">END DO</span> <span class="c">! End of unused capacity stages loop</span>
<a name="ln-2250"></a>  <span class="k">END DO</span> <span class="c">! End of multimode DX dehumidification modes loop</span>
<a name="ln-2251"></a>
<a name="ln-2252"></a><span class="c">!  ! Warn if excess fields entered</span>
<a name="ln-2253"></a><span class="c">!  IF (NumAlphas .GE. AlphaIndex .and. ANY(Alphas(AlphaIndex:) /= Blank)) THEN</span>
<a name="ln-2254"></a><span class="c">!    CALL ShowWarningError(RoutineName//trim(CurrentModuleObject)//&#39;=&quot;&#39;//trim(DXCoil(DXCoilNum)%Name)//&#39;&quot;:&#39;)</span>
<a name="ln-2255"></a><span class="c">!    CALL ShowContinueError(&#39;...too many remaining fields for specified Capacity Stages and Dehumidification Modes.&#39;)</span>
<a name="ln-2256"></a><span class="c">!    CALL ShowContinueError(&#39;...Excess Coil Performance Object Type and Coil Performance Object Name fields will be ignored.&#39;)</span>
<a name="ln-2257"></a><span class="c">!  ENDIF</span>
<a name="ln-2258"></a>
<a name="ln-2259"></a>  <span class="c">! Get Water System tank connections</span>
<a name="ln-2260"></a>  <span class="c">!  A13, \field Name of Water Storage Tank for Supply</span>
<a name="ln-2261"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-2262"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2263"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromMains</span>
<a name="ln-2264"></a>  <span class="k">ELSE</span>
<a name="ln-2265"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromTank</span>
<a name="ln-2266"></a>    <span class="k">CALL </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2267"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2268"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span> <span class="p">)</span>
<a name="ln-2269"></a>  <span class="n">ENDIF</span>
<a name="ln-2270"></a>
<a name="ln-2271"></a>  <span class="c">!A14; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-2272"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-2273"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2274"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-2275"></a>  <span class="k">ELSE</span>
<a name="ln-2276"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-2277"></a>    <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2278"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2279"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-2280"></a>  <span class="n">ENDIF</span>
<a name="ln-2281"></a>
<a name="ln-2282"></a>  <span class="c">!Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-2283"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2284"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2285"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2286"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.&#39;</span><span class="p">)</span>
<a name="ln-2287"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2288"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2289"></a>  <span class="k">END IF</span>
<a name="ln-2290"></a>
<a name="ln-2291"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2292"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2293"></a><span class="k">    IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2294"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-2295"></a>    <span class="n">ENDIF</span>
<a name="ln-2296"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2297"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, freeze possible&#39;</span><span class="p">)</span>
<a name="ln-2298"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &lt; 2 {C}. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-2299"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2300"></a>    <span class="k">END IF</span>
<a name="ln-2301"></a><span class="k">  END IF</span>
<a name="ln-2302"></a>
<a name="ln-2303"></a><span class="k">  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2304"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<a name="ln-2305"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2306"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2307"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2308"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Basin heater will be available to operate throughout the simulation.&#39;</span><span class="p">)</span>
<a name="ln-2309"></a>    <span class="k">END IF</span>
<a name="ln-2310"></a><span class="k">  END IF</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a><span class="k">END DO</span> <span class="c">! end of the Multimode DX coil loop</span>
<a name="ln-2313"></a>
<a name="ln-2314"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2315"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2316"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2317"></a><span class="k">END IF</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a><span class="c">!************* Read Heat Pump (DX Heating Coil) Input **********</span>
<a name="ln-2320"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:Heating:DX:SingleSpeed&#39;</span>
<a name="ln-2321"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumDXHeatingCoils</span>
<a name="ln-2322"></a>
<a name="ln-2323"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2324"></a>
<a name="ln-2325"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2326"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2327"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-2328"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2329"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2330"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2331"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2332"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2333"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2334"></a>  <span class="n">ENDIF</span>
<a name="ln-2335"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2336"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2337"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2338"></a>  <span class="n">ENDIF</span>
<a name="ln-2339"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>       <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2340"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-2341"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_HeatingEmpirical</span>
<a name="ln-2342"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2343"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2344"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2345"></a>  <span class="k">ELSE</span>
<a name="ln-2346"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-2347"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2348"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2349"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2350"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2351"></a>    <span class="k">END IF</span>
<a name="ln-2352"></a><span class="k">  END IF</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2355"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2356"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2357"></a>
<a name="ln-2358"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2359"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2360"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2361"></a>
<a name="ln-2362"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-2363"></a>
<a name="ln-2364"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2365"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2366"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2367"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2368"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2369"></a>    <span class="k">ELSE</span>
<a name="ln-2370"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2371"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2372"></a>    <span class="k">END IF</span>
<a name="ln-2373"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2374"></a>  <span class="k">ELSE</span>
<a name="ln-2375"></a>    <span class="c">! only legal types are Quadratic, Biquadratic and Cubic</span>
<a name="ln-2376"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2377"></a>
<a name="ln-2378"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2379"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Quadratic</span>
<a name="ln-2380"></a>
<a name="ln-2381"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2382"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2383"></a>
<a name="ln-2384"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2385"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Cubic</span>
<a name="ln-2386"></a>
<a name="ln-2387"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2388"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2389"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2390"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2391"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic, Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2392"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2393"></a>    <span class="k">END SELECT</span>
<a name="ln-2394"></a><span class="k">  END IF</span>
<a name="ln-2395"></a>
<a name="ln-2396"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2397"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2398"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2399"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2400"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2401"></a>    <span class="k">ELSE</span>
<a name="ln-2402"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2403"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2404"></a>    <span class="k">END IF</span>
<a name="ln-2405"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2406"></a>  <span class="k">ELSE</span>
<a name="ln-2407"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-2408"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2409"></a>
<a name="ln-2410"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2411"></a>
<a name="ln-2412"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2413"></a>
<a name="ln-2414"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2415"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2416"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2417"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2418"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2419"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2420"></a>    <span class="k">END SELECT</span>
<a name="ln-2421"></a><span class="k">  END IF</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2424"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2425"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2426"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2427"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2428"></a>    <span class="k">ELSE</span>
<a name="ln-2429"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2430"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2431"></a>    <span class="k">END IF</span>
<a name="ln-2432"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2433"></a>  <span class="k">ELSE</span>
<a name="ln-2434"></a>    <span class="c">! only legal types are Quadratic, Biquadratic and Cubic</span>
<a name="ln-2435"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2436"></a>
<a name="ln-2437"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2438"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Quadratic</span>
<a name="ln-2439"></a>
<a name="ln-2440"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2441"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2442"></a>
<a name="ln-2443"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2444"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Cubic</span>
<a name="ln-2445"></a>
<a name="ln-2446"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2447"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2448"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2449"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2450"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic, Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2451"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2452"></a>    <span class="k">END SELECT</span>
<a name="ln-2453"></a><span class="k">  END IF</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2456"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2457"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2458"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2459"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2460"></a>    <span class="k">ELSE</span>
<a name="ln-2461"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2462"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2463"></a>    <span class="k">END IF</span>
<a name="ln-2464"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2465"></a>  <span class="k">ELSE</span>
<a name="ln-2466"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic or Cubic</span>
<a name="ln-2467"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2468"></a>
<a name="ln-2469"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2470"></a>
<a name="ln-2471"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2472"></a>
<a name="ln-2473"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2474"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2475"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2476"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2477"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2478"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2479"></a>    <span class="k">END SELECT</span>
<a name="ln-2480"></a><span class="k">  END IF</span>
<a name="ln-2481"></a>
<a name="ln-2482"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2483"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2484"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2485"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2486"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2487"></a>    <span class="k">ELSE</span>
<a name="ln-2488"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2489"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2490"></a>    <span class="k">END IF</span>
<a name="ln-2491"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2492"></a>  <span class="k">ELSE</span>
<a name="ln-2493"></a>    <span class="c">! Verify Curve Object, only legal types are Quadratic or Cubic</span>
<a name="ln-2494"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2495"></a>
<a name="ln-2496"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2499"></a>
<a name="ln-2500"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2501"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2502"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2503"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2504"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2505"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2506"></a>    <span class="k">END SELECT</span>
<a name="ln-2507"></a>
<a name="ln-2508"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2509"></a><span class="c">!     Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-2510"></a>      <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-2511"></a>      <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-2512"></a>      <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2513"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2514"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-2515"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2516"></a><span class="k">          </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-2517"></a>          <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-2518"></a>        <span class="k">END IF</span>
<a name="ln-2519"></a><span class="k">        IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2520"></a><span class="k">          </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-2521"></a>          <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-2522"></a>        <span class="k">END IF</span>
<a name="ln-2523"></a><span class="k">        </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-2524"></a>      <span class="k">END DO</span>
<a name="ln-2525"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2526"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2527"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-2528"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2529"></a>                        <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2530"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2531"></a>        <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-2532"></a>      <span class="k">END IF</span>
<a name="ln-2533"></a>
<a name="ln-2534"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2535"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2536"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-2537"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2538"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2539"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2540"></a>        <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2541"></a>      <span class="k">END IF</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a><span class="k">    END IF</span>
<a name="ln-2544"></a>
<a name="ln-2545"></a><span class="k">  END IF</span>
<a name="ln-2546"></a>
<a name="ln-2547"></a><span class="c">! Only required for reverse cycle heat pumps</span>
<a name="ln-2548"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2549"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2550"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2551"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2552"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2553"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2554"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...field is required because &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &quot;ReverseCycle&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2555"></a>      <span class="k">ELSE</span>
<a name="ln-2556"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2557"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2558"></a>      <span class="k">END IF</span>
<a name="ln-2559"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2560"></a>    <span class="k">ELSE</span>
<a name="ln-2561"></a>      <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-2562"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">))</span>
<a name="ln-2563"></a>
<a name="ln-2564"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2565"></a>
<a name="ln-2566"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2567"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2568"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2569"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">)))</span>
<a name="ln-2570"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2571"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2572"></a>      <span class="k">END SELECT</span>
<a name="ln-2573"></a><span class="k">    END IF</span>
<a name="ln-2574"></a><span class="k">  END IF</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">))</span>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">=</span> <span class="n">ReverseCycle</span>
<a name="ln-2577"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;Resistive&#39;</span><span class="p">))</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">=</span> <span class="n">Resistive</span>
<a name="ln-2578"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2579"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2580"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2581"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...valid values for this field are ReverseCycle or Resistive.&#39;</span><span class="p">)</span>
<a name="ln-2582"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2583"></a>  <span class="k">END IF</span>
<a name="ln-2584"></a>
<a name="ln-2585"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Timed&#39;</span><span class="p">))</span>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="o">=</span> <span class="n">Timed</span>
<a name="ln-2586"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;OnDemand&#39;</span><span class="p">))</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="o">=</span> <span class="n">OnDemand</span>
<a name="ln-2587"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2588"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2589"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2590"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...valid values for this field are Timed or OnDemand.&#39;</span><span class="p">)</span>
<a name="ln-2591"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2592"></a>  <span class="k">END IF</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2595"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2596"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2597"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2598"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2599"></a>
<a name="ln-2600"></a>  <span class="c">!Set minimum OAT for heat pump compressor operation</span>
<a name="ln-2601"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2606"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOnOffBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2607"></a>  <span class="k">ELSE</span>
<a name="ln-2608"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOnOffBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2609"></a>  <span class="n">ENDIF</span>
<a name="ln-2610"></a>
<a name="ln-2611"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2612"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>  <span class="c">!Set maximum outdoor temp for defrost to occur</span>
<a name="ln-2615"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2616"></a>
<a name="ln-2617"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-2618"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2619"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2620"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2621"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-2622"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2623"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2624"></a>  <span class="k">END IF</span>
<a name="ln-2625"></a>
<a name="ln-2626"></a>  <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-2627"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>  <span class="c">!Set defrost time period</span>
<a name="ln-2630"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2631"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2632"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-2633"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0 for defrost control = TIMED.&#39;</span><span class="p">)</span>
<a name="ln-2634"></a>  <span class="k">END IF</span>
<a name="ln-2635"></a>
<a name="ln-2636"></a>  <span class="c">!Set defrost capacity (for resistive defrost)</span>
<a name="ln-2637"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2638"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2639"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-2640"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0 for defrost strategy = RESISTIVE.&#39;</span><span class="p">)</span>
<a name="ln-2641"></a>  <span class="k">END IF</span>
<a name="ln-2642"></a>
<a name="ln-2643"></a>  <span class="c">!Set Region number for calculating HSPF</span>
<a name="ln-2644"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RegionNum</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2645"></a>
<a name="ln-2646"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2647"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RegionNum</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-2648"></a>  <span class="n">ENDIF</span>
<a name="ln-2649"></a>
<a name="ln-2650"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2651"></a>
<a name="ln-2652"></a>  <span class="c">!A13 is optional evaporator node name</span>
<a name="ln-2653"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2654"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2655"></a>  <span class="k">ELSE</span>
<a name="ln-2656"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2657"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2658"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2659"></a>     <span class="c">! warn if not an outdoor node, but allow</span>
<a name="ln-2660"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2661"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, may be invalid&#39;</span><span class="p">)</span>
<a name="ln-2662"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2663"></a>                               <span class="s1">&#39;&quot;, node does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-2664"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This node needs to be included in an air system or the coil model will not be valid&#39;</span> <span class="p">&amp;</span>
<a name="ln-2665"></a>                             <span class="o">//</span><span class="s1">&#39;, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2666"></a>    <span class="k">END IF</span>
<a name="ln-2667"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-2668"></a>
<a name="ln-2669"></a><span class="k">END DO</span> <span class="c">! end of the DX heating coil loop</span>
<a name="ln-2670"></a>
<a name="ln-2671"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2672"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2673"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2674"></a><span class="k">END IF</span>
<a name="ln-2675"></a>
<a name="ln-2676"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span>
<a name="ln-2677"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumDXMulSpeedCoils</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2680"></a>
<a name="ln-2681"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2682"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2683"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-2684"></a>
<a name="ln-2685"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2686"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2687"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2688"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2689"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2690"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2691"></a>  <span class="n">ENDIF</span>
<a name="ln-2692"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2693"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2694"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2695"></a>  <span class="n">ENDIF</span>
<a name="ln-2696"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2697"></a><span class="c">! Initialize DataHeatBalance heat reclaim variable name for use by heat reclaim coils</span>
<a name="ln-2698"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-2699"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SourceType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-2700"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-2701"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_CoolingTwoSpeed</span>
<a name="ln-2702"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2703"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2704"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2705"></a>  <span class="k">ELSE</span>
<a name="ln-2706"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-2707"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2708"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2709"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2710"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2711"></a>    <span class="k">END IF</span>
<a name="ln-2712"></a><span class="k">  END IF</span>
<a name="ln-2713"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2714"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2715"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2716"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2717"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2718"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InternalStaticPressureDrop</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2719"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2720"></a>  <span class="k">ELSE</span>
<a name="ln-2721"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InternalStaticPressureDrop</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2722"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2723"></a>  <span class="n">ENDIF</span>
<a name="ln-2724"></a>
<a name="ln-2725"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2726"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2727"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2728"></a>
<a name="ln-2729"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2730"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2731"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2732"></a>
<a name="ln-2733"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-2734"></a>
<a name="ln-2735"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2736"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2737"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2738"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2739"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2740"></a>    <span class="k">ELSE</span>
<a name="ln-2741"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2742"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2743"></a>    <span class="k">END IF</span>
<a name="ln-2744"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2745"></a>  <span class="k">ELSE</span>
<a name="ln-2746"></a>    <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-2747"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2748"></a>
<a name="ln-2749"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2750"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2751"></a>
<a name="ln-2752"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2753"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2754"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2755"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2756"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2757"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2758"></a>    <span class="k">END SELECT</span>
<a name="ln-2759"></a><span class="k">  END IF</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2762"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2763"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2764"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2765"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2766"></a>    <span class="k">ELSE</span>
<a name="ln-2767"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2768"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2769"></a>    <span class="k">END IF</span>
<a name="ln-2770"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2771"></a>  <span class="k">ELSE</span>
<a name="ln-2772"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-2773"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2774"></a>
<a name="ln-2775"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2776"></a>
<a name="ln-2777"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2778"></a>
<a name="ln-2779"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2780"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2781"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2782"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2783"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2784"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2785"></a>    <span class="k">END SELECT</span>
<a name="ln-2786"></a><span class="k">  END IF</span>
<a name="ln-2787"></a>
<a name="ln-2788"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2789"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2790"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2791"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2792"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2793"></a>    <span class="k">ELSE</span>
<a name="ln-2794"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2795"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2796"></a>    <span class="k">END IF</span>
<a name="ln-2797"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2798"></a>  <span class="k">ELSE</span>
<a name="ln-2799"></a>    <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-2800"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2801"></a>
<a name="ln-2802"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2803"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2804"></a>
<a name="ln-2805"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2806"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2807"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2808"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2809"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2810"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2811"></a>    <span class="k">END SELECT</span>
<a name="ln-2812"></a><span class="k">  END IF</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2815"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2816"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2817"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2818"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2819"></a>    <span class="k">ELSE</span>
<a name="ln-2820"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2821"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2822"></a>    <span class="k">END IF</span>
<a name="ln-2823"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2824"></a>  <span class="k">ELSE</span>
<a name="ln-2825"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-2826"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2827"></a>
<a name="ln-2828"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2831"></a>
<a name="ln-2832"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2833"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2834"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2835"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2836"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2837"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2838"></a>    <span class="k">END SELECT</span>
<a name="ln-2839"></a><span class="k">  END IF</span>
<a name="ln-2840"></a>
<a name="ln-2841"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2842"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2843"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2844"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2845"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2846"></a>    <span class="k">ELSE</span>
<a name="ln-2847"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2848"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2849"></a>    <span class="k">END IF</span>
<a name="ln-2850"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2851"></a>  <span class="k">ELSE</span>
<a name="ln-2852"></a>    <span class="c">! Verify Curve Object, only legal types are Quadratic or Cubic</span>
<a name="ln-2853"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2854"></a>
<a name="ln-2855"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2856"></a>
<a name="ln-2857"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-2858"></a>
<a name="ln-2859"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2860"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2861"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2862"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-2863"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-2864"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2865"></a>    <span class="k">END SELECT</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2868"></a><span class="c">!     Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-2869"></a>      <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-2870"></a>      <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-2871"></a>      <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2872"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2873"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-2874"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2875"></a><span class="k">          </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-2876"></a>          <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-2877"></a>        <span class="k">END IF</span>
<a name="ln-2878"></a><span class="k">        IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2879"></a><span class="k">          </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-2880"></a>          <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-2881"></a>        <span class="k">END IF</span>
<a name="ln-2882"></a><span class="k">        </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-2883"></a>      <span class="k">END DO</span>
<a name="ln-2884"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2885"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2886"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-2887"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2888"></a>                        <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2889"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2890"></a>        <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-2891"></a>      <span class="k">END IF</span>
<a name="ln-2892"></a>
<a name="ln-2893"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2894"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2895"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-2896"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2897"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2898"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2899"></a>        <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2900"></a>      <span class="k">END IF</span>
<a name="ln-2901"></a>
<a name="ln-2902"></a><span class="k">    END IF</span>
<a name="ln-2903"></a>
<a name="ln-2904"></a><span class="k">  END IF</span>
<a name="ln-2905"></a>
<a name="ln-2906"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2907"></a>
<a name="ln-2908"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2909"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2910"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP2</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2911"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2912"></a>
<a name="ln-2913"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2914"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2915"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2916"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2917"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2918"></a>    <span class="k">ELSE</span>
<a name="ln-2919"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2920"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2921"></a>    <span class="k">END IF</span>
<a name="ln-2922"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2923"></a>  <span class="k">ELSE</span>
<a name="ln-2924"></a>    <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-2925"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">))</span>
<a name="ln-2926"></a>
<a name="ln-2927"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2928"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2929"></a>
<a name="ln-2930"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2931"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2932"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2933"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">)))</span>
<a name="ln-2934"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2935"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2936"></a>    <span class="k">END SELECT</span>
<a name="ln-2937"></a><span class="k">  END IF</span>
<a name="ln-2938"></a>
<a name="ln-2939"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-2940"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2941"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2942"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-2943"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-2944"></a>    <span class="k">ELSE</span>
<a name="ln-2945"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2946"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2947"></a>    <span class="k">END IF</span>
<a name="ln-2948"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2949"></a>  <span class="k">ELSE</span>
<a name="ln-2950"></a>    <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-2951"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span><span class="p">))</span>
<a name="ln-2952"></a>
<a name="ln-2953"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-2954"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-2955"></a>
<a name="ln-2956"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2957"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2958"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2959"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span><span class="p">)))</span>
<a name="ln-2960"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-2961"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2962"></a>    <span class="k">END SELECT</span>
<a name="ln-2963"></a><span class="k">  END IF</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a><span class="c">! outdoor condenser node</span>
<a name="ln-2966"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2967"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2968"></a>  <span class="k">ELSE</span>
<a name="ln-2969"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2970"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2971"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2972"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2973"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, may be invalid&#39;</span><span class="p">)</span>
<a name="ln-2974"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2975"></a>                               <span class="s1">&#39;&quot;, node does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-2976"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This node needs to be included in an air system or the coil model will not be valid&#39;</span> <span class="p">&amp;</span>
<a name="ln-2977"></a>                             <span class="o">//</span><span class="s1">&#39;, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2978"></a>    <span class="k">END IF</span>
<a name="ln-2979"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-2980"></a>
<a name="ln-2981"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2982"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">AirCooled</span>
<a name="ln-2983"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;EvaporativelyCooled&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2984"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCooled</span>
<a name="ln-2985"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2986"></a>  <span class="k">ELSE</span>
<a name="ln-2987"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2988"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2989"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...must be AirCooled or EvaporativelyCooled.&#39;</span><span class="p">)</span>
<a name="ln-2990"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2991"></a>  <span class="k">END IF</span>
<a name="ln-2992"></a>
<a name="ln-2993"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2994"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2995"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-2996"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0 or &gt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-2997"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2998"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2999"></a>  <span class="k">END IF</span>
<a name="ln-3000"></a>
<a name="ln-3001"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3002"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3003"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3004"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-3005"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3006"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3007"></a>  <span class="k">END IF</span>
<a name="ln-3008"></a>
<a name="ln-3009"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3010"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3011"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3012"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3013"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-3014"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3015"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3016"></a>  <span class="k">END IF</span>
<a name="ln-3017"></a>
<a name="ln-3018"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect2</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3019"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3020"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3021"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be cannot be &lt; 0.0 or &gt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-3022"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3023"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3024"></a>  <span class="k">END IF</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3027"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3028"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3029"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-3030"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3031"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3032"></a>  <span class="k">END IF</span>
<a name="ln-3033"></a>
<a name="ln-3034"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-3035"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3036"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3037"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-3038"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3039"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3040"></a>  <span class="k">END IF</span>
<a name="ln-3041"></a>
<a name="ln-3042"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR2</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP2</span>
<a name="ln-3043"></a>
<a name="ln-3044"></a>  <span class="c">! Get Water System tank connections</span>
<a name="ln-3045"></a>  <span class="c">!  A14, \field Name of Water Storage Tank for Supply</span>
<a name="ln-3046"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3047"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3048"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromMains</span>
<a name="ln-3049"></a>  <span class="k">ELSE</span>
<a name="ln-3050"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromTank</span>
<a name="ln-3051"></a>    <span class="k">CALL </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3052"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3053"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span> <span class="p">)</span>
<a name="ln-3054"></a>  <span class="n">ENDIF</span>
<a name="ln-3055"></a>
<a name="ln-3056"></a>  <span class="c">!A15; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-3057"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-3058"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3059"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-3060"></a>  <span class="k">ELSE</span>
<a name="ln-3061"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-3062"></a>    <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3063"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3064"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-3065"></a>  <span class="n">ENDIF</span>
<a name="ln-3066"></a>
<a name="ln-3067"></a>  <span class="c">! Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-3068"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-3069"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3070"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3071"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0.&#39;</span><span class="p">)</span>
<a name="ln-3072"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3073"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3074"></a>  <span class="k">END IF</span>
<a name="ln-3075"></a>
<a name="ln-3076"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-3077"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3078"></a><span class="k">    IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">17</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3079"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-3080"></a>    <span class="n">ENDIF</span>
<a name="ln-3081"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3082"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, freeze possible&#39;</span><span class="p">)</span>
<a name="ln-3083"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &lt; 2 {C}. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-3084"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3085"></a>    <span class="k">END IF</span>
<a name="ln-3086"></a><span class="k">  END IF</span>
<a name="ln-3087"></a>
<a name="ln-3088"></a><span class="k">  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3089"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<a name="ln-3090"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3091"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3092"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3093"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Basin heater will be available to operate throughout the simulation.&#39;</span><span class="p">)</span>
<a name="ln-3094"></a>    <span class="k">END IF</span>
<a name="ln-3095"></a><span class="k">  END IF</span>
<a name="ln-3096"></a>
<a name="ln-3097"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3098"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-3099"></a>    <span class="c">!DXCoil(DXCoilNum)%SHRFTemp2 = DXCoil(DXCoilNum)%SHRFTemp(1)</span>
<a name="ln-3100"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3101"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3102"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3103"></a>    <span class="k">ELSE</span>
<a name="ln-3104"></a>     <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-3105"></a>     <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3106"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3107"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTempCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-3108"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTempCurveType2</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTempCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3109"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3110"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3111"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3112"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-3113"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic.&#39;</span><span class="p">)</span>
<a name="ln-3114"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3115"></a>     <span class="k">END SELECT</span>
<a name="ln-3116"></a><span class="k">    END IF</span>
<a name="ln-3117"></a><span class="k">  END IF</span>
<a name="ln-3118"></a>
<a name="ln-3119"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3120"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-3121"></a>    <span class="c">!DXCoil(DXCoilNum)%SHRFFlow2 = DXCoil(DXCoilNum)%SHRFFlow(1)</span>
<a name="ln-3122"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3123"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3124"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3125"></a>    <span class="k">ELSE</span>
<a name="ln-3126"></a>     <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-3127"></a>     <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3128"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3129"></a>
<a name="ln-3130"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3131"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3132"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3133"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-3134"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be quadratic or cubic.&#39;</span><span class="p">)</span>
<a name="ln-3135"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3136"></a>     <span class="k">END SELECT</span>
<a name="ln-3137"></a><span class="k">    END IF</span>
<a name="ln-3138"></a><span class="k">  END IF</span>
<a name="ln-3139"></a>
<a name="ln-3140"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3141"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-3142"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3143"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3144"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3145"></a>    <span class="k">ELSE</span>
<a name="ln-3146"></a>     <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-3147"></a>     <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span><span class="p">))</span>
<a name="ln-3148"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3149"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTempCurveType2</span><span class="o">=</span><span class="n">Biquadratic</span>
<a name="ln-3150"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3151"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3152"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3153"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span><span class="p">)))</span>
<a name="ln-3154"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Biquadratic.&#39;</span><span class="p">)</span>
<a name="ln-3155"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3156"></a>     <span class="k">END SELECT</span>
<a name="ln-3157"></a><span class="k">    END IF</span>
<a name="ln-3158"></a><span class="k">  END IF</span>
<a name="ln-3159"></a>
<a name="ln-3160"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3161"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow2</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>  <span class="c">! convert curve name to number</span>
<a name="ln-3162"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3163"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3164"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3165"></a>    <span class="k">ELSE</span>
<a name="ln-3166"></a>     <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-3167"></a>     <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow2</span><span class="p">))</span>
<a name="ln-3168"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3169"></a>
<a name="ln-3170"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3171"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3172"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3173"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow2</span><span class="p">)))</span>
<a name="ln-3174"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be quadratic or cubic.&#39;</span><span class="p">)</span>
<a name="ln-3175"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3176"></a>     <span class="k">END SELECT</span>
<a name="ln-3177"></a><span class="k">    END IF</span>
<a name="ln-3178"></a><span class="k">  END IF</span>
<a name="ln-3179"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3180"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3181"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3182"></a>  <span class="k">ELSE</span>
<a name="ln-3183"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3184"></a>  <span class="n">ENDIF</span>
<a name="ln-3185"></a><span class="k">END DO</span>
<a name="ln-3186"></a>
<a name="ln-3187"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3188"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3189"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-3190"></a><span class="k">END IF</span>
<a name="ln-3191"></a>
<a name="ln-3192"></a><span class="c">! Loop over the DX Water Heater Coils and get &amp; load the data</span>
<a name="ln-3193"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:WaterHeating:AirToWaterHeatPump&#39;</span>
<a name="ln-3194"></a><span class="k">DO </span><span class="n">DXHPWaterHeaterCoilNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span>
<a name="ln-3195"></a>
<a name="ln-3196"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXHPWaterHeaterCoilNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3197"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3198"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-3199"></a>
<a name="ln-3200"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3201"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3202"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3203"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3204"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3205"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3206"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3207"></a>  <span class="n">ENDIF</span>
<a name="ln-3208"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3209"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3210"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3211"></a>  <span class="n">ENDIF</span>
<a name="ln-3212"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3213"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-3214"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_HeatPumpWaterHeater</span>
<a name="ln-3215"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! heat pump water heater DX coil has no schedule</span>
<a name="ln-3216"></a>
<a name="ln-3217"></a><span class="c">! Store the HPWH DX coil heating capacity in RatedTotCap2. After backing off pump and fan heat,</span>
<a name="ln-3218"></a><span class="c">! move to RatedTotCap() for use by DX coil</span>
<a name="ln-3219"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>                <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3220"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3221"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3222"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3223"></a>        <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3224"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3225"></a>  <span class="k">END IF</span>
<a name="ln-3226"></a>
<a name="ln-3227"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3228"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3229"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3230"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3231"></a>        <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3232"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3233"></a>  <span class="k">END IF</span>
<a name="ln-3234"></a>
<a name="ln-3235"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3236"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3237"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3238"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0 and &lt;= 1. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3239"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3240"></a>
<a name="ln-3241"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3242"></a>  <span class="k">END IF</span>
<a name="ln-3243"></a>
<a name="ln-3244"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span>         <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3245"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3246"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3247"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 5 {C}. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3248"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3249"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3250"></a>  <span class="k">END IF</span>
<a name="ln-3251"></a>
<a name="ln-3252"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWBTemp</span>         <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3253"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWBTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3254"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3255"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 5 {C}. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3256"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3257"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3258"></a>  <span class="k">END IF</span>
<a name="ln-3259"></a>
<a name="ln-3260"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWaterTemp</span>      <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3261"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWaterTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">2</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3262"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3263"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 25 {C}. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3264"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3265"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3266"></a>  <span class="k">END IF</span>
<a name="ln-3267"></a>
<a name="ln-3268"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3269"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3270"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3271"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3272"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3273"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3274"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3275"></a>    <span class="k">END IF</span>
<a name="ln-3276"></a><span class="k">  END IF</span>
<a name="ln-3277"></a>
<a name="ln-3278"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3279"></a><span class="c">! move to init</span>
<a name="ln-3280"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span> <span class="o">/=</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3281"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3282"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3283"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3284"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3285"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3286"></a>    <span class="k">END IF</span>
<a name="ln-3287"></a><span class="c">!   check the range of flow rate to be &gt;= 1 gpm/ton and &lt;= 5 gpm/ton</span>
<a name="ln-3288"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.79405d-8</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3289"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">8.97024d-8</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3290"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, outside range&#39;</span><span class="p">)</span>
<a name="ln-3291"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; per watt of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3292"></a>         <span class="s1">&#39; is outside the recommended range of &gt;= 1.79405E-8 m3/s/W (0.083 gpm/MBH) and &lt;= 8.97024E-8 m3/s/W (0.417 gpm/MBH).&#39;</span><span class="p">)</span>
<a name="ln-3293"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Entered Flow rate per watt = [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3294"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3295"></a>    <span class="k">END IF</span>
<a name="ln-3296"></a><span class="k">  END IF</span>
<a name="ln-3297"></a>
<a name="ln-3298"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3299"></a><span class="c">!  initialized to TRUE on allocate</span>
<a name="ln-3300"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanPowerIncludedInCOP</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3301"></a>  <span class="k">ELSE</span>
<a name="ln-3302"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3303"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3304"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-3305"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3306"></a>  <span class="k">END IF</span>
<a name="ln-3307"></a>
<a name="ln-3308"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3309"></a><span class="c">!  initialized to FALSE on allocate</span>
<a name="ln-3310"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondPumpPowerInCOP</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3311"></a>  <span class="k">ELSE</span>
<a name="ln-3312"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3313"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3314"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-3315"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3316"></a>  <span class="k">END IF</span>
<a name="ln-3317"></a>
<a name="ln-3318"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3319"></a><span class="c">!  initialized to FALSE on allocate</span>
<a name="ln-3320"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondPumpHeatInCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3321"></a>  <span class="k">ELSE</span>
<a name="ln-3322"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3323"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-3324"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-3325"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3326"></a>  <span class="k">END IF</span>
<a name="ln-3327"></a>
<a name="ln-3328"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3329"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3330"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3331"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3332"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3333"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3334"></a>  <span class="k">END IF</span>
<a name="ln-3335"></a>
<a name="ln-3336"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpFracToWater</span>     <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3337"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpFracToWater</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpFracToWater</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3338"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3339"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0 and &lt;= 1. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3340"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3341"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3342"></a>  <span class="k">END IF</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3345"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3346"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3347"></a>
<a name="ln-3348"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3349"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3350"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3351"></a>
<a name="ln-3352"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-3353"></a>
<a name="ln-3354"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3355"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3356"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3357"></a>
<a name="ln-3358"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3359"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3360"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3361"></a>
<a name="ln-3362"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-3363"></a>
<a name="ln-3364"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>     <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3365"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3366"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3367"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3368"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3369"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3370"></a>  <span class="k">END IF</span>
<a name="ln-3371"></a>
<a name="ln-3372"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span>       <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3373"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3374"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3375"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0 {C}. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3376"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3377"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3378"></a>  <span class="k">END IF</span>
<a name="ln-3379"></a>
<a name="ln-3380"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;DryBulbTemperature&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3381"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemperatureType</span> <span class="o">=</span> <span class="n">DryBulbIndicator</span>
<a name="ln-3382"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;WetBulbTemperature&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3383"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemperatureType</span> <span class="o">=</span> <span class="n">WetBulbIndicator</span>
<a name="ln-3384"></a>  <span class="k">ELSE</span>
<a name="ln-3385"></a><span class="c">!   wrong temperature type selection</span>
<a name="ln-3386"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3387"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be DryBulbTemperature or WetBulbTemperature.&#39;</span><span class="p">)</span>
<a name="ln-3388"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3389"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3390"></a>  <span class="k">END IF</span>
<a name="ln-3391"></a>
<a name="ln-3392"></a><span class="c">! set rated inlet air temperature for curve object verification</span>
<a name="ln-3393"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemperatureType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">WetBulbIndicator</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3394"></a><span class="k">    </span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWBTemp</span>
<a name="ln-3395"></a>  <span class="k">ELSE</span>
<a name="ln-3396"></a><span class="k">    </span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span>
<a name="ln-3397"></a>  <span class="k">END IF</span>
<a name="ln-3398"></a><span class="c">! set rated water temperature for curve object verification</span>
<a name="ln-3399"></a>  <span class="n">InletWaterTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWaterTemp</span>
<a name="ln-3400"></a>
<a name="ln-3401"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3402"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-3403"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3404"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3405"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3406"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3407"></a>    <span class="k">ELSE</span>
<a name="ln-3408"></a>      <span class="c">! Verify Curve Object, only legal types are BiQuadratic or Cubic</span>
<a name="ln-3409"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span><span class="p">))</span>
<a name="ln-3410"></a>
<a name="ln-3411"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3412"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTempCurveType</span> <span class="o">=</span> <span class="n">Biquadratic</span>
<a name="ln-3413"></a>        <span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-3414"></a>
<a name="ln-3415"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3416"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTempCurveType</span> <span class="o">=</span> <span class="n">Cubic</span>
<a name="ln-3417"></a>        <span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">)</span>
<a name="ln-3418"></a>
<a name="ln-3419"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3420"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3421"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span><span class="p">)))</span>
<a name="ln-3423"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3424"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3425"></a>        <span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3426"></a>      <span class="k">END SELECT</span>
<a name="ln-3427"></a>
<a name="ln-3428"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatCapFTemp</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3429"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3430"></a>        <span class="c">! could remove name from the field for output</span>
<a name="ln-3431"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized to 1.0 at the rating point.&#39;</span><span class="p">)</span>
<a name="ln-3432"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at the rating point = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCapFTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3433"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-3434"></a>      <span class="k">END IF</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a><span class="k">    END IF</span>
<a name="ln-3437"></a><span class="k">  END IF</span>
<a name="ln-3438"></a>
<a name="ln-3439"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3440"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-3441"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3442"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3443"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3444"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3445"></a>    <span class="k">ELSE</span>
<a name="ln-3446"></a>      <span class="c">! Verify Curve Object, only legal types are Cubic or Quadratic</span>
<a name="ln-3447"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span><span class="p">))</span>
<a name="ln-3448"></a>
<a name="ln-3449"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3450"></a>        <span class="n">HeatCapFAirFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3451"></a>
<a name="ln-3452"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3453"></a>        <span class="n">HeatCapFAirFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3454"></a>
<a name="ln-3455"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3456"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3457"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3458"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span><span class="p">)))</span>
<a name="ln-3459"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3460"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3461"></a>        <span class="n">HeatCapFAirFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3462"></a>      <span class="k">END SELECT</span>
<a name="ln-3463"></a>
<a name="ln-3464"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatCapFAirFlow</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3465"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3466"></a>        <span class="c">! could remove name from the field for output</span>
<a name="ln-3467"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized to 1.0 at the rating point.&#39;</span><span class="p">)</span>
<a name="ln-3468"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at an air flow fraction of 1 = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3469"></a>                               <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCapFAirFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3470"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-3471"></a>      <span class="k">END IF</span>
<a name="ln-3472"></a>
<a name="ln-3473"></a><span class="k">    END IF</span>
<a name="ln-3474"></a><span class="k">  END IF</span>
<a name="ln-3475"></a>
<a name="ln-3476"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3477"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-3478"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3479"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3480"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3481"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3482"></a>    <span class="k">ELSE</span>
<a name="ln-3483"></a>      <span class="c">! Verify Curve Object, only legal types are Cubic or Quadratic</span>
<a name="ln-3484"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span><span class="p">))</span>
<a name="ln-3485"></a>
<a name="ln-3486"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3487"></a>        <span class="n">HeatCapFWaterFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3488"></a>
<a name="ln-3489"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3490"></a>        <span class="n">HeatCapFWaterFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3491"></a>
<a name="ln-3492"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3493"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3494"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3495"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span><span class="p">)))</span>
<a name="ln-3496"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3497"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3498"></a>        <span class="n">HeatCapFWaterFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3499"></a>      <span class="k">END SELECT</span>
<a name="ln-3500"></a>
<a name="ln-3501"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatCapFWaterFlow</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3502"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3503"></a>        <span class="c">! could remove name from the field for output</span>
<a name="ln-3504"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized to 1.0 at the rating point.&#39;</span><span class="p">)</span>
<a name="ln-3505"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at an air flow fraction of 1 = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3506"></a>                             <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCapFWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3507"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-3508"></a>      <span class="k">END IF</span>
<a name="ln-3509"></a>
<a name="ln-3510"></a><span class="k">    END IF</span>
<a name="ln-3511"></a><span class="k">  END IF</span>
<a name="ln-3512"></a>
<a name="ln-3513"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3514"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<a name="ln-3515"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3516"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3517"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3518"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3519"></a>    <span class="k">ELSE</span>
<a name="ln-3520"></a>      <span class="c">! Verify Curve Object, only legal types are BiQuadratic or Cubic</span>
<a name="ln-3521"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span><span class="p">))</span>
<a name="ln-3522"></a>
<a name="ln-3523"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3524"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTempCurveType</span> <span class="o">=</span> <span class="n">Biquadratic</span>
<a name="ln-3525"></a>        <span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-3526"></a>
<a name="ln-3527"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3528"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTempCurveType</span> <span class="o">=</span> <span class="n">Cubic</span>
<a name="ln-3529"></a>        <span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">)</span>
<a name="ln-3530"></a>
<a name="ln-3531"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3532"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3533"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3534"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span><span class="p">)))</span>
<a name="ln-3535"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3536"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3537"></a>        <span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3538"></a>      <span class="k">END SELECT</span>
<a name="ln-3539"></a>
<a name="ln-3540"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatCOPFTemp</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3541"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3542"></a>        <span class="c">! could remove name from the field for output</span>
<a name="ln-3543"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized to 1.0 at the rating point.&#39;</span><span class="p">)</span>
<a name="ln-3544"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at an air flow fraction of 1 = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3545"></a>                             <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCOPFTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3546"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-3547"></a>      <span class="k">END IF</span>
<a name="ln-3548"></a>
<a name="ln-3549"></a><span class="k">    END IF</span>
<a name="ln-3550"></a><span class="k">  END IF</span>
<a name="ln-3551"></a>
<a name="ln-3552"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3553"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<a name="ln-3554"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3555"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3556"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3557"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3558"></a>    <span class="k">ELSE</span>
<a name="ln-3559"></a>      <span class="c">! Verify Curve Object, only legal types are Cubic or Quadratic</span>
<a name="ln-3560"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span><span class="p">))</span>
<a name="ln-3561"></a>
<a name="ln-3562"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3563"></a>        <span class="n">HeatCOPFAirFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3564"></a>
<a name="ln-3565"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3566"></a>        <span class="n">HeatCOPFAirFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3567"></a>
<a name="ln-3568"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3569"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3570"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3571"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span><span class="p">)))</span>
<a name="ln-3572"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3573"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3574"></a>        <span class="n">HeatCOPFAirFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3575"></a>      <span class="k">END SELECT</span>
<a name="ln-3576"></a>
<a name="ln-3577"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatCOPFAirFlow</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3578"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3579"></a>        <span class="c">! could remove name from the field for output</span>
<a name="ln-3580"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized to 1.0 at the rating point.&#39;</span><span class="p">)</span>
<a name="ln-3581"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at an air flow fraction of 1 = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3582"></a>                                    <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCOPFAirFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3583"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-3584"></a>      <span class="k">END IF</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a><span class="k">    END IF</span>
<a name="ln-3587"></a><span class="k">  END IF</span>
<a name="ln-3588"></a>
<a name="ln-3589"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3590"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<a name="ln-3591"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3592"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3593"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3594"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3595"></a>    <span class="k">ELSE</span>
<a name="ln-3596"></a>      <span class="c">! Verify Curve Object, only legal types are Cubic or Quadratic</span>
<a name="ln-3597"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span><span class="p">))</span>
<a name="ln-3598"></a>
<a name="ln-3599"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3600"></a>        <span class="n">HeatCOPFWaterFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3601"></a>
<a name="ln-3602"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3603"></a>        <span class="n">HeatCOPFWaterFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3604"></a>
<a name="ln-3605"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3606"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3607"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3608"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span><span class="p">)))</span>
<a name="ln-3609"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3610"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3611"></a>        <span class="n">HeatCOPFWaterFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3612"></a>      <span class="k">END SELECT</span>
<a name="ln-3613"></a>
<a name="ln-3614"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatCOPFWaterFlow</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3615"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3616"></a>        <span class="c">! could remove name from the field for output</span>
<a name="ln-3617"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized to 1.0 at the rating point.&#39;</span><span class="p">)</span>
<a name="ln-3618"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at a water flow fraction of 1 = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3619"></a>                               <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCOPFWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3620"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-3621"></a>      <span class="k">END IF</span>
<a name="ln-3622"></a>
<a name="ln-3623"></a><span class="k">    END IF</span>
<a name="ln-3624"></a><span class="k">  END IF</span>
<a name="ln-3625"></a>
<a name="ln-3626"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3627"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<a name="ln-3628"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3629"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3630"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3631"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3632"></a>    <span class="k">ELSE</span>
<a name="ln-3633"></a>      <span class="c">! Verify Curve Object, only legal types are Cubic or Quadratic</span>
<a name="ln-3634"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3635"></a>
<a name="ln-3636"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3637"></a>
<a name="ln-3638"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3639"></a>
<a name="ln-3640"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3641"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3642"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3643"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-3644"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-3645"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3646"></a>      <span class="k">END SELECT</span>
<a name="ln-3647"></a>
<a name="ln-3648"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3649"></a><span class="c">!       Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-3650"></a>        <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3651"></a>        <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3652"></a>        <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3653"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3654"></a>          <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-3655"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3656"></a><span class="k">            </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-3657"></a>            <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-3658"></a>          <span class="k">END IF</span>
<a name="ln-3659"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3660"></a><span class="k">            </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-3661"></a>            <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-3662"></a>          <span class="k">END IF</span>
<a name="ln-3663"></a><span class="k">          </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-3664"></a>        <span class="k">END DO</span>
<a name="ln-3665"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3666"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3667"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-3668"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3669"></a>                        <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3670"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3671"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-3672"></a>        <span class="k">END IF</span>
<a name="ln-3673"></a>
<a name="ln-3674"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3675"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3676"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-3677"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3678"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3679"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3680"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3681"></a>        <span class="k">END IF</span>
<a name="ln-3682"></a>
<a name="ln-3683"></a><span class="k">      END IF</span>
<a name="ln-3684"></a>
<a name="ln-3685"></a><span class="k">    END IF</span>
<a name="ln-3686"></a><span class="k">  END IF</span>
<a name="ln-3687"></a>
<a name="ln-3688"></a><span class="c">! assume compressor resides at the inlet to the DX Coil</span>
<a name="ln-3689"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-3690"></a>
<a name="ln-3691"></a><span class="c">! set condenser type as HPWH</span>
<a name="ln-3692"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterHeater</span>
<a name="ln-3693"></a>
<a name="ln-3694"></a><span class="k">END DO</span> <span class="c">! end of the DX water heater coil loop</span>
<a name="ln-3695"></a>
<a name="ln-3696"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3697"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3698"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-3699"></a><span class="k">END IF</span>
<a name="ln-3700"></a>
<a name="ln-3701"></a><span class="c">! DX Multispeed cooling coil</span>
<a name="ln-3702"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span>
<a name="ln-3703"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumDXMulSpeedCoolCoils</span>
<a name="ln-3704"></a>
<a name="ln-3705"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3706"></a>
<a name="ln-3707"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3708"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3709"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-3710"></a>
<a name="ln-3711"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3712"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3713"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3714"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3715"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3716"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3717"></a>  <span class="n">ENDIF</span>
<a name="ln-3718"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3719"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3720"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3721"></a>  <span class="n">ENDIF</span>
<a name="ln-3722"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3723"></a><span class="c">! Initialize DataHeatBalance heat reclaim variable name for use by heat reclaim coils</span>
<a name="ln-3724"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3725"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SourceType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-3726"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-3727"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_MultiSpeedCooling</span>
<a name="ln-3728"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3729"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3730"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3731"></a>  <span class="k">ELSE</span>
<a name="ln-3732"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-3733"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3734"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3735"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3736"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3737"></a>    <span class="k">END IF</span>
<a name="ln-3738"></a><span class="k">  END IF</span>
<a name="ln-3739"></a>
<a name="ln-3740"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3741"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3742"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3743"></a>
<a name="ln-3744"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3745"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3746"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3747"></a>
<a name="ln-3748"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-3749"></a>
<a name="ln-3750"></a><span class="c">! outdoor condenser node</span>
<a name="ln-3751"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3752"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3753"></a>  <span class="k">ELSE</span>
<a name="ln-3754"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3755"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3756"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3757"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3758"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, may be invalid&#39;</span><span class="p">)</span>
<a name="ln-3759"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3760"></a>                               <span class="s1">&#39;&quot;, node does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-3761"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This node needs to be included in an air system or the coil model will not be valid&#39;</span> <span class="p">&amp;</span>
<a name="ln-3762"></a>                             <span class="o">//</span><span class="s1">&#39;, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-3763"></a>    <span class="k">END IF</span>
<a name="ln-3764"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-3765"></a>
<a name="ln-3766"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3767"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">AirCooled</span>
<a name="ln-3768"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;EvaporativelyCooled&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3769"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCooled</span>
<a name="ln-3770"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3771"></a>  <span class="k">ELSE</span>
<a name="ln-3772"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3773"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3774"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...must be AirCooled or EvaporativelyCooled.&#39;</span><span class="p">)</span>
<a name="ln-3775"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3776"></a>  <span class="k">END IF</span>
<a name="ln-3777"></a>
<a name="ln-3778"></a>  <span class="c">! Get Water System tank connections</span>
<a name="ln-3779"></a>  <span class="c">!  A8, \field Name of Water Storage Tank for Supply</span>
<a name="ln-3780"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3781"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3782"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromMains</span>
<a name="ln-3783"></a>  <span class="k">ELSE</span>
<a name="ln-3784"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromTank</span>
<a name="ln-3785"></a>    <span class="k">CALL </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3786"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3787"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span> <span class="p">)</span>
<a name="ln-3788"></a>  <span class="k">END IF</span>
<a name="ln-3789"></a>
<a name="ln-3790"></a>  <span class="c">!A9; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-3791"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3792"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3793"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-3794"></a>  <span class="k">ELSE</span>
<a name="ln-3795"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-3796"></a>    <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3797"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3798"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-3799"></a>  <span class="k">END IF</span>
<a name="ln-3800"></a>
<a name="ln-3801"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-3802"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3803"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3804"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3805"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-3806"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3807"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3808"></a>  <span class="k">END IF</span>
<a name="ln-3809"></a>
<a name="ln-3810"></a>  <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-3811"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3812"></a>
<a name="ln-3813"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3814"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3815"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3816"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3817"></a>  <span class="k">ELSE</span>
<a name="ln-3818"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3819"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-3820"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The allowed choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-3821"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3822"></a>  <span class="k">END IF</span>
<a name="ln-3823"></a>
<a name="ln-3824"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3825"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatentImpact</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3826"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3827"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatentImpact</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3828"></a>  <span class="k">ELSE</span>
<a name="ln-3829"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3830"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-3831"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The allowed choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-3832"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3833"></a>  <span class="k">END IF</span>
<a name="ln-3834"></a>
<a name="ln-3835"></a>  <span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-3836"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3837"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3838"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3839"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3840"></a>                <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3841"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3842"></a>  <span class="k">END IF</span>
<a name="ln-3843"></a>
<a name="ln-3844"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3845"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3846"></a><span class="k">    IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3847"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-3848"></a>    <span class="n">ENDIF</span>
<a name="ln-3849"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3850"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, freeze possible&#39;</span><span class="p">)</span>
<a name="ln-3851"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is less than 2 {C}. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-3852"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3853"></a>    <span class="k">END IF</span>
<a name="ln-3854"></a><span class="k">  END IF</span>
<a name="ln-3855"></a>
<a name="ln-3856"></a><span class="k">  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3857"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-3858"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3859"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3860"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3861"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Basin heater will be available to operate throughout the simulation.&#39;</span><span class="p">)</span>
<a name="ln-3862"></a>    <span class="k">END IF</span>
<a name="ln-3863"></a><span class="k">  END IF</span>
<a name="ln-3864"></a>
<a name="ln-3865"></a>  <span class="c">!A12; \field Fuel type</span>
<a name="ln-3866"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Electricity&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3867"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeElectricity</span>
<a name="ln-3868"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3869"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeNaturalGas</span>
<a name="ln-3870"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;PropaneGas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3871"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypePropaneGas</span>
<a name="ln-3872"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Diesel&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3873"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeDiesel</span>
<a name="ln-3874"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Gasoline&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3875"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeGasoline</span>
<a name="ln-3876"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;FuelOil#1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3877"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeFuelOil1</span>
<a name="ln-3878"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;FuelOil#2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3879"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeFuelOil2</span>
<a name="ln-3880"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;OtherFuel1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3881"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeOtherFuel1</span>
<a name="ln-3882"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;OtherFuel2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3883"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeOtherFuel2</span>
<a name="ln-3884"></a>  <span class="k">ELSE</span>
<a name="ln-3885"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3886"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-3887"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Electricity, NaturalGas, PropaneGas, Diesel, Gasoline, FuelOil#1, FuelOil#2,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3888"></a>       <span class="s1">&#39;OtherFuel1 or OtherFuel2&#39;</span><span class="p">)</span>
<a name="ln-3889"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3890"></a>  <span class="k">END IF</span>
<a name="ln-3891"></a>
<a name="ln-3892"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Number of speeds</span>
<a name="ln-3893"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3894"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3895"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 2.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3896"></a>                                         <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-3897"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3898"></a>  <span class="k">End If</span>
<a name="ln-3899"></a>
<a name="ln-3900"></a>  <span class="c">! Allocate arrays based on the number of speeds</span>
<a name="ln-3901"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3902"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3903"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3904"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3905"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3906"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3907"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3908"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3909"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3910"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3911"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3912"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3913"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondEffect</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3914"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3915"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3916"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3917"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3918"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3919"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTwet_Rated</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3920"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSGamma_Rated</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3921"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSMaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3922"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSLatentCapacityTimeConstant</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3923"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSFanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-3924"></a>
<a name="ln-3925"></a>  <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-3926"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3927"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3928"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3929"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3930"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSFanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3931"></a>
<a name="ln-3932"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-3933"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3934"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3935"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-3936"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-3937"></a>      <span class="k">ELSE</span>
<a name="ln-3938"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3939"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3940"></a>      <span class="k">END IF</span>
<a name="ln-3941"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3942"></a>    <span class="k">ELSE</span>
<a name="ln-3943"></a>      <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-3944"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-3945"></a>
<a name="ln-3946"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3947"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span><span class="n">RatedOutdoorAirTemp</span><span class="p">)</span>
<a name="ln-3948"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3949"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-3950"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3951"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-3952"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3953"></a>        <span class="k">END IF</span>
<a name="ln-3954"></a>
<a name="ln-3955"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-3956"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3957"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3958"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-3959"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-3960"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3961"></a>      <span class="k">END SELECT</span>
<a name="ln-3962"></a><span class="k">    END IF</span>
<a name="ln-3963"></a>
<a name="ln-3964"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-3965"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3966"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3967"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-3968"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-3969"></a>      <span class="k">ELSE</span>
<a name="ln-3970"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3971"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3972"></a>      <span class="k">END IF</span>
<a name="ln-3973"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3974"></a>    <span class="k">ELSE</span>
<a name="ln-3975"></a>      <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-3976"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-3977"></a>
<a name="ln-3978"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-3979"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3980"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3981"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-3982"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3983"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-3984"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3985"></a>        <span class="k">END IF</span>
<a name="ln-3986"></a>
<a name="ln-3987"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-3988"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3989"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3990"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-3991"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3992"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-3993"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3994"></a>        <span class="k">END IF</span>
<a name="ln-3995"></a>
<a name="ln-3996"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-3997"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-3998"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3999"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4000"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4001"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4002"></a>      <span class="k">END SELECT</span>
<a name="ln-4003"></a><span class="k">    END IF</span>
<a name="ln-4004"></a>
<a name="ln-4005"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4006"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4007"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4008"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4009"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4010"></a>      <span class="k">ELSE</span>
<a name="ln-4011"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4012"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4013"></a>      <span class="k">END IF</span>
<a name="ln-4014"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4015"></a>    <span class="k">ELSE</span>
<a name="ln-4016"></a>      <span class="c">! Verify Curve Object, only legal type is Biquadratic</span>
<a name="ln-4017"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4018"></a>
<a name="ln-4019"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4020"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletWetbulbTemp</span><span class="p">,</span><span class="n">RatedOutdoorAirTemp</span><span class="p">)</span>
<a name="ln-4021"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4022"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4023"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4024"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4025"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4026"></a>        <span class="k">END IF</span>
<a name="ln-4027"></a>
<a name="ln-4028"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4029"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4030"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4031"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-4032"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-4033"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4034"></a>      <span class="k">END SELECT</span>
<a name="ln-4035"></a><span class="k">    END IF</span>
<a name="ln-4036"></a>
<a name="ln-4037"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4038"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4039"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4040"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4041"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4042"></a>      <span class="k">ELSE</span>
<a name="ln-4043"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4044"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4045"></a>      <span class="k">END IF</span>
<a name="ln-4046"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4047"></a>    <span class="k">ELSE</span>
<a name="ln-4048"></a>      <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-4049"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4050"></a>
<a name="ln-4051"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4052"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4053"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4054"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4055"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4056"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4057"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4058"></a>        <span class="k">END IF</span>
<a name="ln-4059"></a>
<a name="ln-4060"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4061"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4062"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4063"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4064"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4065"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4066"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4067"></a>        <span class="k">END IF</span>
<a name="ln-4068"></a>
<a name="ln-4069"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4070"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4071"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4072"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4073"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4074"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4075"></a>      <span class="k">END SELECT</span>
<a name="ln-4076"></a><span class="k">    END IF</span>
<a name="ln-4077"></a>
<a name="ln-4078"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4079"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4080"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4081"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4082"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4083"></a>      <span class="k">ELSE</span>
<a name="ln-4084"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4085"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4086"></a>      <span class="k">END IF</span>
<a name="ln-4087"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4088"></a>    <span class="k">ELSE</span>
<a name="ln-4089"></a>    <span class="c">! Verify Curve Object, only legal types are Quadratic or Cubic</span>
<a name="ln-4090"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4091"></a>
<a name="ln-4092"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4093"></a>
<a name="ln-4094"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4095"></a>
<a name="ln-4096"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4097"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4098"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4099"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4100"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4101"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4102"></a>      <span class="k">END SELECT</span>
<a name="ln-4103"></a>
<a name="ln-4104"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4105"></a><span class="c">!       Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-4106"></a>        <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-4107"></a>        <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-4108"></a>        <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4109"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4110"></a>          <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-4111"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4112"></a><span class="k">            </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-4113"></a>            <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-4114"></a>          <span class="k">END IF</span>
<a name="ln-4115"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4116"></a><span class="k">            </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-4117"></a>            <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-4118"></a>          <span class="k">END IF</span>
<a name="ln-4119"></a><span class="k">          </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-4120"></a>        <span class="k">END DO</span>
<a name="ln-4121"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4122"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4123"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4124"></a>             <span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-4125"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4126"></a>                   <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4127"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4128"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">PerfModeNum</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-4129"></a>        <span class="k">END IF</span>
<a name="ln-4130"></a>
<a name="ln-4131"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4132"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4133"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4134"></a>             <span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-4135"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4136"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4137"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4138"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4139"></a>        <span class="k">END IF</span>
<a name="ln-4140"></a>
<a name="ln-4141"></a><span class="k">      END IF</span>
<a name="ln-4142"></a>
<a name="ln-4143"></a><span class="k">    END IF</span>
<a name="ln-4144"></a>
<a name="ln-4145"></a>    <span class="c">! read data for latent degradation</span>
<a name="ln-4146"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTwet_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4147"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTwet_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4148"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4149"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4150"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTwet_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4151"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4152"></a>    <span class="k">END IF</span>
<a name="ln-4153"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSGamma_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4154"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSGamma_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4155"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4156"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4157"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSGamma_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4158"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4159"></a>    <span class="k">END IF</span>
<a name="ln-4160"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSMaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4161"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4162"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4163"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4164"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSMaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4165"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4166"></a>    <span class="k">END IF</span>
<a name="ln-4167"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSLatentCapacityTimeConstant</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4168"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4169"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4170"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4171"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSLatentCapacityTimeConstant</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4172"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4173"></a>    <span class="k">END IF</span>
<a name="ln-4174"></a>
<a name="ln-4175"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4176"></a>
<a name="ln-4177"></a>    <span class="c">! Read waste heat modifier curve name</span>
<a name="ln-4178"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4179"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4180"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4181"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4182"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4183"></a>      <span class="k">ELSE</span>
<a name="ln-4184"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4185"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4186"></a>      <span class="k">END IF</span>
<a name="ln-4187"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4188"></a>    <span class="k">ELSE</span>
<a name="ln-4189"></a>      <span class="c">! Verify Curve Object, only legal types are BiQuadratic</span>
<a name="ln-4190"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4191"></a>
<a name="ln-4192"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4193"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedOutdoorAirTemp</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">)</span>
<a name="ln-4194"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4195"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4196"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4197"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4198"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4199"></a>        <span class="k">END IF</span>
<a name="ln-4200"></a>
<a name="ln-4201"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4202"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4203"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4204"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4205"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-4206"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4207"></a>      <span class="k">END SELECT</span>
<a name="ln-4208"></a><span class="k">    END IF</span>
<a name="ln-4209"></a>
<a name="ln-4210"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondEffect</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4211"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondEffect</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondEffect</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4212"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4213"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0 or &gt; 1.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4214"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4215"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4216"></a>    <span class="k">END IF</span>
<a name="ln-4217"></a>
<a name="ln-4218"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4219"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4220"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4221"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4222"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4223"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4224"></a>    <span class="k">END IF</span>
<a name="ln-4225"></a>
<a name="ln-4226"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4227"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4228"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4229"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4230"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4231"></a>         <span class="s1">&#39;entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4232"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4233"></a>    <span class="k">END IF</span>
<a name="ln-4234"></a>
<a name="ln-4235"></a><span class="k">  END DO</span>
<a name="ln-4236"></a>
<a name="ln-4237"></a><span class="k">END DO</span>
<a name="ln-4238"></a>
<a name="ln-4239"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4240"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4241"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4242"></a><span class="k">END IF</span>
<a name="ln-4243"></a>
<a name="ln-4244"></a><span class="c">! DX multispeed heating coil</span>
<a name="ln-4245"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span>
<a name="ln-4246"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumDXMulSpeedHeatCoils</span>
<a name="ln-4247"></a>
<a name="ln-4248"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4249"></a>
<a name="ln-4250"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4251"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4252"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-4253"></a>
<a name="ln-4254"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4255"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4256"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4257"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4258"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4259"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4260"></a>  <span class="n">ENDIF</span>
<a name="ln-4261"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4262"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4263"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4264"></a>  <span class="n">ENDIF</span>
<a name="ln-4265"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4266"></a><span class="c">! Initialize DataHeatBalance heat reclaim variable name for use by heat reclaim coils</span>
<a name="ln-4267"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-4268"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SourceType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-4269"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-4270"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_MultiSpeedHeating</span>
<a name="ln-4271"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4272"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4273"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4274"></a>  <span class="k">ELSE</span>
<a name="ln-4275"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-4276"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4277"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4278"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4279"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4280"></a>    <span class="k">END IF</span>
<a name="ln-4281"></a><span class="k">  END IF</span>
<a name="ln-4282"></a>
<a name="ln-4283"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4284"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4285"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4286"></a>
<a name="ln-4287"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4288"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4289"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4290"></a>
<a name="ln-4291"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-4292"></a>
<a name="ln-4293"></a>  <span class="c">!Set minimum OAT for heat pump compressor operation</span>
<a name="ln-4294"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a>  <span class="c">! set Minimum Outdoor Dry-Bulb Temperature for Compressor Operation</span>
<a name="ln-4297"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4298"></a>  <span class="c">!</span>
<a name="ln-4299"></a>  <span class="c">!Set crankcase heater capacity</span>
<a name="ln-4300"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4301"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4302"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4303"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be &lt; 0.0,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4304"></a>        <span class="s1">&#39; entered value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4305"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4306"></a>  <span class="k">END IF</span>
<a name="ln-4307"></a>
<a name="ln-4308"></a>  <span class="c">!Set crankcase heater cutout temperature</span>
<a name="ln-4309"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4310"></a>
<a name="ln-4311"></a><span class="c">! Only required for reverse cycle heat pumps</span>
<a name="ln-4312"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4313"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4314"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4315"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4316"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4317"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4318"></a>      <span class="k">ELSE</span>
<a name="ln-4319"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4320"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4321"></a>      <span class="k">END IF</span>
<a name="ln-4322"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4323"></a>    <span class="k">ELSE</span>
<a name="ln-4324"></a>      <span class="c">! Verify Curve Object, only legal type is BiQuadratic</span>
<a name="ln-4325"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">))</span>
<a name="ln-4326"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4327"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">,</span><span class="n">RatedInletWetbulbTempHeat</span><span class="p">,</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4328"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4329"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4330"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4331"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4332"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4333"></a>        <span class="k">END IF</span>
<a name="ln-4334"></a>
<a name="ln-4335"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-4336"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4337"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4338"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">)))</span>
<a name="ln-4339"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-4340"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4341"></a>      <span class="k">END SELECT</span>
<a name="ln-4342"></a><span class="k">    END IF</span>
<a name="ln-4343"></a><span class="k">  END IF</span>
<a name="ln-4344"></a>
<a name="ln-4345"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">))</span>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">=</span> <span class="n">ReverseCycle</span>
<a name="ln-4346"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Resistive&#39;</span><span class="p">))</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">=</span> <span class="n">Resistive</span>
<a name="ln-4347"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4348"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4349"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4350"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...valid values for this field are ReverseCycle or Resistive.&#39;</span><span class="p">)</span>
<a name="ln-4351"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4352"></a>  <span class="k">END IF</span>
<a name="ln-4353"></a>
<a name="ln-4354"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;Timed&#39;</span><span class="p">))</span>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="o">=</span> <span class="n">Timed</span>
<a name="ln-4355"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;OnDemand&#39;</span><span class="p">))</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="o">=</span> <span class="n">OnDemand</span>
<a name="ln-4356"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4357"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4358"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4359"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...valid values for this field are Timed or OnDemand.&#39;</span><span class="p">)</span>
<a name="ln-4360"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4361"></a>  <span class="k">END IF</span>
<a name="ln-4362"></a>
<a name="ln-4363"></a>  <span class="c">!Set maximum outdoor temp for defrost to occur</span>
<a name="ln-4364"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4365"></a>
<a name="ln-4366"></a>  <span class="c">!Set defrost time period</span>
<a name="ln-4367"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4368"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4369"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-4370"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0 for defrost control = TIMED.&#39;</span><span class="p">)</span>
<a name="ln-4371"></a>  <span class="k">END IF</span>
<a name="ln-4372"></a>
<a name="ln-4373"></a>  <span class="c">!Set defrost capacity (for resistive defrost)</span>
<a name="ln-4374"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4375"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4376"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-4377"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0 for defrost strategy = RESISTIVE.&#39;</span><span class="p">)</span>
<a name="ln-4378"></a>  <span class="k">END IF</span>
<a name="ln-4379"></a>
<a name="ln-4380"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4381"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4382"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4383"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4384"></a>  <span class="k">ELSE</span>
<a name="ln-4385"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4386"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-4387"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The allowed choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-4388"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4389"></a>  <span class="k">END IF</span>
<a name="ln-4390"></a>
<a name="ln-4391"></a>  <span class="c">!A10; \field Fuel type</span>
<a name="ln-4392"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Electricity&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4393"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeElectricity</span>
<a name="ln-4394"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4395"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeNaturalGas</span>
<a name="ln-4396"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;PropaneGas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4397"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypePropaneGas</span>
<a name="ln-4398"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Diesel&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4399"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeDiesel</span>
<a name="ln-4400"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Gasoline&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4401"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeGasoline</span>
<a name="ln-4402"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;FuelOil#1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4403"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeFuelOil1</span>
<a name="ln-4404"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;FuelOil#2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4405"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeFuelOil2</span>
<a name="ln-4406"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;OtherFuel1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4407"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeOtherFuel1</span>
<a name="ln-4408"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;OtherFuel2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4409"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="n">FuelTypeOtherFuel2</span>
<a name="ln-4410"></a>  <span class="k">ELSE</span>
<a name="ln-4411"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4412"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;,,,invalid choice for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.  Entered choice = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-4413"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Electricity, NaturalGas, PropaneGas, Diesel, Gasoline, FuelOil#1, FuelOil#2,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4414"></a>       <span class="s1">&#39;OtherFuel1 or OtherFuel2&#39;</span><span class="p">)</span>
<a name="ln-4415"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4416"></a>  <span class="k">END IF</span>
<a name="ln-4417"></a>
<a name="ln-4418"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RegionNum</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>         <span class="c">! Region Number for HSPF Calc</span>
<a name="ln-4419"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>       <span class="c">! Number of speeds</span>
<a name="ln-4420"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4421"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4422"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 2.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4423"></a>                                         <span class="s1">&#39; entered number is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-4424"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4425"></a>  <span class="k">END IF</span>
<a name="ln-4426"></a>
<a name="ln-4427"></a>  <span class="c">! Allocate arrays based on the number of speeds</span>
<a name="ln-4428"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4429"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4430"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4431"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4432"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4433"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4434"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4435"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4436"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4437"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4438"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4439"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4440"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4441"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4442"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4443"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4444"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSFanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">))</span>
<a name="ln-4445"></a>
<a name="ln-4446"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4447"></a>
<a name="ln-4448"></a>  <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-4449"></a>
<a name="ln-4450"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4451"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4452"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4453"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSFanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4454"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4455"></a>
<a name="ln-4456"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4457"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4458"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4459"></a>                           <span class="s1">&#39;&quot; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4460"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4461"></a>    <span class="k">ELSE</span>
<a name="ln-4462"></a>      <span class="c">! only legal types are Quadratic, Biquadratic and Cubic</span>
<a name="ln-4463"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4464"></a>
<a name="ln-4465"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4466"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quadratic</span>
<a name="ln-4467"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4468"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4469"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4470"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4471"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4472"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4473"></a>        <span class="k">END IF</span>
<a name="ln-4474"></a>
<a name="ln-4475"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4476"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Biquadratic</span>
<a name="ln-4477"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4478"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4479"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4480"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4481"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4482"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4483"></a>        <span class="k">END IF</span>
<a name="ln-4484"></a>
<a name="ln-4485"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4486"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cubic</span>
<a name="ln-4487"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4488"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4489"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4490"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4491"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4492"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4493"></a>        <span class="k">END IF</span>
<a name="ln-4494"></a>
<a name="ln-4495"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4496"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4497"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4498"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4499"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic, Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4500"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4501"></a>      <span class="k">END SELECT</span>
<a name="ln-4502"></a><span class="k">    END IF</span>
<a name="ln-4503"></a>
<a name="ln-4504"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4505"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4506"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4507"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4508"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4509"></a>      <span class="k">ELSE</span>
<a name="ln-4510"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4511"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4512"></a>      <span class="k">END IF</span>
<a name="ln-4513"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4514"></a>    <span class="k">ELSE</span>
<a name="ln-4515"></a>      <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-4516"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4517"></a>
<a name="ln-4518"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4519"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4520"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4521"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4522"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4523"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4524"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4525"></a>        <span class="k">END IF</span>
<a name="ln-4526"></a>
<a name="ln-4527"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4528"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4529"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4530"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4531"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4532"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4533"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4534"></a>        <span class="k">END IF</span>
<a name="ln-4535"></a>
<a name="ln-4536"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4537"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4538"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4539"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4540"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4541"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4542"></a>      <span class="k">END SELECT</span>
<a name="ln-4543"></a><span class="k">    END IF</span>
<a name="ln-4544"></a>
<a name="ln-4545"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4546"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4547"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4548"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4549"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4550"></a>      <span class="k">ELSE</span>
<a name="ln-4551"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4552"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4553"></a>      <span class="k">END IF</span>
<a name="ln-4554"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4555"></a>    <span class="k">ELSE</span>
<a name="ln-4556"></a>      <span class="c">! only legal types are Quadratic, Biquadratic and Cubic</span>
<a name="ln-4557"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4558"></a>
<a name="ln-4559"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4560"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quadratic</span>
<a name="ln-4561"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4562"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4563"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4564"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4565"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4566"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4567"></a>        <span class="k">END IF</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4570"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">BiQuadratic</span>
<a name="ln-4571"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedInletAirTempHeat</span><span class="p">,</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4572"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4573"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4574"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4575"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4576"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4577"></a>        <span class="k">END IF</span>
<a name="ln-4578"></a>
<a name="ln-4579"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4580"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cubic</span>
<a name="ln-4581"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">)</span>
<a name="ln-4582"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4583"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4584"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4585"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4586"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4587"></a>        <span class="k">END IF</span>
<a name="ln-4588"></a>
<a name="ln-4589"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4590"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4591"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4592"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4593"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic, Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4594"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4595"></a>      <span class="k">END SELECT</span>
<a name="ln-4596"></a><span class="k">    END IF</span>
<a name="ln-4597"></a>
<a name="ln-4598"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4599"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4600"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4601"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4602"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4603"></a>      <span class="k">ELSE</span>
<a name="ln-4604"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4605"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4606"></a>      <span class="k">END IF</span>
<a name="ln-4607"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4608"></a>    <span class="k">ELSE</span>
<a name="ln-4609"></a>      <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-4610"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4611"></a>
<a name="ln-4612"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4613"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4614"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4615"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4616"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4617"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4618"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4619"></a>        <span class="k">END IF</span>
<a name="ln-4620"></a>
<a name="ln-4621"></a><span class="k">      CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4622"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4623"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4624"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4625"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4626"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4627"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4628"></a>        <span class="k">END IF</span>
<a name="ln-4629"></a>
<a name="ln-4630"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4631"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4632"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4633"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4634"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4635"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4636"></a>      <span class="k">END SELECT</span>
<a name="ln-4637"></a><span class="k">    END IF</span>
<a name="ln-4638"></a>
<a name="ln-4639"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4640"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4641"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4642"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4643"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4644"></a>      <span class="k">ELSE</span>
<a name="ln-4645"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4646"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4647"></a>      <span class="k">END IF</span>
<a name="ln-4648"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4649"></a>    <span class="k">ELSE</span>
<a name="ln-4650"></a>      <span class="c">! Verify Curve Object, only legal types are Quadratic or Cubic</span>
<a name="ln-4651"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4652"></a>
<a name="ln-4653"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4654"></a>
<a name="ln-4655"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4656"></a>
<a name="ln-4657"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4658"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4659"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4660"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4661"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4662"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4663"></a>      <span class="k">END SELECT</span>
<a name="ln-4664"></a>
<a name="ln-4665"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4666"></a><span class="c">!       Test PLF curve minimum and maximum. Cap if less than 0.7 or greater than 1.0.</span>
<a name="ln-4667"></a>        <span class="n">MinCurveVal</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-4668"></a>        <span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-4669"></a>        <span class="n">CurveInput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4670"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurveInput</span> <span class="o">&lt;=</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4671"></a>          <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">CurveInput</span><span class="p">)</span>
<a name="ln-4672"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4673"></a><span class="k">            </span><span class="n">MinCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-4674"></a>            <span class="n">MinCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-4675"></a>          <span class="k">END IF</span>
<a name="ln-4676"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCurveVal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4677"></a><span class="k">            </span><span class="n">MaxCurveVal</span> <span class="o">=</span> <span class="n">CurveVal</span>
<a name="ln-4678"></a>            <span class="n">MaxCurvePLR</span> <span class="o">=</span> <span class="n">CurveInput</span>
<a name="ln-4679"></a>          <span class="k">END IF</span>
<a name="ln-4680"></a><span class="k">          </span><span class="n">CurveInput</span><span class="o">=</span><span class="n">CurveInput</span><span class="o">+</span><span class="mf">0.01d0</span>
<a name="ln-4681"></a>        <span class="k">END DO</span>
<a name="ln-4682"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MinCurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.7d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4683"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4684"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-4685"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve minimum must be &gt;= 0.7, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4686"></a>                        <span class="s1">&#39;curve min at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4687"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve minimum to 0.7 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4688"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-4689"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMin</span><span class="o">=</span><span class="mf">0.7d0</span><span class="p">)</span>
<a name="ln-4690"></a>        <span class="k">END IF</span>
<a name="ln-4691"></a>
<a name="ln-4692"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MaxCurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4693"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4694"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; has out of range value.&#39;</span><span class="p">)</span>
<a name="ln-4695"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve maximum must be &lt;= 1.0, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4696"></a>                        <span class="s1">&#39;curve max at PLR = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurvePLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4697"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting curve maximum to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4698"></a>          <span class="k">CALL </span><span class="n">SetCurveOutputMinMaxValues</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurveMax</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4699"></a>        <span class="k">END IF</span>
<a name="ln-4700"></a>
<a name="ln-4701"></a><span class="k">      END IF</span>
<a name="ln-4702"></a>
<a name="ln-4703"></a><span class="k">    END IF</span>
<a name="ln-4704"></a>
<a name="ln-4705"></a>    <span class="c">! Read waste heat modifier curve name</span>
<a name="ln-4706"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4707"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4708"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4709"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4710"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4711"></a>      <span class="k">ELSE</span>
<a name="ln-4712"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4713"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4714"></a>      <span class="k">END IF</span>
<a name="ln-4715"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4716"></a>    <span class="k">ELSE</span>
<a name="ln-4717"></a>      <span class="c">! Verify Curve Object, only legal types are BiQuadratic</span>
<a name="ln-4718"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-4719"></a>
<a name="ln-4720"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4721"></a>        <span class="n">CurveVal</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">RatedOutdoorAirTempHeat</span><span class="p">,</span><span class="n">RatedInletAirTempHeat</span><span class="p">)</span>
<a name="ln-4722"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CurveVal</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurveVal</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.90d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4723"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, curve values&#39;</span><span class="p">)</span>
<a name="ln-4724"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output is not equal to 1.0 &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4725"></a>                                             <span class="s1">&#39;(+ or - 10%) at rated conditions.&#39;</span><span class="p">)</span>
<a name="ln-4726"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at rated conditions = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CurveVal</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4727"></a>        <span class="k">END IF</span>
<a name="ln-4728"></a>
<a name="ln-4729"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-4730"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4731"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4732"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span>
<a name="ln-4733"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-4734"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4735"></a>      <span class="k">END SELECT</span>
<a name="ln-4736"></a><span class="k">    END IF</span>
<a name="ln-4737"></a>
<a name="ln-4738"></a><span class="k">  END DO</span>
<a name="ln-4739"></a><span class="k">END DO</span>
<a name="ln-4740"></a>
<a name="ln-4741"></a><span class="c">! Loop over the VRF Cooling Coils and get &amp; load the data</span>
<a name="ln-4742"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoilVRF_Cooling</span><span class="p">)</span>
<a name="ln-4743"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVRFCoolingCoils</span>
<a name="ln-4744"></a>
<a name="ln-4745"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4746"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4747"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-4748"></a>
<a name="ln-4749"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4750"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4751"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4752"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4753"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4754"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4755"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4756"></a>  <span class="n">ENDIF</span>
<a name="ln-4757"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4758"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4759"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4760"></a>  <span class="n">ENDIF</span>
<a name="ln-4761"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4762"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-4763"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilVRF_Cooling</span>
<a name="ln-4764"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4765"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4766"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4767"></a>  <span class="k">ELSE</span>
<a name="ln-4768"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-4769"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4770"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4771"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4772"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4773"></a>    <span class="k">END IF</span>
<a name="ln-4774"></a><span class="k">  END IF</span>
<a name="ln-4775"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4776"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4777"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4778"></a>
<a name="ln-4779"></a>
<a name="ln-4780"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>     <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4781"></a>  <span class="c">! Verify Curve Object, only legal type is Linear, Quadratic, Cubic, or BiQuadratic</span>
<a name="ln-4782"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4783"></a>
<a name="ln-4784"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">)</span>
<a name="ln-4785"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Linear</span>
<a name="ln-4786"></a>
<a name="ln-4787"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4788"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quadratic</span>
<a name="ln-4789"></a>
<a name="ln-4790"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4791"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cubic</span>
<a name="ln-4792"></a>
<a name="ln-4793"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4794"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">BiQuadratic</span>
<a name="ln-4795"></a>
<a name="ln-4796"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4797"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4798"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4799"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-4800"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be Linear, Quadratic, Cubic, or BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-4801"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4802"></a>    <span class="k">END SELECT</span>
<a name="ln-4803"></a>
<a name="ln-4804"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4805"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4806"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4807"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4808"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4809"></a>    <span class="k">ELSE</span>
<a name="ln-4810"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4811"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4812"></a>    <span class="k">END IF</span>
<a name="ln-4813"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4814"></a>  <span class="k">ELSE</span>
<a name="ln-4815"></a>    <span class="c">! Verify Curve Object, only legal type is Linear, Quadratic or Cubic</span>
<a name="ln-4816"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4817"></a>
<a name="ln-4818"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4819"></a>
<a name="ln-4820"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4821"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4822"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4823"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-4824"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be Linear, Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4825"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4826"></a>    <span class="k">END SELECT</span>
<a name="ln-4827"></a><span class="k">  END IF</span>
<a name="ln-4828"></a>
<a name="ln-4829"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4830"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4831"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4832"></a>
<a name="ln-4833"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4834"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4835"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4836"></a>
<a name="ln-4837"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-4838"></a>
<a name="ln-4839"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4840"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4841"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-4842"></a>  <span class="k">ELSE</span>
<a name="ln-4843"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-4844"></a>    <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4845"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4846"></a>                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-4847"></a>  <span class="k">END IF</span>
<a name="ln-4848"></a>
<a name="ln-4849"></a><span class="k">END DO</span>
<a name="ln-4850"></a>
<a name="ln-4851"></a><span class="c">! Loop over the VRF Heating Coils and get &amp; load the data</span>
<a name="ln-4852"></a><span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;COIL:Heating:DX:VariableRefrigerantFlow&#39;</span>
<a name="ln-4853"></a><span class="k">DO </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVRFHeatingCoils</span>
<a name="ln-4854"></a>
<a name="ln-4855"></a>  <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4856"></a>                     <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4857"></a>                     <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-4858"></a>
<a name="ln-4859"></a>  <span class="n">DXCoilNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4860"></a>  <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4861"></a>  <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4862"></a>  <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DXCoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4863"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4864"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4865"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4866"></a>  <span class="n">ENDIF</span>
<a name="ln-4867"></a>  <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4868"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4869"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4870"></a>  <span class="n">ENDIF</span>
<a name="ln-4871"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4872"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-4873"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">=</span> <span class="n">CoilVRF_Heating</span>
<a name="ln-4874"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4875"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4876"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4877"></a>  <span class="k">ELSE</span>
<a name="ln-4878"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">! convert schedule name to pointer</span>
<a name="ln-4879"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4880"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4881"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4882"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4883"></a>    <span class="k">END IF</span>
<a name="ln-4884"></a><span class="k">  END IF</span>
<a name="ln-4885"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4886"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4887"></a>
<a name="ln-4888"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4889"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4890"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4891"></a>
<a name="ln-4892"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4893"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4894"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4895"></a>
<a name="ln-4896"></a>  <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-4897"></a>
<a name="ln-4898"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-4899"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4900"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4901"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4902"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4903"></a>    <span class="k">ELSE</span>
<a name="ln-4904"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4905"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4906"></a>    <span class="k">END IF</span>
<a name="ln-4907"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4908"></a>  <span class="k">ELSE</span>
<a name="ln-4909"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-4910"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4911"></a>
<a name="ln-4912"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">)</span>
<a name="ln-4913"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Linear</span>
<a name="ln-4914"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4915"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Quadratic</span>
<a name="ln-4916"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4917"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cubic</span>
<a name="ln-4918"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4919"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Biquadratic</span>
<a name="ln-4920"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4921"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4922"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4923"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-4924"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be Linear, Quadratic, Cubic or BiQuadratic.&#39;</span><span class="p">)</span>
<a name="ln-4925"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4926"></a>    <span class="k">END SELECT</span>
<a name="ln-4927"></a><span class="k">  END IF</span>
<a name="ln-4928"></a>
<a name="ln-4929"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-4930"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4931"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4932"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing&#39;</span><span class="p">)</span>
<a name="ln-4933"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-4934"></a>    <span class="k">ELSE</span>
<a name="ln-4935"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4936"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4937"></a>    <span class="k">END IF</span>
<a name="ln-4938"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4939"></a>  <span class="k">ELSE</span>
<a name="ln-4940"></a>    <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-4941"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4942"></a>
<a name="ln-4943"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4944"></a>
<a name="ln-4945"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4946"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-4947"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4948"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span>
<a name="ln-4949"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be linear, Quadratic or Cubic.&#39;</span><span class="p">)</span>
<a name="ln-4950"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4951"></a>    <span class="k">END SELECT</span>
<a name="ln-4952"></a><span class="k">  END IF</span>
<a name="ln-4953"></a>
<a name="ln-4954"></a><span class="k">END DO</span>
<a name="ln-4955"></a>
<a name="ln-4956"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4957"></a><span class="k">  CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4958"></a>                      <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4959"></a><span class="k">END IF</span>
<a name="ln-4960"></a>
<a name="ln-4961"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span>
<a name="ln-4962"></a>  <span class="c">! Setup Report Variables for Cooling Equipment</span>
<a name="ln-4963"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Cooling:DX:SingleSpeed/Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span>
<a name="ln-4964"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-4965"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4966"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-4967"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4968"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-4969"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-4970"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4971"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-4972"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4973"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-4974"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4975"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-4976"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4977"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-4978"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4979"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-4980"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4981"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-4982"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-4983"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4984"></a>
<a name="ln-4985"></a><span class="c">! do we report these even if no storage tank?</span>
<a name="ln-4986"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4987"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span><span class="p">,&amp;</span>
<a name="ln-4988"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4989"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume [m3]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span><span class="p">,&amp;</span>
<a name="ln-4990"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4991"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;OnSiteWater&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4992"></a>                           <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Condensate&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-4993"></a>  <span class="n">ENDIF</span>
<a name="ln-4994"></a>
<a name="ln-4995"></a><span class="c">! Moved to Init</span>
<a name="ln-4996"></a><span class="c">!  IF (DXCoil(DXCoilNum)%ReportCoolingCoilCrankcasePower) THEN</span>
<a name="ln-4997"></a><span class="c">!    CALL SetupOutputVariable(&#39;DX Cooling Coil Crankcase Heater Power [W]&#39;,DXCoil(DXCoilNum)%CrankcaseHeaterPower,&#39;System&#39;,&amp;</span>
<a name="ln-4998"></a><span class="c">!                             &#39;Average&#39;,DXCoil(DXCoilNum)%Name)</span>
<a name="ln-4999"></a><span class="c">!    CALL SetupOutputVariable(&#39;Cooling Coil Crankcase Heater Electric Energy [J]&#39;,DXCoil(DXCoilNum)%CrankcaseHeaterConsumption,&amp;</span>
<a name="ln-5000"></a><span class="c">!                             &#39;System&#39;,&#39;Sum&#39;,DXCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-5001"></a><span class="c">!                              ResourceTypeKey=&#39;Electric&#39;,EndUseKey=&#39;COOLING&#39;,GroupKey=&#39;System&#39;)</span>
<a name="ln-5002"></a><span class="c">!  END IF</span>
<a name="ln-5003"></a>
<a name="ln-5004"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5005"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condenser Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5006"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5007"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Water Volume [m3]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5008"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5009"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5010"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Mains Supply Water Volume [m3]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5011"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5012"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5013"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5014"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5015"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5016"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5017"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5018"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5019"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5020"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5021"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5022"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5023"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5024"></a>        <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5025"></a>    <span class="k">END IF</span>
<a name="ln-5026"></a><span class="k">  END IF</span>
<a name="ln-5027"></a>
<a name="ln-5028"></a><span class="k">END DO</span>
<a name="ln-5029"></a>
<a name="ln-5030"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span>
<a name="ln-5031"></a>  <span class="c">! Setup Report Variables for Cooling Equipment</span>
<a name="ln-5032"></a>  <span class="c">! CurrentModuleObject=&#39;Cooling:DX:TwoStageWithHumidityControlMode&#39;</span>
<a name="ln-5033"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Stage 2 Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilStg2RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-5034"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5035"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Dehumidification Mode []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DehumidificationMode</span><span class="p">,&amp;</span>
<a name="ln-5036"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5037"></a><span class="k">END DO</span>
<a name="ln-5038"></a>
<a name="ln-5039"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NumDXHeatingCoils</span><span class="o">+</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span>
<a name="ln-5040"></a>  <span class="c">! Setup Report Variables for Heating Equipment</span>
<a name="ln-5041"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Heating:DX:SingleSpeed&#39;</span>
<a name="ln-5042"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Total Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5043"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5044"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Total Heating Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5045"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5046"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5047"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5048"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5049"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5050"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5051"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5052"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5053"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5054"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-5055"></a>                           <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5056"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5057"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Crankcase Heater Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-5058"></a>                           <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5059"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Crankcase Heater Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span><span class="p">,&amp;</span>
<a name="ln-5060"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5061"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5062"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5063"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5064"></a><span class="k">END DO</span>
<a name="ln-5065"></a>
<a name="ln-5066"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span><span class="o">+</span><span class="n">NumDXHeatingCoils</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5067"></a>             <span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span><span class="o">+</span><span class="n">NumDXHeatingCoils</span><span class="o">+</span><span class="n">NumDXMulSpeedCoils</span>
<a name="ln-5068"></a>  <span class="c">! Setup Report Variables for Cooling Equipment</span>
<a name="ln-5069"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Cooling:DX:TwoSpeed&#39;</span>
<a name="ln-5070"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5071"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5072"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5073"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5074"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5075"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5076"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5077"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5078"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5079"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5080"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5081"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5082"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5083"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5084"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5085"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5086"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5087"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5088"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5089"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5090"></a>
<a name="ln-5091"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5092"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condenser Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5093"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5094"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Water Volume [m3]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5095"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5096"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5097"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Mains Supply Water Volume [m3]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5098"></a>                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5099"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5100"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5101"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5102"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5103"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5104"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5105"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5106"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5107"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5108"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5109"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5110"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5111"></a>        <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5112"></a>    <span class="k">END IF</span>
<a name="ln-5113"></a>
<a name="ln-5114"></a><span class="k">  END IF</span>
<a name="ln-5115"></a>
<a name="ln-5116"></a><span class="k">END DO</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span><span class="o">+</span><span class="n">NumDXHeatingCoils</span><span class="o">+</span><span class="n">NumDXMulSpeedCoils</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5119"></a>             <span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span><span class="o">+</span><span class="n">NumDXHeatingCoils</span><span class="o">+</span><span class="n">NumDXMulSpeedCoils</span><span class="o">+</span><span class="n">NumDXHeatPumpWaterHeaterCoils</span>
<a name="ln-5120"></a>  <span class="c">! Setup Report Variables for Cooling Equipment</span>
<a name="ln-5121"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:WaterHeating:AirToWaterHeatPump&#39;</span>
<a name="ln-5122"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5123"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5124"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5125"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="c">!, &amp;</span>
<a name="ln-5126"></a><span class="c">!                           ResourceTypeKey=&#39;ENERGYTRANSFER&#39;,EndUseKey=&#39;COOLING&#39;,GroupKey=&#39;Plant&#39;)</span>
<a name="ln-5127"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5128"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5129"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5130"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5131"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5132"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5133"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5134"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5135"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5136"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5137"></a>
<a name="ln-5138"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportCoolingCoilCrankcasePower</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5139"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Crankcase Heater Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-5140"></a>                             <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5141"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Crankcase Heater Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span><span class="p">,&amp;</span>
<a name="ln-5142"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5143"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-5144"></a>  <span class="k">END IF</span>
<a name="ln-5145"></a>
<a name="ln-5146"></a><span class="c">! new report variables for a HP water heater DX coil</span>
<a name="ln-5147"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Water Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5148"></a>                           <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5149"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Water Heating Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5150"></a>                           <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="c">!, &amp;</span>
<a name="ln-5151"></a><span class="c">!                           ResourceTypeKey=&#39;ENERGYTRANSFER&#39;,EndUseKey=&#39;HEATING&#39;,GroupKey=&#39;Plant&#39;)</span>
<a name="ln-5152"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Water Heating Electric Power [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5153"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecWaterHeatingPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5154"></a>                           <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5155"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Water Heating Electric Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5156"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecWaterHeatingConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5157"></a>                           <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5158"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-5159"></a><span class="k">END DO</span>
<a name="ln-5160"></a>
<a name="ln-5161"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5162"></a>   <span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="p">&amp;</span>
<a name="ln-5163"></a>             <span class="o">+</span> <span class="n">NumDXMulSpeedCoolCoils</span>
<a name="ln-5164"></a>  <span class="c">! Setup Report Variables for Cooling Equipment:</span>
<a name="ln-5165"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Cooling:DX:MultiSpeed&#39;</span>
<a name="ln-5166"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5167"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5168"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5169"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5170"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5171"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5172"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5173"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5174"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5175"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5176"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5177"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5178"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5179"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5180"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5181"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5182"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5183"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5184"></a>
<a name="ln-5185"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5186"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5187"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5188"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5189"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelConsumed</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5190"></a>       <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)),</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5191"></a>  <span class="k">END IF</span>
<a name="ln-5192"></a>
<a name="ln-5193"></a><span class="k">  CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5194"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5195"></a>
<a name="ln-5196"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ReportEvapCondVars</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5197"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condenser Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5198"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5199"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5200"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Water Volume [m3]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5201"></a>                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5202"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5203"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5204"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Mains Supply Water Volume [m3]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5205"></a>                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5206"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5207"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5208"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5209"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5210"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5211"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5212"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5213"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5214"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5215"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5216"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5217"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5218"></a>        <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5219"></a>    <span class="k">END IF</span>
<a name="ln-5220"></a><span class="k">  END IF</span>
<a name="ln-5221"></a>
<a name="ln-5222"></a><span class="k">END DO</span>
<a name="ln-5223"></a>
<a name="ln-5224"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5225"></a>             <span class="n">NumDXMulSpeedCoolCoils</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5226"></a>   <span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="p">&amp;</span>
<a name="ln-5227"></a>             <span class="o">+</span> <span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedHeatCoils</span>
<a name="ln-5228"></a>  <span class="c">! Setup Report Variables for Heating Equipment:</span>
<a name="ln-5229"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Heating:DX:MultiSpeed&#39;</span>
<a name="ln-5230"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Total Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5231"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5232"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Total Heating Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5233"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5234"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5235"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5236"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5237"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5238"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5239"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5240"></a>
<a name="ln-5241"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5242"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5243"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5244"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5245"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelConsumed</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5246"></a>       <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)),</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5247"></a>  <span class="k">END IF</span>
<a name="ln-5248"></a>
<a name="ln-5249"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ReverseCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5250"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5251"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5252"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5253"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5254"></a>         <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cValidOutputFuelTypes</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)),</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5255"></a>  <span class="k">ELSE</span>
<a name="ln-5256"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5257"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5258"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Defrost Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-5259"></a>                           <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5260"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5261"></a>  <span class="k">END IF</span>
<a name="ln-5262"></a>
<a name="ln-5263"></a><span class="k">  CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Crankcase Heater Electric Power [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,&amp;</span>
<a name="ln-5264"></a>                           <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5265"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Crankcase Heater Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span><span class="p">,&amp;</span>
<a name="ln-5266"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5267"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5268"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5269"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5270"></a>
<a name="ln-5271"></a><span class="k">END DO</span>
<a name="ln-5272"></a>
<a name="ln-5273"></a><span class="c">! VRF cooling coil report variables</span>
<a name="ln-5274"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5275"></a>             <span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedHeatCoils</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5276"></a>   <span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="p">&amp;</span>
<a name="ln-5277"></a>             <span class="o">+</span> <span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedHeatCoils</span> <span class="o">+</span> <span class="n">NumVRFCoolingCoils</span>
<a name="ln-5278"></a>  <span class="c">! Setup Report Variables for Cooling Equipment:</span>
<a name="ln-5279"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Cooling:DX:VariableRefrigerantFlow</span>
<a name="ln-5280"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5281"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5282"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5283"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5284"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5285"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5286"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5287"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5288"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5289"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5290"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5291"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5292"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5293"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5294"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5295"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5296"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span><span class="p">,&amp;</span>
<a name="ln-5297"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5298"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume [m3]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span><span class="p">,&amp;</span>
<a name="ln-5299"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5300"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;OnSiteWater&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5301"></a>                           <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Condensate&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5302"></a>  <span class="n">ENDIF</span>
<a name="ln-5303"></a><span class="k">END DO</span>
<a name="ln-5304"></a>
<a name="ln-5305"></a><span class="c">! VRF heating coil report variables</span>
<a name="ln-5306"></a><span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5307"></a>             <span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedHeatCoils</span> <span class="o">+</span> <span class="n">NumVRFCoolingCoils</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5308"></a>   <span class="n">NumDoe2DXCoils</span> <span class="o">+</span> <span class="n">NumDXHeatingCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedCoils</span> <span class="o">+</span> <span class="n">NumDXMulModeCoils</span> <span class="o">+</span> <span class="n">NumDXHeatPumpWaterHeaterCoils</span> <span class="p">&amp;</span>
<a name="ln-5309"></a>             <span class="o">+</span> <span class="n">NumDXMulSpeedCoolCoils</span> <span class="o">+</span> <span class="n">NumDXMulSpeedHeatCoils</span> <span class="o">+</span> <span class="n">NumVRFCoolingCoils</span> <span class="o">+</span> <span class="n">NumVRFHeatingCoils</span>
<a name="ln-5310"></a>  <span class="c">! Setup Report Variables for Heating Equipment:</span>
<a name="ln-5311"></a>  <span class="c">! CurrentModuleObject=&#39;Coil:Heating:DX:VariableRefrigerantFlow</span>
<a name="ln-5312"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Total Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5313"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5314"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Total Heating Energy [J]&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,&amp;</span>
<a name="ln-5315"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5316"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-5317"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Runtime Fraction []&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,&amp;</span>
<a name="ln-5318"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5319"></a><span class="k">END DO</span>
<a name="ln-5320"></a><span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5321"></a>  <span class="c">! setup EMS sizing actuators for single speed DX</span>
<a name="ln-5322"></a>  <span class="k">DO </span><span class="n">DXCoilNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumDOE2DXCoils</span>
<a name="ln-5323"></a>    <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5324"></a>                          <span class="s1">&#39;Autosized Rated Air Flow Rate&#39;</span> <span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5325"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRateEMSOverrideON</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-5326"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRateEMSOverrideValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5327"></a>
<a name="ln-5328"></a>    <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5329"></a>                          <span class="s1">&#39;Autosized Rated Sensible Heat Ratio&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W/W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5330"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHREMSOverrideOn</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-5331"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHREMSOverrideValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5332"></a>
<a name="ln-5333"></a>    <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5334"></a>                          <span class="s1">&#39;Autosized Rated Total Cooling Capacity&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5335"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-5336"></a>                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5337"></a>  <span class="n">ENDDO</span>
<a name="ln-5338"></a>
<a name="ln-5339"></a><span class="n">ENDIF</span>
<a name="ln-5340"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">)</span>
<a name="ln-5341"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">)</span>
<a name="ln-5342"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-5343"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">)</span>
<a name="ln-5344"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-5345"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-5346"></a>
<a name="ln-5347"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Alphas2</span><span class="p">)</span>
<a name="ln-5348"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields2</span><span class="p">)</span>
<a name="ln-5349"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields2</span><span class="p">)</span>
<a name="ln-5350"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Numbers2</span><span class="p">)</span>
<a name="ln-5351"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks2</span><span class="p">)</span>
<a name="ln-5352"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks2</span><span class="p">)</span>
<a name="ln-5353"></a><span class="k">CALL </span><span class="n">ManageEMS</span><span class="p">(</span><span class="n">emsCallFromComponentGetInput</span><span class="p">)</span>
<a name="ln-5354"></a>
<a name="ln-5355"></a>
<a name="ln-5356"></a><span class="k">RETURN</span>
<a name="ln-5357"></a>
<a name="ln-5358"></a><span class="k">END SUBROUTINE </span><span class="n">GetDXCoils</span>
<a name="ln-5359"></a>
<a name="ln-5360"></a><span class="k">SUBROUTINE </span><span class="n">InitDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5363"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-5364"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-5365"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-5366"></a>          <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-5367"></a>          <span class="c">!                      July 2005 R. Raustad, FSEC</span>
<a name="ln-5368"></a>          <span class="c">!                        Add new coil type COIL:DX:HEATPUMPWATERHEATER</span>
<a name="ln-5369"></a>          <span class="c">!                      June 2007 L. Gu, FSEC</span>
<a name="ln-5370"></a>          <span class="c">!                        Add new coil type COIL:DX:MULTISPEED:COOLING and HEATING</span>
<a name="ln-5371"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5372"></a>
<a name="ln-5373"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5374"></a>          <span class="c">! This subroutine is for initializations of DX Coil Components.</span>
<a name="ln-5375"></a>
<a name="ln-5376"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5377"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-5378"></a>
<a name="ln-5379"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5380"></a>          <span class="c">! na</span>
<a name="ln-5381"></a>
<a name="ln-5382"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5383"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FanElecPower</span>
<a name="ln-5384"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopInputsFilled</span>
<a name="ln-5385"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-5386"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-5387"></a>
<a name="ln-5388"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5389"></a>
<a name="ln-5390"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5391"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span> <span class="c">! number of the current DX coil unit being simulated</span>
<a name="ln-5392"></a>
<a name="ln-5393"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SmallDifferenceTest</span><span class="o">=</span><span class="mf">0.00000001d0</span>
<a name="ln-5395"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;InitDXCoil&#39;</span>
<a name="ln-5396"></a>
<a name="ln-5397"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5398"></a>          <span class="c">! na</span>
<a name="ln-5399"></a>
<a name="ln-5400"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5401"></a>          <span class="c">! na</span>
<a name="ln-5402"></a>
<a name="ln-5403"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5404"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>  <span class="c">! One time environment flag</span>
<a name="ln-5405"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>   <span class="c">! One time sizing flag</span>
<a name="ln-5406"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>                  <span class="c">! One time flag used to allocate MyEnvrnFlag and MySizeFlag</span>
<a name="ln-5407"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CrankcaseHeaterReportVarFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! One time flag used to report crankcase heater power for non-HP coils</span>
<a name="ln-5408"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHeatPumpIndoorAirTemp</span> <span class="c">! Indoor dry-bulb temperature to heat pump evaporator at rated conditions [C]</span>
<a name="ln-5409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHeatPumpIndoorHumRat</span>  <span class="c">! Inlet humidity ratio to heat pump evaporator at rated conditions [kgWater/kgDryAir]</span>
<a name="ln-5410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="c">! Rated Air Volume Flow Rate divided by Rated Total Capacity [m3/s-W)</span>
<a name="ln-5411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPInletAirHumRat</span>           <span class="c">! Rated inlet air humidity ratio for heat pump water heater [kgWater/kgDryAir]</span>
<a name="ln-5412"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>        <span class="c">! TRUE when errors found</span>
<a name="ln-5413"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CapacityStageNum</span>           <span class="c">! Loop index for 1,Number of capacity stages</span>
<a name="ln-5414"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DehumidModeNum</span>             <span class="c">! Loop index for 1,Number of enhanced dehumidification modes</span>
<a name="ln-5415"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Mode</span>                       <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-5416"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DXCoilNumTemp</span>              <span class="c">! Counter for crankcase heater report variable DO loop</span>
<a name="ln-5417"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirInletNode</span>               <span class="c">! Air inlet node number</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5420"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-5421"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-5422"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">))</span>
<a name="ln-5423"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5424"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5425"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5426"></a>
<a name="ln-5427"></a>  <span class="k">END IF</span>
<a name="ln-5428"></a>  <span class="c">! if &quot;ISHundredPercentDOASDXCoil&quot; =.true., then set coil as 100% DOAS dx coil</span>
<a name="ln-5429"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5430"></a><span class="k">      </span><span class="n">DXCT</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5431"></a>  <span class="k">ELSE</span>
<a name="ln-5432"></a><span class="k">      </span><span class="n">DXCT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5433"></a>  <span class="n">ENDIF</span>
<a name="ln-5434"></a>
<a name="ln-5435"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatPumpWaterHeater</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a><span class="k">    CALL </span><span class="n">SizeDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5438"></a>
<a name="ln-5439"></a>    <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>
<a name="ln-5440"></a>    <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5441"></a>        <span class="p">((</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5442"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5443"></a>                           <span class="s1">&#39;&quot;: Rated air volume flow rate per watt of rated total water &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5444"></a>                           <span class="s1">&#39;heating capacity is out of range.&#39;</span><span class="p">)</span>
<a name="ln-5445"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5446"></a>           <span class="s1">&#39;Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5447"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]. See Input-Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5448"></a>    <span class="k">END IF</span>
<a name="ln-5449"></a><span class="k">    </span><span class="n">HPInletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWBTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5450"></a>                       <span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5451"></a>    <span class="n">HPWHInletDBTemp</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span>
<a name="ln-5452"></a>    <span class="n">HPWHInletWBTemp</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletWBTemp</span>
<a name="ln-5453"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5454"></a>                       <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span><span class="p">,</span><span class="n">HPInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5455"></a><span class="c">!   get rated coil bypass factor excluding fan heat</span>
<a name="ln-5456"></a>    <span class="n">FanElecPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5457"></a><span class="c">!   call CalcHPWHDXCoil to determine DXCoil%RatedTotCap(1) for rated CBF calculation below</span>
<a name="ln-5458"></a>    <span class="k">CALL </span><span class="n">CalcHPWHDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-5459"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5460"></a><span class="k">      CALL </span><span class="n">SizeDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5461"></a>      <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5462"></a>    <span class="k">END IF</span>
<a name="ln-5463"></a>
<a name="ln-5464"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-5465"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedInletDBTemp</span><span class="p">,</span><span class="n">HPInletAirHumRat</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5466"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5467"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5468"></a>  <span class="k">END IF</span>
<a name="ln-5469"></a>
<a name="ln-5470"></a><span class="c">! Find the companion upstream coil (DX cooling coil) that is used with DX heating coils (HP AC units only)</span>
<a name="ln-5471"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5472"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5473"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5474"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5475"></a>                  <span class="n">GetHPCoolingCoilIndex</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5476"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5477"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">ReportCoolingCoilCrankcasePower</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5478"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5479"></a><span class="c">!       Copy condenser node number from DX cooling coil when used with a companion DX heating coil</span>
<a name="ln-5480"></a>        <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxModes</span>
<a name="ln-5481"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5482"></a>                          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-5483"></a>        <span class="k">END DO</span>
<a name="ln-5484"></a><span class="k">      END IF</span>
<a name="ln-5485"></a><span class="k">    ELSE</span>
<a name="ln-5486"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5487"></a>    <span class="k">END IF</span>
<a name="ln-5488"></a><span class="k">  END IF</span> <span class="c">!IF(DXCoil(DXCoilNum)%FindCompanionUpStreamCoil)THEN</span>
<a name="ln-5489"></a>
<a name="ln-5490"></a><span class="c">! CR7308 - Wait for zone and air loop equipment to be simulated, then print out report variables</span>
<a name="ln-5491"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CrankcaseHeaterReportVarFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5492"></a><span class="k">    IF</span><span class="p">(</span><span class="n">AirLoopInputsFilled</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5493"></a><span class="c">!     Set report variables for DX cooling coils that will have a crankcase heater (all DX coils not used in a HP AC unit)</span>
<a name="ln-5494"></a>      <span class="k">DO </span><span class="n">DXCoilNumTemp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumDOE2DXCoils</span><span class="o">+</span><span class="n">NumDXMulModeCoils</span>
<a name="ln-5495"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNumTemp</span><span class="p">)%</span><span class="n">ReportCoolingCoilCrankcasePower</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5496"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Crankcase Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5497"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNumTemp</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNumTemp</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5498"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Crankcase Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5499"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNumTemp</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNumTemp</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5500"></a>                                    <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-5501"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNumTemp</span><span class="p">)%</span><span class="n">ReportCoolingCoilCrankcasePower</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5502"></a>        <span class="k">END IF</span>
<a name="ln-5503"></a><span class="k">      END DO</span>
<a name="ln-5504"></a><span class="k">      </span><span class="n">CrankcaseHeaterReportVarFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5505"></a>    <span class="k">END IF</span> <span class="c">!(AirLoopInputsFilled)THEN</span>
<a name="ln-5506"></a>  <span class="k">END IF</span> <span class="c">!(CrankcaseHeaterReportVarFlag)THEN</span>
<a name="ln-5507"></a>
<a name="ln-5508"></a><span class="c">! Find the companion upstream coil (DX cooling coil) that is used with DX heating coils (Multispeed HP units only)</span>
<a name="ln-5509"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5510"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5511"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5512"></a>                  <span class="n">GetHPCoolingCoilIndex</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5513"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5514"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">ReportCoolingCoilCrankcasePower</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5515"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5516"></a>      <span class="k">END IF</span>
<a name="ln-5517"></a><span class="k">    ELSE</span>
<a name="ln-5518"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5519"></a>    <span class="k">END IF</span>
<a name="ln-5520"></a><span class="k">  END IF</span> <span class="c">!IF(DXCoil(DXCoilNum)%FindCompanionUpStreamCoil)THEN</span>
<a name="ln-5521"></a>
<a name="ln-5522"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5523"></a>    <span class="c">! for each coil, do the sizing once.</span>
<a name="ln-5524"></a>    <span class="k">CALL </span><span class="n">SizeDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5525"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5526"></a>
<a name="ln-5527"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5528"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5529"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5530"></a>
<a name="ln-5531"></a><span class="k">      </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5532"></a>      <span class="c">! Check for zero capacity or zero max flow rate</span>
<a name="ln-5533"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5534"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5535"></a>                            <span class="s1">&#39; has zero rated total capacity&#39;</span><span class="p">)</span>
<a name="ln-5536"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5537"></a>      <span class="k">END IF</span>
<a name="ln-5538"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5539"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5540"></a>                            <span class="s1">&#39; has zero rated air flow rate&#39;</span><span class="p">)</span>
<a name="ln-5541"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5542"></a>      <span class="k">END IF</span>
<a name="ln-5543"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5544"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-5545"></a>      <span class="n">ENDIF</span>
<a name="ln-5546"></a>      <span class="c">!</span>
<a name="ln-5547"></a>      <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-5548"></a>      <span class="c">!</span>
<a name="ln-5549"></a>      <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-5550"></a>      <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5551"></a>          <span class="p">((</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5552"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5553"></a>                             <span class="s1">&#39;&quot;: Rated air volume flow rate per watt of rated total &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5554"></a>                             <span class="s1">&#39;cooling capacity is out of range.&#39;</span><span class="p">)</span>
<a name="ln-5555"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5556"></a>          <span class="s1">&#39;], Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5557"></a>          <span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5558"></a>          <span class="s1">&#39;]. See Input Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5559"></a>      <span class="k">END IF</span>
<a name="ln-5560"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5561"></a>        <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5562"></a>      <span class="c">! get high speed rated coil bypass factor</span>
<a name="ln-5563"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-5564"></a>                                           <span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),&amp;</span>
<a name="ln-5565"></a>                                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-5566"></a>
<a name="ln-5567"></a>    <span class="k">END IF</span>
<a name="ln-5568"></a>
<a name="ln-5569"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5570"></a><span class="k">      DO </span><span class="n">DehumidModeNum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span>
<a name="ln-5571"></a>        <span class="k">DO </span><span class="n">CapacityStageNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span>
<a name="ln-5572"></a>          <span class="n">Mode</span> <span class="o">=</span> <span class="n">DehumidModeNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">CapacityStageNum</span>
<a name="ln-5573"></a>          <span class="c">! Check for zero capacity or zero max flow rate</span>
<a name="ln-5574"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5575"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5576"></a>                                <span class="s1">&#39; has zero rated total capacity&#39;</span><span class="p">)</span>
<a name="ln-5577"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;for CoilPerformance:DX:Cooling mode: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5578"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5579"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5580"></a>          <span class="k">END IF</span>
<a name="ln-5581"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5582"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5583"></a>                                <span class="s1">&#39; has zero rated air flow rate&#39;</span><span class="p">)</span>
<a name="ln-5584"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;for CoilPerformance:DX:Cooling mode: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5585"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5586"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5587"></a>          <span class="k">END IF</span>
<a name="ln-5588"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5589"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-5590"></a>          <span class="n">ENDIF</span>
<a name="ln-5591"></a>          <span class="c">!</span>
<a name="ln-5592"></a>          <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-5593"></a>          <span class="c">!</span>
<a name="ln-5594"></a>          <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-5595"></a>          <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5596"></a>              <span class="p">((</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5597"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5598"></a>                                 <span class="s1">&#39;&quot;: Rated air volume flow rate per watt of rated total &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5599"></a>                                 <span class="s1">&#39;cooling capacity is out of range.&#39;</span><span class="p">)</span>
<a name="ln-5600"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5601"></a>             <span class="s1">&#39;], Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5602"></a>             <span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5603"></a>             <span class="s1">&#39;]. See Input Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5604"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;for CoilPerformance:DX:Cooling mode: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5605"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5606"></a>          <span class="k">END IF</span>
<a name="ln-5607"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5608"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5609"></a>          <span class="c">! get rated coil bypass factor</span>
<a name="ln-5610"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceType</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5611"></a>                                               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">),&amp;</span>
<a name="ln-5612"></a>                                               <span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),&amp;</span>
<a name="ln-5613"></a>                                               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-5614"></a>        <span class="k">END DO</span> <span class="c">! End capacity stages loop</span>
<a name="ln-5615"></a>      <span class="k">END DO</span> <span class="c">! End dehumidification modes loop</span>
<a name="ln-5616"></a>
<a name="ln-5617"></a>    <span class="k">END IF</span>
<a name="ln-5618"></a>
<a name="ln-5619"></a>
<a name="ln-5620"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5621"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5622"></a>
<a name="ln-5623"></a><span class="k">      </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5624"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5625"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5626"></a>                            <span class="s1">&#39; has zero rated total capacity&#39;</span><span class="p">)</span>
<a name="ln-5627"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5628"></a>      <span class="k">END IF</span>
<a name="ln-5629"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5630"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5631"></a>                            <span class="s1">&#39; has zero rated air flow rate&#39;</span><span class="p">)</span>
<a name="ln-5632"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5633"></a>      <span class="k">END IF</span>
<a name="ln-5634"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5635"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-5636"></a>      <span class="n">ENDIF</span>
<a name="ln-5637"></a>      <span class="n">RatedHeatPumpIndoorAirTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.11d0</span>  <span class="c">! 21.11C or 70F</span>
<a name="ln-5638"></a>      <span class="n">RatedHeatPumpIndoorHumRat</span> <span class="o">=</span> <span class="mf">0.00881d0</span> <span class="c">! Humidity ratio corresponding to 70F dry bulb/60F wet bulb</span>
<a name="ln-5639"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5640"></a>         <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedHeatPumpIndoorAirTemp</span><span class="p">,</span><span class="n">RatedHeatPumpIndoorHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5641"></a>      <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-5642"></a>      <span class="c">!</span>
<a name="ln-5643"></a>      <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-5644"></a>      <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5645"></a>          <span class="p">((</span><span class="n">RatedVolFlowperRatedTotCap</span> <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5646"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5647"></a>                              <span class="s1">&#39;: Rated air volume flow rate per watt of rated total &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5648"></a>                              <span class="s1">&#39;heating capacity is out of range.&#39;</span><span class="p">)</span>
<a name="ln-5649"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5650"></a>           <span class="s1">&#39;], Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5651"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]. See Input-Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5652"></a>      <span class="k">END IF</span>
<a name="ln-5653"></a>
<a name="ln-5654"></a><span class="k">    END IF</span>
<a name="ln-5655"></a>
<a name="ln-5656"></a>
<a name="ln-5657"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5658"></a>      <span class="c">!</span>
<a name="ln-5659"></a>      <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-5660"></a>      <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>
<a name="ln-5661"></a>      <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5662"></a>          <span class="p">((</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5663"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5664"></a>                             <span class="s1">&#39;&quot;: At low speed rated air volume flow rate per watt of rated total &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5665"></a>                             <span class="s1">&#39;cooling capacity is out of range.&#39;</span><span class="p">)</span>
<a name="ln-5666"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5667"></a>          <span class="s1">&#39;], Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5668"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]. See Input-Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5669"></a>      <span class="k">END IF</span>
<a name="ln-5670"></a>
<a name="ln-5671"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate2</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5672"></a>        <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5673"></a>      <span class="c">! get low speed rated coil bypass factor</span>
<a name="ln-5674"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF2</span> <span class="o">=</span> <span class="n">CalcCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-5675"></a>                                           <span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span><span class="p">,&amp;</span>
<a name="ln-5676"></a>                                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span><span class="p">)</span>
<a name="ln-5677"></a>
<a name="ln-5678"></a>      <span class="c">! call for standard ratings for two-speeed DX coil</span>
<a name="ln-5679"></a>      <span class="k">IF</span>  <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5680"></a><span class="k">        CALL </span><span class="n">CalcTwoSpeedDXCoilStandardRating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5681"></a>      <span class="n">ENDIF</span>
<a name="ln-5682"></a>    <span class="k">END IF</span>
<a name="ln-5683"></a>
<a name="ln-5684"></a><span class="c">!   Autosizing is completed in Size routine, however, the HPWH disrupts the flow of the eio and reporting</span>
<a name="ln-5685"></a><span class="c">!   is done here while all other coils are sized and reported.</span>
<a name="ln-5686"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatPumpWaterHeater</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirVolFlowAutoSized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5687"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5688"></a>                             <span class="s1">&#39;Rated Air Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-5689"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirVolFlowAutoSized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5690"></a>    <span class="k">END IF</span>
<a name="ln-5691"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatPumpWaterHeater</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterVolFlowAutoSized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5692"></a><span class="k">       CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5693"></a>                              <span class="s1">&#39;Rated Condenser Water Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span><span class="p">)</span>
<a name="ln-5694"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterVolFlowAutoSized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5695"></a>    <span class="k">END IF</span>
<a name="ln-5696"></a>
<a name="ln-5697"></a>    <span class="c">! Multispeed Cooling</span>
<a name="ln-5698"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5699"></a><span class="k">      Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-5700"></a>        <span class="c">! Check for zero capacity or zero max flow rate</span>
<a name="ln-5701"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5702"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5703"></a>                            <span class="s1">&#39; has zero rated total capacity at speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5704"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5705"></a>        <span class="k">END IF</span>
<a name="ln-5706"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5707"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5708"></a>                            <span class="s1">&#39; has zero rated air flow rate at speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5709"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5710"></a>        <span class="k">END IF</span>
<a name="ln-5711"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5712"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-5713"></a>        <span class="n">ENDIF</span>
<a name="ln-5714"></a>        <span class="c">!</span>
<a name="ln-5715"></a>        <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-5716"></a>        <span class="c">!</span>
<a name="ln-5717"></a>        <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-5718"></a>                                                 <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-5719"></a>        <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5720"></a>           <span class="p">((</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5721"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;Sizing: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5722"></a>                <span class="s1">&#39;&quot;: Rated air volume flow rate per watt of rated total &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5723"></a>                <span class="s1">&#39;cooling capacity is out of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5724"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5725"></a>             <span class="s1">&#39;], &#39;</span><span class="o">//</span><span class="s1">&#39;Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5726"></a>             <span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5727"></a>             <span class="s1">&#39;]. See Input Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5728"></a>        <span class="k">END IF</span>
<a name="ln-5729"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5730"></a>          <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5731"></a>        <span class="c">! get high speed rated coil bypass factor</span>
<a name="ln-5732"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-5733"></a>                                           <span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),&amp;</span>
<a name="ln-5734"></a>                                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-5735"></a>      <span class="k">END DO</span>
<a name="ln-5736"></a><span class="k">    END IF</span>
<a name="ln-5737"></a>
<a name="ln-5738"></a>    <span class="c">! Multispeed Heating</span>
<a name="ln-5739"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5740"></a><span class="k">      </span><span class="n">RatedHeatPumpIndoorAirTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.11d0</span>  <span class="c">! 21.11C or 70F</span>
<a name="ln-5741"></a>      <span class="n">RatedHeatPumpIndoorHumRat</span> <span class="o">=</span> <span class="mf">0.00881d0</span> <span class="c">! Humidity ratio corresponding to 70F dry bulb/60F wet bulb</span>
<a name="ln-5742"></a>      <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-5743"></a>
<a name="ln-5744"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5745"></a>         <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RatedHeatPumpIndoorAirTemp</span><span class="p">,</span><span class="n">RatedHeatPumpIndoorHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-5746"></a>        <span class="c">! Check for valid range of (Rated Air Volume Flow Rate / Rated Total Capacity)</span>
<a name="ln-5747"></a>        <span class="c">!</span>
<a name="ln-5748"></a>        <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-5749"></a>                                                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-5750"></a>        <span class="k">IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5751"></a>            <span class="p">((</span><span class="n">RatedVolFlowperRatedTotCap</span> <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5752"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5753"></a>                              <span class="s1">&#39;: Rated air volume flow rate per watt of rated total &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5754"></a>                <span class="s1">&#39;heating capacity is out of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">)))</span>
<a name="ln-5755"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Min Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5756"></a>             <span class="s1">&#39;], Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5757"></a>             <span class="s1">&#39;], Max Rated Vol Flow Per Watt=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5758"></a>             <span class="s1">&#39;]. See Input Output Reference Manual for valid range.&#39;</span><span class="p">)</span>
<a name="ln-5759"></a>        <span class="k">END IF</span>
<a name="ln-5760"></a><span class="k">      End Do</span>
<a name="ln-5761"></a><span class="k">    END IF</span>
<a name="ln-5762"></a>
<a name="ln-5763"></a><span class="k">  END IF</span>
<a name="ln-5764"></a>
<a name="ln-5765"></a><span class="k">  </span><span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-5766"></a>
<a name="ln-5767"></a>  <span class="c">! Each iteration, load the coil data structure with the inlet conditions</span>
<a name="ln-5768"></a>
<a name="ln-5769"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-5770"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">)</span>
<a name="ln-5771"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>            <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5772"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>          <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-5773"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>        <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-5774"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-5775"></a><span class="c">!  DXCoil(DXCoilNum)%InletAirPressure        = Node(AirInletNode)%Press</span>
<a name="ln-5776"></a>
<a name="ln-5777"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5778"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5779"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecWaterHeatingPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5780"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-5781"></a><span class="c">!  DXCoil(DXCoilNum)%InletAirPressure         = StdBaroPress</span>
<a name="ln-5782"></a>
<a name="ln-5783"></a><span class="c">!   HPWH&#39;s that use an inlet air temperature schedule also need to have a valid barometric pressure</span>
<a name="ln-5784"></a><span class="c">!   The DX Coil used in HPWH&#39;s does not know if it is using a scheduled inlet temperature so check the node pressure</span>
<a name="ln-5785"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5786"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Press</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5787"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Press</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-5788"></a>      <span class="k">END IF</span>
<a name="ln-5789"></a><span class="k">    END IF</span>
<a name="ln-5790"></a>
<a name="ln-5791"></a><span class="k">  END IF</span>
<a name="ln-5792"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a>  <span class="k">RETURN</span>
<a name="ln-5795"></a>
<a name="ln-5796"></a><span class="k">END SUBROUTINE </span><span class="n">InitDXCoil</span>
<a name="ln-5797"></a>
<a name="ln-5798"></a><span class="k">SUBROUTINE </span><span class="n">SizeDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-5799"></a>
<a name="ln-5800"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5801"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-5802"></a>          <span class="c">!       DATE WRITTEN   January 2002</span>
<a name="ln-5803"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-5804"></a>          <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-5805"></a>          <span class="c">!                      July 2005 R. Raustad, FSEC</span>
<a name="ln-5806"></a>          <span class="c">!                        Add new coil type COIL:DX:HEATPUMPWATERHEATER</span>
<a name="ln-5807"></a>          <span class="c">!                      June 2007 L. Gu, FSEC</span>
<a name="ln-5808"></a>          <span class="c">!                        Add new coil type COIL:DX:MULTISPEED:COOLING and HEATING</span>
<a name="ln-5809"></a>          <span class="c">!                      January 2011, B. Griffithn NREL. add EMS overrides for autosized fields. 1`</span>
<a name="ln-5810"></a>          <span class="c">!                      August 2013 Daeho Kang, add component sizing table entries</span>
<a name="ln-5811"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5812"></a>
<a name="ln-5813"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5814"></a>          <span class="c">! This subroutine is for sizing DX Coil components for which nominal capacity and air flow rate</span>
<a name="ln-5815"></a>          <span class="c">! have not been specified in the input.</span>
<a name="ln-5816"></a>
<a name="ln-5817"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5818"></a>          <span class="c">! Obtains cooling capacities and air flow rates from the zone or system sizing arrays.</span>
<a name="ln-5819"></a>
<a name="ln-5820"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5821"></a>          <span class="c">! na</span>
<a name="ln-5822"></a>
<a name="ln-5823"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5824"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-5825"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-5826"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-5827"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-5828"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-5829"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-5830"></a>  <span class="k">USE </span><span class="n">StandardRatings</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcDXCoilStandardRating</span>
<a name="ln-5831"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-5832"></a>
<a name="ln-5833"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5834"></a>
<a name="ln-5835"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5836"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>
<a name="ln-5837"></a>
<a name="ln-5838"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5839"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SizeDXCoil&#39;</span>
<a name="ln-5840"></a>
<a name="ln-5841"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5842"></a>          <span class="c">! na</span>
<a name="ln-5843"></a>
<a name="ln-5844"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5845"></a>          <span class="c">! na</span>
<a name="ln-5846"></a>
<a name="ln-5847"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoair</span>
<a name="ln-5849"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>
<a name="ln-5850"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixTemp</span>
<a name="ln-5851"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixHumRat</span>
<a name="ln-5852"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixEnth</span>
<a name="ln-5853"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixWetBulb</span>
<a name="ln-5854"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupTemp</span>
<a name="ln-5855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHumRat</span>
<a name="ln-5856"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupEnth</span>
<a name="ln-5857"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutTemp</span>
<a name="ln-5858"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutAirFrac</span>
<a name="ln-5859"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowRate</span>
<a name="ln-5860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-5861"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>
<a name="ln-5862"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="c">!Rated Air Volume Flow Rate divided by Rated Total Capacity[m3/s-W)</span>
<a name="ln-5863"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TimeStepNumAtMax</span>
<a name="ln-5864"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DDNum</span>
<a name="ln-5865"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CapacityStageNum</span>     <span class="c">! Loop index for 1,Number of capacity stages</span>
<a name="ln-5866"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DehumidModeNum</span>       <span class="c">! Loop index for 1,Number of enhanced dehumidification modes</span>
<a name="ln-5867"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Mode</span>  <span class="c">! Operating mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-5868"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfSpeedCompanion</span>  <span class="c">! Number of speed for a companion cooling coil (Multispeed HO heating coil only</span>
<a name="ln-5869"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">equipName</span>
<a name="ln-5870"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">OASysFlag</span>            <span class="c">! Logical flag determines if parent object set OA Sys coil property</span>
<a name="ln-5871"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">AirLoopSysFlag</span>       <span class="c">! Logical flag determines if parent object set air loop coil property</span>
<a name="ln-5872"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateDes</span>          <span class="c">! Design rated air volume flow for reporting</span>
<a name="ln-5873"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRateUser</span>         <span class="c">! Hard-sized rated air volume flow for reporting</span>
<a name="ln-5874"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRate2Des</span>         <span class="c">! Design rated low speed air volume flow for reporting</span>
<a name="ln-5875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedAirVolFlowRate2User</span>        <span class="c">! Hard-sized rated low speed air volume flow for reporting</span>
<a name="ln-5876"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCapDes</span>                  <span class="c">! Design rated total capacity for reproting</span>
<a name="ln-5877"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCapUser</span>                 <span class="c">! Hard-sized rated total capacity for reproting</span>
<a name="ln-5878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCap2Des</span>                 <span class="c">! Design rated low speed total capacity for reproting</span>
<a name="ln-5879"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedTotCap2User</span>                <span class="c">! Hard-sized rated low speed total capacity for reproting</span>
<a name="ln-5880"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHRDes</span>                     <span class="c">! Design ratd SHR for reporting</span>
<a name="ln-5881"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHRUser</span>                    <span class="c">! Hard-sized ratd SHR for reporting</span>
<a name="ln-5882"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHR2Des</span>                    <span class="c">! Design ratd low speed SHR for reporting</span>
<a name="ln-5883"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHR2User</span>                   <span class="c">! Hard-sized ratd low speed SHR for reporting</span>
<a name="ln-5884"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlowDes</span>              <span class="c">! Design evaporative condenser air flow for reporting</span>
<a name="ln-5885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlowUser</span>             <span class="c">! Hard-sized evaporative condenser air flow for reporting</span>
<a name="ln-5886"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlow2Des</span>             <span class="c">! Design low speed evaporative condenser air flow for reporting</span>
<a name="ln-5887"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondAirFlow2User</span>            <span class="c">! Hard-sized low speed evaporative condenser air flow for reporting</span>
<a name="ln-5888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPowerDes</span>     <span class="c">! Design evaporative condenser pump rated power consumption for reporting</span>
<a name="ln-5889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPowerUser</span>    <span class="c">! Hard-sized evaporative condenser pump rated power consumption for reporting</span>
<a name="ln-5890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPower2Des</span>    <span class="c">! Design low speed condenser pump rated power consumption for reporting</span>
<a name="ln-5891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPower2User</span>   <span class="c">! Hard-sized low speed condenser pump rated power consumption for reporting</span>
<a name="ln-5892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostCapacityDes</span>              <span class="c">! Design defrost heater capacity for reporting</span>
<a name="ln-5893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostCapacityUser</span>             <span class="c">! Hard-sized defrost heater capacity for reporting</span>
<a name="ln-5894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedAirVolFlowRateDes</span>        <span class="c">! Design multispeed rated air volume flow rate for reporting</span>
<a name="ln-5895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedAirVolFlowRateUser</span>       <span class="c">! Hard-sized multispeed rated air volume flow rate for reporting</span>
<a name="ln-5896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedTotCapDes</span>                <span class="c">! Design multispeed rated total capacity for reporting</span>
<a name="ln-5897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedTotCapUser</span>               <span class="c">! Hard-sized multispeed rated total capacity for reporting</span>
<a name="ln-5898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedSHRDes</span>                   <span class="c">! Design multispeed rated SHR for reporting</span>
<a name="ln-5899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSRatedSHRUser</span>                  <span class="c">! Hard-sized multispeed rated SHR for reporting</span>
<a name="ln-5900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondAirFlowDes</span>            <span class="c">! Design evaporative condenser air flow for reporting</span>
<a name="ln-5901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondAirFlowUser</span>           <span class="c">! Hard-sized evaporative condenser air flow for reporting</span>
<a name="ln-5902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondAirFlow2Des</span>           <span class="c">! Design low speed evaporative condenser air flow for reporting</span>
<a name="ln-5903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondAirFlow2User</span>          <span class="c">! Hard-sized low speed evaporative condenser air flow for reporting</span>
<a name="ln-5904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondPumpElecNomPowerDes</span>   <span class="c">! Design evaporative condenser pump rated power consumption for reporting</span>
<a name="ln-5905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondPumpElecNomPowerUser</span>  <span class="c">! Hard-sized evaporative condenser pump rated power consumption for reporting</span>
<a name="ln-5906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondPumpElecNomPower2Des</span>  <span class="c">! Design low speed condenser pump rated power consumption for reporting</span>
<a name="ln-5907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSEvapCondPumpElecNomPower2User</span> <span class="c">! Hard-sized low speed condenser pump rated power consumption for reporting</span>
<a name="ln-5908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSDefrostCapacityDes</span>            <span class="c">! Design defrost heater capacity for reporting</span>
<a name="ln-5909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSDefrostCapacityUser</span>           <span class="c">! Hard-sized defrost heater capacity for reporting</span>
<a name="ln-5910"></a>  <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">HardSizeNoDesRun</span>                   <span class="c">! Indicator to a hard-sized field with no design sizing data</span>
<a name="ln-5911"></a>  <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">IsAutoSize</span>                         <span class="c">! Indicator to autosize for reporting</span>
<a name="ln-5912"></a>  <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">IsCoolCoilCapAutosize</span>              <span class="c">! Indicator to cooling capacity autosize for reporting</span>
<a name="ln-5913"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisAirSys</span>            <span class="c">! true if a particular air system had a Sizing:System object and system sizing done</span>
<a name="ln-5914"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisZone</span>              <span class="c">! true if a particular zone had a Sizing:Zone object and zone sizing was done</span>
<a name="ln-5915"></a>
<a name="ln-5916"></a>    <span class="c">! Initiate all reporting variables</span>
<a name="ln-5917"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SysSizingRunDone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5918"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5919"></a>  <span class="k">ELSE</span>
<a name="ln-5920"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5921"></a>  <span class="n">ENDIF</span>
<a name="ln-5922"></a>
<a name="ln-5923"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5924"></a><span class="k">    CALL </span><span class="n">CheckThisAirSystemForSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">,</span> <span class="n">SizingDesRunThisAirSys</span> <span class="p">)</span>
<a name="ln-5925"></a>  <span class="k">ELSE</span>
<a name="ln-5926"></a><span class="k">    </span><span class="n">SizingDesRunThisAirSys</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5927"></a>  <span class="n">ENDIF</span>
<a name="ln-5928"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5929"></a><span class="k">    CALL </span><span class="n">CheckThisZoneForSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">,</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span>
<a name="ln-5930"></a>  <span class="k">ELSE</span>
<a name="ln-5931"></a><span class="k">    </span><span class="n">SizingDesRunThisZone</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5932"></a>  <span class="n">ENDIF</span>
<a name="ln-5933"></a>
<a name="ln-5934"></a>  <span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5935"></a>  <span class="n">IsCoolCoilCapAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5936"></a>  <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5937"></a>  <span class="n">RatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5938"></a>  <span class="n">RatedAirVolFlowRate2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5939"></a>  <span class="n">RatedAirVolFlowRate2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5940"></a>  <span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5941"></a>  <span class="n">RatedTotCapUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5942"></a>  <span class="n">RatedTotCap2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5943"></a>  <span class="n">RatedTotCap2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5944"></a>  <span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5945"></a>  <span class="n">RatedSHRUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5946"></a>  <span class="n">RatedSHR2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5947"></a>  <span class="n">RatedSHR2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5948"></a>  <span class="n">EvapCondAirFlowDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5949"></a>  <span class="n">EvapCondAirFlowUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5950"></a>  <span class="n">EvapCondAirFlow2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5951"></a>  <span class="n">EvapCondAirFlow2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5952"></a>  <span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5953"></a>  <span class="n">EvapCondPumpElecNomPowerUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5954"></a>  <span class="n">EvapCondPumpElecNomPower2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5955"></a>  <span class="n">EvapCondPumpElecNomPower2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5956"></a>  <span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5957"></a>  <span class="n">DefrostCapacityUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5958"></a>  <span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5959"></a>  <span class="n">MSRatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5960"></a>  <span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5961"></a>  <span class="n">MSRatedTotCapUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5962"></a>  <span class="n">MSRatedSHRDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5963"></a>  <span class="n">MSRatedSHRUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5964"></a>  <span class="n">MSEvapCondAirFlowDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5965"></a>  <span class="n">MSEvapCondAirFlowUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5966"></a>  <span class="n">MSEvapCondAirFlow2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5967"></a>  <span class="n">MSEvapCondAirFlow2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5968"></a>  <span class="n">MSEvapCondPumpElecNomPowerDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5969"></a>  <span class="n">MSEvapCondPumpElecNomPowerUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5970"></a>  <span class="n">MSEvapCondPumpElecNomPower2Des</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5971"></a>  <span class="n">MSEvapCondPumpElecNomPower2User</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5972"></a>  <span class="n">MSDefrostCapacityDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5973"></a>  <span class="n">MSDefrostCapacityUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5974"></a>
<a name="ln-5975"></a><span class="c">!  EXTERNAL ReportSizingOutput</span>
<a name="ln-5976"></a>
<a name="ln-5977"></a>  <span class="c">! NOTE: we are sizing COIL:DX:HeatingEmpirical on the COOLING load. Thus the cooling and</span>
<a name="ln-5978"></a>  <span class="c">! and heating capacities of a DX heat pump system will be identical. In real life the ARI</span>
<a name="ln-5979"></a>  <span class="c">! heating and cooling capacities are close but not identical.</span>
<a name="ln-5980"></a>  <span class="k">DO </span><span class="n">DehumidModeNum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumDehumidModes</span>
<a name="ln-5981"></a>    <span class="k">DO </span><span class="n">CapacityStageNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span>
<a name="ln-5982"></a>      <span class="n">Mode</span> <span class="o">=</span> <span class="n">DehumidModeNum</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">CapacityStageNum</span>
<a name="ln-5983"></a>
<a name="ln-5984"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5985"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5986"></a>      <span class="k">END IF</span>
<a name="ln-5987"></a>        <span class="c">! Sizing rated air volume flow rate</span>
<a name="ln-5988"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5989"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5990"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5991"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5992"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Cooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5993"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5994"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5995"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5996"></a>            <span class="c">! If hard-sized, check if system sizing data is available for system coil</span>
<a name="ln-5997"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5998"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5999"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6000"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6001"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6002"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6003"></a>                                <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6004"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6005"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6006"></a>                                <span class="s1">&#39;User-Specified Rated Air Flow Rate (non-bypassed) [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6007"></a>                                <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6008"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6009"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6010"></a>                                <span class="s1">&#39;User-Specified Rated High Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6011"></a>                                <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6012"></a>              <span class="k">ELSE</span>
<a name="ln-6013"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6014"></a>                                <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6015"></a>              <span class="k">END IF</span>
<a name="ln-6016"></a><span class="k">            END IF</span>
<a name="ln-6017"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-6018"></a>            <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6019"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6020"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6021"></a>                <span class="c">! Parent object sets flow rate</span>
<a name="ln-6022"></a>                <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-6023"></a>              <span class="k">ELSE</span>
<a name="ln-6024"></a><span class="k">                </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-6025"></a>              <span class="k">END IF</span>
<a name="ln-6026"></a><span class="k">            ELSE</span>
<a name="ln-6027"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6028"></a>                <span class="c">! Parent object sets flow rate</span>
<a name="ln-6029"></a>                <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-6030"></a>              <span class="k">ELSE</span>
<a name="ln-6031"></a><span class="k">                </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-6032"></a>              <span class="k">END IF</span>
<a name="ln-6033"></a><span class="k">            END IF</span>
<a name="ln-6034"></a><span class="k">          END IF</span>
<a name="ln-6035"></a>
<a name="ln-6036"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6037"></a>            <span class="c">! If hard-sized, check if zone sizing data is available for zone coil</span>
<a name="ln-6038"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6039"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6040"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6041"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6042"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6043"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6044"></a>                                <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6045"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6046"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6047"></a>                                <span class="s1">&#39;User-Specified Rated Air Flow Rate (non-bypassed) [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6048"></a>                                <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6049"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6050"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6051"></a>                                <span class="s1">&#39;User-Specified Rated High Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6052"></a>                                <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6053"></a>              <span class="k">ELSE</span>
<a name="ln-6054"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6055"></a>                                <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6056"></a>              <span class="k">END IF</span>
<a name="ln-6057"></a><span class="k">            END IF</span>
<a name="ln-6058"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with zone sizing data</span>
<a name="ln-6059"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6060"></a>              <span class="c">! Parent object sets flow rate</span>
<a name="ln-6061"></a>              <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-6062"></a>            <span class="k">ELSE</span>
<a name="ln-6063"></a><span class="k">              CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6064"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ZoneCoolingOnlyFan</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6065"></a><span class="k">                </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-6066"></a>              <span class="k">ELSE</span>
<a name="ln-6067"></a><span class="k">                </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6068"></a>                  <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-6069"></a>              <span class="k">END IF</span>
<a name="ln-6070"></a><span class="k">            END IF</span> <span class="c">! IF(ZoneEqSizing(CurZoneEqNum)%AirFlow)THEN</span>
<a name="ln-6071"></a>          <span class="k">END IF</span>
<a name="ln-6072"></a><span class="k">        END IF</span>
<a name="ln-6073"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6074"></a><span class="k">          </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6075"></a>        <span class="k">END IF</span>
<a name="ln-6076"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRateEMSOverrideON</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6077"></a><span class="k">          </span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRateEMSOverrideValue</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6078"></a>        <span class="k">END IF</span>
<a name="ln-6079"></a><span class="k">      END IF</span>
<a name="ln-6080"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6081"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6082"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">*</span> <span class="mf">0.00005035d0</span>
<a name="ln-6083"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirVolFlowAutoSized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6084"></a>        <span class="k">END IF</span>
<a name="ln-6085"></a>
<a name="ln-6086"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6087"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">*</span> <span class="mf">0.00000004487d0</span>
<a name="ln-6088"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterVolFlowAutoSized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6089"></a><span class="c">!            Reporting autosize info for DX coils used with HPWHs will list the info out of order in the eio, report it later</span>
<a name="ln-6090"></a><span class="c">!            CALL ReportSizingOutput(DXCoil(DXCoilNum)%DXCoilType, DXCoil(DXCoilNum)%Name, &amp;</span>
<a name="ln-6091"></a><span class="c">!                                  &#39;Rated Condenser Water Volume Flow Rate [m3/s]&#39;, DXCoil(DXCoilNum)%RatedHPWHCondWaterFlow)</span>
<a name="ln-6092"></a>        <span class="k">END IF</span>
<a name="ln-6093"></a><span class="k">      ELSE</span>
<a name="ln-6094"></a>
<a name="ln-6095"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6096"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirVolFlowAutoSized</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterVolFlowAutoSized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6097"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Design Size values are available for both autosized and hard-sized</span>
<a name="ln-6098"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span>
<a name="ln-6099"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6100"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6101"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6102"></a>                                  <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-6103"></a>                <span class="c">! For Multimode Coil, Rated flow must be adjusted for bypass fraction</span>
<a name="ln-6104"></a>                <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6105"></a>                                       <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6106"></a>                <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span>
<a name="ln-6107"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6108"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6109"></a>                                  <span class="s1">&#39;Design Size Rated Air Flow Rate (non-bypassed) [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-6110"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6111"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6112"></a>                                  <span class="s1">&#39;Design Size Rated High Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">RatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-6113"></a>              <span class="k">ELSE</span>
<a name="ln-6114"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6115"></a>                                  <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-6116"></a>              <span class="k">END IF</span>
<a name="ln-6117"></a><span class="k">            ELSE</span>  <span class="c">! Hard size with sizing data</span>
<a name="ln-6118"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6119"></a><span class="k">                </span><span class="n">RatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6120"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6121"></a><span class="k">                  CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6122"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6123"></a>                                  <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6124"></a>                                  <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-6125"></a>                  <span class="c">! For Multimode Coil, Rated flow must be adjusted for bypass fraction</span>
<a name="ln-6126"></a>                  <span class="n">RatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRateDes</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6127"></a>                                       <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6128"></a>                  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6129"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6130"></a>                                  <span class="s1">&#39;Design Size Rated Air Flow Rate (non-bypassed) [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6131"></a>                                  <span class="s1">&#39;User-Specified Rated Air Flow Rate (non-bypassed) [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-6132"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6133"></a><span class="k">                  CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6134"></a>                                  <span class="s1">&#39;Design Size Rated High Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6135"></a>                                  <span class="s1">&#39;User-Specified Rated High Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-6136"></a>                <span class="k">ELSE</span>
<a name="ln-6137"></a><span class="k">                  CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6138"></a>                                  <span class="s1">&#39;Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6139"></a>                                  <span class="s1">&#39;User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-6140"></a>                <span class="k">END IF</span>
<a name="ln-6141"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6142"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6143"></a>                                   <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6144"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6145"></a>                                       <span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6146"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Air Volume Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6147"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-6148"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Air Volume Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6149"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-6150"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6151"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6152"></a>                  <span class="n">ENDIF</span>
<a name="ln-6153"></a>                <span class="n">ENDIF</span>
<a name="ln-6154"></a>              <span class="k">END IF</span>
<a name="ln-6155"></a><span class="k">            END IF</span>
<a name="ln-6156"></a><span class="k">          END IF</span>
<a name="ln-6157"></a><span class="k">        END IF</span>
<a name="ln-6158"></a><span class="k">      END IF</span>
<a name="ln-6159"></a>
<a name="ln-6160"></a><span class="k">      </span><span class="n">OASysFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6161"></a>      <span class="n">AirLoopSysFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6162"></a>      <span class="c">! logicals used when parent sizes coil</span>
<a name="ln-6163"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="n">OASysFlag</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span>
<a name="ln-6164"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="n">AirLoopSysFlag</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span>
<a name="ln-6165"></a>
<a name="ln-6166"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6167"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6168"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6169"></a>      <span class="k">END IF</span>
<a name="ln-6170"></a>        <span class="c">! Sizing rated total capacity</span>
<a name="ln-6171"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6172"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6173"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6174"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6175"></a><span class="k">        </span><span class="n">IsCoolCoilCapAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6176"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6177"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6178"></a>            <span class="c">! If hard-sized, check if system sizing data is available for system coil</span>
<a name="ln-6179"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6180"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6181"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6182"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6183"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6184"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6185"></a>                       <span class="s1">&#39;User-Specified Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6186"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6187"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6188"></a>                        <span class="s1">&#39;User-Specified Rated High Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6189"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6190"></a>              <span class="k">ELSE</span>
<a name="ln-6191"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6192"></a>                        <span class="s1">&#39;User-Specified Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6193"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6194"></a>              <span class="k">END IF</span>
<a name="ln-6195"></a><span class="k">            END IF</span>
<a name="ln-6196"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-6197"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">OASysFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6198"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span>
<a name="ln-6199"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">AirLoopSysFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6200"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span>
<a name="ln-6201"></a>            <span class="k">ELSE</span>
<a name="ln-6202"></a><span class="k">              CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6203"></a>              <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6204"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6205"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-6206"></a>                  <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-6207"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-6208"></a>                  <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-6209"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-6210"></a>                <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-6211"></a>                  <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-6212"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-6213"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-6214"></a>                    <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-6215"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-6216"></a>                  <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-6217"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6218"></a><span class="k">                      </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-6219"></a>                    <span class="k">ELSE</span>
<a name="ln-6220"></a><span class="k">                      </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6221"></a>                    <span class="k">END IF</span>
<a name="ln-6222"></a><span class="k">                    </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-6223"></a>                    <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6224"></a>                              <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-6225"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6226"></a>                                <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-6227"></a>                  <span class="k">END IF</span>
<a name="ln-6228"></a><span class="k">                END IF</span>
<a name="ln-6229"></a><span class="k">                </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-6230"></a>                <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6231"></a>                <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6232"></a>                <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6233"></a>                <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6234"></a>                <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-6235"></a>                <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-6236"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6237"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-6238"></a>                <span class="k">ELSE</span>
<a name="ln-6239"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-6240"></a>                <span class="k">END IF</span>
<a name="ln-6241"></a><span class="k">              ELSE</span>
<a name="ln-6242"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6243"></a>              <span class="k">END IF</span>
<a name="ln-6244"></a><span class="k">            END IF</span> <span class="c">! IF(OASysFlag) THEN or ELSE IF(AirLoopSysFlag) THEN</span>
<a name="ln-6245"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">RatedTotCapDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6246"></a><span class="k">              </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6247"></a>            <span class="k">ELSE</span>
<a name="ln-6248"></a><span class="k">              </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6249"></a>            <span class="k">END IF</span>
<a name="ln-6250"></a>            <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-6251"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6252"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6253"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6254"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the minimum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6255"></a>                                       <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6256"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6257"></a>                                        <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6258"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6259"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6260"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6261"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6262"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6263"></a>              <span class="k">END IF</span>
<a name="ln-6264"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6265"></a>                                                    <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6266"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6267"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6268"></a>              <span class="k">END IF</span>
<a name="ln-6269"></a><span class="k">            </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6270"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6271"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6272"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the maximum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6273"></a>                                       <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6274"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6275"></a>                                        <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6276"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6277"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6278"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6279"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Maximum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6280"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6281"></a>              <span class="k">END IF</span>
<a name="ln-6282"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6283"></a>                                                    <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6284"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6285"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6286"></a>              <span class="k">END IF</span>
<a name="ln-6287"></a><span class="k">            END IF</span>
<a name="ln-6288"></a><span class="k">          END IF</span>
<a name="ln-6289"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6290"></a>            <span class="c">! If hard-sized, check if zone sizing data is available for system coil</span>
<a name="ln-6291"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6292"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6293"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6294"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6295"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6296"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6297"></a>                                   <span class="s1">&#39;User-Specified Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6298"></a>                                   <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6299"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6300"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6301"></a>                                  <span class="s1">&#39;User-Specified Rated High Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6302"></a>                                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6303"></a>              <span class="k">ELSE</span>
<a name="ln-6304"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6305"></a>                                  <span class="s1">&#39;User-Specified Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6306"></a>                                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6307"></a>              <span class="k">END IF</span>
<a name="ln-6308"></a><span class="k">            END IF</span>
<a name="ln-6309"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-6310"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Parent object calculated capacity</span>
<a name="ln-6311"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span>
<a name="ln-6312"></a>            <span class="k">ELSE</span>
<a name="ln-6313"></a><span class="k">              CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6314"></a>              <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6315"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6316"></a><span class="k">                IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6317"></a><span class="k">                  IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6318"></a><span class="k">                    </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-6319"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-6320"></a>                  <span class="k">ELSE</span>
<a name="ln-6321"></a><span class="k">                    </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-6322"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-6323"></a>                  <span class="k">END IF</span>
<a name="ln-6324"></a><span class="k">                ELSE</span>
<a name="ln-6325"></a><span class="k">                  </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-6326"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-6327"></a>                <span class="k">END IF</span>
<a name="ln-6328"></a><span class="k">                </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-6329"></a>                <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-6330"></a>                <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-6331"></a>                <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-6332"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6333"></a><span class="k">                  </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-6334"></a>                <span class="k">ELSE</span>
<a name="ln-6335"></a><span class="k">                  </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6336"></a>                <span class="n">ENDIF</span>
<a name="ln-6337"></a>                <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6338"></a>                <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6339"></a>                <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6340"></a>                <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6341"></a>                <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-6342"></a>                <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-6343"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6344"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-6345"></a>                <span class="k">ELSE</span>
<a name="ln-6346"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-6347"></a>                <span class="k">END IF</span>
<a name="ln-6348"></a><span class="k">              ELSE</span>
<a name="ln-6349"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6350"></a>              <span class="k">END IF</span>
<a name="ln-6351"></a><span class="k">            END IF</span>
<a name="ln-6352"></a><span class="k">          END IF</span> <span class="c">! End of desing sizing</span>
<a name="ln-6353"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">RatedTotCapDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6354"></a><span class="k">              </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6355"></a>            <span class="k">ELSE</span>
<a name="ln-6356"></a><span class="k">              </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6357"></a>            <span class="k">END IF</span>
<a name="ln-6358"></a>            <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-6359"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6360"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6361"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6362"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the minimum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6363"></a>                                       <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6364"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6365"></a>                                        <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6366"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6367"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6368"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6369"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6370"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6371"></a>              <span class="k">END IF</span>
<a name="ln-6372"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6373"></a>                                                   <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6374"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6375"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6376"></a>              <span class="k">END IF</span>
<a name="ln-6377"></a><span class="k">            </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6378"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6379"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6380"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the maximum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6381"></a>                                       <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6382"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6383"></a>                                        <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6384"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6385"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6386"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6387"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Maximum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6388"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6389"></a>              <span class="k">END IF</span>
<a name="ln-6390"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6391"></a>                                                   <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6392"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6393"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6394"></a>              <span class="k">END IF</span>
<a name="ln-6395"></a><span class="k">            END IF</span>
<a name="ln-6396"></a><span class="k">        END IF</span> <span class="c">! End of sys/zone coil type</span>
<a name="ln-6397"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6398"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Design Size values are available for both autosized and hard-sized</span>
<a name="ln-6399"></a>              <span class="c">! Set Design Size and User-Specified values</span>
<a name="ln-6400"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6401"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCapEMSOverrideValue</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6402"></a>            <span class="n">ENDIF</span>
<a name="ln-6403"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6404"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6405"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6406"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6407"></a>                                  <span class="s1">&#39;Design Size Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">)</span>
<a name="ln-6408"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6409"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6410"></a>                                  <span class="s1">&#39;Design Size Rated High Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">)</span>
<a name="ln-6411"></a>            <span class="k">ELSE</span>
<a name="ln-6412"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6413"></a>                                  <span class="s1">&#39;Design Size Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">)</span>
<a name="ln-6414"></a>            <span class="k">END IF</span>
<a name="ln-6415"></a>
<a name="ln-6416"></a><span class="k">          ELSE</span>  <span class="c">! Hard size with sizing data</span>
<a name="ln-6417"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedTotCapDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6418"></a><span class="k">              </span><span class="n">RatedTotCapUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6419"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6420"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6421"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6422"></a>                                  <span class="s1">&#39;Design Size Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6423"></a>                                  <span class="s1">&#39;User-Specified Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapUser</span><span class="p">)</span>
<a name="ln-6424"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6425"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6426"></a>                                  <span class="s1">&#39;Design Size Rated High Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6427"></a>                                  <span class="s1">&#39;User-Specified Rated High Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapUser</span><span class="p">)</span>
<a name="ln-6428"></a>              <span class="k">ELSE</span>
<a name="ln-6429"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6430"></a>                                  <span class="s1">&#39;Design Size Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6431"></a>                                  <span class="s1">&#39;User-Specified Rated Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapUser</span><span class="p">)</span>
<a name="ln-6432"></a>              <span class="k">END IF</span>
<a name="ln-6433"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6434"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedTotCapDes</span> <span class="o">-</span> <span class="n">RatedTotCapUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedTotCapUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6435"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6436"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6437"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Total Cooling Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6438"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedTotCapUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-6439"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Total Cooling Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6440"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-6441"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6442"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6443"></a>                <span class="k">END IF</span>
<a name="ln-6444"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-6445"></a>            <span class="k">END IF</span>
<a name="ln-6446"></a><span class="k">          END IF</span>
<a name="ln-6447"></a><span class="k">        END IF</span>
<a name="ln-6448"></a><span class="k">      END IF</span>
<a name="ln-6449"></a>
<a name="ln-6450"></a>        <span class="c">! Heating coil capacity</span>
<a name="ln-6451"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6452"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6453"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6454"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6455"></a><span class="k">        </span><span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6456"></a>      <span class="k">END IF</span>
<a name="ln-6457"></a>
<a name="ln-6458"></a>
<a name="ln-6459"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6460"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6461"></a>
<a name="ln-6462"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6463"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6464"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6465"></a>        <span class="k">END IF</span>
<a name="ln-6466"></a>
<a name="ln-6467"></a>    <span class="c">!    IF (.NOT. DXCoil(DXCoilNum)%AirVolFlowAutoSized .AND. .NOT. DXCoil(DXCoilNum)%WaterVolFlowAutoSized) THEN</span>
<a name="ln-6468"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6469"></a>
<a name="ln-6470"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6471"></a><span class="k">          </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6472"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6473"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6474"></a>                              <span class="s1">&#39;User-Specified Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6475"></a>          <span class="k">END IF</span>
<a name="ln-6476"></a><span class="k">        ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-6477"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">OASysFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6478"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6479"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-6480"></a>              <span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6481"></a>            <span class="k">ELSE</span>
<a name="ln-6482"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6483"></a>                                                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatSizeRatio</span>
<a name="ln-6484"></a>              <span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6485"></a>            <span class="k">END IF</span>
<a name="ln-6486"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">AirLoopSysFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6487"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6488"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-6489"></a>            <span class="k">ELSE</span>
<a name="ln-6490"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6491"></a>                                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatSizeRatio</span>
<a name="ln-6492"></a>            <span class="k">END IF</span>
<a name="ln-6493"></a><span class="k">            </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6494"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilPresent</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6495"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoolCap</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatSizeRatio</span>
<a name="ln-6496"></a>            <span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6497"></a>          <span class="k">ELSE</span>
<a name="ln-6498"></a>
<a name="ln-6499"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6500"></a><span class="k">              CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6501"></a>              <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6502"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6503"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-6504"></a>                  <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-6505"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-6506"></a>                  <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-6507"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-6508"></a>                <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-6509"></a>                  <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-6510"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-6511"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-6512"></a>                    <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-6513"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-6514"></a>                  <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-6515"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6516"></a><span class="k">                      </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-6517"></a>                    <span class="k">ELSE</span>
<a name="ln-6518"></a><span class="k">                      </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6519"></a>                    <span class="k">END IF</span>
<a name="ln-6520"></a><span class="k">                    </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-6521"></a>                    <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6522"></a>                              <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-6523"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6524"></a>                                <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-6525"></a>                  <span class="k">END IF</span>
<a name="ln-6526"></a><span class="k">                END IF</span>
<a name="ln-6527"></a><span class="k">                </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-6528"></a>                <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6529"></a>                <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6530"></a>                <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6531"></a>                <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6532"></a>                <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-6533"></a>                <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-6534"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6535"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-6536"></a>                <span class="k">ELSE</span>
<a name="ln-6537"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-6538"></a>                <span class="k">END IF</span>
<a name="ln-6539"></a><span class="k">              ELSE</span>
<a name="ln-6540"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6541"></a>              <span class="k">END IF</span>
<a name="ln-6542"></a>
<a name="ln-6543"></a><span class="k">              IF</span><span class="p">(</span><span class="n">RatedTotCapDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6544"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6545"></a>              <span class="k">ELSE</span>
<a name="ln-6546"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6547"></a>              <span class="k">END IF</span>
<a name="ln-6548"></a>              <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-6549"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6550"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6551"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6552"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Heating Capacity will be limited by the minimum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6553"></a>                                           <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6554"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6555"></a>                                            <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6556"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6557"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6558"></a>                                           <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6559"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6560"></a>                                           <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6561"></a>                <span class="k">END IF</span>
<a name="ln-6562"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6563"></a>                                                     <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6564"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6565"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6566"></a>                <span class="k">END IF</span>
<a name="ln-6567"></a><span class="k">              </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6568"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6569"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6570"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Heating Capacity will be limited by the maximum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6571"></a>                                           <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6572"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6573"></a>                                            <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6574"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6575"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6576"></a>                                            <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6577"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Maximum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6578"></a>                                            <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6579"></a>                <span class="k">END IF</span>
<a name="ln-6580"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6581"></a>                                                      <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6582"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6583"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6584"></a>                <span class="k">END IF</span>
<a name="ln-6585"></a><span class="k">              END IF</span>
<a name="ln-6586"></a><span class="k">          </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6587"></a>
<a name="ln-6588"></a><span class="k">              CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6589"></a>              <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6590"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6591"></a><span class="k">                IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6592"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6593"></a><span class="k">                    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-6594"></a>                  <span class="k">ELSE</span>
<a name="ln-6595"></a><span class="k">                    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6596"></a>                                                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatSizeRatio</span>
<a name="ln-6597"></a>                  <span class="k">END IF</span>
<a name="ln-6598"></a><span class="k">                  </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6599"></a>                <span class="k">ELSE</span>
<a name="ln-6600"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6601"></a><span class="k">                    IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6602"></a><span class="k">                      </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-6603"></a>                      <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-6604"></a>                    <span class="k">ELSE</span>
<a name="ln-6605"></a><span class="k">                      </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-6606"></a>                      <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-6607"></a>                    <span class="k">END IF</span>
<a name="ln-6608"></a><span class="k">                  ELSE</span>
<a name="ln-6609"></a><span class="k">                    </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-6610"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-6611"></a>                  <span class="k">END IF</span>
<a name="ln-6612"></a><span class="k">                  </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-6613"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-6614"></a>                  <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-6615"></a>                  <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-6616"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6617"></a><span class="k">                    </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-6618"></a>                  <span class="k">ELSE</span>
<a name="ln-6619"></a><span class="k">                    </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6620"></a>                  <span class="n">ENDIF</span>
<a name="ln-6621"></a>                  <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6622"></a>                  <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6623"></a>                  <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6624"></a>                  <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6625"></a>                  <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-6626"></a>                  <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-6627"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6628"></a><span class="k">                    </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-6629"></a>                  <span class="k">ELSE</span>
<a name="ln-6630"></a><span class="k">                    </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-6631"></a>                  <span class="k">END IF</span>
<a name="ln-6632"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-6633"></a>              <span class="k">ELSE</span>
<a name="ln-6634"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6635"></a>              <span class="k">END IF</span>
<a name="ln-6636"></a><span class="k">              IF</span><span class="p">(</span><span class="n">RatedTotCapDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6637"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6638"></a>              <span class="k">ELSE</span>
<a name="ln-6639"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6640"></a>              <span class="k">END IF</span>
<a name="ln-6641"></a>              <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-6642"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6643"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6644"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6645"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Heating Capacity will be limited by the minimum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6646"></a>                                             <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6647"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6648"></a>                                              <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6649"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6650"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6651"></a>                                              <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6652"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6653"></a>                                              <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6654"></a>                <span class="k">END IF</span>
<a name="ln-6655"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6656"></a>                                                         <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6657"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6658"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6659"></a>                <span class="k">END IF</span>
<a name="ln-6660"></a><span class="k">              ELSE IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6661"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6662"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6663"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Heating Capacity will be limited by the maximum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6664"></a>                                             <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-6665"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6666"></a>                                              <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6667"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6668"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6669"></a>                                              <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6670"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Maximum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6671"></a>                                              <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6672"></a>                <span class="k">END IF</span>
<a name="ln-6673"></a><span class="k">                </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6674"></a>                                                        <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6675"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6676"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6677"></a>                <span class="k">END IF</span>
<a name="ln-6678"></a><span class="k">              END IF</span>
<a name="ln-6679"></a>
<a name="ln-6680"></a><span class="k">            END IF</span> <span class="c">! zone or sys coil</span>
<a name="ln-6681"></a>          <span class="k">END IF</span>
<a name="ln-6682"></a><span class="k">        END IF</span>
<a name="ln-6683"></a>
<a name="ln-6684"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! .AND. .NOT. DXCoil(DXCoilNum)%CoolingCoilPresent) THEN</span>
<a name="ln-6685"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6686"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6687"></a><span class="k">              </span><span class="n">RatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoolCap</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatSizeRatio</span>
<a name="ln-6688"></a>              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6689"></a>            <span class="k">ELSE</span>
<a name="ln-6690"></a><span class="k">              </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">RatedTotCapDes</span>
<a name="ln-6691"></a>            <span class="k">END IF</span>
<a name="ln-6692"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6693"></a>                                  <span class="s1">&#39;Design Size Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">)</span>
<a name="ln-6694"></a>          <span class="k">ELSE</span>
<a name="ln-6695"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedTotCapDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6696"></a><span class="k">              </span><span class="n">RatedTotCapUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6697"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6698"></a>                                  <span class="s1">&#39;Design Size Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6699"></a>                                  <span class="s1">&#39;User-Specified Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCapUser</span><span class="p">)</span>
<a name="ln-6700"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6701"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedTotCapDes</span> <span class="o">-</span> <span class="n">RatedTotCapUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedTotCapUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6702"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6703"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6704"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Total Heating Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6705"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedTotCapUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-6706"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Total Heating Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6707"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedTotCapDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-6708"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6709"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6710"></a>                <span class="k">END IF</span>
<a name="ln-6711"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-6712"></a>            <span class="k">END IF</span>
<a name="ln-6713"></a><span class="k">          END IF</span> <span class="c">! End of design sizing</span>
<a name="ln-6714"></a>        <span class="k">END IF</span> <span class="c">! End of zone/sys coil type  Rated Total Heating Capacity</span>
<a name="ln-6715"></a>      <span class="k">END IF</span> <span class="c">! heating coil</span>
<a name="ln-6716"></a>        <span class="c">! Sizing RatedSHR</span>
<a name="ln-6717"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6718"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6719"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6720"></a>      <span class="k">END IF</span>
<a name="ln-6721"></a>
<a name="ln-6722"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6723"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6724"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6725"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilVRF_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6726"></a>
<a name="ln-6727"></a><span class="k">        </span><span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">RatedInletAirHumRat</span><span class="p">,</span><span class="n">RatedInletAirTemp</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-6728"></a>
<a name="ln-6729"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6730"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6731"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6732"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6733"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6734"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6735"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6736"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6737"></a>                                  <span class="s1">&#39;User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6738"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6739"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6740"></a>                                  <span class="s1">&#39;User-Specified Rated High Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6741"></a>              <span class="k">ELSE</span>
<a name="ln-6742"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6743"></a>                                  <span class="s1">&#39;User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6744"></a>              <span class="k">END IF</span>
<a name="ln-6745"></a><span class="k">            END IF</span>
<a name="ln-6746"></a>
<a name="ln-6747"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-6748"></a>
<a name="ln-6749"></a>            <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6750"></a>
<a name="ln-6751"></a>          <span class="k">END IF</span>
<a name="ln-6752"></a>
<a name="ln-6753"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6754"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6755"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6756"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6757"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6758"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6759"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6760"></a>                                  <span class="s1">&#39;User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6761"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6762"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6763"></a>                                  <span class="s1">&#39;User-Specified Rated High Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6764"></a>              <span class="k">ELSE</span>
<a name="ln-6765"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6766"></a>                                   <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6767"></a>                                  <span class="s1">&#39;User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-6768"></a>              <span class="k">END IF</span>
<a name="ln-6769"></a><span class="k">            END IF</span>
<a name="ln-6770"></a>
<a name="ln-6771"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-6772"></a>
<a name="ln-6773"></a>            <span class="k">CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6774"></a>
<a name="ln-6775"></a>          <span class="k">END IF</span>
<a name="ln-6776"></a>
<a name="ln-6777"></a><span class="k">        END IF</span> <span class="c">! End of Sys/Zone coil type</span>
<a name="ln-6778"></a>
<a name="ln-6779"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6780"></a>
<a name="ln-6781"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFLow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6782"></a>        <span class="c">! For autosizing the rated SHR, we set a minimum SHR of 0.676 and a maximum of 0.798. The min SHR occurs occurs at the</span>
<a name="ln-6783"></a>        <span class="c">! minimum flow / capacity ratio = MinRatedVolFlowPerRatedTotCap = 0.00004027 [m3/s / W] = 300 [cfm/ton].</span>
<a name="ln-6784"></a>        <span class="c">! The max SHR occurs at maximum flow / capacity ratio = MaxRatedVolFlowPerRatedTotCap = 0.00006041 [m3/s / W] = 450 [cfm/ton].</span>
<a name="ln-6785"></a>        <span class="c">! For flow / capacity ratios between the min and max we linearly interpolate between min and max SHR. Thus rated SHR is a</span>
<a name="ln-6786"></a>        <span class="c">! linear function of the rated flow / capacity ratio. This linear function (see below) is the result of a regression</span>
<a name="ln-6787"></a>        <span class="c">! of flow/capacity ratio vs SHR for several actual coils.</span>
<a name="ln-6788"></a>            <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6789"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCT</span> <span class="o">==</span> <span class="n">RegularDXCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6790"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">&gt;</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6791"></a><span class="k">                </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.431d0</span> <span class="o">+</span> <span class="mi">608</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6792"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">&lt;</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6793"></a><span class="k">                </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.431d0</span> <span class="o">+</span> <span class="mi">608</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6794"></a>              <span class="k">ELSE</span>
<a name="ln-6795"></a><span class="k">                </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.431d0</span> <span class="o">+</span> <span class="mi">608</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">RatedVolFlowPerRatedTotCap</span>
<a name="ln-6796"></a>              <span class="k">END IF</span>
<a name="ln-6797"></a><span class="k">            ELSE</span> <span class="c">! DOASDXCoil, or DXCT = 2</span>
<a name="ln-6798"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">&gt;</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6799"></a><span class="k">                </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.389d0</span> <span class="o">+</span> <span class="mi">768</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6800"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">&lt;</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6801"></a><span class="k">                </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.389d0</span> <span class="o">+</span> <span class="mi">768</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-6802"></a>              <span class="k">ELSE</span>
<a name="ln-6803"></a><span class="k">                </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">0.389d0</span> <span class="o">+</span> <span class="mi">768</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">RatedVolFlowPerRatedTotCap</span>
<a name="ln-6804"></a>              <span class="k">END IF</span>
<a name="ln-6805"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-6806"></a>          <span class="k">ELSE</span>
<a name="ln-6807"></a><span class="k">            </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6808"></a>          <span class="k">END IF</span>
<a name="ln-6809"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHREMSOverrideOn</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6810"></a><span class="k">              </span><span class="n">RatedSHRDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHREMSOverrideValue</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<a name="ln-6811"></a>          <span class="k">END IF</span>
<a name="ln-6812"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Design Size values are available for both autosized and hard-sized</span>
<a name="ln-6813"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">RatedSHRDes</span>
<a name="ln-6814"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6815"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6816"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6817"></a>                                  <span class="s1">&#39;Design Size Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRDes</span><span class="p">)</span>
<a name="ln-6818"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6819"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6820"></a>                                  <span class="s1">&#39;Design Size Rated High Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRDes</span><span class="p">)</span>
<a name="ln-6821"></a>            <span class="k">ELSE</span>
<a name="ln-6822"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6823"></a>                                  <span class="s1">&#39;Design Size Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRDes</span><span class="p">)</span>
<a name="ln-6824"></a>            <span class="k">END IF</span>
<a name="ln-6825"></a><span class="k">          ELSE</span>  <span class="c">! Hard size with sizing data</span>
<a name="ln-6826"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedSHRDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6827"></a><span class="k">              </span><span class="n">RatedSHRUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6828"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6829"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6830"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6831"></a>                                  <span class="s1">&#39;Design Size Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6832"></a>                                  <span class="s1">&#39;User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRUser</span><span class="p">)</span>
<a name="ln-6833"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6834"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedSHRDes</span> <span class="o">-</span> <span class="n">RatedSHRUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedSHRUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6835"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6836"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6837"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Sensible Heat Ratio of &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHRUser</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6838"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Sensible Heat Ratio of &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6839"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHRDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6840"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6841"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6842"></a>                  <span class="k">END IF</span>
<a name="ln-6843"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-6844"></a>
<a name="ln-6845"></a>              <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6846"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6847"></a>                                  <span class="s1">&#39;Design Size Rated High Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6848"></a>                                  <span class="s1">&#39;User-Specified Rated High Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRUser</span><span class="p">)</span>
<a name="ln-6849"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6850"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedSHRDes</span> <span class="o">-</span> <span class="n">RatedSHRUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedSHRUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6851"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6852"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6853"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated High Speed Sensible Heat Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6854"></a>                                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHRUser</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6855"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated High Speed Sensible Heat Ratio of &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6856"></a>                                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHRDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6857"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6858"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6859"></a>                  <span class="k">END IF</span>
<a name="ln-6860"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-6861"></a>              <span class="k">ELSE</span>
<a name="ln-6862"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6863"></a>                                  <span class="s1">&#39;Design Size Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6864"></a>                                  <span class="s1">&#39;User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHRUser</span><span class="p">)</span>
<a name="ln-6865"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6866"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedSHRDes</span> <span class="o">-</span> <span class="n">RatedSHRUser</span><span class="p">)</span><span class="o">/</span><span class="n">RatedSHRUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6867"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6868"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6869"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Sensible Heat Ratio of &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHRUser</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6870"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Sensible Heat Ratio of &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6871"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHRDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6872"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6873"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6874"></a>                  <span class="k">END IF</span>
<a name="ln-6875"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-6876"></a>              <span class="k">END IF</span>
<a name="ln-6877"></a><span class="k">            END IF</span>
<a name="ln-6878"></a><span class="k">          END IF</span>
<a name="ln-6879"></a><span class="k">        END IF</span> <span class="c">! End of reproting</span>
<a name="ln-6880"></a>      <span class="k">END IF</span> <span class="c">! End of Rated SHR</span>
<a name="ln-6881"></a>
<a name="ln-6882"></a>        <span class="c">! Sizing evaporator condenser air flow</span>
<a name="ln-6883"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6884"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6885"></a><span class="k">        </span><span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6886"></a>      <span class="k">END IF</span>
<a name="ln-6887"></a>
<a name="ln-6888"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6889"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6890"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6891"></a>
<a name="ln-6892"></a>        <span class="c">! Auto size condenser air flow to Total Capacity * 0.000114 m3/s/w (850 cfm/ton)</span>
<a name="ln-6893"></a>        <span class="n">EvapCondAirFlowDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.000114d0</span>
<a name="ln-6894"></a>        <span class="c">! Design data is always available</span>
<a name="ln-6895"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6896"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCondAirFlowDes</span>
<a name="ln-6897"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6898"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6899"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6900"></a>                                  <span class="s1">&#39;Design Size Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">EvapCondAirFlowDes</span><span class="p">)</span>
<a name="ln-6901"></a>
<a name="ln-6902"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6903"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6904"></a>                                  <span class="s1">&#39;Design Size High Speed Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">EvapCondAirFlowDes</span><span class="p">)</span>
<a name="ln-6905"></a>          <span class="k">ELSE</span>
<a name="ln-6906"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6907"></a>                                  <span class="s1">&#39;Design Size Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">EvapCondAirFlowDes</span><span class="p">)</span>
<a name="ln-6908"></a>          <span class="k">END IF</span>
<a name="ln-6909"></a><span class="k">        ELSE</span> <span class="c">! Hard size with sizig data</span>
<a name="ln-6910"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">EvapCondAirFlowDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6911"></a><span class="k">            </span><span class="n">EvapCondAirFlowUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6912"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6913"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6914"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6915"></a>                                   <span class="s1">&#39;Design Size Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlowDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6916"></a>                                   <span class="s1">&#39;User-Specified Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlowUser</span><span class="p">)</span>
<a name="ln-6917"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6918"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6919"></a>                                  <span class="s1">&#39;Design Size High Speed Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlowDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6920"></a>                                  <span class="s1">&#39;User-Specified High Speed Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlowUser</span><span class="p">)</span>
<a name="ln-6921"></a>            <span class="k">ELSE</span>
<a name="ln-6922"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6923"></a>                                  <span class="s1">&#39;Design Size Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlowDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6924"></a>                                  <span class="s1">&#39;User-Specified Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlowUser</span><span class="p">)</span>
<a name="ln-6925"></a>            <span class="k">END IF</span>
<a name="ln-6926"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6927"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">EvapCondAirFlowDes</span> <span class="o">-</span> <span class="n">EvapCondAirFlowUser</span><span class="p">)</span><span class="o">/</span><span class="n">EvapCondAirFlowUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6928"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6929"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6930"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Evaporative Condenser Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6931"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondAirFlowUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-6932"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Evaporative Condenser Air Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6933"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondAirFlowDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-6934"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6935"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6936"></a>              <span class="k">END IF</span>
<a name="ln-6937"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-6938"></a>          <span class="k">END IF</span>
<a name="ln-6939"></a><span class="k">        END IF</span>
<a name="ln-6940"></a><span class="k">      END IF</span>
<a name="ln-6941"></a>
<a name="ln-6942"></a>        <span class="c">! Sizing evaporative condenser air flow 2</span>
<a name="ln-6943"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6944"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6945"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6946"></a>      <span class="k">END IF</span>
<a name="ln-6947"></a>
<a name="ln-6948"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6949"></a>          <span class="c">! Auto size low speed condenser air flow to 1/3 Total Capacity * 0.000114 m3/s/w (850 cfm/ton)</span>
<a name="ln-6950"></a>        <span class="n">EvapCondAirFlow2Des</span> <span class="o">=</span> <span class="mf">0.3333d0</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.000114d0</span>
<a name="ln-6951"></a>
<a name="ln-6952"></a>          <span class="c">! Design Size data is always available</span>
<a name="ln-6953"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6954"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="o">=</span> <span class="n">EvapCondAirFlow2Des</span>
<a name="ln-6955"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6956"></a>                        <span class="s1">&#39;Design Size Low Speed Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6957"></a>                         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span><span class="p">)</span>
<a name="ln-6958"></a>        <span class="k">ELSE</span>
<a name="ln-6959"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">EvapCondAirFlow2Des</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6960"></a><span class="k">            </span><span class="n">EvapCondAirFlow2User</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span>
<a name="ln-6961"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6962"></a>                        <span class="s1">&#39;Design Size Low Speed Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlow2Des</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6963"></a>                        <span class="s1">&#39;User-Specified Low Speed Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">EvapCondAirFlow2User</span><span class="p">)</span>
<a name="ln-6964"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6965"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">EvapCondAirFlow2Des</span> <span class="o">-</span> <span class="n">EvapCondAirFlow2User</span><span class="p">)</span><span class="o">/</span><span class="n">EvapCondAirFlow2User</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6966"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6967"></a>                                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6968"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Low Speed Evaporative Condenser Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6969"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondAirFlow2User</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-6970"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Low Speed Evaporative Condenser Air Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6971"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondAirFlow2Des</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-6972"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-6973"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-6974"></a>              <span class="k">END IF</span>
<a name="ln-6975"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-6976"></a>          <span class="k">END IF</span>
<a name="ln-6977"></a><span class="k">        END IF</span>
<a name="ln-6978"></a><span class="k">      END IF</span>
<a name="ln-6979"></a>
<a name="ln-6980"></a>        <span class="c">! Sizing evaporative condenser pump electric nominal power</span>
<a name="ln-6981"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6982"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6983"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6984"></a>      <span class="k">END IF</span>
<a name="ln-6985"></a>
<a name="ln-6986"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6987"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6988"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6989"></a>
<a name="ln-6990"></a>         <span class="c">! Auto size high speed evap condenser pump power to Total Capacity * 0.004266 w/w (15 w/ton)</span>
<a name="ln-6991"></a>        <span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.004266d0</span>
<a name="ln-6992"></a>
<a name="ln-6993"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6994"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCondPumpElecNomPowerDes</span>
<a name="ln-6995"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6996"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6997"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6998"></a>                                <span class="s1">&#39;Design Size Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6999"></a>                                <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">)</span>
<a name="ln-7000"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7001"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7002"></a>                                <span class="s1">&#39;Design Size High Speed Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7003"></a>                                <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">)</span>
<a name="ln-7004"></a>          <span class="k">ELSE</span>
<a name="ln-7005"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7006"></a>                                <span class="s1">&#39;Design Size Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7007"></a>                                <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">)</span>
<a name="ln-7008"></a>          <span class="k">END IF</span>
<a name="ln-7009"></a>
<a name="ln-7010"></a><span class="k">        ELSE</span>
<a name="ln-7011"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-7012"></a>               <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7013"></a><span class="k">            </span><span class="n">EvapCondPumpElecNomPowerUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7014"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7015"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7016"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoilPerformanceName</span><span class="p">(</span><span class="n">Mode</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-7017"></a>                                <span class="s1">&#39;Design Size Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7018"></a>                                <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7019"></a>                                <span class="s1">&#39;User-Specified Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7020"></a>                                <span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span>
<a name="ln-7021"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7022"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7023"></a>                                <span class="s1">&#39;Design Size High Speed Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7024"></a>                                <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7025"></a>                                <span class="s1">&#39;User-Specified High Speed Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7026"></a>                                <span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span>
<a name="ln-7027"></a>            <span class="k">ELSE</span>
<a name="ln-7028"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7029"></a>                                <span class="s1">&#39;Design Size Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7030"></a>                                <span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7031"></a>                                <span class="s1">&#39;User-Specified Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7032"></a>                                <span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span>
<a name="ln-7033"></a>            <span class="k">END IF</span>
<a name="ln-7034"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7035"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPowerDes</span> <span class="o">-</span> <span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span><span class="o">/</span><span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-7036"></a>                                   <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7037"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7038"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7039"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Evaporative Condenser Pump Rated Power Consumption of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7040"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPowerUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7041"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Evaporative Condenser Pump Rated Power Consumption of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7042"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPowerDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7043"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7044"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7045"></a>              <span class="k">END IF</span>
<a name="ln-7046"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7047"></a>          <span class="k">END IF</span>
<a name="ln-7048"></a><span class="k">        END IF</span>
<a name="ln-7049"></a><span class="k">      END IF</span>
<a name="ln-7050"></a>
<a name="ln-7051"></a>        <span class="c">! Sizing low speed evaporative condenser pump electric nominal power</span>
<a name="ln-7052"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7053"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7054"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7055"></a>      <span class="k">END IF</span>
<a name="ln-7056"></a>
<a name="ln-7057"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7058"></a>
<a name="ln-7059"></a>          <span class="c">!Auto size low speed evap condenser pump power to 1/3 Total Capacity * 0.004266 w/w (15 w/ton)</span>
<a name="ln-7060"></a>        <span class="n">EvapCondPumpElecNomPower2Des</span> <span class="o">=</span> <span class="mf">0.3333d0</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.004266d0</span>
<a name="ln-7061"></a>
<a name="ln-7062"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7063"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="o">=</span> <span class="n">EvapCondPumpElecNomPower2Des</span>
<a name="ln-7064"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7065"></a>                              <span class="s1">&#39;Design Size Low Speed Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7066"></a>                               <span class="n">EvapCondPumpElecNomPower2Des</span><span class="p">)</span>
<a name="ln-7067"></a>        <span class="k">ELSE</span>
<a name="ln-7068"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">EvapCondPumpElecNomPower2Des</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-7069"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7070"></a><span class="k">            </span><span class="n">EvapCondPumpElecNomPower2User</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span>
<a name="ln-7071"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7072"></a>                              <span class="s1">&#39;Design Size Low Speed Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7073"></a>                               <span class="n">EvapCondPumpElecNomPower2Des</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7074"></a>                              <span class="s1">&#39;User-Specified Low Speed Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7075"></a>                               <span class="n">EvapCondPumpElecNomPower2User</span><span class="p">)</span>
<a name="ln-7076"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7077"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPower2Des</span> <span class="o">-</span> <span class="n">EvapCondPumpElecNomPower2User</span><span class="p">)</span><span class="o">/</span><span class="n">EvapCondPumpElecNomPower2User</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7078"></a>                                                       <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7079"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span><span class="p">&amp;</span>
<a name="ln-7080"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7081"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Low Speed Evaporative Condenser Pump Rated Power Consumption of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7082"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPower2User</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7083"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Low Speed Evaporative Condenser Pump Rated Power Consumption&#39;</span> <span class="p">&amp;</span>
<a name="ln-7084"></a>                                      <span class="o">//</span> <span class="s1">&#39; of &#39;</span> <span class="o">//</span>   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EvapCondPumpElecNomPower2Des</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7085"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7086"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7087"></a>              <span class="k">END IF</span>
<a name="ln-7088"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7089"></a>          <span class="k">END IF</span>
<a name="ln-7090"></a><span class="k">        END IF</span>
<a name="ln-7091"></a><span class="k">      END IF</span>
<a name="ln-7092"></a>
<a name="ln-7093"></a>        <span class="c">! Sizing rated low speed air flow rate</span>
<a name="ln-7094"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7095"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7096"></a><span class="k">        </span><span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7097"></a>      <span class="k">END IF</span>
<a name="ln-7098"></a>
<a name="ln-7099"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7100"></a><span class="k">        </span><span class="n">RatedAirVolFlowRate2Des</span> <span class="o">=</span> <span class="mf">0.3333d0</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7101"></a>
<a name="ln-7102"></a>          <span class="c">! Design Size data is always available</span>
<a name="ln-7103"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7104"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span> <span class="o">=</span> <span class="n">RatedAirVolFlowRate2Des</span>
<a name="ln-7105"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7106"></a>                                  <span class="s1">&#39;Design Size Rated Low Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRate2Des</span><span class="p">)</span>
<a name="ln-7107"></a>        <span class="k">ELSE</span>
<a name="ln-7108"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedAirVolFlowRate2Des</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-7109"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7110"></a><span class="k">            </span><span class="n">RatedAirVolFlowRate2User</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span>
<a name="ln-7111"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7112"></a>                                  <span class="s1">&#39;Design Size Rated Low Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRate2Des</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7113"></a>                                  <span class="s1">&#39;User-Specified Rated Low Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">RatedAirVolFlowRate2User</span><span class="p">)</span>
<a name="ln-7114"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7115"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedAirVolFlowRate2Des</span> <span class="o">-</span> <span class="n">RatedAirVolFlowRate2User</span><span class="p">)</span><span class="o">/</span><span class="n">RatedAirVolFlowRate2User</span><span class="p">)</span> <span class="o">&gt;</span>   <span class="p">&amp;</span>
<a name="ln-7116"></a>                      <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7117"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7118"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7119"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Low Speed Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7120"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRate2User</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7121"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Low Speed Air Flow Rate  of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7122"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedAirVolFlowRate2Des</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7123"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7124"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7125"></a>              <span class="k">END IF</span>
<a name="ln-7126"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7127"></a>          <span class="k">END IF</span>
<a name="ln-7128"></a><span class="k">        END IF</span>
<a name="ln-7129"></a><span class="k">      END IF</span>
<a name="ln-7130"></a>
<a name="ln-7131"></a>        <span class="c">! Sizing rated low speed total cooling capacity</span>
<a name="ln-7132"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7133"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7134"></a><span class="k">        </span><span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7135"></a>      <span class="k">END IF</span>
<a name="ln-7136"></a>
<a name="ln-7137"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7138"></a><span class="k">        </span><span class="n">RatedTotCap2Des</span> <span class="o">=</span> <span class="mf">0.3333d0</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7139"></a>
<a name="ln-7140"></a>          <span class="c">! Design Size data is always available</span>
<a name="ln-7141"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7142"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">=</span> <span class="n">RatedTotCap2Des</span>
<a name="ln-7143"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7144"></a>                                  <span class="s1">&#39;Design Size Rated Low Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCap2Des</span><span class="p">)</span>
<a name="ln-7145"></a>        <span class="k">ELSE</span>
<a name="ln-7146"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedTotCap2Des</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">&amp;</span>
<a name="ln-7147"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7148"></a><span class="k">            </span><span class="n">RatedTotCap2User</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>
<a name="ln-7149"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7150"></a>                                  <span class="s1">&#39;Design Size Rated Low Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCap2Des</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7151"></a>                                  <span class="s1">&#39;User-Specified Rated Low Speed Total Cooling Capacity (gross) [W]&#39;</span><span class="p">,</span> <span class="n">RatedTotCap2User</span><span class="p">)</span>
<a name="ln-7152"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7153"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedTotCap2Des</span> <span class="o">-</span> <span class="n">RatedTotCap2User</span><span class="p">)</span><span class="o">/</span><span class="n">RatedTotCap2User</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7154"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7155"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7156"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Low Speed Total Cooling Capacity (gross) of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7157"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedTotCap2User</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7158"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Low Speed Total Cooling Capacity (gross) of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7159"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedTotCap2Des</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7160"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7161"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7162"></a>              <span class="k">END IF</span>
<a name="ln-7163"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7164"></a>          <span class="k">END IF</span>
<a name="ln-7165"></a><span class="k">        END IF</span>
<a name="ln-7166"></a><span class="k">      END IF</span>
<a name="ln-7167"></a>
<a name="ln-7168"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7169"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7170"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7171"></a>                  <span class="s1">&#39;Evaporative Condenser low speed air flow must be less than or equal to high speed air flow.&#39;</span><span class="p">)</span>
<a name="ln-7172"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7173"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7174"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7175"></a>        <span class="k">END IF</span>
<a name="ln-7176"></a>
<a name="ln-7177"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7178"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7179"></a>                  <span class="s1">&#39;Evaporative Condenser low speed pump power must be less than or equal to high speed pump power.&#39;</span><span class="p">)</span>
<a name="ln-7180"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7181"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7182"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7183"></a>        <span class="k">END IF</span>
<a name="ln-7184"></a>
<a name="ln-7185"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7186"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7187"></a>                  <span class="s1">&#39;Rated Total Cooling Capacity, Low Speed must be less than or equal to &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7188"></a>                  <span class="s1">&#39;Rated Total Cooling Capacity, High Speed.&#39;</span><span class="p">)</span>
<a name="ln-7189"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7190"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7191"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7192"></a>        <span class="k">END IF</span>
<a name="ln-7193"></a>
<a name="ln-7194"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7195"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7196"></a>                  <span class="s1">&#39;Rated Air Volume Flow Rate, low speed must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7197"></a>                  <span class="s1">&#39;Rated Air Volume Flow Rate, high speed.&#39;</span><span class="p">)</span>
<a name="ln-7198"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7199"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7200"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7201"></a>        <span class="k">END IF</span>
<a name="ln-7202"></a><span class="k">      END IF</span>
<a name="ln-7203"></a>    <span class="c">!END IF</span>
<a name="ln-7204"></a>
<a name="ln-7205"></a>        <span class="c">! Sizing rated low speed SHR2</span>
<a name="ln-7206"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7207"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7208"></a><span class="k">        </span><span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7209"></a>      <span class="k">END IF</span>
<a name="ln-7210"></a>
<a name="ln-7211"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7212"></a><span class="k">        </span><span class="n">RatedSHR2Des</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7213"></a>          <span class="c">! Design Size data is always available</span>
<a name="ln-7214"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7215"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span> <span class="o">=</span> <span class="n">RatedSHR2Des</span>
<a name="ln-7216"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7217"></a>                                  <span class="s1">&#39;Design Size Rated Low Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHR2Des</span><span class="p">)</span>
<a name="ln-7218"></a>        <span class="k">ELSE</span>
<a name="ln-7219"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RatedSHR2Des</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7220"></a><span class="k">            </span><span class="n">RatedSHR2User</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span>
<a name="ln-7221"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7222"></a>                                  <span class="s1">&#39;Design Size Rated Low Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHR2Des</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7223"></a>                                  <span class="s1">&#39;User-Specified Rated Low Speed Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">RatedSHR2User</span><span class="p">)</span>
<a name="ln-7224"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7225"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatedSHR2Des</span> <span class="o">-</span> <span class="n">RatedSHR2User</span><span class="p">)</span><span class="o">/</span><span class="n">RatedSHR2User</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7226"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7227"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7228"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Low Speed Sensible Heat Ratio of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7229"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHR2User</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7230"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Low Speed Sensible Heat Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7231"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHR2Des</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7232"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7233"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7234"></a>              <span class="k">END IF</span>
<a name="ln-7235"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7236"></a>          <span class="k">END IF</span>
<a name="ln-7237"></a><span class="k">        END IF</span>
<a name="ln-7238"></a><span class="k">      END IF</span>
<a name="ln-7239"></a>
<a name="ln-7240"></a>        <span class="c">! Sizing resistive defrost heater capacity</span>
<a name="ln-7241"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7242"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7243"></a><span class="k">        </span><span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7244"></a>      <span class="k">END IF</span>
<a name="ln-7245"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7246"></a>      <span class="c">!IF (DXCoil(DXCoilNum)%DXCoilType_Num == CoilDX_MultiSpeedHeating .OR. &amp;</span>
<a name="ln-7247"></a>      <span class="c">!    DXCoil(DXCoilNum)%DXCoilType_Num == Coil_HeatingAirToAirVariableSpeed) THEN</span>
<a name="ln-7248"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">==</span> <span class="n">Resistive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7249"></a><span class="k">          </span><span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-7250"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7251"></a><span class="k">            </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="n">DefrostCapacityDes</span>
<a name="ln-7252"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7253"></a>                                <span class="s1">&#39;Design Size Resistive Defrost Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityDes</span><span class="p">)</span>
<a name="ln-7254"></a>          <span class="k">ELSE</span>
<a name="ln-7255"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DefrostCapacityDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7256"></a><span class="k">              </span><span class="n">DefrostCapacityUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span>
<a name="ln-7257"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7258"></a>                                <span class="s1">&#39;Design Size Resistive Defrost Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7259"></a>                                <span class="s1">&#39;User-Specified Resistive Defrost Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityUser</span><span class="p">)</span>
<a name="ln-7260"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7261"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DefrostCapacityDes</span> <span class="o">-</span> <span class="n">DefrostCapacityUser</span><span class="p">)</span><span class="o">/</span><span class="n">DefrostCapacityUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7262"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7263"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7264"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Resistive Defrost Heater Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7265"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DefrostCapacityUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7266"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Resistive Defrost Heater Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7267"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DefrostCapacityDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7268"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7269"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7270"></a>                <span class="k">END IF</span>
<a name="ln-7271"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-7272"></a>            <span class="k">END IF</span>
<a name="ln-7273"></a><span class="k">          END IF</span>
<a name="ln-7274"></a><span class="k">        ELSE</span>
<a name="ln-7275"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7276"></a>        <span class="k">END IF</span>
<a name="ln-7277"></a><span class="k">      END IF</span>
<a name="ln-7278"></a>
<a name="ln-7279"></a><span class="k">    END DO</span> <span class="c">! End capacity stages loop</span>
<a name="ln-7280"></a>  <span class="k">END DO</span> <span class="c">! End dehumidification modes loop</span>
<a name="ln-7281"></a>
<a name="ln-7282"></a>    <span class="c">! Autosizing for multispeed cooling coil</span>
<a name="ln-7283"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7284"></a>    <span class="c">! flow rate auto size</span>
<a name="ln-7285"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7286"></a>        <span class="c">! Sizing multispeed air volume flow rate</span>
<a name="ln-7287"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7288"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7289"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7290"></a>      <span class="k">END IF</span>
<a name="ln-7291"></a>
<a name="ln-7292"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="o">==</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7293"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7294"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span> <span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7295"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7296"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7297"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7298"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7299"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7300"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7301"></a>            <span class="k">END IF</span>
<a name="ln-7302"></a><span class="k">          ELSE</span>
<a name="ln-7303"></a><span class="k">            CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7304"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7305"></a><span class="k">              </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-7306"></a>            <span class="k">ELSE</span>
<a name="ln-7307"></a><span class="k">              </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-7308"></a>            <span class="k">END IF</span>
<a name="ln-7309"></a><span class="k">          END IF</span>
<a name="ln-7310"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7311"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7312"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7313"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7314"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7315"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7316"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7317"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7318"></a>            <span class="k">END IF</span>
<a name="ln-7319"></a><span class="k">          ELSE</span>
<a name="ln-7320"></a><span class="k">            CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7321"></a>            <span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7322"></a>                                                      <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-7323"></a>          <span class="k">END IF</span>
<a name="ln-7324"></a><span class="k">        END IF</span>
<a name="ln-7325"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7326"></a><span class="k">          </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7327"></a>        <span class="k">END IF</span>
<a name="ln-7328"></a><span class="k">      ELSE</span>
<a name="ln-7329"></a><span class="k">        </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7330"></a>                                                       <span class="n">Mode</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7331"></a>      <span class="k">END IF</span>
<a name="ln-7332"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7333"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7334"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSRatedAirVolFlowRateDes</span>
<a name="ln-7335"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7336"></a>                    <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7337"></a>                    <span class="n">MSRatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-7338"></a>        <span class="k">ELSE</span>
<a name="ln-7339"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">&amp;</span>
<a name="ln-7340"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7341"></a><span class="k">            </span><span class="n">MSRatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7342"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7343"></a>                    <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7344"></a>                    <span class="n">MSRatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7345"></a>                    <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7346"></a>                    <span class="n">MSRatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-7347"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7348"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">MSRatedAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSRatedAirVolFlowRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7349"></a>                                     <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7350"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7351"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7352"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Air Volume Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7353"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7354"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Air Volume Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7355"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7356"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7357"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7358"></a>              <span class="k">END IF</span>
<a name="ln-7359"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7360"></a>          <span class="k">END IF</span>
<a name="ln-7361"></a><span class="k">        END IF</span>
<a name="ln-7362"></a><span class="k">      END IF</span>
<a name="ln-7363"></a><span class="k">    END DO</span>
<a name="ln-7364"></a>
<a name="ln-7365"></a>      <span class="c">! Ensure flow rate at lower speed must be lower or equal to the flow rate at higher speed. Otherwise, a severe error is isssued.</span>
<a name="ln-7366"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7367"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7368"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7369"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7370"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate.&#39;</span><span class="p">)</span>
<a name="ln-7371"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7372"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7373"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7374"></a>      <span class="k">END IF</span>
<a name="ln-7375"></a><span class="k">    END DO</span>
<a name="ln-7376"></a>
<a name="ln-7377"></a>      <span class="c">! Sizing multispeed rated total capacity</span>
<a name="ln-7378"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7379"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7380"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7381"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7382"></a>      <span class="k">END IF</span>
<a name="ln-7383"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7384"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7385"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7386"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7387"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7388"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7389"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7390"></a>                    <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7391"></a>                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7392"></a>            <span class="k">END IF</span>
<a name="ln-7393"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-7394"></a>            <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7395"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7396"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7397"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-7398"></a>                <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-7399"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-7400"></a>                <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-7401"></a>                <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-7402"></a>              <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-7403"></a>                <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-7404"></a>                <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-7405"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-7406"></a>                  <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-7407"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-7408"></a>                <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-7409"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7410"></a><span class="k">                    </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-7411"></a>                  <span class="k">ELSE</span>
<a name="ln-7412"></a><span class="k">                    </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7413"></a>                  <span class="k">END IF</span>
<a name="ln-7414"></a><span class="k">                  </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-7415"></a>                  <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7416"></a>                              <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-7417"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7418"></a>                                <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-7419"></a>                <span class="k">END IF</span>
<a name="ln-7420"></a><span class="k">              END IF</span>
<a name="ln-7421"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-7422"></a>              <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7423"></a>              <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7424"></a>              <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7425"></a>              <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7426"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-7427"></a>              <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-7428"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7429"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-7430"></a>              <span class="k">ELSE</span>
<a name="ln-7431"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-7432"></a>              <span class="k">END IF</span>
<a name="ln-7433"></a><span class="k">              IF</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7434"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">MSRatedTotCapDes</span>
<a name="ln-7435"></a>              <span class="k">ELSE</span>
<a name="ln-7436"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7437"></a>              <span class="k">END IF</span>
<a name="ln-7438"></a>              <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-7439"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7440"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7441"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7442"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the minimum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7443"></a>                                         <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-7444"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil speed = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-7445"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7446"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7447"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7448"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7449"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7450"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7451"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7452"></a>                <span class="k">END IF</span>
<a name="ln-7453"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-7454"></a>
<a name="ln-7455"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7456"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7457"></a>                <span class="k">END IF</span>
<a name="ln-7458"></a><span class="k">              </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7459"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7460"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7461"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the maximum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7462"></a>                                         <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-7463"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil speed = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-7464"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7465"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7466"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7467"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7468"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7469"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Maximum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7470"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7471"></a>                <span class="k">END IF</span>
<a name="ln-7472"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-7473"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7474"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7475"></a>                <span class="k">END IF</span>
<a name="ln-7476"></a><span class="k">              END IF</span>
<a name="ln-7477"></a><span class="k">            ELSE</span>
<a name="ln-7478"></a><span class="k">              </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7479"></a>            <span class="k">END IF</span>
<a name="ln-7480"></a><span class="k">          END IF</span>
<a name="ln-7481"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7482"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7483"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7484"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7485"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7486"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7487"></a>                    <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7488"></a>                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7489"></a>            <span class="k">END IF</span>
<a name="ln-7490"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-7491"></a>            <span class="k">CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7492"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7493"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7494"></a><span class="k">              </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-7495"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-7496"></a>              <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-7497"></a>              <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-7498"></a>              <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-7499"></a>              <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-7500"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7501"></a><span class="k">                </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-7502"></a>              <span class="k">ELSE</span>
<a name="ln-7503"></a><span class="k">                </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7504"></a>              <span class="n">ENDIF</span>
<a name="ln-7505"></a>              <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7506"></a>              <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7507"></a>              <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7508"></a>              <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-7509"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-7510"></a>              <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-7511"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7512"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-7513"></a>              <span class="k">ELSE</span>
<a name="ln-7514"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-7515"></a>              <span class="k">END IF</span>
<a name="ln-7516"></a><span class="k">              IF</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7517"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">MSRatedTotCapDes</span>
<a name="ln-7518"></a>              <span class="k">ELSE</span>
<a name="ln-7519"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7520"></a>              <span class="k">END IF</span>
<a name="ln-7521"></a>              <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-7522"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7523"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7524"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7525"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the minimum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7526"></a>                                         <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-7527"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil speed = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-7528"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7529"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7530"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7531"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7532"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7533"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7534"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7535"></a>                <span class="k">END IF</span>
<a name="ln-7536"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7537"></a>                                                      <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-7538"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7539"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7540"></a>                <span class="k">END IF</span>
<a name="ln-7541"></a><span class="k">              ELSE IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7542"></a><span class="k">                IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7543"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7544"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Cooling Capacity will be limited by the maximum rated volume flow per&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7545"></a>                                         <span class="s1">&#39; rated total capacity ratio.&#39;</span><span class="p">)</span>
<a name="ln-7546"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil speed = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-7547"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...DX coil volume flow rate (m3/s) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7548"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7549"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7550"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Requested flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7551"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7552"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Maximum flow/capacity ratio (m3/s/W) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7553"></a>                                          <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7554"></a>                <span class="k">END IF</span>
<a name="ln-7555"></a><span class="k">                </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7556"></a>                                                      <span class="o">/</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-7557"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7558"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Adjusted capacity (W) = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7559"></a>                <span class="k">END IF</span>
<a name="ln-7560"></a><span class="k">              END IF</span>
<a name="ln-7561"></a><span class="k">            ELSE</span>
<a name="ln-7562"></a><span class="k">              </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7563"></a>            <span class="k">END IF</span>
<a name="ln-7564"></a><span class="k">          END IF</span>
<a name="ln-7565"></a><span class="k">        END IF</span>
<a name="ln-7566"></a><span class="k">      ELSE</span>
<a name="ln-7567"></a><span class="k">        </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7568"></a>                                                         <span class="n">Mode</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7569"></a>      <span class="k">END IF</span>
<a name="ln-7570"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7571"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7572"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSRatedTotCapDes</span>
<a name="ln-7573"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7574"></a>                 <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="n">MSRatedTotCapDes</span><span class="p">)</span>
<a name="ln-7575"></a>        <span class="k">ELSE</span>
<a name="ln-7576"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSRatedTotCapDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7577"></a><span class="k">            </span><span class="n">MSRatedTotCapUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7578"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7579"></a>                 <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="n">MSRatedTotCapDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7580"></a>                 <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Total Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="n">MSRatedTotCapUser</span><span class="p">)</span>
<a name="ln-7581"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7582"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span> <span class="o">-</span> <span class="n">MSRatedTotCapUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSRatedTotCapUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7583"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7584"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7585"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Total Cooling Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7586"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7587"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Totla Cooling Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7588"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7589"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7590"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7591"></a>              <span class="k">END IF</span>
<a name="ln-7592"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7593"></a>          <span class="k">END IF</span>
<a name="ln-7594"></a><span class="k">        END IF</span>
<a name="ln-7595"></a><span class="k">      END IF</span>
<a name="ln-7596"></a><span class="k">    END DO</span>
<a name="ln-7597"></a>
<a name="ln-7598"></a>       <span class="c">! Ensure capacity at lower speed must be lower or equal to the capacity at higher speed.</span>
<a name="ln-7599"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7600"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7601"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7602"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Total Cooling Capacity must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7603"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Total Cooling Capacity.&#39;</span><span class="p">)</span>
<a name="ln-7604"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7605"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7606"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7607"></a>      <span class="k">END IF</span>
<a name="ln-7608"></a><span class="k">    END DO</span>
<a name="ln-7609"></a>
<a name="ln-7610"></a>    <span class="c">! Rated SHR</span>
<a name="ln-7611"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7612"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7613"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7614"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7615"></a>      <span class="k">END IF</span>
<a name="ln-7616"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7617"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7618"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7619"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7620"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7621"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7622"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7623"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7624"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7625"></a>            <span class="k">END IF</span>
<a name="ln-7626"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-7627"></a>            <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7628"></a>          <span class="k">END IF</span>
<a name="ln-7629"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7630"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisZone</span><span class="p">)</span>  <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7631"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7632"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7633"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7634"></a><span class="k">             CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7635"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7636"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7637"></a>            <span class="k">END IF</span>
<a name="ln-7638"></a><span class="k">          ELSE</span> <span class="c">! autosize or hard-sized with system sizing data</span>
<a name="ln-7639"></a>            <span class="k">CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7640"></a>          <span class="k">END IF</span>
<a name="ln-7641"></a><span class="k">        END IF</span>
<a name="ln-7642"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFLow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-7643"></a>            <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7644"></a>    <span class="c">! For autosizing the rated SHR, we set a minimum SHR of 0.676 and a maximum of 0.798. The min SHR occurs occurs at the</span>
<a name="ln-7645"></a>    <span class="c">! minimum flow / capacity ratio = MinRatedVolFlowPerRatedTotCap = 0.00004027 [m3/s / W] = 300 [cfm/ton].</span>
<a name="ln-7646"></a>    <span class="c">! The max SHR occurs at maximum flow / capacity ratio = MaxRatedVolFlowPerRatedTotCap = 0.00006041 [m3/s / W] = 450 [cfm/ton].</span>
<a name="ln-7647"></a>    <span class="c">! For flow / capacity ratios between the min and max we linearly interpolate between min and max SHR. Thus rated SHR is a</span>
<a name="ln-7648"></a>    <span class="c">! linear function of the rated flow / capacity ratio. This linear function (see below) is the result of a regression</span>
<a name="ln-7649"></a>    <span class="c">! of flow/capacity ratio vs SHR for several actual coils.</span>
<a name="ln-7650"></a>          <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7651"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">&gt;</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7652"></a><span class="k">            </span><span class="n">MSRatedSHRDes</span> <span class="o">=</span> <span class="mf">0.431d0</span> <span class="o">+</span> <span class="mi">608</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-7653"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">&lt;</span> <span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7654"></a><span class="k">            </span><span class="n">MSRatedSHRDes</span> <span class="o">=</span> <span class="mf">0.431d0</span> <span class="o">+</span> <span class="mi">608</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span>
<a name="ln-7655"></a>          <span class="k">ELSE</span>
<a name="ln-7656"></a><span class="k">            </span><span class="n">MSRatedSHRDes</span> <span class="o">=</span> <span class="mf">0.431d0</span> <span class="o">+</span> <span class="mi">608</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">RatedVolFlowPerRatedTotCap</span>
<a name="ln-7657"></a>          <span class="k">END IF</span>
<a name="ln-7658"></a><span class="k">        ELSE</span>
<a name="ln-7659"></a><span class="k">          </span><span class="n">MSRatedSHRDes</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7660"></a>        <span class="k">END IF</span>
<a name="ln-7661"></a><span class="k">      ELSE</span>
<a name="ln-7662"></a><span class="k">        </span><span class="n">MSRatedSHRDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7663"></a>      <span class="k">END IF</span>
<a name="ln-7664"></a>
<a name="ln-7665"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7666"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7667"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSRatedSHRDes</span>
<a name="ln-7668"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7669"></a>                <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">MSRatedSHRDes</span><span class="p">)</span>
<a name="ln-7670"></a>        <span class="k">ELSE</span>
<a name="ln-7671"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSRatedSHRDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7672"></a><span class="k">            </span><span class="n">MSRatedSHRUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7673"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7674"></a>                 <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">MSRatedSHRDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7675"></a>                 <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Sensible Heat Ratio&#39;</span><span class="p">,</span> <span class="n">MSRatedSHRUser</span><span class="p">)</span>
<a name="ln-7676"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7677"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSRatedSHRDes</span> <span class="o">-</span> <span class="n">MSRatedSHRUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSRatedSHRUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7678"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7679"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7680"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Sensible Heat Ratio of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7681"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedSHRUser</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7682"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Sensible Heat Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7683"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedSHRDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7684"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7685"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7686"></a>              <span class="k">END IF</span>
<a name="ln-7687"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7688"></a>          <span class="k">END IF</span>
<a name="ln-7689"></a><span class="k">        END IF</span>
<a name="ln-7690"></a><span class="k">      END IF</span>
<a name="ln-7691"></a><span class="k">    END DO</span>
<a name="ln-7692"></a>
<a name="ln-7693"></a>      <span class="c">! Rated Evapovative condenser airflow rates</span>
<a name="ln-7694"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7695"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7696"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7697"></a><span class="k">        </span><span class="n">IsAutoSize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7698"></a>      <span class="k">END IF</span>
<a name="ln-7699"></a>        <span class="c">! Auto size condenser air flow to Total Capacity * 0.000114 m3/s/w (850 cfm/ton)</span>
<a name="ln-7700"></a>      <span class="n">MSEvapCondAirFlowDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.000114d0</span>
<a name="ln-7701"></a>
<a name="ln-7702"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7703"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSEvapCondAirFlowDes</span>
<a name="ln-7704"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7705"></a>            <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">MSEvapCondAirFlowDes</span><span class="p">)</span>
<a name="ln-7706"></a>      <span class="k">ELSE</span>
<a name="ln-7707"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSEvapCondAirFlowDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7708"></a><span class="k">          </span><span class="n">MSEvapCondAirFlowUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7709"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7710"></a>             <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">MSEvapCondAirFlowDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7711"></a>             <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Evaporative Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7712"></a>             <span class="n">MSEvapCondAirFlowUser</span><span class="p">)</span>
<a name="ln-7713"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7714"></a><span class="k">            IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSEvapCondAirFlowDes</span> <span class="o">-</span> <span class="n">MSEvapCondAirFlowUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSEvapCondAirFlowUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7715"></a><span class="k">              CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7716"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7717"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Evaporative Condenser Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7718"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSEvapCondAirFlowUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7719"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Evaporative Condenser Air Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7720"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSEvapCondAirFlowDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7721"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7722"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7723"></a>            <span class="k">END IF</span>
<a name="ln-7724"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7725"></a>        <span class="k">END IF</span>
<a name="ln-7726"></a><span class="k">      END IF</span>
<a name="ln-7727"></a><span class="k">    END DO</span>
<a name="ln-7728"></a>
<a name="ln-7729"></a>     <span class="c">! Ensure evaporative condesner airflow rate at lower speed must be lower or equal to one at higher speed.</span>
<a name="ln-7730"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7731"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7732"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7733"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Evaporative Condenser Air Flow Rate must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7734"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Evaporative Condenser Air Flow Rate.&#39;</span><span class="p">)</span>
<a name="ln-7735"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7736"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7737"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7738"></a>      <span class="k">END IF</span>
<a name="ln-7739"></a><span class="k">    END DO</span>
<a name="ln-7740"></a>
<a name="ln-7741"></a>      <span class="c">! Sizing multispeed rated evapovative condenser pump power</span>
<a name="ln-7742"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7743"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7744"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7745"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7746"></a>      <span class="k">END IF</span>
<a name="ln-7747"></a>        <span class="c">! Auto size low speed evap condenser pump power to 1/3 Total Capacity * 0.004266 w/w (15 w/ton)</span>
<a name="ln-7748"></a>      <span class="n">MSEvapCondPumpElecNomPowerDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.004266d0</span>
<a name="ln-7749"></a>        <span class="c">! Design Size data is always available</span>
<a name="ln-7750"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7751"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSEvapCondPumpElecNomPowerDes</span>
<a name="ln-7752"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7753"></a>               <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Evaporative Condenser Pump Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7754"></a>                <span class="n">MSEvapCondPumpElecNomPowerDes</span><span class="p">)</span>
<a name="ln-7755"></a>      <span class="k">ELSE</span>
<a name="ln-7756"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSEvapCondPumpElecNomPowerDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-7757"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7758"></a><span class="k">          </span><span class="n">MSEvapCondPumpElecNomPowerUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7759"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7760"></a>               <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Evaporative Condenser Pump Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7761"></a>                <span class="n">MSEvapCondPumpElecNomPowerDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7762"></a>               <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Evaporative Condenser Pump Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7763"></a>                <span class="n">MSEvapCondPumpElecNomPowerUser</span><span class="p">)</span>
<a name="ln-7764"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7765"></a><span class="k">            IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSEvapCondPumpElecNomPowerDes</span> <span class="o">-</span> <span class="n">MSEvapCondPumpElecNomPowerUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSEvapCondPumpElecNomPowerUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7766"></a>                              <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7767"></a><span class="k">              CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7768"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7769"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Evaporative Condenser Pump Rated Power Consumption of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7770"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSEvapCondPumpElecNomPowerUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7771"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Evaporative Condenser Pump Rated Power Consumption of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7772"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSEvapCondPumpElecNomPowerDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7773"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7774"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7775"></a>            <span class="k">END IF</span>
<a name="ln-7776"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7777"></a>        <span class="k">END IF</span>
<a name="ln-7778"></a><span class="k">      END IF</span>
<a name="ln-7779"></a><span class="k">    END DO</span>
<a name="ln-7780"></a>
<a name="ln-7781"></a>   <span class="c">! Ensure evaporative condesner pump power at lower speed must be lower or equal to one at higher speed.</span>
<a name="ln-7782"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7783"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7784"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7785"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7786"></a>             <span class="s1">&#39; Rated Evaporative Condenser Pump Power Consumption must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7787"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7788"></a>             <span class="s1">&#39; Rated Evaporative Condenser Pump Power Consumption.&#39;</span><span class="p">)</span>
<a name="ln-7789"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7790"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7791"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7792"></a>      <span class="k">END IF</span>
<a name="ln-7793"></a><span class="k">    END DO</span>
<a name="ln-7794"></a><span class="k">  END IF</span>
<a name="ln-7795"></a>
<a name="ln-7796"></a>  <span class="c">! Autosizing for multispeed heating coil</span>
<a name="ln-7797"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7798"></a>    <span class="c">! flow rate auto size</span>
<a name="ln-7799"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7800"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7801"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7802"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7803"></a>      <span class="k">END IF</span>
<a name="ln-7804"></a>        <span class="c">! Sizing rated air flow rate</span>
<a name="ln-7805"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="o">==</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7806"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7807"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizingDesRunThisAirSys</span><span class="p">)</span>  <span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7808"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7809"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7810"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7811"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7812"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7813"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7814"></a>            <span class="k">END IF</span>
<a name="ln-7815"></a><span class="k">          ELSE</span>
<a name="ln-7816"></a><span class="k">            CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7817"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7818"></a><span class="k">              </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-7819"></a>            <span class="k">ELSE</span>
<a name="ln-7820"></a><span class="k">              </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-7821"></a>            <span class="k">END IF</span>
<a name="ln-7822"></a><span class="k">          END IF</span>
<a name="ln-7823"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7824"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7825"></a><span class="k">            </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7826"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7827"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7828"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7829"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-7830"></a>            <span class="k">END IF</span>
<a name="ln-7831"></a><span class="k">          ELSE</span>
<a name="ln-7832"></a><span class="k">            CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7833"></a>            <span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-7834"></a>               <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-7835"></a>          <span class="k">END IF</span>
<a name="ln-7836"></a><span class="k">        END IF</span>
<a name="ln-7837"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7838"></a><span class="k">          </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7839"></a>        <span class="k">END IF</span>
<a name="ln-7840"></a><span class="k">      ELSE</span>
<a name="ln-7841"></a><span class="k">        </span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7842"></a>                                                          <span class="n">Mode</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7843"></a>      <span class="k">END IF</span>
<a name="ln-7844"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7845"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">IsAutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7846"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSRatedAirVolFlowRateDes</span>
<a name="ln-7847"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7848"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7849"></a>                        <span class="n">MSRatedAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-7850"></a>        <span class="k">ELSE</span>
<a name="ln-7851"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-7852"></a>                <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7853"></a><span class="k">            </span><span class="n">MSRatedAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7854"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7855"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7856"></a>                        <span class="n">MSRatedAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7857"></a>                        <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7858"></a>                        <span class="n">MSRatedAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-7859"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7860"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSRatedAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">MSRatedAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSRatedAirVolFlowRateUser</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7861"></a>                              <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7862"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span><span class="p">&amp;</span>
<a name="ln-7863"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7864"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Air Volume Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7865"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7866"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Air Volume Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7867"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-7868"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7869"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7870"></a>              <span class="k">END IF</span>
<a name="ln-7871"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-7872"></a>          <span class="k">END IF</span>
<a name="ln-7873"></a><span class="k">        END IF</span>
<a name="ln-7874"></a><span class="k">      END IF</span>
<a name="ln-7875"></a><span class="k">    End Do</span>
<a name="ln-7876"></a>
<a name="ln-7877"></a>   <span class="c">! Ensure flow rate at lower speed must be lower or equal to the flow rate at higher speed. Otherwise, a severe error is isssued.</span>
<a name="ln-7878"></a>    <span class="k">Do </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7879"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-7880"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7881"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7882"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Air Flow Rate.&#39;</span><span class="p">)</span>
<a name="ln-7883"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7884"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7885"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7886"></a>      <span class="k">End If</span>
<a name="ln-7887"></a><span class="k">    End Do</span>
<a name="ln-7888"></a>
<a name="ln-7889"></a>      <span class="c">! Sizing rated total heating capacity</span>
<a name="ln-7890"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7891"></a>      <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7892"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7893"></a><span class="k">        </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7894"></a>      <span class="k">END IF</span>
<a name="ln-7895"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7896"></a>          <span class="c">! Heating capacity is assumed to be equal to the cooling capacity</span>
<a name="ln-7897"></a>        <span class="n">NumOfSpeedCompanion</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7898"></a>        <span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7899"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">NumOfSpeedCompanion</span><span class="p">)</span>
<a name="ln-7900"></a>      <span class="k">ELSE</span>
<a name="ln-7901"></a><span class="k">        </span><span class="n">MSRatedTotCapDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7902"></a>                                                           <span class="n">Mode</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-7903"></a>      <span class="k">END IF</span>
<a name="ln-7904"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7905"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSRatedTotCapDes</span>
<a name="ln-7906"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7907"></a>                 <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">MSRatedTotCapDes</span><span class="p">)</span>
<a name="ln-7908"></a>      <span class="k">ELSE</span>
<a name="ln-7909"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSRatedTotCapDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7910"></a><span class="k">          </span><span class="n">MSRatedTotCapUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7911"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7912"></a>                <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Design Size Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">MSRatedTotCapDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7913"></a>                <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; User-Specified Rated Total Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="n">MSRatedTotCapUser</span><span class="p">)</span>
<a name="ln-7914"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7915"></a><span class="k">            IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span> <span class="o">-</span> <span class="n">MSRatedTotCapUser</span><span class="p">)</span><span class="o">/</span><span class="n">MSRatedTotCapUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7916"></a><span class="k">              CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7917"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7918"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Rated Total Heating Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7919"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7920"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Rated Total Heating Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7921"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MSRatedTotCapDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-7922"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7923"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7924"></a>            <span class="k">END IF</span>
<a name="ln-7925"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7926"></a>        <span class="k">END IF</span>
<a name="ln-7927"></a><span class="k">      END IF</span>
<a name="ln-7928"></a><span class="k">    END DO</span>
<a name="ln-7929"></a>
<a name="ln-7930"></a>   <span class="c">! Ensure capacity at lower speed must be lower or equal to the capacity at higher speed.</span>
<a name="ln-7931"></a>    <span class="k">DO </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7932"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7933"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeDXCoil: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7934"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Total Heating Capacity must be less than or equal to &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7935"></a>          <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Rated Total Heating Capacity.&#39;</span><span class="p">)</span>
<a name="ln-7936"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instead, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7937"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7938"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-7939"></a>      <span class="k">END IF</span>
<a name="ln-7940"></a><span class="k">    END DO</span>
<a name="ln-7941"></a>
<a name="ln-7942"></a>      <span class="c">! Resistive Defrost Heater Capacity = capacity at the first stage</span>
<a name="ln-7943"></a>      <span class="c">! Sizing defrost heater capacity</span>
<a name="ln-7944"></a>    <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7945"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7946"></a><span class="k">      </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7947"></a>    <span class="k">END IF</span>
<a name="ln-7948"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="o">==</span> <span class="n">Resistive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7949"></a><span class="k">      </span><span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7950"></a>    <span class="k">ELSE</span>
<a name="ln-7951"></a><span class="k">      </span><span class="n">DefrostCapacityDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7952"></a>    <span class="k">END IF</span>
<a name="ln-7953"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">IsAutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7954"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">=</span> <span class="n">DefrostCapacityDes</span>
<a name="ln-7955"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7956"></a>                       <span class="s1">&#39;Design Size Resistive Defrost Heater Capacity&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityDes</span><span class="p">)</span>
<a name="ln-7957"></a>    <span class="k">ELSE</span>
<a name="ln-7958"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DefrostCapacityDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HardSizeNoDesRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7959"></a><span class="k">        </span><span class="n">DefrostCapacityUser</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span>
<a name="ln-7960"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7961"></a>                       <span class="s1">&#39;Design Size Resistive Defrost Heater Capacity&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7962"></a>                       <span class="s1">&#39;User-Specified Resistive Defrost Heater Capacity&#39;</span><span class="p">,</span> <span class="n">DefrostCapacityUser</span><span class="p">)</span>
<a name="ln-7963"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7964"></a><span class="k">          IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DefrostCapacityDes</span> <span class="o">-</span> <span class="n">DefrostCapacityUser</span><span class="p">)</span><span class="o">/</span><span class="n">DefrostCapacityUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7965"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;SizeDxCoil: Potential issue with equipment sizing for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7966"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7967"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Resistive Defrost Heater Capacity of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7968"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DefrostCapacityUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39;[W]&#39;</span><span class="p">)</span>
<a name="ln-7969"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Resistive Defrost Heater Capacity of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7970"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DefrostCapacityDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39;[W]&#39;</span><span class="p">)</span>
<a name="ln-7971"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-7972"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-7973"></a>          <span class="k">END IF</span>
<a name="ln-7974"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-7975"></a>      <span class="k">END IF</span>
<a name="ln-7976"></a><span class="k">    END IF</span>
<a name="ln-7977"></a><span class="k">  END IF</span>
<a name="ln-7978"></a>
<a name="ln-7979"></a>  <span class="c">! Call routine that computes AHRI certified rating for single-speed DX Coils</span>
<a name="ln-7980"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7981"></a>       <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7982"></a><span class="k">      CALL </span><span class="n">CalcDXCoilStandardRating</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>                          <span class="p">&amp;</span>
<a name="ln-7983"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-7984"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">,</span>                <span class="p">&amp;</span>
<a name="ln-7985"></a>                                    <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7986"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                <span class="p">&amp;</span>
<a name="ln-7987"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                   <span class="p">&amp;</span>
<a name="ln-7988"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                  <span class="p">&amp;</span>
<a name="ln-7989"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                  <span class="p">&amp;</span>
<a name="ln-7990"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                   <span class="p">&amp;</span>
<a name="ln-7991"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                   <span class="p">&amp;</span>
<a name="ln-7992"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                    <span class="p">&amp;</span>
<a name="ln-7993"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>        <span class="p">&amp;</span>
<a name="ln-7994"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanPowerPerEvapAirFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7995"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RegionNum</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-7996"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">,</span>              <span class="p">&amp;</span>
<a name="ln-7997"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-7998"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOnOffBlank</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-7999"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span><span class="p">)</span>
<a name="ln-8000"></a>  <span class="k">END IF</span>
<a name="ln-8001"></a>  <span class="c">! Call routine that computes AHRI certified rating for multi-speed DX cooling Coils</span>
<a name="ln-8002"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-8003"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8004"></a><span class="k">      CALL </span><span class="n">CalcDXCoilStandardRating</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>                          <span class="p">&amp;</span>
<a name="ln-8005"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-8006"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">,</span>                <span class="p">&amp;</span>
<a name="ln-8007"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">,</span>                   <span class="p">&amp;</span>
<a name="ln-8008"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">,</span>                 <span class="p">&amp;</span>
<a name="ln-8009"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-8010"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">,</span>                   <span class="p">&amp;</span>
<a name="ln-8011"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">,</span>                   <span class="p">&amp;</span>
<a name="ln-8012"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-8013"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-8014"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-8015"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-8016"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSFanPowerPerEvapAirFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8017"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RegionNum</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-8018"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">,</span>              <span class="p">&amp;</span>
<a name="ln-8019"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOn</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-8020"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OATempCompressorOnOffBlank</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-8021"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span><span class="p">)</span>
<a name="ln-8022"></a>  <span class="k">END If</span>
<a name="ln-8023"></a>
<a name="ln-8024"></a>  <span class="c">!create predefined report entries</span>
<a name="ln-8025"></a>  <span class="n">equipName</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-8026"></a>  <span class="c">! put tables for cooling and heating separate</span>
<a name="ln-8027"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-8028"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8029"></a>          <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8030"></a>          <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8031"></a>          <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-8032"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilType</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span>
<a name="ln-8033"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8034"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8035"></a><span class="k">          CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8036"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8037"></a>                    <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8038"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8039"></a>                    <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8040"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8041"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8042"></a>        <span class="k">ELSE</span>
<a name="ln-8043"></a><span class="k">          CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8044"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8045"></a>                    <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8046"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8047"></a>                    <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8048"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8049"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8050"></a>        <span class="k">END IF</span>
<a name="ln-8051"></a><span class="k">      ELSE</span>
<a name="ln-8052"></a><span class="k">        DO </span><span class="n">Mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-8053"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8054"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8055"></a>                    <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8056"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8057"></a>                    <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8058"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8059"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8060"></a>        <span class="k">END DO</span>
<a name="ln-8061"></a><span class="k">      END IF</span>
<a name="ln-8062"></a><span class="k">      CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstCoolCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-8063"></a>                                             <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-8064"></a>
<a name="ln-8065"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8066"></a>          <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8067"></a>          <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span>
<a name="ln-8068"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilType</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span>
<a name="ln-8069"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8070"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8071"></a><span class="k">          CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8072"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8073"></a>        <span class="k">ELSE</span>
<a name="ln-8074"></a><span class="k">          CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8075"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8076"></a>        <span class="k">END IF</span>
<a name="ln-8077"></a><span class="k">      ELSE</span>
<a name="ln-8078"></a><span class="k">        DO </span><span class="n">Mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-8079"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8080"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8081"></a>        <span class="k">END DO</span>
<a name="ln-8082"></a><span class="k">      END IF</span>
<a name="ln-8083"></a><span class="k">      CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstHeatCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-8084"></a>                                             <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-8085"></a>  <span class="k">END SELECT</span>
<a name="ln-8086"></a><span class="k">  RETURN</span>
<a name="ln-8087"></a>
<a name="ln-8088"></a><span class="k">END SUBROUTINE </span><span class="n">SizeDXCoil</span>
<a name="ln-8089"></a>
<a name="ln-8090"></a><span class="k">SUBROUTINE </span><span class="n">CalcHPWHDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8091"></a>
<a name="ln-8092"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8093"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-8094"></a>          <span class="c">!       DATE WRITTEN   May 2005</span>
<a name="ln-8095"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8096"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8097"></a>
<a name="ln-8098"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8099"></a>          <span class="c">! Calculates the gross cooling capacity of a heat pump water heater evaporator and</span>
<a name="ln-8100"></a>          <span class="c">! heating capacity of the condenser coil given the rated heating capacity and COP.</span>
<a name="ln-8101"></a>
<a name="ln-8102"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8103"></a>          <span class="c">! The routine requires the user to enter the total heating capacity and COP for the</span>
<a name="ln-8104"></a>          <span class="c">! heat pump water heater along with logicals defining if fan and condenser pump are included.</span>
<a name="ln-8105"></a>          <span class="c">! Since manufacturer&#39;s can rate their HPWH equipment with or without including condenser</span>
<a name="ln-8106"></a>          <span class="c">! pump heat, this information is required to accurately determine the condenser&#39;s leaving</span>
<a name="ln-8107"></a>          <span class="c">! water temperature. In addition, knowledge of the fan heat is required to back into</span>
<a name="ln-8108"></a>          <span class="c">! a compressor COP.</span>
<a name="ln-8109"></a>
<a name="ln-8110"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8111"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-8112"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-8113"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FanElecPower</span><span class="p">,</span> <span class="n">HPWHInletDBTemp</span><span class="p">,</span> <span class="n">HPWHInletWBTemp</span><span class="p">,</span> <span class="n">DXCoilTotalCapacity</span>
<a name="ln-8114"></a>
<a name="ln-8115"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8116"></a>
<a name="ln-8117"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8118"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>        <span class="c">! the number of the DX coil to be simulated</span>
<a name="ln-8119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>    <span class="c">! sensible water heating load / full load sensible water heating capacity</span>
<a name="ln-8120"></a>
<a name="ln-8121"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8122"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcHPWHDXCoil&#39;</span>
<a name="ln-8123"></a>
<a name="ln-8124"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8125"></a>          <span class="c">! na</span>
<a name="ln-8126"></a>
<a name="ln-8127"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8128"></a>          <span class="c">! na</span>
<a name="ln-8129"></a>
<a name="ln-8130"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8131"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHeatingCapacity</span>       <span class="c">! Water heating rated capacity with or without condenser water pump heat (W)</span>
<a name="ln-8132"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedHeatingCOP</span>            <span class="c">! Water heating rated COP with or without evap fan and cond water pump heat (W/W)</span>
<a name="ln-8133"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OperatingHeatingCapacity</span>   <span class="c">! Water heating operating capacity including the impact of capacity and COP curves (W)</span>
<a name="ln-8134"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OperatingHeatingCOP</span>        <span class="c">! Water heating operating COP including the impact of capacity and COP curves (W/W)</span>
<a name="ln-8135"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OperatingHeatingPower</span>      <span class="c">! Water heating operating Power (W)</span>
<a name="ln-8136"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompressorPower</span>            <span class="c">! Power consumed by compressor only (W)</span>
<a name="ln-8137"></a>
<a name="ln-8138"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalTankHeatingCapacity</span>   <span class="c">! Water heating capacity corrected for condenser water pump heat (W)</span>
<a name="ln-8139"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankHeatingCOP</span>             <span class="c">! Water heating COP corrected for fan and condenser water pump power (W/W)</span>
<a name="ln-8140"></a>                                      <span class="c">! (these previous 2 variables also include the impact of capacity and COP curves)</span>
<a name="ln-8141"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCoolingCapacity</span>        <span class="c">! Air cooling capacity corrected for evap fan and cond water pump heat (W)</span>
<a name="ln-8142"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWaterTemp</span>             <span class="c">! Condenser water inlet temperature (C)</span>
<a name="ln-8143"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTemp</span>            <span class="c">! Condenser water outlet temperature (C)</span>
<a name="ln-8144"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletMassFlowRate</span>      <span class="c">! Evaporator air inlet mass flow rate (m3/s)</span>
<a name="ln-8145"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletMassFlowRate</span>      <span class="c">! Condenser water inlet mass flow rate (m3/s)</span>
<a name="ln-8146"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span>                    <span class="c">! Specific heat of condenser inlet water (J/Kg/k)</span>
<a name="ln-8147"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirTemp</span>               <span class="c">! HPWH inlet air temperature (dry-bulb or wet-bulb) (C)</span>
<a name="ln-8148"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapFTemp</span>               <span class="c">! Output of HPWH Heating Capacity as a Function of Temperature curve</span>
<a name="ln-8149"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapFAirFlow</span>            <span class="c">! Output of HPWH Heating Capacity as a Function of Air Flow Rate Ratio curve</span>
<a name="ln-8150"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapFWaterFlow</span>          <span class="c">! Output of HPWH Heating Capacity as a Function of Water Flow Rate Ratio curve</span>
<a name="ln-8151"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCOPFTemp</span>               <span class="c">! Output of HPWH COP as a Function of Temperature curve</span>
<a name="ln-8152"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCOPFAirFlow</span>            <span class="c">! Output of HPWH COP as a Function of Air Flow Rate Ratio curve</span>
<a name="ln-8153"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCOPFWAterFlow</span>          <span class="c">! Output of HPWH COP as a Function of Water Flow Rate Ratio curve</span>
<a name="ln-8154"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRateRatio</span>           <span class="c">! Ratio of evaporator inlet air mass flow rate to rated mass flow rate</span>
<a name="ln-8155"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterFlowRateRatio</span>         <span class="c">! Ratio of evaporator inlet water mass flow rate to rated mass flow rate</span>
<a name="ln-8156"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadFraction</span>             <span class="c">! Output of Part Load Fraction as a Function of Part Load Ratio curve</span>
<a name="ln-8157"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PumpHeatToWater</span>            <span class="c">! Amount of pump heat attributed to heating water</span>
<a name="ln-8158"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPRTF</span>                      <span class="c">! Heat pump run time fraction</span>
<a name="ln-8159"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EvapInletNode</span>              <span class="c">! Evaporator air inlet node number</span>
<a name="ln-8160"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EvapOutletNode</span>             <span class="c">! Evaporator air outlet node number</span>
<a name="ln-8161"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CondInletNode</span>              <span class="c">! Condenser water inlet node number</span>
<a name="ln-8162"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CondOutletNode</span>             <span class="c">! Condenser water outlet node number</span>
<a name="ln-8163"></a>
<a name="ln-8164"></a>  <span class="n">CondInletNode</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterInNode</span>
<a name="ln-8165"></a>  <span class="n">CondOutletNode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">WaterOutNode</span>
<a name="ln-8166"></a>
<a name="ln-8167"></a><span class="c">! If heat pump water heater is OFF, set outlet to inlet and RETURN</span>
<a name="ln-8168"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8169"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">CondOutletNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CondInletNode</span><span class="p">)</span>
<a name="ln-8170"></a>    <span class="k">RETURN</span>
<a name="ln-8171"></a><span class="k">  ELSE</span>
<a name="ln-8172"></a><span class="k">    </span><span class="n">RatedHeatingCapacity</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>
<a name="ln-8173"></a>    <span class="n">RatedHeatingCOP</span>        <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8174"></a>    <span class="n">EvapInletNode</span>          <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-8175"></a>    <span class="n">EvapOutletNode</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span>
<a name="ln-8176"></a>    <span class="n">InletWaterTemp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CondInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8177"></a>    <span class="n">CondInletMassFlowRate</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CondInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span> <span class="n">PartLoadRatio</span>
<a name="ln-8178"></a>    <span class="n">EvapInletMassFlowRate</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">EvapInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span> <span class="n">PartLoadRatio</span>
<a name="ln-8179"></a>    <span class="n">CpWater</span>                <span class="o">=</span> <span class="n">CPHW</span><span class="p">(</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-8180"></a>    <span class="n">CompressorPower</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8181"></a>    <span class="n">OperatingHeatingPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8182"></a>    <span class="n">TankHeatingCOP</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8183"></a>  <span class="k">END IF</span>
<a name="ln-8184"></a>
<a name="ln-8185"></a><span class="c">! determine inlet air temperature type for curve objects</span>
<a name="ln-8186"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemperatureType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">WetBulbIndicator</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8187"></a><span class="k">    </span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">HPWHInletWBTemp</span>
<a name="ln-8188"></a>  <span class="k">ELSE</span>
<a name="ln-8189"></a><span class="k">    </span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">HPWHInletDBTemp</span>
<a name="ln-8190"></a>  <span class="k">END IF</span>
<a name="ln-8191"></a>
<a name="ln-8192"></a><span class="c">! get output of Heating Capacity and Heating COP curves (curves default to 1 if user has not specified curve name)</span>
<a name="ln-8193"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8194"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTempCurveType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Cubic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8195"></a><span class="k">      </span><span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">)</span>
<a name="ln-8196"></a>    <span class="k">ELSE</span>
<a name="ln-8197"></a><span class="k">      </span><span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-8198"></a>    <span class="k">END IF</span>
<a name="ln-8199"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-8200"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatCapFTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8201"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8202"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8203"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; HPWH Heating Capacity Modifier curve (function of temperature) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8204"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCapFTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8205"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTempCurveType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8206"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8207"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8208"></a>                               <span class="s1">&#39; and an inlet water temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8209"></a>        <span class="k">ELSE</span>
<a name="ln-8210"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8211"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8212"></a>        <span class="k">END IF</span>
<a name="ln-8213"></a><span class="k">        CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8214"></a>      <span class="k">END IF</span>
<a name="ln-8215"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8216"></a>          <span class="s1">&#39; HPWH Heating Capacity Modifier curve (function of temperature) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8217"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFTempErrorIndex</span><span class="p">,</span> <span class="n">HeatCapFTemp</span><span class="p">,</span> <span class="n">HeatCapFTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8218"></a>            <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-8219"></a>      <span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8220"></a>    <span class="k">END IF</span>
<a name="ln-8221"></a><span class="k">  ELSE</span>
<a name="ln-8222"></a><span class="k">    </span><span class="n">HeatCapFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8223"></a>  <span class="k">END IF</span>
<a name="ln-8224"></a>
<a name="ln-8225"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8226"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTempCurveType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Cubic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8227"></a><span class="k">      </span><span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">)</span>
<a name="ln-8228"></a>    <span class="k">ELSE</span>
<a name="ln-8229"></a><span class="k">      </span><span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTemp</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-8230"></a>    <span class="k">END IF</span>
<a name="ln-8231"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-8232"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatCOPFTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8233"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8234"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8235"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; HPWH Heating COP Modifier curve (function of temperature) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8236"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCOPFTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8237"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTempCurveType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8238"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8239"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8240"></a>                               <span class="s1">&#39; and an inlet water temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8241"></a>        <span class="k">ELSE</span>
<a name="ln-8242"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8243"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8244"></a>        <span class="k">END IF</span>
<a name="ln-8245"></a><span class="k">        CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8246"></a>      <span class="k">END IF</span>
<a name="ln-8247"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8248"></a>          <span class="s1">&#39; HPWH Heating COP Modifier curve (function of temperature) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8249"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFTempErrorIndex</span><span class="p">,</span> <span class="n">HeatCOPFTemp</span><span class="p">,</span> <span class="n">HeatCOPFTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8250"></a>            <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-8251"></a>      <span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8252"></a>    <span class="k">END IF</span>
<a name="ln-8253"></a><span class="k">  ELSE</span>
<a name="ln-8254"></a><span class="k">    </span><span class="n">HeatCOPFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8255"></a>  <span class="k">END IF</span>
<a name="ln-8256"></a>
<a name="ln-8257"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8258"></a><span class="k">    </span><span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="n">EvapInletMassFlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8259"></a>    <span class="n">HeatCapFAirFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlow</span><span class="p">,</span><span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-8260"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-8261"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatCapFAirFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8262"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8263"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8264"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; HPWH Heating Capacity Modifier curve (function of air flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8265"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCapFAirFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8266"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an air flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8267"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirFlowRateRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8268"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8269"></a>      <span class="k">END IF</span>
<a name="ln-8270"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8271"></a>          <span class="s1">&#39; HPWH Heating Capacity Modifier curve (function of air flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8272"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFAirFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatCapFAirFlow</span><span class="p">,</span> <span class="n">HeatCapFAirFlow</span><span class="p">)</span>
<a name="ln-8273"></a>      <span class="n">HeatCapFAirFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8274"></a>    <span class="k">END IF</span>
<a name="ln-8275"></a><span class="k">  ELSE</span>
<a name="ln-8276"></a><span class="k">    </span><span class="n">HeatCapFAirFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8277"></a>  <span class="k">END IF</span>
<a name="ln-8278"></a>
<a name="ln-8279"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8280"></a><span class="k">    </span><span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="n">EvapInletMassFlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8281"></a>    <span class="n">HeatCOPFAirFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlow</span><span class="p">,</span><span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-8282"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-8283"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatCOPFAirFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8284"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8285"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8286"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; HPWH Heating COP Modifier curve (function of air flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8287"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCOPFAirFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8288"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an air flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8289"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirFlowRateRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8290"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8291"></a>      <span class="k">END IF</span>
<a name="ln-8292"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8293"></a>          <span class="s1">&#39; HPWH Heating COP Modifier curve (function of air flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8294"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFAirFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatCOPFAirFlow</span><span class="p">,</span> <span class="n">HeatCOPFAirFlow</span><span class="p">)</span>
<a name="ln-8295"></a>      <span class="n">HeatCOPFAirFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8296"></a>    <span class="k">END IF</span>
<a name="ln-8297"></a><span class="k">  ELSE</span>
<a name="ln-8298"></a><span class="k">    </span><span class="n">HeatCOPFAirFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8299"></a>  <span class="k">END IF</span>
<a name="ln-8300"></a>
<a name="ln-8301"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8302"></a><span class="k">    </span><span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">CondInletMassFlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span><span class="o">*</span><span class="n">RhoH2O</span><span class="p">(</span><span class="n">InletWaterTemp</span><span class="p">))</span>
<a name="ln-8303"></a>    <span class="n">HeatCapFWaterFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlow</span><span class="p">,</span><span class="n">WaterFlowRateRatio</span><span class="p">)</span>
<a name="ln-8304"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-8305"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatCapFWaterFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8306"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8307"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8308"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; HPWH Heating Capacity Modifier curve (function of water flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8309"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCapFWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8310"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a water flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8311"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterFlowRateRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8312"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8313"></a>      <span class="k">END IF</span>
<a name="ln-8314"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8315"></a>          <span class="s1">&#39; HPWH Heating Capacity Modifier curve (function of water flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8316"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCapFWaterFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatCapFWaterFlow</span><span class="p">,</span> <span class="n">HeatCapFWaterFlow</span><span class="p">)</span>
<a name="ln-8317"></a>      <span class="n">HeatCapFWaterFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8318"></a>    <span class="k">END IF</span>
<a name="ln-8319"></a><span class="k">  ELSE</span>
<a name="ln-8320"></a><span class="k">    </span><span class="n">HeatCapFWaterFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8321"></a>  <span class="k">END IF</span>
<a name="ln-8322"></a>
<a name="ln-8323"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8324"></a><span class="k">    </span><span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">CondInletMassFlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedHPWHCondWaterFlow</span><span class="o">*</span><span class="n">RhoH2O</span><span class="p">(</span><span class="n">InletWaterTemp</span><span class="p">))</span>
<a name="ln-8325"></a>    <span class="n">HeatCOPFWaterFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlow</span><span class="p">,</span><span class="n">WaterFlowRateRatio</span><span class="p">)</span>
<a name="ln-8326"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-8327"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatCOPFWaterFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8328"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8329"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8330"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; HPWH Heating COP Modifier curve (function of water flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8331"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatCOPFWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8332"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a water flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8333"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterFlowRateRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8334"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8335"></a>      <span class="k">END IF</span>
<a name="ln-8336"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8337"></a>          <span class="s1">&#39; HPWH Heating COP Modifier curve (function of water flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8338"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HCOPFWaterFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatCOPFWaterFlow</span><span class="p">,</span> <span class="n">HeatCOPFWaterFlow</span><span class="p">)</span>
<a name="ln-8339"></a>      <span class="n">HeatCOPFWaterFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8340"></a>    <span class="k">END IF</span>
<a name="ln-8341"></a><span class="k">  ELSE</span>
<a name="ln-8342"></a><span class="k">    </span><span class="n">HeatCOPFWaterFlow</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8343"></a>  <span class="k">END IF</span>
<a name="ln-8344"></a>
<a name="ln-8345"></a><span class="c">! adjust Heating Capacity and COP for off-design conditions</span>
<a name="ln-8346"></a>  <span class="n">OperatingHeatingCapacity</span> <span class="o">=</span> <span class="n">RatedHeatingCapacity</span> <span class="o">*</span> <span class="n">HeatCapFTemp</span> <span class="o">*</span> <span class="n">HeatCapFAirFlow</span> <span class="o">*</span> <span class="n">HeatCapFWaterFlow</span>
<a name="ln-8347"></a>  <span class="n">OperatingHeatingCOP</span>      <span class="o">=</span> <span class="n">RatedHeatingCOP</span>      <span class="o">*</span> <span class="n">HeatCOPFTemp</span> <span class="o">*</span> <span class="n">HeatCOPFAirFlow</span> <span class="o">*</span> <span class="n">HeatCOPFWaterFlow</span>
<a name="ln-8348"></a>
<a name="ln-8349"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OperatingHeatingCOP</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">OperatingHeatingPower</span> <span class="o">=</span> <span class="n">OperatingHeatingCapacity</span> <span class="o">/</span> <span class="n">OperatingHeatingCOP</span>
<a name="ln-8350"></a>
<a name="ln-8351"></a>  <span class="n">PumpHeatToWater</span>          <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpFracToWater</span>
<a name="ln-8352"></a>  <span class="n">TankHeatingCOP</span>           <span class="o">=</span> <span class="n">OperatingHeatingCOP</span>
<a name="ln-8353"></a>
<a name="ln-8354"></a><span class="c">! account for pump heat if not included in total water heating capacity</span>
<a name="ln-8355"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondPumpHeatInCapacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8356"></a><span class="k">    </span><span class="n">TotalTankHeatingCapacity</span> <span class="o">=</span> <span class="n">OperatingHeatingCapacity</span>
<a name="ln-8357"></a>  <span class="k">ELSE</span>
<a name="ln-8358"></a><span class="k">    </span><span class="n">TotalTankHeatingCapacity</span> <span class="o">=</span> <span class="n">OperatingHeatingCapacity</span> <span class="o">+</span> <span class="n">PumpHeatToWater</span>
<a name="ln-8359"></a>  <span class="k">END IF</span>
<a name="ln-8360"></a>
<a name="ln-8361"></a><span class="c">! find part load fraction to calculate RTF</span>
<a name="ln-8362"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8363"></a><span class="k">    </span><span class="n">PartLoadFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.7d0</span><span class="p">,</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">PartLoadRatio</span><span class="p">))</span>
<a name="ln-8364"></a>  <span class="k">ELSE</span>
<a name="ln-8365"></a><span class="k">    </span><span class="n">PartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8366"></a>  <span class="k">END IF</span>
<a name="ln-8367"></a>
<a name="ln-8368"></a><span class="k">  </span><span class="n">HPRTF</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PartLoadFraction</span><span class="p">))</span>
<a name="ln-8369"></a>
<a name="ln-8370"></a><span class="c">! calculate evaporator total cooling capacity</span>
<a name="ln-8371"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HPRTF</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8372"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FanPowerIncludedInCOP</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8373"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondPumpPowerInCOP</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8374"></a><span class="c">!       make sure fan power is full load fan power</span>
<a name="ln-8375"></a>        <span class="n">CompressorPower</span> <span class="o">=</span> <span class="n">OperatingHeatingPower</span> <span class="o">-</span> <span class="n">FanElecPower</span><span class="o">/</span><span class="n">HPRTF</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span>
<a name="ln-8376"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OperatingHeatingPower</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">TankHeatingCOP</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">/</span> <span class="n">OperatingHeatingPower</span>
<a name="ln-8377"></a>      <span class="k">ELSE</span>
<a name="ln-8378"></a><span class="k">        </span><span class="n">CompressorPower</span> <span class="o">=</span> <span class="n">OperatingHeatingPower</span> <span class="o">-</span> <span class="n">FanElecPower</span><span class="o">/</span><span class="n">HPRTF</span>
<a name="ln-8379"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">OperatingHeatingPower</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8380"></a>          <span class="n">TankHeatingCOP</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">/</span> <span class="p">(</span><span class="n">OperatingHeatingPower</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="p">)</span>
<a name="ln-8381"></a>      <span class="k">END IF</span>
<a name="ln-8382"></a><span class="k">    ELSE</span>
<a name="ln-8383"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondPumpPowerInCOP</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8384"></a><span class="c">!       make sure fan power is full load fan power</span>
<a name="ln-8385"></a>        <span class="n">CompressorPower</span> <span class="o">=</span> <span class="n">OperatingHeatingPower</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span>
<a name="ln-8386"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">OperatingHeatingPower</span> <span class="o">+</span> <span class="n">FanElecPower</span><span class="o">/</span><span class="n">HPRTF</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8387"></a>          <span class="n">TankHeatingCOP</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">/</span> <span class="p">(</span><span class="n">OperatingHeatingPower</span> <span class="o">+</span> <span class="n">FanElecPower</span><span class="o">/</span><span class="n">HPRTF</span><span class="p">)</span>
<a name="ln-8388"></a>      <span class="k">ELSE</span>
<a name="ln-8389"></a><span class="k">        </span><span class="n">CompressorPower</span> <span class="o">=</span> <span class="n">OperatingHeatingPower</span>
<a name="ln-8390"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">OperatingHeatingPower</span> <span class="o">+</span> <span class="n">FanElecPower</span><span class="o">/</span><span class="n">HPRTF</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8391"></a>          <span class="n">TankHeatingCOP</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8392"></a>                          <span class="p">(</span><span class="n">OperatingHeatingPower</span> <span class="o">+</span> <span class="n">FanElecPower</span><span class="o">/</span><span class="n">HPRTF</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="p">)</span>
<a name="ln-8393"></a>      <span class="k">END IF</span>
<a name="ln-8394"></a><span class="k">    END IF</span>
<a name="ln-8395"></a><span class="k">  END IF</span>
<a name="ln-8396"></a>
<a name="ln-8397"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondPumpHeatInCapacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8398"></a><span class="k">    </span><span class="n">EvapCoolingCapacity</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">-</span> <span class="n">PumpHeatToWater</span> <span class="o">-</span> <span class="n">CompressorPower</span>
<a name="ln-8399"></a>  <span class="k">ELSE</span>
<a name="ln-8400"></a><span class="k">    </span><span class="n">EvapCoolingCapacity</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">-</span> <span class="n">CompressorPower</span>
<a name="ln-8401"></a>  <span class="k">END IF</span>
<a name="ln-8402"></a>
<a name="ln-8403"></a><span class="c">! set evaporator total cooling capacity prior to CalcDOE2DXCoil subroutine</span>
<a name="ln-8404"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">EvapCoolingCapacity</span>
<a name="ln-8405"></a>
<a name="ln-8406"></a><span class="c">! determine condenser water inlet/outlet condition at full capacity</span>
<a name="ln-8407"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CondInletMassFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8408"></a><span class="k">    </span><span class="n">OutletWaterTemp</span>         <span class="o">=</span> <span class="n">InletWaterTemp</span>
<a name="ln-8409"></a>  <span class="k">ELSE</span>
<a name="ln-8410"></a><span class="k">    </span><span class="n">OutletWaterTemp</span>         <span class="o">=</span> <span class="n">InletWaterTemp</span> <span class="o">+</span> <span class="n">TotalTankHeatingCapacity</span><span class="o">/</span><span class="p">(</span><span class="n">CpWater</span> <span class="o">*</span> <span class="n">CondInletMassFlowRate</span><span class="p">)</span>
<a name="ln-8411"></a>  <span class="k">END IF</span>
<a name="ln-8412"></a>
<a name="ln-8413"></a><span class="k">  </span><span class="n">Node</span><span class="p">(</span><span class="n">CondOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-8414"></a>
<a name="ln-8415"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">CondOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CondInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-8416"></a>
<a name="ln-8417"></a><span class="c">! send heating capacity and COP to water heater module for standards rating calculation</span>
<a name="ln-8418"></a><span class="c">! total heating capacity including condenser pump</span>
<a name="ln-8419"></a>  <span class="n">HPWHHeatingCapacity</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span>
<a name="ln-8420"></a><span class="c">! total heating COP including compressor, fan, and condenser pump</span>
<a name="ln-8421"></a>  <span class="n">HPWHHeatingCOP</span>      <span class="o">=</span> <span class="n">TankHeatingCOP</span>
<a name="ln-8422"></a>
<a name="ln-8423"></a><span class="c">! send DX coil total cooling capacity to HPWH for reporting</span>
<a name="ln-8424"></a>  <span class="n">DXCoilTotalCapacity</span> <span class="o">=</span> <span class="n">EvapCoolingCapacity</span>
<a name="ln-8425"></a>
<a name="ln-8426"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="n">TotalTankHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-8427"></a>
<a name="ln-8428"></a><span class="c">! calculate total compressor plus condenser pump power, fan power reported in fan module</span>
<a name="ln-8429"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecWaterHeatingPower</span> <span class="o">=</span> <span class="p">(</span><span class="n">CompressorPower</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="p">)</span> <span class="o">*</span> <span class="n">HPRTF</span>
<a name="ln-8430"></a>
<a name="ln-8431"></a><span class="k">RETURN</span>
<a name="ln-8432"></a><span class="k">END SUBROUTINE </span><span class="n">CalcHPWHDXCoil</span>
<a name="ln-8433"></a>
<a name="ln-8434"></a><span class="k">SUBROUTINE </span><span class="n">CalcDoe2DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PerfMode</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8435"></a>                          <span class="n">CoolingHeatingPLR</span><span class="p">)</span>
<a name="ln-8436"></a>
<a name="ln-8437"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8438"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-8439"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-8440"></a>          <span class="c">!       MODIFIED       Shirey, Feb/October 2001, Feb/Mar 2004</span>
<a name="ln-8441"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-8442"></a>          <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-8443"></a>          <span class="c">!                      April 2010 Chandan Sharma, FSEC, Added basin heater</span>
<a name="ln-8444"></a>          <span class="c">!       RE-ENGINEERED  Don Shirey, Aug/Sept 2000</span>
<a name="ln-8445"></a>
<a name="ln-8446"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8447"></a>          <span class="c">! Calculates the air-side performance and electrical energy use of a direct-</span>
<a name="ln-8448"></a>          <span class="c">! expansion, air-cooled cooling unit.</span>
<a name="ln-8449"></a>
<a name="ln-8450"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8451"></a>          <span class="c">! This routine simulates the performance of air-cooled DX cooling equipment.</span>
<a name="ln-8452"></a>          <span class="c">! The routine requires the user to enter the total cooling capacity, sensible heat ratio,</span>
<a name="ln-8453"></a>          <span class="c">! and COP for the unit at ARI 210/240 rating conditions (26.67C [80F] dry-bulb, 19.44C [67F]</span>
<a name="ln-8454"></a>          <span class="c">! wet-bulb air entering the cooling coil, 35C [95F] dry-bulb air entering the outdoor</span>
<a name="ln-8455"></a>          <span class="c">! condenser. Since different manufacturer&#39;s rate their equipment at different air flow rates,</span>
<a name="ln-8456"></a>          <span class="c">! the supply air flow rate corresponding to the rated capacities and rated COP must also be</span>
<a name="ln-8457"></a>          <span class="c">! entered (should be between 300 cfm/ton and 450 cfm/ton). The rated information entered by</span>
<a name="ln-8458"></a>          <span class="c">! the user should NOT include the thermal or electrical impacts of the supply air fan, as</span>
<a name="ln-8459"></a>          <span class="c">! this is addressed by another module.</span>
<a name="ln-8460"></a>
<a name="ln-8461"></a>          <span class="c">! With the rated performance data entered by the user, the model employs some of the</span>
<a name="ln-8462"></a>          <span class="c">! DOE-2.1E curve fits to adjust the capacity and efficiency of the unit as a function</span>
<a name="ln-8463"></a>          <span class="c">! of entering air temperatures and supply air flow rate (actual vs rated flow). The model</span>
<a name="ln-8464"></a>          <span class="c">! does NOT employ the exact same methodology to calculate performance as DOE-2, although</span>
<a name="ln-8465"></a>          <span class="c">! some of the DOE-2 curve fits are employed by this model.</span>
<a name="ln-8466"></a>
<a name="ln-8467"></a>          <span class="c">! The model checks for coil dryout conditions, and adjusts the calculated performance</span>
<a name="ln-8468"></a>          <span class="c">! appropriately.</span>
<a name="ln-8469"></a>
<a name="ln-8470"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8471"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit page 4-81.</span>
<a name="ln-8472"></a>          <span class="c">!</span>
<a name="ln-8473"></a>          <span class="c">! Henderson, H.I. Jr., K. Rengarajan and D.B. Shirey, III. 1992.The impact of comfort</span>
<a name="ln-8474"></a>          <span class="c">! control on air conditioner energy use in humid climates. ASHRAE Transactions 98(2):</span>
<a name="ln-8475"></a>          <span class="c">! 104-113.</span>
<a name="ln-8476"></a>          <span class="c">!</span>
<a name="ln-8477"></a>          <span class="c">! Henderson, H.I. Jr., Danny Parker and Y.J. Huang. 2000.Improving DOE-2&#39;s RESYS routine:</span>
<a name="ln-8478"></a>          <span class="c">! User Defined Functions to Provide More Accurate Part Load Energy Use and Humidity</span>
<a name="ln-8479"></a>          <span class="c">! Predictions. Proceedings of ACEEE Conference.</span>
<a name="ln-8480"></a>
<a name="ln-8481"></a>
<a name="ln-8482"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8483"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-8484"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-8485"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HPWHCrankcaseDBTemp</span><span class="p">,</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">SysTimeElapsed</span>
<a name="ln-8486"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">CreateSysTimeIntervalString</span>
<a name="ln-8487"></a>  <span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-8488"></a>
<a name="ln-8489"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8490"></a>
<a name="ln-8491"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8492"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DXCoilNum</span>           <span class="c">! the number of the DX coil to be simulated</span>
<a name="ln-8493"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompOp</span>              <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-8494"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! true if this is the first iteration of HVAC</span>
<a name="ln-8495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! sensible cooling load / full load sensible cooling capacity</span>
<a name="ln-8496"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Allows parent object to control fan operation</span>
<a name="ln-8497"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">PerfMode</span>            <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-8498"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! ratio of compressor on airflow to compressor off airflow</span>
<a name="ln-8499"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CoolingHeatingPLR</span>   <span class="c">! used for cycling fan RH control</span>
<a name="ln-8500"></a>
<a name="ln-8501"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8502"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcDoe2DXCoil: &#39;</span>
<a name="ln-8503"></a>
<a name="ln-8504"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8505"></a>          <span class="c">! na</span>
<a name="ln-8506"></a>
<a name="ln-8507"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8508"></a>          <span class="c">! na</span>
<a name="ln-8509"></a>
<a name="ln-8510"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8511"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>           <span class="c">! dry air mass flow rate through coil [kg/s] (adjusted for bypass if any)</span>
<a name="ln-8512"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>      <span class="c">! Ratio of actual air mass flow to rated air mass flow (adjusted for bypass if any)</span>
<a name="ln-8513"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolumeFlowRate</span>     <span class="c">! Air volume flow rate across the cooling coil [m3/s] (adjusted for bypass if any)</span>
<a name="ln-8514"></a>                                   <span class="c">! (average flow if cycling fan, full flow if constant fan)</span>
<a name="ln-8515"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowperRatedTotCap</span> <span class="c">! Air volume flow rate divided by rated total cooling capacity [m3/s-W] (adjusted for bypass)</span>
<a name="ln-8516"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BypassFlowFraction</span>    <span class="c">! Fraction of total flow which is bypassed around the cooling coil</span>
<a name="ln-8517"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>                <span class="c">! gross total cooling capacity at off-rated conditions [W]</span>
<a name="ln-8518"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>      <span class="c">! Total capacity modifier (function of entering wetbulb, outside drybulb)</span>
<a name="ln-8519"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span>      <span class="c">! Total capacity modifier (function of actual supply air flow vs rated flow)</span>
<a name="ln-8520"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirWetBulbC</span>      <span class="c">! wetbulb temperature of inlet air [C]</span>
<a name="ln-8521"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDryBulbTemp</span>   <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-8522"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>      <span class="c">! inlet air enthalpy [J/kg]</span>
<a name="ln-8523"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>        <span class="c">! inlet air humidity ratio [kg/kg]</span>
<a name="ln-8524"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRatTemp</span>    <span class="c">! inlet air humidity ratio used in ADP/BF loop [kg/kg]</span>
<a name="ln-8525"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-8526"></a><span class="c">!REAL(r64) :: InletAirPressure      ! inlet air pressure [Pa]</span>
<a name="ln-8527"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBF</span>              <span class="c">! coil bypass factor at rated conditions</span>
<a name="ln-8528"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>                   <span class="c">! Sensible Heat Ratio (sensible/total) of the cooling coil</span>
<a name="ln-8529"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBF</span>                   <span class="c">! coil bypass factor at off rated conditions</span>
<a name="ln-8530"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A0</span>                    <span class="c">! NTU * air mass flow rate, used in CBF calculation</span>
<a name="ln-8531"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hDelta</span>                <span class="c">! Change in air enthalpy across the cooling coil [J/kg]</span>
<a name="ln-8532"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>                  <span class="c">! Apparatus dew point enthalpy [J/kg]</span>
<a name="ln-8533"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>              <span class="c">! Enthalpy at inlet dry-bulb and wADP [J/kg]</span>
<a name="ln-8534"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>              <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-8535"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>                  <span class="c">! Apparatus dew point temperature [C]</span>
<a name="ln-8536"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>                  <span class="c">! Apparatus dew point humidity ratio [kg/kg]</span>
<a name="ln-8537"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span>    <span class="c">! outlet full load enthalpy [J/kg]</span>
<a name="ln-8538"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span>  <span class="c">! outlet humidity ratio at full load</span>
<a name="ln-8539"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>    <span class="c">! outlet air temperature at full load [C]</span>
<a name="ln-8540"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span>         <span class="c">! EIR modifier (function of entering wetbulb, outside drybulb)</span>
<a name="ln-8541"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span>         <span class="c">! EIR modifier (function of actual supply air flow vs rated flow)</span>
<a name="ln-8542"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span>                   <span class="c">! EIR at part load and off rated conditions</span>
<a name="ln-8543"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>                   <span class="c">! Part load factor, accounts for thermal lag at compressor startup, used in power calculation</span>
<a name="ln-8544"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>            <span class="c">! operating latent capacity of DX coil</span>
<a name="ln-8545"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>             <span class="c">! Rated latent capacity of DX coil</span>
<a name="ln-8546"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRUnadjusted</span>         <span class="c">! SHR prior to latent degradation effective SHR calculation</span>
<a name="ln-8547"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Counter</span>                 <span class="c">! Counter for dry evaporator iterations</span>
<a name="ln-8548"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxIter</span>                 <span class="c">! Maximum number of iterations for dry evaporator calculations</span>
<a name="ln-8549"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RF</span>                    <span class="c">! Relaxation factor for dry evaporator iterations</span>
<a name="ln-8550"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tolerance</span>             <span class="c">! Error tolerance for dry evaporator iterations</span>
<a name="ln-8551"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>                <span class="c">! Deviation of humidity ratio in dry evaporator iteration loop</span>
<a name="ln-8552"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-8553"></a>                                 <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-8554"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>       <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-8555"></a>                                 <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-8556"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>       <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-8557"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoAir</span>                <span class="c">! Density of air [kg/m3]</span>
<a name="ln-8558"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoWater</span>              <span class="c">! Density of water [kg/m3]</span>
<a name="ln-8559"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span> <span class="c">! power due to crankcase heater</span>
<a name="ln-8560"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompAmbTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Ambient temperature at compressor</span>
<a name="ln-8561"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRatio</span>          <span class="c">! ratio of compressor on airflow to average timestep airflow</span>
<a name="ln-8562"></a>                                 <span class="c">! used when constant fan mode yields different air flow rates when compressor is ON and OFF</span>
<a name="ln-8563"></a>                                 <span class="c">! (e.g. Packaged Terminal Heat Pump)</span>
<a name="ln-8564"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>        <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-8565"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>        <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-8566"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>         <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-8567"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorPressure</span>       <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-8568"></a>
<a name="ln-8569"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-8570"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! minimum of the inlet air humidity ratio and the outlet air humidity ratio</span>
<a name="ln-8571"></a><span class="c">!CHARACTER(len=6) :: OutputChar = &#39; &#39;     ! character string for warning messages</span>
<a name="ln-8572"></a><span class="c">!INTEGER,SAVE     :: ErrCount3=0    ! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-8573"></a><span class="c">!INTEGER,SAVE     :: ErrCount4=0    ! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-8574"></a><span class="c">!CHARACTER(len=6) :: CharPLR        ! used in warning messages</span>
<a name="ln-8575"></a><span class="c">!CHARACTER(len=6) :: CharPLF        ! used in warning messages</span>
<a name="ln-8576"></a><span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">Mode</span>           <span class="c">! Performance mode for Multimode DX coil; Always 1 for other coil types</span>
<a name="ln-8577"></a><span class="c">!CHARACTER(len=MaxNameLength) :: MinVol      ! character string used for error messages</span>
<a name="ln-8578"></a><span class="c">!CHARACTER(len=MaxNameLength) :: MaxVol      ! character string used for error messages</span>
<a name="ln-8579"></a><span class="c">!CHARACTER(len=MaxNameLength) :: VolFlowChar ! character string used for error messages</span>
<a name="ln-8580"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>           <span class="c">! Supply air temperature (average value if constant fan, full output if cycling fan)</span>
<a name="ln-8581"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>         <span class="c">! Supply air humidity ratio (average value if constant fan, full output if cycling fan)</span>
<a name="ln-8582"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>       <span class="c">! Supply air enthalpy (average value if constant fan, full output if cycling fan)</span>
<a name="ln-8583"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Adiff</span>                   <span class="c">! Used for exponential</span>
<a name="ln-8584"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXcoolToHeatPLRRatio</span>    <span class="c">! ratio of cooling PLR to heating PLR, used for cycling fan RH control</span>
<a name="ln-8585"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRTF</span>                 <span class="c">! heating coil part-load ratio, used for cycling fan RH control</span>
<a name="ln-8586"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilPLF</span>          <span class="c">! heating coil PLF (function of PLR), used for cycling fan RH control</span>
<a name="ln-8587"></a>
<a name="ln-8588"></a><span class="c">! If Performance mode not present, then set to 1.  Used only by Multimode/Multispeed DX coil (otherwise mode = 1)</span>
<a name="ln-8589"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PerfMode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8590"></a><span class="k">  </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">PerfMode</span>
<a name="ln-8591"></a><span class="k">ELSE</span>
<a name="ln-8592"></a><span class="k">  </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8593"></a><span class="k">END IF</span>
<a name="ln-8594"></a>
<a name="ln-8595"></a><span class="c">! If AirFlowRatio not present, then set to 1. Used only by DX coils with different air flow</span>
<a name="ln-8596"></a><span class="c">! during cooling and when no cooling is required (constant fan, fan speed changes)</span>
<a name="ln-8597"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">OnOffAirFlowRatio</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8598"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-8599"></a><span class="k">ELSE</span>
<a name="ln-8600"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8601"></a><span class="k">END IF</span>
<a name="ln-8602"></a>
<a name="ln-8603"></a><span class="c">! If CoolingHeatingPLR not present, then set to 1. Used for cycling fan systems where</span>
<a name="ln-8604"></a><span class="c">! heating PLR is greater than cooling PLR, otherwise CoolingHeatingPLR = 1.</span>
<a name="ln-8605"></a><span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoolingHeatingPLR</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8606"></a><span class="k">  </span><span class="n">DXcoolToHeatPLRRatio</span> <span class="o">=</span> <span class="n">CoolingHeatingPLR</span>
<a name="ln-8607"></a><span class="k">ELSE</span>
<a name="ln-8608"></a><span class="k">  </span><span class="n">DXcoolToHeatPLRRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8609"></a><span class="k">END IF</span>
<a name="ln-8610"></a>
<a name="ln-8611"></a><span class="n">MaxIter</span>         <span class="o">=</span> <span class="mi">30</span>
<a name="ln-8612"></a><span class="n">RF</span>              <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-8613"></a><span class="n">Counter</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8614"></a><span class="n">Tolerance</span>       <span class="o">=</span> <span class="mf">0.01d0</span>
<a name="ln-8615"></a><span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8616"></a><span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8617"></a><span class="n">BypassFlowFraction</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8618"></a><span class="n">AirMassFlow</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">BypassFlowFraction</span><span class="p">)</span>
<a name="ln-8619"></a><span class="n">InletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-8620"></a><span class="n">InletAirEnthalpy</span>    <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-8621"></a><span class="n">InletAirHumRat</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-8622"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-8623"></a><span class="c">!InletAirPressure    = DXCoil(DXCoilNum)%InletAirPressure</span>
<a name="ln-8624"></a><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8625"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8626"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8627"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8628"></a>
<a name="ln-8629"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/=</span> <span class="n">WaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8630"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8631"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-8632"></a> <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-8633"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8634"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-8635"></a>      <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-8636"></a>      <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-8637"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-8638"></a>    <span class="k">ELSE</span>
<a name="ln-8639"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Temp</span>
<a name="ln-8640"></a>      <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">HumRat</span>
<a name="ln-8641"></a> <span class="c">! this should use Node%WetBulbTemp or a PSYC function, not OAWB</span>
<a name="ln-8642"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">OutAirWetBulb</span>
<a name="ln-8643"></a>    <span class="k">END IF</span>
<a name="ln-8644"></a><span class="k">  ELSE</span>
<a name="ln-8645"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-8646"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-8647"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-8648"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-8649"></a>  <span class="n">ENDIF</span>
<a name="ln-8650"></a><span class="k">ELSE</span>
<a name="ln-8651"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8652"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-8653"></a>    <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-8654"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span> <span class="c">! node not connected</span>
<a name="ln-8655"></a>  <span class="k">ELSE</span>
<a name="ln-8656"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-8657"></a>  <span class="n">ENDIF</span>
<a name="ln-8658"></a><span class="k">END IF</span>
<a name="ln-8659"></a>
<a name="ln-8660"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8661"></a><span class="k">  </span><span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorDryBulb</span> <span class="c">! Outdoor dry-bulb temp</span>
<a name="ln-8662"></a>  <span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-8663"></a><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8664"></a><span class="k">  </span><span class="n">RhoAir</span>          <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">)</span>
<a name="ln-8665"></a>  <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8666"></a> <span class="c">! (Outdoor wet-bulb temp from DataEnvironment) + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-8667"></a>  <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8668"></a>  <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-8669"></a>  <span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-8670"></a><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">WaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8671"></a><span class="k">  </span><span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">HPWHCrankcaseDBTemp</span> <span class="c">! Temperature at HP water heater compressor</span>
<a name="ln-8672"></a><span class="k">END IF</span>
<a name="ln-8673"></a>
<a name="ln-8674"></a><span class="c">! Initialize crankcase heater, operates below OAT defined in input deck for HP DX cooling coil</span>
<a name="ln-8675"></a><span class="c">! If used in a heat pump, the value of MaxOAT in the heating coil overrides that in the cooling coil (in GetInput)</span>
<a name="ln-8676"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompAmbTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8677"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-8678"></a><span class="k">ELSE</span>
<a name="ln-8679"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8680"></a><span class="k">END IF</span>
<a name="ln-8681"></a>
<a name="ln-8682"></a><span class="c">! calculate end time of current time step to determine if error messages should be printed</span>
<a name="ln-8683"></a><span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-8684"></a>
<a name="ln-8685"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-8686"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-8687"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-8688"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-8689"></a><span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! .AND. &amp;</span>
<a name="ln-8690"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8691"></a>     <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8692"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8693"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer1</span><span class="p">))</span>
<a name="ln-8694"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer2</span><span class="p">))</span>
<a name="ln-8695"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Operation at low ambient temperatures may require special performance curves.&#39;</span><span class="p">)</span>
<a name="ln-8696"></a>    <span class="n">ENDIF</span>
<a name="ln-8697"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8698"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8699"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Low condenser dry-bulb temperature error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8700"></a>          <span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8701"></a>            <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-8702"></a>    <span class="k">ELSE</span>
<a name="ln-8703"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8704"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Low condenser wet-bulb temperature error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8705"></a>          <span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8706"></a>            <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-8707"></a>    <span class="k">END IF</span>
<a name="ln-8708"></a><span class="k">  END IF</span>
<a name="ln-8709"></a><span class="k">END IF</span>
<a name="ln-8710"></a>
<a name="ln-8711"></a><span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowOutTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8712"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8713"></a>       <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8714"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutletTempIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8715"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer1</span><span class="p">))</span>
<a name="ln-8716"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer2</span><span class="p">))</span>
<a name="ln-8717"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Possible reasons for low outlet air dry-bulb temperatures are: This DX coil&#39;</span><span class="p">)</span>
<a name="ln-8718"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   1) may have a low inlet air dry-bulb temperature. Inlet air temperature = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8719"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadInletAirTempLast</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-8720"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   2) may have a low air flow rate per watt of cooling capacity. Check inputs.&#39;</span><span class="p">)</span>
<a name="ln-8721"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   3) is used as part of a HX assisted cooling coil which uses a high sensible&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8722"></a>                                   <span class="s1">&#39; effectiveness. Check inputs.&#39;</span><span class="p">)</span>
<a name="ln-8723"></a>    <span class="k">END IF</span>
<a name="ln-8724"></a><span class="k">    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8725"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Full load outlet temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8726"></a>          <span class="s1">&#39; indicates a possibility of frost/freeze error continues. Outlet air temperature statistics follow:&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8727"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutletTempIndex</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadOutAirTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8728"></a>             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadOutAirTempLast</span><span class="p">)</span>
<a name="ln-8729"></a>  <span class="k">END IF</span>
<a name="ln-8730"></a><span class="k">END IF</span>
<a name="ln-8731"></a>
<a name="ln-8732"></a><span class="c">! save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-8733"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-8734"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-8735"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8736"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8737"></a>
<a name="ln-8738"></a><span class="k">IF</span><span class="p">((</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8739"></a>   <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8740"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8741"></a>   <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CompOp</span> <span class="o">==</span> <span class="n">On</span><span class="p">))</span> <span class="k">THEN</span>      <span class="c">! for cycling fan, reset mass flow to full on rate</span>
<a name="ln-8742"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8743"></a><span class="k">    </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">/</span> <span class="p">(</span><span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">DXcoolToHeatPLRRatio</span><span class="p">)</span>
<a name="ln-8744"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8745"></a>           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8746"></a><span class="k">    </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="n">AirFlowRatio</span>
<a name="ln-8747"></a>  <span class="k">ELSE</span>
<a name="ln-8748"></a><span class="k">    </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8749"></a>  <span class="k">END IF</span>
<a name="ln-8750"></a>
<a name="ln-8751"></a><span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 500 cfm/ton)</span>
<a name="ln-8752"></a>
<a name="ln-8753"></a><span class="c">! for some reason there are diff&#39;s when using coil inlet air pressure</span>
<a name="ln-8754"></a><span class="c">! these lines (more to follow) are commented out for the time being</span>
<a name="ln-8755"></a>
<a name="ln-8756"></a>  <span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-8757"></a>  <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-8758"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-8759"></a><span class="c">!  InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRat,InletAirPressure)</span>
<a name="ln-8760"></a><span class="c">!  AirVolumeFlowRate = AirMassFlow/ PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-8761"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8762"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8763"></a>        <span class="s1">&#39;&quot; - Rated total cooling capacity is zero or less.&#39;</span><span class="p">)</span>
<a name="ln-8764"></a>  <span class="k">END IF</span>
<a name="ln-8765"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8766"></a><span class="k">    </span><span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>
<a name="ln-8767"></a>  <span class="k">ELSE</span>
<a name="ln-8768"></a><span class="k">    </span><span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8769"></a>  <span class="k">END IF</span>
<a name="ln-8770"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8771"></a>      <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8772"></a>      <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8773"></a>       <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))))</span> <span class="k">THEN</span>
<a name="ln-8774"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8775"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8776"></a>        <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out of range at &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8777"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W.&#39;</span><span class="p">)</span>
<a name="ln-8778"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-8779"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8780"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8781"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-8782"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components,&#39;</span><span class="p">)</span>
<a name="ln-8783"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;or variable air volume [VAV] system using incorrect coil type.&#39;</span><span class="p">)</span>
<a name="ln-8784"></a>    <span class="n">ENDIF</span>
<a name="ln-8785"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8786"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8787"></a>          <span class="s1">&#39;of range error continues...&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span><span class="p">,</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-8788"></a>  <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8789"></a>      <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8790"></a>       <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))))</span> <span class="k">THEN</span>
<a name="ln-8791"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8792"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8793"></a>             <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total water heating capacity is out of range at &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8794"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W.&#39;</span><span class="p">)</span>
<a name="ln-8795"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-8796"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8797"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8798"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-8799"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes may be that the parent object is calling for an actual supply air flow&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8800"></a>                               <span class="s1">&#39; rate that is much higher or lower than the DX coil rated supply air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-8801"></a>    <span class="n">ENDIF</span>
<a name="ln-8802"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8803"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total water heating capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8804"></a>          <span class="s1">&#39;of range error continues...&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span><span class="p">,</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-8805"></a>  <span class="k">END IF</span>
<a name="ln-8806"></a><span class="c">!</span>
<a name="ln-8807"></a><span class="c">!    Adjust coil bypass factor for actual air flow rate. Use relation CBF = exp(-NTU) where</span>
<a name="ln-8808"></a><span class="c">!    NTU = A0/(m*cp). Relationship models the cooling coil as a heat exchanger with Cmin/Cmax = 0.</span>
<a name="ln-8809"></a>
<a name="ln-8810"></a>  <span class="n">RatedCBF</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8811"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RatedCBF</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8812"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="o">-</span><span class="nb">log</span><span class="p">(</span><span class="n">RatedCBF</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8813"></a>  <span class="k">ELSE</span>
<a name="ln-8814"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8815"></a>  <span class="k">END IF</span>
<a name="ln-8816"></a><span class="k">  </span><span class="n">ADiff</span><span class="o">=-</span><span class="n">A0</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-8817"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ADiff</span> <span class="o">&gt;=</span> <span class="n">EXP_LowerLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8818"></a><span class="k">     </span><span class="n">CBF</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">ADiff</span><span class="p">)</span>
<a name="ln-8819"></a>  <span class="k">ELSE</span>
<a name="ln-8820"></a><span class="k">     </span><span class="n">CBF</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8821"></a>  <span class="k">END IF</span>
<a name="ln-8822"></a>
<a name="ln-8823"></a>  <span class="c">!   check boundary for low ambient temperature and post warnings to individual DX coil buffers to print at end of time step</span>
<a name="ln-8824"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8825"></a><span class="k">    IF</span><span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!Same threshold as for air-cooled electric chiller</span>
<a name="ln-8826"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8827"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span> <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-8828"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8829"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8830"></a>          <span class="s1">&#39;&quot; - Air-cooled condenser inlet dry-bulb temperature below 0 C. Outdoor dry-bulb temperature = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8831"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8832"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;... Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-8833"></a>                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-8834"></a>       <span class="k">END IF</span>
<a name="ln-8835"></a><span class="k">    END IF</span>
<a name="ln-8836"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8837"></a><span class="k">    IF</span><span class="p">(</span><span class="n">OutdoorWetBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!Same threshold as for evap-cooled electric chiller</span>
<a name="ln-8838"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8839"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span> <span class="o">=</span> <span class="n">OutdoorWetBulb</span>
<a name="ln-8840"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8841"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8842"></a>          <span class="s1">&#39;&quot; - Evap-cooled condenser inlet wet-bulb temperature below 10 C. Outdoor wet-bulb temperature = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8843"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8844"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;... Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-8845"></a>                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-8846"></a>       <span class="k">END IF</span>
<a name="ln-8847"></a><span class="k">    END IF</span>
<a name="ln-8848"></a><span class="k">  END IF</span>
<a name="ln-8849"></a>
<a name="ln-8850"></a>  <span class="c">!  Get total capacity modifying factor (function of temperature) for off-rated conditions</span>
<a name="ln-8851"></a>  <span class="c">!  InletAirHumRat may be modified in this ADP/BF loop, use temporary varible for calculations</span>
<a name="ln-8852"></a>  <span class="n">InletAirHumRatTemp</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-8853"></a>  <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8854"></a>  <span class="k">DO</span>
<a name="ln-8855"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8856"></a>         <span class="c">! Coil:DX:HeatPumpWaterHeater does not have total cooling capacity as a function of temp or flow curve</span>
<a name="ln-8857"></a>         <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8858"></a>         <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8859"></a>    <span class="k">ELSE</span>
<a name="ln-8860"></a><span class="k">       IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8861"></a><span class="k">       </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-8862"></a>       <span class="k">ELSE</span>
<a name="ln-8863"></a><span class="k">       </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-8864"></a>       <span class="k">END IF</span>
<a name="ln-8865"></a>
<a name="ln-8866"></a>       <span class="c">!    Warn user if curve output goes negative</span>
<a name="ln-8867"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8868"></a><span class="k">         IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8869"></a><span class="k">           CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8870"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Total Cooling Capacity Modifier curve (function of temperature) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8871"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotCapTempModFac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8872"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8873"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a condenser inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8874"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8875"></a>                           <span class="s1">&#39; and an inlet air wet-bulb temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8876"></a>           <span class="k">ELSE</span>
<a name="ln-8877"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a condenser inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8878"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8879"></a>           <span class="k">END IF</span>
<a name="ln-8880"></a><span class="k">           IF</span><span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8881"></a><span class="k">            Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative output results from stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8882"></a>                                   <span class="s1">&#39; compressor operation.&#39;</span><span class="p">)</span>
<a name="ln-8883"></a>           <span class="k">END IF</span>
<a name="ln-8884"></a><span class="k">           CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8885"></a>         <span class="k">END IF</span>
<a name="ln-8886"></a><span class="k">         CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8887"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8888"></a>              <span class="s1">&#39; Total Cooling Capacity Modifier curve (function of temperature) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8889"></a>              <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTempErrorIndex</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">)</span>
<a name="ln-8890"></a>         <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8891"></a>       <span class="k">END IF</span>
<a name="ln-8892"></a>
<a name="ln-8893"></a>       <span class="c">!    Get total capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-8894"></a>       <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-8895"></a>       <span class="c">!    Warn user if curve output goes negative</span>
<a name="ln-8896"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">TotCapFlowModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8897"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8898"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-8899"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Total Cooling Capacity Modifier curve (function of flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-8900"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotCapFlowModFac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-8901"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an air flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-8902"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-8903"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-8904"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8905"></a><span class="k">            Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative output results from stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8906"></a>                                   <span class="s1">&#39; compressor operation.&#39;</span><span class="p">)</span>
<a name="ln-8907"></a>          <span class="k">END IF</span>
<a name="ln-8908"></a><span class="k">        END IF</span>
<a name="ln-8909"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8910"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8911"></a>            <span class="s1">&#39; Total Cooling Capacity Modifier curve (function of flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8912"></a>            <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlowErrorIndex</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span>
<a name="ln-8913"></a>        <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8914"></a>       <span class="k">END IF</span>
<a name="ln-8915"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8916"></a>    <span class="n">TotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-8917"></a>    <span class="c">!</span>
<a name="ln-8918"></a>    <span class="c">! if user specified SHR modifier curves are available calculate the SHR as follows:</span>
<a name="ln-8919"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8920"></a><span class="k">       </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">CalcSHRUserDefinedCurves</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8921"></a>                                      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-8922"></a>                                      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-8923"></a>      <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-8924"></a>      <span class="k">EXIT</span>
<a name="ln-8925"></a><span class="k">    ELSE</span>
<a name="ln-8926"></a>      <span class="c">! Calculate apparatus dew point conditions using TotCap and CBF</span>
<a name="ln-8927"></a>      <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-8928"></a>      <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-8929"></a>      <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcDoe2DXCoil&#39;</span><span class="p">)</span>
<a name="ln-8930"></a>      <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-8931"></a>      <span class="c">!  tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-8932"></a>      <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">,</span><span class="s1">&#39;CalcDoe2DXCoil&#39;</span><span class="p">)</span>
<a name="ln-8933"></a>      <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">,</span><span class="s1">&#39;CalcDoe2DXCoil&#39;</span><span class="p">)</span>
<a name="ln-8934"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8935"></a><span class="k">          </span><span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-8936"></a>      <span class="k">ELSE</span>
<a name="ln-8937"></a><span class="k">          </span><span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8938"></a>      <span class="k">END IF</span>
<a name="ln-8939"></a>      <span class="c">!</span>
<a name="ln-8940"></a>      <span class="c">! Check for dry evaporator conditions (win &lt; wadp)</span>
<a name="ln-8941"></a>      <span class="c">!</span>
<a name="ln-8942"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">wADP</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">InletAirHumRatTemp</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8943"></a><span class="k">          If</span><span class="p">(</span><span class="n">InletAirHumRatTemp</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">InletAirHumRatTemp</span><span class="o">=</span><span class="mf">0.00001d0</span>
<a name="ln-8944"></a>          <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">InletAirHumRatTemp</span> <span class="o">-</span> <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">InletAirHumRatTemp</span>
<a name="ln-8945"></a>        <span class="c">!</span>
<a name="ln-8946"></a>        <span class="c">! Increase InletAirHumRatTemp at constant InletAirTemp to find coil dry-out point. Then use the</span>
<a name="ln-8947"></a>        <span class="c">! capacity at the dry-out point to determine exiting conditions from coil. This is required</span>
<a name="ln-8948"></a>        <span class="c">! since the TotCapTempModFac doesn&#39;t work properly with dry-coil conditions.</span>
<a name="ln-8949"></a>        <span class="c">!</span>
<a name="ln-8950"></a>          <span class="n">InletAirHumRatTemp</span> <span class="o">=</span> <span class="n">RF</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RF</span><span class="p">)</span><span class="o">*</span><span class="n">InletAirHumRatTemp</span>
<a name="ln-8951"></a>          <span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRatTemp</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-8952"></a>        <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-8953"></a>        <span class="c">!  InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRatTemp,InletAirPressure)</span>
<a name="ln-8954"></a>          <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8955"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Recalculate with modified inlet conditions</span>
<a name="ln-8956"></a>          <span class="k">EXIT</span>
<a name="ln-8957"></a><span class="k">      ELSE</span>
<a name="ln-8958"></a><span class="k">          EXIT</span>
<a name="ln-8959"></a><span class="k">      END IF</span>
<a name="ln-8960"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8961"></a>  <span class="k">END DO</span>  <span class="c">! end of DO iteration loop</span>
<a name="ln-8962"></a>  <span class="c">!</span>
<a name="ln-8963"></a>
<a name="ln-8964"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8965"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">mode</span><span class="p">),</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="c">! Calculate part-load factor</span>
<a name="ln-8966"></a>  <span class="k">ELSE</span>
<a name="ln-8967"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8968"></a>  <span class="k">END IF</span>
<a name="ln-8969"></a>
<a name="ln-8970"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8971"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8972"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8973"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8974"></a>           <span class="s1">&#39;&quot;, PLF curve value&#39;</span><span class="p">)</span>
<a name="ln-8975"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The PLF curve value = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8976"></a>                                  <span class="s1">&#39; for part-load ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8977"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;PLF curve values must be &gt;= 0.7. PLF has been reset to 0.7 and simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-8978"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-8979"></a>      <span class="k">ELSE</span>
<a name="ln-8980"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8981"></a>           <span class="s1">&#39;&quot;, PLF curve value&#39;</span><span class="p">)</span>
<a name="ln-8982"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The PLF curve value = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8983"></a>                                  <span class="s1">&#39; for part-load ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8984"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;PLF curve values must be &gt;= 0.7. PLF has been reset to 0.7 and simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-8985"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-8986"></a>      <span class="k">END IF</span>
<a name="ln-8987"></a><span class="k">    END IF</span>
<a name="ln-8988"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8989"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8990"></a>                                            <span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; PLF curve &lt; 0.7 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8991"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex2</span><span class="p">,</span><span class="n">PLF</span><span class="p">,</span><span class="n">PLF</span><span class="p">)</span>
<a name="ln-8992"></a>    <span class="k">ELSE</span>
<a name="ln-8993"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8994"></a>                                            <span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; PLF curve &lt; 0.7 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8995"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex2</span><span class="p">,</span><span class="n">PLF</span><span class="p">,</span><span class="n">PLF</span><span class="p">)</span>
<a name="ln-8996"></a>    <span class="k">END IF</span>
<a name="ln-8997"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-8998"></a>  <span class="k">END IF</span>
<a name="ln-8999"></a>
<a name="ln-9000"></a>
<a name="ln-9001"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-9002"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-9003"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-9004"></a>      <span class="nb">ABS</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9005"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9006"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9007"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9008"></a>           <span class="s1">&#39;&quot;, runtime fraction&#39;</span><span class="p">)</span>
<a name="ln-9009"></a>        <span class="k">CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The runtime fraction exceeded 1.0. [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9010"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-9011"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Runtime fraction reset to 1 and the simulation will continue.&#39;</span><span class="p">)</span>
<a name="ln-9012"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9013"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-9014"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9015"></a>      <span class="k">ELSE</span>
<a name="ln-9016"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9017"></a>           <span class="s1">&#39;&quot;, runtime fraction&#39;</span><span class="p">)</span>
<a name="ln-9018"></a>        <span class="k">CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The runtime fraction exceeded 1.0. [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9019"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-9020"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Runtime fraction reset to 1 and the simulation will continue.&#39;</span><span class="p">)</span>
<a name="ln-9021"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9022"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-9023"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9024"></a>      <span class="k">END IF</span>
<a name="ln-9025"></a><span class="k">    END IF</span>
<a name="ln-9026"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9027"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-9028"></a>                   <span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; runtime fraction &gt; 1.0 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9029"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex3</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-9030"></a>    <span class="k">ELSE</span>
<a name="ln-9031"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-9032"></a>                     <span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; runtime fraction &gt; 1.0 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9033"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex3</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-9034"></a>    <span class="k">END IF</span>
<a name="ln-9035"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-9036"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9037"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-9038"></a>  <span class="k">END IF</span>
<a name="ln-9039"></a>
<a name="ln-9040"></a>  <span class="c">! If cycling fan, send coil part-load fraction to on/off fan via HVACDataGlobals</span>
<a name="ln-9041"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PLF</span>
<a name="ln-9042"></a>
<a name="ln-9043"></a>  <span class="c">!  Calculate full load output conditions</span>
<a name="ln-9044"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9045"></a><span class="k">      </span><span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-9046"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9047"></a><span class="k">        </span><span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9048"></a>        <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9049"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9050"></a><span class="k">            </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DryCoilOutletHumRatioMin</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-9051"></a>        <span class="n">ENDIF</span>
<a name="ln-9052"></a>      <span class="k">ELSE</span>
<a name="ln-9053"></a><span class="k">        </span><span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9054"></a>        <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9055"></a>      <span class="n">ENDIF</span>
<a name="ln-9056"></a>  <span class="k">ELSE</span>
<a name="ln-9057"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9058"></a>      <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9059"></a>      <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9060"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9061"></a><span class="k">        </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9062"></a>      <span class="k">ELSE</span>
<a name="ln-9063"></a><span class="k">        </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9064"></a>      <span class="k">END IF</span>
<a name="ln-9065"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-9066"></a>  <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">)</span>
<a name="ln-9067"></a>
<a name="ln-9068"></a><span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-9069"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9070"></a><span class="k">    </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9071"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9072"></a><span class="c">!   IF(FullLoadOutAirTemp .LT. PsyTsatFnHPb(FullLoadOutAirEnth,InletAirPressure)) THEN</span>
<a name="ln-9073"></a><span class="c">!    FullLoadOutAirTemp = PsyTsatFnHPb(FullLoadOutAirEnth,InletAirPressure)</span>
<a name="ln-9074"></a>    <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">)</span>
<a name="ln-9075"></a>   <span class="k">END IF</span>
<a name="ln-9076"></a>
<a name="ln-9077"></a>  <span class="c">! Store actual outlet conditions when DX coil is ON for use in heat recovery module</span>
<a name="ln-9078"></a>  <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-9079"></a>  <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-9080"></a>
<a name="ln-9081"></a><span class="c">! Add warning message for cold cooling coil (FullLoadOutAirTemp &lt; 2 C)</span>
<a name="ln-9082"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">2.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9083"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9084"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadOutAirTempLast</span> <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-9085"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutletTempIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9086"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadInletAirTempLast</span> <span class="o">=</span> <span class="n">InletAirDryBulbTemp</span>
<a name="ln-9087"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer1</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9088"></a>       <span class="s1">&#39;&quot; - Full load outlet air dry-bulb temperature &lt; 2C. This indicates the possibility of coil frost/freeze.&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9089"></a>       <span class="s1">&#39; Outlet temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span>
<a name="ln-9090"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-9091"></a>                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-9092"></a>    <span class="k">END IF</span>
<a name="ln-9093"></a><span class="k">  END IF</span>
<a name="ln-9094"></a>
<a name="ln-9095"></a>  <span class="c">!  If constant fan with cycling compressor, call function to determine &quot;effective SHR&quot;</span>
<a name="ln-9096"></a>  <span class="c">!  which includes the part-load degradation on latent capacity</span>
<a name="ln-9097"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9098"></a><span class="k">     </span><span class="n">QLatRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-9099"></a>     <span class="n">QLatActual</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SHR</span><span class="p">)</span>
<a name="ln-9100"></a>     <span class="n">SHRUnadjusted</span> <span class="o">=</span> <span class="n">SHR</span>
<a name="ln-9101"></a>     <span class="n">SHR</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHR</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9102"></a>                          <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirWetbulbC</span><span class="p">,</span> <span class="n">Mode</span><span class="p">)</span>
<a name="ln-9103"></a>    <span class="c">! For multimode coil, if stage-2 operation (modes 2 or 4), adjust Stage1&amp;2 SHR to account for</span>
<a name="ln-9104"></a>    <span class="c">! Stage 1 operating at full load, so there is no degradation for that portion</span>
<a name="ln-9105"></a>    <span class="c">! Use the stage 1 bypass fraction to allocate</span>
<a name="ln-9106"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9107"></a><span class="k">      </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRUnadjusted</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">Mode</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9108"></a>            <span class="n">SHR</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="n">Mode</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9109"></a>    <span class="k">END IF</span>
<a name="ln-9110"></a>
<a name="ln-9111"></a>  <span class="c">!  Calculate full load output conditions</span>
<a name="ln-9112"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9113"></a><span class="k">        </span><span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-9114"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9115"></a><span class="k">          </span><span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9116"></a>          <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9117"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9118"></a><span class="k">              </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DryCoilOutletHumRatioMin</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-9119"></a>          <span class="n">ENDIF</span>
<a name="ln-9120"></a>        <span class="k">ELSE</span>
<a name="ln-9121"></a><span class="k">          </span><span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9122"></a>          <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9123"></a>        <span class="n">ENDIF</span>
<a name="ln-9124"></a>    <span class="k">ELSE</span>
<a name="ln-9125"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9126"></a>        <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9127"></a>        <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9128"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9129"></a><span class="k">            </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9130"></a>        <span class="k">ELSE</span>
<a name="ln-9131"></a><span class="k">            </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9132"></a>        <span class="k">END IF</span>
<a name="ln-9133"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-9134"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">)</span>
<a name="ln-9135"></a>
<a name="ln-9136"></a><span class="c">! apply latent degradation model to cycling fan when RH control is desired and heating coil operates</span>
<a name="ln-9137"></a><span class="c">! longer than the cooling coil. DXcoolToHeatPLRRatio = Cooling coil PLR / Heating coil PLR.</span>
<a name="ln-9138"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9139"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXcoolToHeatPLRRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9140"></a><span class="k">      </span><span class="n">QLatRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-9141"></a>      <span class="n">QLatActual</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SHR</span><span class="p">)</span>
<a name="ln-9142"></a>      <span class="n">HeatRTF</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">DXcoolToHeatPLRRatio</span>
<a name="ln-9143"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilPLFCurvePTR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9144"></a><span class="k">        </span><span class="n">HeatingCoilPLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilPLFCurvePTR</span><span class="p">,</span><span class="n">HeatRTF</span><span class="p">)</span>
<a name="ln-9145"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLF</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">HeatRTF</span> <span class="o">=</span> <span class="n">HeatRTF</span><span class="o">/</span><span class="n">HeatingCoilPLF</span>
<a name="ln-9146"></a>      <span class="k">END IF</span>
<a name="ln-9147"></a><span class="k">      </span><span class="n">SHRUnadjusted</span> <span class="o">=</span> <span class="n">SHR</span>
<a name="ln-9148"></a>      <span class="n">SHR</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHR</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9149"></a>                     <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirWetbulbC</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">HeatRTF</span><span class="p">)</span>
<a name="ln-9150"></a>  <span class="c">!   Calculate full load output conditions</span>
<a name="ln-9151"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9152"></a><span class="k">         </span><span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-9153"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9154"></a><span class="k">           </span><span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9155"></a>           <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9156"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9157"></a><span class="k">               </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DryCoilOutletHumRatioMin</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-9158"></a>           <span class="n">ENDIF</span>
<a name="ln-9159"></a>         <span class="k">ELSE</span>
<a name="ln-9160"></a><span class="k">           </span><span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9161"></a>           <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9162"></a>         <span class="n">ENDIF</span>
<a name="ln-9163"></a>      <span class="k">ELSE</span>
<a name="ln-9164"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9165"></a>          <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9166"></a>          <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9167"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9168"></a><span class="k">            </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9169"></a>          <span class="k">ELSE</span>
<a name="ln-9170"></a><span class="k">            </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9171"></a>          <span class="k">END IF</span>
<a name="ln-9172"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-9173"></a>      <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">)</span>
<a name="ln-9174"></a>    <span class="k">END IF</span>
<a name="ln-9175"></a>
<a name="ln-9176"></a><span class="k">  END IF</span>
<a name="ln-9177"></a>
<a name="ln-9178"></a><span class="c">!  Calculate actual outlet conditions for the input part load ratio</span>
<a name="ln-9179"></a><span class="c">!  Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-9180"></a>
<a name="ln-9181"></a><span class="c">! For multimode coil, if stage-2 operation (modes 2 or 4), return &quot;full load&quot; outlet conditions</span>
<a name="ln-9182"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9183"></a>      <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9184"></a>    <span class="c">! Continuous fan, cycling compressor</span>
<a name="ln-9185"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9186"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">))</span><span class="o">*</span><span class="n">InletAirEnthalpy</span><span class="p">)</span>
<a name="ln-9187"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9188"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">))</span><span class="o">*</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-9189"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-9190"></a>  <span class="k">ELSE</span>
<a name="ln-9191"></a>    <span class="c">! Default to cycling fan, cycling compressor</span>
<a name="ln-9192"></a>    <span class="c">! Also return this result for stage 2 operation of multimode coil</span>
<a name="ln-9193"></a>    <span class="c">! Cycling fan typically provides full outlet conditions. When RH control is used, account for additional</span>
<a name="ln-9194"></a>    <span class="c">! heating run time by using cooing/heating ratio the same as constant fan (otherwise PLRRatio = 1).</span>
<a name="ln-9195"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">FullLoadOutAirEnth</span> <span class="o">*</span> <span class="n">DXcoolToHeatPLRRatio</span> <span class="o">+</span> <span class="n">InletAirEnthalpy</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXcoolToHeatPLRRatio</span><span class="p">)</span>
<a name="ln-9196"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span> <span class="o">*</span> <span class="n">DXcoolToHeatPLRRatio</span> <span class="o">+</span> <span class="n">InletAirHumRat</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXcoolToHeatPLRRatio</span><span class="p">)</span>
<a name="ln-9197"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span> <span class="o">*</span> <span class="n">DXcoolToHeatPLRRatio</span> <span class="o">+</span> <span class="n">InletAirDryBulbTemp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXcoolToHeatPLRRatio</span><span class="p">)</span>
<a name="ln-9198"></a>  <span class="k">END IF</span>
<a name="ln-9199"></a>
<a name="ln-9200"></a><span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-9201"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">OutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcDOE2DXCoil&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9202"></a><span class="k">    </span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9203"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9204"></a><span class="c">!   IF(OutletAirTemp .LT. PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)) THEN</span>
<a name="ln-9205"></a><span class="c">!    OutletAirTemp = PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-9206"></a>    <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-9207"></a>   <span class="k">END IF</span>
<a name="ln-9208"></a>
<a name="ln-9209"></a><span class="c">! Mix with air that was bypassed around coil, if any</span>
<a name="ln-9210"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">BypassFlowFraction</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9211"></a><span class="k">     </span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">BypassFlowFraction</span><span class="p">)</span><span class="o">*</span><span class="n">OutletAirEnthalpy</span> <span class="o">+</span> <span class="n">BypassFlowFraction</span><span class="o">*</span><span class="n">InletAirEnthalpy</span>
<a name="ln-9212"></a>     <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">BypassFlowFraction</span><span class="p">)</span><span class="o">*</span><span class="n">OutletAirHumRat</span> <span class="o">+</span> <span class="n">BypassFlowFraction</span><span class="o">*</span><span class="n">InletAirHumRat</span>
<a name="ln-9213"></a>     <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-9214"></a>     <span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-9215"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">OutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9216"></a><span class="k">       </span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9217"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9218"></a><span class="c">!     IF(OutletAirTemp .LT. PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)) THEN</span>
<a name="ln-9219"></a><span class="c">!       OutletAirTemp = PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-9220"></a>       <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-9221"></a>     <span class="k">END IF</span>
<a name="ln-9222"></a><span class="k">    END IF</span>
<a name="ln-9223"></a>
<a name="ln-9224"></a><span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-9225"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9226"></a><span class="c">!   Coil:DX:HeatPumpWaterHeater does not have EIR temp or flow curves</span>
<a name="ln-9227"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9228"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9229"></a>  <span class="k">ELSE</span>
<a name="ln-9230"></a><span class="k">    </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-9231"></a>
<a name="ln-9232"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-9233"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">EIRTempModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9234"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9235"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-9236"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Energy Input Ratio Modifier curve (function of temperature) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-9237"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">EIRTempModFac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-9238"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Biquadratic</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9239"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a condenser inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-9240"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9241"></a>                               <span class="s1">&#39; and an inlet air wet-bulb temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-9242"></a>        <span class="k">ELSE</span>
<a name="ln-9243"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a condenser inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-9244"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-9245"></a>        <span class="k">END IF</span>
<a name="ln-9246"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9247"></a><span class="k">          Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative output results from stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9248"></a>                                 <span class="s1">&#39; compressor operation.&#39;</span><span class="p">)</span>
<a name="ln-9249"></a>        <span class="k">END IF</span>
<a name="ln-9250"></a><span class="k">        CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-9251"></a>      <span class="k">END IF</span>
<a name="ln-9252"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9253"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9254"></a>          <span class="s1">&#39; Energy Input Ratio Modifier curve (function of temperature) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9255"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTempErrorIndex</span><span class="p">,</span> <span class="n">EIRTempModFac</span><span class="p">,</span> <span class="n">EIRTempModFac</span><span class="p">)</span>
<a name="ln-9256"></a>      <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9257"></a>    <span class="k">END IF</span>
<a name="ln-9258"></a>
<a name="ln-9259"></a><span class="k">    </span><span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-9260"></a>
<a name="ln-9261"></a><span class="c">!   Warn user if curve output goes negative</span>
<a name="ln-9262"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">EIRFlowModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9263"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9264"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-9265"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Energy Input Ratio Modifier curve (function of flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-9266"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">EIRFlowModFac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-9267"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an air flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-9268"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-9269"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-9270"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9271"></a><span class="k">          Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative output results from stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9272"></a>                                 <span class="s1">&#39; compressor operation.&#39;</span><span class="p">)</span>
<a name="ln-9273"></a>        <span class="k">END IF</span>
<a name="ln-9274"></a><span class="k">      END IF</span>
<a name="ln-9275"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9276"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9277"></a>         <span class="s1">&#39; Energy Input Ratio Modifier curve (function of flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9278"></a>         <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlowErrorIndex</span><span class="p">,</span> <span class="n">EIRFlowModFac</span><span class="p">,</span> <span class="n">EIRFlowModFac</span><span class="p">)</span>
<a name="ln-9279"></a>      <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9280"></a>    <span class="k">END IF</span>
<a name="ln-9281"></a><span class="k">  END IF</span>
<a name="ln-9282"></a>
<a name="ln-9283"></a><span class="k">  </span><span class="n">EIR</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">*</span> <span class="n">EIRTempModFac</span>
<a name="ln-9284"></a>
<a name="ln-9285"></a><span class="c">! For multimode coil, if stage-2 operation (Modes 2 or 4), return &quot;full load&quot; power adjusted for PLF</span>
<a name="ln-9286"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9287"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-9288"></a>  <span class="k">ELSE</span>
<a name="ln-9289"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">/</span> <span class="n">PartLoadRatio</span>
<a name="ln-9290"></a>  <span class="k">END IF</span>
<a name="ln-9291"></a>
<a name="ln-9292"></a><span class="c">! Reset AirMassFlow to inlet node air mass flow for final total, sensible and latent calculations</span>
<a name="ln-9293"></a><span class="c">! since AirMassFlow might have been modified above (in this subroutine):</span>
<a name="ln-9294"></a><span class="c">!     IF (FanOpMode .EQ. CycFanCycCoil) AirMassFlow = AirMassFlow / PartLoadRatio</span>
<a name="ln-9295"></a><span class="c">!</span>
<a name="ln-9296"></a><span class="c">! For multimode coil, this should be full flow including bypassed fraction</span>
<a name="ln-9297"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-9298"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-9299"></a>
<a name="ln-9300"></a><span class="c">! Set DataHeatGlobal heat reclaim variable for use by heat reclaim coil (part load ratio is accounted for)</span>
<a name="ln-9301"></a><span class="c">! Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-9302"></a>  <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-9303"></a>
<a name="ln-9304"></a>  <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-9305"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9306"></a>                                         <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9307"></a>                                          <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">))</span>
<a name="ln-9308"></a><span class="c">!  Don&#39;t let sensible capacity be greater than total capacity</span>
<a name="ln-9309"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9310"></a><span class="k">     </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-9311"></a>  <span class="k">END IF</span>
<a name="ln-9312"></a><span class="c">!</span>
<a name="ln-9313"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-9314"></a>
<a name="ln-9315"></a><span class="c">! Calculate crankcase heater power using the runtime fraction for this DX cooling coil only if there is no companion DX coil.</span>
<a name="ln-9316"></a><span class="c">! Else use the largest runtime fraction of this DX cooling coil and the companion DX heating coil.</span>
<a name="ln-9317"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9318"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9319"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-9320"></a>  <span class="k">ELSE</span>
<a name="ln-9321"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9322"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9323"></a>                                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">))</span>
<a name="ln-9324"></a>  <span class="k">END IF</span>
<a name="ln-9325"></a>
<a name="ln-9326"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9327"></a>  <span class="c">!******************</span>
<a name="ln-9328"></a>  <span class="c">!             WATER CONSUMPTION IN m3 OF WATER FOR DIRECT</span>
<a name="ln-9329"></a>  <span class="c">!             H2O [m3/sec] = Delta W[KgH2O/Kg air]*Mass Flow Air[Kg air]</span>
<a name="ln-9330"></a>  <span class="c">!                                /RhoWater [kg H2O/m3 H2O]</span>
<a name="ln-9331"></a>  <span class="c">!******************</span>
<a name="ln-9332"></a>     <span class="n">RhoWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-9333"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-9334"></a>             <span class="p">(</span><span class="n">CondInletHumrat</span> <span class="o">-</span> <span class="n">OutdoorHumRat</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-9335"></a>              <span class="n">CondAirMassFlow</span><span class="o">/</span><span class="n">RhoWater</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-9336"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9337"></a>                                               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-9338"></a>  <span class="c">! Calculate basin heater power</span>
<a name="ln-9339"></a>    <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-9340"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-9341"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-9342"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9343"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9344"></a>                                         <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-9345"></a>    <span class="n">ENDIF</span>
<a name="ln-9346"></a>  <span class="k">END IF</span>
<a name="ln-9347"></a>
<a name="ln-9348"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">OutletAirTemp</span>
<a name="ln-9349"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-9350"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-9351"></a>
<a name="ln-9352"></a><span class="k">ELSE</span>
<a name="ln-9353"></a>
<a name="ln-9354"></a>  <span class="c">! DX coil is off; just pass through conditions</span>
<a name="ln-9355"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-9356"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-9357"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-9358"></a>
<a name="ln-9359"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9360"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9361"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9362"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9363"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9364"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9365"></a>
<a name="ln-9366"></a><span class="c">! Reset globals when DX coil is OFF for use in heat recovery module</span>
<a name="ln-9367"></a>  <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9368"></a>  <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9369"></a>
<a name="ln-9370"></a><span class="c">! Calculate crankcase heater power using the runtime fraction for this DX cooling coil (here DXCoolingCoilRTF=0) if</span>
<a name="ln-9371"></a><span class="c">! there is no companion DX coil, or the runtime fraction of the companion DX heating coil (here DXHeatingCoilRTF&gt;=0).</span>
<a name="ln-9372"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9373"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span>
<a name="ln-9374"></a>  <span class="k">ELSE</span>
<a name="ln-9375"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9376"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-9377"></a>  <span class="k">END IF</span>
<a name="ln-9378"></a>
<a name="ln-9379"></a><span class="c">! Calculate basin heater power</span>
<a name="ln-9380"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9381"></a><span class="k">    IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9382"></a><span class="k">      CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-9383"></a>                               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-9384"></a>                               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-9385"></a>    <span class="n">ENDIF</span>
<a name="ln-9386"></a>  <span class="k">ELSE</span>
<a name="ln-9387"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9388"></a><span class="k">      CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-9389"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-9390"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-9391"></a>    <span class="n">ENDIF</span>
<a name="ln-9392"></a>  <span class="n">ENDIF</span>
<a name="ln-9393"></a>
<a name="ln-9394"></a><span class="k">END IF</span> <span class="c">! end of on/off if - else</span>
<a name="ln-9395"></a>
<a name="ln-9396"></a><span class="c">!set water system demand request (if needed)</span>
<a name="ln-9397"></a><span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9398"></a><span class="k">   </span><span class="n">WaterStorage</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9399"></a>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-9400"></a><span class="n">ENDIF</span>
<a name="ln-9401"></a>
<a name="ln-9402"></a><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-9403"></a><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-9404"></a><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-9405"></a><span class="n">DXCoilFanOpMode</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>          <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-9406"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span>     <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-9407"></a>
<a name="ln-9408"></a><span class="k">RETURN</span>
<a name="ln-9409"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDoe2DXCoil</span>
<a name="ln-9410"></a>
<a name="ln-9411"></a><span class="k">SUBROUTINE </span><span class="n">CalcVRFCoolingCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompCycRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9412"></a>                              <span class="n">PerfMode</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">MaxCoolCap</span><span class="p">)</span>
<a name="ln-9413"></a>
<a name="ln-9414"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9415"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-9416"></a>          <span class="c">!       DATE WRITTEN   August 2010</span>
<a name="ln-9417"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9418"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9419"></a>
<a name="ln-9420"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9421"></a>          <span class="c">! Calculates the air-side performance of a direct-expansion, air-cooled</span>
<a name="ln-9422"></a>          <span class="c">! VRF terminal unit cooling coil.</span>
<a name="ln-9423"></a>          <span class="c">! A new subroutine was created in case this DX coil model is significantly</span>
<a name="ln-9424"></a>          <span class="c">! different from the existing CalcDoe2DXCoil subroutine. The VRF heating coil</span>
<a name="ln-9425"></a>          <span class="c">! uses the existing DX heating coil subroutine (CalcDXHeatingCoil).</span>
<a name="ln-9426"></a>
<a name="ln-9427"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9428"></a>          <span class="c">! This routine simulates the performance of a variable refrigerant flow cooling coil.</span>
<a name="ln-9429"></a>          <span class="c">! The routine requires the user to enter the total cooling capacity and sensible heat ratio.</span>
<a name="ln-9430"></a>          <span class="c">! Since different manufacturer&#39;s rate their equipment at different air flow rates,</span>
<a name="ln-9431"></a>          <span class="c">! the supply air flow rate corresponding to the rated capacities must also be</span>
<a name="ln-9432"></a>          <span class="c">! entered (should be between 300 cfm/ton and 450 cfm/ton). The rated information entered by</span>
<a name="ln-9433"></a>          <span class="c">! the user should NOT include the thermal or electrical impacts of the supply air fan, as</span>
<a name="ln-9434"></a>          <span class="c">! this is addressed by another module.</span>
<a name="ln-9435"></a>
<a name="ln-9436"></a>          <span class="c">! With the rated performance data entered by the user, the model employs some of the</span>
<a name="ln-9437"></a>          <span class="c">! DOE-2.1E curve fits to adjust the capacity and efficiency of the unit as a function</span>
<a name="ln-9438"></a>          <span class="c">! of entering air temperatures and supply air flow rate (actual vs rated flow). The model</span>
<a name="ln-9439"></a>          <span class="c">! does NOT employ the exact same methodology to calculate performance as DOE-2.</span>
<a name="ln-9440"></a>          <span class="c">!</span>
<a name="ln-9441"></a>          <span class="c">! This VRF cooling coil model adjusts the rated total cooling capacity by the CAPFT</span>
<a name="ln-9442"></a>          <span class="c">! and CAP funciton of flow curve/model currently used by the existing DX coil model.</span>
<a name="ln-9443"></a>          <span class="c">! The part-load ratio is then applied to the total operating capacity to find the capacity</span>
<a name="ln-9444"></a>          <span class="c">! required to meet the load. This VRF model then uses the ADP/bypass method to find the</span>
<a name="ln-9445"></a>          <span class="c">! SHR and resulting outlet conditions given that total capacity (or delta H).</span>
<a name="ln-9446"></a>
<a name="ln-9447"></a>          <span class="c">! The model checks for coil dryout conditions, and adjusts the calculated performance</span>
<a name="ln-9448"></a>          <span class="c">! appropriately.</span>
<a name="ln-9449"></a>
<a name="ln-9450"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9451"></a>          <span class="c">! na</span>
<a name="ln-9452"></a>
<a name="ln-9453"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9454"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-9455"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-9456"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HPWHCrankcaseDBTemp</span><span class="p">,</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">SysTimeElapsed</span>
<a name="ln-9457"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">CreateSysTimeIntervalString</span>
<a name="ln-9458"></a>  <span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-9459"></a>
<a name="ln-9460"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9461"></a>
<a name="ln-9462"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9463"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DXCoilNum</span>           <span class="c">! the number of the DX coil to be simulated</span>
<a name="ln-9464"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompOp</span>              <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-9465"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! true if this is the first iteration of HVAC</span>
<a name="ln-9466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! sensible cooling load / full load sensible cooling capacity</span>
<a name="ln-9467"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Allows parent object to control fan operation</span>
<a name="ln-9468"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompCycRatio</span>        <span class="c">! cycling ratio of VRF condenser</span>
<a name="ln-9469"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">PerfMode</span>            <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-9470"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! ratio of compressor on airflow to compressor off airflow</span>
<a name="ln-9471"></a><span class="c">!  REAL(r64), INTENT(IN), OPTIONAL :: CoolingHeatingPLR   ! used for cycling fan RH control</span>
<a name="ln-9472"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MaxCoolCap</span>           <span class="c">! maximum capacity of DX coil</span>
<a name="ln-9473"></a>
<a name="ln-9474"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9475"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcVRFCoolingCoil&#39;</span>
<a name="ln-9476"></a>
<a name="ln-9477"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9478"></a>          <span class="c">! na</span>
<a name="ln-9479"></a>
<a name="ln-9480"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9481"></a>          <span class="c">! na</span>
<a name="ln-9482"></a>
<a name="ln-9483"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9484"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>           <span class="c">! dry air mass flow rate through coil [kg/s] (adjusted for bypass if any)</span>
<a name="ln-9485"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>      <span class="c">! Ratio of actual air mass flow to rated air mass flow (adjusted for bypass if any)</span>
<a name="ln-9486"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolumeFlowRate</span>     <span class="c">! Air volume flow rate across the cooling coil [m3/s] (adjusted for bypass if any)</span>
<a name="ln-9487"></a>                                   <span class="c">! (average flow if cycling fan, full flow if constant fan)</span>
<a name="ln-9488"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowperRatedTotCap</span> <span class="c">! Air volume flow rate divided by rated total cooling capacity [m3/s-W] (adjusted for bypass)</span>
<a name="ln-9489"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>                <span class="c">! gross total cooling capacity at off-rated conditions [W]</span>
<a name="ln-9490"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>      <span class="c">! Total capacity modifier (function of entering wetbulb, outside drybulb)</span>
<a name="ln-9491"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span>      <span class="c">! Total capacity modifier (function of actual supply air flow vs rated flow)</span>
<a name="ln-9492"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirWetBulbC</span>      <span class="c">! wetbulb temperature of inlet air [C]</span>
<a name="ln-9493"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDryBulbTemp</span>   <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-9494"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>      <span class="c">! inlet air enthalpy [J/kg]</span>
<a name="ln-9495"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>        <span class="c">! inlet air humidity ratio [kg/kg]</span>
<a name="ln-9496"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRatTemp</span>    <span class="c">! inlet air humidity ratio used in ADP/BF loop [kg/kg]</span>
<a name="ln-9497"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9498"></a><span class="c">!REAL(r64) :: InletAirPressure      ! inlet air pressure [Pa]</span>
<a name="ln-9499"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBF</span>              <span class="c">! coil bypass factor at rated conditions</span>
<a name="ln-9500"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>                   <span class="c">! Sensible Heat Ratio (sensible/total) of the cooling coil</span>
<a name="ln-9501"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBF</span>                   <span class="c">! coil bypass factor at off rated conditions</span>
<a name="ln-9502"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A0</span>                    <span class="c">! NTU * air mass flow rate, used in CBF calculation</span>
<a name="ln-9503"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hDelta</span>                <span class="c">! Change in air enthalpy across the cooling coil [J/kg]</span>
<a name="ln-9504"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>                  <span class="c">! Apparatus dew point enthalpy [J/kg]</span>
<a name="ln-9505"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>              <span class="c">! Enthalpy at inlet dry-bulb and wADP [J/kg]</span>
<a name="ln-9506"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>              <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-9507"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>                  <span class="c">! Apparatus dew point temperature [C]</span>
<a name="ln-9508"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>                  <span class="c">! Apparatus dew point humidity ratio [kg/kg]</span>
<a name="ln-9509"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span>    <span class="c">! outlet full load enthalpy [J/kg]</span>
<a name="ln-9510"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span>  <span class="c">! outlet humidity ratio at full load</span>
<a name="ln-9511"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>    <span class="c">! outlet air temperature at full load [C]</span>
<a name="ln-9512"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>                   <span class="c">! Part load factor, accounts for thermal lag at compressor startup, used in power calculation</span>
<a name="ln-9513"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>            <span class="c">! operating latent capacity of DX coil</span>
<a name="ln-9514"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>             <span class="c">! Rated latent capacity of DX coil</span>
<a name="ln-9515"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRUnadjusted</span>         <span class="c">! SHR prior to latent degradation effective SHR calculation</span>
<a name="ln-9516"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Counter</span>                 <span class="c">! Counter for dry evaporator iterations</span>
<a name="ln-9517"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxIter</span>                 <span class="c">! Maximum number of iterations for dry evaporator calculations</span>
<a name="ln-9518"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RF</span>                    <span class="c">! Relaxation factor for dry evaporator iterations</span>
<a name="ln-9519"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tolerance</span>             <span class="c">! Error tolerance for dry evaporator iterations</span>
<a name="ln-9520"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>                <span class="c">! Deviation of humidity ratio in dry evaporator iteration loop</span>
<a name="ln-9521"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-9522"></a>                                 <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-9523"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>       <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-9524"></a>                                 <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-9525"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>       <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-9526"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoAir</span>                <span class="c">! Density of air [kg/m3]</span>
<a name="ln-9527"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span> <span class="c">! power due to crankcase heater</span>
<a name="ln-9528"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompAmbTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Ambient temperature at compressor</span>
<a name="ln-9529"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRatio</span>          <span class="c">! ratio of compressor on airflow to average timestep airflow</span>
<a name="ln-9530"></a>                                 <span class="c">! used when constant fan mode yields different air flow rates when compressor is ON and OFF</span>
<a name="ln-9531"></a>                                 <span class="c">! (e.g. Packaged Terminal Heat Pump)</span>
<a name="ln-9532"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>        <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-9533"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>        <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-9534"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>         <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-9535"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorPressure</span>       <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-9536"></a>
<a name="ln-9537"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-9538"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! minimum of the inlet air humidity ratio and the outlet air humidity ratio</span>
<a name="ln-9539"></a><span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">Mode</span>           <span class="c">! Performance mode for Multimode DX coil; Always 1 for other coil types</span>
<a name="ln-9540"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>           <span class="c">! Supply air temperature (average value if constant fan, full output if cycling fan)</span>
<a name="ln-9541"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>         <span class="c">! Supply air humidity ratio (average value if constant fan, full output if cycling fan)</span>
<a name="ln-9542"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>       <span class="c">! Supply air enthalpy (average value if constant fan, full output if cycling fan)</span>
<a name="ln-9543"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Adiff</span>                   <span class="c">! Used for exponential</span>
<a name="ln-9544"></a>
<a name="ln-9545"></a><span class="c">! If Performance mode not present, then set to 1.  Used only by Multimode/Multispeed DX coil (otherwise mode = 1)</span>
<a name="ln-9546"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PerfMode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9547"></a><span class="k">  </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">PerfMode</span>
<a name="ln-9548"></a><span class="k">ELSE</span>
<a name="ln-9549"></a><span class="k">  </span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9550"></a><span class="k">END IF</span>
<a name="ln-9551"></a>
<a name="ln-9552"></a><span class="c">! If AirFlowRatio not present, then set to 1. Used only by DX coils with different air flow</span>
<a name="ln-9553"></a><span class="c">! during cooling and when no cooling is required (constant fan, fan speed changes)</span>
<a name="ln-9554"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">OnOffAirFlowRatio</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9555"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-9556"></a><span class="k">ELSE</span>
<a name="ln-9557"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9558"></a><span class="k">END IF</span>
<a name="ln-9559"></a>
<a name="ln-9560"></a><span class="n">MaxIter</span>         <span class="o">=</span> <span class="mi">30</span>
<a name="ln-9561"></a><span class="n">RF</span>              <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-9562"></a><span class="n">Counter</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9563"></a><span class="n">Tolerance</span>       <span class="o">=</span> <span class="mf">0.01d0</span>
<a name="ln-9564"></a><span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9565"></a><span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9566"></a><span class="n">AirMassFlow</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-9567"></a><span class="n">InletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-9568"></a><span class="n">InletAirEnthalpy</span>    <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-9569"></a><span class="n">InletAirHumRat</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-9570"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9571"></a><span class="c">!InletAirPressure    = DXCoil(DXCoilNum)%InletAirPressure</span>
<a name="ln-9572"></a><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9573"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9574"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9575"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9576"></a>
<a name="ln-9577"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9578"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Temp</span>
<a name="ln-9579"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">WaterCooled</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9580"></a><span class="k">    </span><span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-9581"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-9582"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-9583"></a>  <span class="k">ELSE</span>
<a name="ln-9584"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-9585"></a>    <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-9586"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9587"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9588"></a>      <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-9589"></a>      <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-9590"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-9591"></a>    <span class="k">ELSE</span>
<a name="ln-9592"></a><span class="k">      </span><span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">HumRat</span>
<a name="ln-9593"></a> <span class="c">! this should use Node%WetBulbTemp or a PSYC function, not OAWB</span>
<a name="ln-9594"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">OutAirWetBulb</span>
<a name="ln-9595"></a>    <span class="k">END IF</span>
<a name="ln-9596"></a><span class="k">  END IF</span>
<a name="ln-9597"></a><span class="k">ELSE</span>
<a name="ln-9598"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9599"></a>  <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-9600"></a>  <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-9601"></a>  <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-9602"></a><span class="n">ENDIF</span>
<a name="ln-9603"></a>
<a name="ln-9604"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9605"></a><span class="k">  </span><span class="n">RhoAir</span>          <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">)</span>
<a name="ln-9606"></a>  <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-9607"></a> <span class="c">! (Outdoor wet-bulb temp from DataEnvironment) + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-9608"></a>  <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-9609"></a>  <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9610"></a>  <span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-9611"></a><span class="k">ELSE</span> <span class="c">! for air or water-cooled, inlet temp is stored in OutdoorDryBulb temp</span>
<a name="ln-9612"></a>  <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorDryBulb</span> <span class="c">! Outdoor dry-bulb temp or water inlet temp</span>
<a name="ln-9613"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">WaterCooled</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9614"></a><span class="k">    </span><span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">OutDryBulbTemp</span> <span class="c">! for crankcase heater use actual outdoor temp for water-cooled</span>
<a name="ln-9615"></a>  <span class="k">ELSE</span>
<a name="ln-9616"></a><span class="k">    </span><span class="n">CompAmbTemp</span>     <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-9617"></a>  <span class="k">END IF</span>
<a name="ln-9618"></a><span class="k">END IF</span>
<a name="ln-9619"></a>
<a name="ln-9620"></a><span class="c">! Initialize crankcase heater, operates below OAT defined in input deck for HP DX cooling coil</span>
<a name="ln-9621"></a><span class="c">! If used in a heat pump, the value of MaxOAT in the heating coil overrides that in the cooling coil (in GetInput)</span>
<a name="ln-9622"></a><span class="k">IF</span> <span class="p">(</span><span class="n">CompAmbTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9623"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-9624"></a><span class="k">ELSE</span>
<a name="ln-9625"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9626"></a><span class="k">END IF</span>
<a name="ln-9627"></a>
<a name="ln-9628"></a><span class="c">! calculate end time of current time step to determine if error messages should be printed</span>
<a name="ln-9629"></a><span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-9630"></a>
<a name="ln-9631"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-9632"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-9633"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-9634"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-9635"></a><span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! .AND. &amp;</span>
<a name="ln-9636"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9637"></a>     <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9638"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9639"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer1</span><span class="p">))</span>
<a name="ln-9640"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer2</span><span class="p">))</span>
<a name="ln-9641"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Operation at low inlet temperatures may require special performance curves.&#39;</span><span class="p">)</span>
<a name="ln-9642"></a>    <span class="n">ENDIF</span>
<a name="ln-9643"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-9644"></a>      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Low condenser inlet temperature error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9645"></a>      <span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9646"></a>        <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-9647"></a>  <span class="k">END IF</span>
<a name="ln-9648"></a><span class="k">END IF</span>
<a name="ln-9649"></a>
<a name="ln-9650"></a><span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintHighAmbMessage</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! .AND. &amp;</span>
<a name="ln-9651"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9652"></a>     <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9653"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9654"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbBuffer1</span><span class="p">))</span>
<a name="ln-9655"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbBuffer2</span><span class="p">))</span>
<a name="ln-9656"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Operation at high inlet temperatures may require special performance curves.&#39;</span><span class="p">)</span>
<a name="ln-9657"></a>    <span class="n">ENDIF</span>
<a name="ln-9658"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-9659"></a>      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - High condenser inlet temperature error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9660"></a>      <span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbErrIndex</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighTempLast</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighTempLast</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9661"></a>        <span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-9662"></a>  <span class="k">END IF</span>
<a name="ln-9663"></a><span class="k">END IF</span>
<a name="ln-9664"></a>
<a name="ln-9665"></a><span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowOutTempMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9666"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9667"></a>       <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9668"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutletTempIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9669"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer1</span><span class="p">))</span>
<a name="ln-9670"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer2</span><span class="p">))</span>
<a name="ln-9671"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Possible reasons for low outlet air dry-bulb temperatures are: This DX coil&#39;</span><span class="p">)</span>
<a name="ln-9672"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   1) may have a low inlet air dry-bulb temperature. Inlet air temperature = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9673"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadInletAirTempLast</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-9674"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   2) may have a low air flow rate per watt of cooling capacity. Check inputs.&#39;</span><span class="p">)</span>
<a name="ln-9675"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   3) is used as part of a HX assisted cooling coil which uses a high sensible&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9676"></a>                                   <span class="s1">&#39; effectiveness. Check inputs.&#39;</span><span class="p">)</span>
<a name="ln-9677"></a>    <span class="k">END IF</span>
<a name="ln-9678"></a><span class="k">    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-9679"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Full load outlet temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9680"></a>          <span class="s1">&#39; indicates a possibility of frost/freeze error continues. Outlet air temperature statistics follow:&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9681"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutletTempIndex</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadOutAirTempLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9682"></a>             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadOutAirTempLast</span><span class="p">)</span>
<a name="ln-9683"></a>  <span class="k">END IF</span>
<a name="ln-9684"></a><span class="k">END IF</span>
<a name="ln-9685"></a>
<a name="ln-9686"></a><span class="c">! save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-9687"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-9688"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-9689"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9690"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9691"></a>
<a name="ln-9692"></a><span class="k">IF</span><span class="p">((</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9693"></a>   <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9694"></a>   <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CompOp</span> <span class="o">==</span> <span class="n">On</span><span class="p">))</span> <span class="k">THEN</span>      <span class="c">! for cycling fan, reset mass flow to full on rate</span>
<a name="ln-9695"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9696"></a><span class="k">    </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">/</span> <span class="n">PartLoadRatio</span>
<a name="ln-9697"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9698"></a><span class="k">    </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="n">AirFlowRatio</span>
<a name="ln-9699"></a>  <span class="k">ELSE</span>
<a name="ln-9700"></a><span class="k">    </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-9701"></a>  <span class="k">END IF</span>
<a name="ln-9702"></a>
<a name="ln-9703"></a><span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 500 cfm/ton)</span>
<a name="ln-9704"></a>
<a name="ln-9705"></a><span class="c">! for some reason there are diff&#39;s when using coil inlet air pressure</span>
<a name="ln-9706"></a><span class="c">! these lines (more to follow) are commented out for the time being</span>
<a name="ln-9707"></a>
<a name="ln-9708"></a>  <span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9709"></a>  <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-9710"></a>  <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-9711"></a>
<a name="ln-9712"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9713"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9714"></a>        <span class="s1">&#39;&quot; - Rated total cooling capacity is zero or less.&#39;</span><span class="p">)</span>
<a name="ln-9715"></a>  <span class="k">END IF</span>
<a name="ln-9716"></a>
<a name="ln-9717"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9718"></a>      <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9719"></a>       <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))))</span> <span class="k">THEN</span>
<a name="ln-9720"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9721"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9722"></a>        <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out of range at &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9723"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W.&#39;</span><span class="p">)</span>
<a name="ln-9724"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9725"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9726"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9727"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-9728"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Possible causes include inconsistent air flow rates in system components,&#39;</span><span class="p">)</span>
<a name="ln-9729"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...or mixing manual inputs with autosize inputs.&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9730"></a>                             <span class="s1">&#39; Also check the following values and calculations.&#39;</span><span class="p">)</span>
<a name="ln-9731"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Volume Flow Rate per Rated Total Capacity = Volume Flow Rate / Rated Total Capacity&#39;</span><span class="p">)</span>
<a name="ln-9732"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Volume Flow Rate = Air Mass Flow Rate / Air Density&#39;</span><span class="p">)</span>
<a name="ln-9733"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Data used for calculations:&#39;</span><span class="p">)</span>
<a name="ln-9734"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Rated Total Capacity = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W.&#39;</span><span class="p">)</span>
<a name="ln-9735"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Volume Flow Rate = Air Mass Flow Rate / Air Density&#39;</span><span class="p">)</span>
<a name="ln-9736"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Volume Flow Rate   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirVolumeFlowRate</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s.&#39;</span><span class="p">)</span>
<a name="ln-9737"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlow</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-9738"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Density        = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9739"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">),</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/m3.&#39;</span><span class="p">)</span>
<a name="ln-9740"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Data used for air density calculation:&#39;</span><span class="p">)</span>
<a name="ln-9741"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outdoor Air Pressure     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Pa.&#39;</span><span class="p">)</span>
<a name="ln-9742"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Dry-Bulb Temp  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-9743"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir.&#39;</span><span class="p">)</span>
<a name="ln-9744"></a>
<a name="ln-9745"></a>    <span class="n">ENDIF</span>
<a name="ln-9746"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9747"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9748"></a>          <span class="s1">&#39;of range error continues...&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span><span class="p">,</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-9749"></a>  <span class="k">END IF</span>
<a name="ln-9750"></a><span class="c">!</span>
<a name="ln-9751"></a><span class="c">!    Adjust coil bypass factor for actual air flow rate. Use relation CBF = exp(-NTU) where</span>
<a name="ln-9752"></a><span class="c">!    NTU = A0/(m*cp). Relationship models the cooling coil as a heat exchanger with Cmin/Cmax = 0.</span>
<a name="ln-9753"></a>
<a name="ln-9754"></a>  <span class="n">RatedCBF</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-9755"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RatedCBF</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9756"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="o">-</span><span class="nb">log</span><span class="p">(</span><span class="n">RatedCBF</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-9757"></a>  <span class="k">ELSE</span>
<a name="ln-9758"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9759"></a>  <span class="k">END IF</span>
<a name="ln-9760"></a><span class="k">  </span><span class="n">ADiff</span><span class="o">=-</span><span class="n">A0</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9761"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ADiff</span> <span class="o">&gt;=</span> <span class="n">EXP_LowerLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9762"></a><span class="k">     </span><span class="n">CBF</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">ADiff</span><span class="p">)</span>
<a name="ln-9763"></a>  <span class="k">ELSE</span>
<a name="ln-9764"></a><span class="k">     </span><span class="n">CBF</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9765"></a>  <span class="k">END IF</span>
<a name="ln-9766"></a>
<a name="ln-9767"></a><span class="c">! check boundary for low ambient temperature and post warnings to individual DX coil buffers to print at end of time step</span>
<a name="ln-9768"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9769"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowAmbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9770"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowTempLast</span> <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-9771"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9772"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9773"></a>       <span class="s1">&#39;&quot; - Condenser inlet temperature below &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9774"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C. Condenser inlet temperature = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9775"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-9776"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowAmbBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;... Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-9777"></a>                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-9778"></a>    <span class="k">END IF</span>
<a name="ln-9779"></a><span class="k">  END IF</span>
<a name="ln-9780"></a>
<a name="ln-9781"></a><span class="c">! check boundary for high ambient temperature and post warnings to individual DX coil buffers to print at end of time step</span>
<a name="ln-9782"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCompressor</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9783"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintHighAmbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9784"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighTempLast</span> <span class="o">=</span> <span class="n">OutdoorDryBulb</span>
<a name="ln-9785"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9786"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9787"></a>       <span class="s1">&#39;&quot; - Condenser inlet temperature above &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9788"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCompressor</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C. Condenser temperature = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9789"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-9790"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HighAmbBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;... Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-9791"></a>                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-9792"></a>    <span class="k">END IF</span>
<a name="ln-9793"></a><span class="k">  END IF</span>
<a name="ln-9794"></a>
<a name="ln-9795"></a><span class="c">!  Get total capacity modifying factor (function of temperature) for off-rated conditions</span>
<a name="ln-9796"></a><span class="c">!  InletAirHumRat may be modified in this ADP/BF loop, use temporary varible for calculations</span>
<a name="ln-9797"></a>   <span class="n">InletAirHumRatTemp</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9798"></a><span class="c">! No need to differentiate between curve types, single-independent curve will just use first variable</span>
<a name="ln-9799"></a><span class="c">! (as long as the first independent variable is the same for both curve types)</span>
<a name="ln-9800"></a><span class="mi">50</span> <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-9801"></a>
<a name="ln-9802"></a><span class="c">!  Warn user if curve output goes negative</span>
<a name="ln-9803"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9804"></a><span class="k">     IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9805"></a><span class="k">       CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-9806"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Total Cooling Capacity Modifier curve (function of temperature) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-9807"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotCapTempModFac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-9808"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using a condenser inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-9809"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9810"></a>                             <span class="s1">&#39; and an inlet air wet-bulb temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-9811"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9812"></a><span class="k">         Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative output results from stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9813"></a>                                <span class="s1">&#39; compressor operation.&#39;</span><span class="p">)</span>
<a name="ln-9814"></a>       <span class="k">END IF</span>
<a name="ln-9815"></a><span class="k">       CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-9816"></a>     <span class="k">END IF</span>
<a name="ln-9817"></a><span class="k">     CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9818"></a>         <span class="s1">&#39; Total Cooling Capacity Modifier curve (function of temperature) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9819"></a>         <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTempErrorIndex</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">)</span>
<a name="ln-9820"></a>     <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9821"></a>   <span class="k">END IF</span>
<a name="ln-9822"></a>
<a name="ln-9823"></a><span class="c">!  Get total capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-9824"></a>   <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-9825"></a>   <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-9826"></a>
<a name="ln-9827"></a><span class="c">!  Warn user if curve output goes negative</span>
<a name="ln-9828"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">TotCapFlowModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9829"></a><span class="k">     IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9830"></a><span class="k">       CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-9831"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Total Cooling Capacity Modifier curve (function of flow fraction) output is negative (&#39;</span> <span class="p">&amp;</span>
<a name="ln-9832"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotCapFlowModFac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-9833"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative value occurs using an air flow fraction of &#39;</span> <span class="p">&amp;</span>
<a name="ln-9834"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-9835"></a>       <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-9836"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">Mode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9837"></a><span class="k">         Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Negative output results from stage &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9838"></a>                                <span class="s1">&#39; compressor operation.&#39;</span><span class="p">)</span>
<a name="ln-9839"></a>       <span class="k">END IF</span>
<a name="ln-9840"></a><span class="k">     END IF</span>
<a name="ln-9841"></a><span class="k">     CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9842"></a>        <span class="s1">&#39; Total Cooling Capacity Modifier curve (function of flow fraction) output is negative warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9843"></a>        <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlowErrorIndex</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span>
<a name="ln-9844"></a>     <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9845"></a>  <span class="k">END IF</span>
<a name="ln-9846"></a>
<a name="ln-9847"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxCoolCap</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9848"></a><span class="k">    </span><span class="n">TotCap</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">MaxCoolCap</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span><span class="p">)</span>
<a name="ln-9849"></a>  <span class="k">ELSE</span>
<a name="ln-9850"></a><span class="k">    </span><span class="n">TotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-9851"></a>  <span class="k">END IF</span>
<a name="ln-9852"></a>
<a name="ln-9853"></a><span class="k">  </span><span class="n">TotCap</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-9854"></a>
<a name="ln-9855"></a><span class="c">! Calculate apparatus dew point conditions using TotCap and CBF</span>
<a name="ln-9856"></a>  <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9857"></a><span class="c">! there is an issue here with using CBF to calculate the ADP enthalpy.</span>
<a name="ln-9858"></a><span class="c">! at low loads the bypass factor increases significantly.</span>
<a name="ln-9859"></a>  <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-9860"></a>  <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcVRFCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-9861"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9862"></a><span class="c">!  tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-9863"></a>  <span class="n">wADP</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">,</span><span class="s1">&#39;CalcVRFCoolingCoil&#39;</span><span class="p">))</span>
<a name="ln-9864"></a>  <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">,</span><span class="s1">&#39;CalcVRFCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-9865"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9866"></a><span class="k">    </span><span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-9867"></a>  <span class="k">ELSE</span>
<a name="ln-9868"></a><span class="k">    </span><span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9869"></a>  <span class="k">END IF</span>
<a name="ln-9870"></a><span class="c">!</span>
<a name="ln-9871"></a><span class="c">! Check for dry evaporator conditions (win &lt; wadp)</span>
<a name="ln-9872"></a><span class="c">!</span>
<a name="ln-9873"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">wADP</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">InletAirHumRatTemp</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9874"></a><span class="k">     If</span><span class="p">(</span><span class="n">InletAirHumRatTemp</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">InletAirHumRatTemp</span><span class="o">=</span><span class="mf">0.00001d0</span>
<a name="ln-9875"></a>     <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">InletAirHumRatTemp</span> <span class="o">-</span> <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">InletAirHumRatTemp</span>
<a name="ln-9876"></a><span class="c">!</span>
<a name="ln-9877"></a><span class="c">! Increase InletAirHumRatTemp at constant InletAirTemp to find coil dry-out point. Then use the</span>
<a name="ln-9878"></a><span class="c">! capacity at the dry-out point to determine exiting conditions from coil. This is required</span>
<a name="ln-9879"></a><span class="c">! since the TotCapTempModFac doesn&#39;t work properly with dry-coil conditions.</span>
<a name="ln-9880"></a><span class="c">!</span>
<a name="ln-9881"></a>      <span class="n">InletAirHumRatTemp</span> <span class="o">=</span> <span class="n">RF</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RF</span><span class="p">)</span><span class="o">*</span><span class="n">InletAirHumRatTemp</span>
<a name="ln-9882"></a>      <span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRatTemp</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9883"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9884"></a><span class="c">!     InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRatTemp,InletAirPressure)</span>
<a name="ln-9885"></a>      <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-9886"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="n">go</span> <span class="n">to</span> <span class="mi">50</span>   <span class="c">! Recalculate with modified inlet conditions</span>
<a name="ln-9887"></a>
<a name="ln-9888"></a>  <span class="k">END IF</span>
<a name="ln-9889"></a>
<a name="ln-9890"></a><span class="k">  IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompCycRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9891"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">mode</span><span class="p">),</span><span class="n">CompCycRatio</span><span class="p">)</span> <span class="c">! Calculate part-load factor</span>
<a name="ln-9892"></a>  <span class="k">ELSE</span>
<a name="ln-9893"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9894"></a>  <span class="k">END IF</span>
<a name="ln-9895"></a>
<a name="ln-9896"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9897"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9898"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The PLF curve value for the DX cooling coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9899"></a>                       <span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9900"></a>                       <span class="s1">&#39; for part-load ratio =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-9901"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;PLF curve values must be &gt;= 0.7. PLF has been reset to 0.7 and simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-9902"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Cooling:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-9903"></a>    <span class="k">END IF</span>
<a name="ln-9904"></a><span class="k">    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9905"></a>                  <span class="s1">&#39;, DX cooling coil PLF curve &lt; 0.7 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9906"></a>                   <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex2</span><span class="p">,</span><span class="n">PLF</span><span class="p">,</span><span class="n">PLF</span><span class="p">)</span>
<a name="ln-9907"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-9908"></a>  <span class="k">END IF</span>
<a name="ln-9909"></a>
<a name="ln-9910"></a>
<a name="ln-9911"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-9912"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="n">CompCycRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-9913"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-9914"></a>      <span class="nb">ABS</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9915"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9916"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The runtime fraction for DX cooling coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9917"></a>                           <span class="s1">&#39; exceeded 1.0. [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-9918"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Runtime fraction reset to 1 and the simulation will continue.&#39;</span><span class="p">)</span>
<a name="ln-9919"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Cooling:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-9920"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9921"></a>    <span class="k">END IF</span>
<a name="ln-9922"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-9923"></a>                     <span class="s1">&#39;, DX cooling coil runtime fraction &gt; 1.0 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9924"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex3</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-9925"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-9926"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9927"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-9928"></a>  <span class="k">END IF</span>
<a name="ln-9929"></a>
<a name="ln-9930"></a>  <span class="c">! If cycling fan, send coil part-load fraction to on/off fan via HVACDataGlobals</span>
<a name="ln-9931"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PLF</span>
<a name="ln-9932"></a>
<a name="ln-9933"></a>  <span class="c">!  Calculate full load output conditions</span>
<a name="ln-9934"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9935"></a>  <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9936"></a>  <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9937"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9938"></a><span class="k">    </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9939"></a>  <span class="k">ELSE</span>
<a name="ln-9940"></a><span class="k">    </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9941"></a>  <span class="k">END IF</span>
<a name="ln-9942"></a><span class="k">  </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">)</span>
<a name="ln-9943"></a>
<a name="ln-9944"></a><span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-9945"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9946"></a><span class="k">    </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-9947"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-9948"></a><span class="c">!   IF(FullLoadOutAirTemp .LT. PsyTsatFnHPb(FullLoadOutAirEnth,InletAirPressure)) THEN</span>
<a name="ln-9949"></a><span class="c">!    FullLoadOutAirTemp = PsyTsatFnHPb(FullLoadOutAirEnth,InletAirPressure)</span>
<a name="ln-9950"></a>    <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">)</span>
<a name="ln-9951"></a>   <span class="k">END IF</span>
<a name="ln-9952"></a>
<a name="ln-9953"></a>  <span class="c">! Store actual outlet conditions when DX coil is ON for use in heat recovery module</span>
<a name="ln-9954"></a>  <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-9955"></a>  <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-9956"></a>
<a name="ln-9957"></a><span class="c">! Add warning message for cold cooling coil (FullLoadOutAirTemp &lt; 2 C)</span>
<a name="ln-9958"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">2.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9959"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PrintLowOutTempMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9960"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadOutAirTempLast</span> <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-9961"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutletTempIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9962"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FullLoadInletAirTempLast</span> <span class="o">=</span> <span class="n">InletAirDryBulbTemp</span>
<a name="ln-9963"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer1</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9964"></a>       <span class="s1">&#39;&quot; - Full load outlet air dry-bulb temperature &lt; 2C. This indicates the possibility of coil frost/freeze.&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9965"></a>       <span class="s1">&#39; Outlet temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span>
<a name="ln-9966"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LowOutTempBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-9967"></a>                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-9968"></a>    <span class="k">END IF</span>
<a name="ln-9969"></a><span class="k">  END IF</span>
<a name="ln-9970"></a>
<a name="ln-9971"></a>  <span class="c">!  If constant fan with cycling compressor, call function to determine &quot;effective SHR&quot;</span>
<a name="ln-9972"></a>  <span class="c">!  which includes the part-load degradation on latent capacity</span>
<a name="ln-9973"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompCycRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9974"></a><span class="k">     </span><span class="n">QLatRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-9975"></a>     <span class="n">QLatActual</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SHR</span><span class="p">)</span>
<a name="ln-9976"></a>     <span class="n">SHRUnadjusted</span> <span class="o">=</span> <span class="n">SHR</span>
<a name="ln-9977"></a>     <span class="n">SHR</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHR</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9978"></a>                          <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirWetbulbC</span><span class="p">,</span> <span class="n">Mode</span><span class="p">)</span>
<a name="ln-9979"></a>
<a name="ln-9980"></a>  <span class="c">!  Calculate full load output conditions</span>
<a name="ln-9981"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9982"></a>    <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-9983"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-9984"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9985"></a><span class="k">      </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-9986"></a>    <span class="k">ELSE</span>
<a name="ln-9987"></a><span class="k">      </span><span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-9988"></a>    <span class="k">END IF</span>
<a name="ln-9989"></a><span class="k">    </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">)</span>
<a name="ln-9990"></a>
<a name="ln-9991"></a>  <span class="k">END IF</span>
<a name="ln-9992"></a>
<a name="ln-9993"></a><span class="c">!  Calculate actual outlet conditions for the input part load ratio</span>
<a name="ln-9994"></a><span class="c">!  Actual outlet conditions are &quot;average&quot; for time step when compressor cycles</span>
<a name="ln-9995"></a>
<a name="ln-9996"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompCycRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9997"></a>    <span class="c">! Continuous fan, cycling compressor</span>
<a name="ln-9998"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9999"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">))</span><span class="o">*</span><span class="n">InletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10000"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-10001"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">))</span><span class="o">*</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-10002"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10003"></a>  <span class="k">ELSE</span>
<a name="ln-10004"></a>    <span class="c">! Default to cycling fan, cycling compressor</span>
<a name="ln-10005"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">FullLoadOutAirEnth</span>
<a name="ln-10006"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-10007"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-10008"></a>  <span class="k">END IF</span>
<a name="ln-10009"></a>
<a name="ln-10010"></a><span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-10011"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">OutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcVRFCoolingCoil&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10012"></a><span class="k">    </span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10013"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10014"></a><span class="c">!   IF(OutletAirTemp .LT. PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)) THEN</span>
<a name="ln-10015"></a><span class="c">!    OutletAirTemp = PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-10016"></a>    <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10017"></a>   <span class="k">END IF</span>
<a name="ln-10018"></a>
<a name="ln-10019"></a><span class="c">! Reset AirMassFlow to inlet node air mass flow for final total, sensible and latent calculations</span>
<a name="ln-10020"></a><span class="c">! since AirMassFlow might have been modified above (in this subroutine):</span>
<a name="ln-10021"></a><span class="c">!     IF (FanOpMode .EQ. CycFanCycCoil) AirMassFlow = AirMassFlow / PartLoadRatio</span>
<a name="ln-10022"></a><span class="c">!</span>
<a name="ln-10023"></a><span class="c">! For multimode coil, this should be full flow including bypassed fraction</span>
<a name="ln-10024"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-10025"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10026"></a>
<a name="ln-10027"></a><span class="c">!! Set DataHeatGlobal heat reclaim variable for use by heat reclaim coil (part load ratio is accounted for)</span>
<a name="ln-10028"></a><span class="c">!! Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-10029"></a><span class="c">!  HeatReclaimDXCoil(DXCoilNum)%AvailCapacity = DXCoil(DXCoilNum)%TotalCoolingEnergyRate + DXCoil(DXCoilNum)%ElecCoolingPower</span>
<a name="ln-10030"></a>
<a name="ln-10031"></a>  <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10032"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10033"></a>                                         <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-10034"></a>                                          <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">))</span>
<a name="ln-10035"></a><span class="c">!  Don&#39;t let sensible capacity be greater than total capacity</span>
<a name="ln-10036"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10037"></a><span class="k">     </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-10038"></a>  <span class="k">END IF</span>
<a name="ln-10039"></a><span class="c">!</span>
<a name="ln-10040"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-10041"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">OutletAirTemp</span>
<a name="ln-10042"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-10043"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-10044"></a>
<a name="ln-10045"></a><span class="k">ELSE</span>
<a name="ln-10046"></a>
<a name="ln-10047"></a>  <span class="c">! DX coil is off; just pass through conditions</span>
<a name="ln-10048"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-10049"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-10050"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-10051"></a>
<a name="ln-10052"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10053"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10054"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10055"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10056"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10057"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10058"></a>
<a name="ln-10059"></a><span class="c">! Reset globals when DX coil is OFF for use in heat recovery module</span>
<a name="ln-10060"></a>  <span class="n">DXCoilFullLoadOutAirTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10061"></a>  <span class="n">DXCoilFullLoadOutAirHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10062"></a>
<a name="ln-10063"></a><span class="k">END IF</span> <span class="c">! end of on/off if - else</span>
<a name="ln-10064"></a>
<a name="ln-10065"></a><span class="c">!set water system demand request (if needed)</span>
<a name="ln-10066"></a><span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10067"></a><span class="k">   </span><span class="n">WaterStorage</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10068"></a>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-10069"></a><span class="n">ENDIF</span>
<a name="ln-10070"></a>
<a name="ln-10071"></a><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-10072"></a><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-10073"></a><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>      <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10074"></a><span class="n">DXCoilFanOpMode</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>          <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-10075"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span>     <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-10076"></a><span class="n">DXCoilTotalCooling</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-10077"></a><span class="n">DXCoilCoolInletAirWBTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10078"></a>
<a name="ln-10079"></a><span class="k">RETURN</span>
<a name="ln-10080"></a><span class="k">END SUBROUTINE </span><span class="n">CalcVRFCoolingCoil</span>
<a name="ln-10081"></a>
<a name="ln-10082"></a><span class="k">SUBROUTINE </span><span class="n">CalcDXHeatingCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">MaxHeatCap</span><span class="p">)</span>
<a name="ln-10083"></a>
<a name="ln-10084"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10085"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-10086"></a>          <span class="c">!       DATE WRITTEN   October 2001</span>
<a name="ln-10087"></a>          <span class="c">!       MODIFIED       Raustad/Shirey Mar 2004</span>
<a name="ln-10088"></a>          <span class="c">!                      Kenneth Tang 2004 (Sensitivity of TotCapTempModFac &amp; EIRTempModFac  to indoor dry bulb temp)</span>
<a name="ln-10089"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-10090"></a>          <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-10091"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10092"></a>
<a name="ln-10093"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10094"></a>          <span class="c">! Calculates the air-side heating performance and electrical heating energy</span>
<a name="ln-10095"></a>          <span class="c">! use of a direct-expansion, air-cooled heat pump unit.</span>
<a name="ln-10096"></a>
<a name="ln-10097"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10098"></a>          <span class="c">! This routine simulates the performance of air-cooled DX heating equipment.</span>
<a name="ln-10099"></a>          <span class="c">! The routine requires the user to enter the total heating capacity</span>
<a name="ln-10100"></a>          <span class="c">! and COP for the unit at ARI 210/240 rating conditions (21.11C [70F] dry-bulb,</span>
<a name="ln-10101"></a>          <span class="c">! 15.55C [60F] wet-bulb air entering the heating coil, 8.33C [47F] dry-bulb,</span>
<a name="ln-10102"></a>          <span class="c">! 6.11C [43F] wet-bulb air entering the outdoor condenser. Since different</span>
<a name="ln-10103"></a>          <span class="c">! manufacturer&#39;s rate their equipment at different air flow rates, the supply</span>
<a name="ln-10104"></a>          <span class="c">! air flow rate corresponding to the rated capacities and rated COP must also</span>
<a name="ln-10105"></a>          <span class="c">! be entered (should be between 300 cfm/ton and 450 cfm/ton). The rated information</span>
<a name="ln-10106"></a>          <span class="c">! entered by the user should NOT include the thermal or electrical impacts of the</span>
<a name="ln-10107"></a>          <span class="c">! supply air fan, as this is addressed by another module.</span>
<a name="ln-10108"></a>
<a name="ln-10109"></a>          <span class="c">! With the rated performance data entered by the user, the model employs some of the</span>
<a name="ln-10110"></a>          <span class="c">! DOE-2.1E curve fits to adjust the capacity and efficiency of the unit as a function</span>
<a name="ln-10111"></a>          <span class="c">! of outdoor air temperatures and supply air flow rate (actual vs rated flow). The</span>
<a name="ln-10112"></a>          <span class="c">! model does NOT employ the exact same methodology to calculate performance as DOE-2,</span>
<a name="ln-10113"></a>          <span class="c">! although some of the DOE-2 curve fits are employed by this model.</span>
<a name="ln-10114"></a>
<a name="ln-10115"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10116"></a>          <span class="c">!</span>
<a name="ln-10117"></a>          <span class="c">! Winkelmann, F.C., Birdsall, B.E., Buhl W.F., Ellington, K.L., Erdem, A.E. 1993.</span>
<a name="ln-10118"></a>          <span class="c">! DOE-2 Supplement Version 2.1E.  Energy and Environment Division, Larwence Berkely</span>
<a name="ln-10119"></a>          <span class="c">! Laboratory.</span>
<a name="ln-10120"></a>          <span class="c">!</span>
<a name="ln-10121"></a>          <span class="c">! Henderson, H.I. Jr., Y.J. Huang and Danny Parker. 1999. Residential Equipment Part</span>
<a name="ln-10122"></a>          <span class="c">! Load Curves for Use in DOE-2.  Environmental Energy Technologies Division, Ernest</span>
<a name="ln-10123"></a>          <span class="c">! Orlando Lawrence Berkeley National Laboratory.</span>
<a name="ln-10124"></a>
<a name="ln-10125"></a>
<a name="ln-10126"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10127"></a><span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-10128"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-10129"></a>
<a name="ln-10130"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10131"></a>
<a name="ln-10132"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10133"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>        <span class="c">! the number of the DX heating coil to be simulated</span>
<a name="ln-10134"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>    <span class="c">! sensible cooling load / full load sensible cooling capacity</span>
<a name="ln-10135"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>        <span class="c">! Allows parent object to control fan mode</span>
<a name="ln-10136"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! ratio of compressor on airflow to compressor off airflow</span>
<a name="ln-10137"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MaxHeatCap</span>        <span class="c">! maximum allowed heating capacity</span>
<a name="ln-10138"></a>
<a name="ln-10139"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10140"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcDXHeatingCoil&#39;</span>
<a name="ln-10141"></a>
<a name="ln-10142"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10143"></a>          <span class="c">! na</span>
<a name="ln-10144"></a>
<a name="ln-10145"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10146"></a>          <span class="c">! na</span>
<a name="ln-10147"></a>
<a name="ln-10148"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10149"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AirMassFlow</span>                 <span class="c">! dry air mass flow rate through coil [kg/s]</span>
<a name="ln-10150"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>            <span class="c">! Ratio of actual air mass flow to rated air mass flow</span>
<a name="ln-10151"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AirVolumeFlowRate</span>           <span class="c">! Air volume flow rate across the cooling coil [m3/s]</span>
<a name="ln-10152"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">VolFlowperRatedTotCap</span>       <span class="c">! Air volume flow rate divided by rated total cooling capacity [m3/s-W]</span>
<a name="ln-10153"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotCap</span>                      <span class="c">! gross total cooling capacity at off-rated conditions [W]</span>
<a name="ln-10154"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotCapTempModFac</span>            <span class="c">! Total capacity modifier (function of entering drybulb, outside drybulb) depending</span>
<a name="ln-10155"></a>                                        <span class="c">! on the type of curve</span>
<a name="ln-10156"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotCapFlowModFac</span>            <span class="c">! Total capacity modifier (function of actual supply air flow vs rated flow)</span>
<a name="ln-10157"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InletAirDryBulbTemp</span>         <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-10158"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InletAirWetBulbC</span>            <span class="c">! wetbulb temperature of inlet air [C]</span>
<a name="ln-10159"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>            <span class="c">! inlet air enthalpy [J/kg]</span>
<a name="ln-10160"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InletAirHumRat</span>              <span class="c">! inlet air humidity ratio [kg/kg]</span>
<a name="ln-10161"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10162"></a><span class="c">!REAL(r64)     :: InletAirPressure            ! inlet air pressure [Pa]</span>
<a name="ln-10163"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span>          <span class="c">! outlet full load enthalpy [J/kg]</span>
<a name="ln-10164"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span>        <span class="c">! outlet humidity ratio at full load</span>
<a name="ln-10165"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>          <span class="c">! outlet air temperature at full load [C]</span>
<a name="ln-10166"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FullLoadOutAirRH</span>            <span class="c">! outlet air relative humidity at full load</span>
<a name="ln-10167"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">EIRTempModFac</span>               <span class="c">! EIR modifier (function of entering drybulb, outside drybulb) depending on the</span>
<a name="ln-10168"></a>                                        <span class="c">! type of curve</span>
<a name="ln-10169"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">DefrostEIRTempModFac</span>        <span class="c">! EIR modifier for defrost (function of entering wetbulb, outside drybulb)</span>
<a name="ln-10170"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">EIRFlowModFac</span>               <span class="c">! EIR modifier (function of actual supply air flow vs rated flow)</span>
<a name="ln-10171"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">EIR</span>                         <span class="c">! EIR at part load and off rated conditions</span>
<a name="ln-10172"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PLF</span>                         <span class="c">! Part load factor, accounts for thermal lag at compressor startup</span>
<a name="ln-10173"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PLRHeating</span>                  <span class="c">! PartLoadRatio in heating</span>
<a name="ln-10174"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorCoilT</span>                <span class="c">! Outdoor coil temperature (C)</span>
<a name="ln-10175"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorCoildw</span>               <span class="c">! Outdoor coil delta w assuming coil temp of OutdoorCoilT (kg/kg)</span>
<a name="ln-10176"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FractionalDefrostTime</span>       <span class="c">! Fraction of time step system is in defrost</span>
<a name="ln-10177"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatingCapacityMultiplier</span>   <span class="c">! Multiplier for heating capacity when system is in defrost</span>
<a name="ln-10178"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InputPowerMultiplier</span>        <span class="c">! Multiplier for power when system is in defrost</span>
<a name="ln-10179"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LoadDueToDefrost</span>            <span class="c">! Additional load due to defrost</span>
<a name="ln-10180"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span>       <span class="c">! power due to crankcase heater</span>
<a name="ln-10181"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>              <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-10182"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>              <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-10183"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorHumRat</span>               <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-10184"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutdoorPressure</span>             <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-10185"></a><span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">Mode</span><span class="o">=</span><span class="mi">1</span>             <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-10186"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">AirFlowRatio</span>       <span class="c">! Ratio of compressor on airflow to average timestep airflow</span>
<a name="ln-10187"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OutletAirTemp</span>      <span class="c">! Supply air temperature (average value if constant fan, full output if cycling fan)</span>
<a name="ln-10188"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OutletAirHumRat</span>    <span class="c">! Supply air humidity ratio (average value if constant fan, full output if cycling fan)</span>
<a name="ln-10189"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>  <span class="c">! Supply air enthalpy (average value if constant fan, full output if cycling fan)</span>
<a name="ln-10190"></a>
<a name="ln-10191"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">OnOffAirFlowRatio</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10192"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-10193"></a><span class="k">ELSE</span>
<a name="ln-10194"></a><span class="k">  </span><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10195"></a><span class="k">END IF</span>
<a name="ln-10196"></a>
<a name="ln-10197"></a><span class="c">! Get condenser outdoor node info from DX Heating Coil</span>
<a name="ln-10198"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10199"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Temp</span>
<a name="ln-10200"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">WaterCooled</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10201"></a><span class="k">    </span><span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-10202"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-10203"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-10204"></a>  <span class="k">ELSE</span>
<a name="ln-10205"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-10206"></a>    <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-10207"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10208"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-10209"></a>      <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-10210"></a>      <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-10211"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-10212"></a>    <span class="k">ELSE</span>
<a name="ln-10213"></a><span class="k">      </span><span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">HumRat</span>
<a name="ln-10214"></a> <span class="c">! this should use Node%WetBulbTemp or a PSYC function, not OAWB</span>
<a name="ln-10215"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">OutAirWetBulb</span>
<a name="ln-10216"></a>    <span class="k">END IF</span>
<a name="ln-10217"></a><span class="k">  END IF</span>
<a name="ln-10218"></a><span class="k">ELSE</span>
<a name="ln-10219"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-10220"></a>  <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-10221"></a>  <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-10222"></a>  <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-10223"></a><span class="n">ENDIF</span>
<a name="ln-10224"></a>
<a name="ln-10225"></a><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-10226"></a><span class="n">InletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-10227"></a><span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-10228"></a><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-10229"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10230"></a><span class="c">!InletAirPressure = DXCoil(DXCoilNum)%InletAirPressure</span>
<a name="ln-10231"></a><span class="c">!InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRat,InletAirPressure)</span>
<a name="ln-10232"></a><span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10233"></a><span class="n">PLRHeating</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10234"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10235"></a><span class="c">! Initialize crankcase heater, operates below OAT defined in input deck for HP DX heating coil</span>
<a name="ln-10236"></a><span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10237"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-10238"></a><span class="k">ELSE</span>
<a name="ln-10239"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10240"></a><span class="k">END IF</span>
<a name="ln-10241"></a>
<a name="ln-10242"></a><span class="k">IF</span><span class="p">((</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10243"></a>   <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10244"></a>   <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10245"></a><span class="c">! for cycling fan, reset mass flow to full on rate</span>
<a name="ln-10246"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">/</span> <span class="n">PartLoadRatio</span>
<a name="ln-10247"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="n">AirFlowRatio</span>
<a name="ln-10248"></a><span class="c">!</span>
<a name="ln-10249"></a><span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 600 cfm/ton)</span>
<a name="ln-10250"></a><span class="c">!</span>
<a name="ln-10251"></a>  <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-10252"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10253"></a><span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-10254"></a>  <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-10255"></a>
<a name="ln-10256"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10257"></a>      <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-10258"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10259"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-10260"></a>        <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out of range at &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10261"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W.&#39;</span><span class="p">)</span>
<a name="ln-10262"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10263"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10264"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10265"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-10266"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-10267"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-10268"></a>    <span class="n">ENDIF</span>
<a name="ln-10269"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-10270"></a>        <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-10271"></a>        <span class="s1">&#39;of range error continues...&#39;</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10272"></a>        <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-10273"></a>  <span class="k">END IF</span>
<a name="ln-10274"></a>
<a name="ln-10275"></a><span class="c">! Get total capacity modifying factor (function of temperature) for off-rated conditions</span>
<a name="ln-10276"></a><span class="c">! Model was extended to accept bi-quadratic curves. This allows sensitivity of the heating capacity</span>
<a name="ln-10277"></a><span class="c">! to the entering dry-bulb temperature as well as the outside dry-bulb temperature. User is</span>
<a name="ln-10278"></a><span class="c">! advised to use the bi-quaratic curve if sufficient manufacturer data is available.</span>
<a name="ln-10279"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotCapTempModFacCurveType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10280"></a><span class="k">   SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingPerformanceOATType</span><span class="p">)</span>
<a name="ln-10281"></a>     <span class="k">CASE</span><span class="p">(</span><span class="n">DryBulbIndicator</span><span class="p">)</span>
<a name="ln-10282"></a>       <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-10283"></a>     <span class="k">CASE</span><span class="p">(</span><span class="n">WetBulbIndicator</span><span class="p">)</span>
<a name="ln-10284"></a>       <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">)</span>
<a name="ln-10285"></a>     <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10286"></a>       <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-10287"></a>   <span class="k">END SELECT</span>
<a name="ln-10288"></a><span class="k"> ELSE</span>
<a name="ln-10289"></a><span class="k">   SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingPerformanceOATType</span><span class="p">)</span>
<a name="ln-10290"></a>     <span class="k">CASE</span><span class="p">(</span><span class="n">DryBulbIndicator</span><span class="p">)</span>
<a name="ln-10291"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10292"></a><span class="k">         </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-10293"></a>       <span class="k">ELSE</span>
<a name="ln-10294"></a><span class="k">         </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span>
<a name="ln-10295"></a>       <span class="k">END IF</span>
<a name="ln-10296"></a><span class="k">     CASE</span><span class="p">(</span><span class="n">WetBulbIndicator</span><span class="p">)</span>
<a name="ln-10297"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10298"></a><span class="k">         </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">OutdoorWetBulb</span><span class="p">)</span>
<a name="ln-10299"></a>       <span class="k">ELSE</span>
<a name="ln-10300"></a><span class="k">         </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span>
<a name="ln-10301"></a>       <span class="k">END IF</span>
<a name="ln-10302"></a><span class="k">     CASE </span><span class="n">DEFAULT</span>
<a name="ln-10303"></a>       <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-10304"></a>   <span class="k">END SELECT</span>
<a name="ln-10305"></a><span class="k"> END IF</span>
<a name="ln-10306"></a>
<a name="ln-10307"></a><span class="c">!  Get total capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-10308"></a>  <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-10309"></a>  <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-10310"></a>
<a name="ln-10311"></a><span class="c">! Calculate total heating capacity for off-rated conditions</span>
<a name="ln-10312"></a>  <span class="n">TotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-10313"></a>
<a name="ln-10314"></a><span class="c">! Calculating adjustment factors for defrost</span>
<a name="ln-10315"></a><span class="c">! Calculate delta w through outdoor coil by assuming a coil temp of 0.82*DBT-9.7(F) per DOE2.1E</span>
<a name="ln-10316"></a>  <span class="n">OutdoorCoilT</span> <span class="o">=</span> <span class="mf">0.82d0</span> <span class="o">*</span> <span class="n">OutdoorDryBulb</span> <span class="o">-</span> <span class="mf">8.589d0</span>
<a name="ln-10317"></a>  <span class="n">OutdoorCoildw</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">1.0d-6</span><span class="p">,(</span><span class="n">OutdoorHumRat</span> <span class="o">-</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">OutdoorCoilT</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)))</span>
<a name="ln-10318"></a>
<a name="ln-10319"></a><span class="c">! Initializing defrost adjustment factors</span>
<a name="ln-10320"></a>  <span class="n">LoadDueToDefrost</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10321"></a>  <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10322"></a>  <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10323"></a>  <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10324"></a>
<a name="ln-10325"></a><span class="c">! Check outdoor temperature to determine of defrost is active</span>
<a name="ln-10326"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10327"></a><span class="c">! Calculate defrost adjustment factors depending on defrost control type</span>
<a name="ln-10328"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Timed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10329"></a><span class="k">       </span><span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span>
<a name="ln-10330"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10331"></a><span class="k">         </span><span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.909d0</span> <span class="o">-</span> <span class="mi">10</span><span class="mf">7.33d0</span> <span class="o">*</span> <span class="n">OutdoorCoildw</span>
<a name="ln-10332"></a>         <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.90d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">6.45d0</span><span class="o">*</span><span class="n">OutdoorCoildw</span>
<a name="ln-10333"></a>       <span class="k">END IF</span>
<a name="ln-10334"></a><span class="k">     ELSE</span> <span class="c">!else defrost control is on-demand</span>
<a name="ln-10335"></a>       <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.01446d0</span> <span class="o">/</span> <span class="n">OutdoorCoildw</span><span class="p">)</span>
<a name="ln-10336"></a>       <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.875d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-10337"></a>       <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.954d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-10338"></a>     <span class="k">END IF</span>
<a name="ln-10339"></a>
<a name="ln-10340"></a>
<a name="ln-10341"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10342"></a><span class="c">! Calculate defrost adjustment factors depending on defrost control strategy</span>
<a name="ln-10343"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ReverseCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10344"></a><span class="k">         </span><span class="n">LoadDueToDefrost</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01d0</span> <span class="o">*</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10345"></a>                            <span class="p">(</span><span class="mf">7.222d0</span> <span class="o">-</span> <span class="n">OutdoorDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10346"></a>                            <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span>
<a name="ln-10347"></a>         <span class="n">DefrostEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">,&amp;</span>
<a name="ln-10348"></a>                                <span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">),</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">))</span>
<a name="ln-10349"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="n">DefrostEIRTempModFac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10350"></a>                                           <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10351"></a>                                           <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-10352"></a>       <span class="k">ELSE</span> <span class="c">! Defrost strategy is resistive</span>
<a name="ln-10353"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">&amp;</span>
<a name="ln-10354"></a>                                          <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-10355"></a>       <span class="k">END IF</span>
<a name="ln-10356"></a><span class="k">     ELSE</span> <span class="c">! Defrost is not active because (FractionalDefrostTime .EQ. 0.0)</span>
<a name="ln-10357"></a>       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-10358"></a>     <span class="k">END IF</span>
<a name="ln-10359"></a><span class="k">  END IF</span>
<a name="ln-10360"></a>
<a name="ln-10361"></a><span class="c">! Modify total heating capacity based on defrost heating capacity multiplier</span>
<a name="ln-10362"></a><span class="c">! MaxHeatCap passed from parent object VRF Condenser and is used to limit capacity of TU&#39;s to that available from condenser</span>
<a name="ln-10363"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxHeatCap</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10364"></a><span class="k">    </span><span class="n">TotCap</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">MaxHeatCap</span><span class="p">,</span><span class="n">TotCap</span> <span class="o">*</span> <span class="n">HeatingCapacityMultiplier</span><span class="p">)</span>
<a name="ln-10365"></a>  <span class="k">ELSE</span>
<a name="ln-10366"></a><span class="k">    </span><span class="n">TotCap</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">HeatingCapacityMultiplier</span>
<a name="ln-10367"></a>  <span class="k">END IF</span>
<a name="ln-10368"></a>
<a name="ln-10369"></a><span class="c">! Calculate full load outlet conditions</span>
<a name="ln-10370"></a>  <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">+</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-10371"></a>  <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-10372"></a>  <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">)</span>
<a name="ln-10373"></a>  <span class="n">FullLoadOutAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcDXHeatingCoil:fullload&#39;</span><span class="p">)</span>
<a name="ln-10374"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10375"></a><span class="c">!  FullLoadOutAirRH = PsyRhFnTdbWPb(FullLoadOutAirTemp,FullLoadOutAirHumRat,InletAirPressure)</span>
<a name="ln-10376"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadOutAirRH</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Limit to saturated conditions at FullLoadOutAirEnth</span>
<a name="ln-10377"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10378"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10379"></a><span class="c">!    FullLoadOutAirTemp = PsyTsatFnHPb(FullLoadOutAirEnth,InletAirPressure)</span>
<a name="ln-10380"></a>    <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">)</span>
<a name="ln-10381"></a>  <span class="k">END IF</span>
<a name="ln-10382"></a>
<a name="ln-10383"></a>  <span class="c">! Calculate actual outlet conditions for the input part load ratio</span>
<a name="ln-10384"></a>  <span class="c">! Actual outlet conditions are &quot;average&quot; for time step</span>
<a name="ln-10385"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10386"></a>    <span class="c">! continuous fan, cycling compressor</span>
<a name="ln-10387"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-10388"></a>       <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">AirFlowRatio</span><span class="p">))</span><span class="o">*</span><span class="n">InletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10389"></a>    <span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-10390"></a>    <span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10391"></a>  <span class="k">ELSE</span>
<a name="ln-10392"></a>    <span class="c">! default to cycling fan, cycling compressor</span>
<a name="ln-10393"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">FullLoadOutAirEnth</span>
<a name="ln-10394"></a>    <span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-10395"></a>    <span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-10396"></a>  <span class="k">END IF</span>
<a name="ln-10397"></a>  <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-10398"></a>  <span class="c">! Model was extended to accept bi-quadratic curves. This allows sensitivity of the EIR</span>
<a name="ln-10399"></a>  <span class="c">! to the entering dry-bulb temperature as well as the outside dry-bulb temperature. User is</span>
<a name="ln-10400"></a>  <span class="c">! advised to use the bi-quaratic curve if sufficient manufacturer data is available.</span>
<a name="ln-10401"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10402"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10403"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-10404"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10405"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-10406"></a>    <span class="k">END IF</span>
<a name="ln-10407"></a><span class="k">    </span><span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-10408"></a>  <span class="k">ELSE</span>
<a name="ln-10409"></a><span class="k">    </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10410"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10411"></a>  <span class="k">END IF</span>
<a name="ln-10412"></a><span class="k">  </span><span class="n">EIR</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span>
<a name="ln-10413"></a>  <span class="c">! Calculate modified PartLoadRatio due to defrost (reverse-cycle defrost only)</span>
<a name="ln-10414"></a>  <span class="n">PLRHeating</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">PartLoadRatio</span> <span class="o">+</span> <span class="n">LoadDueToDefrost</span><span class="o">/</span><span class="n">TotCap</span><span class="p">))</span>
<a name="ln-10415"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilVRF_Heating</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10416"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">PLRHeating</span><span class="p">)</span> <span class="c">! Calculate part-load factor</span>
<a name="ln-10417"></a>  <span class="k">ELSE</span>
<a name="ln-10418"></a><span class="k">    </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10419"></a>  <span class="k">END IF</span>
<a name="ln-10420"></a>
<a name="ln-10421"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10422"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10423"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The PLF curve value for DX heating coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-10424"></a>                         <span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10425"></a>                         <span class="s1">&#39; for part-load ratio =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLRHeating</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-10426"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;PLF curve values must be &gt;= 0.7. PLF has been reset to 0.7 and simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-10427"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Heating:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-10428"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10429"></a>    <span class="n">ENDIF</span>
<a name="ln-10430"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;DX heating coil PLF curve &lt; 0.7 warning continues... &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10431"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRErrIndex</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">PLF</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">PLF</span><span class="p">)</span>
<a name="ln-10432"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-10433"></a>  <span class="k">END IF</span>
<a name="ln-10434"></a>
<a name="ln-10435"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">PLRHeating</span> <span class="o">/</span> <span class="n">PLF</span><span class="p">)</span>
<a name="ln-10436"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-10437"></a>      <span class="nb">ABS</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10438"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10439"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The runtime fraction for DX heating coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-10440"></a>                         <span class="s1">&#39; exceeded 1.0. [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-10441"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Runtime fraction is set to 1.0 and the simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-10442"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Heating:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-10443"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10444"></a>    <span class="n">ENDIF</span>
<a name="ln-10445"></a>    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-10446"></a>                   <span class="s1">&#39;, DX heating coil runtime fraction &gt; 1.0 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10447"></a>           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex4</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-10448"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-10449"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10450"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-10451"></a>  <span class="k">END IF</span>
<a name="ln-10452"></a>  <span class="c">! if cycling fan, send coil part-load fraction to on/off fan via HVACDataGlobals</span>
<a name="ln-10453"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PLF</span>
<a name="ln-10454"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">*</span> <span class="n">InputPowerMultiplier</span>
<a name="ln-10455"></a>
<a name="ln-10456"></a><span class="c">! Calculate crankcase heater power using the runtime fraction for this DX heating coil only if there is no companion DX coil.</span>
<a name="ln-10457"></a><span class="c">! Else use the largest runtime fraction of this DX heating coil and the companion DX cooling coil.</span>
<a name="ln-10458"></a>
<a name="ln-10459"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10460"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10461"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-10462"></a>  <span class="k">ELSE</span>
<a name="ln-10463"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10464"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10465"></a>                                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">))</span>
<a name="ln-10466"></a>  <span class="k">END IF</span>
<a name="ln-10467"></a>
<a name="ln-10468"></a><span class="k">  </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-10469"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">OutletAirEnthalpy</span> <span class="o">-</span> <span class="n">InletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10470"></a><span class="c">! Adjust defrost power to correct for DOE-2 bug where defrost power is constant regardless of compressor runtime fraction</span>
<a name="ln-10471"></a><span class="c">! Defrosts happen based on compressor run time (frost buildup on outdoor coil), not total elapsed time.</span>
<a name="ln-10472"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span>
<a name="ln-10473"></a>
<a name="ln-10474"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">OutletAirTemp</span>
<a name="ln-10475"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-10476"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-10477"></a>
<a name="ln-10478"></a><span class="k">ELSE</span>
<a name="ln-10479"></a>
<a name="ln-10480"></a>  <span class="c">! DX coil is off; just pass through conditions</span>
<a name="ln-10481"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-10482"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-10483"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-10484"></a>
<a name="ln-10485"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10486"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10487"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10488"></a>
<a name="ln-10489"></a><span class="c">! Calculate crankcase heater power using the runtime fraction for this DX heating coil (here DXHeatingCoilRTF=0) if</span>
<a name="ln-10490"></a><span class="c">! there is no companion DX coil, or the runtime fraction of the companion DX cooling coil (here DXCoolingCoilRTF&gt;=0).</span>
<a name="ln-10491"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10492"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span>
<a name="ln-10493"></a>  <span class="k">ELSE</span>
<a name="ln-10494"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10495"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-10496"></a>  <span class="k">END IF</span>
<a name="ln-10497"></a>
<a name="ln-10498"></a><span class="k">END IF</span> <span class="c">! end of on/off if - else</span>
<a name="ln-10499"></a>
<a name="ln-10500"></a><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>    <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-10501"></a><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-10502"></a><span class="n">DXCoilFanOpMode</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>     <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-10503"></a><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">PLRHeating</span>
<a name="ln-10504"></a><span class="n">DXCoilTotalHeating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span>
<a name="ln-10505"></a><span class="n">DXCoilHeatInletAirDBTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InletAirDryBulbTemp</span>
<a name="ln-10506"></a><span class="n">DXCoilHeatInletAirWBTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InletAirWetbulbC</span>
<a name="ln-10507"></a>
<a name="ln-10508"></a><span class="k">RETURN</span>
<a name="ln-10509"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDXHeatingCoil</span>
<a name="ln-10510"></a>
<a name="ln-10511"></a>
<a name="ln-10512"></a><span class="k">SUBROUTINE </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">ForceOn</span><span class="p">)</span>
<a name="ln-10513"></a>
<a name="ln-10514"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10515"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-10516"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-10517"></a>          <span class="c">!       MODIFIED       Raustad/Shirey, Feb 2004</span>
<a name="ln-10518"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-10519"></a>          <span class="c">!                        Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-10520"></a>          <span class="c">!                      April 2010, Chandan sharma, FSEC, added basin heater</span>
<a name="ln-10521"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10522"></a>
<a name="ln-10523"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10524"></a>          <span class="c">! Calculates the air-side performance and electrical energy use of a direct-</span>
<a name="ln-10525"></a>          <span class="c">! expansion, air-cooled cooling unit with a 2 speed or variable speed compressor.</span>
<a name="ln-10526"></a>
<a name="ln-10527"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10528"></a>          <span class="c">! Uses the same methodology as the single speed DX unit model (SUBROUTINE CalcDoe2DXCoil).</span>
<a name="ln-10529"></a>          <span class="c">! In addition it assumes that the unit performance is obtained by interpolating between</span>
<a name="ln-10530"></a>          <span class="c">! the performance at high speed and that at low speed. If the output needed is below</span>
<a name="ln-10531"></a>          <span class="c">! that produced at low speed, the compressor cycles between off and low speed.</span>
<a name="ln-10532"></a>
<a name="ln-10533"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10534"></a><span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-10535"></a><span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-10536"></a><span class="c">!USE ScheduleManager, ONLY: GetCurrentScheduleValue</span>
<a name="ln-10537"></a>
<a name="ln-10538"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10539"></a>
<a name="ln-10540"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10541"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>        <span class="c">! the number of the DX heating coil to be simulated</span>
<a name="ln-10542"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>       <span class="c">! = (CompressorSpeed - CompressorSpeedMin) / (CompressorSpeedMax - CompressorSpeedMin)</span>
<a name="ln-10543"></a>                            <span class="c">! SpeedRatio varies between 1.0 (maximum speed) and 0.0 (minimum speed)</span>
<a name="ln-10544"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>         <span class="c">! cycling part load ratio</span>
<a name="ln-10545"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">ForceOn</span>
<a name="ln-10546"></a>
<a name="ln-10547"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10548"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcMultiSpeedDXCoil&#39;</span>
<a name="ln-10549"></a>
<a name="ln-10550"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10551"></a>          <span class="c">! na</span>
<a name="ln-10552"></a>
<a name="ln-10553"></a>
<a name="ln-10554"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10555"></a>          <span class="c">! na</span>
<a name="ln-10556"></a>
<a name="ln-10557"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10558"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>         <span class="c">! dry air mass flow rate through coil [kg/s]</span>
<a name="ln-10559"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>    <span class="c">! Ratio of max air mass flow to rated air mass flow</span>
<a name="ln-10560"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirWetBulbC</span>    <span class="c">! wetbulb temperature of inlet air [C]</span>
<a name="ln-10561"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDryBulbTemp</span> <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-10562"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>    <span class="c">! inlet air enthalpy [J/kg]</span>
<a name="ln-10563"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>      <span class="c">! inlet air humidity ratio [kg/kg]</span>
<a name="ln-10564"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10565"></a><span class="c">!REAL(r64) :: InletAirPressure    ! inlet air pressure [Pa]</span>
<a name="ln-10566"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDryBulbTemp</span>    <span class="c">! outlet air dry bulb temperature [C]</span>
<a name="ln-10567"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>   <span class="c">! outlet air enthalpy [J/kg]</span>
<a name="ln-10568"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>     <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-10569"></a><span class="c">! REAL(r64) :: OutletAirRH         ! outlet air relative humudity [fraction]</span>
<a name="ln-10570"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDryBulbTempSat</span> <span class="c">! outlet air dry bulb temp at saturation at the outlet enthalpy [C]</span>
<a name="ln-10571"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirDryBulbTemp</span> <span class="c">! low speed outlet air dry bulb temperature [C]</span>
<a name="ln-10572"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirEnthalpy</span>    <span class="c">! low speed outlet air enthalpy [J/kg]</span>
<a name="ln-10573"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirHumRat</span>      <span class="c">! low speed outlet air humidity ratio [kg/kg]</span>
<a name="ln-10574"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirRH</span>          <span class="c">! low speed outlet air relative humudity [fraction]</span>
<a name="ln-10575"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hDelta</span>              <span class="c">! Change in air enthalpy across the cooling coil [J/kg]</span>
<a name="ln-10576"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>            <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-10577"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>                <span class="c">! Apparatus dew point enthalpy [J/kg]</span>
<a name="ln-10578"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>                <span class="c">! Apparatus dew point temperature [C]</span>
<a name="ln-10579"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>                <span class="c">! Apparatus dew point humidity ratio [kg/kg]</span>
<a name="ln-10580"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>            <span class="c">! Enthalpy at inlet dry-bulb and wADP [J/kg]</span>
<a name="ln-10581"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBFHS</span>          <span class="c">! coil bypass factor at rated conditions (high speed)</span>
<a name="ln-10582"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFHS</span>               <span class="c">! coil bypass factor at max flow (high speed)</span>
<a name="ln-10583"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapHS</span>            <span class="c">! total capacity at high speed [W]</span>
<a name="ln-10584"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRHS</span>               <span class="c">! sensible heat ratio at high speed</span>
<a name="ln-10585"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapLS</span>            <span class="c">! total capacity at low speed [W]</span>
<a name="ln-10586"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRLS</span>               <span class="c">! sensible heat ratio at low speed</span>
<a name="ln-10587"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFacHS</span>     <span class="c">! EIR modifier (function of entering wetbulb, outside drybulb) (high speed)</span>
<a name="ln-10588"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFacHS</span>     <span class="c">! EIR modifier (function of actual supply air flow vs rated flow) (high speed)</span>
<a name="ln-10589"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRHS</span>               <span class="c">! EIR at off rated conditions (high speed)</span>
<a name="ln-10590"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFacLS</span>     <span class="c">! EIR modifier (function of entering wetbulb, outside drybulb) (low speed)</span>
<a name="ln-10591"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRLS</span>               <span class="c">! EIR at off rated conditions (low speed)</span>
<a name="ln-10592"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>              <span class="c">! total capacity at current speed [W]</span>
<a name="ln-10593"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>                 <span class="c">! sensible heat ratio at current speed</span>
<a name="ln-10594"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span>                 <span class="c">! EIR at current speed</span>
<a name="ln-10595"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowNom</span>      <span class="c">! speed ratio weighted average of high and low speed air mass flow rates [kg/s]</span>
<a name="ln-10596"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFNom</span>              <span class="c">! coil bypass factor corresponding to AirMassFlowNom and SpeedRatio</span>
<a name="ln-10597"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBF</span>                 <span class="c">! CBFNom adjusted for actual air mass flow rate</span>
<a name="ln-10598"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>                 <span class="c">! Part load factor, accounts for thermal lag at compressor startup, used in</span>
<a name="ln-10599"></a>                               <span class="c">! power calculation</span>
<a name="ln-10600"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>       <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-10601"></a>                               <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-10602"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>     <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-10603"></a>                               <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-10604"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoAir</span>              <span class="c">! Density of air [kg/m3]</span>
<a name="ln-10605"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoWater</span>            <span class="c">! Density of water [kg/m3]</span>
<a name="ln-10606"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>     <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-10607"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecPower</span> <span class="c">! Evaporative condenser electric pump power [W]</span>
<a name="ln-10608"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! minimum of the inlet air humidity ratio and the outlet air humidity ratio</span>
<a name="ln-10609"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">Mode</span><span class="o">=</span><span class="mi">1</span>  <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-10610"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>       <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-10611"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>       <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-10612"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>        <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-10613"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorPressure</span>      <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-10614"></a><span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">LocalForceOn</span>
<a name="ln-10615"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio2</span>     <span class="c">! Ratio of low speed air mass flow to rated air mass flow</span>
<a name="ln-10616"></a>
<a name="ln-10617"></a><span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ForceOn</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10618"></a><span class="k">  </span><span class="n">LocalForceOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10619"></a><span class="k">ELSE</span>
<a name="ln-10620"></a><span class="k">  </span><span class="n">LocalForceOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10621"></a><span class="n">ENDIF</span>
<a name="ln-10622"></a>
<a name="ln-10623"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10624"></a><span class="k">  </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-10625"></a>  <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-10626"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10627"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-10628"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-10629"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-10630"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-10631"></a>  <span class="k">ELSE</span>
<a name="ln-10632"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">Temp</span>
<a name="ln-10633"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">Mode</span><span class="p">))%</span><span class="n">HumRat</span>
<a name="ln-10634"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10635"></a>  <span class="k">END IF</span>
<a name="ln-10636"></a><span class="k">ELSE</span>
<a name="ln-10637"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-10638"></a>  <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-10639"></a>  <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-10640"></a>  <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-10641"></a><span class="n">ENDIF</span>
<a name="ln-10642"></a>
<a name="ln-10643"></a><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-10644"></a><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-10645"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10646"></a><span class="n">InletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-10647"></a><span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-10648"></a><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-10649"></a><span class="n">AirMassFlowRatio2</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! DXCoil(DXCoilNum)%RatedAirMassFlowRate2 / DXCoil(DXCoilNum)%RatedAirMassFlowRate(Mode)</span>
<a name="ln-10650"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10651"></a><span class="c">!InletAirPressure = DXCoil(DXCoilNum)%InletAirPressure</span>
<a name="ln-10652"></a><span class="c">!InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRat,InletAirPressure)</span>
<a name="ln-10653"></a><span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10654"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10655"></a><span class="k">  </span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">OutdoorDryBulb</span> <span class="c">! Outdoor dry-bulb temp</span>
<a name="ln-10656"></a><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10657"></a> <span class="c">! Outdoor wet-bulb temp from DataEnvironment + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-10658"></a>  <span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-10659"></a>  <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10660"></a><span class="k">END IF</span>
<a name="ln-10661"></a>
<a name="ln-10662"></a><span class="k">IF</span><span class="p">((</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10663"></a>   <span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">LocalForceOn</span><span class="p">))&amp;</span>
<a name="ln-10664"></a>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CycRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10665"></a>
<a name="ln-10666"></a><span class="k">  </span><span class="n">RhoAir</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">)</span>
<a name="ln-10667"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10668"></a>    <span class="c">! Adjust high speed coil bypass factor for actual maximum air flow rate.</span>
<a name="ln-10669"></a>    <span class="n">RatedCBFHS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-10670"></a>    <span class="n">CBFHS</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">RatedCBFHS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span><span class="p">)</span>
<a name="ln-10671"></a>    <span class="c">! get high speed total capacity and SHR at current conditions</span>
<a name="ln-10672"></a>    <span class="k">CALL </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">InletAirEnthalpy</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10673"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10674"></a>                       <span class="n">CBFHS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">TotCapHS</span><span class="p">,</span><span class="n">SHRHS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10675"></a>                       <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10676"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10677"></a><span class="c">!                       CondInletTemp, Node(DXCoil(DXCoilNum)%AirInNode)%Press)</span>
<a name="ln-10678"></a>    <span class="c">! get the high speed SHR from user specified SHR modifier curves</span>
<a name="ln-10679"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10680"></a><span class="k">        </span><span class="n">SHRHS</span> <span class="o">=</span> <span class="n">CalcSHRUserDefinedCurves</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10681"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10682"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR</span><span class="p">(</span><span class="n">Mode</span><span class="p">))</span>
<a name="ln-10683"></a>    <span class="n">ENDIF</span>
<a name="ln-10684"></a>    <span class="c">! get low speed total capacity and SHR at current conditions</span>
<a name="ln-10685"></a>    <span class="k">CALL </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">InletAirEnthalpy</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10686"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10687"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10688"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">TotCapLS</span><span class="p">,</span><span class="n">SHRLS</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10689"></a>                       <span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10690"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10691"></a><span class="c">!                       Node(DXCoil(DXCoilNum)%AirInNode)%Press)</span>
<a name="ln-10692"></a>    <span class="c">! get the low speed SHR from user specified SHR modifier curves</span>
<a name="ln-10693"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10694"></a><span class="k">        </span><span class="n">SHRLS</span> <span class="o">=</span> <span class="n">CalcSHRUserDefinedCurves</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatio2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10695"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10696"></a>                                    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span><span class="p">)</span>
<a name="ln-10697"></a>    <span class="n">ENDIF</span>
<a name="ln-10698"></a>    <span class="c">! get high speed EIR at current conditions</span>
<a name="ln-10699"></a>    <span class="n">EIRTempModFacHS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-10700"></a>    <span class="n">EIRFlowModFacHS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-10701"></a>    <span class="n">EIRHS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRFlowModFacHS</span> <span class="o">*</span> <span class="n">EIRTempModFacHS</span>
<a name="ln-10702"></a>    <span class="c">! get low speed EIR at current conditions</span>
<a name="ln-10703"></a><span class="c">!    EIRTempModFacLS = CurveValue(DXCoil(DXCoilNum)%EIRFTemp(Mode),InletAirWetbulbC,CondInletTemp)</span>
<a name="ln-10704"></a><span class="c">!    CR7307 changed EIRTempModFacLS calculation to that shown below.</span>
<a name="ln-10705"></a>    <span class="n">EIRTempModFacLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-10706"></a>    <span class="n">EIRLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR2</span> <span class="o">*</span> <span class="n">EIRTempModFacLS</span>
<a name="ln-10707"></a>
<a name="ln-10708"></a>    <span class="c">! get current total capacity, SHR, EIR</span>
<a name="ln-10709"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10710"></a><span class="k">      </span><span class="n">TotCap</span> <span class="o">=</span> <span class="n">TotCapHS</span>
<a name="ln-10711"></a>      <span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRHS</span>
<a name="ln-10712"></a>      <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRHS</span>
<a name="ln-10713"></a>      <span class="n">CBFNom</span> <span class="o">=</span> <span class="n">CBFHS</span>
<a name="ln-10714"></a>      <span class="n">AirMassFlowNom</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span>
<a name="ln-10715"></a>      <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-10716"></a>      <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-10717"></a>    <span class="k">ELSE</span>
<a name="ln-10718"></a><span class="k">      </span><span class="n">TotCap</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">TotCapHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">TotCapLS</span>
<a name="ln-10719"></a>      <span class="n">EIR</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">EIRHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">EIRLS</span>
<a name="ln-10720"></a>      <span class="n">CBFNom</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">CBFHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF2</span>
<a name="ln-10721"></a>      <span class="n">AirMassFlowNom</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10722"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate2</span>
<a name="ln-10723"></a>      <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10724"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span><span class="p">)</span>
<a name="ln-10725"></a>      <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10726"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span>
<a name="ln-10727"></a>    <span class="k">END IF</span>
<a name="ln-10728"></a><span class="k">    </span><span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">/</span> <span class="n">AirMassFlow</span>
<a name="ln-10729"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10730"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10731"></a><span class="k">            </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRHS</span>
<a name="ln-10732"></a>        <span class="k">ELSE</span>
<a name="ln-10733"></a><span class="k">            </span><span class="n">SHR</span> <span class="o">=</span>  <span class="nb">MIN</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="o">*</span><span class="n">SHRHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">SHRLS</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-10734"></a>        <span class="n">ENDIF</span>
<a name="ln-10735"></a>        <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-10736"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10737"></a><span class="k">           </span><span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-10738"></a>           <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-10739"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">OutletAirHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10740"></a><span class="k">               </span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DryCoilOutletHumRatioMin</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-10741"></a>           <span class="n">ENDIF</span>
<a name="ln-10742"></a>        <span class="k">ELSE</span>
<a name="ln-10743"></a><span class="k">           </span><span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10744"></a>           <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-10745"></a>        <span class="n">ENDIF</span>
<a name="ln-10746"></a>        <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:highspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10747"></a>        <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:highspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10748"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OutletAirDryBulbTempSat</span> <span class="o">&gt;</span> <span class="n">OutletAirDryBulbTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10749"></a><span class="k">           </span><span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-10750"></a>           <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:highspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10751"></a>        <span class="n">ENDIF</span>
<a name="ln-10752"></a>        <span class="c">!LSOutletAirRH = PsyRhFnTdbWPb(OutletAirDryBulbTemp,OutletAirHumRat,OutdoorPressure,&#39;CalcMultiSpeedDXCoil:highspeedoutlet&#39;)</span>
<a name="ln-10753"></a>    <span class="k">ELSE</span>
<a name="ln-10754"></a>      <span class="c">! Adjust CBF for off-nominal flow</span>
<a name="ln-10755"></a>        <span class="n">CBF</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">CBFNom</span><span class="p">,</span><span class="n">AirMassFlowNom</span><span class="p">,</span><span class="n">AirMassFlow</span><span class="p">)</span>
<a name="ln-10756"></a>      <span class="c">! Calculate new apparatus dew point conditions</span>
<a name="ln-10757"></a>        <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-10758"></a>        <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10759"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10760"></a>    <span class="c">!    tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-10761"></a>        <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">)</span>
<a name="ln-10762"></a>        <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">)</span>
<a name="ln-10763"></a>      <span class="c">! get corresponding SHR</span>
<a name="ln-10764"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10765"></a><span class="k">          </span><span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-10766"></a>        <span class="k">ELSE</span>
<a name="ln-10767"></a><span class="k">          </span><span class="n">SHR</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-10768"></a>        <span class="n">ENDIF</span>
<a name="ln-10769"></a>
<a name="ln-10770"></a>    <span class="c">!cr8918    SHR = MIN((hTinwADP-hADP)/(InletAirEnthalpy-hADP),1.d0)</span>
<a name="ln-10771"></a>        <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-10772"></a>      <span class="c">! get outlet conditions</span>
<a name="ln-10773"></a>        <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-10774"></a>        <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-10775"></a>
<a name="ln-10776"></a>        <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10777"></a>        <span class="c">! OutletAirRH = PsyRhFnTdbWPb(OutletAirDryBulbTemp,OutletAirHumRat,OutBaroPress)</span>
<a name="ln-10778"></a>        <span class="c">! IF (OutletAirRH &gt;= 1.) THEN  ! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-10779"></a>        <span class="c">!   OutletAirDryBulbTemp = PsyTsatFnHPb(OutletAirEnthalpy,OutBaroPress)</span>
<a name="ln-10780"></a>        <span class="c">!    OutletAirHumRat  = PsyWFnTdbH(OutletAirDryBulbTemp,OutletAirEnthalpy)</span>
<a name="ln-10781"></a>        <span class="c">!  END IF</span>
<a name="ln-10782"></a>        <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10783"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10784"></a>    <span class="c">!    OutletAirDryBulbTempSat = PsyTsatFnHPb(OutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-10785"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-10786"></a>          <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-10787"></a>          <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10788"></a>        <span class="k">END IF</span>
<a name="ln-10789"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-10790"></a>  <span class="c">! calculate cooling rate and electrical power</span>
<a name="ln-10791"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10792"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10793"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-10794"></a>                                                             <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">))</span>
<a name="ln-10795"></a>  <span class="c">! Don&#39;t let sensible capacity be greater than total capacity</span>
<a name="ln-10796"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10797"></a><span class="k">       </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-10798"></a>    <span class="k">END IF</span>
<a name="ln-10799"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-10800"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-10801"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-10802"></a><span class="c">!   Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-10803"></a>    <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-10804"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10805"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10806"></a>
<a name="ln-10807"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-10808"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-10809"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTemp</span>
<a name="ln-10810"></a>
<a name="ln-10811"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CycRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10812"></a>
<a name="ln-10813"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10814"></a>     <span class="c">! Outdoor wet-bulb temp from DataEnvironment + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-10815"></a>      <span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect2</span><span class="p">)</span>
<a name="ln-10816"></a>      <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10817"></a>    <span class="k">END IF</span>
<a name="ln-10818"></a>
<a name="ln-10819"></a>    <span class="c">! Adjust low speed coil bypass factor for actual flow rate.</span>
<a name="ln-10820"></a>    <span class="c">! CBF = AdjustCBF(DXCoil(DXCoilNum)%RatedCBF2,DXCoil(DXCoilNum)%RatedAirMassFlowRate2,AirMassFlow)</span>
<a name="ln-10821"></a>    <span class="c">! get low speed total capacity and SHR at current conditions</span>
<a name="ln-10822"></a>    <span class="k">CALL </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">InletAirEnthalpy</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10823"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10824"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10825"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">TotCapLS</span><span class="p">,</span><span class="n">SHRLS</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10826"></a>                       <span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-10827"></a>    <span class="c">! get the low speed SHR from user specified SHR modifier curves</span>
<a name="ln-10828"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10829"></a><span class="k">        </span><span class="n">SHRLS</span> <span class="o">=</span> <span class="n">CalcSHRUserDefinedCurves</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10830"></a>                                         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFTemp2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SHRFFlow2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10831"></a>                                         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedSHR2</span><span class="p">)</span>
<a name="ln-10832"></a>    <span class="n">ENDIF</span>
<a name="ln-10833"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10834"></a><span class="c">!                       Node(DXCoil(DXCoilNum)%AirInNode)%Press)</span>
<a name="ln-10835"></a>    <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCapLS</span> <span class="o">/</span> <span class="n">AirMassFlow</span>
<a name="ln-10836"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">UserSHRCurveExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10837"></a><span class="k">        </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRLS</span>
<a name="ln-10838"></a>        <span class="n">LSOutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-10839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10840"></a><span class="k">           </span><span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-10841"></a>           <span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-10842"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">LSOutletAirHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10843"></a><span class="k">               </span><span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DryCoilOutletHumRatioMin</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-10844"></a>           <span class="n">ENDIF</span>
<a name="ln-10845"></a>        <span class="k">ELSE</span>
<a name="ln-10846"></a><span class="k">           </span><span class="n">SHR</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-10847"></a>           <span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-10848"></a>        <span class="n">ENDIF</span>
<a name="ln-10849"></a>        <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10850"></a>        <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10851"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OutletAirDryBulbTempSat</span> <span class="o">&gt;</span> <span class="n">LSOutletAirDryBulbTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10852"></a><span class="k">            </span><span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-10853"></a>            <span class="n">LSOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10854"></a>        <span class="n">ENDIF</span>
<a name="ln-10855"></a>        <span class="n">LSOutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10856"></a>           <span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10857"></a>    <span class="k">ELSE</span>
<a name="ln-10858"></a>        <span class="c">! Adjust CBF for off-nominal flow</span>
<a name="ln-10859"></a>        <span class="n">CBF</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCBF2</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate2</span><span class="p">,</span><span class="n">AirMassFlow</span><span class="p">)</span>
<a name="ln-10860"></a>        <span class="c">! Calculate new apparatus dew point conditions</span>
<a name="ln-10861"></a>        <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-10862"></a>        <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:newdewpointconditions&#39;</span><span class="p">)</span>
<a name="ln-10863"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10864"></a>    <span class="c">!    tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-10865"></a>        <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:newdewpointconditions&#39;</span><span class="p">)</span>
<a name="ln-10866"></a>        <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:newdewpointconditions&#39;</span><span class="p">)</span>
<a name="ln-10867"></a>        <span class="c">! get corresponding SHR</span>
<a name="ln-10868"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10869"></a><span class="k">            </span><span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-10870"></a>        <span class="k">ELSE</span>
<a name="ln-10871"></a><span class="k">            </span><span class="n">SHR</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-10872"></a>        <span class="n">ENDIF</span>
<a name="ln-10873"></a>    <span class="c">!cr8918    SHR = MIN((hTinwADP-hADP)/(InletAirEnthalpy-hADP),1.d0)</span>
<a name="ln-10874"></a>        <span class="c">! get low speed outlet conditions</span>
<a name="ln-10875"></a>        <span class="n">LSOutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-10876"></a>        <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-10877"></a>        <span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">)</span>
<a name="ln-10878"></a>        <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10879"></a>        <span class="n">LSOutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10880"></a>           <span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10881"></a>        <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10882"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-10883"></a>    <span class="c">!    LSOutletAirRH = PsyRhFnTdbWPb(LSOutletAirDryBulbTemp,LSOutletAirHumRat,InletAirPressure)</span>
<a name="ln-10884"></a>    <span class="c">!    OutletAirDryBulbTempSat = PsyTsatFnHPb(LSOutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-10885"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-10886"></a>          <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-10887"></a>          <span class="n">LSOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoil:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-10888"></a>        <span class="k">END IF</span>
<a name="ln-10889"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-10890"></a>    <span class="c">! outlet conditions are average of inlet and low speed weighted by CycRatio</span>
<a name="ln-10891"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">CycRatio</span><span class="o">*</span><span class="n">LSOutletAirEnthalpy</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CycRatio</span><span class="p">)</span><span class="o">*</span><span class="n">InletAirEnthalpy</span>
<a name="ln-10892"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">CycRatio</span><span class="o">*</span><span class="n">LSOutletAirHumRat</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CycRatio</span><span class="p">)</span><span class="o">*</span><span class="n">InletAirHumRat</span>
<a name="ln-10893"></a>    <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10894"></a>    <span class="c">! get low speed EIR at current conditions</span>
<a name="ln-10895"></a><span class="c">!    EIRTempModFacLS = CurveValue(DXCoil(DXCoilNum)%EIRFTemp(Mode),InletAirWetbulbC,CondInletTemp)</span>
<a name="ln-10896"></a><span class="c">!    CR7307 changed EIRTempModFacLS calculation to that shown below.</span>
<a name="ln-10897"></a>    <span class="n">EIRTempModFacLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-10898"></a>    <span class="n">EIRLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedEIR2</span> <span class="o">*</span> <span class="n">EIRTempModFacLS</span>
<a name="ln-10899"></a>    <span class="c">! get the part load factor that will account for cycling losses</span>
<a name="ln-10900"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="n">Mode</span><span class="p">),</span><span class="n">CycRatio</span><span class="p">)</span>
<a name="ln-10901"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10902"></a><span class="k">     </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-10903"></a>    <span class="k">END IF</span>
<a name="ln-10904"></a>    <span class="c">! calculate the run time fraction</span>
<a name="ln-10905"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="n">CycRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-10906"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>    <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-10907"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10908"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-10909"></a>    <span class="k">END IF</span>
<a name="ln-10910"></a>    <span class="c">! get the eletrical power consumption</span>
<a name="ln-10911"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCapLS</span> <span class="o">*</span> <span class="n">EIRLS</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-10912"></a>    <span class="c">! calculate cooling output power</span>
<a name="ln-10913"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-10914"></a><span class="c">!   Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-10915"></a>    <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-10916"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-10917"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-10918"></a>                                                             <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">))</span>
<a name="ln-10919"></a>  <span class="c">! Don&#39;t let sensible capacity be greater than total capacity</span>
<a name="ln-10920"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10921"></a><span class="k">       </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-10922"></a>    <span class="k">END IF</span>
<a name="ln-10923"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-10924"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-10925"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-10926"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-10927"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTemp</span>
<a name="ln-10928"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondAirFlow2</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-10929"></a>    <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower2</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-10930"></a>
<a name="ln-10931"></a>  <span class="k">END IF</span>
<a name="ln-10932"></a>
<a name="ln-10933"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10934"></a>  <span class="c">!******************</span>
<a name="ln-10935"></a>  <span class="c">!             WATER CONSUMPTION IN m3 OF WATER FOR DIRECT</span>
<a name="ln-10936"></a>  <span class="c">!             H2O [m3/sec] = Delta W[KgH2O/Kg air]*Mass Flow Air[Kg air]</span>
<a name="ln-10937"></a>  <span class="c">!                                /RhoWater [kg H2O/m3 H2O]</span>
<a name="ln-10938"></a>  <span class="c">!******************</span>
<a name="ln-10939"></a>     <span class="n">RhoWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-10940"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span>  <span class="p">(</span><span class="n">CondInletHumrat</span> <span class="o">-</span> <span class="n">OutdoorHumRat</span><span class="p">)</span> <span class="o">*</span>  <span class="n">CondAirMassFlow</span><span class="o">/</span><span class="n">RhoWater</span>
<a name="ln-10941"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">EvapCondPumpElecPower</span>
<a name="ln-10942"></a>     <span class="c">!set water system demand request (if needed)</span>
<a name="ln-10943"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10944"></a>
<a name="ln-10945"></a><span class="k">       </span><span class="n">WaterStorage</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10946"></a>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-10947"></a>     <span class="n">ENDIF</span>
<a name="ln-10948"></a>
<a name="ln-10949"></a>     <span class="c">! Calculate basin heater power</span>
<a name="ln-10950"></a>     <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-10951"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-10952"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-10953"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10954"></a>                                          <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-10955"></a>  <span class="n">ENDIF</span>
<a name="ln-10956"></a>
<a name="ln-10957"></a><span class="k">ELSE</span>
<a name="ln-10958"></a>
<a name="ln-10959"></a>  <span class="c">! DX coil is off; just pass through conditions</span>
<a name="ln-10960"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-10961"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-10962"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-10963"></a>
<a name="ln-10964"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10965"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10966"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10967"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10968"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10969"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10970"></a>
<a name="ln-10971"></a>  <span class="c">! Calculate basin heater power</span>
<a name="ln-10972"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10973"></a><span class="k">    CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-10974"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-10975"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-10976"></a>  <span class="n">ENDIF</span>
<a name="ln-10977"></a><span class="k">END IF</span>
<a name="ln-10978"></a>
<a name="ln-10979"></a><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-10980"></a><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-10981"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">CondInletTemp</span> <span class="c">! Save condenser inlet temp in the data structure</span>
<a name="ln-10982"></a>
<a name="ln-10983"></a><span class="k">RETURN</span>
<a name="ln-10984"></a>
<a name="ln-10985"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMultiSpeedDXCoil</span>
<a name="ln-10986"></a>
<a name="ln-10987"></a><span class="k">SUBROUTINE </span><span class="n">CalcBasinHeaterPowerForMultiModeDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">DehumidMode</span><span class="p">)</span>
<a name="ln-10988"></a>
<a name="ln-10989"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10990"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-10991"></a>          <span class="c">!       DATE WRITTEN   May 2010</span>
<a name="ln-10992"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10993"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10994"></a>
<a name="ln-10995"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10996"></a>          <span class="c">! To calculate the basin heater power for multi mode DX cooling coil</span>
<a name="ln-10997"></a>
<a name="ln-10998"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10999"></a>          <span class="c">! The methodology employed is as follows:</span>
<a name="ln-11000"></a>          <span class="c">! 1) If the number of capacity stages is equal to 1 and the CondenserType for stage 1</span>
<a name="ln-11001"></a>          <span class="c">!    is EvapCooled, then the basin heater power is calculated for (1-runtimefractionstage1) of DX coil</span>
<a name="ln-11002"></a>          <span class="c">! 2) If the number of capacity stages is greater than 1, then</span>
<a name="ln-11003"></a>          <span class="c">!    a) If the CondenserType for stage 1 is EvapCooled, then the basin heater power is calculated for</span>
<a name="ln-11004"></a>          <span class="c">!       (1-runtimefractionofstage1) of DX coil</span>
<a name="ln-11005"></a>          <span class="c">!    b) Elseif the CondenserType for stage 2 is EvapCooled, then the basin heater power is calculated for</span>
<a name="ln-11006"></a>          <span class="c">!       (1-runtimefractionofstage2) of DX coil</span>
<a name="ln-11007"></a>
<a name="ln-11008"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11009"></a>          <span class="c">! na</span>
<a name="ln-11010"></a>
<a name="ln-11011"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11012"></a>          <span class="c">! na</span>
<a name="ln-11013"></a>
<a name="ln-11014"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11015"></a>
<a name="ln-11016"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11017"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DehumidMode</span>         <span class="c">! Dehumidification mode (0=normal, 1=enhanced)</span>
<a name="ln-11018"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DXCoilNum</span>           <span class="c">! Index of coil being simulated</span>
<a name="ln-11019"></a>
<a name="ln-11020"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11021"></a>          <span class="c">! na</span>
<a name="ln-11022"></a>
<a name="ln-11023"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11024"></a>          <span class="c">! na</span>
<a name="ln-11025"></a>
<a name="ln-11026"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11027"></a>          <span class="c">! na</span>
<a name="ln-11028"></a>
<a name="ln-11029"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11030"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PerfMode</span>                  <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-11031"></a>                                       <span class="c">! 1-2=normal mode: 1=stage 1 only, 2=stage 1&amp;2</span>
<a name="ln-11032"></a>                                       <span class="c">! 3-4=enhanced dehumidification mode: 3=stage 1 only, 4=stage 1&amp;2</span>
<a name="ln-11033"></a>
<a name="ln-11034"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumCapacityStages</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11035"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-11036"></a>                                         <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-11037"></a>  <span class="k">ELSE</span>
<a name="ln-11038"></a><span class="k">    </span><span class="n">PerfMode</span> <span class="o">=</span> <span class="n">DehumidMode</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-11039"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">PerfMode</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11040"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-11041"></a>                                         <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-11042"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">PerfMode</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11043"></a><span class="k">      CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-11044"></a>                          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-11045"></a>                          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,&amp;</span>
<a name="ln-11046"></a>                          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-11047"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-11048"></a>                                       <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilStg2RuntimeFrac</span><span class="p">)</span>
<a name="ln-11049"></a>    <span class="n">ENDIF</span>
<a name="ln-11050"></a>  <span class="n">ENDIF</span>
<a name="ln-11051"></a>
<a name="ln-11052"></a><span class="k">RETURN</span>
<a name="ln-11053"></a>
<a name="ln-11054"></a><span class="k">END SUBROUTINE </span><span class="n">CalcBasinHeaterPowerForMultiModeDXCoil</span>
<a name="ln-11055"></a>
<a name="ln-11056"></a><span class="k">FUNCTION </span><span class="n">AdjustCBF</span><span class="p">(</span><span class="n">CBFNom</span><span class="p">,</span><span class="n">AirMassFlowRateNom</span><span class="p">,</span><span class="n">AirMassFlowRate</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CBFAdj</span><span class="p">)</span>
<a name="ln-11057"></a>
<a name="ln-11058"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-11059"></a>          <span class="c">!       AUTHOR         Fred Buhl using Don Shirey&#39;s code</span>
<a name="ln-11060"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-11061"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11062"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11063"></a>
<a name="ln-11064"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-11065"></a>          <span class="c">!    Adjust coil bypass factor for actual air flow rate.</span>
<a name="ln-11066"></a>
<a name="ln-11067"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11068"></a>          <span class="c">! Uses relation CBF = exp(-NTU) whereNTU = A0/(m*cp). Relationship models the cooling coil</span>
<a name="ln-11069"></a>          <span class="c">! as a heat exchanger with Cmin/Cmax = 0.</span>
<a name="ln-11070"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11071"></a>          <span class="c">! na</span>
<a name="ln-11072"></a>
<a name="ln-11073"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11074"></a>          <span class="c">! na</span>
<a name="ln-11075"></a>
<a name="ln-11076"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11077"></a>
<a name="ln-11078"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-11079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFNom</span>                <span class="c">! nominal coil bypass factor</span>
<a name="ln-11080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRateNom</span>    <span class="c">! nominal air mass flow rate [kg/s]</span>
<a name="ln-11081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>       <span class="c">! actual air mass flow rate [kg/s]</span>
<a name="ln-11082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CBFAdj</span>                <span class="c">! the result - the adjusted coil bypass factor</span>
<a name="ln-11083"></a>
<a name="ln-11084"></a>
<a name="ln-11085"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-11086"></a>          <span class="c">! na</span>
<a name="ln-11087"></a>
<a name="ln-11088"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11089"></a>          <span class="c">! na</span>
<a name="ln-11090"></a>
<a name="ln-11091"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11092"></a>          <span class="c">! na</span>
<a name="ln-11093"></a>
<a name="ln-11094"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11095"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A0</span>  <span class="c">! intermediate variable</span>
<a name="ln-11096"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADiff</span>  <span class="c">! intermediate variable</span>
<a name="ln-11097"></a>
<a name="ln-11098"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CBFNom</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11099"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="o">-</span><span class="nb">log</span><span class="p">(</span><span class="n">CBFNom</span><span class="p">)</span><span class="o">*</span><span class="n">AirMassFlowRateNom</span>
<a name="ln-11100"></a>  <span class="k">ELSE</span>
<a name="ln-11101"></a><span class="k">     </span><span class="n">A0</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11102"></a>  <span class="k">END IF</span>
<a name="ln-11103"></a><span class="k">  </span><span class="n">ADiff</span><span class="o">=-</span><span class="n">A0</span><span class="o">/</span><span class="n">AirMassFlowRate</span>
<a name="ln-11104"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ADiff</span> <span class="o">&gt;=</span> <span class="n">EXP_LowerLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11105"></a><span class="k">     </span><span class="n">CBFAdj</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">ADiff</span><span class="p">)</span>
<a name="ln-11106"></a>  <span class="k">ELSE</span>
<a name="ln-11107"></a><span class="k">     </span><span class="n">CBFAdj</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11108"></a>  <span class="k">END IF</span>
<a name="ln-11109"></a>
<a name="ln-11110"></a><span class="k">  RETURN</span>
<a name="ln-11111"></a><span class="k">END FUNCTION </span><span class="n">AdjustCBF</span>
<a name="ln-11112"></a>
<a name="ln-11113"></a><span class="k">FUNCTION </span><span class="n">CalcCBF</span><span class="p">(</span><span class="n">UnitType</span><span class="p">,</span><span class="n">UnitName</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">TotCap</span><span class="p">,</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="n">SHR</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-11114"></a>
<a name="ln-11115"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-11116"></a>          <span class="c">!       AUTHOR         Fred Buhl using Don Shirey&#39;s code</span>
<a name="ln-11117"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-11118"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11119"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11120"></a>
<a name="ln-11121"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-11122"></a>          <span class="c">! Calculate the coil bypass factor for a coil given the total capacity at the entering conditions,</span>
<a name="ln-11123"></a>          <span class="c">! air mass flow rate at the entering conditions, and the sensible heat ratio (SHR) at the</span>
<a name="ln-11124"></a>          <span class="c">! entering conditions.</span>
<a name="ln-11125"></a>
<a name="ln-11126"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11127"></a>          <span class="c">! calculate SlopeRated (deltahumrat/deltaT) using rated unit information provided by</span>
<a name="ln-11128"></a>          <span class="c">! user. Then hunt along saturation curve of psychrometric chart until the slope of the line</span>
<a name="ln-11129"></a>          <span class="c">! between the saturation point and rated inlet air humidity ratio and T is the same as SlopeRated.</span>
<a name="ln-11130"></a>          <span class="c">! When the slopes are equal, then we have located the apparatus dewpoint of the coil at rated</span>
<a name="ln-11131"></a>          <span class="c">! conditions. From this information, coil bypass factor is calculated.</span>
<a name="ln-11132"></a>
<a name="ln-11133"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11134"></a>          <span class="c">! na</span>
<a name="ln-11135"></a>
<a name="ln-11136"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11137"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-11138"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdRhoAir</span>
<a name="ln-11139"></a>
<a name="ln-11140"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11141"></a>
<a name="ln-11142"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-11143"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitType</span>
<a name="ln-11144"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitName</span>
<a name="ln-11145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirTemp</span>          <span class="c">! inlet air temperature [C]</span>
<a name="ln-11146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>        <span class="c">! inlet air humidity ratio [kg water / kg dry air]</span>
<a name="ln-11147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>                <span class="c">! total cooling  capacity [Watts]</span>
<a name="ln-11148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>       <span class="c">! the air mass flow rate at the given capacity [kg/s]</span>
<a name="ln-11149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>                   <span class="c">! sensible heat ratio at the given capacity and flow rate</span>
<a name="ln-11150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CBF</span>                   <span class="c">! the result - the coil bypass factor</span>
<a name="ln-11151"></a>
<a name="ln-11152"></a>
<a name="ln-11153"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-11154"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcCBF&#39;</span>
<a name="ln-11155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SmallDifferenceTest</span><span class="o">=</span><span class="mf">0.00000001d0</span>
<a name="ln-11156"></a>
<a name="ln-11157"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11158"></a>          <span class="c">! na</span>
<a name="ln-11159"></a>
<a name="ln-11160"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11161"></a>          <span class="c">! na</span>
<a name="ln-11162"></a>
<a name="ln-11163"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>  <span class="c">! Enthalpy of inlet air to evaporator at given conditions [J/kg]</span>
<a name="ln-11165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaH</span>            <span class="c">! Enthalpy drop across evaporator at given conditions [J/kg]</span>
<a name="ln-11166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaT</span>            <span class="c">! Temperature drop across evaporator at given conditions [C]</span>
<a name="ln-11167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaHumRat</span>       <span class="c">! Humidity ratio drop across evaporator at given conditions [kg/kg]</span>
<a name="ln-11168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>     <span class="c">! Outlet dry-bulb temperature from evaporator at given conditions [C]</span>
<a name="ln-11169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span> <span class="c">! Enthalpy of outlet air at given conditions [J/kg]</span>
<a name="ln-11170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>   <span class="c">! Outlet humidity ratio from evaporator at given conditions [kg/kg]</span>
<a name="ln-11171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirRH</span>       <span class="c">! relative humidity of the outlet air</span>
<a name="ln-11172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Error</span>                <span class="c">! Error term used in given coil bypass factor (CBF) calculations</span>
<a name="ln-11173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorLast</span>            <span class="c">! Error term, from previous iteration</span>
<a name="ln-11174"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Iter</span>                 <span class="c">! Iteration loop counter in CBF calculations</span>
<a name="ln-11175"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IterMax</span>              <span class="c">! Maximum number of iterations in CBF calculations</span>
<a name="ln-11176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADPTemp</span>              <span class="c">! Apparatus dewpoint temperature used in CBF calculations [C]</span>
<a name="ln-11177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADPHumRat</span>            <span class="c">! Apparatus dewpoint humidity used in CBF calculations [kg/kg]</span>
<a name="ln-11178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADPEnthalpy</span>          <span class="c">! Air enthalpy at apparatus dew point [J/kg]</span>
<a name="ln-11179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaADPTemp</span>         <span class="c">! Change in Apparatus Dew Point used in CBF calculations [C]</span>
<a name="ln-11180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SlopeAtConds</span>          <span class="c">! Slope (DeltaHumRat/DeltaT) at given conditions</span>
<a name="ln-11181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Slope</span>                <span class="c">! Calculated Slope used while hunting for Tadp</span>
<a name="ln-11182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tolerance</span>            <span class="c">! Convergence tolerance for CBF calculations</span>
<a name="ln-11183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTinHumRatOut</span>        <span class="c">! Air enthalpy at inlet air temp and outlet air humidity ratio [J/kg]</span>
<a name="ln-11184"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>    <span class="c">! Set to true if errors in CBF calculation, fatal at end of routine</span>
<a name="ln-11185"></a>
<a name="ln-11186"></a>  <span class="n">DeltaH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11187"></a>  <span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11188"></a>  <span class="n">DeltaHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11189"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span>  <span class="n">InletAirTemp</span>
<a name="ln-11190"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-11191"></a>  <span class="n">SlopeAtConds</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11192"></a>  <span class="n">Slope</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11193"></a>  <span class="n">IterMax</span> <span class="o">=</span> <span class="mi">50</span>
<a name="ln-11194"></a>  <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11195"></a>
<a name="ln-11196"></a>  <span class="n">DeltaH</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlowRate</span>
<a name="ln-11197"></a>  <span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-11198"></a>  <span class="n">HTinHumRatOut</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">DeltaH</span>
<a name="ln-11199"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">HTinHumRatOut</span><span class="p">)</span>
<a name="ln-11200"></a>  <span class="n">DeltaHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-11201"></a>  <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">DeltaH</span>
<a name="ln-11202"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-11203"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11204"></a><span class="c">!  Pressure will have to be pass into this subroutine to fix this one</span>
<a name="ln-11205"></a>  <span class="n">OutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="s1">&#39;CalcCBF&#39;</span><span class="p">)</span>
<a name="ln-11206"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutletAirRH</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11207"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;For object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;, name = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11208"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;Calculated outlet air relative humidity greater than 1. The combination of&#39;</span><span class="p">)</span>
<a name="ln-11209"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;rated air volume flow rate, total cooling capacity and sensible heat ratio yields coil exiting&#39;</span><span class="p">)</span>
<a name="ln-11210"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;air conditions above the saturation curve. Possible fixes are to reduce the rated total cooling&#39;</span><span class="p">)</span>
<a name="ln-11211"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;capacity, increase the rated air volume flow rate, or reduce the rated sensible heat&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11212"></a>                             <span class="s1">&#39; ratio for this coil.&#39;</span><span class="p">)</span>
<a name="ln-11213"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;If autosizing, it is recommended that all three of these values be autosized.&#39;</span><span class="p">)</span>
<a name="ln-11214"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inputs used for calculating cooling coil bypass factor.&#39;</span><span class="p">)</span>
<a name="ln-11215"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11216"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11217"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-11218"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-11219"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Total Cooling Capacity used in calculation = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-11220"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate used in calculation     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-11221"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate used in calculation   = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11222"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-11223"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">TotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11224"></a><span class="k">       IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11225"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11226"></a>           <span class="p">((</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span> <span class="p">&amp;</span>
<a name="ln-11227"></a>             <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11228"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate per Watt of Rated Cooling Capacity is also out of bounds at = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11229"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11230"></a>                                <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W&#39;</span><span class="p">)</span>
<a name="ln-11231"></a>       <span class="k">END IF</span>
<a name="ln-11232"></a><span class="k">     END IF</span>
<a name="ln-11233"></a><span class="k">     CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11234"></a>     <span class="k">CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;Check and revise the input data for this coil before rerunning the simulation.&#39;</span><span class="p">)</span>
<a name="ln-11235"></a>  <span class="k">END IF</span>
<a name="ln-11236"></a><span class="k">  </span><span class="n">DeltaT</span> <span class="o">=</span> <span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-11237"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaT</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11238"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span> <span class="p">(</span><span class="s1">&#39;For object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;, name = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11239"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;Calculated coil delta T is less than or equal to 0. The combination of&#39;</span><span class="p">)</span>
<a name="ln-11240"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;rated air volume flow rate, total cooling capacity and sensible heat ratio yields coil exiting&#39;</span><span class="p">)</span>
<a name="ln-11241"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;air conditions that are not reasonable. Possible fixes are to adjust the rated total cooling&#39;</span><span class="p">)</span>
<a name="ln-11242"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;capacity, rated air volume flow rate, or rated sensible heat&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11243"></a>                             <span class="s1">&#39; ratio for this coil.&#39;</span><span class="p">)</span>
<a name="ln-11244"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;If autosizing, it is recommended that all three of these values be autosized.&#39;</span><span class="p">)</span>
<a name="ln-11245"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inputs used for calculating cooling coil bypass factor.&#39;</span><span class="p">)</span>
<a name="ln-11246"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11247"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11248"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-11249"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-11250"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Total Cooling Capacity used in calculation = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-11251"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate used in calculation     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-11252"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate used in calculation   = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11253"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-11254"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">TotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11255"></a><span class="k">       IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11256"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11257"></a>           <span class="p">((</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span> <span class="p">&amp;</span>
<a name="ln-11258"></a>             <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11259"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate per Watt of Rated Cooling Capacity is also out of bounds at = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11260"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11261"></a>                                <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W&#39;</span><span class="p">)</span>
<a name="ln-11262"></a>       <span class="k">END IF</span>
<a name="ln-11263"></a><span class="k">     END IF</span>
<a name="ln-11264"></a><span class="k">     CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11265"></a>     <span class="k">CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;Check and revise the input data for this coil before rerunning the simulation.&#39;</span><span class="p">)</span>
<a name="ln-11266"></a>  <span class="k">END IF</span>
<a name="ln-11267"></a>  <span class="c">! Calculate slope at given conditions</span>
<a name="ln-11268"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaT</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SlopeAtConds</span> <span class="o">=</span> <span class="n">DeltaHumRat</span><span class="o">/</span><span class="n">DeltaT</span>
<a name="ln-11269"></a>
<a name="ln-11270"></a><span class="c">!  IF (SlopeAtConds .le. .0000001d0 .or. OutletAirHumRat .le. 0.) THEN</span>
<a name="ln-11271"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SlopeAtConds</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">OutletAirHumRat</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11272"></a><span class="c">!   Invalid conditions, slope can&#39;t be less than zero (SHR &gt; 1) or</span>
<a name="ln-11273"></a><span class="c">!   outlet air humidity ratio can&#39;t be less than zero.</span>
<a name="ln-11274"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11275"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Invalid slope or outlet air condition when calculating cooling coil bypass factor.&#39;</span><span class="p">)</span>
<a name="ln-11276"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Slope = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SlopeAtConds</span><span class="p">,</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-11277"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11278"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11279"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Air Humidity Ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-11280"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Air Humidity Ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-11281"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Total Cooling Capacity used in calculation = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-11282"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Mass Flow Rate used in calculation     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-11283"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate used in calculation   = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11284"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">),</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-11285"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">TotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11286"></a><span class="k">       IF</span> <span class="p">(((</span><span class="n">MinRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)</span> <span class="o">-</span> <span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11287"></a>            <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11288"></a>           <span class="p">((</span><span class="n">AirMassFlowRate</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span> <span class="p">&amp;</span>
<a name="ln-11289"></a>             <span class="o">-</span> <span class="n">MaxRatedVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">SmallDifferenceTest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11290"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Air Volume Flow Rate per Watt of Rated Cooling Capacity is also out of bounds at = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11291"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirMassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11292"></a>                                <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">/</span><span class="n">TotCap</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s/W&#39;</span><span class="p">)</span>
<a name="ln-11293"></a>       <span class="k">END IF</span>
<a name="ln-11294"></a><span class="k">    END IF</span>
<a name="ln-11295"></a><span class="k">    CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11296"></a>    <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11297"></a>  <span class="k">ELSE</span>
<a name="ln-11298"></a>
<a name="ln-11299"></a><span class="c">!   First guess for Tadp is outlet air dew point</span>
<a name="ln-11300"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11301"></a><span class="c">!  Pressure will have to be pass into this subroutine to fix this one</span>
<a name="ln-11302"></a>    <span class="n">ADPTemp</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-11303"></a>
<a name="ln-11304"></a>    <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.0d0</span>         <span class="c">! initial conditions for iteration</span>
<a name="ln-11305"></a>    <span class="n">ErrorLast</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-11306"></a>    <span class="n">Iter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-11307"></a>    <span class="n">DeltaADPTemp</span> <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-11308"></a>    <span class="k">DO WHILE</span> <span class="p">((</span><span class="n">Iter</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="n">IterMax</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">Tolerance</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">))</span>
<a name="ln-11309"></a><span class="c">!     Do for IterMax iterations or until the error gets below .1%</span>
<a name="ln-11310"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Iter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">ADPTemp</span> <span class="o">=</span> <span class="n">ADPTemp</span> <span class="o">+</span> <span class="n">DeltaADPTemp</span>
<a name="ln-11311"></a>      <span class="n">Iter</span> <span class="o">=</span> <span class="n">Iter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-11312"></a>
<a name="ln-11313"></a><span class="c">!     Find new slope using guessed Tadp</span>
<a name="ln-11314"></a>
<a name="ln-11315"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11316"></a><span class="c">!  Pressure will have to be pass into this subroutine to fix this one</span>
<a name="ln-11317"></a>      <span class="n">ADPHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">ADPTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-11318"></a>      <span class="n">Slope</span>     <span class="o">=</span> <span class="p">(</span><span class="n">InletAirHumRat</span><span class="o">-</span><span class="n">ADPHumRat</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="o">-</span><span class="n">ADPTemp</span><span class="p">)</span>
<a name="ln-11319"></a>
<a name="ln-11320"></a><span class="c">!     check for convergence (slopes are equal to within error tolerance)</span>
<a name="ln-11321"></a>
<a name="ln-11322"></a>      <span class="n">Error</span>     <span class="o">=</span> <span class="p">(</span><span class="n">Slope</span><span class="o">-</span><span class="n">SlopeAtConds</span><span class="p">)</span><span class="o">/</span><span class="n">SlopeAtConds</span>
<a name="ln-11323"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Error</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">ErrorLast</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="n">DeltaADPTemp</span> <span class="o">=</span> <span class="o">-</span><span class="n">DeltaADPTemp</span><span class="o">/</span><span class="mf">2.d0</span>
<a name="ln-11324"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Error</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">ErrorLast</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="n">DeltaADPTemp</span> <span class="o">=</span> <span class="o">-</span><span class="n">DeltaADPTemp</span><span class="o">/</span><span class="mf">2.d0</span>
<a name="ln-11325"></a>      <span class="n">ErrorLast</span> <span class="o">=</span> <span class="n">Error</span>
<a name="ln-11326"></a>
<a name="ln-11327"></a>      <span class="n">Tolerance</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Error</span><span class="p">)</span>
<a name="ln-11328"></a>
<a name="ln-11329"></a>    <span class="k">END DO</span>
<a name="ln-11330"></a>
<a name="ln-11331"></a><span class="c">!   Calculate Bypass Factor from Enthalpies</span>
<a name="ln-11332"></a>
<a name="ln-11333"></a>    <span class="n">InletAirEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">)</span>
<a name="ln-11334"></a>    <span class="n">OutletAirEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-11335"></a>    <span class="n">ADPEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ADPTemp</span><span class="p">,</span><span class="n">ADPHumRat</span><span class="p">)</span>
<a name="ln-11336"></a>    <span class="n">CBF</span> <span class="o">=</span> <span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="o">-</span><span class="n">ADPEnthalpy</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">ADPEnthalpy</span><span class="p">)</span>
<a name="ln-11337"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Iter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">IterMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11338"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11339"></a>                          <span class="s1">&#39;&quot; -- coil bypass factor calculation did not converge after max iterations.&#39;</span><span class="p">)</span>
<a name="ln-11340"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The RatedSHR of [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11341"></a>         <span class="s1">&#39;], entered by the user or autosized (see *.eio file),&#39;</span><span class="p">)</span>
<a name="ln-11342"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;may be causing this. The line defined by the coil rated inlet air conditions&#39;</span><span class="p">)</span>
<a name="ln-11343"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;(26.7C drybulb and 19.4C wetbulb) and the RatedSHR (i.e., slope of the line) must intersect&#39;</span><span class="p">)</span>
<a name="ln-11344"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the saturation curve of the psychrometric chart. If the RatedSHR is too low, then this&#39;</span><span class="p">)</span>
<a name="ln-11345"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;intersection may not occur and the coil bypass factor calculation will not converge.&#39;</span><span class="p">)</span>
<a name="ln-11346"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;If autosizing the SHR, recheck the design supply air humidity ratio and design supply air&#39;</span><span class="p">)</span>
<a name="ln-11347"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;temperature values in the Sizing:System and Sizing:Zone objects. In general, the temperatures&#39;</span><span class="p">)</span>
<a name="ln-11348"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;and humidity ratios specified in these two objects should be the same for each system&#39;</span><span class="p">)</span>
<a name="ln-11349"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;and the zones that it serves.&#39;</span><span class="p">)</span>
<a name="ln-11350"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11351"></a>      <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! Didn&#39;t converge within MaxIter iterations</span>
<a name="ln-11352"></a>    <span class="n">ENDIF</span>
<a name="ln-11353"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CBF</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11354"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; -- negative coil bypass factor calculated.&#39;</span><span class="p">)</span>
<a name="ln-11355"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11356"></a>      <span class="n">CBFErrors</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! Negative CBF not valid</span>
<a name="ln-11357"></a>    <span class="n">ENDIF</span>
<a name="ln-11358"></a>  <span class="k">END IF</span>
<a name="ln-11359"></a>
<a name="ln-11360"></a><span class="c">! Show fatal error for specific coil that caused a CBF error</span>
<a name="ln-11361"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CBFErrors</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11362"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitName</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11363"></a>                        <span class="s1">&#39;&quot; Errors found in calculating coil bypass factors&#39;</span><span class="p">)</span>
<a name="ln-11364"></a>  <span class="k">END IF</span>
<a name="ln-11365"></a>
<a name="ln-11366"></a><span class="k">  RETURN</span>
<a name="ln-11367"></a><span class="k">END FUNCTION </span><span class="n">CalcCBF</span>
<a name="ln-11368"></a>
<a name="ln-11369"></a><span class="k">FUNCTION </span><span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHRss</span><span class="p">,</span> <span class="n">RTF</span><span class="p">,</span> <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">EnteringDB</span><span class="p">,</span> <span class="n">EnteringWB</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">HeatingRTF</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SHReff</span><span class="p">)</span>
<a name="ln-11370"></a>
<a name="ln-11371"></a>        <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-11372"></a>        <span class="c">!    AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-11373"></a>        <span class="c">!    DATE WRITTEN   September 2003</span>
<a name="ln-11374"></a>        <span class="c">!                   Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-11375"></a>        <span class="c">!                    Add new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-11376"></a>        <span class="c">!                   Nov 2008 R. Raustad, FSEC</span>
<a name="ln-11377"></a>        <span class="c">!                    Modified to allow latent degradation with cycling fan</span>
<a name="ln-11378"></a>        <span class="c">!    RE-ENGINEERED  na</span>
<a name="ln-11379"></a>
<a name="ln-11380"></a>        <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-11381"></a>        <span class="c">!    Adjust sensible heat ratio to account for degradation of DX coil latent</span>
<a name="ln-11382"></a>        <span class="c">!    capacity at part-load (cycling) conditions.</span>
<a name="ln-11383"></a>
<a name="ln-11384"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11385"></a>        <span class="c">!    With model parameters entered by the user, the part-load latent performance</span>
<a name="ln-11386"></a>        <span class="c">!    of a DX cooling coil is determined for a constant air flow system with</span>
<a name="ln-11387"></a>        <span class="c">!    a cooling coil that cycles on/off. The model calculates the time</span>
<a name="ln-11388"></a>        <span class="c">!    required for condensate to begin falling from the cooling coil.</span>
<a name="ln-11389"></a>        <span class="c">!    Runtimes greater than this are integrated to a &quot;part-load&quot; latent</span>
<a name="ln-11390"></a>        <span class="c">!    capacity which is used to determine the &quot;part-load&quot; sensible heat ratio.</span>
<a name="ln-11391"></a>        <span class="c">!    See reference below for additional details (linear decay model, Eq. 8b).</span>
<a name="ln-11392"></a>        <span class="c">!</span>
<a name="ln-11393"></a>        <span class="c">! REFERENCES:</span>
<a name="ln-11394"></a>        <span class="c">!   &quot;A Model to Predict the Latent Capacity of Air Conditioners and</span>
<a name="ln-11395"></a>        <span class="c">!    Heat Pumps at Part-Load Conditions with Constant Fan Operation&quot;</span>
<a name="ln-11396"></a>        <span class="c">!    1996 ASHRAE Transactions, Volume 102, Part 1, Pp. 266 - 274,</span>
<a name="ln-11397"></a>        <span class="c">!    Hugh I. Henderson, Jr., P.E., Kannan Rengarajan, P.E.</span>
<a name="ln-11398"></a>
<a name="ln-11399"></a>        <span class="c">! USE STATEMENTS:</span>
<a name="ln-11400"></a>        <span class="c">!    na</span>
<a name="ln-11401"></a>
<a name="ln-11402"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11403"></a>
<a name="ln-11404"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-11405"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span>   <span class="c">! Index number for cooling coil</span>
<a name="ln-11406"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRss</span>       <span class="c">! Steady-state sensible heat ratio</span>
<a name="ln-11407"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RTF</span>         <span class="c">! Compressor run-time fraction</span>
<a name="ln-11408"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatRated</span>   <span class="c">! Rated latent capacity</span>
<a name="ln-11409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLatActual</span>  <span class="c">! Actual latent capacity</span>
<a name="ln-11410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringDB</span>  <span class="c">! Entering air dry-bulb temperature</span>
<a name="ln-11411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringWB</span>  <span class="c">! Entering air wet-bulb temperature</span>
<a name="ln-11412"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Mode</span>  <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-11413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HeatingRTF</span> <span class="c">! Used to recalculate Toff for cycling fan systems</span>
<a name="ln-11414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SHReff</span>      <span class="c">! Effective sensible heat ratio, includes degradation due to cycling effects</span>
<a name="ln-11415"></a>
<a name="ln-11416"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-11417"></a>          <span class="c">! na</span>
<a name="ln-11418"></a>
<a name="ln-11419"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11420"></a>          <span class="c">! na</span>
<a name="ln-11421"></a>
<a name="ln-11422"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11423"></a>          <span class="c">! na</span>
<a name="ln-11424"></a>
<a name="ln-11425"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11426"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet</span>        <span class="c">! Nominal time for condensate to begin leaving the coil&#39;s condensate drain line</span>
<a name="ln-11427"></a>                         <span class="c">!   at the current operating conditions (sec)</span>
<a name="ln-11428"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">Gamma</span>       <span class="c">! Initial moisture evaporation rate divided by steady-state AC latent capacity</span>
<a name="ln-11429"></a>                         <span class="c">!   at the current operating conditions</span>
<a name="ln-11430"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_rated</span>  <span class="c">! Twet at rated conditions (coil air flow rate and air temperatures), sec</span>
<a name="ln-11431"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Gamma_rated</span> <span class="c">! Gamma at rated conditions (coil air flow rate and air temperatures)</span>
<a name="ln-11432"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Twet_max</span>    <span class="c">! Maximum allowed value for Twet</span>
<a name="ln-11433"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Nmax</span>        <span class="c">! Maximum ON/OFF cycles per hour for the compressor (cycles/hr)</span>
<a name="ln-11434"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tcl</span>         <span class="c">! Time constant for latent capacity to reach steady state after startup (sec)</span>
<a name="ln-11435"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ton</span>         <span class="c">! Coil on time (sec)</span>
<a name="ln-11436"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toff</span>        <span class="c">! Coil off time (sec)</span>
<a name="ln-11437"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toffa</span>       <span class="c">! Actual coil off time (sec). Equations valid for Toff &lt;= (2.0 * Twet/Gamma)</span>
<a name="ln-11438"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aa</span>          <span class="c">! Intermediate variable</span>
<a name="ln-11439"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To1</span>         <span class="c">! Intermediate variable (first guess at To). To = time to the start of moisture removal</span>
<a name="ln-11440"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">To2</span>         <span class="c">! Intermediate variable (second guess at To). To = time to the start of moisture removal</span>
<a name="ln-11441"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Error</span>       <span class="c">! Error for iteration (DO) loop</span>
<a name="ln-11442"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LHRmult</span>     <span class="c">! Latent Heat Ratio (LHR) multiplier. The effective latent heat ratio LHR = (1-SHRss)*LHRmult</span>
<a name="ln-11443"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ton_heating</span>
<a name="ln-11444"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toff_heating</span>
<a name="ln-11445"></a>
<a name="ln-11446"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-11447"></a><span class="k">   </span><span class="n">Twet_rated</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Twet_Rated</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11448"></a>   <span class="n">Gamma_rated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Gamma_Rated</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11449"></a>   <span class="n">Nmax</span>        <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11450"></a>   <span class="n">Tcl</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatentCapacityTimeConstant</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11451"></a>  <span class="k">Else</span>
<a name="ln-11452"></a><span class="k">   </span><span class="n">Twet_rated</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTwet_Rated</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11453"></a>   <span class="n">Gamma_rated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSGamma_Rated</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11454"></a>   <span class="n">Nmax</span>        <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSMaxONOFFCyclesperHour</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11455"></a>   <span class="n">Tcl</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSLatentCapacityTimeConstant</span><span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-11456"></a>  <span class="k">End If</span>
<a name="ln-11457"></a>
<a name="ln-11458"></a><span class="c">!  No moisture evaporation (latent degradation) occurs for runtime fraction of 1.0</span>
<a name="ln-11459"></a><span class="c">!  All latent degradation model parameters cause divide by 0.0 if not greater than 0.0</span>
<a name="ln-11460"></a><span class="c">!  Latent degradation model parameters initialize to 0.0 meaning no evaporation model used.</span>
<a name="ln-11461"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">RTF</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Twet_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11462"></a>      <span class="n">Gamma_rated</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Nmax</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Tcl</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11463"></a><span class="k">     </span><span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span>
<a name="ln-11464"></a>     <span class="k">RETURN</span>
<a name="ln-11465"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-11466"></a>
<a name="ln-11467"></a>   <span class="n">Twet_max</span>   <span class="o">=</span> <span class="mi">999</span><span class="mf">9.0d0</span> <span class="c">! high limit for Twet</span>
<a name="ln-11468"></a>
<a name="ln-11469"></a><span class="c">!  Calculate the model parameters at the actual operating conditions</span>
<a name="ln-11470"></a>   <span class="n">Twet</span>    <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Twet_rated</span><span class="o">*</span><span class="n">QLatRated</span> <span class="o">/</span><span class="p">(</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">),</span><span class="n">Twet_max</span><span class="p">)</span>
<a name="ln-11471"></a>   <span class="nb">Gamma</span>   <span class="o">=</span> <span class="n">Gamma_rated</span><span class="o">*</span><span class="n">QLatRated</span><span class="o">*</span><span class="p">(</span><span class="n">EnteringDB</span><span class="o">-</span><span class="n">EnteringWB</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="mf">6.7d0</span><span class="o">-</span><span class="mi">1</span><span class="mf">9.4d0</span><span class="p">)</span><span class="o">*</span><span class="n">QLatActual</span><span class="o">+</span><span class="mf">1.d-10</span><span class="p">)</span>
<a name="ln-11472"></a>
<a name="ln-11473"></a><span class="c">!  Calculate the compressor on and off times using a converntional thermostat curve</span>
<a name="ln-11474"></a>   <span class="n">Ton</span>  <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">Nmax</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">RTF</span><span class="p">))</span>   <span class="c">! duration of cooling coil on-cycle (sec)</span>
<a name="ln-11475"></a>   <span class="n">Toff</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">Nmax</span><span class="o">*</span><span class="n">RTF</span><span class="p">)</span>        <span class="c">! duration of cooling coil off-cycle (sec)</span>
<a name="ln-11476"></a>
<a name="ln-11477"></a><span class="c">!  Cap Toff to meet the equation restriction</span>
<a name="ln-11478"></a>   <span class="k">IF</span><span class="p">(</span><span class="nb">Gamma</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11479"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Toff</span><span class="p">,</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Twet</span><span class="o">/</span><span class="nb">Gamma</span><span class="p">)</span>
<a name="ln-11480"></a>   <span class="k">ELSE</span>
<a name="ln-11481"></a><span class="k">     </span><span class="n">Toffa</span> <span class="o">=</span> <span class="n">Toff</span>
<a name="ln-11482"></a>   <span class="k">END IF</span>
<a name="ln-11483"></a>
<a name="ln-11484"></a><span class="c">!  Need to include the reheat coil operation to account for actual fan run time. E+ uses a</span>
<a name="ln-11485"></a><span class="c">!  separate heating coil for heating and reheat (to separate the heating and reheat loads)</span>
<a name="ln-11486"></a><span class="c">!  and real world applications would use a single heating coil for both purposes, the actual</span>
<a name="ln-11487"></a><span class="c">!  fan operation is based on HeatingPLR + ReheatPLR. For cycling fan RH control, latent</span>
<a name="ln-11488"></a><span class="c">!  degradation only occurs when a heating load exists, in this case the reheat load is</span>
<a name="ln-11489"></a><span class="c">!  equal to and oposite in magnitude to the cooling coil sensible output but the reheat</span>
<a name="ln-11490"></a><span class="c">!  coil is not always active. This additional fan run time has not been accounted for at this time.</span>
<a name="ln-11491"></a><span class="c">!</span>
<a name="ln-11492"></a><span class="c">!  Recalculate Toff for cycling fan systems when heating is active</span>
<a name="ln-11493"></a>   <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatingRTF</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11494"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">HeatingRTF</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HeatingRTF</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">RTF</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11495"></a><span class="k">       </span><span class="n">Ton_heating</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">Nmax</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">HeatingRTF</span><span class="p">))</span>
<a name="ln-11496"></a>       <span class="n">Toff_heating</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.d0</span><span class="o">*</span><span class="n">Nmax</span><span class="o">*</span><span class="n">HeatingRTF</span><span class="p">)</span>
<a name="ln-11497"></a><span class="c">!    add additional heating coil operation during cooling coil off cycle (due to cycling rate difference of coils)</span>
<a name="ln-11498"></a>       <span class="n">Ton_heating</span> <span class="o">=</span> <span class="n">Ton_heating</span> <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">Ton_heating</span><span class="p">,</span> <span class="p">(</span><span class="n">Ton</span><span class="o">+</span><span class="n">Toffa</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">Ton_heating</span><span class="o">+</span><span class="n">Toff_heating</span><span class="p">)))</span>
<a name="ln-11499"></a>       <span class="n">Toffa</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Toffa</span><span class="p">,</span><span class="n">Ton_heating</span> <span class="o">-</span> <span class="n">Ton</span><span class="p">)</span>
<a name="ln-11500"></a>     <span class="k">END IF</span>
<a name="ln-11501"></a><span class="k">   END IF</span>
<a name="ln-11502"></a>
<a name="ln-11503"></a><span class="c">!  Use sucessive substitution to solve for To</span>
<a name="ln-11504"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Gamma</span><span class="o">*</span><span class="n">Toffa</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.25d0</span><span class="o">/</span><span class="n">Twet</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">Gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Toffa</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-11505"></a>   <span class="n">To1</span> <span class="o">=</span> <span class="n">aa</span><span class="o">+</span><span class="n">Tcl</span>
<a name="ln-11506"></a>   <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11507"></a>   <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Error</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-11508"></a>       <span class="n">To2</span> <span class="o">=</span> <span class="n">aa</span><span class="o">-</span><span class="n">Tcl</span><span class="o">*</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">To1</span><span class="o">/</span><span class="n">Tcl</span><span class="p">)</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-11509"></a>       <span class="n">Error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">To2</span><span class="o">-</span><span class="n">To1</span><span class="p">)</span><span class="o">/</span><span class="n">To1</span><span class="p">)</span>
<a name="ln-11510"></a>       <span class="n">To1</span> <span class="o">=</span> <span class="n">To2</span>
<a name="ln-11511"></a>   <span class="k">END DO</span>
<a name="ln-11512"></a>
<a name="ln-11513"></a><span class="c">!  Adjust Sensible Heat Ratio (SHR) using Latent Heat Ratio (LHR) multiplier</span>
<a name="ln-11514"></a><span class="c">!  Floating underflow errors occur when -Ton/Tcl is a large negative number.</span>
<a name="ln-11515"></a><span class="c">!  Cap lower limit at -700 to avoid the underflow errors.</span>
<a name="ln-11516"></a>   <span class="n">aa</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="mf">0.0d0</span><span class="p">,</span><span class="o">-</span><span class="n">Ton</span><span class="o">/</span><span class="n">Tcl</span><span class="p">))</span>
<a name="ln-11517"></a><span class="c">!  Calculate latent heat ratio multiplier</span>
<a name="ln-11518"></a>   <span class="n">LHRmult</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(((</span><span class="n">Ton</span><span class="o">-</span><span class="n">To2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Ton</span><span class="o">+</span><span class="n">Tcl</span><span class="o">*</span><span class="p">(</span><span class="n">aa</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-11519"></a>
<a name="ln-11520"></a><span class="c">!  Calculate part-load or &quot;effective&quot; sensible heat ratio</span>
<a name="ln-11521"></a>   <span class="n">SHReff</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHRss</span><span class="p">)</span><span class="o">*</span><span class="n">LHRmult</span>
<a name="ln-11522"></a>
<a name="ln-11523"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SHRss</span><span class="p">)</span> <span class="n">SHReff</span> <span class="o">=</span> <span class="n">SHRss</span> <span class="c">! Effective SHR can be less than the steady-state SHR</span>
<a name="ln-11524"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">SHReff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHReff</span><span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Effective sensible heat ratio can&#39;t be greater than 1.0</span>
<a name="ln-11525"></a>
<a name="ln-11526"></a> <span class="k">RETURN</span>
<a name="ln-11527"></a>
<a name="ln-11528"></a><span class="k">END FUNCTION </span><span class="n">CalcEffectiveSHR</span>
<a name="ln-11529"></a>
<a name="ln-11530"></a><span class="k">SUBROUTINE </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">InletHumRat</span><span class="p">,</span><span class="n">InletEnthalpy</span><span class="p">,</span><span class="n">InletWetBulb</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">,&amp;</span>
<a name="ln-11531"></a>                         <span class="n">AirMassFlow</span><span class="p">,</span><span class="n">TotCapNom</span><span class="p">,</span><span class="n">CBF</span><span class="p">,</span><span class="n">CCapFTemp</span><span class="p">,</span><span class="n">CCapFFlow</span><span class="p">,</span><span class="n">TotCap</span><span class="p">,</span><span class="n">SHR</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-11532"></a>
<a name="ln-11533"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11534"></a>          <span class="c">!       AUTHOR         Fred Buhl using Don Shirey&#39;s code</span>
<a name="ln-11535"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-11536"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11537"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11538"></a>
<a name="ln-11539"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11540"></a>          <span class="c">! Calculates total capacity and sensible heat ratio of a DX coil at the specified conditions</span>
<a name="ln-11541"></a>
<a name="ln-11542"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11543"></a>          <span class="c">! With the rated performance data entered by the user, the model employs some of the</span>
<a name="ln-11544"></a>          <span class="c">! DOE-2.1E curve fits to adjust the capacity and SHR of the unit as a function</span>
<a name="ln-11545"></a>          <span class="c">! of entering air temperatures and supply air flow rate (actual vs rated flow). The model</span>
<a name="ln-11546"></a>          <span class="c">! does NOT employ the exact same methodology to calculate performance as DOE-2, although</span>
<a name="ln-11547"></a>          <span class="c">! some of the DOE-2 curve fits are employed by this model.</span>
<a name="ln-11548"></a>
<a name="ln-11549"></a>          <span class="c">! The model checks for coil dryout conditions, and adjusts the calculated performance</span>
<a name="ln-11550"></a>          <span class="c">! appropriately.</span>
<a name="ln-11551"></a>
<a name="ln-11552"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11553"></a>          <span class="c">! ASHRAE HVAC 2 Toolkit page 4-81.</span>
<a name="ln-11554"></a>          <span class="c">!</span>
<a name="ln-11555"></a>          <span class="c">! Henderson, H.I. Jr., K. Rengarajan and D.B. Shirey, III. 1992.The impact of comfort</span>
<a name="ln-11556"></a>          <span class="c">! control on air conditioner energy use in humid climates. ASHRAE Transactions 98(2):</span>
<a name="ln-11557"></a>          <span class="c">! 104-113.</span>
<a name="ln-11558"></a>          <span class="c">!</span>
<a name="ln-11559"></a>          <span class="c">! Henderson, H.I. Jr., Danny Parker and Y.J. Huang. 2000.Improving DOE-2&#39;s RESYS routine:</span>
<a name="ln-11560"></a>          <span class="c">! User Defined Functions to Provide More Accurate Part Load Energy Use and Humidity</span>
<a name="ln-11561"></a>          <span class="c">! Predictions. Proceedings of ACEEE Conference.</span>
<a name="ln-11562"></a>
<a name="ln-11563"></a>
<a name="ln-11564"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11565"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-11566"></a>
<a name="ln-11567"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11568"></a>
<a name="ln-11569"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletDryBulb</span>       <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-11571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletHumRat</span>        <span class="c">! inlet air humidity ratio [kg water / kg dry air]</span>
<a name="ln-11572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletEnthalpy</span>      <span class="c">! inlet air specific enthalpy [J/kg]</span>
<a name="ln-11573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWetBulb</span>       <span class="c">! inlet air wet bulb temperature [C]</span>
<a name="ln-11574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>   <span class="c">! Ratio of actual air mass flow to nominal air mass flow</span>
<a name="ln-11575"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>        <span class="c">! actual mass flow for capacity and SHR calculation</span>
<a name="ln-11576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapNom</span>          <span class="c">! nominal total capacity [W]</span>
<a name="ln-11577"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBF</span>                <span class="c">! coil bypass factor</span>
<a name="ln-11578"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapFTemp</span>          <span class="c">! capacity modifier curve index, function of entering wetbulb</span>
<a name="ln-11579"></a>                                             <span class="c">! and outside drybulb</span>
<a name="ln-11580"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCapFFlow</span>          <span class="c">! capacity modifier curve, function of actual flow vs rated flow</span>
<a name="ln-11581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TotCap</span>             <span class="c">! total capacity at the given conditions [W]</span>
<a name="ln-11582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SHR</span>                <span class="c">! sensible heat ratio at the given conditions</span>
<a name="ln-11583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>      <span class="c">! Condenser inlet temperature [C]</span>
<a name="ln-11584"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pressure</span>           <span class="c">! air pressure [Pa]</span>
<a name="ln-11585"></a>
<a name="ln-11586"></a>
<a name="ln-11587"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11588"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcTotCapSHR&#39;</span>
<a name="ln-11589"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIter</span>   <span class="o">=</span> <span class="mi">30</span>      <span class="c">! Maximum number of iterations for dry evaporator calculations</span>
<a name="ln-11590"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RF</span>        <span class="o">=</span> <span class="mf">0.4d0</span>   <span class="c">! Relaxation factor for dry evaporator iterations</span>
<a name="ln-11591"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">0.01d0</span>  <span class="c">! Error tolerance for dry evaporator iterations</span>
<a name="ln-11592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MinHumRatCalc</span> <span class="o">=</span> <span class="mf">0.00001d0</span>  <span class="c">! Error tolerance for dry evaporator iterations</span>
<a name="ln-11593"></a>
<a name="ln-11594"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11595"></a>          <span class="c">! na</span>
<a name="ln-11596"></a>
<a name="ln-11597"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11598"></a>          <span class="c">! na</span>
<a name="ln-11599"></a>
<a name="ln-11600"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletWetBulbCalc</span>    <span class="c">! calculated inlet wetbulb temperature used for finding dry coil point [C]</span>
<a name="ln-11602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletHumRatCalc</span>     <span class="c">! calculated inlet humidity ratio used for finding dry coil point [kg water / kg dry air]</span>
<a name="ln-11603"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>    <span class="c">! Total capacity modifier (function of entering wetbulb, outside drybulb)</span>
<a name="ln-11604"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span>    <span class="c">! Total capacity modifier (function of actual supply air flow vs nominal flow)</span>
<a name="ln-11605"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hDelta</span>              <span class="c">! Change in air enthalpy across the cooling coil [J/kg]</span>
<a name="ln-11606"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>                <span class="c">! Apparatus dew point enthalpy [J/kg]</span>
<a name="ln-11607"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>                <span class="c">! Apparatus dew point temperature [C]</span>
<a name="ln-11608"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>                <span class="c">! Apparatus dew point humidity ratio [kg/kg]</span>
<a name="ln-11609"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>            <span class="c">! Enthalpy at inlet dry-bulb and wADP [J/kg]</span>
<a name="ln-11610"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRCalc</span>             <span class="c">! temporary calculated value of SHR</span>
<a name="ln-11611"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapCalc</span>          <span class="c">! temporary calculated value of total capacity [W]</span>
<a name="ln-11612"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Counter</span>             <span class="c">! Counter for dry evaporator iterations</span>
<a name="ln-11613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>              <span class="c">! Deviation of humidity ratio in dry evaporator iteration loop</span>
<a name="ln-11614"></a>
<a name="ln-11615"></a><span class="c">!  MaxIter = 30</span>
<a name="ln-11616"></a><span class="c">!  RF = 0.4d0</span>
<a name="ln-11617"></a>  <span class="n">Counter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-11618"></a><span class="c">!  Tolerance = 0.01d0</span>
<a name="ln-11619"></a>  <span class="n">werror</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11620"></a>
<a name="ln-11621"></a>  <span class="n">InletWetBulbCalc</span> <span class="o">=</span> <span class="n">InletWetBulb</span>
<a name="ln-11622"></a>  <span class="n">InletHumRatCalc</span> <span class="o">=</span> <span class="n">InletHumRat</span>
<a name="ln-11623"></a>
<a name="ln-11624"></a><span class="c">!  DO WHILE (ABS(werror) .gt. Tolerance .OR. Counter == 0)</span>
<a name="ln-11625"></a><span class="c">!   Get capacity modifying factor (function of inlet wetbulb &amp; outside drybulb) for off-rated conditions</span>
<a name="ln-11626"></a>   <span class="k">DO</span>
<a name="ln-11627"></a><span class="k">    </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapFTemp</span><span class="p">,</span><span class="n">InletWetBulbCalc</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-11628"></a><span class="c">!   Get capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-11629"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CCapFFlow</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-11630"></a><span class="c">!   Get total capacity</span>
<a name="ln-11631"></a>    <span class="n">TotCapCalc</span> <span class="o">=</span> <span class="n">TotCapNom</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-11632"></a>
<a name="ln-11633"></a><span class="c">!   Calculate apparatus dew point conditions using TotCap and CBF</span>
<a name="ln-11634"></a>    <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCapCalc</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-11635"></a>    <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-11636"></a>    <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">Pressure</span><span class="p">)</span>
<a name="ln-11637"></a>    <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">)</span>
<a name="ln-11638"></a>    <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">wADP</span><span class="p">)</span>
<a name="ln-11639"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">InletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11640"></a><span class="k">      </span><span class="n">SHRCalc</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-11641"></a>    <span class="k">ELSE</span>
<a name="ln-11642"></a><span class="k">      </span><span class="n">SHRCalc</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-11643"></a>    <span class="n">ENDIF</span>
<a name="ln-11644"></a><span class="c">!</span>
<a name="ln-11645"></a><span class="c">!   Check for dry evaporator conditions (win &lt; wadp)</span>
<a name="ln-11646"></a><span class="c">!</span>
<a name="ln-11647"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">wADP</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">InletHumRatCalc</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11648"></a><span class="k">      If</span><span class="p">(</span><span class="n">InletHumRatCalc</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">InletHumRatCalc</span><span class="o">=</span><span class="n">MinHumRatCalc</span>
<a name="ln-11649"></a><span class="c">!      InletHumRatCalc=MAX(InletHumRatCalc,MinHumRatCalc)  ! proposed.</span>
<a name="ln-11650"></a>
<a name="ln-11651"></a>      <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">InletHumRatCalc</span> <span class="o">-</span> <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">InletHumRatCalc</span>
<a name="ln-11652"></a><span class="c">!</span>
<a name="ln-11653"></a><span class="c">!     Increase InletHumRatCalc at constant inlet air temp to find coil dry-out point. Then use the</span>
<a name="ln-11654"></a><span class="c">!     capacity at the dry-out point to determine exiting conditions from coil. This is required</span>
<a name="ln-11655"></a><span class="c">!     since the TotCapTempModFac doesn&#39;t work properly with dry-coil conditions.</span>
<a name="ln-11656"></a><span class="c">!</span>
<a name="ln-11657"></a>      <span class="n">InletHumRatCalc</span> <span class="o">=</span> <span class="n">RF</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RF</span><span class="p">)</span><span class="o">*</span><span class="n">InletHumRatCalc</span>
<a name="ln-11658"></a>      <span class="n">InletWetBulbCalc</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">InletHumRatCalc</span><span class="p">,</span><span class="n">Pressure</span><span class="p">)</span>
<a name="ln-11659"></a>      <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-11660"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Recalculate with modified inlet conditions</span>
<a name="ln-11661"></a>      <span class="k">EXIT</span> <span class="c">! conditions are satisfied</span>
<a name="ln-11662"></a>    <span class="k">ELSE</span>
<a name="ln-11663"></a><span class="k">      EXIT</span> <span class="c">! conditions are satisfied</span>
<a name="ln-11664"></a>    <span class="k">END IF</span>
<a name="ln-11665"></a><span class="k">  END DO</span>
<a name="ln-11666"></a>
<a name="ln-11667"></a><span class="c">! END DO</span>
<a name="ln-11668"></a>
<a name="ln-11669"></a><span class="c">!  Calculate full load output conditions</span>
<a name="ln-11670"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SHRCalc</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SHRCalc</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-11671"></a>
<a name="ln-11672"></a>  <span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRCalc</span>
<a name="ln-11673"></a>  <span class="n">TotCap</span> <span class="o">=</span> <span class="n">TotCapCalc</span>
<a name="ln-11674"></a>
<a name="ln-11675"></a>  <span class="k">RETURN</span>
<a name="ln-11676"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTotCapSHR</span>
<a name="ln-11677"></a>
<a name="ln-11678"></a><span class="k">SUBROUTINE </span><span class="n">CalcMultiSpeedDXCoilCooling</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">)</span>
<a name="ln-11679"></a>
<a name="ln-11680"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11681"></a>          <span class="c">!       AUTHOR         Lixing Gu, FSEC</span>
<a name="ln-11682"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-11683"></a>          <span class="c">!       MODIFIED       April 2010, Chandan sharma, FSEC, added basin heater</span>
<a name="ln-11684"></a>          <span class="c">!       RE-ENGINEERED  Revised based on CalcMultiSpeedDXCoil</span>
<a name="ln-11685"></a>
<a name="ln-11686"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11687"></a>          <span class="c">! Calculates the air-side performance and electrical energy use of a direct-</span>
<a name="ln-11688"></a>          <span class="c">! expansion, air-cooled cooling unit with a multispeed compressor.</span>
<a name="ln-11689"></a>
<a name="ln-11690"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11691"></a>          <span class="c">! Uses the same methodology as the single speed DX unit model (SUBROUTINE CalcDoe2DXCoil).</span>
<a name="ln-11692"></a>          <span class="c">! In addition it assumes that the unit performance is obtained by interpolating between</span>
<a name="ln-11693"></a>          <span class="c">! the performance at high speed and that at low speed. If the output needed is below</span>
<a name="ln-11694"></a>          <span class="c">! that produced at low speed, the compressor cycles between off and low speed.</span>
<a name="ln-11695"></a>
<a name="ln-11696"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11697"></a><span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-11698"></a><span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-11699"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">MSHPMassFlowRateLow</span><span class="p">,</span> <span class="n">MSHPMassFlowRateHigh</span><span class="p">,</span> <span class="n">MSHPWasteHeat</span>
<a name="ln-11700"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-11701"></a>
<a name="ln-11702"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11703"></a>
<a name="ln-11704"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11705"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DXCoilNum</span>     <span class="c">! the number of the DX heating coil to be simulated</span>
<a name="ln-11706"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>    <span class="c">! = (CompressorSpeed - CompressorSpeedMin) / (CompressorSpeedMax - CompressorSpeedMin)</span>
<a name="ln-11707"></a>                         <span class="c">! SpeedRatio varies between 1.0 (maximum speed) and 0.0 (minimum speed)</span>
<a name="ln-11708"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>      <span class="c">! cycling part load ratio</span>
<a name="ln-11709"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>      <span class="c">! Speed number</span>
<a name="ln-11710"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>     <span class="c">! Sets fan control to CycFanCycCoil or ContFanCycCoil</span>
<a name="ln-11711"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>        <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-11712"></a>
<a name="ln-11713"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11714"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcMultiSpeedDXCoilCooling&#39;</span>
<a name="ln-11715"></a>
<a name="ln-11716"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11717"></a>          <span class="c">! na</span>
<a name="ln-11718"></a>
<a name="ln-11719"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11720"></a>          <span class="c">! na</span>
<a name="ln-11721"></a>
<a name="ln-11722"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11723"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>         <span class="c">! dry air mass flow rate through coil [kg/s]</span>
<a name="ln-11724"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirWetBulbC</span>    <span class="c">! wetbulb temperature of inlet air [C]</span>
<a name="ln-11725"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDryBulbTemp</span> <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-11726"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>    <span class="c">! inlet air enthalpy [J/kg]</span>
<a name="ln-11727"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>      <span class="c">! inlet air humidity ratio [kg/kg]</span>
<a name="ln-11728"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11729"></a><span class="c">!REAL(r64)   :: InletAirPressure    ! inlet air pressure [Pa]</span>
<a name="ln-11730"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDryBulbTemp</span>    <span class="c">! outlet air dry bulb temperature [C]</span>
<a name="ln-11731"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>   <span class="c">! outlet air enthalpy [J/kg]</span>
<a name="ln-11732"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>     <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-11733"></a><span class="c">!REAL(r64)   :: OutletAirRH         ! outlet air relative humudity [fraction]</span>
<a name="ln-11734"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirDryBulbTempSat</span> <span class="c">! outlet air dry bulb temp at saturation at the outlet enthalpy [C]</span>
<a name="ln-11735"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirDryBulbTemp</span> <span class="c">! low speed outlet air dry bulb temperature [C]</span>
<a name="ln-11736"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirEnthalpy</span>    <span class="c">! low speed outlet air enthalpy [J/kg]</span>
<a name="ln-11737"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirHumRat</span>      <span class="c">! low speed outlet air humidity ratio [kg/kg]</span>
<a name="ln-11738"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSOutletAirRH</span>          <span class="c">! low speed outlet air relative humudity [fraction]</span>
<a name="ln-11739"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSOutletAirDryBulbTemp</span> <span class="c">! hihg speed outlet air dry bulb temperature [C]</span>
<a name="ln-11740"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSOutletAirEnthalpy</span>    <span class="c">! high speed outlet air enthalpy [J/kg]</span>
<a name="ln-11741"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSOutletAirHumRat</span>      <span class="c">! high speed outlet air humidity ratio [kg/kg]</span>
<a name="ln-11742"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSOutletAirRH</span>          <span class="c">! high speed outlet air relative humudity [fraction]</span>
<a name="ln-11743"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hDelta</span>              <span class="c">! Change in air enthalpy across the cooling coil [J/kg]</span>
<a name="ln-11744"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>            <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-11745"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>                <span class="c">! Apparatus dew point enthalpy [J/kg]</span>
<a name="ln-11746"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>                <span class="c">! Apparatus dew point temperature [C]</span>
<a name="ln-11747"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>                <span class="c">! Apparatus dew point humidity ratio [kg/kg]</span>
<a name="ln-11748"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>            <span class="c">! Enthalpy at inlet dry-bulb and wADP [J/kg]</span>
<a name="ln-11749"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBFHS</span>          <span class="c">! coil bypass factor at rated conditions (high speed)</span>
<a name="ln-11750"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFHS</span>               <span class="c">! coil bypass factor at max flow (high speed)</span>
<a name="ln-11751"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedCBFLS</span>          <span class="c">! coil bypass factor at rated conditions (low speed)</span>
<a name="ln-11752"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBFLS</span>               <span class="c">! coil bypass factor at max flow (low speed)</span>
<a name="ln-11753"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapHS</span>            <span class="c">! total capacity at high speed [W]</span>
<a name="ln-11754"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRHS</span>               <span class="c">! sensible heat ratio at high speed</span>
<a name="ln-11755"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapLS</span>            <span class="c">! total capacity at low speed [W]</span>
<a name="ln-11756"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRLS</span>               <span class="c">! sensible heat ratio at low speed</span>
<a name="ln-11757"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFacHS</span>     <span class="c">! EIR modifier (function of entering wetbulb, outside drybulb) (high speed)</span>
<a name="ln-11758"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFacHS</span>     <span class="c">! EIR modifier (function of actual supply air flow vs rated flow) (high speed)</span>
<a name="ln-11759"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRHS</span>               <span class="c">! EIR at off rated conditions (high speed)</span>
<a name="ln-11760"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFacLS</span>     <span class="c">! EIR modifier (function of entering wetbulb, outside drybulb) (low speed)</span>
<a name="ln-11761"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFacLS</span>     <span class="c">! EIR modifier (function of actual supply air flow vs rated flow) (low speed)</span>
<a name="ln-11762"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRLS</span>               <span class="c">! EIR at off rated conditions (low speed)</span>
<a name="ln-11763"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span>                 <span class="c">! sensible heat ratio at current speed</span>
<a name="ln-11764"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span>                 <span class="c">! EIR at current speed</span>
<a name="ln-11765"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CBF</span>                 <span class="c">! CBFNom adjusted for actual air mass flow rate</span>
<a name="ln-11766"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>                 <span class="c">! Part load factor, accounts for thermal lag at compressor startup, used in</span>
<a name="ln-11767"></a>                               <span class="c">! power calculation</span>
<a name="ln-11768"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>       <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-11769"></a>                               <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-11770"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>     <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-11771"></a>                               <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-11772"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoAir</span>              <span class="c">! Density of air [kg/m3]</span>
<a name="ln-11773"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoWater</span>            <span class="c">! Density of water [kg/m3]</span>
<a name="ln-11774"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>     <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-11775"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecPower</span> <span class="c">! Evaporative condenser electric pump power [W]</span>
<a name="ln-11776"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! minimum of the inlet air humidity ratio and the outlet air humidity ratio</span>
<a name="ln-11777"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">DXMode</span><span class="o">=</span><span class="mi">1</span>        <span class="c">! Performance mode for MultiMode DX coil; Always 1 for other coil types</span>
<a name="ln-11778"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>       <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-11779"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>       <span class="c">! Outdoor wet-bulb temperature at condenser (C)</span>
<a name="ln-11780"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>        <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-11781"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorPressure</span>      <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-11782"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNumHS</span>           <span class="c">! High speed number</span>
<a name="ln-11783"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNumLS</span>           <span class="c">! Low speed number</span>
<a name="ln-11784"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRUnadjusted</span>        <span class="c">! Temp SHR</span>
<a name="ln-11785"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">QLatRated</span>                <span class="c">! Qlatent at rated conditions of indoor(TDB,TWB)=(26.7C,19.4C)</span>
<a name="ln-11786"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">QLatActual</span>               <span class="c">! Qlatent at actual operating conditions</span>
<a name="ln-11787"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatioLS</span>   <span class="c">! airflow ratio at low speed</span>
<a name="ln-11788"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatioHS</span>   <span class="c">! airflow ratio at high speed</span>
<a name="ln-11789"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WasteHeatLS</span>          <span class="c">! Waste heat at low speed</span>
<a name="ln-11790"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WasteHeatHS</span>          <span class="c">! Waste heat at high speed</span>
<a name="ln-11791"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSElecCoolingPower</span>   <span class="c">! low speed power [W]</span>
<a name="ln-11792"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSElecCoolingPower</span>   <span class="c">! high speed power [W]</span>
<a name="ln-11793"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span> <span class="c">! Power due to crank case heater</span>
<a name="ln-11794"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hfg</span>
<a name="ln-11795"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolumeFlowRate</span>    <span class="c">! Air volume flow rate across the heating coil</span>
<a name="ln-11796"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowperRatedTotCap</span> <span class="c">! Air volume flow rate divided by rated total heating capacity</span>
<a name="ln-11797"></a>
<a name="ln-11798"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">DXMode</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11799"></a><span class="k">  </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">DXMode</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-11800"></a>  <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-11801"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11802"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-11803"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-11804"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-11805"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-11806"></a>  <span class="k">ELSE</span>
<a name="ln-11807"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">DXMode</span><span class="p">))%</span><span class="n">Temp</span>
<a name="ln-11808"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="n">DXMode</span><span class="p">))%</span><span class="n">HumRat</span>
<a name="ln-11809"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11810"></a>  <span class="k">END IF</span>
<a name="ln-11811"></a><span class="k">ELSE</span>
<a name="ln-11812"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-11813"></a>  <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-11814"></a>  <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-11815"></a>  <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-11816"></a><span class="n">ENDIF</span>
<a name="ln-11817"></a>
<a name="ln-11818"></a><span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-11819"></a><span class="k">   </span><span class="n">SpeedNumLS</span> <span class="o">=</span> <span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-11820"></a>   <span class="n">SpeedNumHS</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-11821"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-11822"></a><span class="k">    </span><span class="n">SpeedNumLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-11823"></a>    <span class="n">SpeedNumHS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-11824"></a>  <span class="k">End If</span>
<a name="ln-11825"></a><span class="k">Else</span>
<a name="ln-11826"></a><span class="k">  </span><span class="n">SpeedNumLS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-11827"></a>  <span class="n">SpeedNumHS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-11828"></a><span class="k">End If</span>
<a name="ln-11829"></a>
<a name="ln-11830"></a><span class="n">MSHPWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11831"></a><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-11832"></a><span class="n">AirMassFlowRatioLS</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-11833"></a><span class="n">AirMassFlowRatioHS</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-11834"></a>
<a name="ln-11835"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11836"></a><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11837"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11838"></a><span class="n">InletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-11839"></a><span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-11840"></a><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-11841"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11842"></a><span class="c">!InletAirPressure = DXCoil(DXCoilNum)%InletAirPressure</span>
<a name="ln-11843"></a><span class="c">!InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRat,InletAirPressure)</span>
<a name="ln-11844"></a><span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11845"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">DXMode</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11846"></a><span class="k">  </span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">OutdoorDryBulb</span> <span class="c">! Outdoor dry-bulb temp</span>
<a name="ln-11847"></a><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">DXMode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11848"></a> <span class="c">! Outdoor wet-bulb temp from DataEnvironment + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-11849"></a>  <span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondEffect</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span>
<a name="ln-11850"></a>  <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11851"></a><span class="k">END IF</span>
<a name="ln-11852"></a><span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11853"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-11854"></a><span class="k">ELSE</span>
<a name="ln-11855"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11856"></a><span class="k">END IF</span>
<a name="ln-11857"></a>
<a name="ln-11858"></a><span class="k">IF</span><span class="p">((</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11859"></a>   <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11860"></a>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CycRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CompOp</span> <span class="o">==</span> <span class="n">On</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11861"></a>
<a name="ln-11862"></a><span class="k">  </span><span class="n">RhoAir</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">OutdoorHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11863"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11864"></a>
<a name="ln-11865"></a>    <span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 500 cfm/ton) at low speed</span>
<a name="ln-11866"></a>    <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11867"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11868"></a>    <span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-11869"></a>    <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-11870"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11871"></a>        <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-11872"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11873"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11874"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out of range at speed &#39;</span> <span class="p">&amp;</span>
<a name="ln-11875"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-11876"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11877"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11878"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11879"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-11880"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-11881"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-11882"></a>      <span class="k">END IF</span>
<a name="ln-11883"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11884"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11885"></a>         <span class="s1">&#39;of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;error continues...&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11886"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-11887"></a>    <span class="k">END IF</span>
<a name="ln-11888"></a>
<a name="ln-11889"></a>    <span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 500 cfm/ton) at high speed</span>
<a name="ln-11890"></a>    <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11891"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11892"></a>    <span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-11893"></a>    <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-11894"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11895"></a>        <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-11896"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11897"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11898"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out of range at speed &#39;</span> <span class="p">&amp;</span>
<a name="ln-11899"></a>          <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-11900"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-11901"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11902"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11903"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-11904"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-11905"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-11906"></a>      <span class="k">END IF</span>
<a name="ln-11907"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11908"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11909"></a>         <span class="s1">&#39;of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;error continues...&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11910"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-11911"></a>    <span class="k">END IF</span>
<a name="ln-11912"></a>
<a name="ln-11913"></a>    <span class="c">! Adjust high speed coil bypass factor for actual maximum air flow rate.</span>
<a name="ln-11914"></a>    <span class="n">RatedCBFHS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-11915"></a>    <span class="n">CBFHS</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">RatedCBFHS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">MSHPMassFlowRateHigh</span><span class="p">)</span>
<a name="ln-11916"></a>    <span class="n">RatedCBFLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-11917"></a>    <span class="n">CBFLS</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">RatedCBFLS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">MSHPMassFlowRateLow</span><span class="p">)</span>
<a name="ln-11918"></a>    <span class="c">! get low speed total capacity and SHR at current conditions</span>
<a name="ln-11919"></a>    <span class="k">CALL </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">InletAirEnthalpy</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatioLS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11920"></a>                       <span class="n">MSHPMassFlowRateLow</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-11921"></a>                       <span class="n">CBFLS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-11922"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">TotCapLS</span><span class="p">,</span><span class="n">SHRLS</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11923"></a>                       <span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-11924"></a>    <span class="c">! get low speed outlet conditions</span>
<a name="ln-11925"></a>    <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCapLS</span> <span class="o">/</span> <span class="n">MSHPMassFlowRateLow</span>
<a name="ln-11926"></a>    <span class="c">! Calculate new apparatus dew point conditions</span>
<a name="ln-11927"></a>    <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBFLS</span><span class="p">)</span>
<a name="ln-11928"></a>    <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoilCooling highspeed&#39;</span><span class="p">)</span>
<a name="ln-11929"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11930"></a>    <span class="c">!  tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-11931"></a>    <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoilCooling&#39;</span><span class="p">)</span>
<a name="ln-11932"></a>    <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">,</span><span class="s1">&#39;CalcMultiSpeedDXCoilCooling highspeed&#39;</span><span class="p">)</span>
<a name="ln-11933"></a>    <span class="c">! get corresponding SHR</span>
<a name="ln-11934"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11935"></a><span class="k">      </span><span class="n">SHRLS</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-11936"></a>    <span class="k">ELSE</span>
<a name="ln-11937"></a><span class="k">      </span><span class="n">SHRLS</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-11938"></a>    <span class="n">ENDIF</span>
<a name="ln-11939"></a><span class="c">!cr8918    SHRLS = MIN((hTinwADP-hADP)/(InletAirEnthalpy-hADP),1.d0)</span>
<a name="ln-11940"></a>    <span class="c">! get low speed outlet conditions</span>
<a name="ln-11941"></a>    <span class="n">LSOutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-11942"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHRLS</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-11943"></a>    <span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11944"></a>    <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11945"></a>    <span class="n">LSOutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11946"></a>                    <span class="s1">&#39;CalcMultiSpeedDXCoilCooling:highspeed&#39;</span><span class="p">)</span>
<a name="ln-11947"></a>    <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11948"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11949"></a>    <span class="c">!    LSOutletAirRH = PsyRhFnTdbWPb(LSOutletAirDryBulbTemp,LSOutletAirHumRat,InletAirPressure)</span>
<a name="ln-11950"></a>    <span class="c">!    OutletAirDryBulbTempSat = PsyTsatFnHPb(LSOutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-11951"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-11952"></a>      <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-11953"></a>      <span class="n">LSOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11954"></a>    <span class="k">END IF</span>
<a name="ln-11955"></a>
<a name="ln-11956"></a>    <span class="c">! get high speed total capacity and SHR at current conditions</span>
<a name="ln-11957"></a>
<a name="ln-11958"></a>    <span class="k">CALL </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">InletAirEnthalpy</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatioHS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11959"></a>                       <span class="n">MSHPMassFlowRateHigh</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-11960"></a>                       <span class="n">CBFHS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">TotCapHS</span><span class="p">,</span><span class="n">SHRHS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11961"></a>                       <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-11962"></a>    <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCapHS</span> <span class="o">/</span> <span class="n">MSHPMassFlowRateHigh</span>
<a name="ln-11963"></a>    <span class="c">! Calculate new apparatus dew point conditions</span>
<a name="ln-11964"></a>    <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBFHS</span><span class="p">)</span>
<a name="ln-11965"></a>    <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11966"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11967"></a>    <span class="c">!  tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-11968"></a>    <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11969"></a>    <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11970"></a>    <span class="c">! get corresponding SHR</span>
<a name="ln-11971"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11972"></a><span class="k">      </span><span class="n">SHRHS</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-11973"></a>    <span class="k">ELSE</span>
<a name="ln-11974"></a><span class="k">      </span><span class="n">SHRHS</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-11975"></a>    <span class="n">ENDIF</span>
<a name="ln-11976"></a><span class="c">!cr8918    SHRHS = MIN((hTinwADP-hADP)/(InletAirEnthalpy-hADP),1.d0)</span>
<a name="ln-11977"></a>    <span class="c">! get the part load factor that will account for cycling losses</span>
<a name="ln-11978"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-11979"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11980"></a><span class="k">     </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-11981"></a>    <span class="k">END IF</span>
<a name="ln-11982"></a>    <span class="c">! calculate the run time fraction</span>
<a name="ln-11983"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-11984"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>    <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11985"></a>
<a name="ln-11986"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11987"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-11988"></a>    <span class="k">END IF</span>
<a name="ln-11989"></a>
<a name="ln-11990"></a>    <span class="c">! get high speed outlet conditions</span>
<a name="ln-11991"></a>    <span class="n">HSOutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-11992"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHRHS</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-11993"></a>    <span class="n">HSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11994"></a>    <span class="n">HSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">HSOutletAirEnthalpy</span><span class="p">,</span><span class="n">HSOutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11995"></a>    <span class="n">HSOutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">HSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">HSOutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11996"></a>                    <span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:highspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-11997"></a>    <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">HSOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-11998"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-11999"></a>    <span class="c">!    LSOutletAirRH = PsyRhFnTdbWPb(LSOutletAirDryBulbTemp,LSOutletAirHumRat,InletAirPressure)</span>
<a name="ln-12000"></a>    <span class="c">!    OutletAirDryBulbTempSat = PsyTsatFnHPb(LSOutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-12001"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HSOutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-12002"></a>      <span class="n">HSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-12003"></a>      <span class="n">HSOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">HSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">HSOutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12004"></a>    <span class="k">END IF</span>
<a name="ln-12005"></a>
<a name="ln-12006"></a>    <span class="c">!  If constant fan with cycling compressor, call function to determine &quot;effective SHR&quot;</span>
<a name="ln-12007"></a>    <span class="c">!  which includes the part-load degradation on latent capacity</span>
<a name="ln-12008"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatentImpact</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SpeedRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12009"></a><span class="k">      </span><span class="n">QLatRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span>
<a name="ln-12010"></a>      <span class="n">QLatActual</span> <span class="o">=</span> <span class="n">TotCapHS</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SHRHS</span><span class="p">)</span>
<a name="ln-12011"></a>      <span class="n">SHRUnadjusted</span> <span class="o">=</span> <span class="n">SHRHS</span>
<a name="ln-12012"></a>      <span class="n">SHR</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHRHS</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12013"></a>                          <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirWetbulbC</span><span class="p">,</span> <span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12014"></a>      <span class="c">! Calculate full load output conditions</span>
<a name="ln-12015"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHR</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-12016"></a>      <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-12017"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12018"></a><span class="k">        </span><span class="n">HSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12019"></a>      <span class="k">Else</span>
<a name="ln-12020"></a><span class="k">        </span><span class="n">HSOutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-12021"></a>      <span class="k">End If</span>
<a name="ln-12022"></a><span class="k">      </span><span class="n">HSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">HSOutletAirEnthalpy</span><span class="p">,</span><span class="n">HSOutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12023"></a>    <span class="k">END IF</span>
<a name="ln-12024"></a>
<a name="ln-12025"></a>    <span class="c">! get high speed EIR at current conditions</span>
<a name="ln-12026"></a>    <span class="n">EIRTempModFacHS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-12027"></a>    <span class="n">EIRFlowModFacHS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">AirMassFlowRatioHS</span><span class="p">)</span>
<a name="ln-12028"></a>    <span class="n">EIRHS</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRFlowModFacHS</span> <span class="o">*</span> <span class="n">EIRTempModFacHS</span>
<a name="ln-12029"></a>    <span class="c">! get low speed EIR at current conditions</span>
<a name="ln-12030"></a>    <span class="n">EIRTempModFacLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-12031"></a>    <span class="n">EIRFlowModFacLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">AirMassFlowRatioLS</span><span class="p">)</span>
<a name="ln-12032"></a>    <span class="n">EIRLS</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRTempModFacLS</span> <span class="o">*</span> <span class="n">EIRFlowModFacLS</span>
<a name="ln-12033"></a>
<a name="ln-12034"></a>    <span class="c">! get current total capacity, SHR, EIR</span>
<a name="ln-12035"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12036"></a><span class="k">      </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRHS</span>
<a name="ln-12037"></a>      <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRHS</span>
<a name="ln-12038"></a>      <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12039"></a>      <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12040"></a>    <span class="k">ELSE</span>
<a name="ln-12041"></a><span class="k">      </span><span class="n">EIR</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">EIRHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">EIRLS</span>
<a name="ln-12042"></a>      <span class="n">SHR</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">SHRHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">SHRLS</span>
<a name="ln-12043"></a>      <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12044"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span>
<a name="ln-12045"></a>      <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12046"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12047"></a>    <span class="k">END IF</span>
<a name="ln-12048"></a>    <span class="c">! Outlet calculation</span>
<a name="ln-12049"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">*</span><span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">HSOutletAirEnthalpy</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12050"></a>                                               <span class="n">MSHPMassFlowRateLow</span><span class="o">*</span><span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">LSOutletAirEnthalpy</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-12051"></a>    <span class="c">! Average outlet enthalpy</span>
<a name="ln-12052"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12053"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="o">*</span><span class="n">HSOutletAirHumRat</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LSOutletAirHumRat</span><span class="p">)</span>
<a name="ln-12054"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">*</span><span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12055"></a>                                              <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">HSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12056"></a>                                              <span class="n">MSHPMassFlowRateLow</span><span class="o">*</span><span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12057"></a>                                              <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-12058"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12059"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-12060"></a>    <span class="k">END IF</span>
<a name="ln-12061"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12062"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-12063"></a>
<a name="ln-12064"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12065"></a>    <span class="c">! Update outlet conditions</span>
<a name="ln-12066"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12067"></a><span class="k">      </span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LSOutletAirEnthalpy</span>
<a name="ln-12068"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">LSOutletAirHumRat</span>
<a name="ln-12069"></a>      <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">LSOutletAirDryBulbTemp</span>
<a name="ln-12070"></a>    <span class="k">Else If</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12071"></a><span class="k">      </span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">HSOutletAirEnthalpy</span>
<a name="ln-12072"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">HSOutletAirHumRat</span>
<a name="ln-12073"></a>      <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">HSOutletAirDryBulbTemp</span>
<a name="ln-12074"></a>    <span class="k">Else</span>
<a name="ln-12075"></a><span class="k">      </span><span class="n">Hfg</span> <span class="o">=</span> <span class="n">PsyHfgAirFnWTdb</span><span class="p">(</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">HSOutletAirDryBulbTemp</span><span class="o">*</span><span class="n">SpeedRatio</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12076"></a>          <span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:highspeed&#39;</span><span class="p">)</span>
<a name="ln-12077"></a>      <span class="c">! Average outlet HR</span>
<a name="ln-12078"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="o">/</span><span class="n">Hfg</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12079"></a>      <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12080"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-12081"></a>        <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-12082"></a>        <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12083"></a>        <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-12084"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">*</span><span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12085"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span>
<a name="ln-12086"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12087"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-12088"></a>        <span class="k">END IF</span>
<a name="ln-12089"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12090"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-12091"></a>      <span class="k">END IF</span>
<a name="ln-12092"></a><span class="k">    End If</span>
<a name="ln-12093"></a>
<a name="ln-12094"></a><span class="k">    </span><span class="n">LSElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCapLS</span><span class="o">*</span><span class="n">EIRLS</span>
<a name="ln-12095"></a>    <span class="n">HSElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCapHS</span><span class="o">*</span><span class="n">EIRHS</span>
<a name="ln-12096"></a>
<a name="ln-12097"></a>    <span class="c">! Power calculation</span>
<a name="ln-12098"></a>    <span class="k">If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12099"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">HSElecCoolingPower</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LSElecCoolingPower</span>
<a name="ln-12100"></a>    <span class="k">Else</span>
<a name="ln-12101"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="o">*</span><span class="n">HSElecCoolingPower</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12102"></a>                   <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span><span class="o">*</span><span class="n">LSElecCoolingPower</span>
<a name="ln-12103"></a>    <span class="k">End If</span>
<a name="ln-12104"></a><span class="c">!   Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-12105"></a>    <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-12106"></a>
<a name="ln-12107"></a>    <span class="c">! Waste heat calculation</span>
<a name="ln-12108"></a>    <span class="n">WasteHeatLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12109"></a>                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12110"></a>    <span class="n">WasteHeatHS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12111"></a>                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12112"></a>    <span class="n">MSHPWasteHeat</span> <span class="o">=</span> <span class="p">(</span><span class="n">SpeedRatio</span><span class="o">*</span><span class="n">WasteHeatHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">WasteHeatLS</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-12113"></a>
<a name="ln-12114"></a>    <span class="c">! Energy use for other fuel types</span>
<a name="ln-12115"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12116"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-12117"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12118"></a>    <span class="k">End If</span>
<a name="ln-12119"></a>
<a name="ln-12120"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-12121"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-12122"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTemp</span>
<a name="ln-12123"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12124"></a>
<a name="ln-12125"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CycRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12126"></a>
<a name="ln-12127"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">CycRatio</span>
<a name="ln-12128"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span>
<a name="ln-12129"></a>
<a name="ln-12130"></a>    <span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 500 cfm/ton) at low speed</span>
<a name="ln-12131"></a>    <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12132"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12133"></a>    <span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-12134"></a>    <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12135"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12136"></a>        <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-12137"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12138"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12139"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out of range at speed &#39;</span> <span class="p">&amp;</span>
<a name="ln-12140"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12141"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12142"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12143"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12144"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxCoolVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-12145"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-12146"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-12147"></a>      <span class="k">END IF</span>
<a name="ln-12148"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12149"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total cooling capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12150"></a>         <span class="s1">&#39;of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;error continues...&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12151"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-12152"></a>    <span class="k">END IF</span>
<a name="ln-12153"></a>
<a name="ln-12154"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12155"></a>     <span class="c">! Outdoor wet-bulb temp from DataEnvironment + (1.0-EvapCondEffectiveness) * (drybulb - wetbulb)</span>
<a name="ln-12156"></a>      <span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondEffect</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span>
<a name="ln-12157"></a>      <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12158"></a>    <span class="k">END IF</span>
<a name="ln-12159"></a>
<a name="ln-12160"></a><span class="k">    </span><span class="n">RatedCBFLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12161"></a>    <span class="n">CBFLS</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">RatedCBFLS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">MSHPMassFlowRateLow</span><span class="p">)</span>
<a name="ln-12162"></a>
<a name="ln-12163"></a>    <span class="c">! Adjust low speed coil bypass factor for actual flow rate.</span>
<a name="ln-12164"></a>    <span class="c">! CBF = AdjustCBF(DXCoil(DXCoilNum)%RatedCBF2,DXCoil(DXCoilNum)%RatedAirMassFlowRate2,AirMassFlow)</span>
<a name="ln-12165"></a>    <span class="c">! get low speed total capacity and SHR at current conditions</span>
<a name="ln-12166"></a>    <span class="k">CALL </span><span class="n">CalcTotCapSHR</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">InletAirEnthalpy</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">AirMassFlowRatioLS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12167"></a>                       <span class="n">MSHPMassFlowRateLow</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-12168"></a>                       <span class="n">CBFLS</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-12169"></a>                       <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">TotCapLS</span><span class="p">,</span><span class="n">SHRLS</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12170"></a>                       <span class="n">OutdoorPressure</span><span class="p">)</span>
<a name="ln-12171"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12172"></a>    <span class="c">!  Node(DXCoil(DXCoilNum)%AirInNode)%Press)</span>
<a name="ln-12173"></a>    <span class="n">hDelta</span> <span class="o">=</span> <span class="n">TotCapLS</span> <span class="o">/</span> <span class="n">AirMassFlow</span>
<a name="ln-12174"></a>    <span class="c">! Adjust CBF for off-nominal flow</span>
<a name="ln-12175"></a>    <span class="n">CBF</span> <span class="o">=</span> <span class="n">AdjustCBF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCBF</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">AirMassFlow</span><span class="p">)</span>
<a name="ln-12176"></a>    <span class="c">! Calculate new apparatus dew point conditions</span>
<a name="ln-12177"></a>    <span class="n">hADP</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">CBF</span><span class="p">)</span>
<a name="ln-12178"></a>    <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12179"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12180"></a>    <span class="c">!  tADP = PsyTsatFnHPb(hADP,InletAirPressure)</span>
<a name="ln-12181"></a>    <span class="n">wADP</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span><span class="n">hADP</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12182"></a>    <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">wADP</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12183"></a>    <span class="c">! get corresponding SHR</span>
<a name="ln-12184"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12185"></a><span class="k">      </span><span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">InletAirEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-12186"></a>    <span class="k">ELSE</span>
<a name="ln-12187"></a><span class="k">      </span><span class="n">SHR</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-12188"></a>    <span class="n">ENDIF</span>
<a name="ln-12189"></a><span class="c">!cr8918    SHR = MIN((hTinwADP-hADP)/(InletAirEnthalpy-hADP),1.d0)</span>
<a name="ln-12190"></a>
<a name="ln-12191"></a>    <span class="c">! get the part load factor that will account for cycling losses</span>
<a name="ln-12192"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">CycRatio</span><span class="p">)</span>
<a name="ln-12193"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CycRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PLF</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12194"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12195"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The PLF curve value for DX cooling coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12196"></a>                         <span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for part-load ratio = 1&#39;</span><span class="p">)</span>
<a name="ln-12197"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;PLF curve value must be = 1.0 and has been reset to 1.0. Simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-12198"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12199"></a>      <span class="n">ENDIF</span>
<a name="ln-12200"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12201"></a>          <span class="s1">&#39; DX cooling coil PLF curve value &lt;&gt; 1.0 warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12202"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFErrIndex</span><span class="p">,</span> <span class="n">PLF</span><span class="p">,</span> <span class="n">PLF</span><span class="p">)</span>
<a name="ln-12203"></a>      <span class="n">PLF</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12204"></a>    <span class="k">END IF</span>
<a name="ln-12205"></a>
<a name="ln-12206"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12207"></a><span class="k">     </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-12208"></a>    <span class="k">END IF</span>
<a name="ln-12209"></a>    <span class="c">! calculate the run time fraction</span>
<a name="ln-12210"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="n">CycRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-12211"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>    <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-12212"></a>
<a name="ln-12213"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12214"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-12215"></a>    <span class="k">END IF</span>
<a name="ln-12216"></a>
<a name="ln-12217"></a>    <span class="c">! get low speed outlet conditions</span>
<a name="ln-12218"></a>    <span class="n">LSOutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">hDelta</span>
<a name="ln-12219"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-12220"></a>    <span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12221"></a>    <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12222"></a>    <span class="n">LSOutletAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12223"></a>                    <span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:lowspeedoutlet&#39;</span><span class="p">)</span>
<a name="ln-12224"></a>    <span class="n">OutletAirDryBulbTempSat</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12225"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12226"></a>    <span class="c">!    LSOutletAirRH = PsyRhFnTdbWPb(LSOutletAirDryBulbTemp,LSOutletAirHumRat,InletAirPressure)</span>
<a name="ln-12227"></a>    <span class="c">!    OutletAirDryBulbTempSat = PsyTsatFnHPb(LSOutletAirEnthalpy,InletAirPressure)</span>
<a name="ln-12228"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-12229"></a>      <span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-12230"></a>      <span class="n">LSOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12231"></a>    <span class="k">END IF</span>
<a name="ln-12232"></a>
<a name="ln-12233"></a>    <span class="c">!  If constant fan with cycling compressor, call function to determine &quot;effective SHR&quot;</span>
<a name="ln-12234"></a>    <span class="c">!  which includes the part-load degradation on latent capacity</span>
<a name="ln-12235"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12236"></a><span class="k">      </span><span class="n">QLatRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedSHR</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span>
<a name="ln-12237"></a>      <span class="n">QLatActual</span> <span class="o">=</span> <span class="n">TotCapLS</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SHR</span><span class="p">)</span>
<a name="ln-12238"></a>      <span class="n">SHRUnadjusted</span> <span class="o">=</span> <span class="n">SHR</span>
<a name="ln-12239"></a>      <span class="n">SHR</span> <span class="o">=</span> <span class="n">CalcEffectiveSHR</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SHR</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12240"></a>                          <span class="n">QLatRated</span><span class="p">,</span> <span class="n">QLatActual</span><span class="p">,</span> <span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirWetbulbC</span><span class="p">,</span> <span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12241"></a>      <span class="c">! Calculate full load output conditions</span>
<a name="ln-12242"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SHR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHR</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-12243"></a>      <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span><span class="n">hDelta</span>
<a name="ln-12244"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SHR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12245"></a><span class="k">        </span><span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12246"></a>      <span class="k">Else</span>
<a name="ln-12247"></a><span class="k">        </span><span class="n">LSOutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-12248"></a>      <span class="k">End If</span>
<a name="ln-12249"></a><span class="k">      </span><span class="n">LSOutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">LSOutletAirEnthalpy</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12250"></a>    <span class="k">END IF</span>
<a name="ln-12251"></a>
<a name="ln-12252"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PLF</span>
<a name="ln-12253"></a>    <span class="c">! outlet conditions are average of inlet and low speed weighted by CycRatio</span>
<a name="ln-12254"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">LSOutletAirEnthalpy</span>
<a name="ln-12255"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">LSOutletAirHumRat</span>
<a name="ln-12256"></a>    <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">LSOutletAirDryBulbTemp</span>
<a name="ln-12257"></a>    <span class="c">! get low speed EIR at current conditions</span>
<a name="ln-12258"></a>    <span class="n">EIRTempModFacLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">InletAirWetbulbC</span><span class="p">,</span><span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-12259"></a>    <span class="n">EIRFlowModFacLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">AirMassFlowRatioLS</span><span class="p">)</span>
<a name="ln-12260"></a>    <span class="n">EIRLS</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRTempModFacLS</span> <span class="o">*</span> <span class="n">EIRFlowModFacLS</span>
<a name="ln-12261"></a>
<a name="ln-12262"></a>    <span class="c">! get the eletrical power consumption</span>
<a name="ln-12263"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCapLS</span> <span class="o">*</span> <span class="n">EIRLS</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-12264"></a>    <span class="c">! calculate cooling output power</span>
<a name="ln-12265"></a><span class="c">!    AirMassFlow = DXCoil(DXCoilNum)%InletAirMassFlowRate</span>
<a name="ln-12266"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">LSOutletAirEnthalpy</span><span class="p">)</span><span class="o">*</span><span class="n">CycRatio</span>
<a name="ln-12267"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12268"></a><span class="k">      </span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12269"></a>      <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">LSOutletAirHumRat</span><span class="p">)</span>
<a name="ln-12270"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12271"></a>                        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span><span class="o">*</span><span class="n">CycRatio</span>
<a name="ln-12272"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12273"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-12274"></a>      <span class="k">END IF</span>
<a name="ln-12275"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12276"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-12277"></a>      <span class="c">! Calculate avarage outlet conditions</span>
<a name="ln-12278"></a>      <span class="n">Hfg</span> <span class="o">=</span> <span class="n">PsyHfgAirFnWTdb</span><span class="p">(</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">OutletAirDryBulbTemp</span><span class="o">*</span><span class="n">CycRatio</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CycRatio</span><span class="p">)</span><span class="o">*</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="s1">&#39;MultiSpeedCooling &#39;</span><span class="p">)</span>
<a name="ln-12279"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span><span class="o">/</span><span class="n">Hfg</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12280"></a>      <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12281"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutletAirDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutletAirDryBulbTempSat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Limit to saturated conditions at OutletAirEnthalpy</span>
<a name="ln-12282"></a>        <span class="n">OutletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTempSat</span>
<a name="ln-12283"></a>        <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12284"></a>        <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-12285"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12286"></a>          <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span>
<a name="ln-12287"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12288"></a><span class="k">          </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-12289"></a>        <span class="k">END IF</span>
<a name="ln-12290"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12291"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-12292"></a>      <span class="k">END IF</span>
<a name="ln-12293"></a><span class="k">    Else</span>
<a name="ln-12294"></a><span class="k">      </span><span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-12295"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12296"></a>                                                             <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">LSOutletAirDryBulbTemp</span><span class="p">,</span><span class="n">MinAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">))</span><span class="o">*</span><span class="n">CycRatio</span>
<a name="ln-12297"></a>      <span class="c">! Don&#39;t let sensible capacity be greater than total capacity</span>
<a name="ln-12298"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">&gt;</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12299"></a><span class="k">         </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span>
<a name="ln-12300"></a>      <span class="k">END IF</span>
<a name="ln-12301"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12302"></a>                                             <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span>
<a name="ln-12303"></a>    <span class="k">End If</span>
<a name="ln-12304"></a>    <span class="c">!   Calculation for heat reclaim needs to be corrected to use compressor power (not including condenser fan power)</span>
<a name="ln-12305"></a>    <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-12306"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-12307"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-12308"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">OutletAirDryBulbTemp</span>
<a name="ln-12309"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span>  <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondAirFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-12310"></a>    <span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEvapCondPumpElecNomPower</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span>
<a name="ln-12311"></a>
<a name="ln-12312"></a>    <span class="c">! Waste heat</span>
<a name="ln-12313"></a>    <span class="n">MSHPWasteHeat</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12314"></a>                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-12315"></a>
<a name="ln-12316"></a>    <span class="c">! Energy use for other fuel types</span>
<a name="ln-12317"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12318"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-12319"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12320"></a>    <span class="k">End If</span>
<a name="ln-12321"></a>
<a name="ln-12322"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12323"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12324"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12325"></a>    <span class="k">ELSE</span>
<a name="ln-12326"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12327"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12328"></a>                                           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">))</span>
<a name="ln-12329"></a>    <span class="k">END IF</span>
<a name="ln-12330"></a>
<a name="ln-12331"></a><span class="k">  END IF</span>
<a name="ln-12332"></a>
<a name="ln-12333"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">DXMode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12334"></a>  <span class="c">!******************</span>
<a name="ln-12335"></a>  <span class="c">!             WATER CONSUMPTION IN m3 OF WATER FOR DIRECT</span>
<a name="ln-12336"></a>  <span class="c">!             H2O [m3/sec] = Delta W[KgH2O/Kg air]*Mass Flow Air[Kg air]</span>
<a name="ln-12337"></a>  <span class="c">!                                /RhoWater [kg H2O/m3 H2O]</span>
<a name="ln-12338"></a>  <span class="c">!******************</span>
<a name="ln-12339"></a>     <span class="n">RhoWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12340"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span>  <span class="p">(</span><span class="n">CondInletHumrat</span> <span class="o">-</span> <span class="n">OutdoorHumRat</span><span class="p">)</span> <span class="o">*</span>  <span class="n">CondAirMassFlow</span><span class="o">/</span><span class="n">RhoWater</span>
<a name="ln-12341"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">EvapCondPumpElecPower</span>
<a name="ln-12342"></a>     <span class="c">!set water system demand request (if needed)</span>
<a name="ln-12343"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DxCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12344"></a><span class="k">       </span><span class="n">WaterStorage</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-12345"></a>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-12346"></a>     <span class="n">ENDIF</span>
<a name="ln-12347"></a>
<a name="ln-12348"></a>     <span class="c">! Calculate basin heater power</span>
<a name="ln-12349"></a>     <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-12350"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-12351"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-12352"></a>     <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12353"></a>                                      <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12354"></a>  <span class="n">ENDIF</span>
<a name="ln-12355"></a>
<a name="ln-12356"></a><span class="k">ELSE</span>
<a name="ln-12357"></a>
<a name="ln-12358"></a>  <span class="c">! DX coil is off; just pass through conditions</span>
<a name="ln-12359"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-12360"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-12361"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-12362"></a>
<a name="ln-12363"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12364"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12365"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12366"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12367"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12368"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12369"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12370"></a>
<a name="ln-12371"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12372"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span>
<a name="ln-12373"></a>  <span class="k">ELSE</span>
<a name="ln-12374"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12375"></a>                                         <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12376"></a>  <span class="k">END IF</span>
<a name="ln-12377"></a>
<a name="ln-12378"></a>  <span class="c">! Calculate basin heater power</span>
<a name="ln-12379"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="p">(</span><span class="n">DXMode</span><span class="p">)</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12380"></a><span class="k">    CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-12381"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-12382"></a>                              <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-12383"></a>  <span class="n">ENDIF</span>
<a name="ln-12384"></a><span class="k">END IF</span>
<a name="ln-12385"></a>
<a name="ln-12386"></a><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-12387"></a><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-12388"></a><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-12389"></a><span class="n">DXCoilFanOpMode</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>      <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-12390"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">CondInletTemp</span> <span class="c">! Save condenser inlet temp in the data structure</span>
<a name="ln-12391"></a>
<a name="ln-12392"></a><span class="k">RETURN</span>
<a name="ln-12393"></a>
<a name="ln-12394"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMultiSpeedDXCoilCooling</span>
<a name="ln-12395"></a>
<a name="ln-12396"></a><span class="k">SUBROUTINE </span><span class="n">CalcMultiSpeedDXCoilHeating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-12397"></a>
<a name="ln-12398"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12399"></a>          <span class="c">!       AUTHOR         Lixing Gu, FSEC</span>
<a name="ln-12400"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-12401"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12402"></a>          <span class="c">!       RE-ENGINEERED  Revised based on CalcDXHeatingCoil</span>
<a name="ln-12403"></a>
<a name="ln-12404"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12405"></a>          <span class="c">! Calculates the air-side performance and electrical energy use of a direct-</span>
<a name="ln-12406"></a>          <span class="c">! expansion, air-cooled cooling unit with a multispeed compressor.</span>
<a name="ln-12407"></a>
<a name="ln-12408"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12409"></a>          <span class="c">! Uses the same methodology as the single speed DX heating unit model (SUBROUTINE CalcDXHeatingCoil).</span>
<a name="ln-12410"></a>          <span class="c">! In addition it assumes that the unit performance is obtained by interpolating between</span>
<a name="ln-12411"></a>          <span class="c">! the performance at high speed and that at low speed. If the output needed is below</span>
<a name="ln-12412"></a>          <span class="c">! that produced at low speed, the compressor cycles between off and low speed.</span>
<a name="ln-12413"></a>
<a name="ln-12414"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12415"></a><span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-12416"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-12417"></a><span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-12418"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">MSHPMassFlowRateLow</span><span class="p">,</span> <span class="n">MSHPMassFlowRateHigh</span><span class="p">,</span> <span class="n">MSHPWasteHeat</span>
<a name="ln-12419"></a>
<a name="ln-12420"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12421"></a>
<a name="ln-12422"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12423"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DXCoilNum</span>      <span class="c">! the number of the DX heating coil to be simulated</span>
<a name="ln-12424"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>     <span class="c">! = (CompressorSpeed - CompressorSpeedMin) / (CompressorSpeedMax - CompressorSpeedMin)</span>
<a name="ln-12425"></a>                          <span class="c">! SpeedRatio varies between 1.0 (maximum speed) and 0.0 (minimum speed)</span>
<a name="ln-12426"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>       <span class="c">! cycling part load ratio</span>
<a name="ln-12427"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>       <span class="c">! Speed number</span>
<a name="ln-12428"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! Fan operation mode</span>
<a name="ln-12429"></a>
<a name="ln-12430"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12431"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcMultiSpeedDXCoilHeating&#39;</span>
<a name="ln-12432"></a>
<a name="ln-12433"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-12434"></a>          <span class="c">! na</span>
<a name="ln-12435"></a>
<a name="ln-12436"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-12437"></a>          <span class="c">! na</span>
<a name="ln-12438"></a>
<a name="ln-12439"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12440"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>         <span class="c">! dry air mass flow rate through coil [kg/s]</span>
<a name="ln-12441"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirWetBulbC</span>    <span class="c">! wetbulb temperature of inlet air [C]</span>
<a name="ln-12442"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirDryBulbTemp</span> <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-12443"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>    <span class="c">! inlet air enthalpy [J/kg]</span>
<a name="ln-12444"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>      <span class="c">! inlet air humidity ratio [kg/kg]</span>
<a name="ln-12445"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>   <span class="c">! outlet air enthalpy [J/kg]</span>
<a name="ln-12446"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>     <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-12447"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapHS</span>            <span class="c">! total capacity at high speed [W]</span>
<a name="ln-12448"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapLS</span>            <span class="c">! total capacity at low speed [W]</span>
<a name="ln-12449"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRHS</span>               <span class="c">! EIR at off rated conditions (high speed)</span>
<a name="ln-12450"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRLS</span>               <span class="c">! EIR at off rated conditions (low speed)</span>
<a name="ln-12451"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>              <span class="c">! total capacity at current speed [W]</span>
<a name="ln-12452"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span>                 <span class="c">! EIR at current speed</span>
<a name="ln-12453"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>                 <span class="c">! Part load factor, accounts for thermal lag at compressor startup, used in</span>
<a name="ln-12454"></a>                               <span class="c">! power calculation</span>
<a name="ln-12455"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>       <span class="c">! Outdoor dry-bulb temperature at condenser (C)</span>
<a name="ln-12456"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>        <span class="c">! Outdoor humidity ratio at condenser (kg/kg)</span>
<a name="ln-12457"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorPressure</span>      <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-12458"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNumHS</span>           <span class="c">! High speed number</span>
<a name="ln-12459"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNumLS</span>           <span class="c">! Low speed number</span>
<a name="ln-12460"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatioLS</span>   <span class="c">! airflow ratio at low speed</span>
<a name="ln-12461"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatioHS</span>   <span class="c">! airflow ratio at high speed</span>
<a name="ln-12462"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRatio</span>         <span class="c">! Airflow ratio</span>
<a name="ln-12463"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLRHeating</span>           <span class="c">! Part load ratio in heating</span>
<a name="ln-12464"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CrankcaseHeatingPower</span> <span class="c">! Power due to crank case heater</span>
<a name="ln-12465"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVolumeFlowRate</span>    <span class="c">! Air volume flow rate across the heating coil</span>
<a name="ln-12466"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowperRatedTotCap</span> <span class="c">! Air volume flow rate divided by rated total heating capacity</span>
<a name="ln-12467"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>     <span class="c">! Total capacity modifier as a function ot temperature</span>
<a name="ln-12468"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span>     <span class="c">! Total capacity modifier as a function of flow ratio</span>
<a name="ln-12469"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorCoilT</span>         <span class="c">! Outdoor coil temperature</span>
<a name="ln-12470"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorCoildw</span>        <span class="c">! Outdoor coil delta w assuming coil temperature of OutdoorCoilT</span>
<a name="ln-12471"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadDueToDefrost</span>     <span class="c">! Additonal load due to defrost</span>
<a name="ln-12472"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadDueToDefrostLS</span>   <span class="c">! Additonal load due to defrost at low speed</span>
<a name="ln-12473"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadDueToDefrostHS</span>   <span class="c">! Additonal load due to defrost at high speed</span>
<a name="ln-12474"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCapacityMultiplier</span> <span class="c">! Multiplier for heating capacity when system is in defrost</span>
<a name="ln-12475"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FractionalDefrostTime</span> <span class="c">! Fraction of time step when system is in defrost</span>
<a name="ln-12476"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InputPowerMultiplier</span>  <span class="c">! Multiplier for poer when system is in defrost</span>
<a name="ln-12477"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostEIRTempModFac</span> <span class="c">! EIR modifier for defrost</span>
<a name="ln-12478"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span>   <span class="c">! Outlet full load enthalpy</span>
<a name="ln-12479"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span> <span class="c">! Outlet humidity ratio at full load</span>
<a name="ln-12480"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>   <span class="c">! Outlet temperature at full load</span>
<a name="ln-12481"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirRH</span>     <span class="c">! Outler relative humidity at full load</span>
<a name="ln-12482"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>        <span class="c">! Supply ari temperature</span>
<a name="ln-12483"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span>        <span class="c">! EIR modifier as a function of temperature</span>
<a name="ln-12484"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span>        <span class="c">! EIR modifier as a function of airflow ratio</span>
<a name="ln-12485"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WasteHeatLS</span>          <span class="c">! Waste heat at low speed</span>
<a name="ln-12486"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WasteHeatHS</span>          <span class="c">! Waste heat at high speed</span>
<a name="ln-12487"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSFullLoadOutAirEnth</span> <span class="c">! Outlet full load enthalpy at low speed</span>
<a name="ln-12488"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSFullLoadOutAirEnth</span> <span class="c">! Outlet full load enthalpy at high speed</span>
<a name="ln-12489"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSElecHeatingPower</span>   <span class="c">! Full load power at low speed</span>
<a name="ln-12490"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSElecHeatingPower</span>   <span class="c">! Full load power at high speed</span>
<a name="ln-12491"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostPowerLS</span>       <span class="c">! Defrost power at low speed [W]</span>
<a name="ln-12492"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefrostPowerHS</span>       <span class="c">! Defrost power at high speed [W]</span>
<a name="ln-12493"></a>
<a name="ln-12494"></a><span class="c">! FLOW</span>
<a name="ln-12495"></a><span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12496"></a><span class="k">   </span><span class="n">SpeedNumLS</span> <span class="o">=</span> <span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-12497"></a>   <span class="n">SpeedNumHS</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-12498"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12499"></a><span class="k">    </span><span class="n">SpeedNumLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-12500"></a>    <span class="n">SpeedNumHS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-12501"></a>  <span class="k">End If</span>
<a name="ln-12502"></a><span class="k">Else</span>
<a name="ln-12503"></a><span class="k">  </span><span class="n">SpeedNumLS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12504"></a>  <span class="n">SpeedNumHS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12505"></a><span class="k">End If</span>
<a name="ln-12506"></a>
<a name="ln-12507"></a><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12508"></a><span class="n">AirMassFlowRatioLS</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12509"></a><span class="n">AirMassFlowRatioHS</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12510"></a>
<a name="ln-12511"></a><span class="n">AirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12512"></a><span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">MSHPWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12513"></a>
<a name="ln-12514"></a><span class="c">! Get condenser outdoor node info from DX Heating Coil</span>
<a name="ln-12515"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12516"></a><span class="k">  </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Press</span>
<a name="ln-12517"></a>  <span class="c">! If node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-12518"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12519"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-12520"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-12521"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-12522"></a>  <span class="k">ELSE</span>
<a name="ln-12523"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Temp</span>
<a name="ln-12524"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">HumRat</span>
<a name="ln-12525"></a>  <span class="k">END IF</span>
<a name="ln-12526"></a><span class="k">ELSE</span>
<a name="ln-12527"></a><span class="k">  </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-12528"></a>  <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-12529"></a>  <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-12530"></a><span class="n">ENDIF</span>
<a name="ln-12531"></a>
<a name="ln-12532"></a><span class="n">InletAirDryBulbTemp</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-12533"></a><span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-12534"></a><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-12535"></a><span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12536"></a><span class="c">!InletAirPressure = DXCoil(DXCoilNum)%InletAirPressure</span>
<a name="ln-12537"></a><span class="c">!InletAirWetbulbC = PsyTwbFnTdbWPb(InletAirDryBulbTemp,InletAirHumRat,InletAirPressure)</span>
<a name="ln-12538"></a><span class="n">InletAirWetbulbC</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12539"></a><span class="n">PLRHeating</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12540"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12541"></a><span class="c">! Initialize crankcase heater, operates below OAT defined in input deck for HP DX heating coil</span>
<a name="ln-12542"></a><span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12543"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span>
<a name="ln-12544"></a><span class="k">ELSE</span>
<a name="ln-12545"></a><span class="k">  </span><span class="n">CrankcaseHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12546"></a><span class="k">END IF</span>
<a name="ln-12547"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12548"></a><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AvailCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12549"></a>
<a name="ln-12550"></a><span class="k">IF</span><span class="p">((</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12551"></a>   <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12552"></a>   <span class="p">((</span><span class="n">CycRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12553"></a>
<a name="ln-12554"></a><span class="k">  If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12555"></a>
<a name="ln-12556"></a>    <span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 600 cfm/ton) at low speed</span>
<a name="ln-12557"></a>    <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12558"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12559"></a>    <span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-12560"></a>    <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12561"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12562"></a>        <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-12563"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12564"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12565"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out of range at speed &#39;</span> <span class="p">&amp;</span>
<a name="ln-12566"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12567"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12568"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12569"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12570"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-12571"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-12572"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-12573"></a>      <span class="k">END IF</span>
<a name="ln-12574"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12575"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12576"></a>         <span class="s1">&#39;of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;error continues...&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12577"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-12578"></a>    <span class="k">END IF</span>
<a name="ln-12579"></a>
<a name="ln-12580"></a>    <span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 600 cfm/ton) at high speed</span>
<a name="ln-12581"></a>    <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12582"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12583"></a>    <span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-12584"></a>    <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12585"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12586"></a>        <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-12587"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12588"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12589"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out of range at speed &#39;</span> <span class="p">&amp;</span>
<a name="ln-12590"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12591"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12592"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12593"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12594"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-12595"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-12596"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-12597"></a>      <span class="k">END IF</span>
<a name="ln-12598"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12599"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12600"></a>         <span class="s1">&#39;of range at speed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;error continues...&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12601"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSErrIndex</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-12602"></a>    <span class="k">END IF</span>
<a name="ln-12603"></a>
<a name="ln-12604"></a>    <span class="c">! Get total capacity modifying factor (function of temperature) for off-rated conditions</span>
<a name="ln-12605"></a>    <span class="c">! Model was extended to accept bi-quadratic curves. This allows sensitivity of the heating capacity</span>
<a name="ln-12606"></a>    <span class="c">! to the entering dry-bulb temperature as well as the outside dry-bulb temperature. User is</span>
<a name="ln-12607"></a>    <span class="c">! advised to use the bi-quaratic curve if sufficient manufacturer data is available.</span>
<a name="ln-12608"></a>    <span class="c">! Low speed</span>
<a name="ln-12609"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12610"></a>      <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12611"></a><span class="k">        </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12612"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12613"></a><span class="k">      </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12614"></a>    <span class="k">END IF</span>
<a name="ln-12615"></a>    <span class="c">!  Get total capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-12616"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">AirMassFlowRatioLS</span><span class="p">)</span>
<a name="ln-12617"></a>    <span class="c">! Calculate total heating capacity for off-rated conditions</span>
<a name="ln-12618"></a>    <span class="n">TotCapLS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-12619"></a>    <span class="c">! High speed</span>
<a name="ln-12620"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12621"></a>      <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12622"></a><span class="k">        </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12623"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12624"></a><span class="k">      </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12625"></a>    <span class="k">END IF</span>
<a name="ln-12626"></a>    <span class="c">!  Get total capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-12627"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">AirMassFlowRatioHS</span><span class="p">)</span>
<a name="ln-12628"></a>    <span class="c">! Calculate total heating capacity for off-rated conditions</span>
<a name="ln-12629"></a>    <span class="n">TotCapHS</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-12630"></a>    <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-12631"></a>    <span class="c">! Model was extended to accept bi-quadratic curves. This allows sensitivity of the EIR</span>
<a name="ln-12632"></a>    <span class="c">! to the entering dry-bulb temperature as well as the outside dry-bulb temperature. User is</span>
<a name="ln-12633"></a>    <span class="c">! advised to use the bi-quaratic curve if sufficient manufacturer data is available.</span>
<a name="ln-12634"></a>    <span class="c">! Low Speed</span>
<a name="ln-12635"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12636"></a>       <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12637"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12638"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12639"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12640"></a>    <span class="k">END IF</span>
<a name="ln-12641"></a><span class="k">    </span><span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span> <span class="n">AirMassFlowRatioLS</span><span class="p">)</span>
<a name="ln-12642"></a>    <span class="n">EIRLS</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span>
<a name="ln-12643"></a>    <span class="c">! High Speed</span>
<a name="ln-12644"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12645"></a>       <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12646"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12647"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12648"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12649"></a>    <span class="k">END IF</span>
<a name="ln-12650"></a><span class="k">    </span><span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span> <span class="n">AirMassFlowRatioHS</span><span class="p">)</span>
<a name="ln-12651"></a>    <span class="n">EIRHS</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span>
<a name="ln-12652"></a>
<a name="ln-12653"></a>    <span class="c">! Calculating adjustment factors for defrost</span>
<a name="ln-12654"></a>    <span class="c">! Calculate delta w through outdoor coil by assuming a coil temp of 0.82*DBT-9.7(F) per DOE2.1E</span>
<a name="ln-12655"></a>    <span class="n">OutdoorCoilT</span> <span class="o">=</span> <span class="mf">0.82d0</span> <span class="o">*</span> <span class="n">OutdoorDryBulb</span> <span class="o">-</span> <span class="mf">8.589d0</span>
<a name="ln-12656"></a>    <span class="n">OutdoorCoildw</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">1.0d-6</span><span class="p">,(</span><span class="n">OutdoorHumRat</span> <span class="o">-</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">OutdoorCoilT</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)))</span>
<a name="ln-12657"></a>
<a name="ln-12658"></a>    <span class="c">! Initializing defrost adjustment factors</span>
<a name="ln-12659"></a>    <span class="n">LoadDueToDefrostLS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12660"></a>    <span class="n">LoadDueToDefrostHS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12661"></a>    <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12662"></a>    <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12663"></a>    <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12664"></a>    <span class="n">DefrostPowerLS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12665"></a>    <span class="n">DefrostPowerHS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12666"></a>
<a name="ln-12667"></a>    <span class="c">! Check outdoor temperature to determine of defrost is active</span>
<a name="ln-12668"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12669"></a>      <span class="c">! Calculate defrost adjustment factors depending on defrost control type</span>
<a name="ln-12670"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Timed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12671"></a><span class="k">        </span><span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span>
<a name="ln-12672"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12673"></a><span class="k">          </span><span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.909d0</span> <span class="o">-</span> <span class="mi">10</span><span class="mf">7.33d0</span> <span class="o">*</span> <span class="n">OutdoorCoildw</span>
<a name="ln-12674"></a>          <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.90d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">6.45d0</span><span class="o">*</span><span class="n">OutdoorCoildw</span>
<a name="ln-12675"></a>        <span class="k">END IF</span>
<a name="ln-12676"></a><span class="k">      ELSE</span> <span class="c">!else defrost control is on-demand</span>
<a name="ln-12677"></a>        <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.01446d0</span> <span class="o">/</span> <span class="n">OutdoorCoildw</span><span class="p">)</span>
<a name="ln-12678"></a>        <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.875d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-12679"></a>        <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.954d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-12680"></a>      <span class="k">END IF</span>
<a name="ln-12681"></a>
<a name="ln-12682"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12683"></a>        <span class="c">! Calculate defrost adjustment factors depending on defrost control strategy</span>
<a name="ln-12684"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ReverseCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12685"></a><span class="k">          </span><span class="n">DefrostEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">,&amp;</span>
<a name="ln-12686"></a>                                <span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">),</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">))</span>
<a name="ln-12687"></a>          <span class="n">LoadDueToDefrostLS</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01d0</span> <span class="o">*</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">7.222d0</span> <span class="o">-</span> <span class="n">OutdoorDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12688"></a>                            <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span>
<a name="ln-12689"></a>          <span class="n">DefrostPowerLS</span> <span class="o">=</span>  <span class="n">DefrostEIRTempModFac</span> <span class="o">*</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span><span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-12690"></a>          <span class="n">LoadDueToDefrostHS</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01d0</span> <span class="o">*</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">7.222d0</span> <span class="o">-</span> <span class="n">OutdoorDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12691"></a>                            <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span>
<a name="ln-12692"></a>          <span class="n">DefrostPowerHS</span> <span class="o">=</span>  <span class="n">DefrostEIRTempModFac</span> <span class="o">*</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span><span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-12693"></a>        <span class="k">ELSE</span> <span class="c">! Defrost strategy is resistive</span>
<a name="ln-12694"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">&amp;</span>
<a name="ln-12695"></a>                                          <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-12696"></a>        <span class="k">END IF</span>
<a name="ln-12697"></a><span class="k">      ELSE</span> <span class="c">! Defrost is not active because (OutDryBulbTemp .GT. DXCoil(DXCoilNum)%MaxOATDefrost)</span>
<a name="ln-12698"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-12699"></a>      <span class="k">END IF</span>
<a name="ln-12700"></a><span class="k">    END IF</span>
<a name="ln-12701"></a>
<a name="ln-12702"></a><span class="k">    </span><span class="n">TotCapLS</span> <span class="o">=</span> <span class="n">TotCapLS</span><span class="o">*</span><span class="n">HeatingCapacityMultiplier</span>
<a name="ln-12703"></a>    <span class="n">TotCapHS</span> <span class="o">=</span> <span class="n">TotCapHS</span><span class="o">*</span><span class="n">HeatingCapacityMultiplier</span>
<a name="ln-12704"></a>
<a name="ln-12705"></a>    <span class="c">! Calculate modified PartLoadRatio due to defrost (reverse-cycle defrost only)</span>
<a name="ln-12706"></a>    <span class="n">PLRHeating</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="n">LoadDueToDefrostHS</span><span class="o">/</span><span class="n">TotCapHS</span><span class="p">))</span>
<a name="ln-12707"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">PLRHeating</span><span class="p">)</span> <span class="c">! Calculate part-load factor</span>
<a name="ln-12708"></a>
<a name="ln-12709"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12710"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PlrErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12711"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The PLF curve value at high speed for DX multispeed heating coil &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12712"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12713"></a>           <span class="s1">&#39; for part-load ratio =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLRHeating</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-12714"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;PLF curve values must be &gt;= 0.7. PLF has been reset to 0.7 and simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-12715"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Heating:DX:MultiSpeed].&#39;</span><span class="p">)</span>
<a name="ln-12716"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12717"></a>      <span class="k">END IF</span>
<a name="ln-12718"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;DX heating coil PLF curve &lt; 0.7 warning continues... &#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12719"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PlrErrIndex</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">PLF</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">PLF</span><span class="p">)</span>
<a name="ln-12720"></a>      <span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-12721"></a>    <span class="k">END IF</span>
<a name="ln-12722"></a>
<a name="ln-12723"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">PLRHeating</span> <span class="o">/</span> <span class="n">PLF</span><span class="p">)</span>
<a name="ln-12724"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-12725"></a>        <span class="nb">ABS</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12726"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12727"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The runtime fraction at high speed for DX multispeed heating coil &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12728"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12729"></a>           <span class="s1">&#39; exceeded 1.0. [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-12730"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Runtime fraction is set to 1.0 and the simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-12731"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Heating:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-12732"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12733"></a>      <span class="k">END IF</span>
<a name="ln-12734"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-12735"></a>                   <span class="s1">&#39;, DX heating coil runtime fraction &gt; 1.0 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12736"></a>           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex4</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12737"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-12738"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12739"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-12740"></a>    <span class="k">END IF</span>
<a name="ln-12741"></a>
<a name="ln-12742"></a>    <span class="c">! Get full load output and power</span>
<a name="ln-12743"></a>    <span class="n">LSFullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">+</span> <span class="n">TotCapLS</span><span class="o">/</span><span class="n">MSHPMassFlowRateLow</span>
<a name="ln-12744"></a>    <span class="n">HSFullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">+</span> <span class="n">TotCapHS</span><span class="o">/</span><span class="n">MSHPMassFlowRateHigh</span>
<a name="ln-12745"></a>    <span class="n">LSElecHeatingPower</span> <span class="o">=</span> <span class="n">TotCapLS</span><span class="o">*</span><span class="n">EIRLS</span><span class="o">*</span><span class="n">InputPowerMultiplier</span>
<a name="ln-12746"></a>    <span class="n">HSElecHeatingPower</span> <span class="o">=</span> <span class="n">TotCapHS</span><span class="o">*</span><span class="n">EIRHS</span><span class="o">*</span><span class="n">InputPowerMultiplier</span>
<a name="ln-12747"></a>    <span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-12748"></a>
<a name="ln-12749"></a>    <span class="c">! if cycling fan, send coil part-load fraction to on/off fan via HVACDataGlobals</span>
<a name="ln-12750"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12751"></a>
<a name="ln-12752"></a>    <span class="c">! Power calculation</span>
<a name="ln-12753"></a>    <span class="k">If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12754"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">HSElecHeatingPower</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">LSElecHeatingPower</span>
<a name="ln-12755"></a>    <span class="k">Else</span>
<a name="ln-12756"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="o">*</span><span class="n">HSElecHeatingPower</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12757"></a>                   <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span><span class="o">*</span><span class="n">LSElecHeatingPower</span>
<a name="ln-12758"></a>    <span class="k">End If</span>
<a name="ln-12759"></a>
<a name="ln-12760"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateHigh</span><span class="o">*</span><span class="p">(</span><span class="n">HSFullLoadOutAirEnth</span><span class="o">-</span><span class="n">InletAirEnthalpy</span><span class="p">)</span><span class="o">*</span><span class="n">SpeedRatio</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12761"></a>                                               <span class="n">MSHPMassFlowRateLow</span><span class="o">*</span><span class="p">(</span><span class="n">LSFullLoadOutAirEnth</span><span class="o">-</span><span class="n">InletAirEnthalpy</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-12762"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12763"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12764"></a>    <span class="n">FullLoadOutAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:Averageload&#39;</span><span class="p">)</span>
<a name="ln-12765"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadOutAirRH</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Limit to saturated conditions at FullLoadOutAirEnth</span>
<a name="ln-12766"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12767"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12768"></a>    <span class="k">END IF</span>
<a name="ln-12769"></a>
<a name="ln-12770"></a>    <span class="c">! Waste heat calculation</span>
<a name="ln-12771"></a>    <span class="n">WasteHeatLS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12772"></a>                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12773"></a>    <span class="n">WasteHeatHS</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12774"></a>                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedNumHS</span><span class="p">)</span>
<a name="ln-12775"></a>    <span class="n">MSHPWasteHeat</span> <span class="o">=</span> <span class="p">(</span><span class="n">SpeedRatio</span><span class="o">*</span><span class="n">WasteHeatHS</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">WasteHeatLS</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span>
<a name="ln-12776"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12777"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span>
<a name="ln-12778"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12779"></a>    <span class="k">End If</span>
<a name="ln-12780"></a>
<a name="ln-12781"></a>    <span class="c">! Adjust defrost power to correct for DOE-2 bug where defrost power is constant regardless of compressor runtime fraction</span>
<a name="ln-12782"></a>    <span class="c">! Defrosts happen based on compressor run time (frost buildup on outdoor coil), not total elapsed time.</span>
<a name="ln-12783"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ReverseCycle</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12784"></a><span class="k">      If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRImpact</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12785"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DefrostPowerHS</span> <span class="o">*</span> <span class="n">SpeedRatio</span> <span class="o">+</span> <span class="n">DefrostPowerLS</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-12786"></a>      <span class="k">Else</span>
<a name="ln-12787"></a><span class="k">        </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DefrostPowerHS</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12788"></a>                                         <span class="n">DefrostPowerLS</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12789"></a>      <span class="k">End If</span>
<a name="ln-12790"></a><span class="k">    End If</span>
<a name="ln-12791"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">OutletAirTemp</span>
<a name="ln-12792"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-12793"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-12794"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12795"></a>
<a name="ln-12796"></a>  <span class="c">! Stage 1</span>
<a name="ln-12797"></a>  <span class="k">Else If</span> <span class="p">(</span><span class="n">CycRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12798"></a>
<a name="ln-12799"></a>    <span class="c">! for cycling fan, reset mass flow to full on rate</span>
<a name="ln-12800"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">/</span> <span class="n">CycRatio</span>
<a name="ln-12801"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">MSHPMassFlowRateLow</span>
<a name="ln-12802"></a>    <span class="c">!</span>
<a name="ln-12803"></a>    <span class="c">! Check for valid air volume flow per rated total cooling capacity (200 - 600 cfm/ton)</span>
<a name="ln-12804"></a>    <span class="c">!</span>
<a name="ln-12805"></a>    <span class="n">AirVolumeFlowRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span> <span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12806"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12807"></a>    <span class="c">!  AirVolumeFlowRate = AirMassFlow/PsyRhoAirFnPbTdbW(InletAirPressure,InletAirDryBulbTemp, InletAirHumRat)</span>
<a name="ln-12808"></a>    <span class="n">VolFlowperRatedTotCap</span> <span class="o">=</span> <span class="n">AirVolumeFlowRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span>
<a name="ln-12809"></a>
<a name="ln-12810"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12811"></a>        <span class="p">(</span><span class="n">VolFlowperRatedTotCap</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-12812"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12813"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12814"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out of range at speed 1.&#39;</span><span class="p">)</span>
<a name="ln-12815"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12816"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Expected range for VolumeFlowPerRatedTotalCapacity=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12817"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinOperVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;--&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12818"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHeatVolFlowPerRatedTotCap</span><span class="p">(</span><span class="n">DXCT</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-12819"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Possible causes include inconsistent air flow rates in system components or&#39;</span><span class="p">)</span>
<a name="ln-12820"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inconsistent supply air fan operation modes in coil and unitary system objects.&#39;</span><span class="p">)</span>
<a name="ln-12821"></a>      <span class="k">END IF</span>
<a name="ln-12822"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12823"></a>          <span class="s1">&#39;&quot; - Air volume flow rate per watt of rated total heating capacity is out &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12824"></a>          <span class="s1">&#39;of range error continues at speed 1...&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-12825"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex1</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">VolFlowperRatedTotCap</span><span class="p">)</span>
<a name="ln-12826"></a>    <span class="k">END IF</span>
<a name="ln-12827"></a>
<a name="ln-12828"></a>    <span class="c">! Get total capacity modifying factor (function of temperature) for off-rated conditions</span>
<a name="ln-12829"></a>    <span class="c">! Model was extended to accept bi-quadratic curves. This allows sensitivity of the heating capacity</span>
<a name="ln-12830"></a>    <span class="c">! to the entering dry-bulb temperature as well as the outside dry-bulb temperature. User is</span>
<a name="ln-12831"></a>    <span class="c">! advised to use the bi-quaratic curve if sufficient manufacturer data is available.</span>
<a name="ln-12832"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12833"></a>       <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12834"></a><span class="k">      </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12835"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSTotCapTempModFacCurveType</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12836"></a><span class="k">      </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFTemp</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12837"></a>    <span class="k">END IF</span>
<a name="ln-12838"></a>
<a name="ln-12839"></a>    <span class="c">!  Get total capacity modifying factor (function of mass flow) for off-rated conditions</span>
<a name="ln-12840"></a><span class="c">!    AirMassFlowRatio = AirMassFlow/DXCoil(DXCoilNum)%MSRatedAirMassFlowRate(SpeedNumLS)</span>
<a name="ln-12841"></a><span class="c">!    TotCapFlowModFac = CurveValue(DXCoil(DXCoilNum)%MSCCapFFlow(SpeedNumLS),AirMassFlowRatio)</span>
<a name="ln-12842"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSCCapFFlow</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">AirMassFlowRatioLS</span><span class="p">)</span>
<a name="ln-12843"></a>    <span class="c">! Calculate total heating capacity for off-rated conditions</span>
<a name="ln-12844"></a>    <span class="n">TotCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span>
<a name="ln-12845"></a>
<a name="ln-12846"></a>    <span class="c">! Calculating adjustment factors for defrost</span>
<a name="ln-12847"></a>    <span class="c">! Calculate delta w through outdoor coil by assuming a coil temp of 0.82*DBT-9.7(F) per DOE2.1E</span>
<a name="ln-12848"></a>    <span class="n">OutdoorCoilT</span> <span class="o">=</span> <span class="mf">0.82d0</span> <span class="o">*</span> <span class="n">OutdoorDryBulb</span> <span class="o">-</span> <span class="mf">8.589d0</span>
<a name="ln-12849"></a>    <span class="n">OutdoorCoildw</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">1.0d-6</span><span class="p">,(</span><span class="n">OutdoorHumRat</span> <span class="o">-</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">OutdoorCoilT</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)))</span>
<a name="ln-12850"></a>
<a name="ln-12851"></a>    <span class="c">! Initializing defrost adjustment factors</span>
<a name="ln-12852"></a>    <span class="n">LoadDueToDefrost</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12853"></a>    <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12854"></a>    <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12855"></a>    <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12856"></a>
<a name="ln-12857"></a>    <span class="c">! Check outdoor temperature to determine of defrost is active</span>
<a name="ln-12858"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12859"></a>      <span class="c">! Calculate defrost adjustment factors depending on defrost control type</span>
<a name="ln-12860"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Timed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12861"></a><span class="k">        </span><span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span>
<a name="ln-12862"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12863"></a><span class="k">          </span><span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.909d0</span> <span class="o">-</span> <span class="mi">10</span><span class="mf">7.33d0</span> <span class="o">*</span> <span class="n">OutdoorCoildw</span>
<a name="ln-12864"></a>          <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.90d0</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">6.45d0</span><span class="o">*</span><span class="n">OutdoorCoildw</span>
<a name="ln-12865"></a>        <span class="k">END IF</span>
<a name="ln-12866"></a><span class="k">      ELSE</span> <span class="c">!else defrost control is on-demand</span>
<a name="ln-12867"></a>        <span class="n">FractionalDefrostTime</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.01446d0</span> <span class="o">/</span> <span class="n">OutdoorCoildw</span><span class="p">)</span>
<a name="ln-12868"></a>        <span class="n">HeatingCapacityMultiplier</span> <span class="o">=</span> <span class="mf">0.875d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-12869"></a>        <span class="n">InputPowerMultiplier</span> <span class="o">=</span> <span class="mf">0.954d0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span>
<a name="ln-12870"></a>      <span class="k">END IF</span>
<a name="ln-12871"></a>
<a name="ln-12872"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FractionalDefrostTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12873"></a>        <span class="c">! Calculate defrost adjustment factors depending on defrost control strategy</span>
<a name="ln-12874"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ReverseCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12875"></a><span class="k">          </span><span class="n">LoadDueToDefrost</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01d0</span> <span class="o">*</span> <span class="n">FractionalDefrostTime</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12876"></a>                            <span class="p">(</span><span class="mf">7.222d0</span> <span class="o">-</span> <span class="n">OutdoorDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12877"></a>                            <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span>
<a name="ln-12878"></a>          <span class="n">DefrostEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="p">,&amp;</span>
<a name="ln-12879"></a>                                <span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">InletAirWetbulbC</span><span class="p">),</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.555d0</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">))</span>
<a name="ln-12880"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="n">DefrostEIRTempModFac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12881"></a>                                           <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">1.01667d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-12882"></a>                                           <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-12883"></a>        <span class="k">ELSE</span> <span class="c">! Defrost strategy is resistive</span>
<a name="ln-12884"></a>          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span> <span class="p">&amp;</span>
<a name="ln-12885"></a>                                          <span class="o">*</span> <span class="n">FractionalDefrostTime</span>
<a name="ln-12886"></a>        <span class="k">END IF</span>
<a name="ln-12887"></a><span class="k">      ELSE</span> <span class="c">! Defrost is not active because (OutDryBulbTemp .GT. DXCoil(DXCoilNum)%MaxOATDefrost)</span>
<a name="ln-12888"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-12889"></a>      <span class="k">END IF</span>
<a name="ln-12890"></a><span class="k">    END IF</span>
<a name="ln-12891"></a>
<a name="ln-12892"></a>    <span class="c">! Modify total heating capacity based on defrost heating capacity multiplier</span>
<a name="ln-12893"></a>    <span class="n">TotCap</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">HeatingCapacityMultiplier</span>
<a name="ln-12894"></a>
<a name="ln-12895"></a>    <span class="c">! Calculate full load outlet conditions</span>
<a name="ln-12896"></a>    <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">+</span> <span class="n">TotCap</span><span class="o">/</span><span class="n">AirMassFlow</span>
<a name="ln-12897"></a>    <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-12898"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12899"></a>    <span class="n">FullLoadOutAirRH</span> <span class="o">=</span> <span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:fullload&#39;</span><span class="p">)</span>
<a name="ln-12900"></a>    <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12901"></a>    <span class="c">!  FullLoadOutAirRH = PsyRhFnTdbWPb(FullLoadOutAirTemp,FullLoadOutAirHumRat,InletAirPressure)</span>
<a name="ln-12902"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadOutAirRH</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Limit to saturated conditions at FullLoadOutAirEnth</span>
<a name="ln-12903"></a>      <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutdoorPressure</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12904"></a>      <span class="c">!  Eventually inlet air conditions will be used in DX Coil, these lines are commented out and marked with this comment line</span>
<a name="ln-12905"></a>      <span class="c">!  FullLoadOutAirTemp = PsyTsatFnHPb(FullLoadOutAirEnth,InletAirPressure)</span>
<a name="ln-12906"></a>      <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12907"></a>    <span class="k">END IF</span>
<a name="ln-12908"></a>
<a name="ln-12909"></a>    <span class="c">! Set outlet conditions from the full load calculation</span>
<a name="ln-12910"></a>    <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">FullLoadOutAirEnth</span>
<a name="ln-12911"></a>    <span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">FullLoadOutAirHumRat</span>
<a name="ln-12912"></a>    <span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">FullLoadOutAirTemp</span>
<a name="ln-12913"></a>    <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-12914"></a>    <span class="c">! Model was extended to accept bi-quadratic curves. This allows sensitivity of the EIR</span>
<a name="ln-12915"></a>    <span class="c">! to the entering dry-bulb temperature as well as the outside dry-bulb temperature. User is</span>
<a name="ln-12916"></a>    <span class="c">! advised to use the bi-quaratic curve if sufficient manufacturer data is available.</span>
<a name="ln-12917"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Quadratic</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-12918"></a>        <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Cubic</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12919"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12920"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRTempModFacCurveType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Biquadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12921"></a><span class="k">      </span><span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">InletAirDryBulbTemp</span><span class="p">,</span><span class="n">OutdoorDryBulb</span><span class="p">)</span>
<a name="ln-12922"></a>    <span class="k">END IF</span>
<a name="ln-12923"></a><span class="k">    </span><span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSEIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">AirMassFlowRatioLS</span><span class="p">)</span>
<a name="ln-12924"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSRatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span>
<a name="ln-12925"></a>    <span class="c">! Calculate modified PartLoadRatio due to defrost (reverse-cycle defrost only)</span>
<a name="ln-12926"></a>    <span class="n">PLRHeating</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">CycRatio</span> <span class="o">+</span> <span class="n">LoadDueToDefrost</span><span class="o">/</span><span class="n">TotCap</span><span class="p">))</span>
<a name="ln-12927"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSPLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">PLRHeating</span><span class="p">)</span> <span class="c">! Calculate part-load factor</span>
<a name="ln-12928"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CycRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PLF</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12929"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12930"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The PLF curve value for DX heating coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12931"></a>                         <span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for part-load ratio = 1&#39;</span><span class="p">)</span>
<a name="ln-12932"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;PLF curve value must be = 1.0 and has been reset to 1.0. Simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-12933"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12934"></a>      <span class="k">END IF</span>
<a name="ln-12935"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12936"></a>          <span class="s1">&#39; DX heating coil PLF curve value &lt;&gt; 1.0 warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12937"></a>          <span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFErrIndex</span><span class="p">,</span> <span class="n">PLF</span><span class="p">,</span> <span class="n">PLF</span><span class="p">)</span>
<a name="ln-12938"></a>      <span class="n">PLF</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12939"></a>    <span class="k">END IF</span>
<a name="ln-12940"></a>
<a name="ln-12941"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12942"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRErrIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12943"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The PLF curve value for DX heating coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12944"></a>                         <span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLF</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-12945"></a>                         <span class="s1">&#39; for part-load ratio =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLRHeating</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-12946"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;PLF curve values must be &gt;= 0.7. PLF has been reset to 0.7 and simulation is continuing.&#39;</span><span class="p">)</span>
<a name="ln-12947"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Heating:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-12948"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12949"></a>      <span class="k">END IF</span>
<a name="ln-12950"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;DX heating coil PLF curve &lt; 0.7 warning continues... &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-12951"></a>        <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLRErrIndex</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">PLF</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">PLF</span><span class="p">)</span>
<a name="ln-12952"></a>      <span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-12953"></a>    <span class="k">END IF</span>
<a name="ln-12954"></a>
<a name="ln-12955"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">PLRHeating</span> <span class="o">/</span> <span class="n">PLF</span><span class="p">)</span>
<a name="ln-12956"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-12957"></a>        <span class="nb">ABS</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12958"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12959"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;The runtime fraction for DX heating coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12960"></a>                         <span class="s1">&#39; exceeded 1.0. [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-12961"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Runtime fraction is set to 1.0 and the simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-12962"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the IO reference manual for PLF curve guidance [Coil:Heating:DX:SingleSpeed].&#39;</span><span class="p">)</span>
<a name="ln-12963"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-12964"></a>      <span class="k">END IF</span>
<a name="ln-12965"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>              <span class="p">&amp;</span>
<a name="ln-12966"></a>                   <span class="s1">&#39;, DX heating coil runtime fraction &gt; 1.0 warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12967"></a>           <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ErrIndex4</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12968"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-12969"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12970"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Reset coil runtime fraction to 1.0</span>
<a name="ln-12971"></a>    <span class="k">END IF</span>
<a name="ln-12972"></a>    <span class="c">! if cycling fan, send coil part-load fraction to on/off fan via HVACDataGlobals</span>
<a name="ln-12973"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PLF</span>
<a name="ln-12974"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span> <span class="o">*</span> <span class="n">InputPowerMultiplier</span>
<a name="ln-12975"></a>
<a name="ln-12976"></a>    <span class="c">! Calculate crankcase heater power using the runtime fraction for this DX heating coil only if there is no companion DX coil.</span>
<a name="ln-12977"></a>    <span class="c">! Else use the largest runtime fraction of this DX heating coil and the companion DX cooling coil.</span>
<a name="ln-12978"></a>
<a name="ln-12979"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12980"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12981"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-12982"></a>    <span class="k">ELSE</span>
<a name="ln-12983"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12984"></a>                                           <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12985"></a>                                          <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">))</span>
<a name="ln-12986"></a>    <span class="k">END IF</span>
<a name="ln-12987"></a>
<a name="ln-12988"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">FullLoadOutAirEnth</span> <span class="o">-</span> <span class="n">InletAirEnthalpy</span><span class="p">)</span><span class="o">*</span><span class="n">CycRatio</span>
<a name="ln-12989"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12990"></a><span class="k">      </span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span><span class="o">+</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="o">/</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-12991"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-12992"></a>    <span class="k">END IF</span>
<a name="ln-12993"></a><span class="k">    </span><span class="n">MSHPWasteHeat</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeat</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">),</span><span class="n">OutdoorDryBulb</span><span class="p">,</span><span class="n">InletAirDryBulbTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12994"></a>                  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MSWasteHeatFrac</span><span class="p">(</span><span class="n">SpeedNumLS</span><span class="p">)</span><span class="o">*</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span>
<a name="ln-12995"></a>
<a name="ln-12996"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-12997"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span>
<a name="ln-12998"></a>      <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12999"></a>    <span class="k">End If</span>
<a name="ln-13000"></a>    <span class="c">! Adjust defrost power to correct for DOE-2 bug where defrost power is constant regardless of compressor runtime fraction</span>
<a name="ln-13001"></a>    <span class="c">! Defrosts happen based on compressor run time (frost buildup on outdoor coil), not total elapsed time.</span>
<a name="ln-13002"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span>
<a name="ln-13003"></a>
<a name="ln-13004"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">OutletAirTemp</span>
<a name="ln-13005"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-13006"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-13007"></a>  <span class="k">End If</span>
<a name="ln-13008"></a>
<a name="ln-13009"></a><span class="k">ELSE</span>
<a name="ln-13010"></a>
<a name="ln-13011"></a>  <span class="c">! DX coil is off; just pass through conditions</span>
<a name="ln-13012"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-13013"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-13014"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-13015"></a>
<a name="ln-13016"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13017"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13018"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13019"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13020"></a>
<a name="ln-13021"></a><span class="c">! Calculate crankcase heater power using the runtime fraction for this DX heating coil (here DXHeatingCoilRTF=0) if</span>
<a name="ln-13022"></a><span class="c">! there is no companion DX coil, or the runtime fraction of the companion DX cooling coil (here DXCoolingCoilRTF&gt;=0).</span>
<a name="ln-13023"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13024"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span>
<a name="ln-13025"></a>  <span class="k">ELSE</span>
<a name="ln-13026"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span> <span class="o">=</span> <span class="n">CrankcaseHeatingPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-13027"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CompanionUpstreamDXCoil</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-13028"></a>  <span class="k">END IF</span>
<a name="ln-13029"></a>
<a name="ln-13030"></a><span class="k">END IF</span> <span class="c">! end of on/off if - else</span>
<a name="ln-13031"></a>
<a name="ln-13032"></a><span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-13033"></a><span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>   <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-13034"></a><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PLRHeating</span>
<a name="ln-13035"></a><span class="n">DXCoilFanOpMode</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>      <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-13036"></a><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">PLRHeating</span>
<a name="ln-13037"></a>
<a name="ln-13038"></a><span class="k">RETURN</span>
<a name="ln-13039"></a>
<a name="ln-13040"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMultiSpeedDXCoilHeating</span>
<a name="ln-13041"></a>
<a name="ln-13042"></a><span class="k">SUBROUTINE </span><span class="n">UpdateDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-13043"></a>
<a name="ln-13044"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-13045"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13046"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-13047"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-13048"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-13049"></a>
<a name="ln-13050"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-13051"></a>          <span class="c">! This subroutine is for passing results to the outlet air node.</span>
<a name="ln-13052"></a>
<a name="ln-13053"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13054"></a>          <span class="c">! na</span>
<a name="ln-13055"></a>
<a name="ln-13056"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13057"></a>          <span class="c">! na</span>
<a name="ln-13058"></a>
<a name="ln-13059"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13060"></a>  <span class="k">USE </span><span class="n">DataContaminantBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Contaminant</span>
<a name="ln-13061"></a>
<a name="ln-13062"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13063"></a>
<a name="ln-13064"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13065"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span> <span class="c">! number of the current fan coil unit being simulated</span>
<a name="ln-13066"></a>
<a name="ln-13067"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-13068"></a>          <span class="c">! na</span>
<a name="ln-13069"></a>
<a name="ln-13070"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13071"></a>          <span class="c">! na</span>
<a name="ln-13072"></a>
<a name="ln-13073"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13074"></a>          <span class="c">! na</span>
<a name="ln-13075"></a>
<a name="ln-13076"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13077"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirOutletNode</span> <span class="c">! air outlet node number</span>
<a name="ln-13078"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirInletNode</span> <span class="c">! air inlet node number</span>
<a name="ln-13079"></a>
<a name="ln-13080"></a><span class="n">AirOutletNode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirOutNode</span>
<a name="ln-13081"></a><span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-13082"></a><span class="c">! changed outputs</span>
<a name="ln-13083"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-13084"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-13085"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-13086"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-13087"></a><span class="c">! pass through outputs</span>
<a name="ln-13088"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Quality</span>              <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-13089"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Press</span>                <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-13090"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-13091"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-13092"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-13093"></a><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-13094"></a>
<a name="ln-13095"></a><span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">CO2Simulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-13096"></a><span class="k">  </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-13097"></a><span class="k">End If</span>
<a name="ln-13098"></a><span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">GenericContamSimulation</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-13099"></a><span class="k">  </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">GenContam</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">GenContam</span>
<a name="ln-13100"></a><span class="k">End If</span>
<a name="ln-13101"></a>
<a name="ln-13102"></a><span class="k">RETURN</span>
<a name="ln-13103"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateDXCoil</span>
<a name="ln-13104"></a>
<a name="ln-13105"></a><span class="k">SUBROUTINE </span><span class="n">ReportDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-13106"></a>
<a name="ln-13107"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-13108"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13109"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-13110"></a>          <span class="c">!       MODIFIED       Richard Raustad/Don Shirey Oct 2001, Feb 2004</span>
<a name="ln-13111"></a>          <span class="c">!                      Feb 2005 M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-13112"></a>          <span class="c">!                        Always update evap value to support new coil type COIL:DX:MultiMode:CoolingEmpirical:</span>
<a name="ln-13113"></a>          <span class="c">!                      Lixing Gu. Jan. 5, 2007, pass information to the AirflowNetwork model</span>
<a name="ln-13114"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-13115"></a>
<a name="ln-13116"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-13117"></a>          <span class="c">! Fills some of the report variables for the DX coils</span>
<a name="ln-13118"></a>
<a name="ln-13119"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13120"></a>          <span class="c">! na</span>
<a name="ln-13121"></a>
<a name="ln-13122"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13123"></a>          <span class="c">! na</span>
<a name="ln-13124"></a>
<a name="ln-13125"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13126"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">DXElecCoolingPower</span><span class="p">,</span> <span class="n">DXElecHeatingPower</span>
<a name="ln-13127"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">RhoH2O</span>
<a name="ln-13128"></a>  <span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-13129"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopDXCoilRTF</span>
<a name="ln-13130"></a>
<a name="ln-13131"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13132"></a>
<a name="ln-13133"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13134"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilNum</span> <span class="c">! number of the current fan coil unit being simulated</span>
<a name="ln-13135"></a>
<a name="ln-13136"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-13137"></a>          <span class="c">! na</span>
<a name="ln-13138"></a>
<a name="ln-13139"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13140"></a>          <span class="c">! na</span>
<a name="ln-13141"></a>
<a name="ln-13142"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13143"></a>          <span class="c">! na</span>
<a name="ln-13144"></a>
<a name="ln-13145"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13146"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoWater</span>
<a name="ln-13147"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tavg</span>
<a name="ln-13148"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecHumOut</span>
<a name="ln-13149"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecHumIn</span>
<a name="ln-13150"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span> <span class="c">! Number of seconds per HVAC system time step, to convert from W (J/s) to J</span>
<a name="ln-13151"></a>
<a name="ln-13152"></a><span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-13153"></a>
<a name="ln-13154"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-13155"></a>
<a name="ln-13156"></a><span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">,</span><span class="n">CoilVRF_Heating</span><span class="p">)</span>
<a name="ln-13157"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13158"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13159"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13160"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13161"></a>  <span class="n">DXElecHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span>
<a name="ln-13162"></a><span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-13163"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13164"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-13165"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13166"></a>  <span class="k">Else</span>
<a name="ln-13167"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelConsumed</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13168"></a>  <span class="k">End If</span>
<a name="ln-13169"></a><span class="k">  </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13170"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13171"></a>  <span class="n">DXElecHeatingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecHeatingPower</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span>
<a name="ln-13172"></a><span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-13173"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13174"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13175"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span>
<a name="ln-13176"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13177"></a>  <span class="n">DXElecCoolingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-13178"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13179"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13180"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">FuelTypeElectricity</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-13181"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13182"></a>  <span class="k">Else</span>
<a name="ln-13183"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelConsumed</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">FuelUsed</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13184"></a>  <span class="k">End If</span>
<a name="ln-13185"></a><span class="k">  If</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-13186"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13187"></a>  <span class="n">Endif</span>
<a name="ln-13188"></a><span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatPumpWaterHeater</span><span class="p">)</span>
<a name="ln-13189"></a><span class="c">! water heating energy for HP water heater DX Coil condenser</span>
<a name="ln-13190"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalHeatingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13191"></a><span class="c">! water heating power for HP water heater</span>
<a name="ln-13192"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecWaterHeatingConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecWaterHeatingPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13193"></a><span class="c">! other usual DX cooling coil outputs</span>
<a name="ln-13194"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13195"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13196"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span>
<a name="ln-13197"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13198"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13199"></a><span class="c">! DXElecCoolingPower global is only used for air-to-air cooling and heating coils</span>
<a name="ln-13200"></a>  <span class="n">DXElecCoolingPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13201"></a><span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13202"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13203"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergyRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13204"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">LatCoolingEnergy</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">TotalCoolingEnergy</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SensCoolingEnergy</span>
<a name="ln-13205"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13206"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CrankcaseHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13207"></a>  <span class="n">DXElecCoolingPower</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>
<a name="ln-13208"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13209"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13210"></a>  <span class="k">If</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-13211"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13212"></a>  <span class="n">Endif</span>
<a name="ln-13213"></a><span class="k">END SELECT</span>
<a name="ln-13214"></a>
<a name="ln-13215"></a><span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13216"></a>  <span class="c">! calculate and report condensation rates  (how much water extracted from the air stream)</span>
<a name="ln-13217"></a>  <span class="c">! water flow of water in m3/s for water system interactions</span>
<a name="ln-13218"></a>  <span class="c">!  put here to catch all types of DX coils</span>
<a name="ln-13219"></a>  <span class="n">Tavg</span> <span class="o">=</span><span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-13220"></a>  <span class="n">rhoWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">Tavg</span><span class="p">)</span>
<a name="ln-13221"></a><span class="c">! CR9155 Remove specific humidity calculations</span>
<a name="ln-13222"></a>  <span class="n">SpecHumIn</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-13223"></a>  <span class="n">SpecHumOut</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-13224"></a>  <span class="c">!  mdot * del HumRat / rho water</span>
<a name="ln-13225"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-13226"></a>            <span class="p">(</span><span class="n">SpecHumIn</span> <span class="o">-</span> <span class="n">SpecHumOut</span><span class="p">)</span> <span class="o">/</span> <span class="n">rhoWater</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-13227"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span>  <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13228"></a>
<a name="ln-13229"></a>  <span class="n">WaterStorage</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">)%</span><span class="n">VdotAvailSupply</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-13230"></a>      <span class="o">=</span>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span>
<a name="ln-13231"></a>  <span class="n">WaterStorage</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">)%</span><span class="n">TwaterSupply</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-13232"></a>      <span class="o">=</span>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-13233"></a><span class="n">ENDIF</span>
<a name="ln-13234"></a>
<a name="ln-13235"></a><span class="n">LoopDXCoilRTF</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilRuntimeFraction</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilRuntimeFraction</span><span class="p">)</span>
<a name="ln-13236"></a>
<a name="ln-13237"></a><span class="k">RETURN</span>
<a name="ln-13238"></a><span class="k">END SUBROUTINE </span><span class="n">ReportDXCoil</span>
<a name="ln-13239"></a>
<a name="ln-13240"></a><span class="k">SUBROUTINE </span><span class="n">CalcTwoSpeedDXCoilStandardRating</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-13241"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-13242"></a>          <span class="c">!       AUTHOR         B. Griffith, (Derived from CalcDXCoilStandardRating by Bereket Nigusse &amp; Chandan Sharma)</span>
<a name="ln-13243"></a>          <span class="c">!       DATE WRITTEN   July 2012</span>
<a name="ln-13244"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-13245"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-13246"></a>
<a name="ln-13247"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-13248"></a>          <span class="c">! Calculate the following</span>
<a name="ln-13249"></a>          <span class="c">!                 (1) Standard Rated (net) Cooling Capacity</span>
<a name="ln-13250"></a>          <span class="c">!                 (2) Energy Efficiency Ratio (EER),</span>
<a name="ln-13251"></a>          <span class="c">!                 (3) Integrated Energy Efficiency Ratio (IEER)</span>
<a name="ln-13252"></a>
<a name="ln-13253"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13254"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-13255"></a>
<a name="ln-13256"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13257"></a>          <span class="c">! ANSI/AHRI Standard 340/360-2007, Peformance Rating of Commercial and Industrial Unitary Air-Conditioning and</span>
<a name="ln-13258"></a>          <span class="c">!  Heat Pump Equipment, Air-Conditioning, Heating, and Refrigeration Institute, Arlingtion VA.</span>
<a name="ln-13259"></a>
<a name="ln-13260"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13261"></a>
<a name="ln-13262"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-13263"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanPower</span><span class="p">,</span> <span class="n">GetFanInletNode</span><span class="p">,</span> <span class="n">GetFanOutletNode</span><span class="p">,</span> <span class="n">SimulateFanComponents</span>
<a name="ln-13264"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-13265"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-13266"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-13267"></a>
<a name="ln-13268"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13269"></a>
<a name="ln-13270"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13271"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DXCoilNum</span>
<a name="ln-13272"></a>
<a name="ln-13273"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-13274"></a>  <span class="c">! AHRI Standard 340/360-2007 Peformance Rating of Commercial and Industrial Unitary Air-Conditioning and Heat Pump Equipment</span>
<a name="ln-13275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">CoolingCoilInletAirWetbulbTempRated</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">9.4d0</span>  <span class="c">! 19.44C (67F)</span>
<a name="ln-13276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">CoolingCoilInletAirDryblubTempRated</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.7d0</span>  <span class="c">!</span>
<a name="ln-13277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">OutdoorUnitInletAirDrybulbTempRated</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.0d0</span>   <span class="c">! 35.00C (95F)</span>
<a name="ln-13278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-13279"></a>                              <span class="p">(</span><span class="o">/</span><span class="mi">2</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mi">1</span><span class="mf">8.3d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-13280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetCapacityFactorPLTestPoint</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-13281"></a>                              <span class="p">(</span><span class="o">/</span><span class="mf">0.75d0</span><span class="p">,</span> <span class="mf">0.50D0</span><span class="p">,</span> <span class="mf">0.25D0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-13282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ConvFromSIToIP</span> <span class="o">=</span> <span class="mf">3.412141633D0</span> <span class="c">! Conversion from SI to IP [3.412 Btu/hr-W]</span>
<a name="ln-13283"></a>
<a name="ln-13284"></a>
<a name="ln-13285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">AirMassFlowRatioRated</span> <span class="o">=</span> <span class="mf">1.0d0</span>   <span class="c">! AHRI test is at the design flow rate</span>
<a name="ln-13286"></a>                                                             <span class="c">! and hence AirMassFlowRatio is 1.0</span>
<a name="ln-13287"></a>
<a name="ln-13288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DefaultFanPowerPerEvapAirFlowRate</span> <span class="o">=</span> <span class="mi">77</span><span class="mf">3.3D0</span> <span class="c">! 365 W/1000 scfm or 773.3 W/(m3/s). The AHRI standard</span>
<a name="ln-13289"></a>                                                      <span class="c">! specifies a nominal/default fan electric power consumption per rated air</span>
<a name="ln-13290"></a>                                                      <span class="c">! volume flow rate to account for indoor fan electric power consumption</span>
<a name="ln-13291"></a>                                                      <span class="c">! when the standard tests are conducted on units that do not have an</span>
<a name="ln-13292"></a>                                                      <span class="c">! indoor air circulting fan. Used if user doesn&#39;t enter a specific value.</span>
<a name="ln-13293"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-13294"></a>          <span class="c">! na</span>
<a name="ln-13295"></a>
<a name="ln-13296"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-13297"></a>          <span class="c">! na</span>
<a name="ln-13298"></a>
<a name="ln-13299"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13300"></a>
<a name="ln-13301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetCoolingCapRated</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Net Cooling Coil capacity at Rated conditions, accounting for supply fan heat [W]</span>
<a name="ln-13302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EER</span> <span class="o">=</span> <span class="mf">0.0D0</span>              <span class="c">! Energy Efficiency Ratio in SI [W/W]</span>
<a name="ln-13303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IEER</span> <span class="o">=</span> <span class="mf">0.0D0</span>             <span class="c">! Integerated Energy Efficiency Ratio in SI [W/W]</span>
<a name="ln-13304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">0.0D0</span>    <span class="c">! Total capacity modifier (function of entering wetbulb, outside drybulb) [-]</span>
<a name="ln-13305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="mf">0.0D0</span>    <span class="c">! Total capacity modifier (function of actual supply air flow vs rated flow) [-]</span>
<a name="ln-13306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="mf">0.0D0</span>       <span class="c">! EIR modifier (function of entering wetbulb, outside drybulb) [-]</span>
<a name="ln-13307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="mf">0.0D0</span>       <span class="c">! EIR modifier (function of actual supply air flow vs rated flow) [-]</span>
<a name="ln-13308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span>
<a name="ln-13309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalElecPowerRated</span>
<a name="ln-13310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EER_TestPoint_SI</span> <span class="c">! 1 = A, 2 = B, 3= C, 4= D</span>
<a name="ln-13311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EER_TestPoint_IP</span> <span class="c">! 1 = A, 2 = B, 3= C, 4= D</span>
<a name="ln-13312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetCapacity_TestPoint</span> <span class="c">! 1 = A, 2 = B, 3= C, 4= D</span>
<a name="ln-13313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetPower_TestPoint</span>  <span class="c">! 1 = A, 2 = B, 3= C, 4= D</span>
<a name="ln-13314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupAirMdot_TestPoint</span> <span class="c">! 1 = A, 2 = B, 3= C, 4= D</span>
<a name="ln-13315"></a>
<a name="ln-13316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempDryBlub_Leaving_Apoint</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-13317"></a>
<a name="ln-13318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighSpeedNetCoolingCap</span>
<a name="ln-13319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowSpeedNetCoolingCap</span>
<a name="ln-13320"></a>
<a name="ln-13321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadAirMassFlowRate</span>
<a name="ln-13322"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>
<a name="ln-13323"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AccuracyTolerance</span> <span class="o">=</span> <span class="mf">0.2d0</span> <span class="c">! tolerance in AHRI 340/360 Table 6 note 1</span>
<a name="ln-13324"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MaximumIterations</span> <span class="o">=</span> <span class="mi">500</span>
<a name="ln-13325"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SolverFlag</span>
<a name="ln-13326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                 <span class="c">! Parameter array passed to solver</span>
<a name="ln-13327"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR_HighSpeed</span>
<a name="ln-13328"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR_LowSpeed</span>
<a name="ln-13329"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanInletNode</span>
<a name="ln-13330"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOutletNode</span>
<a name="ln-13331"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Iter</span>
<a name="ln-13332"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExternalStatic</span>
<a name="ln-13333"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanStaticPressureRise</span>
<a name="ln-13334"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13335"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13336"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanPowerCorrection</span>
<a name="ln-13337"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanPowerPerEvapAirFlowRate</span>
<a name="ln-13338"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>
<a name="ln-13339"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>
<a name="ln-13340"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TargetNetCapacity</span>
<a name="ln-13341"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirHumRat</span>
<a name="ln-13342"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirRho</span>
<a name="ln-13343"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirVolFlowRate</span>
<a name="ln-13344"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighSpeedTotCoolingCap</span>
<a name="ln-13345"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowSpeedTotCoolingCap</span>
<a name="ln-13346"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCoolingCap</span>
<a name="ln-13347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetCoolingCap</span>
<a name="ln-13348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>
<a name="ln-13349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunTimeFraction</span>
<a name="ln-13350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowerBoundMassFlowRate</span>
<a name="ln-13351"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OneTimeEIOHeaderWrite</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-13352"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PartLoadTestPoint</span>
<a name="ln-13353"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">countStaticInputs</span>
<a name="ln-13354"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-13355"></a>
<a name="ln-13356"></a>  <span class="c">! Get fan index and name if not already available</span>
<a name="ln-13357"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-13358"></a>     <span class="k">CALL </span><span class="n">GetFanIndexForTwoSpeedCoil</span><span class="p">(</span> <span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">)</span>
<a name="ln-13359"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! didn&#39;t find VAV fan, do not rate this coil</span>
<a name="ln-13360"></a>    <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13361"></a>    <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating: Did not find a variable air volume fan associated&#39;</span> <span class="p">&amp;</span>
<a name="ln-13362"></a>                       <span class="o">//</span><span class="s1">&#39; with DX coil named = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;. Standard Ratings will not be calculated.&#39;</span><span class="p">)</span>
<a name="ln-13363"></a>    <span class="k">RETURN</span>
<a name="ln-13364"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-13365"></a>
<a name="ln-13366"></a> <span class="c">! CALL CheckCurveLimitsForStandardRatings(</span>
<a name="ln-13367"></a>
<a name="ln-13368"></a>  <span class="c">! Calculate the Indoor fan electric power consumption.  The electric power consumption is estimated</span>
<a name="ln-13369"></a>  <span class="c">! using either user supplied or AHRI default value for fan power per air volume flow rate</span>
<a name="ln-13370"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13371"></a>
<a name="ln-13372"></a><span class="k">    </span><span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatioRated</span><span class="p">)</span>
<a name="ln-13373"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-13374"></a>                                 <span class="n">OutdoorUnitInletAirDrybulbTempRated</span><span class="p">)</span>
<a name="ln-13375"></a>    <span class="k">Do </span><span class="n">Iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="c">! iterative solution in the event that net capacity is near a threshold for external static</span>
<a name="ln-13376"></a>        <span class="c">!Obtain external static pressure from Table 5 in ANSI/AHRI Std. 340/360-2007</span>
<a name="ln-13377"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">2100</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13378"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.d0</span>
<a name="ln-13379"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">2100</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">3080</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13380"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">0.d0</span>
<a name="ln-13381"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">3080</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">3930</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13382"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">7</span><span class="mf">0.d0</span>
<a name="ln-13383"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">3930</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">6150</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13384"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">9</span><span class="mf">0.d0</span>
<a name="ln-13385"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">6150</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">8210</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13386"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-13387"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">8210</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">10300</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13388"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">11</span><span class="mf">0.d0</span>
<a name="ln-13389"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">10300</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">11700</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13390"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">14</span><span class="mf">0.d0</span>
<a name="ln-13391"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">11700</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NetCoolingCapRated</span> <span class="o">&lt;=</span> <span class="mi">14700</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13392"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">16</span><span class="mf">0.d0</span>
<a name="ln-13393"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="mi">14700</span><span class="mf">0.d0</span> <span class="o">&lt;</span> <span class="n">NetCoolingCapRated</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13394"></a><span class="k">        </span><span class="n">ExternalStatic</span>  <span class="o">=</span> <span class="mi">19</span><span class="mf">0.d0</span>
<a name="ln-13395"></a>      <span class="n">ENDIF</span>
<a name="ln-13396"></a>      <span class="n">FanStaticPressureRise</span> <span class="o">=</span> <span class="n">ExternalStatic</span> <span class="o">+</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InternalStaticPressureDrop</span>
<a name="ln-13397"></a>
<a name="ln-13398"></a>      <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="s1">&#39;FAN:VARIABLEVOLUME&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">,</span> <span class="n">errorsFound</span><span class="p">)</span>
<a name="ln-13399"></a>      <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="s1">&#39;FAN:VARIABLEVOLUME&#39;</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">,</span> <span class="n">errorsFound</span><span class="p">)</span>
<a name="ln-13400"></a>      <span class="c">! set node state variables in preparation for fan model.</span>
<a name="ln-13401"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13402"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13403"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">CoolingCoilInletAirDryblubTempRated</span>
<a name="ln-13404"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CoolingCoilInletAirDryblubTempRated</span><span class="p">,</span> <span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13405"></a>                                                       <span class="n">OutBaroPress</span> <span class="p">,</span> <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13406"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoolingCoilInletAirDryblubTempRated</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13407"></a>                                                    <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13408"></a>
<a name="ln-13409"></a>      <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13410"></a>                                 <span class="n">ZoneCompTurnFansOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13411"></a>                                 <span class="n">ZoneCompTurnFansOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13412"></a>                                 <span class="n">PressureRise</span> <span class="o">=</span> <span class="n">FanStaticPressureRise</span><span class="p">)</span>
<a name="ln-13413"></a>      <span class="n">FanHeatCorrection</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-13414"></a>      <span class="k">CALL </span><span class="n">GetFanPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">FanPowerCorrection</span><span class="p">)</span>
<a name="ln-13415"></a>
<a name="ln-13416"></a>      <span class="n">NetCoolingCapRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>     <span class="p">&amp;</span>
<a name="ln-13417"></a>                         <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13418"></a>    <span class="n">ENDDO</span>
<a name="ln-13419"></a>
<a name="ln-13420"></a>  <span class="k">ELSE</span>
<a name="ln-13421"></a><span class="k">    </span><span class="n">FanPowerPerEvapAirFlowRate</span><span class="o">=</span><span class="n">DefaultFanPowerPerEvapAirFlowRate</span>
<a name="ln-13422"></a>    <span class="n">FanPowerCorrection</span> <span class="o">=</span> <span class="n">DefaultFanPowerPerEvapAirFlowRate</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13423"></a>    <span class="n">FanHeatCorrection</span>  <span class="o">=</span> <span class="n">DefaultFanPowerPerEvapAirFlowRate</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13424"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatioRated</span><span class="p">)</span>
<a name="ln-13425"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-13426"></a>                                 <span class="n">OutdoorUnitInletAirDrybulbTempRated</span><span class="p">)</span>
<a name="ln-13427"></a>    <span class="n">NetCoolingCapRated</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>          <span class="p">&amp;</span>
<a name="ln-13428"></a>                         <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13429"></a>  <span class="n">ENDIF</span>
<a name="ln-13430"></a>
<a name="ln-13431"></a>  <span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13432"></a>
<a name="ln-13433"></a>  <span class="c">! Calculate Energy Efficiency Ratio (EER) at (19.44C WB and 35.0C DB ), ANSI/AHRI Std. 340/360</span>
<a name="ln-13434"></a>  <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-13435"></a>                                  <span class="n">OutdoorUnitInletAirDrybulbTempRated</span><span class="p">)</span>
<a name="ln-13436"></a>  <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatioRated</span><span class="p">)</span>
<a name="ln-13437"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13438"></a>       <span class="c">! RatedCOP &lt;= 0.0 is trapped in GetInput, but keep this as &quot;safety&quot;</span>
<a name="ln-13439"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13440"></a>  <span class="k">ELSE</span>
<a name="ln-13441"></a><span class="k">    </span><span class="n">EIR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13442"></a>  <span class="n">ENDIF</span>
<a name="ln-13443"></a>  <span class="n">TotalElecPowerRated</span> <span class="o">=</span> <span class="n">EIR</span> <span class="o">*</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-13444"></a>                        <span class="o">+</span> <span class="n">FanPowerCorrection</span>
<a name="ln-13445"></a>
<a name="ln-13446"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TotalElecPowerRated</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13447"></a><span class="k">       </span><span class="n">EER</span> <span class="o">=</span> <span class="n">NetCoolingCapRated</span> <span class="o">/</span> <span class="n">TotalElecPowerRated</span>
<a name="ln-13448"></a>  <span class="k">ELSE</span>
<a name="ln-13449"></a><span class="k">       </span><span class="n">EER</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13450"></a>  <span class="n">ENDIF</span>
<a name="ln-13451"></a>
<a name="ln-13452"></a><span class="c">! IEER - A point 100 % net capacity</span>
<a name="ln-13453"></a>  <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">EER</span>
<a name="ln-13454"></a>  <span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">EER</span> <span class="o">*</span> <span class="n">ConvFromSIToIP</span>
<a name="ln-13455"></a>
<a name="ln-13456"></a>  <span class="c">! find coil leaving dryblub at point A, with full rated air flow rate.</span>
<a name="ln-13457"></a>  <span class="c">! init coil</span>
<a name="ln-13458"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>    <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13459"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRateMax</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13460"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>            <span class="o">=</span> <span class="mi">2</span><span class="mf">6.7d0</span>
<a name="ln-13461"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>          <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="mi">2</span><span class="mf">6.7d0</span><span class="p">,</span> <span class="mi">1</span><span class="mf">9.4d0</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13462"></a>                                                         <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13463"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>        <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="mi">2</span><span class="mf">6.7d0</span><span class="p">,</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13464"></a>                                                         <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13465"></a>
<a name="ln-13466"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13467"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">OutdoorUnitInletAirDrybulbTempRated</span>
<a name="ln-13468"></a>  <span class="k">ELSE</span>
<a name="ln-13469"></a><span class="k">    </span><span class="n">OutDryBulbTemp</span> <span class="o">=</span> <span class="n">OutdoorUnitInletAirDrybulbTempRated</span>
<a name="ln-13470"></a>  <span class="n">ENDIF</span>
<a name="ln-13471"></a>  <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-13472"></a>  <span class="n">CycRatio</span>   <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-13473"></a>  <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">ForceOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-13474"></a>  <span class="n">TempDryBlub_Leaving_Apoint</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span> <span class="c">! store result</span>
<a name="ln-13475"></a>
<a name="ln-13476"></a><span class="c">! IEER - part load test points ***************************************************</span>
<a name="ln-13477"></a>  <span class="k">DO </span><span class="n">PartLoadTestPoint</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="c">!</span>
<a name="ln-13478"></a>  <span class="c">! determine minimum unloading capacity fraction at point B conditions.</span>
<a name="ln-13479"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13480"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>
<a name="ln-13481"></a>    <span class="k">ELSE</span>
<a name="ln-13482"></a><span class="k">      </span><span class="n">OutDryBulbTemp</span> <span class="o">=</span> <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>
<a name="ln-13483"></a>    <span class="n">ENDIF</span>
<a name="ln-13484"></a>
<a name="ln-13485"></a>    <span class="n">TargetNetCapacity</span> <span class="o">=</span> <span class="n">NetCapacityFactorPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">*</span> <span class="n">NetCoolingCapRated</span>
<a name="ln-13486"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
<a name="ln-13487"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">TempDryBlub_Leaving_Apoint</span>
<a name="ln-13488"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">TargetNetCapacity</span>
<a name="ln-13489"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>
<a name="ln-13490"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoolingCoilInletAirWetbulbTempRated</span>
<a name="ln-13491"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoolingCoilInletAirDryblubTempRated</span>
<a name="ln-13492"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">NetCoolingCapRated</span>
<a name="ln-13493"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13494"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13495"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">,</span>  <span class="n">r64</span><span class="p">)</span>
<a name="ln-13496"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
<a name="ln-13497"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="n">ExternalStatic</span>
<a name="ln-13498"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
<a name="ln-13499"></a>    <span class="k">ELSE</span>
<a name="ln-13500"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">FanPowerPerEvapAirFlowRate</span>
<a name="ln-13501"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13502"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13503"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13504"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13505"></a>    <span class="n">ENDIF</span>
<a name="ln-13506"></a>
<a name="ln-13507"></a>    <span class="n">LowerBoundMassFlowRate</span> <span class="o">=</span> <span class="mf">0.01d0</span> <span class="o">*</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13508"></a>
<a name="ln-13509"></a>    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">AccuracyTolerance</span><span class="p">,</span> <span class="n">MaximumIterations</span><span class="p">,</span> <span class="n">SolverFlag</span><span class="p">,</span> <span class="n">PartLoadAirMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13510"></a>                                               <span class="n">CalcTwoSpeedDXCoilIEERResidual</span><span class="p">,</span> <span class="n">LowerBoundMassFlowRate</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-13511"></a>                                               <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-13512"></a>
<a name="ln-13513"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">SolverFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13514"></a>
<a name="ln-13515"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating: air flow rate solver failed. Iteration limit exceeded &#39;</span><span class="p">)</span>
<a name="ln-13516"></a>
<a name="ln-13517"></a>      <span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13518"></a>      <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13519"></a>      <span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13520"></a>      <span class="n">NetCapacity_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13521"></a>      <span class="n">NetPower_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>     <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13522"></a>
<a name="ln-13523"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolverFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13524"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating: air flow rate solver failed. root not bounded &#39;</span><span class="p">)</span>
<a name="ln-13525"></a>
<a name="ln-13526"></a>      <span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13527"></a>      <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13528"></a>      <span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13529"></a>      <span class="n">NetCapacity_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13530"></a>      <span class="n">NetPower_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>     <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-13531"></a>    <span class="k">ELSE</span>
<a name="ln-13532"></a>      <span class="c">! now we have the supply air flow rate</span>
<a name="ln-13533"></a>      <span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">PartLoadAirMassFlowRate</span>
<a name="ln-13534"></a>      <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">PartLoadAirMassFlowRate</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13535"></a>      <span class="n">SupplyAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CoolingCoilInletAirDryblubTempRated</span><span class="p">,</span> <span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span> <span class="n">OutBaroPress</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13536"></a>                                      <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13537"></a>      <span class="n">SupplyAirRho</span> <span class="o">=</span>  <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">CoolingCoilInletAirDryblubTempRated</span><span class="p">,</span> <span class="n">SupplyAirHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13538"></a>                                      <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13539"></a>      <span class="n">SupplyAirVolFlowRate</span> <span class="o">=</span> <span class="n">PartLoadAirMassFlowRate</span> <span class="o">/</span> <span class="n">SupplyAirRho</span>
<a name="ln-13540"></a>
<a name="ln-13541"></a>      <span class="k">IF</span><span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13542"></a><span class="k">        </span><span class="n">FanStaticPressureRise</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InternalStaticPressureDrop</span> <span class="p">&amp;</span>
<a name="ln-13543"></a>                       <span class="o">+</span> <span class="p">(</span><span class="n">ExternalStatic</span> <span class="o">*</span> <span class="p">(</span><span class="n">AirMassFlowRatio</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-13544"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">PartLoadAirMassFlowRate</span>
<a name="ln-13545"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">CoolingCoilInletAirDryblubTempRated</span>
<a name="ln-13546"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">SupplyAirHumRat</span>
<a name="ln-13547"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoolingCoilInletAirDryblubTempRated</span><span class="p">,</span> <span class="n">SupplyAirHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13548"></a>                                                        <span class="s1">&#39;CalcTwoSpeedDXCoilStandardRating&#39;</span><span class="p">)</span>
<a name="ln-13549"></a>        <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13550"></a>                                     <span class="n">ZoneCompTurnFansOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13551"></a>                                     <span class="n">ZoneCompTurnFansOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13552"></a>                                     <span class="n">PressureRise</span> <span class="o">=</span> <span class="n">FanStaticPressureRise</span><span class="p">)</span>
<a name="ln-13553"></a>        <span class="n">FanHeatCorrection</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-13554"></a>        <span class="k">CALL </span><span class="n">GetFanPower</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">FanPowerCorrection</span><span class="p">)</span>
<a name="ln-13555"></a>
<a name="ln-13556"></a>      <span class="k">ELSE</span>
<a name="ln-13557"></a><span class="k">        </span><span class="n">FanPowerCorrection</span> <span class="o">=</span> <span class="n">FanPowerPerEvapAirFlowRate</span> <span class="o">*</span> <span class="n">PartLoadAirMassFlowRate</span>
<a name="ln-13558"></a>        <span class="n">FanHeatCorrection</span>  <span class="o">=</span> <span class="n">FanPowerPerEvapAirFlowRate</span> <span class="o">*</span> <span class="n">PartLoadAirMassFlowRate</span>
<a name="ln-13559"></a>      <span class="n">ENDIF</span>
<a name="ln-13560"></a>
<a name="ln-13561"></a>
<a name="ln-13562"></a>      <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-13563"></a>      <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-13564"></a>                                 <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">))</span>
<a name="ln-13565"></a>      <span class="n">HighSpeedTotCoolingCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-13566"></a>      <span class="n">HighSpeedNetCoolingCap</span> <span class="o">=</span> <span class="n">HighSpeedTotCoolingCap</span> <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13567"></a>
<a name="ln-13568"></a>      <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-13569"></a>                                      <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">))</span>
<a name="ln-13570"></a>      <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-13571"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13572"></a>           <span class="c">! RatedCOP &lt;= 0.0 is trapped in GetInput, but keep this as &quot;safety&quot;</span>
<a name="ln-13573"></a>        <span class="n">EIR_HighSpeed</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13574"></a>      <span class="k">ELSE</span>
<a name="ln-13575"></a><span class="k">        </span><span class="n">EIR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13576"></a>      <span class="n">ENDIF</span>
<a name="ln-13577"></a>
<a name="ln-13578"></a>      <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-13579"></a>      <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">,</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-13580"></a>                                 <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">))</span>
<a name="ln-13581"></a>      <span class="n">LowSpeedTotCoolingCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-13582"></a>      <span class="n">LowSpeedNetCoolingCap</span> <span class="o">=</span> <span class="n">LowSpeedTotCoolingCap</span> <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13583"></a>
<a name="ln-13584"></a>      <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFTemp2</span><span class="p">,</span><span class="n">CoolingCoilInletAirWetbulbTempRated</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-13585"></a>                                      <span class="n">OutdoorUnitInletAirDrybulbTempPLTestPoint</span><span class="p">(</span><span class="n">PartLoadTestPoint</span><span class="p">))</span>
<a name="ln-13586"></a>      <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">EIRFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-13587"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP2</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13588"></a>           <span class="c">! RatedCOP &lt;= 0.0 is trapped in GetInput, but keep this as &quot;safety&quot;</span>
<a name="ln-13589"></a>        <span class="n">EIR_LowSpeed</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedCOP2</span>
<a name="ln-13590"></a>      <span class="k">ELSE</span>
<a name="ln-13591"></a><span class="k">        </span><span class="n">EIR_LowSpeed</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13592"></a>      <span class="n">ENDIF</span>
<a name="ln-13593"></a>
<a name="ln-13594"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">LowSpeedNetCoolingCap</span> <span class="o">&lt;=</span> <span class="n">TargetNetCapacity</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13595"></a><span class="k">        </span><span class="n">CycRatio</span>   <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-13596"></a>        <span class="n">SpeedRatio</span> <span class="o">=</span>  <span class="p">(</span><span class="n">TargetNetCapacity</span> <span class="o">-</span> <span class="n">LowSpeedNetCoolingCap</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-13597"></a>                     <span class="o">/</span><span class="p">(</span> <span class="n">HighSpeedNetCoolingCap</span> <span class="o">-</span> <span class="n">LowSpeedNetCoolingCap</span> <span class="p">)</span>
<a name="ln-13598"></a>        <span class="n">TotCoolingCap</span> <span class="o">=</span> <span class="n">HighSpeedTotCoolingCap</span> <span class="o">*</span> <span class="n">SpeedRatio</span> <span class="o">+</span> <span class="n">LowSpeedTotCoolingCap</span> <span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-13599"></a>        <span class="n">NetCoolingCap</span> <span class="o">=</span> <span class="n">TotCoolingCap</span> <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13600"></a>        <span class="n">EIR</span>           <span class="o">=</span> <span class="n">EIR_HighSpeed</span> <span class="o">*</span> <span class="n">SpeedRatio</span>  <span class="o">+</span> <span class="n">EIR_LowSpeed</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-13601"></a>        <span class="n">TotalElecPowerRated</span> <span class="o">=</span> <span class="n">TotCoolingCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">+</span> <span class="n">FanPowerCorrection</span>
<a name="ln-13602"></a>        <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>  <span class="o">=</span> <span class="n">NetCoolingCap</span> <span class="o">/</span> <span class="n">TotalElecPowerRated</span>
<a name="ln-13603"></a>        <span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvFromSIToIP</span>
<a name="ln-13604"></a>        <span class="n">NetCapacity_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">NetCoolingCap</span>
<a name="ln-13605"></a>        <span class="n">NetPower_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">TotalElecPowerRated</span>
<a name="ln-13606"></a>      <span class="k">ELSE</span> <span class="c">! minimum unloading limit exceeded without cycling, so cycle</span>
<a name="ln-13607"></a>        <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-13608"></a>        <span class="n">CycRatio</span>   <span class="o">=</span>  <span class="n">TargetNetCapacity</span> <span class="o">/</span> <span class="n">LowSpeedNetCoolingCap</span>
<a name="ln-13609"></a>        <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CycRatio</span><span class="p">)</span>
<a name="ln-13610"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&lt;</span> <span class="mf">0.7d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13611"></a><span class="k">          </span><span class="n">PLF</span> <span class="o">=</span> <span class="mf">0.7d0</span>
<a name="ln-13612"></a>        <span class="k">END IF</span>
<a name="ln-13613"></a><span class="k">        </span><span class="n">RunTimeFraction</span> <span class="o">=</span> <span class="n">CycRatio</span><span class="o">/</span> <span class="n">PLF</span>
<a name="ln-13614"></a>        <span class="n">RunTimeFraction</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">RunTimeFraction</span><span class="p">,</span> <span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-13615"></a>        <span class="n">TotCoolingCap</span> <span class="o">=</span> <span class="n">LowSpeedTotCoolingCap</span> <span class="o">*</span> <span class="n">RunTimeFraction</span>
<a name="ln-13616"></a>        <span class="n">NetCoolingCap</span> <span class="o">=</span> <span class="n">TotCoolingCap</span> <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13617"></a>        <span class="n">TotalElecPowerRated</span> <span class="o">=</span> <span class="n">LowSpeedTotCoolingCap</span> <span class="o">*</span> <span class="n">EIR_LowSpeed</span> <span class="o">*</span> <span class="n">RunTimeFraction</span>  <span class="p">&amp;</span>
<a name="ln-13618"></a>                              <span class="o">+</span> <span class="n">FanPowerCorrection</span>
<a name="ln-13619"></a>        <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span>  <span class="o">=</span> <span class="n">NetCoolingCap</span> <span class="o">/</span> <span class="n">TotalElecPowerRated</span>
<a name="ln-13620"></a>        <span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvFromSIToIP</span>
<a name="ln-13621"></a>        <span class="n">NetCapacity_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">NetCoolingCap</span>
<a name="ln-13622"></a>        <span class="n">NetPower_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">PartLoadTestPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">TotalElecPowerRated</span>
<a name="ln-13623"></a>
<a name="ln-13624"></a>      <span class="n">ENDIF</span>
<a name="ln-13625"></a>
<a name="ln-13626"></a>    <span class="n">ENDIF</span>
<a name="ln-13627"></a>  <span class="n">ENDDO</span> <span class="c">! loop over 3 part load test points</span>
<a name="ln-13628"></a>
<a name="ln-13629"></a>
<a name="ln-13630"></a>  <span class="n">IEER</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.02d0</span><span class="o">*</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.617d0</span><span class="o">*</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-13631"></a>          <span class="p">(</span><span class="mf">0.238d0</span><span class="o">*</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.125d0</span><span class="o">*</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-13632"></a>
<a name="ln-13633"></a>  <span class="c">! begin output</span>
<a name="ln-13634"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OneTimeEIOHeaderWrite</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13635"></a><span class="k">    WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">890</span> <span class="p">)</span>
<a name="ln-13636"></a>    <span class="n">OneTimeEIOHeaderWrite</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13637"></a>    <span class="n">pdstVAVDXCoolCoil</span>         <span class="o">=</span> <span class="n">newPreDefSubTable</span><span class="p">(</span><span class="n">pdrEquip</span><span class="p">,</span><span class="s1">&#39;VAV DX Cooling Standard Rating Details&#39;</span><span class="p">)</span>
<a name="ln-13638"></a>    <span class="n">pdchVAVDXCoolCoilType</span>     <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;DX Cooling Coil Type&#39;</span><span class="p">)</span>
<a name="ln-13639"></a>    <span class="n">pdchVAVDXFanName</span>          <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;Assocated Fan&#39;</span><span class="p">)</span>
<a name="ln-13640"></a>    <span class="n">pdchVAVDXCoolCoilNetCapSI</span> <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;Net Cooling Capacity [W]&#39;</span><span class="p">)</span>
<a name="ln-13641"></a>    <span class="n">pdchVAVDXCoolCoilCOP</span>      <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;COP [W/W]&#39;</span><span class="p">)</span>
<a name="ln-13642"></a>    <span class="n">pdchVAVDXCoolCoilEERIP</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;EER [Btu/W-h]&#39;</span><span class="p">)</span>
<a name="ln-13643"></a>    <span class="n">pdchVAVDXCoolCoilIEERIP</span>   <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;IEER [Btu/W-h]&#39;</span><span class="p">)</span>
<a name="ln-13644"></a>    <span class="n">pdchVAVDXCoolCoilMdotA</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;Supply Air Flow 100% [kg/s]&#39;</span><span class="p">)</span>
<a name="ln-13645"></a>    <span class="n">pdchVAVDXCoolCoilCOP_B</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;COP 75% Capacity [W/W]&#39;</span><span class="p">)</span>
<a name="ln-13646"></a>    <span class="n">pdchVAVDXCoolCoilEER_B_IP</span> <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;EER 75% Capacity [Btu/W-h]&#39;</span><span class="p">)</span>
<a name="ln-13647"></a>    <span class="n">pdchVAVDXCoolCoilMdotB</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;Supply Air Flow 75% [kg/s]&#39;</span><span class="p">)</span>
<a name="ln-13648"></a>    <span class="n">pdchVAVDXCoolCoilCOP_C</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;COP 50% Capacity [W/W]&#39;</span><span class="p">)</span>
<a name="ln-13649"></a>    <span class="n">pdchVAVDXCoolCoilEER_C_IP</span> <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;EER 50% Capacity [Btu/W-h]&#39;</span><span class="p">)</span>
<a name="ln-13650"></a>    <span class="n">pdchVAVDXCoolCoilMdotC</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;Supply Air Flow 50% [kg/s]&#39;</span><span class="p">)</span>
<a name="ln-13651"></a>    <span class="n">pdchVAVDXCoolCoilCOP_D</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;COP 25% Capacity [W/W]&#39;</span><span class="p">)</span>
<a name="ln-13652"></a>    <span class="n">pdchVAVDXCoolCoilEER_D_IP</span> <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;EER 25% Capacity [Btu/W-h]&#39;</span><span class="p">)</span>
<a name="ln-13653"></a>    <span class="n">pdchVAVDXCoolCoilMdotD</span>    <span class="o">=</span> <span class="n">newPreDefColumn</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span>   <span class="s1">&#39;Supply Air Flow 25% [kg/s]&#39;</span><span class="p">)</span>
<a name="ln-13654"></a>
<a name="ln-13655"></a>    <span class="c">! determine footnote content</span>
<a name="ln-13656"></a>    <span class="n">countStaticInputs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-13657"></a>    <span class="k">DO </span><span class="nb">index</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumDXCoils</span>
<a name="ln-13658"></a>
<a name="ln-13659"></a>      <span class="k">If</span> <span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="nb">index</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DXCoil</span><span class="p">(</span><span class="nb">index</span><span class="p">)%</span><span class="n">DXCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13660"></a><span class="k">        </span><span class="n">countStaticInputs</span> <span class="o">=</span><span class="n">countStaticInputs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-13661"></a>      <span class="n">ENDIF</span>
<a name="ln-13662"></a>    <span class="n">ENDDO</span>
<a name="ln-13663"></a>
<a name="ln-13664"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">countStaticInputs</span> <span class="o">==</span> <span class="n">NumDXMulSpeedCoils</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13665"></a><span class="k">      CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13666"></a>                <span class="s1">&#39;Packaged VAV unit ratings per ANSI/AHRI Standard 340/360-2007 with Addenda 1 and 2&#39;</span><span class="p">)</span>
<a name="ln-13667"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">countStaticInputs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13668"></a><span class="k">      CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13669"></a>                <span class="s1">&#39;Indoor-coil-only unit ratings per ANSI/AHRI Standard 340/360-2007 with Addenda 1 and 2,&#39;</span> <span class="p">&amp;</span>
<a name="ln-13670"></a>                     <span class="o">//</span> <span class="s1">&#39; with supply fan specific power at 365 {W/1000cfm} (773.3 {W/(m3/s)})&#39;</span><span class="p">)</span>
<a name="ln-13671"></a>    <span class="k">ELSE</span> <span class="c">! both</span>
<a name="ln-13672"></a>      <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstVAVDXCoolCoil</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13673"></a>                <span class="s1">&#39;Packaged VAV unit ratings per ANSI/AHRI Standard 340/360-2007 with Addenda 1 and 2,&#39;</span> <span class="p">&amp;</span>
<a name="ln-13674"></a>                 <span class="o">//</span> <span class="s1">&#39; indoor-coil-only units with supply fan specific power at 365 {W/1000cfm} (773.3 {W/(m3/s)})&#39;</span><span class="p">)</span>
<a name="ln-13675"></a>    <span class="n">ENDIF</span>
<a name="ln-13676"></a>
<a name="ln-13677"></a>  <span class="n">ENDIF</span>
<a name="ln-13678"></a>
<a name="ln-13679"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13680"></a>
<a name="ln-13681"></a><span class="k">    WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">891</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Fan:VariableVolume&#39;</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-13682"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-13683"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NetCoolingCapRated</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-13684"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">NetCoolingCapRated</span> <span class="o">*</span><span class="n">ConvFromSIToIP</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13685"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IEER</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13686"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13687"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),&amp;</span>
<a name="ln-13688"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13689"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13690"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13691"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),&amp;</span>
<a name="ln-13692"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13693"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13694"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13695"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13696"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13697"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-13698"></a>  <span class="k">ELSE</span>
<a name="ln-13699"></a><span class="k">    WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">891</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;N/A&#39;</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-13700"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;N/A&#39;</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-13701"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NetCoolingCapRated</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-13702"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">NetCoolingCapRated</span> <span class="o">*</span><span class="n">ConvFromSIToIP</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13703"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IEER</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13704"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13705"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),&amp;</span>
<a name="ln-13706"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13707"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13708"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13709"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),&amp;</span>
<a name="ln-13710"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13711"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13712"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13713"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13714"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-13715"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-13716"></a>  <span class="n">ENDIF</span>
<a name="ln-13717"></a>
<a name="ln-13718"></a>  <span class="mi">890</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;! &lt;VAV DX Cooling Coil Standard Rating Information&gt;, DX Coil Type, DX Coil Name, Fan Type, Fan Name, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13719"></a>              <span class="s1">&#39;Standard Net Cooling Capacity {W}, Standard Net Cooling Capacity {Btu/h}, IEER {Btu/W-h}, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13720"></a>              <span class="s1">&#39;COP 100% Capacity {W/W}, COP 75% Capacity {W/W}, COP 50% Capacity {W/W}, COP 25% Capacity {W/W}, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13721"></a>              <span class="s1">&#39;EER 100% Capacity {Btu/W-h}, EER 75% Capacity {Btu/W-h}, EER 50% Capacity {Btu/W-h}, EER 25% Capacity {Btu/W-h}, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13722"></a>              <span class="s1">&#39;Supply Air Flow 100% {kg/s}, Supply Air Flow 75% {kg/s},Supply Air Flow 50% {kg/s},Supply Air Flow 25% {kg/s}&#39;</span>  <span class="p">)</span>
<a name="ln-13723"></a>
<a name="ln-13724"></a>  <span class="mi">891</span> <span class="k">FORMAT</span> <span class="p">(</span> <span class="s1">&#39; VAV DX Cooling Coil Standard Rating Information, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span> <span class="p">&amp;</span>
<a name="ln-13725"></a>                    <span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-13726"></a>
<a name="ln-13727"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDXCoolCoilType</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">))</span>
<a name="ln-13728"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDXCoolCoilNetCapSI</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NetCoolingCapRated</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-13729"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDXCoolCoilCOP</span><span class="p">,</span>     <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-13730"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDXCoolCoilEERIP</span><span class="p">,</span>   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-13731"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDXCoolCoilIEERIP</span><span class="p">,</span>  <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IEER</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-13732"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDXCoolCoilSEERIP</span><span class="p">,</span>  <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-13733"></a>  <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstDXCoolCoil</span><span class="p">,</span>     <span class="s1">&#39;ANSI/AHRI ratings include supply fan&#39;</span><span class="p">)</span>
<a name="ln-13734"></a>
<a name="ln-13735"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilType</span><span class="p">,</span>     <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">))</span>
<a name="ln-13736"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13737"></a><span class="k">    CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXFanName</span><span class="p">,</span>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">))</span>
<a name="ln-13738"></a>  <span class="k">ELSE</span>
<a name="ln-13739"></a><span class="k">    CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXFanName</span><span class="p">,</span>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">))</span>
<a name="ln-13740"></a>  <span class="n">ENDIF</span>
<a name="ln-13741"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilNetCapSI</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NetCoolingCapRated</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-13742"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilCOP</span><span class="p">,</span>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">))</span>
<a name="ln-13743"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilIEERIP</span><span class="p">,</span>   <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IEER</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-13744"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilEERIP</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
<a name="ln-13745"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilMdotA</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">4</span><span class="p">)))</span>
<a name="ln-13746"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilCOP_B</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">))</span>
<a name="ln-13747"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilEER_B_IP</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
<a name="ln-13748"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilMdotB</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">)))</span>
<a name="ln-13749"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilCOP_C</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
<a name="ln-13750"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilEER_C_IP</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
<a name="ln-13751"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilMdotC</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)))</span>
<a name="ln-13752"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilCOP_D</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_SI</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
<a name="ln-13753"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilEER_D_IP</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">EER_TestPoint_IP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
<a name="ln-13754"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchVAVDXCoolCoilMdotD</span><span class="p">,</span>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SupAirMdot_TestPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">4</span><span class="p">)))</span>
<a name="ln-13755"></a>
<a name="ln-13756"></a>
<a name="ln-13757"></a>  <span class="k">RETURN</span>
<a name="ln-13758"></a>
<a name="ln-13759"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTwoSpeedDXCoilStandardRating</span>
<a name="ln-13760"></a>
<a name="ln-13761"></a><span class="k">SUBROUTINE </span><span class="n">GetFanIndexForTwoSpeedCoil</span><span class="p">(</span> <span class="n">CoolingCoilIndex</span> <span class="p">,</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">SupplyFanName</span> <span class="p">)</span>
<a name="ln-13762"></a>
<a name="ln-13763"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-13764"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-13765"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-13766"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-13767"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-13768"></a>
<a name="ln-13769"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-13770"></a>          <span class="c">! This routine looks up the given TwoSpeed DX coil and returns the companion supply fan index</span>
<a name="ln-13771"></a>
<a name="ln-13772"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13773"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-13774"></a>
<a name="ln-13775"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13776"></a>          <span class="c">! na</span>
<a name="ln-13777"></a>
<a name="ln-13778"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13779"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>            <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-13780"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>            <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-13781"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetFanIndex</span>
<a name="ln-13782"></a>
<a name="ln-13783"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>           <span class="n">ONLY</span> <span class="p">:</span> <span class="n">NumPrimaryAirSys</span>
<a name="ln-13784"></a>
<a name="ln-13785"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13786"></a>
<a name="ln-13787"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13788"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">CoolingCoilIndex</span>
<a name="ln-13789"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">SupplyFanIndex</span>
<a name="ln-13790"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SupplyFanName</span>
<a name="ln-13791"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-13792"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DXSystem</span> <span class="o">=</span> <span class="mi">14</span> <span class="c">! must match SimAirServingZones.f90 (not public)</span>
<a name="ln-13793"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Fan_Simple_VAV</span>   <span class="o">=</span> <span class="mi">3</span> <span class="c">! must match SimAirServingZones.f90 (not public)</span>
<a name="ln-13794"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UnitarySystem</span>    <span class="o">=</span> <span class="mi">19</span> <span class="c">! must match SimAirServingZones.f90 (not public)</span>
<a name="ln-13795"></a>
<a name="ln-13796"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-13797"></a>          <span class="c">! na</span>
<a name="ln-13798"></a>
<a name="ln-13799"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-13800"></a>          <span class="c">! na</span>
<a name="ln-13801"></a>
<a name="ln-13802"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13803"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FoundBranch</span>
<a name="ln-13804"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FoundAirSysNum</span>
<a name="ln-13805"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirSysNum</span>
<a name="ln-13806"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BranchNum</span>
<a name="ln-13807"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-13808"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13809"></a>
<a name="ln-13810"></a>  <span class="n">FoundBranch</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-13811"></a>  <span class="n">FoundAirSysNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-13812"></a>  <span class="n">SupplyFanIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-13813"></a>  <span class="n">SupplyFanName</span> <span class="o">=</span> <span class="s1">&#39;n/a&#39;</span>
<a name="ln-13814"></a>  <span class="k">DO </span><span class="n">AirSysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPrimaryAirSys</span>
<a name="ln-13815"></a>
<a name="ln-13816"></a>    <span class="k">DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirSysNum</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-13817"></a>
<a name="ln-13818"></a>      <span class="k">Do </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-13819"></a>
<a name="ln-13820"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CompType_Num</span> <span class="o">==</span> <span class="n">DXSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13821"></a>
<a name="ln-13822"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13823"></a>                        <span class="n">DXCoil</span><span class="p">(</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">CoilSystemName</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13824"></a><span class="k">            </span><span class="n">FoundBranch</span>    <span class="o">=</span> <span class="n">BranchNum</span>
<a name="ln-13825"></a>            <span class="n">FoundAirSysNum</span> <span class="o">=</span> <span class="n">AirSysNum</span>
<a name="ln-13826"></a>            <span class="k">EXIT</span>
<a name="ln-13827"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-13828"></a>        <span class="c">! these are specified in SimAirServingZones and need to be moved to a Data* file. UnitarySystem=19</span>
<a name="ln-13829"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CompType_Num</span> <span class="o">==</span> <span class="n">UnitarySystem</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-13830"></a><span class="k">            </span><span class="n">FoundBranch</span>    <span class="o">=</span> <span class="n">BranchNum</span>
<a name="ln-13831"></a>            <span class="n">FoundAirSysNum</span> <span class="o">=</span> <span class="n">AirSysNum</span>
<a name="ln-13832"></a>            <span class="k">EXIT</span>
<a name="ln-13833"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-13834"></a>      <span class="n">ENDDO</span>
<a name="ln-13835"></a>
<a name="ln-13836"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FoundBranch</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">FoundAirSysNum</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13837"></a><span class="k">        Do </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">FoundAirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">FoundBranch</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-13838"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">FoundAirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">FoundBranch</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CompType_Num</span> <span class="o">==</span> <span class="n">Fan_Simple_VAV</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13839"></a><span class="k">            </span><span class="n">SupplyFanName</span>  <span class="o">=</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">FoundAirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">FoundBranch</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-13840"></a>            <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">SupplyFanName</span><span class="p">,</span> <span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-13841"></a>            <span class="k">EXIT</span>
<a name="ln-13842"></a>          <span class="c">! these are specified in SimAirServingZones and need to be moved to a Data* file. UnitarySystem=19</span>
<a name="ln-13843"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">FoundAirSysNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">FoundBranch</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CompType_Num</span> <span class="o">==</span> <span class="n">UnitarySystem</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-13844"></a>            <span class="c">! fan may not be specified in a unitary system object, keep looking</span>
<a name="ln-13845"></a>            <span class="c">! Unitary System will &quot;set&quot; the fan index to the DX coil if contained within the HVAC system</span>
<a name="ln-13846"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">SupplyFanIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-13847"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-13848"></a>        <span class="n">ENDDO</span>
<a name="ln-13849"></a>      <span class="n">ENDIF</span>
<a name="ln-13850"></a>    <span class="n">ENDDO</span>
<a name="ln-13851"></a>  <span class="n">ENDDO</span>
<a name="ln-13852"></a>  <span class="k">RETURN</span>
<a name="ln-13853"></a>
<a name="ln-13854"></a><span class="k">END SUBROUTINE </span><span class="n">GetFanIndexForTwoSpeedCoil</span>
<a name="ln-13855"></a>
<a name="ln-13856"></a><span class="k">FUNCTION </span><span class="n">CalcTwoSpeedDXCoilIEERResidual</span><span class="p">(</span><span class="n">SupplyAirMassFlowRate</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13857"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13858"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-13859"></a>          <span class="c">!       DATE WRITTEN   July 2012</span>
<a name="ln-13860"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13861"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13862"></a>
<a name="ln-13863"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13864"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13865"></a>          <span class="c">! Two Speed DX Coil rating for VAV, output depends on the supply air flow rate which is being varied to zero the residual.</span>
<a name="ln-13866"></a>
<a name="ln-13867"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13868"></a>          <span class="c">! Calls CalcMultiSpeedDXCoil to get outlet temperature at the given supply flow rate and SpeedRatio</span>
<a name="ln-13869"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13870"></a>
<a name="ln-13871"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13872"></a>
<a name="ln-13873"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13874"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-13875"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-13876"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-13877"></a>
<a name="ln-13878"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13879"></a>
<a name="ln-13880"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13881"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SupplyAirMassFlowRate</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13882"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13883"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-13884"></a>                                                    <span class="c">! par(3) = speed ratio</span>
<a name="ln-13885"></a>                                                    <span class="c">! par(4) = cycling Ratio</span>
<a name="ln-13886"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-13887"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13888"></a>
<a name="ln-13889"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13890"></a>          <span class="c">! na</span>
<a name="ln-13891"></a>
<a name="ln-13892"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13893"></a>          <span class="c">! na</span>
<a name="ln-13894"></a>
<a name="ln-13895"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13896"></a>          <span class="c">! na</span>
<a name="ln-13897"></a>
<a name="ln-13898"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13899"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DXCoilNum</span>       <span class="c">! index of this coil</span>
<a name="ln-13900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-13901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TargetCoilLeavingDryblub</span>
<a name="ln-13902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorUnitInletDryBulb</span>
<a name="ln-13903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IndoorUnitInletDryBulb</span>
<a name="ln-13904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IndoorUnitInletWetBulb</span>
<a name="ln-13905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>
<a name="ln-13906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>
<a name="ln-13907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>
<a name="ln-13908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirRho</span>
<a name="ln-13909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirHumRat</span>
<a name="ln-13910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetCoolingCapRated</span>
<a name="ln-13911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TargetNetCapacity</span>
<a name="ln-13912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanPowerPerEvapAirFlowRate</span>
<a name="ln-13913"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanInletNodeNum</span>
<a name="ln-13914"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOutletNodeNum</span>
<a name="ln-13915"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanIndex</span>
<a name="ln-13916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanExternalStaticFull</span>
<a name="ln-13917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirVolFlowRate</span>
<a name="ln-13918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanStaticPressureRise</span>
<a name="ln-13919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-13921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>
<a name="ln-13922"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HighSpeedNetCoolingCap</span>
<a name="ln-13923"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowSpeedNetCoolingCap</span>
<a name="ln-13924"></a>
<a name="ln-13925"></a>  <span class="n">DXCoilNum</span>                <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13926"></a>  <span class="n">TargetCoilLeavingDryblub</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-13927"></a>  <span class="n">TargetNetCapacity</span>        <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-13928"></a>  <span class="n">OutdoorUnitInletDryBulb</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13929"></a>  <span class="n">IndoorUnitInletWetBulb</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-13930"></a>  <span class="n">IndoorUnitInletDryBulb</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-13931"></a>  <span class="n">NetCoolingCapRated</span>       <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-13932"></a>  <span class="n">FanPowerPerEvapAirFlowRate</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13933"></a>  <span class="n">FanInletNodeNum</span>          <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-13934"></a>  <span class="n">FanOutletNodeNum</span>         <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-13935"></a>  <span class="n">FanExternalStaticFull</span>    <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-13936"></a>  <span class="n">FanIndex</span>                 <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-13937"></a>
<a name="ln-13938"></a>
<a name="ln-13939"></a>
<a name="ln-13940"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13941"></a><span class="k">    </span><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">SupplyAirMassFlowRate</span> <span class="o">/</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedAirMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-13942"></a>  <span class="k">ELSE</span>
<a name="ln-13943"></a><span class="k">    </span><span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-13944"></a>  <span class="n">ENDIF</span>
<a name="ln-13945"></a>  <span class="n">SupplyAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">IndoorUnitInletDryBulb</span><span class="p">,</span> <span class="n">IndoorUnitInletWetBulb</span><span class="p">,</span> <span class="n">OutBaroPress</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13946"></a>                                    <span class="s1">&#39;CalcTwoSpeedDXCoilIEERResidual&#39;</span><span class="p">)</span>
<a name="ln-13947"></a>  <span class="n">SupplyAirRho</span> <span class="o">=</span>  <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">IndoorUnitInletDryBulb</span><span class="p">,</span> <span class="n">SupplyAirHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13948"></a>                                    <span class="s1">&#39;CalcTwoSpeedDXCoilIEERResidual&#39;</span><span class="p">)</span>
<a name="ln-13949"></a>
<a name="ln-13950"></a>
<a name="ln-13951"></a>  <span class="n">SupplyAirVolFlowRate</span> <span class="o">=</span> <span class="n">SupplyAirMassFlowRate</span> <span class="o">/</span> <span class="n">SupplyAirRho</span>
<a name="ln-13952"></a>
<a name="ln-13953"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RateWithInternalStaticAndFanObject</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13954"></a>    <span class="c">! modify external static per AHRI 340/360, Table 6, note 1.</span>
<a name="ln-13955"></a>    <span class="n">FanStaticPressureRise</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InternalStaticPressureDrop</span> <span class="p">&amp;</span>
<a name="ln-13956"></a>                   <span class="o">+</span> <span class="p">(</span><span class="n">FanExternalStaticFull</span> <span class="o">*</span> <span class="p">(</span><span class="n">AirMassFlowRatio</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-13957"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">SupplyAirMassFlowRate</span>
<a name="ln-13958"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FanOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">SupplyAirMassFlowRate</span>
<a name="ln-13959"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">IndoorUnitInletDryBulb</span>
<a name="ln-13960"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">IndoorUnitInletDryBulb</span><span class="p">,</span> <span class="n">IndoorUnitInletWetBulb</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13961"></a>                                                       <span class="n">OutBaroPress</span> <span class="p">,</span> <span class="s1">&#39;CalcTwoSpeedDXCoilIEERResidual&#39;</span><span class="p">)</span>
<a name="ln-13962"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">IndoorUnitInletDryBulb</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13963"></a>                                                    <span class="s1">&#39;CalcTwoSpeedDXCoilIEERResidual&#39;</span><span class="p">)</span>
<a name="ln-13964"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13965"></a>                                 <span class="n">ZoneCompTurnFansOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13966"></a>                                 <span class="n">ZoneCompTurnFansOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13967"></a>                                 <span class="n">PressureRise</span> <span class="o">=</span> <span class="n">FanStaticPressureRise</span><span class="p">)</span>
<a name="ln-13968"></a>    <span class="n">FanHeatCorrection</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">FanInletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-13969"></a>
<a name="ln-13970"></a>  <span class="k">ELSE</span>
<a name="ln-13971"></a>
<a name="ln-13972"></a><span class="k">   </span><span class="n">FanHeatCorrection</span>  <span class="o">=</span> <span class="n">FanPowerPerEvapAirFlowRate</span> <span class="o">*</span> <span class="n">SupplyAirVolFlowRate</span>
<a name="ln-13973"></a>
<a name="ln-13974"></a>  <span class="n">ENDIF</span>
<a name="ln-13975"></a>
<a name="ln-13976"></a>  <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-13977"></a>  <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">IndoorUnitInletWetBulb</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-13978"></a>                               <span class="n">OutdoorUnitInletDryBulb</span><span class="p">)</span>
<a name="ln-13979"></a>  <span class="n">HighSpeedNetCoolingCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>       <span class="p">&amp;</span>
<a name="ln-13980"></a>                          <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13981"></a>
<a name="ln-13982"></a>  <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-13983"></a>  <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CCapFTemp2</span><span class="p">,</span><span class="n">IndoorUnitInletWetBulb</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-13984"></a>                               <span class="n">OutdoorUnitInletDryBulb</span><span class="p">)</span>
<a name="ln-13985"></a>  <span class="n">LowSpeedNetCoolingCap</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>       <span class="p">&amp;</span>
<a name="ln-13986"></a>                              <span class="o">-</span> <span class="n">FanHeatCorrection</span>
<a name="ln-13987"></a>
<a name="ln-13988"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">LowSpeedNetCoolingCap</span> <span class="o">&lt;=</span> <span class="n">TargetNetCapacity</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13989"></a><span class="k">    </span><span class="n">CycRatio</span>   <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-13990"></a>    <span class="n">SpeedRatio</span> <span class="o">=</span>  <span class="p">(</span><span class="n">TargetNetCapacity</span> <span class="o">-</span> <span class="n">LowSpeedNetCoolingCap</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-13991"></a>                   <span class="o">/</span><span class="p">(</span> <span class="n">HighSpeedNetCoolingCap</span> <span class="o">-</span> <span class="n">LowSpeedNetCoolingCap</span> <span class="p">)</span>
<a name="ln-13992"></a>  <span class="k">ELSE</span> <span class="c">! minimum unloading limit exceeded for no cycling</span>
<a name="ln-13993"></a>    <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-13994"></a>    <span class="n">CycRatio</span>   <span class="o">=</span>  <span class="n">TargetNetCapacity</span> <span class="o">/</span> <span class="n">LowSpeedNetCoolingCap</span>
<a name="ln-13995"></a>  <span class="n">ENDIF</span>
<a name="ln-13996"></a>
<a name="ln-13997"></a>  <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>    <span class="o">=</span> <span class="n">SupplyAirMassFlowRate</span>
<a name="ln-13998"></a>
<a name="ln-13999"></a>  <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">ForceOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-14000"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)</span>
<a name="ln-14001"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">TargetCoilLeavingDryblub</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14002"></a>
<a name="ln-14003"></a>  <span class="k">RETURN</span>
<a name="ln-14004"></a><span class="k">END FUNCTION </span><span class="n">CalcTwoSpeedDXCoilIEERResidual</span>
<a name="ln-14005"></a>
<a name="ln-14006"></a>
<a name="ln-14007"></a><span class="c">! ======================  Utility routines ======================================</span>
<a name="ln-14008"></a>
<a name="ln-14009"></a><span class="k">SUBROUTINE </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">DXCoilName</span><span class="p">,</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ThisObjectType</span><span class="p">,</span><span class="n">SuppressWarning</span><span class="p">)</span>
<a name="ln-14010"></a>
<a name="ln-14011"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-14012"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-14013"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-14014"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14015"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14016"></a>
<a name="ln-14017"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-14018"></a>          <span class="c">! This subroutine sets an index for a given DX Coil -- issues error message if that</span>
<a name="ln-14019"></a>          <span class="c">! DX Coil is not a legal DX Coil.</span>
<a name="ln-14020"></a>
<a name="ln-14021"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14022"></a>          <span class="c">! na</span>
<a name="ln-14023"></a>
<a name="ln-14024"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14025"></a>          <span class="c">! na</span>
<a name="ln-14026"></a>
<a name="ln-14027"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14028"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14029"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span>
<a name="ln-14030"></a>
<a name="ln-14031"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14032"></a>
<a name="ln-14033"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14034"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilName</span>
<a name="ln-14035"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">DXCoilIndex</span>
<a name="ln-14036"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-14037"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">ThisObjectType</span>
<a name="ln-14038"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SuppressWarning</span>
<a name="ln-14039"></a>
<a name="ln-14040"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-14041"></a>          <span class="c">! na</span>
<a name="ln-14042"></a>
<a name="ln-14043"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14044"></a>          <span class="c">! na</span>
<a name="ln-14045"></a>
<a name="ln-14046"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14047"></a>          <span class="c">! na</span>
<a name="ln-14048"></a>
<a name="ln-14049"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14050"></a>          <span class="c">! na</span>
<a name="ln-14051"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14052"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14053"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14054"></a>  <span class="k">END IF</span>
<a name="ln-14055"></a>
<a name="ln-14056"></a><span class="k">  </span><span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">DXCoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14057"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14058"></a><span class="k">    IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SuppressWarning</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14059"></a><span class="c">!     No warning printed if only searching for the existence of a DX Coil</span>
<a name="ln-14060"></a>    <span class="k">ELSE</span>
<a name="ln-14061"></a><span class="k">      IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ThisObjectType</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14062"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ThisObjectType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, GetDXCoilIndex: DX Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoilName</span><span class="p">))</span>
<a name="ln-14063"></a>      <span class="k">ELSE</span>
<a name="ln-14064"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilIndex: DX Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoilName</span><span class="p">))</span>
<a name="ln-14065"></a>      <span class="n">ENDIF</span>
<a name="ln-14066"></a>    <span class="k">END IF</span>
<a name="ln-14067"></a><span class="k">    </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14068"></a>  <span class="n">ENDIF</span>
<a name="ln-14069"></a>
<a name="ln-14070"></a>  <span class="k">RETURN</span>
<a name="ln-14071"></a>
<a name="ln-14072"></a><span class="k">END SUBROUTINE </span><span class="n">GetDXCoilIndex</span>
<a name="ln-14073"></a>
<a name="ln-14074"></a><span class="k">FUNCTION </span><span class="n">GetCoilCapacity</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilCapacity</span><span class="p">)</span>
<a name="ln-14075"></a>
<a name="ln-14076"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14077"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-14078"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-14079"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14080"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14081"></a>
<a name="ln-14082"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14083"></a>          <span class="c">! This function looks up the coil capacity for the given coil and returns it.  If</span>
<a name="ln-14084"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-14085"></a>          <span class="c">! as negative.</span>
<a name="ln-14086"></a>
<a name="ln-14087"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14088"></a>          <span class="c">! na</span>
<a name="ln-14089"></a>
<a name="ln-14090"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14091"></a>          <span class="c">! na</span>
<a name="ln-14092"></a>
<a name="ln-14093"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14094"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-14095"></a>
<a name="ln-14096"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14097"></a>
<a name="ln-14098"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14099"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14100"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14101"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CoilCapacity</span> <span class="c">! returned capacity of matched coil</span>
<a name="ln-14103"></a>
<a name="ln-14104"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14105"></a>          <span class="c">! na</span>
<a name="ln-14106"></a>
<a name="ln-14107"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14108"></a>          <span class="c">! na</span>
<a name="ln-14109"></a>
<a name="ln-14110"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14111"></a>          <span class="c">! na</span>
<a name="ln-14112"></a>
<a name="ln-14113"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14114"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14115"></a>
<a name="ln-14116"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14117"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14118"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14119"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14120"></a>  <span class="k">END IF</span>
<a name="ln-14121"></a>
<a name="ln-14122"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:DX:SingleSpeed&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-14123"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14124"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14125"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14126"></a><span class="k">      </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14127"></a>    <span class="n">ENDIF</span>
<a name="ln-14128"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14129"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14130"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14131"></a><span class="k">      </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">NumCapacityStages</span><span class="p">)</span>
<a name="ln-14132"></a>    <span class="n">ENDIF</span>
<a name="ln-14133"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14134"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14135"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14136"></a><span class="k">      </span><span class="n">CoilCapacity</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14137"></a>    <span class="n">ENDIF</span>
<a name="ln-14138"></a>  <span class="k">ELSE</span>
<a name="ln-14139"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14140"></a>  <span class="n">ENDIF</span>
<a name="ln-14141"></a>
<a name="ln-14142"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14143"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilCapacity: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14144"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... returning capacity as -1000.&#39;</span><span class="p">)</span>
<a name="ln-14145"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14146"></a>    <span class="n">CoilCapacity</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-14147"></a>  <span class="n">ENDIF</span>
<a name="ln-14148"></a>
<a name="ln-14149"></a>  <span class="k">RETURN</span>
<a name="ln-14150"></a>
<a name="ln-14151"></a><span class="k">END FUNCTION </span><span class="n">GetCoilCapacity</span>
<a name="ln-14152"></a>
<a name="ln-14153"></a><span class="k">FUNCTION </span><span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">CoilType_Num</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CoilCapacity</span><span class="p">)</span>
<a name="ln-14154"></a>
<a name="ln-14155"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14156"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-14157"></a>          <span class="c">!       DATE WRITTEN   October 2010</span>
<a name="ln-14158"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14159"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14160"></a>
<a name="ln-14161"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14162"></a>          <span class="c">! This function looks up the coil capacity for the given coil and returns it.  If</span>
<a name="ln-14163"></a>          <span class="c">! incorrect coil index or type is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-14164"></a>          <span class="c">! as negative.</span>
<a name="ln-14165"></a>
<a name="ln-14166"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14167"></a>          <span class="c">! na</span>
<a name="ln-14168"></a>
<a name="ln-14169"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14170"></a>          <span class="c">! na</span>
<a name="ln-14171"></a>
<a name="ln-14172"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14173"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-14174"></a>
<a name="ln-14175"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14176"></a>
<a name="ln-14177"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14178"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilIndex</span>    <span class="c">! must match coil index for the coil type</span>
<a name="ln-14179"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilType_Num</span> <span class="c">! must match coil types in this module</span>
<a name="ln-14180"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CoilCapacity</span> <span class="c">! returned capacity of matched coil</span>
<a name="ln-14182"></a>
<a name="ln-14183"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14184"></a>          <span class="c">! na</span>
<a name="ln-14185"></a>
<a name="ln-14186"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14187"></a>          <span class="c">! na</span>
<a name="ln-14188"></a>
<a name="ln-14189"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14190"></a>          <span class="c">! na</span>
<a name="ln-14191"></a>
<a name="ln-14192"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14193"></a>          <span class="c">! na</span>
<a name="ln-14194"></a>
<a name="ln-14195"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14196"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14197"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14198"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14199"></a>  <span class="k">END IF</span>
<a name="ln-14200"></a>
<a name="ln-14201"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14202"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilCapacityByIndexType: Invalid index passed = 0&#39;</span><span class="p">)</span>
<a name="ln-14203"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... returning capacity as -1000.&#39;</span><span class="p">)</span>
<a name="ln-14204"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14205"></a>    <span class="n">CoilCapacity</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-14206"></a>    <span class="k">RETURN</span>
<a name="ln-14207"></a><span class="k">  END IF</span>
<a name="ln-14208"></a>
<a name="ln-14209"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CoilType_Num</span> <span class="o">/=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14210"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilCapacityByIndexType: Index passed does not match DX Coil type passed.&#39;</span><span class="p">)</span>
<a name="ln-14211"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... returning capacity as -1000.&#39;</span><span class="p">)</span>
<a name="ln-14212"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14213"></a>    <span class="n">CoilCapacity</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-14214"></a>  <span class="k">ELSE</span>
<a name="ln-14215"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-14216"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-14217"></a>        <span class="n">CoilCapacity</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">MSRatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">NumOfSpeeds</span><span class="p">)</span>
<a name="ln-14218"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-14219"></a>        <span class="n">CoilCapacity</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">NumCapacityStages</span><span class="p">)</span>
<a name="ln-14220"></a>    <span class="k">END SELECT</span>
<a name="ln-14221"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-14222"></a>
<a name="ln-14223"></a>  <span class="k">RETURN</span>
<a name="ln-14224"></a>
<a name="ln-14225"></a><span class="k">END FUNCTION </span><span class="n">GetCoilCapacityByIndexType</span>
<a name="ln-14226"></a>
<a name="ln-14227"></a><span class="k">FUNCTION </span><span class="n">GetCoilTypeNum</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">PrintWarning</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">TypeNum</span><span class="p">)</span>
<a name="ln-14228"></a>
<a name="ln-14229"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14230"></a>          <span class="c">!       AUTHOR         R. Raustad - FSEC</span>
<a name="ln-14231"></a>          <span class="c">!       DATE WRITTEN   August 2008</span>
<a name="ln-14232"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14233"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14234"></a>
<a name="ln-14235"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14236"></a>          <span class="c">! This function looks up the integerized coil type for the given coil and returns it.  If</span>
<a name="ln-14237"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-14238"></a>          <span class="c">! as negative.</span>
<a name="ln-14239"></a>
<a name="ln-14240"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14241"></a>          <span class="c">! na</span>
<a name="ln-14242"></a>
<a name="ln-14243"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14244"></a>          <span class="c">! na</span>
<a name="ln-14245"></a>
<a name="ln-14246"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14247"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14248"></a>
<a name="ln-14249"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14250"></a>
<a name="ln-14251"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14252"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14253"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14254"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14255"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">PrintWarning</span> <span class="c">! prints warning when true</span>
<a name="ln-14256"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TypeNum</span>      <span class="c">! returned integerized type of matched coil</span>
<a name="ln-14257"></a>
<a name="ln-14258"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14259"></a>          <span class="c">! na</span>
<a name="ln-14260"></a>
<a name="ln-14261"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14262"></a>          <span class="c">! na</span>
<a name="ln-14263"></a>
<a name="ln-14264"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14265"></a>          <span class="c">! na</span>
<a name="ln-14266"></a>
<a name="ln-14267"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14268"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14269"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PrintMessage</span>
<a name="ln-14270"></a>
<a name="ln-14271"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14272"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14273"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14274"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14275"></a>  <span class="k">END IF</span>
<a name="ln-14276"></a>
<a name="ln-14277"></a><span class="k">  IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PrintWarning</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14278"></a><span class="k">    </span><span class="n">PrintMessage</span> <span class="o">=</span> <span class="n">PrintWarning</span>
<a name="ln-14279"></a>  <span class="k">ELSE</span>
<a name="ln-14280"></a><span class="k">    </span><span class="n">PrintMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14281"></a>  <span class="k">END IF</span>
<a name="ln-14282"></a>
<a name="ln-14283"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14284"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14285"></a><span class="k">    </span><span class="n">TypeNum</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">DXCoilType_Num</span>
<a name="ln-14286"></a>  <span class="k">ELSE</span>
<a name="ln-14287"></a><span class="k">   IF</span><span class="p">(</span><span class="n">PrintMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14288"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilTypeNum: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14289"></a>   <span class="k">END IF</span>
<a name="ln-14290"></a><span class="k">     </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14291"></a>     <span class="n">TypeNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14292"></a>  <span class="n">ENDIF</span>
<a name="ln-14293"></a>
<a name="ln-14294"></a>  <span class="k">RETURN</span>
<a name="ln-14295"></a>
<a name="ln-14296"></a><span class="k">END FUNCTION </span><span class="n">GetCoilTypeNum</span>
<a name="ln-14297"></a>
<a name="ln-14298"></a><span class="k">FUNCTION </span><span class="n">GetMinOATCompressor</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">MinOAT</span><span class="p">)</span>
<a name="ln-14299"></a>
<a name="ln-14300"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14301"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-14302"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-14303"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14304"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14305"></a>
<a name="ln-14306"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14307"></a>          <span class="c">! This function looks up the the min oat for the heating coil compressor and returns it.  If</span>
<a name="ln-14308"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and value is returned</span>
<a name="ln-14309"></a>          <span class="c">! as negative.</span>
<a name="ln-14310"></a>
<a name="ln-14311"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14312"></a>          <span class="c">! na</span>
<a name="ln-14313"></a>
<a name="ln-14314"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14315"></a>          <span class="c">! na</span>
<a name="ln-14316"></a>
<a name="ln-14317"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14318"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-14319"></a>
<a name="ln-14320"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14321"></a>
<a name="ln-14322"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14323"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14324"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14325"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinOAT</span>       <span class="c">! returned min oa temperature of matched coil</span>
<a name="ln-14327"></a>
<a name="ln-14328"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14329"></a>          <span class="c">! na</span>
<a name="ln-14330"></a>
<a name="ln-14331"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14332"></a>          <span class="c">! na</span>
<a name="ln-14333"></a>
<a name="ln-14334"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14335"></a>          <span class="c">! na</span>
<a name="ln-14336"></a>
<a name="ln-14337"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14338"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14339"></a>
<a name="ln-14340"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14341"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14342"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14343"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14344"></a>  <span class="k">END IF</span>
<a name="ln-14345"></a>
<a name="ln-14346"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:DX:SingleSpeed&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14347"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-14348"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14349"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14350"></a><span class="k">      </span><span class="n">MinOAT</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">MinOATCompressor</span>
<a name="ln-14351"></a>    <span class="n">ENDIF</span>
<a name="ln-14352"></a>  <span class="k">ELSE</span>
<a name="ln-14353"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14354"></a>  <span class="n">ENDIF</span>
<a name="ln-14355"></a>
<a name="ln-14356"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14357"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetMinOATCompressor: Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-14358"></a>                         <span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14359"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... returning Min OAT as -1000.&#39;</span><span class="p">)</span>
<a name="ln-14360"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14361"></a>    <span class="n">MinOAT</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-14362"></a>  <span class="n">ENDIF</span>
<a name="ln-14363"></a>
<a name="ln-14364"></a>  <span class="k">RETURN</span>
<a name="ln-14365"></a>
<a name="ln-14366"></a><span class="k">END FUNCTION </span><span class="n">GetMinOATCompressor</span>
<a name="ln-14367"></a>
<a name="ln-14368"></a><span class="k">FUNCTION </span><span class="n">GetCoilInletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-14369"></a>
<a name="ln-14370"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14371"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-14372"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-14373"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14374"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14375"></a>
<a name="ln-14376"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14377"></a>          <span class="c">! This function looks up the given coil and returns the inlet node number.  If</span>
<a name="ln-14378"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-14379"></a>          <span class="c">! as zero.</span>
<a name="ln-14380"></a>
<a name="ln-14381"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14382"></a>          <span class="c">! na</span>
<a name="ln-14383"></a>
<a name="ln-14384"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14385"></a>          <span class="c">! na</span>
<a name="ln-14386"></a>
<a name="ln-14387"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14388"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14389"></a>
<a name="ln-14390"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14391"></a>
<a name="ln-14392"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14393"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14394"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14395"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14396"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned node number of matched coil</span>
<a name="ln-14397"></a>
<a name="ln-14398"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14399"></a>          <span class="c">! na</span>
<a name="ln-14400"></a>
<a name="ln-14401"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14402"></a>          <span class="c">! na</span>
<a name="ln-14403"></a>
<a name="ln-14404"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14405"></a>          <span class="c">! na</span>
<a name="ln-14406"></a>
<a name="ln-14407"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14408"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14409"></a>
<a name="ln-14410"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14411"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14412"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14413"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14414"></a>  <span class="k">END IF</span>
<a name="ln-14415"></a>
<a name="ln-14416"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14417"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14418"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-14419"></a>  <span class="k">ELSE</span>
<a name="ln-14420"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilInletNode: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14421"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14422"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14423"></a>  <span class="n">ENDIF</span>
<a name="ln-14424"></a>
<a name="ln-14425"></a>  <span class="k">RETURN</span>
<a name="ln-14426"></a>
<a name="ln-14427"></a><span class="k">END FUNCTION </span><span class="n">GetCoilInletNode</span>
<a name="ln-14428"></a>
<a name="ln-14429"></a><span class="k">FUNCTION </span><span class="n">GetCoilOutletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-14430"></a>
<a name="ln-14431"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14432"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-14433"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-14434"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14435"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14436"></a>
<a name="ln-14437"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14438"></a>          <span class="c">! This function looks up the given coil and returns the inlet node number.  If</span>
<a name="ln-14439"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-14440"></a>          <span class="c">! as zero.</span>
<a name="ln-14441"></a>
<a name="ln-14442"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14443"></a>          <span class="c">! na</span>
<a name="ln-14444"></a>
<a name="ln-14445"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14446"></a>          <span class="c">! na</span>
<a name="ln-14447"></a>
<a name="ln-14448"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14449"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14450"></a>
<a name="ln-14451"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14452"></a>
<a name="ln-14453"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14454"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14455"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14456"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14457"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned node number of matched coil</span>
<a name="ln-14458"></a>
<a name="ln-14459"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14460"></a>          <span class="c">! na</span>
<a name="ln-14461"></a>
<a name="ln-14462"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14463"></a>          <span class="c">! na</span>
<a name="ln-14464"></a>
<a name="ln-14465"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14466"></a>          <span class="c">! na</span>
<a name="ln-14467"></a>
<a name="ln-14468"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14469"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14470"></a>
<a name="ln-14471"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14472"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14473"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14474"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14475"></a>  <span class="k">END IF</span>
<a name="ln-14476"></a>
<a name="ln-14477"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14479"></a><span class="k">    </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirOutNode</span>
<a name="ln-14480"></a>  <span class="k">ELSE</span>
<a name="ln-14481"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilOutletNode: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-14482"></a>          <span class="s1">&#39;&quot; when accessing coil outlet node number.&#39;</span><span class="p">)</span>
<a name="ln-14483"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14484"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14485"></a>  <span class="n">ENDIF</span>
<a name="ln-14486"></a>
<a name="ln-14487"></a>  <span class="k">RETURN</span>
<a name="ln-14488"></a>
<a name="ln-14489"></a><span class="k">END FUNCTION </span><span class="n">GetCoilOutletNode</span>
<a name="ln-14490"></a>
<a name="ln-14491"></a><span class="k">FUNCTION </span><span class="n">GetCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CondNode</span><span class="p">)</span>
<a name="ln-14492"></a>
<a name="ln-14493"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14494"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-14495"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-14496"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14497"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14498"></a>
<a name="ln-14499"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14500"></a>          <span class="c">! This function looks up the given coil and returns the condenser inlet node.  If</span>
<a name="ln-14501"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true.</span>
<a name="ln-14502"></a>
<a name="ln-14503"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14504"></a>          <span class="c">! na</span>
<a name="ln-14505"></a>
<a name="ln-14506"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14507"></a>          <span class="c">! na</span>
<a name="ln-14508"></a>
<a name="ln-14509"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14510"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14511"></a>
<a name="ln-14512"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14513"></a>
<a name="ln-14514"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14515"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14516"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14517"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14518"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CondNode</span>     <span class="c">! returned condenser node number of matched coil</span>
<a name="ln-14519"></a>
<a name="ln-14520"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14521"></a>          <span class="c">! na</span>
<a name="ln-14522"></a>
<a name="ln-14523"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14524"></a>          <span class="c">! na</span>
<a name="ln-14525"></a>
<a name="ln-14526"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14527"></a>          <span class="c">! na</span>
<a name="ln-14528"></a>
<a name="ln-14529"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14530"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14531"></a>
<a name="ln-14532"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14533"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14534"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14535"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14536"></a>  <span class="k">END IF</span>
<a name="ln-14537"></a>
<a name="ln-14538"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14539"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14540"></a><span class="k">    </span><span class="n">CondNode</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14541"></a>   <span class="k">ELSE</span>
<a name="ln-14542"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilCondenserInletNode: Invalid DX Coil, Type= &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14543"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14544"></a>    <span class="n">CondNode</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14545"></a>  <span class="n">ENDIF</span>
<a name="ln-14546"></a>
<a name="ln-14547"></a>  <span class="k">RETURN</span>
<a name="ln-14548"></a>
<a name="ln-14549"></a><span class="k">END FUNCTION </span><span class="n">GetCoilCondenserInletNode</span>
<a name="ln-14550"></a>
<a name="ln-14551"></a><span class="k">FUNCTION </span><span class="n">GetDXCoilBypassedFlowFrac</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">BypassFraction</span><span class="p">)</span>
<a name="ln-14552"></a>
<a name="ln-14553"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14554"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-14555"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-14556"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14557"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14558"></a>
<a name="ln-14559"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14560"></a>          <span class="c">! This function looks up the given coil and returns the bypassed air flow fraction.</span>
<a name="ln-14561"></a>          <span class="c">! Bypassed air flow fraction can only be greater than 0 for multimode DX cooling coils and is typical for 1st stage</span>
<a name="ln-14562"></a>          <span class="c">! If incorrect coil type or name is given, errorsfound is returned as true.</span>
<a name="ln-14563"></a>
<a name="ln-14564"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14565"></a>          <span class="c">! na</span>
<a name="ln-14566"></a>
<a name="ln-14567"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14568"></a>          <span class="c">! na</span>
<a name="ln-14569"></a>
<a name="ln-14570"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14571"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14572"></a>
<a name="ln-14573"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14574"></a>
<a name="ln-14575"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14576"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>       <span class="c">! must match coil types in this module</span>
<a name="ln-14577"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>       <span class="c">! must match coil names for the coil type</span>
<a name="ln-14578"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>    <span class="c">! set to true if problem</span>
<a name="ln-14579"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BypassFraction</span> <span class="c">! returned bypass air fraction of matched coil</span>
<a name="ln-14580"></a>
<a name="ln-14581"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14582"></a>          <span class="c">! na</span>
<a name="ln-14583"></a>
<a name="ln-14584"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14585"></a>          <span class="c">! na</span>
<a name="ln-14586"></a>
<a name="ln-14587"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14588"></a>          <span class="c">! na</span>
<a name="ln-14589"></a>
<a name="ln-14590"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14591"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14592"></a>
<a name="ln-14593"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14594"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14595"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14596"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14597"></a>  <span class="k">END IF</span>
<a name="ln-14598"></a>
<a name="ln-14599"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14600"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14601"></a><span class="k">    </span><span class="n">BypassFraction</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">BypassedFlowFrac</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14602"></a>   <span class="k">ELSE</span>
<a name="ln-14603"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilBypassedFlowFrac: Invalid DX Coil Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14604"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14605"></a>    <span class="n">BypassFraction</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-14606"></a>  <span class="n">ENDIF</span>
<a name="ln-14607"></a>
<a name="ln-14608"></a>  <span class="k">RETURN</span>
<a name="ln-14609"></a>
<a name="ln-14610"></a><span class="k">END FUNCTION </span><span class="n">GetDXCoilBypassedFlowFrac</span>
<a name="ln-14611"></a>
<a name="ln-14612"></a><span class="k">FUNCTION </span><span class="n">GetHPCoolingCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span> <span class="n">HeatingCoilIndex</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span><span class="p">)</span>
<a name="ln-14613"></a>
<a name="ln-14614"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14615"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-14616"></a>          <span class="c">!       DATE WRITTEN   February 2007</span>
<a name="ln-14617"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14618"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14619"></a>
<a name="ln-14620"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14621"></a>          <span class="c">! This function looks up the given DX heating coil and returns the companion DX cooling coil.</span>
<a name="ln-14622"></a>
<a name="ln-14623"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14624"></a>          <span class="c">! na</span>
<a name="ln-14625"></a>
<a name="ln-14626"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14627"></a>          <span class="c">! na</span>
<a name="ln-14628"></a>
<a name="ln-14629"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14630"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-14631"></a>  <span class="k">USE </span><span class="n">DataBranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CompSets</span><span class="p">,</span> <span class="n">NumCompSets</span>
<a name="ln-14632"></a>
<a name="ln-14633"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14634"></a>
<a name="ln-14635"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14636"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilType</span>  <span class="c">! Type of DX heating coil used in HP</span>
<a name="ln-14637"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilName</span>  <span class="c">! Name of DX heating coil used in HP</span>
<a name="ln-14638"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilIndex</span> <span class="c">! Index of DX heating coil used in HP</span>
<a name="ln-14639"></a>
<a name="ln-14640"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14641"></a>          <span class="c">! na</span>
<a name="ln-14642"></a>
<a name="ln-14643"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14644"></a>          <span class="c">! na</span>
<a name="ln-14645"></a>
<a name="ln-14646"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14647"></a>          <span class="c">! na</span>
<a name="ln-14648"></a>
<a name="ln-14649"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14650"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DXCoolingCoilIndex</span>   <span class="c">! Index of HP DX cooling coil returned from this function</span>
<a name="ln-14651"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WhichComp</span>            <span class="c">! DO loop counter to find correct comp set</span>
<a name="ln-14652"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WhichCompanionComp</span>   <span class="c">! DO loop counter to find companion coil comp set</span>
<a name="ln-14653"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WhichHXAssistedComp</span>  <span class="c">! DO loop counter when DX coil is used in a HX assisted cooling coil</span>
<a name="ln-14654"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompSetsParentType</span>   <span class="c">! Parent object type which uses DX heating coil pass into this function</span>
<a name="ln-14655"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompSetsParentName</span>   <span class="c">! Parent object name which uses DX heating coil pass into this function</span>
<a name="ln-14656"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXCompSetsParentType</span> <span class="c">! Used when DX cooling coil is a child of a HX assisted cooling coil</span>
<a name="ln-14657"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXCompSetsParentName</span> <span class="c">! Used when DX cooling coil is a child of a HX assisted cooling coil</span>
<a name="ln-14658"></a>
<a name="ln-14659"></a>  <span class="n">DXCoolingCoilIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14660"></a>
<a name="ln-14661"></a>  <span class="k">DO </span><span class="n">WhichComp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCompSets</span>
<a name="ln-14662"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">CompSets</span><span class="p">(</span><span class="n">WhichComp</span><span class="p">)%</span><span class="n">CTYPE</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14663"></a>       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="n">CompSets</span><span class="p">(</span><span class="n">WhichComp</span><span class="p">)%</span><span class="n">CNAME</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-14664"></a><span class="k">      </span><span class="n">CompSetsParentType</span> <span class="o">=</span> <span class="n">CompSets</span><span class="p">(</span><span class="n">WhichComp</span><span class="p">)%</span><span class="n">PARENTCTYPE</span>
<a name="ln-14665"></a>      <span class="n">CompSetsParentName</span> <span class="o">=</span> <span class="n">CompSets</span><span class="p">(</span><span class="n">WhichComp</span><span class="p">)%</span><span class="n">PARENTCNAME</span>
<a name="ln-14666"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">,</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14667"></a>         <span class="n">SameString</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">,</span><span class="s1">&#39;ZoneHVAC:PackagedTerminalHeatPump&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14668"></a>         <span class="n">SameString</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">,</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14669"></a>         <span class="n">SameString</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">,</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool:VAVChangeoverBypass&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14670"></a>         <span class="n">SameString</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">,</span><span class="s1">&#39;AirLoopHVAC:UnitarySystem&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-14671"></a><span class="c">!       Search for DX cooling coils</span>
<a name="ln-14672"></a>        <span class="k">DO </span><span class="n">WhichCompanionComp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCompSets</span>
<a name="ln-14673"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">PARENTCNAME</span><span class="p">,</span><span class="n">CompSetsParentName</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14674"></a>             <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">CTYPE</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-14675"></a><span class="k">            </span><span class="n">DXCoolingCoilIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">CNAME</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14676"></a>            <span class="k">EXIT</span>
<a name="ln-14677"></a><span class="k">        END DO</span>
<a name="ln-14678"></a><span class="k">        DO </span><span class="n">WhichCompanionComp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCompSets</span>
<a name="ln-14679"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">PARENTCNAME</span><span class="p">,</span><span class="n">CompSetsParentName</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14680"></a>             <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">CTYPE</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-14681"></a><span class="k">            </span><span class="n">DXCoolingCoilIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">CNAME</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14682"></a>            <span class="k">EXIT</span>
<a name="ln-14683"></a><span class="k">        END DO</span>
<a name="ln-14684"></a><span class="c">!       Search for Heat Exchanger Assisted DX cooling coils</span>
<a name="ln-14685"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14686"></a><span class="k">          DO </span><span class="n">WhichHXAssistedComp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCompSets</span>
<a name="ln-14687"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichHXAssistedComp</span><span class="p">)%</span><span class="n">PARENTCNAME</span><span class="p">,</span><span class="n">CompSetsParentName</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14688"></a>               <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichHXAssistedComp</span><span class="p">)%</span><span class="n">CTYPE</span><span class="p">,</span><span class="s1">&#39;CoilSystem:Cooling:DX:HeatExchangerAssisted&#39;</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-14689"></a><span class="k">            </span><span class="n">HXCompSetsParentType</span> <span class="o">=</span> <span class="n">CompSets</span><span class="p">(</span><span class="n">WhichHXAssistedComp</span><span class="p">)%</span><span class="n">CTYPE</span>
<a name="ln-14690"></a>            <span class="n">HXCompSetsParentName</span> <span class="o">=</span> <span class="n">CompSets</span><span class="p">(</span><span class="n">WhichHXAssistedComp</span><span class="p">)%</span><span class="n">CNAME</span>
<a name="ln-14691"></a>            <span class="k">DO </span><span class="n">WhichCompanionComp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCompSets</span>
<a name="ln-14692"></a>              <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">PARENTCNAME</span><span class="p">,</span><span class="n">HXCompSetsParentName</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14693"></a>                 <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">CTYPE</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-14694"></a><span class="k">                </span><span class="n">DXCoolingCoilIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompSets</span><span class="p">(</span><span class="n">WhichCompanionComp</span><span class="p">)%</span><span class="n">CNAME</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14695"></a>                <span class="k">EXIT</span>
<a name="ln-14696"></a><span class="k">            END DO</span>
<a name="ln-14697"></a><span class="k">            EXIT</span>
<a name="ln-14698"></a><span class="k">          END DO</span>
<a name="ln-14699"></a><span class="k">        END IF</span>
<a name="ln-14700"></a><span class="k">      ELSE</span>
<a name="ln-14701"></a><span class="c">!     ErrorFound, Coil:Heating:DX:SingleSpeed is used in wrong type of parent object (should never get here)</span>
<a name="ln-14702"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompSetsParentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14703"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;DX heating coil not allowed in this configuration.&#39;</span><span class="p">)</span>
<a name="ln-14704"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-14705"></a>      <span class="k">END IF</span>
<a name="ln-14706"></a><span class="k">    EXIT</span>
<a name="ln-14707"></a><span class="k">  END DO</span>
<a name="ln-14708"></a>
<a name="ln-14709"></a><span class="c">! Check and warn user is crankcase heater power or max OAT for crankcase heater differs in DX cooling and heating coils</span>
<a name="ln-14710"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14711"></a><span class="k">    IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14712"></a><span class="k">      IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="o">/=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">CrankcaseHeaterCapacity</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14713"></a>         <span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span> <span class="o">/=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14714"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Crankcase heater capacity or max outdoor temp for crankcase heater operation specified in&#39;</span><span class="p">)</span>
<a name="ln-14715"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoolingCoilIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-14716"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;is different than that specified in Coil:Heating:DX:SingleSpeed = &#39;</span> <span class="p">&amp;</span>
<a name="ln-14717"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-14718"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Both of these DX coils are part of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompSetsParentType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-14719"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">CompSetsParentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-14720"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The value specified in the DX heating coil will be used and the simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-14721"></a>      <span class="k">END IF</span>
<a name="ln-14722"></a><span class="k">    END IF</span>
<a name="ln-14723"></a><span class="k">  END IF</span>
<a name="ln-14724"></a>
<a name="ln-14725"></a><span class="k">  RETURN</span>
<a name="ln-14726"></a>
<a name="ln-14727"></a><span class="k">END FUNCTION </span><span class="n">GetHPCoolingCoilIndex</span>
<a name="ln-14728"></a>
<a name="ln-14729"></a><span class="k">FUNCTION </span><span class="n">GetDXCoilNumberOfSpeeds</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NumberOfSpeeds</span><span class="p">)</span>
<a name="ln-14730"></a>
<a name="ln-14731"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14732"></a>          <span class="c">!       AUTHOR         L. Gu</span>
<a name="ln-14733"></a>          <span class="c">!       DATE WRITTEN   July 2007</span>
<a name="ln-14734"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14735"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14736"></a>
<a name="ln-14737"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14738"></a>          <span class="c">! This function looks up the given coil and returns the number of speeds for multispeed coils.</span>
<a name="ln-14739"></a>          <span class="c">! If incorrect coil type or name is given, errorsfound is returned as true.</span>
<a name="ln-14740"></a>
<a name="ln-14741"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14742"></a>          <span class="c">! na</span>
<a name="ln-14743"></a>
<a name="ln-14744"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14745"></a>          <span class="c">! na</span>
<a name="ln-14746"></a>
<a name="ln-14747"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14748"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14749"></a>
<a name="ln-14750"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14751"></a>
<a name="ln-14752"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14753"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>       <span class="c">! must match coil types in this module</span>
<a name="ln-14754"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>       <span class="c">! must match coil names for the coil type</span>
<a name="ln-14755"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>    <span class="c">! set to true if problem</span>
<a name="ln-14756"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumberOfSpeeds</span> <span class="c">! returned the number of speed of matched coil</span>
<a name="ln-14757"></a>
<a name="ln-14758"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14759"></a>          <span class="c">! na</span>
<a name="ln-14760"></a>
<a name="ln-14761"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14762"></a>          <span class="c">! na</span>
<a name="ln-14763"></a>
<a name="ln-14764"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14765"></a>          <span class="c">! na</span>
<a name="ln-14766"></a>
<a name="ln-14767"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14768"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14769"></a>
<a name="ln-14770"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14771"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14772"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14773"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14774"></a>  <span class="k">END IF</span>
<a name="ln-14775"></a>
<a name="ln-14776"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14777"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14778"></a><span class="k">    </span><span class="n">NumberOfSpeeds</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-14779"></a>   <span class="k">ELSE</span>
<a name="ln-14780"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilNumberOfSpeeds: Invalid DX Coil Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14781"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14782"></a>    <span class="n">NumberOfSpeeds</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14783"></a>  <span class="n">ENDIF</span>
<a name="ln-14784"></a>
<a name="ln-14785"></a>  <span class="k">RETURN</span>
<a name="ln-14786"></a>
<a name="ln-14787"></a><span class="k">END FUNCTION </span><span class="n">GetDXCoilNumberOfSpeeds</span>
<a name="ln-14788"></a>
<a name="ln-14789"></a><span class="k">FUNCTION </span><span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CoilIndex</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SchPtr</span><span class="p">)</span>
<a name="ln-14790"></a>
<a name="ln-14791"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14792"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-14793"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-14794"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14795"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14796"></a>
<a name="ln-14797"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14798"></a>          <span class="c">! This function looks up the given coil and returns the availability schedule index.  If</span>
<a name="ln-14799"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and schedule index is returned</span>
<a name="ln-14800"></a>          <span class="c">! as -1.</span>
<a name="ln-14801"></a>
<a name="ln-14802"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14803"></a>          <span class="c">! na</span>
<a name="ln-14804"></a>
<a name="ln-14805"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14806"></a>          <span class="c">! na</span>
<a name="ln-14807"></a>
<a name="ln-14808"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14809"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14810"></a>
<a name="ln-14811"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14812"></a>
<a name="ln-14813"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14814"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14815"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14816"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14817"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CoilIndex</span>   <span class="c">! Coil index number</span>
<a name="ln-14818"></a>
<a name="ln-14819"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SchPtr</span>       <span class="c">! returned availabiltiy schedule of matched coil</span>
<a name="ln-14820"></a>
<a name="ln-14821"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14822"></a>          <span class="c">! na</span>
<a name="ln-14823"></a>
<a name="ln-14824"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14825"></a>          <span class="c">! na</span>
<a name="ln-14826"></a>
<a name="ln-14827"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14828"></a>          <span class="c">! na</span>
<a name="ln-14829"></a>
<a name="ln-14830"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14831"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14832"></a>
<a name="ln-14833"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14834"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14835"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14836"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14837"></a>  <span class="k">END IF</span>
<a name="ln-14838"></a>
<a name="ln-14839"></a><span class="k">  If</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-14840"></a><span class="k">    IF</span><span class="p">(</span><span class="n">CoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14841"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilAvailSchPtr: Invalid index passed = 0&#39;</span><span class="p">)</span>
<a name="ln-14842"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... returning DXCoilAvailSchPtr as -1.&#39;</span><span class="p">)</span>
<a name="ln-14843"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14844"></a>      <span class="n">SchPtr</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-14845"></a>      <span class="k">RETURN</span>
<a name="ln-14846"></a><span class="k">    ELSE</span>
<a name="ln-14847"></a><span class="k">      </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">CoilIndex</span>
<a name="ln-14848"></a>    <span class="k">END IF</span>
<a name="ln-14849"></a><span class="k">  Else</span>
<a name="ln-14850"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14851"></a>  <span class="k">End If</span>
<a name="ln-14852"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14853"></a><span class="k">    </span><span class="n">SchPtr</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">SchedPtr</span>
<a name="ln-14854"></a>  <span class="k">ELSE</span>
<a name="ln-14855"></a><span class="k">    If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-14856"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilAvailSch: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-14857"></a>          <span class="s1">&#39;&quot; when accessing coil availability schedule index.&#39;</span><span class="p">)</span>
<a name="ln-14858"></a>    <span class="k">End IF</span>
<a name="ln-14859"></a><span class="k">    </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14860"></a>    <span class="n">SchPtr</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-14861"></a>  <span class="n">ENDIF</span>
<a name="ln-14862"></a>
<a name="ln-14863"></a>  <span class="k">RETURN</span>
<a name="ln-14864"></a>
<a name="ln-14865"></a><span class="k">END FUNCTION </span><span class="n">GetDXCoilAvailSchPtr</span>
<a name="ln-14866"></a>
<a name="ln-14867"></a><span class="k">FUNCTION </span><span class="n">GetDXCoilAirFlow</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">AirFlow</span><span class="p">)</span>
<a name="ln-14868"></a>
<a name="ln-14869"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14870"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-14871"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-14872"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14873"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14874"></a>
<a name="ln-14875"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14876"></a>          <span class="c">! This function looks up the given coil and returns the availability schedule index.  If</span>
<a name="ln-14877"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and schedule index is returned</span>
<a name="ln-14878"></a>          <span class="c">! as -1.</span>
<a name="ln-14879"></a>
<a name="ln-14880"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14881"></a>          <span class="c">! na</span>
<a name="ln-14882"></a>
<a name="ln-14883"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14884"></a>          <span class="c">! na</span>
<a name="ln-14885"></a>
<a name="ln-14886"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14887"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14888"></a>
<a name="ln-14889"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14890"></a>
<a name="ln-14891"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14892"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-14893"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-14894"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-14895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AirFlow</span>      <span class="c">! returned coil air flow rate</span>
<a name="ln-14896"></a>
<a name="ln-14897"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14898"></a>          <span class="c">! na</span>
<a name="ln-14899"></a>
<a name="ln-14900"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14901"></a>          <span class="c">! na</span>
<a name="ln-14902"></a>
<a name="ln-14903"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14904"></a>          <span class="c">! na</span>
<a name="ln-14905"></a>
<a name="ln-14906"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14907"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-14908"></a>
<a name="ln-14909"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14910"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14911"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14912"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14913"></a>  <span class="k">END IF</span>
<a name="ln-14914"></a>
<a name="ln-14915"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-14916"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14917"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-14918"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">,</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">,</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">,</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span>
<a name="ln-14919"></a>        <span class="n">AirFlow</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14920"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-14921"></a>        <span class="n">AirFlow</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14922"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-14923"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilAirFlow: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-14924"></a>              <span class="s1">&#39;&quot; when accessing coil air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-14925"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14926"></a>        <span class="n">AirFlow</span><span class="o">=-</span><span class="mf">1.d0</span>
<a name="ln-14927"></a>    <span class="k">END SELECT</span>
<a name="ln-14928"></a><span class="k">  ELSE</span>
<a name="ln-14929"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDXCoilAirFlow: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-14930"></a>          <span class="s1">&#39;&quot; when accessing coil air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-14931"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14932"></a>    <span class="n">AirFlow</span><span class="o">=-</span><span class="mf">1.d0</span>
<a name="ln-14933"></a>  <span class="n">ENDIF</span>
<a name="ln-14934"></a>
<a name="ln-14935"></a>  <span class="k">RETURN</span>
<a name="ln-14936"></a>
<a name="ln-14937"></a><span class="k">END FUNCTION </span><span class="n">GetDXCoilAirFlow</span>
<a name="ln-14938"></a>
<a name="ln-14939"></a><span class="k">FUNCTION </span><span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">CapFTCurveIndex</span><span class="p">)</span>
<a name="ln-14940"></a>
<a name="ln-14941"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14942"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-14943"></a>          <span class="c">!       DATE WRITTEN   August 2013</span>
<a name="ln-14944"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14945"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14946"></a>
<a name="ln-14947"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14948"></a>          <span class="c">! This function looks up the given coil and returns the CapFT schedule index.  If</span>
<a name="ln-14949"></a>          <span class="c">! incorrect coil index is given, errorsfound is returned as true and schedule index is returned</span>
<a name="ln-14950"></a>          <span class="c">! as -1.</span>
<a name="ln-14951"></a>
<a name="ln-14952"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14953"></a>          <span class="c">! na</span>
<a name="ln-14954"></a>
<a name="ln-14955"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14956"></a>          <span class="c">! na</span>
<a name="ln-14957"></a>
<a name="ln-14958"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14959"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14960"></a>
<a name="ln-14961"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14962"></a>
<a name="ln-14963"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14964"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! coil index pointer</span>
<a name="ln-14965"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>     <span class="c">! set to true if problem</span>
<a name="ln-14966"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">CapFTCurveIndex</span> <span class="c">! returned coil CapFT curve index</span>
<a name="ln-14967"></a>
<a name="ln-14968"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14969"></a>          <span class="c">! na</span>
<a name="ln-14970"></a>
<a name="ln-14971"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14972"></a>          <span class="c">! na</span>
<a name="ln-14973"></a>
<a name="ln-14974"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14975"></a>          <span class="c">! na</span>
<a name="ln-14976"></a>
<a name="ln-14977"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14978"></a>          <span class="c">! na</span>
<a name="ln-14979"></a>
<a name="ln-14980"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-14981"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14982"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-14983"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14984"></a>  <span class="k">END IF</span>
<a name="ln-14985"></a>
<a name="ln-14986"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CoilIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14987"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">DXCoilType_Num</span><span class="p">)</span>
<a name="ln-14988"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">,</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">,</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">,</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span>
<a name="ln-14989"></a>        <span class="n">CapFTCurveIndex</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14990"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-14991"></a>        <span class="n">CapFTCurveIndex</span><span class="o">=</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">CCapFTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14992"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-14993"></a><span class="c">!        CALL ShowSevereError(&#39;GetDXCoilCapFTCurveIndex: Could not find Coil, Type=&quot;&#39;// &amp;</span>
<a name="ln-14994"></a><span class="c">!             TRIM(cAllCoilTypes(DXCoil(CoilIndex)%DXCoilType_Num))//&#39;&quot; Name=&quot;&#39;//TRIM(DXCoil(CoilIndex)%Name)//  &amp;</span>
<a name="ln-14995"></a><span class="c">!              &#39;&quot; when accessing coil capacity as a function of temperture curve.&#39;)</span>
<a name="ln-14996"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-14997"></a>        <span class="n">CapFTCurveIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14998"></a>    <span class="k">END SELECT</span>
<a name="ln-14999"></a><span class="k">  ELSE</span>
<a name="ln-15000"></a><span class="c">!    CALL ShowSevereError(&#39;GetDXCoilCapFTCurveIndex: Could not find Coil, Index = 0&#39;// &amp;</span>
<a name="ln-15001"></a><span class="c">!          &#39; when accessing coil air flow rate.&#39;)</span>
<a name="ln-15002"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-15003"></a>    <span class="n">CapFTCurveIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-15004"></a>  <span class="n">ENDIF</span>
<a name="ln-15005"></a>
<a name="ln-15006"></a>  <span class="k">RETURN</span>
<a name="ln-15007"></a>
<a name="ln-15008"></a><span class="k">END FUNCTION </span><span class="n">GetDXCoilCapFTCurveIndex</span>
<a name="ln-15009"></a>
<a name="ln-15010"></a><span class="k">SUBROUTINE </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HeatingCoilPLFCurvePTR</span><span class="p">,</span><span class="n">CondenserType</span><span class="p">,</span><span class="n">CondenserInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-15011"></a>                                <span class="n">MaxOATCrankcaseHeater</span><span class="p">,</span><span class="n">MinOATCooling</span><span class="p">,</span><span class="n">MaxOATCooling</span><span class="p">,</span><span class="n">MinOATHeating</span><span class="p">,</span><span class="n">MaxOATHeating</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-15012"></a>                                <span class="n">HeatingPerformanceOATType</span><span class="p">,</span><span class="n">DefrostStrategy</span><span class="p">,</span><span class="n">DefrostControl</span><span class="p">,</span><span class="n">DefrostEIRPtr</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-15013"></a>                                <span class="n">DefrostFraction</span><span class="p">,</span><span class="n">DefrostCapacity</span><span class="p">,</span><span class="n">MaxOATDefrost</span><span class="p">,</span><span class="n">CoolingCoilPresent</span><span class="p">,</span><span class="n">HeatingCoilPresent</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-15014"></a>                                <span class="n">HeatSizeRatio</span><span class="p">,</span> <span class="n">TotCap</span><span class="p">,</span> <span class="n">SupplyFanIndex</span><span class="p">,</span> <span class="n">SupplyFanName</span><span class="p">)</span>
<a name="ln-15015"></a>
<a name="ln-15016"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-15017"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-15018"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-15019"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-15020"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15021"></a>
<a name="ln-15022"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-15023"></a>          <span class="c">! This routine was designed to allow the DX coil to access information from a gas or</span>
<a name="ln-15024"></a>          <span class="c">! electric heating coil when these coils are each used in a parent object.</span>
<a name="ln-15025"></a>          <span class="c">! Also, this is an illustration of setting Data from an outside source.</span>
<a name="ln-15026"></a>
<a name="ln-15027"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15028"></a>          <span class="c">! na</span>
<a name="ln-15029"></a>
<a name="ln-15030"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-15031"></a>          <span class="c">! na</span>
<a name="ln-15032"></a>
<a name="ln-15033"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-15034"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-15035"></a>
<a name="ln-15036"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-15037"></a>
<a name="ln-15038"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-15039"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">DXCoilNum</span>   <span class="c">! Number of DX Cooling Coil</span>
<a name="ln-15040"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! Set to true if certain errors found</span>
<a name="ln-15041"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">HeatingCoilPLFCurvePTR</span>   <span class="c">! Parameter equivalent of heating coil PLR curve index</span>
<a name="ln-15042"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">CondenserType</span>            <span class="c">! Parameter equivalent of condenser type parameter</span>
<a name="ln-15043"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">CondenserInletNodeNum</span>    <span class="c">! Parameter equivalent of condenser inlet node number</span>
<a name="ln-15044"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">MaxOATCrankcaseHeater</span>    <span class="c">! Parameter equivalent of condenser Max OAT for Crank Case Heater temp</span>
<a name="ln-15045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">MaxOATCooling</span>        <span class="c">! Parameter equivalent of condenser Max OAT for compressor cooling operation</span>
<a name="ln-15046"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">MinOATCooling</span>        <span class="c">! Parameter equivalent of condenser Min OAT for compressor cooling operation</span>
<a name="ln-15047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">MaxOATHeating</span>        <span class="c">! Parameter equivalent of condenser Max OAT for compressor heating operation</span>
<a name="ln-15048"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">MinOATHeating</span>        <span class="c">! Parameter equivalent of condenser Min OAT for compressor heating operation</span>
<a name="ln-15049"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">HeatingPerformanceOATType</span> <span class="c">! Parameter equivalent to condenser entering air temp type (1-db, 2=wb)</span>
<a name="ln-15050"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">DefrostStrategy</span>
<a name="ln-15051"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">DefrostControl</span>
<a name="ln-15052"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">DefrostEIRPtr</span>
<a name="ln-15053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">DefrostFraction</span>
<a name="ln-15054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">DefrostCapacity</span>
<a name="ln-15055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">MaxOATDefrost</span>
<a name="ln-15056"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">CoolingCoilPresent</span>
<a name="ln-15057"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">HeatingCoilPresent</span>
<a name="ln-15058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">HeatSizeRatio</span>
<a name="ln-15059"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">OPTIONAL</span>        <span class="kd">::</span> <span class="n">TotCap</span>
<a name="ln-15060"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">SupplyFanIndex</span>
<a name="ln-15061"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SupplyFanName</span>
<a name="ln-15062"></a>
<a name="ln-15063"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-15064"></a>          <span class="c">! na</span>
<a name="ln-15065"></a>
<a name="ln-15066"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-15067"></a>          <span class="c">! na</span>
<a name="ln-15068"></a>
<a name="ln-15069"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-15070"></a>          <span class="c">! na</span>
<a name="ln-15071"></a>
<a name="ln-15072"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-15073"></a>          <span class="c">! na</span>
<a name="ln-15074"></a>
<a name="ln-15075"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-15076"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15077"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-15078"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-15079"></a>  <span class="k">END IF</span>
<a name="ln-15080"></a>
<a name="ln-15081"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DXCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DXCoilNum</span> <span class="o">&gt;</span> <span class="n">NumDXCoils</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15082"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetDXCoolingCoilData: called with DX Cooling Coil Number out of range=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-15083"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be &gt;0 and &lt;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumDXCoils</span><span class="p">)))</span>
<a name="ln-15084"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-15085"></a>    <span class="k">RETURN</span>
<a name="ln-15086"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-15087"></a>
<a name="ln-15088"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatingCoilPLFCurvePTR</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15089"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurvePTR</span>
<a name="ln-15090"></a>  <span class="n">ENDIF</span>
<a name="ln-15091"></a>
<a name="ln-15092"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CondenserType</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15093"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span><span class="o">=</span><span class="n">CondenserType</span>
<a name="ln-15094"></a>  <span class="n">ENDIF</span>
<a name="ln-15095"></a>
<a name="ln-15096"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CondenserInletNodeNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15097"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CondenserInletNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">CondenserInletNodeNum</span>
<a name="ln-15098"></a>  <span class="n">ENDIF</span>
<a name="ln-15099"></a>
<a name="ln-15100"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxOATCrankcaseHeater</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15101"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCrankcaseHeater</span><span class="o">=</span><span class="n">MaxOATCrankcaseHeater</span>
<a name="ln-15102"></a>  <span class="n">ENDIF</span>
<a name="ln-15103"></a>
<a name="ln-15104"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxOATCooling</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15105"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCompressor</span><span class="o">=</span><span class="n">MaxOATCooling</span>
<a name="ln-15106"></a>  <span class="n">ENDIF</span>
<a name="ln-15107"></a>
<a name="ln-15108"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxOATHeating</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15109"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATCompressor</span><span class="o">=</span><span class="n">MaxOATHeating</span>
<a name="ln-15110"></a>  <span class="n">ENDIF</span>
<a name="ln-15111"></a>
<a name="ln-15112"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MinOATCooling</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15113"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="o">=</span><span class="n">MinOATCooling</span>
<a name="ln-15114"></a>  <span class="n">ENDIF</span>
<a name="ln-15115"></a>
<a name="ln-15116"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MinOATHeating</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-15117"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="o">=</span><span class="n">MinOATHeating</span>
<a name="ln-15118"></a>  <span class="n">ENDIF</span>
<a name="ln-15119"></a>
<a name="ln-15120"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatingPerformanceOATType</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15121"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingPerformanceOATType</span><span class="o">=</span><span class="n">HeatingPerformanceOATType</span>
<a name="ln-15122"></a>  <span class="k">END IF</span>
<a name="ln-15123"></a>
<a name="ln-15124"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DefrostStrategy</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15125"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostStrategy</span><span class="o">=</span><span class="n">DefrostStrategy</span>
<a name="ln-15126"></a>  <span class="k">END IF</span>
<a name="ln-15127"></a>
<a name="ln-15128"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DefrostControl</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15129"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostControl</span><span class="o">=</span><span class="n">DefrostControl</span>
<a name="ln-15130"></a>  <span class="k">END IF</span>
<a name="ln-15131"></a>
<a name="ln-15132"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DefrostEIRPtr</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15133"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostEIRFT</span><span class="o">=</span><span class="n">DefrostEIRPtr</span>
<a name="ln-15134"></a>  <span class="k">END IF</span>
<a name="ln-15135"></a>
<a name="ln-15136"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DefrostFraction</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15137"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostTime</span><span class="o">=</span><span class="n">DefrostFraction</span>
<a name="ln-15138"></a>  <span class="k">END IF</span>
<a name="ln-15139"></a>
<a name="ln-15140"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DefrostCapacity</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15141"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DefrostCapacity</span><span class="o">=</span><span class="n">DefrostCapacity</span>
<a name="ln-15142"></a>  <span class="k">END IF</span>
<a name="ln-15143"></a>
<a name="ln-15144"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxOATDefrost</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15145"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">MaxOATDefrost</span><span class="o">=</span><span class="n">MaxOATDefrost</span>
<a name="ln-15146"></a>  <span class="k">END IF</span>
<a name="ln-15147"></a>
<a name="ln-15148"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoolingCoilPresent</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15149"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">CoolingCoilPresent</span><span class="o">=</span><span class="n">CoolingCoilPresent</span>
<a name="ln-15150"></a>  <span class="k">END IF</span>
<a name="ln-15151"></a>
<a name="ln-15152"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatingCoilPresent</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15153"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatingCoilPresent</span><span class="o">=</span><span class="n">HeatingCoilPresent</span>
<a name="ln-15154"></a>  <span class="k">END IF</span>
<a name="ln-15155"></a>
<a name="ln-15156"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatSizeRatio</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15157"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HeatSizeRatio</span><span class="o">=</span><span class="n">HeatSizeRatio</span>
<a name="ln-15158"></a>  <span class="k">END IF</span>
<a name="ln-15159"></a>
<a name="ln-15160"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">TotCap</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15161"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">TotCap</span>
<a name="ln-15162"></a>  <span class="k">END IF</span>
<a name="ln-15163"></a>
<a name="ln-15164"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SupplyFanIndex</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15165"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanIndex</span><span class="o">=</span><span class="n">SupplyFanIndex</span>
<a name="ln-15166"></a>  <span class="k">END IF</span>
<a name="ln-15167"></a>
<a name="ln-15168"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SupplyFanName</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15169"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">SupplyFanName</span><span class="o">=</span><span class="n">SupplyFanName</span>
<a name="ln-15170"></a>  <span class="k">END IF</span>
<a name="ln-15171"></a>
<a name="ln-15172"></a><span class="k">  RETURN</span>
<a name="ln-15173"></a>
<a name="ln-15174"></a><span class="k">END SUBROUTINE </span><span class="n">SetDXCoolingCoilData</span>
<a name="ln-15175"></a>
<a name="ln-15176"></a><span class="k">SUBROUTINE </span><span class="n">SetCoilSystemHeatingDXFlag</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span> <span class="n">CoilName</span><span class="p">)</span>
<a name="ln-15177"></a>
<a name="ln-15178"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-15179"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-15180"></a>          <span class="c">!       DATE WRITTEN   Jan. 2012</span>
<a name="ln-15181"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-15182"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15183"></a>
<a name="ln-15184"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-15185"></a>          <span class="c">! inform DX heating coil that is is part of a CoilSystem:Heating:DX</span>
<a name="ln-15186"></a>          <span class="c">! and therefore it need not find its companion cooling coil</span>
<a name="ln-15187"></a>
<a name="ln-15188"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15189"></a>          <span class="c">! set value of logical flag FindCompanionUpStreamCoil to true</span>
<a name="ln-15190"></a>
<a name="ln-15191"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-15192"></a>          <span class="c">! na</span>
<a name="ln-15193"></a>
<a name="ln-15194"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-15195"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-15196"></a>
<a name="ln-15197"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-15198"></a>
<a name="ln-15199"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-15200"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-15201"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-15202"></a>
<a name="ln-15203"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-15204"></a>          <span class="c">! na</span>
<a name="ln-15205"></a>
<a name="ln-15206"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-15207"></a>          <span class="c">! na</span>
<a name="ln-15208"></a>
<a name="ln-15209"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-15210"></a>          <span class="c">! na</span>
<a name="ln-15211"></a>
<a name="ln-15212"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-15213"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-15214"></a>
<a name="ln-15215"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-15216"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15217"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-15218"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-15219"></a>  <span class="k">END IF</span>
<a name="ln-15220"></a>
<a name="ln-15221"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-15222"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15223"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">FindCompanionUpStreamCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-15224"></a>  <span class="k">ELSE</span>
<a name="ln-15225"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetCoilSystemHeatingDXFlag: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-15226"></a>
<a name="ln-15227"></a>  <span class="n">ENDIF</span>
<a name="ln-15228"></a>
<a name="ln-15229"></a>  <span class="k">RETURN</span>
<a name="ln-15230"></a>
<a name="ln-15231"></a><span class="k">END SUBROUTINE </span><span class="n">SetCoilSystemHeatingDXFlag</span>
<a name="ln-15232"></a>
<a name="ln-15233"></a><span class="k">SUBROUTINE </span><span class="n">SetCoilSystemCoolingData</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span> <span class="n">CoilSystemName</span><span class="p">)</span>
<a name="ln-15234"></a>
<a name="ln-15235"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-15236"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-15237"></a>          <span class="c">!       DATE WRITTEN   July 2012</span>
<a name="ln-15238"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-15239"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15240"></a>
<a name="ln-15241"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-15242"></a>          <span class="c">! inform the child DX coil what the name of its parent is.</span>
<a name="ln-15243"></a>
<a name="ln-15244"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15245"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-15246"></a>
<a name="ln-15247"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-15248"></a>          <span class="c">! na</span>
<a name="ln-15249"></a>
<a name="ln-15250"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-15251"></a>  <span class="k">Use </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-15252"></a>
<a name="ln-15253"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-15254"></a>
<a name="ln-15255"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-15256"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-15257"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilSystemName</span>
<a name="ln-15258"></a>
<a name="ln-15259"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-15260"></a>          <span class="c">! na</span>
<a name="ln-15261"></a>
<a name="ln-15262"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-15263"></a>          <span class="c">! na</span>
<a name="ln-15264"></a>
<a name="ln-15265"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-15266"></a>          <span class="c">! na</span>
<a name="ln-15267"></a>
<a name="ln-15268"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-15269"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-15270"></a>
<a name="ln-15271"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15272"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-15273"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-15274"></a>  <span class="k">END IF</span>
<a name="ln-15275"></a>
<a name="ln-15276"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-15277"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15278"></a><span class="k">    </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">CoilSystemName</span> <span class="o">=</span> <span class="n">CoilSystemName</span>
<a name="ln-15279"></a>  <span class="k">ELSE</span>
<a name="ln-15280"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetCoilSystemCoolingData: Could not find Coil &quot;Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-15281"></a>  <span class="n">ENDIF</span>
<a name="ln-15282"></a>
<a name="ln-15283"></a>  <span class="k">RETURN</span>
<a name="ln-15284"></a>
<a name="ln-15285"></a><span class="k">END SUBROUTINE </span><span class="n">SetCoilSystemCoolingData</span>
<a name="ln-15286"></a>
<a name="ln-15287"></a><span class="k">FUNCTION </span><span class="n">CalcSHRUserDefinedCurves</span><span class="p">(</span><span class="n">InletDryBulb</span><span class="p">,</span><span class="n">InletWetBulb</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-15288"></a>                                  <span class="n">SHRFTempCurveIndex</span><span class="p">,</span><span class="n">SHRFFlowCurveIndex</span><span class="p">,</span><span class="n">SHRRated</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SHRopr</span><span class="p">)</span>
<a name="ln-15289"></a>
<a name="ln-15290"></a>        <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-15291"></a>        <span class="c">!       AUTHOR         Bereket Nigusse, FSEC</span>
<a name="ln-15292"></a>        <span class="c">!       DATE WRITTEN   December 2012</span>
<a name="ln-15293"></a>        <span class="c">!       MODIFIED       na</span>
<a name="ln-15294"></a>        <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15295"></a>
<a name="ln-15296"></a>        <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-15297"></a>        <span class="c">!    Returns the oprating sensible heat ratio for a given Rated SHR abd coil entering</span>
<a name="ln-15298"></a>        <span class="c">!    air DBT and WBT, and supply air mass flow fraction.</span>
<a name="ln-15299"></a>
<a name="ln-15300"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15301"></a>        <span class="c">!    Model uses user specified rated SHR, and SHR modifying curves for temperature and flow</span>
<a name="ln-15302"></a>        <span class="c">!    fraction.  The curves adjust the rated SHR based on biquadratic curve for temperatures</span>
<a name="ln-15303"></a>        <span class="c">!    and quadratic function for supply air mass flow ratio (actual vs rated).</span>
<a name="ln-15304"></a>        <span class="c">!</span>
<a name="ln-15305"></a>        <span class="c">!    The biquadratic and quadratic curves are normalized caurves generated from manufacturer&#39;s</span>
<a name="ln-15306"></a>        <span class="c">!    performance data</span>
<a name="ln-15307"></a>
<a name="ln-15308"></a>        <span class="c">! REFERENCES: na</span>
<a name="ln-15309"></a>
<a name="ln-15310"></a>
<a name="ln-15311"></a>
<a name="ln-15312"></a>        <span class="c">! USE STATEMENTS:</span>
<a name="ln-15313"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-15314"></a>
<a name="ln-15315"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-15316"></a>
<a name="ln-15317"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-15318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">InletDryBulb</span>       <span class="c">! inlet air dry bulb temperature [C]</span>
<a name="ln-15319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">InletWetBulb</span>       <span class="c">! inlet air wet bulb temperature [C]</span>
<a name="ln-15320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AirMassFlowRatio</span>   <span class="c">! ratio of actual air mass flow to rated air mass flow</span>
<a name="ln-15321"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SHRFTempCurveIndex</span> <span class="c">! SHR modifier curve index</span>
<a name="ln-15322"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SHRFFlowCurveIndex</span> <span class="c">! SHR modifier curve index</span>
<a name="ln-15323"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SHRRated</span>           <span class="c">! rated sensible heat ratio, user input</span>
<a name="ln-15324"></a>
<a name="ln-15325"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CalcSHRUserDefinedCurves&#39;</span>
<a name="ln-15326"></a>
<a name="ln-15327"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-15328"></a>          <span class="c">! na</span>
<a name="ln-15329"></a>          <span class="c">!</span>
<a name="ln-15330"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-15331"></a>          <span class="c">! na</span>
<a name="ln-15332"></a>          <span class="c">!</span>
<a name="ln-15333"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-15334"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRTempModFac</span>       <span class="c">! Sensible Heat Ratio modifier (function of entering wetbulb, entering drybulb)</span>
<a name="ln-15335"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRFlowModFac</span>       <span class="c">! Sensible Heat Ratio modifier (function of actual vs rated flow)</span>
<a name="ln-15336"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRopr</span>              <span class="c">! operating SHR, corrected for Temp and Flow Fraction</span>
<a name="ln-15337"></a>
<a name="ln-15338"></a>  <span class="c">!   Get SHR modifying factor (function of inlet wetbulb &amp; drybulb) for off-rated conditions</span>
<a name="ln-15339"></a>  <span class="n">SHRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SHRFTempCurveIndex</span><span class="p">,</span><span class="n">InletWetBulb</span><span class="p">,</span><span class="n">InletDryBulb</span><span class="p">)</span>
<a name="ln-15340"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SHRTempModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-15341"></a><span class="k">     </span><span class="n">SHRTempModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-15342"></a>  <span class="k">END IF</span>
<a name="ln-15343"></a>  <span class="c">!   Get SHR modifying factor (function of mass flow ratio) for off-rated conditions</span>
<a name="ln-15344"></a>  <span class="n">SHRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SHRFFlowCurveIndex</span><span class="p">,</span><span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-15345"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SHRFlowModFac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-15346"></a><span class="k">     </span><span class="n">SHRFlowModFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-15347"></a>  <span class="k">END IF</span>
<a name="ln-15348"></a>  <span class="c">!  Calculate &quot;operating&quot; sensible heat ratio</span>
<a name="ln-15349"></a>  <span class="n">SHRopr</span> <span class="o">=</span> <span class="n">SHRRated</span> <span class="o">*</span> <span class="n">SHRTempModFac</span> <span class="o">*</span> <span class="n">SHRFlowModFac</span>
<a name="ln-15350"></a>
<a name="ln-15351"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SHRopr</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SHRopr</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! SHR cannot be less than zero</span>
<a name="ln-15352"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SHRopr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SHRopr</span> <span class="o">=</span> <span class="mf">1.0d0</span>     <span class="c">! SHR cannot be greater than 1.0</span>
<a name="ln-15353"></a>
<a name="ln-15354"></a>  <span class="k">RETURN</span>
<a name="ln-15355"></a><span class="k">END FUNCTION </span><span class="n">CalcSHRUserDefinedCurves</span>
<a name="ln-15356"></a>
<a name="ln-15357"></a><span class="k">SUBROUTINE </span><span class="n">SetDXCoilTypeData</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span>
<a name="ln-15358"></a>
<a name="ln-15359"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-15360"></a>          <span class="c">!       AUTHOR         B. Nigusse</span>
<a name="ln-15361"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-15362"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-15363"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15364"></a>
<a name="ln-15365"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-15366"></a>          <span class="c">! inform the child DX coil if the DX cooling coil is for 100% DOAS application.</span>
<a name="ln-15367"></a>
<a name="ln-15368"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15369"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-15370"></a>
<a name="ln-15371"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-15372"></a>          <span class="c">! na</span>
<a name="ln-15373"></a>
<a name="ln-15374"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-15375"></a>  <span class="k">Use </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-15376"></a>
<a name="ln-15377"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-15378"></a>
<a name="ln-15379"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-15380"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-15381"></a>
<a name="ln-15382"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-15383"></a>          <span class="c">! na</span>
<a name="ln-15384"></a>
<a name="ln-15385"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-15386"></a>          <span class="c">! na</span>
<a name="ln-15387"></a>
<a name="ln-15388"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-15389"></a>          <span class="c">! na</span>
<a name="ln-15390"></a>
<a name="ln-15391"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-15392"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-15393"></a>
<a name="ln-15394"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15395"></a><span class="k">    CALL </span><span class="n">GetDXCoils</span>
<a name="ln-15396"></a>    <span class="n">GetCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-15397"></a>  <span class="k">END IF</span>
<a name="ln-15398"></a>
<a name="ln-15399"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">DXCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDXCoils</span><span class="p">)</span>
<a name="ln-15400"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15401"></a><span class="k">      </span><span class="n">DXCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-15402"></a>  <span class="k">ELSE</span>
<a name="ln-15403"></a>    <span class="c">!DXCoil(WhichCoil)%ISHundredPercentDOASDXCoil = .FALSE. !Objexx:BoundsViolation DXCoil(0): DXCoil is not allocated with a 0 element: Commented out</span>
<a name="ln-15404"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetDXCoilTypeData: Could not find Coil &quot;Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-15405"></a>  <span class="n">ENDIF</span>
<a name="ln-15406"></a>
<a name="ln-15407"></a>  <span class="k">RETURN</span>
<a name="ln-15408"></a>
<a name="ln-15409"></a><span class="k">END SUBROUTINE </span><span class="n">SetDXCoilTypeData</span>
<a name="ln-15410"></a><span class="c">!     NOTICE</span>
<a name="ln-15411"></a><span class="c">!</span>
<a name="ln-15412"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-15413"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-15414"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-15415"></a><span class="c">!</span>
<a name="ln-15416"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-15417"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-15418"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-15419"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-15420"></a><span class="c">!</span>
<a name="ln-15421"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-15422"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-15423"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-15424"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-15425"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-15426"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-15427"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-15428"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-15429"></a><span class="c">!     permit others to do so.</span>
<a name="ln-15430"></a><span class="c">!</span>
<a name="ln-15431"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-15432"></a><span class="c">!</span>
<a name="ln-15433"></a>
<a name="ln-15434"></a><span class="k">END MODULE </span><span class="n">DXCoils</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
